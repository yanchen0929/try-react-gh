import{r as Nr,H as OM,R as Ia,I as mL,C as gL,D as O2,a as jp,E as FM,j as Oi,G as vL,J as yL,K as xL,s as WS,L as AL,M as hS,P as _L,Q as Gc,T as wL}from"./index.4f2b28fa.js";import{R as ML,g as CL}from"./request.609a8627.js";import{a as TL,u as SL}from"./use-props-value.524ff333.js";import{t as IL}from"./tslib.es6.618bc104.js";var Mu=function(G,Z,tt,ot){var ht=tt?tt.call(ot,G,Z):void 0;if(ht!==void 0)return!!ht;if(G===Z)return!0;if(typeof G!="object"||!G||typeof Z!="object"||!Z)return!1;var bt=Object.keys(G),se=Object.keys(Z);if(bt.length!==se.length)return!1;for(var Ot=Object.prototype.hasOwnProperty.bind(Z),Jt=0;Jt<bt.length;Jt++){var le=bt[Jt];if(!Ot(le))return!1;var jt=G[le],pe=Z[le];if(ht=tt?tt.call(ot,jt,pe,le):void 0,ht===!1||ht===void 0&&jt!==pe)return!1}return!0};function EL(b){return Nr.exports.createElement("svg",Object.assign({width:"1em",height:"1em",viewBox:"0 0 48 48",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink"},b,{style:Object.assign({verticalAlign:"-0.125em"},b.style),className:["antd-mobile-icon",b.className].filter(Boolean).join(" ")}),Nr.exports.createElement("g",{id:"DownOutline-DownOutline",stroke:"none",strokeWidth:1,fill:"none",fillRule:"evenodd"},Nr.exports.createElement("g",null,Nr.exports.createElement("rect",{id:"DownOutline-\u77E9\u5F62",fill:"#FFFFFF",opacity:0,x:0,y:0,width:48,height:48}),Nr.exports.createElement("path",{d:"M5.11219264,16.3947957 L22.6612572,34.5767382 L22.6612572,34.5767382 C23.2125856,35.1304785 24.0863155,35.1630514 24.6755735,34.6744571 L24.7825775,34.5767382 L42.8834676,16.3956061 C42.9580998,16.320643 43,16.2191697 43,16.1133896 L43,12.9866673 C43,12.7657534 42.8209139,12.5866673 42.6,12.5866673 C42.4936115,12.5866673 42.391606,12.6290496 42.316542,12.7044413 L23.7816937,31.3201933 L23.7816937,31.3201933 L5.6866816,12.7237117 C5.53262122,12.5653818 5.27937888,12.5619207 5.121049,12.7159811 C5.04365775,12.7912854 5,12.8946805 5,13.0026627 L5,16.1170064 C5,16.2206403 5.04022164,16.3202292 5.11219264,16.3947957 Z",id:"DownOutline-down",fill:"currentColor",fillRule:"nonzero"}))))}function LL(b){return Nr.exports.createElement("svg",Object.assign({width:"1em",height:"1em",viewBox:"0 0 48 48",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink"},b,{style:Object.assign({verticalAlign:"-0.125em"},b.style),className:["antd-mobile-icon",b.className].filter(Boolean).join(" ")}),Nr.exports.createElement("g",{id:"PhoneFill-PhoneFill",stroke:"none",strokeWidth:1,fill:"none",fillRule:"evenodd"},Nr.exports.createElement("g",{id:"PhoneFill-\u7F16\u7EC4"},Nr.exports.createElement("rect",{id:"PhoneFill-\u77E9\u5F62",fill:"#FFFFFF",opacity:0,x:0,y:0,width:48,height:48}),Nr.exports.createElement("path",{d:"M15.1766716,31.9445426 C8.09652665,24.7479935 4.37345146,18.0644855 4.00844409,11.8899316 L4.0084441,11.8899317 C3.92661639,10.5018215 4.44249252,9.1450022 5.42588939,8.16187843 L8.87520905,4.71264482 L8.875209,4.71264487 C9.82549238,3.76245173 11.3661372,3.76245173 12.3164158,4.71264476 L17.4782284,9.87432857 L17.4782283,9.87432851 C18.4284452,10.8245882 18.4284452,12.3651945 17.4782284,13.3154495 L14.1657865,16.628821 L14.1657866,16.628821 C13.8067263,16.9875805 13.7081153,17.5315453 13.9183928,17.9935105 C15.7748593,22.0642535 17.9030566,25.2995591 20.301982,27.6984247 C22.7008932,30.097276 25.9362605,32.2254155 30.0071383,34.0818547 L30.0071383,34.0818546 C30.4691155,34.2921269 31.01309,34.1935184 31.3718619,33.8344671 L34.6853161,30.5221078 L34.685316,30.5221079 C35.6355994,29.5719147 37.1762442,29.5719147 38.1265228,30.5221078 L43.2873373,35.6837916 L43.2873374,35.6837916 C44.2375542,36.6340513 44.2375542,38.1746576 43.2873373,39.1249125 L39.83903,42.5741462 L39.8390299,42.5741463 C38.8558816,43.5575172 37.4990332,44.0733814 36.1108835,43.9915562 C29.8114647,43.6194609 22.9787453,39.7504807 15.6147216,32.3856094 L15.1766716,31.9445426 Z",id:"PhoneFill-\u8DEF\u5F84",fill:"currentColor",fillRule:"nonzero"}))))}function RL(b){return Nr.exports.createElement("svg",Object.assign({width:"1em",height:"1em",viewBox:"0 0 48 48",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink"},b,{style:Object.assign({verticalAlign:"-0.125em"},b.style),className:["antd-mobile-icon",b.className].filter(Boolean).join(" ")}),Nr.exports.createElement("g",{id:"TravelOutline-TravelOutline",stroke:"none",strokeWidth:1,fill:"none",fillRule:"evenodd"},Nr.exports.createElement("g",{id:"TravelOutline-\u7F16\u7EC4"},Nr.exports.createElement("rect",{id:"TravelOutline-\u77E9\u5F62",fill:"#FFFFFF",opacity:0,x:0,y:0,width:48,height:48}),Nr.exports.createElement("path",{d:"M44,31 L44,38 C44,41.3137085 41.3137085,44 38,44 L31,44 L31,41 L38,41 C39.5976809,41 40.9036609,39.75108 40.9949073,38.1762728 L41,38 L41,31 L44,31 Z M7,31 L7,38 C7,39.5976809 8.24891996,40.9036609 9.82372721,40.9949073 L10,41 L17,41 L17,44 L10,44 C6.6862915,44 4,41.3137085 4,38 L4,31 L7,31 Z M35.0117916,13.4953015 C35.1166207,13.7467969 35.1142891,14.0301778 35.0053359,14.2799142 L25.6937022,35.6235281 C25.5554891,35.9405947 25.1859051,36.0858047 24.8682132,35.9478636 C24.7040314,35.8765762 24.5781952,35.7386683 24.5223976,35.568873 L22.8381152,30.2710706 C22.4583134,29.0764282 22.6605228,27.7728272 23.3843858,26.749381 L27.7570153,20.567063 L20.9489383,24.5446033 C19.9288237,25.1405934 18.6974178,25.2551281 17.5848853,24.8574981 L12.4105493,23.0081401 C12.0854696,22.888567 11.9190648,22.5286234 12.0388737,22.2041835 C12.0990839,22.0411356 12.2244836,21.9103966 12.3850699,21.843247 L33.7040276,12.9570142 C34.2138006,12.7445291 34.7993065,12.9855285 35.0117916,13.4953015 Z M38,4 C41.3137085,4 44,6.6862915 44,10 L44,17 L41,17 L41,10 C41,8.40231912 39.75108,7.09633912 38.1762728,7.00509269 L38,7 L31,7 L31,4 L38,4 Z M17,4 L17,7 L10,7 C8.40231912,7 7.09633912,8.24891996 7.00509269,9.82372721 L7,10 L7,17 L4,17 L4,10 C4,6.6862915 6.6862915,4 10,4 L17,4 Z",id:"TravelOutline-\u5F62\u72B6\u7ED3\u5408",fill:"currentColor",fillRule:"nonzero"}))))}function jS(b,G){const Z=b;for(const tt in G)G.hasOwnProperty(tt)&&(Z[tt]=G[tt]);return Z}var PL=function(G){return function(Z,tt){var ot=Nr.exports.useRef(!1);G(function(){return function(){ot.current=!1}},[]),G(function(){if(!ot.current)ot.current=!0;else return Z()},tt)}},DL=function(G){Nr.exports.useEffect(function(){G==null||G()},[])},OL=DL;let BM=t1();const ii=b=>$0(b,BM);let zM=t1();ii.write=b=>$0(b,zM);let G2=t1();ii.onStart=b=>$0(b,G2);let NM=t1();ii.onFrame=b=>$0(b,NM);let UM=t1();ii.onFinish=b=>$0(b,UM);let Km=[];ii.setTimeout=(b,G)=>{let Z=ii.now()+G,tt=()=>{let ht=Km.findIndex(bt=>bt.cancel==tt);~ht&&Km.splice(ht,1),Wc-=~ht?1:0},ot={time:Z,handler:b,cancel:tt};return Km.splice(XS(Z),0,ot),Wc+=1,YS(),ot};let XS=b=>~(~Km.findIndex(G=>G.time>b)||~Km.length);ii.cancel=b=>{G2.delete(b),NM.delete(b),BM.delete(b),zM.delete(b),UM.delete(b)};ii.sync=b=>{dM=!0,ii.batchedUpdates(b),dM=!1};ii.throttle=b=>{let G;function Z(){try{b(...G)}finally{G=null}}function tt(...ot){G=ot,ii.onStart(Z)}return tt.handler=b,tt.cancel=()=>{G2.delete(Z),G=null},tt};let bM=typeof window!="undefined"?window.requestAnimationFrame:()=>{};ii.use=b=>bM=b;ii.now=typeof performance!="undefined"?()=>performance.now():Date.now;ii.batchedUpdates=b=>b();ii.catch=console.error;ii.frameLoop="always";ii.advance=()=>{ii.frameLoop!=="demand"?console.warn("Cannot call the manual advancement of rafz whilst frameLoop is not set as demand"):qS()};let Vc=-1,Wc=0,dM=!1;function $0(b,G){dM?(G.delete(b),b(0)):(G.add(b),YS())}function YS(){Vc<0&&(Vc=0,ii.frameLoop!=="demand"&&bM(ZS))}function FL(){Vc=-1}function ZS(){~Vc&&(bM(ZS),ii.batchedUpdates(qS))}function qS(){let b=Vc;Vc=ii.now();let G=XS(Vc);G&&(JS(Km.splice(0,G),Z=>Z.handler()),Wc-=G),G2.flush(),BM.flush(b?Math.min(64,Vc-b):16.667),NM.flush(),zM.flush(),UM.flush(),Wc||FL()}function t1(){let b=new Set,G=b;return{add(Z){Wc+=G==b&&!b.has(Z)?1:0,b.add(Z)},delete(Z){return Wc-=G==b&&b.has(Z)?1:0,b.delete(Z)},flush(Z){G.size&&(b=new Set,Wc-=G.size,JS(G,tt=>tt(Z)&&b.add(tt)),Wc+=b.size,G=b)}}}function JS(b,G){b.forEach(Z=>{try{G(Z)}catch(tt){ii.catch(tt)}})}function mM(){}const BL=(b,G,Z)=>Object.defineProperty(b,G,{value:Z,writable:!0,configurable:!0}),Ne={arr:Array.isArray,obj:b=>!!b&&b.constructor.name==="Object",fun:b=>typeof b=="function",str:b=>typeof b=="string",num:b=>typeof b=="number",und:b=>b===void 0};function _h(b,G){if(Ne.arr(b)){if(!Ne.arr(G)||b.length!==G.length)return!1;for(let Z=0;Z<b.length;Z++)if(b[Z]!==G[Z])return!1;return!0}return b===G}const wi=(b,G)=>b.forEach(G);function ml(b,G,Z){if(Ne.arr(b)){for(let tt=0;tt<b.length;tt++)G.call(Z,b[tt],`${tt}`);return}for(const tt in b)b.hasOwnProperty(tt)&&G.call(Z,b[tt],tt)}const Js=b=>Ne.und(b)?[]:Ne.arr(b)?b:[b];function H0(b,G){if(b.size){const Z=Array.from(b);b.clear(),wi(Z,G)}}const b0=(b,...G)=>H0(b,Z=>Z(...G)),QS=()=>typeof window=="undefined"||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent);let kM,KS,jc=null,$S=!1,HM=mM;const zL=b=>{b.to&&(KS=b.to),b.now&&(ii.now=b.now),b.colors!==void 0&&(jc=b.colors),b.skipAnimation!=null&&($S=b.skipAnimation),b.createStringInterpolator&&(kM=b.createStringInterpolator),b.requestAnimationFrame&&ii.use(b.requestAnimationFrame),b.batchedUpdates&&(ii.batchedUpdates=b.batchedUpdates),b.willAdvance&&(HM=b.willAdvance),b.frameLoop&&(ii.frameLoop=b.frameLoop)};var gl=Object.freeze({__proto__:null,get createStringInterpolator(){return kM},get to(){return KS},get colors(){return jc},get skipAnimation(){return $S},get willAdvance(){return HM},assign:zL});const G0=new Set;let La=[],nM=[],F2=0;const V2={get idle(){return!G0.size&&!La.length},start(b){F2>b.priority?(G0.add(b),ii.onStart(NL)):(tI(b),ii(gM))},advance:gM,sort(b){if(F2)ii.onFrame(()=>V2.sort(b));else{const G=La.indexOf(b);~G&&(La.splice(G,1),eI(b))}},clear(){La=[],G0.clear()}};function NL(){G0.forEach(tI),G0.clear(),ii(gM)}function tI(b){La.includes(b)||eI(b)}function eI(b){La.splice(UL(La,G=>G.priority>b.priority),0,b)}function gM(b){const G=nM;for(let Z=0;Z<La.length;Z++){const tt=La[Z];F2=tt.priority,tt.idle||(HM(tt),tt.advance(b),tt.idle||G.push(tt))}return F2=0,nM=La,nM.length=0,La=G,La.length>0}function UL(b,G){const Z=b.findIndex(G);return Z<0?b.length:Z}const bL={transparent:0,aliceblue:4042850303,antiquewhite:4209760255,aqua:16777215,aquamarine:2147472639,azure:4043309055,beige:4126530815,bisque:4293182719,black:255,blanchedalmond:4293643775,blue:65535,blueviolet:2318131967,brown:2771004159,burlywood:3736635391,burntsienna:3934150143,cadetblue:1604231423,chartreuse:2147418367,chocolate:3530104575,coral:4286533887,cornflowerblue:1687547391,cornsilk:4294499583,crimson:3692313855,cyan:16777215,darkblue:35839,darkcyan:9145343,darkgoldenrod:3095792639,darkgray:2846468607,darkgreen:6553855,darkgrey:2846468607,darkkhaki:3182914559,darkmagenta:2332068863,darkolivegreen:1433087999,darkorange:4287365375,darkorchid:2570243327,darkred:2332033279,darksalmon:3918953215,darkseagreen:2411499519,darkslateblue:1211993087,darkslategray:793726975,darkslategrey:793726975,darkturquoise:13554175,darkviolet:2483082239,deeppink:4279538687,deepskyblue:12582911,dimgray:1768516095,dimgrey:1768516095,dodgerblue:512819199,firebrick:2988581631,floralwhite:4294635775,forestgreen:579543807,fuchsia:4278255615,gainsboro:3705462015,ghostwhite:4177068031,gold:4292280575,goldenrod:3668254975,gray:2155905279,green:8388863,greenyellow:2919182335,grey:2155905279,honeydew:4043305215,hotpink:4285117695,indianred:3445382399,indigo:1258324735,ivory:4294963455,khaki:4041641215,lavender:3873897215,lavenderblush:4293981695,lawngreen:2096890111,lemonchiffon:4294626815,lightblue:2916673279,lightcoral:4034953471,lightcyan:3774873599,lightgoldenrodyellow:4210742015,lightgray:3553874943,lightgreen:2431553791,lightgrey:3553874943,lightpink:4290167295,lightsalmon:4288707327,lightseagreen:548580095,lightskyblue:2278488831,lightslategray:2005441023,lightslategrey:2005441023,lightsteelblue:2965692159,lightyellow:4294959359,lime:16711935,limegreen:852308735,linen:4210091775,magenta:4278255615,maroon:2147483903,mediumaquamarine:1724754687,mediumblue:52735,mediumorchid:3126187007,mediumpurple:2473647103,mediumseagreen:1018393087,mediumslateblue:2070474495,mediumspringgreen:16423679,mediumturquoise:1221709055,mediumvioletred:3340076543,midnightblue:421097727,mintcream:4127193855,mistyrose:4293190143,moccasin:4293178879,navajowhite:4292783615,navy:33023,oldlace:4260751103,olive:2155872511,olivedrab:1804477439,orange:4289003775,orangered:4282712319,orchid:3664828159,palegoldenrod:4008225535,palegreen:2566625535,paleturquoise:2951671551,palevioletred:3681588223,papayawhip:4293907967,peachpuff:4292524543,peru:3448061951,pink:4290825215,plum:3718307327,powderblue:2967529215,purple:2147516671,rebeccapurple:1714657791,red:4278190335,rosybrown:3163525119,royalblue:1097458175,saddlebrown:2336560127,salmon:4202722047,sandybrown:4104413439,seagreen:780883967,seashell:4294307583,sienna:2689740287,silver:3233857791,skyblue:2278484991,slateblue:1784335871,slategray:1887473919,slategrey:1887473919,snow:4294638335,springgreen:16744447,steelblue:1182971135,tan:3535047935,teal:8421631,thistle:3636451583,tomato:4284696575,turquoise:1088475391,violet:4001558271,wheat:4125012991,white:4294967295,whitesmoke:4126537215,yellow:4294902015,yellowgreen:2597139199},wu="[-+]?\\d*\\.?\\d+",B2=wu+"%";function W2(...b){return"\\(\\s*("+b.join(")\\s*,\\s*(")+")\\s*\\)"}const kL=new RegExp("rgb"+W2(wu,wu,wu)),HL=new RegExp("rgba"+W2(wu,wu,wu,wu)),GL=new RegExp("hsl"+W2(wu,B2,B2)),VL=new RegExp("hsla"+W2(wu,B2,B2,wu)),WL=/^#([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,jL=/^#([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,XL=/^#([0-9a-fA-F]{6})$/,YL=/^#([0-9a-fA-F]{8})$/;function ZL(b){let G;return typeof b=="number"?b>>>0===b&&b>=0&&b<=4294967295?b:null:(G=XL.exec(b))?parseInt(G[1]+"ff",16)>>>0:jc&&jc[b]!==void 0?jc[b]:(G=kL.exec(b))?(qm(G[1])<<24|qm(G[2])<<16|qm(G[3])<<8|255)>>>0:(G=HL.exec(b))?(qm(G[1])<<24|qm(G[2])<<16|qm(G[3])<<8|pS(G[4]))>>>0:(G=WL.exec(b))?parseInt(G[1]+G[1]+G[2]+G[2]+G[3]+G[3]+"ff",16)>>>0:(G=YL.exec(b))?parseInt(G[1],16)>>>0:(G=jL.exec(b))?parseInt(G[1]+G[1]+G[2]+G[2]+G[3]+G[3]+G[4]+G[4],16)>>>0:(G=GL.exec(b))?(cS(fS(G[1]),T2(G[2]),T2(G[3]))|255)>>>0:(G=VL.exec(b))?(cS(fS(G[1]),T2(G[2]),T2(G[3]))|pS(G[4]))>>>0:null}function oM(b,G,Z){return Z<0&&(Z+=1),Z>1&&(Z-=1),Z<1/6?b+(G-b)*6*Z:Z<1/2?G:Z<2/3?b+(G-b)*(2/3-Z)*6:b}function cS(b,G,Z){const tt=Z<.5?Z*(1+G):Z+G-Z*G,ot=2*Z-tt,ht=oM(ot,tt,b+1/3),bt=oM(ot,tt,b),se=oM(ot,tt,b-1/3);return Math.round(ht*255)<<24|Math.round(bt*255)<<16|Math.round(se*255)<<8}function qm(b){const G=parseInt(b,10);return G<0?0:G>255?255:G}function fS(b){return(parseFloat(b)%360+360)%360/360}function pS(b){const G=parseFloat(b);return G<0?0:G>1?255:Math.round(G*255)}function T2(b){const G=parseFloat(b);return G<0?0:G>100?1:G/100}function dS(b){let G=ZL(b);if(G===null)return b;G=G||0;let Z=(G&4278190080)>>>24,tt=(G&16711680)>>>16,ot=(G&65280)>>>8,ht=(G&255)/255;return`rgba(${Z}, ${tt}, ${ot}, ${ht})`}const X0=(b,G,Z)=>{if(Ne.fun(b))return b;if(Ne.arr(b))return X0({range:b,output:G,extrapolate:Z});if(Ne.str(b.output[0]))return kM(b);const tt=b,ot=tt.output,ht=tt.range||[0,1],bt=tt.extrapolateLeft||tt.extrapolate||"extend",se=tt.extrapolateRight||tt.extrapolate||"extend",Ot=tt.easing||(Jt=>Jt);return Jt=>{const le=JL(Jt,ht);return qL(Jt,ht[le],ht[le+1],ot[le],ot[le+1],Ot,bt,se,tt.map)}};function qL(b,G,Z,tt,ot,ht,bt,se,Ot){let Jt=Ot?Ot(b):b;if(Jt<G){if(bt==="identity")return Jt;bt==="clamp"&&(Jt=G)}if(Jt>Z){if(se==="identity")return Jt;se==="clamp"&&(Jt=Z)}return tt===ot?tt:G===Z?b<=G?tt:ot:(G===-1/0?Jt=-Jt:Z===1/0?Jt=Jt-G:Jt=(Jt-G)/(Z-G),Jt=ht(Jt),tt===-1/0?Jt=-Jt:ot===1/0?Jt=Jt+tt:Jt=Jt*(ot-tt)+tt,Jt)}function JL(b,G){for(var Z=1;Z<G.length-1&&!(G[Z]>=b);++Z);return Z-1}function vM(){return vM=Object.assign||function(b){for(var G=1;G<arguments.length;G++){var Z=arguments[G];for(var tt in Z)Object.prototype.hasOwnProperty.call(Z,tt)&&(b[tt]=Z[tt])}return b},vM.apply(this,arguments)}const tg=Symbol.for("FluidValue.get"),Xp=Symbol.for("FluidValue.observers"),Ea=b=>Boolean(b&&b[tg]),Ss=b=>b&&b[tg]?b[tg]():b,mS=b=>b[Xp]||null;function QL(b,G){b.eventObserved?b.eventObserved(G):b(G)}function Y0(b,G){let Z=b[Xp];Z&&Z.forEach(tt=>{QL(tt,G)})}class rI{constructor(G){if(this[tg]=void 0,this[Xp]=void 0,!G&&!(G=this.get))throw Error("Unknown getter");KL(this,G)}}const KL=(b,G)=>iI(b,tg,G);function ig(b,G){if(b[tg]){let Z=b[Xp];Z||iI(b,Xp,Z=new Set),Z.has(G)||(Z.add(G),b.observerAdded&&b.observerAdded(Z.size,G))}return G}function Z0(b,G){let Z=b[Xp];if(Z&&Z.has(G)){const tt=Z.size-1;tt?Z.delete(G):b[Xp]=null,b.observerRemoved&&b.observerRemoved(tt,G)}}const iI=(b,G,Z)=>Object.defineProperty(b,G,{value:Z,writable:!0,configurable:!0}),R2=/[+\-]?(?:0|[1-9]\d*)(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,$L=/(#(?:[0-9a-f]{2}){2,4}|(#[0-9a-f]{3})|(rgb|hsl)a?\((-?\d+%?[,\s]+){2,3}\s*[\d\.]+%?\))/gi,gS=new RegExp(`(${R2.source})(%|[a-z]+)`,"i"),tR=/rgba\(([0-9\.-]+), ([0-9\.-]+), ([0-9\.-]+), ([0-9\.-]+)\)/gi,j2=/var\((--[a-zA-Z0-9-_]+),? ?([a-zA-Z0-9 ()%#.,-]+)?\)/,nI=b=>{const[G,Z]=eR(b);if(!G||QS())return b;const tt=window.getComputedStyle(document.documentElement).getPropertyValue(G);if(tt)return tt.trim();if(Z&&Z.startsWith("--")){const ot=window.getComputedStyle(document.documentElement).getPropertyValue(Z);return ot||b}else{if(Z&&j2.test(Z))return nI(Z);if(Z)return Z}return b},eR=b=>{const G=j2.exec(b);if(!G)return[,];const[,Z,tt]=G;return[Z,tt]};let sM;const rR=(b,G,Z,tt,ot)=>`rgba(${Math.round(G)}, ${Math.round(Z)}, ${Math.round(tt)}, ${ot})`,oI=b=>{sM||(sM=jc?new RegExp(`(${Object.keys(jc).join("|")})(?!\\w)`,"g"):/^\b$/);const G=b.output.map(ht=>Ss(ht).replace(j2,nI).replace($L,dS).replace(sM,dS)),Z=G.map(ht=>ht.match(R2).map(Number)),ot=Z[0].map((ht,bt)=>Z.map(se=>{if(!(bt in se))throw Error('The arity of each "output" value must be equal');return se[bt]})).map(ht=>X0(vM({},b,{output:ht})));return ht=>{var bt;const se=!gS.test(G[0])&&((bt=G.find(Jt=>gS.test(Jt)))==null?void 0:bt.replace(R2,""));let Ot=0;return G[0].replace(R2,()=>`${ot[Ot++](ht)}${se||""}`).replace(tR,rR)}},GM="react-spring: ",sI=b=>{const G=b;let Z=!1;if(typeof G!="function")throw new TypeError(`${GM}once requires a function parameter`);return(...tt)=>{Z||(G(...tt),Z=!0)}},iR=sI(console.warn);function nR(){iR(`${GM}The "interpolate" function is deprecated in v9 (use "to" instead)`)}const oR=sI(console.warn);function sR(){oR(`${GM}Directly calling start instead of using the api object is deprecated in v9 (use ".start" instead), this will be removed in later 0.X.0 versions`)}function X2(b){return Ne.str(b)&&(b[0]=="#"||/\d/.test(b)||!QS()&&j2.test(b)||b in(jc||{}))}const VM=typeof window!="undefined"&&window.document&&window.document.createElement?Nr.exports.useLayoutEffect:Nr.exports.useEffect,aR=()=>{const b=Nr.exports.useRef(!1);return VM(()=>(b.current=!0,()=>{b.current=!1}),[]),b};function aI(){const b=Nr.exports.useState()[1],G=aR();return()=>{G.current&&b(Math.random())}}function uR(b,G){const[Z]=Nr.exports.useState(()=>({inputs:G,result:b()})),tt=Nr.exports.useRef(),ot=tt.current;let ht=ot;return ht?Boolean(G&&ht.inputs&&lR(G,ht.inputs))||(ht={inputs:G,result:b()}):ht=Z,Nr.exports.useEffect(()=>{tt.current=ht,ot==Z&&(Z.inputs=Z.result=void 0)},[ht]),ht.result}function lR(b,G){if(b.length!==G.length)return!1;for(let Z=0;Z<b.length;Z++)if(b[Z]!==G[Z])return!1;return!0}const uI=b=>Nr.exports.useEffect(b,hR),hR=[];function vS(b){const G=Nr.exports.useRef();return Nr.exports.useEffect(()=>{G.current=b}),G.current}const q0=Symbol.for("Animated:node"),cR=b=>!!b&&b[q0]===b,dl=b=>b&&b[q0],WM=(b,G)=>BL(b,q0,G),Y2=b=>b&&b[q0]&&b[q0].getPayload();class lI{constructor(){this.payload=void 0,WM(this,this)}getPayload(){return this.payload||[]}}class ng extends lI{constructor(G){super(),this.done=!0,this.elapsedTime=void 0,this.lastPosition=void 0,this.lastVelocity=void 0,this.v0=void 0,this.durationProgress=0,this._value=G,Ne.num(this._value)&&(this.lastPosition=this._value)}static create(G){return new ng(G)}getPayload(){return[this]}getValue(){return this._value}setValue(G,Z){return Ne.num(G)&&(this.lastPosition=G,Z&&(G=Math.round(G/Z)*Z,this.done&&(this.lastPosition=G))),this._value===G?!1:(this._value=G,!0)}reset(){const{done:G}=this;this.done=!1,Ne.num(this._value)&&(this.elapsedTime=0,this.durationProgress=0,this.lastPosition=this._value,G&&(this.lastVelocity=null),this.v0=null)}}class eg extends ng{constructor(G){super(0),this._string=null,this._toString=void 0,this._toString=X0({output:[G,G]})}static create(G){return new eg(G)}getValue(){let G=this._string;return G==null?this._string=this._toString(this._value):G}setValue(G){if(Ne.str(G)){if(G==this._string)return!1;this._string=G,this._value=1}else if(super.setValue(G))this._string=null;else return!1;return!0}reset(G){G&&(this._toString=X0({output:[this.getValue(),G]})),this._value=0,super.reset()}}const z2={dependencies:null};class Z2 extends lI{constructor(G){super(),this.source=G,this.setValue(G)}getValue(G){const Z={};return ml(this.source,(tt,ot)=>{cR(tt)?Z[ot]=tt.getValue(G):Ea(tt)?Z[ot]=Ss(tt):G||(Z[ot]=tt)}),Z}setValue(G){this.source=G,this.payload=this._makePayload(G)}reset(){this.payload&&wi(this.payload,G=>G.reset())}_makePayload(G){if(G){const Z=new Set;return ml(G,this._addToPayload,Z),Array.from(Z)}}_addToPayload(G){z2.dependencies&&Ea(G)&&z2.dependencies.add(G);const Z=Y2(G);Z&&wi(Z,tt=>this.add(tt))}}class jM extends Z2{constructor(G){super(G)}static create(G){return new jM(G)}getValue(){return this.source.map(G=>G.getValue())}setValue(G){const Z=this.getPayload();return G.length==Z.length?Z.map((tt,ot)=>tt.setValue(G[ot])).some(Boolean):(super.setValue(G.map(fR)),!0)}}function fR(b){return(X2(b)?eg:ng).create(b)}function yM(b){const G=dl(b);return G?G.constructor:Ne.arr(b)?jM:X2(b)?eg:ng}function N2(){return N2=Object.assign||function(b){for(var G=1;G<arguments.length;G++){var Z=arguments[G];for(var tt in Z)Object.prototype.hasOwnProperty.call(Z,tt)&&(b[tt]=Z[tt])}return b},N2.apply(this,arguments)}const yS=(b,G)=>{const Z=!Ne.fun(b)||b.prototype&&b.prototype.isReactComponent;return Nr.exports.forwardRef((tt,ot)=>{const ht=Nr.exports.useRef(null),bt=Z&&Nr.exports.useCallback(ye=>{ht.current=mR(ot,ye)},[ot]),[se,Ot]=dR(tt,G),Jt=aI(),le=()=>{const ye=ht.current;if(Z&&!ye)return;(ye?G.applyAnimatedValues(ye,se.getValue(!0)):!1)===!1&&Jt()},jt=new pR(le,Ot),pe=Nr.exports.useRef();VM(()=>(pe.current=jt,wi(Ot,ye=>ig(ye,jt)),()=>{pe.current&&(wi(pe.current.deps,ye=>Z0(ye,pe.current)),ii.cancel(pe.current.update))})),Nr.exports.useEffect(le,[]),uI(()=>()=>{const ye=pe.current;wi(ye.deps,dt=>Z0(dt,ye))});const He=G.getComponentProps(se.getValue());return Nr.exports.createElement(b,N2({},He,{ref:bt}))})};class pR{constructor(G,Z){this.update=G,this.deps=Z}eventObserved(G){G.type=="change"&&ii.write(this.update)}}function dR(b,G){const Z=new Set;return z2.dependencies=Z,b.style&&(b=N2({},b,{style:G.createAnimatedStyle(b.style)})),b=new Z2(b),z2.dependencies=null,[b,Z]}function mR(b,G){return b&&(Ne.fun(b)?b(G):b.current=G),G}const xS=Symbol.for("AnimatedComponent"),gR=(b,{applyAnimatedValues:G=()=>!1,createAnimatedStyle:Z=ot=>new Z2(ot),getComponentProps:tt=ot=>ot}={})=>{const ot={applyAnimatedValues:G,createAnimatedStyle:Z,getComponentProps:tt},ht=bt=>{const se=AS(bt)||"Anonymous";return Ne.str(bt)?bt=ht[bt]||(ht[bt]=yS(bt,ot)):bt=bt[xS]||(bt[xS]=yS(bt,ot)),bt.displayName=`Animated(${se})`,bt};return ml(b,(bt,se)=>{Ne.arr(b)&&(se=AS(bt)),ht[se]=ht(bt)}),{animated:ht}},AS=b=>Ne.str(b)?b:b&&Ne.str(b.displayName)?b.displayName:Ne.fun(b)&&b.name||null;function vo(){return vo=Object.assign||function(b){for(var G=1;G<arguments.length;G++){var Z=arguments[G];for(var tt in Z)Object.prototype.hasOwnProperty.call(Z,tt)&&(b[tt]=Z[tt])}return b},vo.apply(this,arguments)}function Wp(b,...G){return Ne.fun(b)?b(...G):b}const V0=(b,G)=>b===!0||!!(G&&b&&(Ne.fun(b)?b(G):Js(b).includes(G))),hI=(b,G)=>Ne.obj(b)?G&&b[G]:b,cI=(b,G)=>b.default===!0?b[G]:b.default?b.default[G]:void 0,vR=b=>b,XM=(b,G=vR)=>{let Z=yR;b.default&&b.default!==!0&&(b=b.default,Z=Object.keys(b));const tt={};for(const ot of Z){const ht=G(b[ot],ot);Ne.und(ht)||(tt[ot]=ht)}return tt},yR=["config","onProps","onStart","onChange","onPause","onResume","onRest"],xR={config:1,from:1,to:1,ref:1,loop:1,reset:1,pause:1,cancel:1,reverse:1,immediate:1,default:1,delay:1,onProps:1,onStart:1,onChange:1,onPause:1,onResume:1,onRest:1,onResolve:1,items:1,trail:1,sort:1,expires:1,initial:1,enter:1,update:1,leave:1,children:1,onDestroyed:1,keys:1,callId:1,parentId:1};function AR(b){const G={};let Z=0;if(ml(b,(tt,ot)=>{xR[ot]||(G[ot]=tt,Z++)}),Z)return G}function fI(b){const G=AR(b);if(G){const Z={to:G};return ml(b,(tt,ot)=>ot in G||(Z[ot]=tt)),Z}return vo({},b)}function J0(b){return b=Ss(b),Ne.arr(b)?b.map(J0):X2(b)?gl.createStringInterpolator({range:[0,1],output:[b,b]})(1):b}function _R(b){for(const G in b)return!0;return!1}function xM(b){return Ne.fun(b)||Ne.arr(b)&&Ne.obj(b[0])}function wR(b,G){var Z;(Z=b.ref)==null||Z.delete(b),G==null||G.delete(b)}function MR(b,G){if(G&&b.ref!==G){var Z;(Z=b.ref)==null||Z.delete(b),G.add(b),b.ref=G}}const CR={default:{tension:170,friction:26},gentle:{tension:120,friction:14},wobbly:{tension:180,friction:12},stiff:{tension:210,friction:20},slow:{tension:280,friction:60},molasses:{tension:280,friction:120}},U2=1.70158,S2=U2*1.525,_S=U2+1,wS=2*Math.PI/3,MS=2*Math.PI/4.5,I2=b=>b<1/2.75?7.5625*b*b:b<2/2.75?7.5625*(b-=1.5/2.75)*b+.75:b<2.5/2.75?7.5625*(b-=2.25/2.75)*b+.9375:7.5625*(b-=2.625/2.75)*b+.984375,TR={linear:b=>b,easeInQuad:b=>b*b,easeOutQuad:b=>1-(1-b)*(1-b),easeInOutQuad:b=>b<.5?2*b*b:1-Math.pow(-2*b+2,2)/2,easeInCubic:b=>b*b*b,easeOutCubic:b=>1-Math.pow(1-b,3),easeInOutCubic:b=>b<.5?4*b*b*b:1-Math.pow(-2*b+2,3)/2,easeInQuart:b=>b*b*b*b,easeOutQuart:b=>1-Math.pow(1-b,4),easeInOutQuart:b=>b<.5?8*b*b*b*b:1-Math.pow(-2*b+2,4)/2,easeInQuint:b=>b*b*b*b*b,easeOutQuint:b=>1-Math.pow(1-b,5),easeInOutQuint:b=>b<.5?16*b*b*b*b*b:1-Math.pow(-2*b+2,5)/2,easeInSine:b=>1-Math.cos(b*Math.PI/2),easeOutSine:b=>Math.sin(b*Math.PI/2),easeInOutSine:b=>-(Math.cos(Math.PI*b)-1)/2,easeInExpo:b=>b===0?0:Math.pow(2,10*b-10),easeOutExpo:b=>b===1?1:1-Math.pow(2,-10*b),easeInOutExpo:b=>b===0?0:b===1?1:b<.5?Math.pow(2,20*b-10)/2:(2-Math.pow(2,-20*b+10))/2,easeInCirc:b=>1-Math.sqrt(1-Math.pow(b,2)),easeOutCirc:b=>Math.sqrt(1-Math.pow(b-1,2)),easeInOutCirc:b=>b<.5?(1-Math.sqrt(1-Math.pow(2*b,2)))/2:(Math.sqrt(1-Math.pow(-2*b+2,2))+1)/2,easeInBack:b=>_S*b*b*b-U2*b*b,easeOutBack:b=>1+_S*Math.pow(b-1,3)+U2*Math.pow(b-1,2),easeInOutBack:b=>b<.5?Math.pow(2*b,2)*((S2+1)*2*b-S2)/2:(Math.pow(2*b-2,2)*((S2+1)*(b*2-2)+S2)+2)/2,easeInElastic:b=>b===0?0:b===1?1:-Math.pow(2,10*b-10)*Math.sin((b*10-10.75)*wS),easeOutElastic:b=>b===0?0:b===1?1:Math.pow(2,-10*b)*Math.sin((b*10-.75)*wS)+1,easeInOutElastic:b=>b===0?0:b===1?1:b<.5?-(Math.pow(2,20*b-10)*Math.sin((20*b-11.125)*MS))/2:Math.pow(2,-20*b+10)*Math.sin((20*b-11.125)*MS)/2+1,easeInBounce:b=>1-I2(1-b),easeOutBounce:I2,easeInOutBounce:b=>b<.5?(1-I2(1-2*b))/2:(1+I2(2*b-1))/2},AM=vo({},CR.default,{mass:1,damping:1,easing:TR.linear,clamp:!1});class SR{constructor(){this.tension=void 0,this.friction=void 0,this.frequency=void 0,this.damping=void 0,this.mass=void 0,this.velocity=0,this.restVelocity=void 0,this.precision=void 0,this.progress=void 0,this.duration=void 0,this.easing=void 0,this.clamp=void 0,this.bounce=void 0,this.decay=void 0,this.round=void 0,Object.assign(this,AM)}}function IR(b,G,Z){Z&&(Z=vo({},Z),CS(Z,G),G=vo({},Z,G)),CS(b,G),Object.assign(b,G);for(const bt in AM)b[bt]==null&&(b[bt]=AM[bt]);let{mass:tt,frequency:ot,damping:ht}=b;return Ne.und(ot)||(ot<.01&&(ot=.01),ht<0&&(ht=0),b.tension=Math.pow(2*Math.PI/ot,2)*tt,b.friction=4*Math.PI*ht*tt/ot),b}function CS(b,G){if(!Ne.und(G.decay))b.duration=void 0;else{const Z=!Ne.und(G.tension)||!Ne.und(G.friction);(Z||!Ne.und(G.frequency)||!Ne.und(G.damping)||!Ne.und(G.mass))&&(b.duration=void 0,b.decay=void 0),Z&&(b.frequency=void 0)}}const TS=[];class ER{constructor(){this.changed=!1,this.values=TS,this.toValues=null,this.fromValues=TS,this.to=void 0,this.from=void 0,this.config=new SR,this.immediate=!1}}function pI(b,{key:G,props:Z,defaultProps:tt,state:ot,actions:ht}){return new Promise((bt,se)=>{var Ot;let Jt,le,jt=V0((Ot=Z.cancel)!=null?Ot:tt==null?void 0:tt.cancel,G);if(jt)ye();else{Ne.und(Z.pause)||(ot.paused=V0(Z.pause,G));let dt=tt==null?void 0:tt.pause;dt!==!0&&(dt=ot.paused||V0(dt,G)),Jt=Wp(Z.delay||0,G),dt?(ot.resumeQueue.add(He),ht.pause()):(ht.resume(),He())}function pe(){ot.resumeQueue.add(He),ot.timeouts.delete(le),le.cancel(),Jt=le.time-ii.now()}function He(){Jt>0&&!gl.skipAnimation?(ot.delayed=!0,le=ii.setTimeout(ye,Jt),ot.pauseQueue.add(pe),ot.timeouts.add(le)):ye()}function ye(){ot.delayed&&(ot.delayed=!1),ot.pauseQueue.delete(pe),ot.timeouts.delete(le),b<=(ot.cancelId||0)&&(jt=!0);try{ht.start(vo({},Z,{callId:b,cancel:jt}),bt)}catch(dt){se(dt)}}})}const YM=(b,G)=>G.length==1?G[0]:G.some(Z=>Z.cancelled)?$m(b.get()):G.every(Z=>Z.noop)?dI(b.get()):_u(b.get(),G.every(Z=>Z.finished)),dI=b=>({value:b,noop:!0,finished:!0,cancelled:!1}),_u=(b,G,Z=!1)=>({value:b,finished:G,cancelled:Z}),$m=b=>({value:b,cancelled:!0,finished:!1});function mI(b,G,Z,tt){const{callId:ot,parentId:ht,onRest:bt}=G,{asyncTo:se,promise:Ot}=Z;return!ht&&b===se&&!G.reset?Ot:Z.promise=(async()=>{Z.asyncId=ot,Z.asyncTo=b;const Jt=XM(G,(Me,vr)=>vr==="onRest"?void 0:Me);let le,jt;const pe=new Promise((Me,vr)=>(le=Me,jt=vr)),He=Me=>{const vr=ot<=(Z.cancelId||0)&&$m(tt)||ot!==Z.asyncId&&_u(tt,!1);if(vr)throw Me.result=vr,jt(Me),Me},ye=(Me,vr)=>{const Tr=new SS,fe=new IS;return(async()=>{if(gl.skipAnimation)throw Q0(Z),fe.result=_u(tt,!1),jt(fe),fe;He(Tr);const Mr=Ne.obj(Me)?vo({},Me):vo({},vr,{to:Me});Mr.parentId=ot,ml(Jt,(xi,fn)=>{Ne.und(Mr[fn])&&(Mr[fn]=xi)});const ui=await tt.start(Mr);return He(Tr),Z.paused&&await new Promise(xi=>{Z.resumeQueue.add(xi)}),ui})()};let dt;if(gl.skipAnimation)return Q0(Z),_u(tt,!1);try{let Me;Ne.arr(b)?Me=(async vr=>{for(const Tr of vr)await ye(Tr)})(b):Me=Promise.resolve(b(ye,tt.stop.bind(tt))),await Promise.all([Me.then(le),pe]),dt=_u(tt.get(),!0,!1)}catch(Me){if(Me instanceof SS)dt=Me.result;else if(Me instanceof IS)dt=Me.result;else throw Me}finally{ot==Z.asyncId&&(Z.asyncId=ht,Z.asyncTo=ht?se:void 0,Z.promise=ht?Ot:void 0)}return Ne.fun(bt)&&ii.batchedUpdates(()=>{bt(dt,tt,tt.item)}),dt})()}function Q0(b,G){H0(b.timeouts,Z=>Z.cancel()),b.pauseQueue.clear(),b.resumeQueue.clear(),b.asyncId=b.asyncTo=b.promise=void 0,G&&(b.cancelId=G)}class SS extends Error{constructor(){super("An async animation has been interrupted. You see this error because you forgot to use `await` or `.catch(...)` on its returned promise."),this.result=void 0}}class IS extends Error{constructor(){super("SkipAnimationSignal"),this.result=void 0}}const _M=b=>b instanceof ZM;let LR=1;class ZM extends rI{constructor(...G){super(...G),this.id=LR++,this.key=void 0,this._priority=0}get priority(){return this._priority}set priority(G){this._priority!=G&&(this._priority=G,this._onPriorityChange(G))}get(){const G=dl(this);return G&&G.getValue()}to(...G){return gl.to(this,G)}interpolate(...G){return nR(),gl.to(this,G)}toJSON(){return this.get()}observerAdded(G){G==1&&this._attach()}observerRemoved(G){G==0&&this._detach()}_attach(){}_detach(){}_onChange(G,Z=!1){Y0(this,{type:"change",parent:this,value:G,idle:Z})}_onPriorityChange(G){this.idle||V2.sort(this),Y0(this,{type:"priority",parent:this,priority:G})}}const Yp=Symbol.for("SpringPhase"),gI=1,wM=2,MM=4,aM=b=>(b[Yp]&gI)>0,Hc=b=>(b[Yp]&wM)>0,O0=b=>(b[Yp]&MM)>0,ES=(b,G)=>G?b[Yp]|=wM|gI:b[Yp]&=~wM,LS=(b,G)=>G?b[Yp]|=MM:b[Yp]&=~MM;class RR extends ZM{constructor(G,Z){if(super(),this.key=void 0,this.animation=new ER,this.queue=void 0,this.defaultProps={},this._state={paused:!1,delayed:!1,pauseQueue:new Set,resumeQueue:new Set,timeouts:new Set},this._pendingCalls=new Set,this._lastCallId=0,this._lastToId=0,this._memoizedDuration=0,!Ne.und(G)||!Ne.und(Z)){const tt=Ne.obj(G)?vo({},G):vo({},Z,{from:G});Ne.und(tt.default)&&(tt.default=!0),this.start(tt)}}get idle(){return!(Hc(this)||this._state.asyncTo)||O0(this)}get goal(){return Ss(this.animation.to)}get velocity(){const G=dl(this);return G instanceof ng?G.lastVelocity||0:G.getPayload().map(Z=>Z.lastVelocity||0)}get hasAnimated(){return aM(this)}get isAnimating(){return Hc(this)}get isPaused(){return O0(this)}get isDelayed(){return this._state.delayed}advance(G){let Z=!0,tt=!1;const ot=this.animation;let{config:ht,toValues:bt}=ot;const se=Y2(ot.to);!se&&Ea(ot.to)&&(bt=Js(Ss(ot.to))),ot.values.forEach((le,jt)=>{if(le.done)return;const pe=le.constructor==eg?1:se?se[jt].lastPosition:bt[jt];let He=ot.immediate,ye=pe;if(!He){if(ye=le.lastPosition,ht.tension<=0){le.done=!0;return}let dt=le.elapsedTime+=G;const Me=ot.fromValues[jt],vr=le.v0!=null?le.v0:le.v0=Ne.arr(ht.velocity)?ht.velocity[jt]:ht.velocity;let Tr;if(Ne.und(ht.duration))if(ht.decay){const fe=ht.decay===!0?.998:ht.decay,Mr=Math.exp(-(1-fe)*dt);ye=Me+vr/(1-fe)*(1-Mr),He=Math.abs(le.lastPosition-ye)<.1,Tr=vr*Mr}else{Tr=le.lastVelocity==null?vr:le.lastVelocity;const fe=ht.precision||(Me==pe?.005:Math.min(1,Math.abs(pe-Me)*.001)),Mr=ht.restVelocity||fe/10,ui=ht.clamp?0:ht.bounce,xi=!Ne.und(ui),fn=Me==pe?le.v0>0:Me<pe;let Ln,Li=!1;const li=1,Oe=Math.ceil(G/li);for(let yn=0;yn<Oe&&(Ln=Math.abs(Tr)>Mr,!(!Ln&&(He=Math.abs(pe-ye)<=fe,He)));++yn){xi&&(Li=ye==pe||ye>pe==fn,Li&&(Tr=-Tr*ui,ye=pe));const Is=-ht.tension*1e-6*(ye-pe),Ks=-ht.friction*.001*Tr,Es=(Is+Ks)/ht.mass;Tr=Tr+Es*li,ye=ye+Tr*li}}else{let fe=1;ht.duration>0&&(this._memoizedDuration!==ht.duration&&(this._memoizedDuration=ht.duration,le.durationProgress>0&&(le.elapsedTime=ht.duration*le.durationProgress,dt=le.elapsedTime+=G)),fe=(ht.progress||0)+dt/this._memoizedDuration,fe=fe>1?1:fe<0?0:fe,le.durationProgress=fe),ye=Me+ht.easing(fe)*(pe-Me),Tr=(ye-le.lastPosition)/G,He=fe==1}le.lastVelocity=Tr,Number.isNaN(ye)&&(console.warn("Got NaN while animating:",this),He=!0)}se&&!se[jt].done&&(He=!1),He?le.done=!0:Z=!1,le.setValue(ye,ht.round)&&(tt=!0)});const Ot=dl(this),Jt=Ot.getValue();if(Z){const le=Ss(ot.to);(Jt!==le||tt)&&!ht.decay?(Ot.setValue(le),this._onChange(le)):tt&&ht.decay&&this._onChange(Jt),this._stop()}else tt&&this._onChange(Jt)}set(G){return ii.batchedUpdates(()=>{this._stop(),this._focus(G),this._set(G)}),this}pause(){this._update({pause:!0})}resume(){this._update({pause:!1})}finish(){if(Hc(this)){const{to:G,config:Z}=this.animation;ii.batchedUpdates(()=>{this._onStart(),Z.decay||this._set(G,!1),this._stop()})}return this}update(G){return(this.queue||(this.queue=[])).push(G),this}start(G,Z){let tt;return Ne.und(G)?(tt=this.queue||[],this.queue=[]):tt=[Ne.obj(G)?G:vo({},Z,{to:G})],Promise.all(tt.map(ot=>this._update(ot))).then(ot=>YM(this,ot))}stop(G){const{to:Z}=this.animation;return this._focus(this.get()),Q0(this._state,G&&this._lastCallId),ii.batchedUpdates(()=>this._stop(Z,G)),this}reset(){this._update({reset:!0})}eventObserved(G){G.type=="change"?this._start():G.type=="priority"&&(this.priority=G.priority+1)}_prepareNode(G){const Z=this.key||"";let{to:tt,from:ot}=G;tt=Ne.obj(tt)?tt[Z]:tt,(tt==null||xM(tt))&&(tt=void 0),ot=Ne.obj(ot)?ot[Z]:ot,ot==null&&(ot=void 0);const ht={to:tt,from:ot};return aM(this)||(G.reverse&&([tt,ot]=[ot,tt]),ot=Ss(ot),Ne.und(ot)?dl(this)||this._set(tt):this._set(ot)),ht}_update(G,Z){let tt=vo({},G);const{key:ot,defaultProps:ht}=this;tt.default&&Object.assign(ht,XM(tt,(Ot,Jt)=>/^on/.test(Jt)?hI(Ot,ot):Ot)),PS(this,tt,"onProps"),B0(this,"onProps",tt,this);const bt=this._prepareNode(tt);if(Object.isFrozen(this))throw Error("Cannot animate a `SpringValue` object that is frozen. Did you forget to pass your component to `animated(...)` before animating its props?");const se=this._state;return pI(++this._lastCallId,{key:ot,props:tt,defaultProps:ht,state:se,actions:{pause:()=>{O0(this)||(LS(this,!0),b0(se.pauseQueue),B0(this,"onPause",_u(this,F0(this,this.animation.to)),this))},resume:()=>{O0(this)&&(LS(this,!1),Hc(this)&&this._resume(),b0(se.resumeQueue),B0(this,"onResume",_u(this,F0(this,this.animation.to)),this))},start:this._merge.bind(this,bt)}}).then(Ot=>{if(tt.loop&&Ot.finished&&!(Z&&Ot.noop)){const Jt=vI(tt);if(Jt)return this._update(Jt,!0)}return Ot})}_merge(G,Z,tt){if(Z.cancel)return this.stop(!0),tt($m(this));const ot=!Ne.und(G.to),ht=!Ne.und(G.from);if(ot||ht)if(Z.callId>this._lastToId)this._lastToId=Z.callId;else return tt($m(this));const{key:bt,defaultProps:se,animation:Ot}=this,{to:Jt,from:le}=Ot;let{to:jt=Jt,from:pe=le}=G;ht&&!ot&&(!Z.default||Ne.und(jt))&&(jt=pe),Z.reverse&&([jt,pe]=[pe,jt]);const He=!_h(pe,le);He&&(Ot.from=pe),pe=Ss(pe);const ye=!_h(jt,Jt);ye&&this._focus(jt);const dt=xM(Z.to),{config:Me}=Ot,{decay:vr,velocity:Tr}=Me;(ot||ht)&&(Me.velocity=0),Z.config&&!dt&&IR(Me,Wp(Z.config,bt),Z.config!==se.config?Wp(se.config,bt):void 0);let fe=dl(this);if(!fe||Ne.und(jt))return tt(_u(this,!0));const Mr=Ne.und(Z.reset)?ht&&!Z.default:!Ne.und(pe)&&V0(Z.reset,bt),ui=Mr?pe:this.get(),xi=J0(jt),fn=Ne.num(xi)||Ne.arr(xi)||X2(xi),Ln=!dt&&(!fn||V0(se.immediate||Z.immediate,bt));if(ye){const yn=yM(jt);if(yn!==fe.constructor)if(Ln)fe=this._set(xi);else throw Error(`Cannot animate between ${fe.constructor.name} and ${yn.name}, as the "to" prop suggests`)}const Li=fe.constructor;let li=Ea(jt),Oe=!1;if(!li){const yn=Mr||!aM(this)&&He;(ye||yn)&&(Oe=_h(J0(ui),xi),li=!Oe),(!_h(Ot.immediate,Ln)&&!Ln||!_h(Me.decay,vr)||!_h(Me.velocity,Tr))&&(li=!0)}if(Oe&&Hc(this)&&(Ot.changed&&!Mr?li=!0:li||this._stop(Jt)),!dt&&((li||Ea(Jt))&&(Ot.values=fe.getPayload(),Ot.toValues=Ea(jt)?null:Li==eg?[1]:Js(xi)),Ot.immediate!=Ln&&(Ot.immediate=Ln,!Ln&&!Mr&&this._set(Jt)),li)){const{onRest:yn}=Ot;wi(DR,Ks=>PS(this,Z,Ks));const Is=_u(this,F0(this,Jt));b0(this._pendingCalls,Is),this._pendingCalls.add(tt),Ot.changed&&ii.batchedUpdates(()=>{Ot.changed=!Mr,yn==null||yn(Is,this),Mr?Wp(se.onRest,Is):Ot.onStart==null||Ot.onStart(Is,this)})}Mr&&this._set(ui),dt?tt(mI(Z.to,Z,this._state,this)):li?this._start():Hc(this)&&!ye?this._pendingCalls.add(tt):tt(dI(ui))}_focus(G){const Z=this.animation;G!==Z.to&&(mS(this)&&this._detach(),Z.to=G,mS(this)&&this._attach())}_attach(){let G=0;const{to:Z}=this.animation;Ea(Z)&&(ig(Z,this),_M(Z)&&(G=Z.priority+1)),this.priority=G}_detach(){const{to:G}=this.animation;Ea(G)&&Z0(G,this)}_set(G,Z=!0){const tt=Ss(G);if(!Ne.und(tt)){const ot=dl(this);if(!ot||!_h(tt,ot.getValue())){const ht=yM(tt);!ot||ot.constructor!=ht?WM(this,ht.create(tt)):ot.setValue(tt),ot&&ii.batchedUpdates(()=>{this._onChange(tt,Z)})}}return dl(this)}_onStart(){const G=this.animation;G.changed||(G.changed=!0,B0(this,"onStart",_u(this,F0(this,G.to)),this))}_onChange(G,Z){Z||(this._onStart(),Wp(this.animation.onChange,G,this)),Wp(this.defaultProps.onChange,G,this),super._onChange(G,Z)}_start(){const G=this.animation;dl(this).reset(Ss(G.to)),G.immediate||(G.fromValues=G.values.map(Z=>Z.lastPosition)),Hc(this)||(ES(this,!0),O0(this)||this._resume())}_resume(){gl.skipAnimation?this.finish():V2.start(this)}_stop(G,Z){if(Hc(this)){ES(this,!1);const tt=this.animation;wi(tt.values,ht=>{ht.done=!0}),tt.toValues&&(tt.onChange=tt.onPause=tt.onResume=void 0),Y0(this,{type:"idle",parent:this});const ot=Z?$m(this.get()):_u(this.get(),F0(this,G!=null?G:tt.to));b0(this._pendingCalls,ot),tt.changed&&(tt.changed=!1,B0(this,"onRest",ot,this))}}}function F0(b,G){const Z=J0(G),tt=J0(b.get());return _h(tt,Z)}function vI(b,G=b.loop,Z=b.to){let tt=Wp(G);if(tt){const ot=tt!==!0&&fI(tt),ht=(ot||b).reverse,bt=!ot||ot.reset;return K0(vo({},b,{loop:G,default:!1,pause:void 0,to:!ht||xM(Z)?Z:void 0,from:bt?b.from:void 0,reset:bt},ot))}}function K0(b){const{to:G,from:Z}=b=fI(b),tt=new Set;return Ne.obj(G)&&RS(G,tt),Ne.obj(Z)&&RS(Z,tt),b.keys=tt.size?Array.from(tt):null,b}function PR(b){const G=K0(b);return Ne.und(G.default)&&(G.default=XM(G)),G}function RS(b,G){ml(b,(Z,tt)=>Z!=null&&G.add(tt))}const DR=["onStart","onRest","onChange","onPause","onResume"];function PS(b,G,Z){b.animation[Z]=G[Z]!==cI(G,Z)?hI(G[Z],b.key):void 0}function B0(b,G,...Z){var tt,ot,ht,bt;(tt=(ot=b.animation)[G])==null||tt.call(ot,...Z),(ht=(bt=b.defaultProps)[G])==null||ht.call(bt,...Z)}const OR=["onStart","onChange","onRest"];let FR=1;class BR{constructor(G,Z){this.id=FR++,this.springs={},this.queue=[],this.ref=void 0,this._flush=void 0,this._initialProps=void 0,this._lastAsyncId=0,this._active=new Set,this._changed=new Set,this._started=!1,this._item=void 0,this._state={paused:!1,pauseQueue:new Set,resumeQueue:new Set,timeouts:new Set},this._events={onStart:new Map,onChange:new Map,onRest:new Map},this._onFrame=this._onFrame.bind(this),Z&&(this._flush=Z),G&&this.start(vo({default:!0},G))}get idle(){return!this._state.asyncTo&&Object.values(this.springs).every(G=>G.idle&&!G.isDelayed&&!G.isPaused)}get item(){return this._item}set item(G){this._item=G}get(){const G={};return this.each((Z,tt)=>G[tt]=Z.get()),G}set(G){for(const Z in G){const tt=G[Z];Ne.und(tt)||this.springs[Z].set(tt)}}update(G){return G&&this.queue.push(K0(G)),this}start(G){let{queue:Z}=this;return G?Z=Js(G).map(K0):this.queue=[],this._flush?this._flush(this,Z):(wI(this,Z),CM(this,Z))}stop(G,Z){if(G!==!!G&&(Z=G),Z){const tt=this.springs;wi(Js(Z),ot=>tt[ot].stop(!!G))}else Q0(this._state,this._lastAsyncId),this.each(tt=>tt.stop(!!G));return this}pause(G){if(Ne.und(G))this.start({pause:!0});else{const Z=this.springs;wi(Js(G),tt=>Z[tt].pause())}return this}resume(G){if(Ne.und(G))this.start({pause:!1});else{const Z=this.springs;wi(Js(G),tt=>Z[tt].resume())}return this}each(G){ml(this.springs,G)}_onFrame(){const{onStart:G,onChange:Z,onRest:tt}=this._events,ot=this._active.size>0,ht=this._changed.size>0;(ot&&!this._started||ht&&!this._started)&&(this._started=!0,H0(G,([Ot,Jt])=>{Jt.value=this.get(),Ot(Jt,this,this._item)}));const bt=!ot&&this._started,se=ht||bt&&tt.size?this.get():null;ht&&Z.size&&H0(Z,([Ot,Jt])=>{Jt.value=se,Ot(Jt,this,this._item)}),bt&&(this._started=!1,H0(tt,([Ot,Jt])=>{Jt.value=se,Ot(Jt,this,this._item)}))}eventObserved(G){if(G.type=="change")this._changed.add(G.parent),G.idle||this._active.add(G.parent);else if(G.type=="idle")this._active.delete(G.parent);else return;ii.onFrame(this._onFrame)}}function CM(b,G){return Promise.all(G.map(Z=>yI(b,Z))).then(Z=>YM(b,Z))}async function yI(b,G,Z){const{keys:tt,to:ot,from:ht,loop:bt,onRest:se,onResolve:Ot}=G,Jt=Ne.obj(G.default)&&G.default;bt&&(G.loop=!1),ot===!1&&(G.to=null),ht===!1&&(G.from=null);const le=Ne.arr(ot)||Ne.fun(ot)?ot:void 0;le?(G.to=void 0,G.onRest=void 0,Jt&&(Jt.onRest=void 0)):wi(OR,dt=>{const Me=G[dt];if(Ne.fun(Me)){const vr=b._events[dt];G[dt]=({finished:Tr,cancelled:fe})=>{const Mr=vr.get(Me);Mr?(Tr||(Mr.finished=!1),fe&&(Mr.cancelled=!0)):vr.set(Me,{value:null,finished:Tr||!1,cancelled:fe||!1})},Jt&&(Jt[dt]=G[dt])}});const jt=b._state;G.pause===!jt.paused?(jt.paused=G.pause,b0(G.pause?jt.pauseQueue:jt.resumeQueue)):jt.paused&&(G.pause=!0);const pe=(tt||Object.keys(b.springs)).map(dt=>b.springs[dt].start(G)),He=G.cancel===!0||cI(G,"cancel")===!0;(le||He&&jt.asyncId)&&pe.push(pI(++b._lastAsyncId,{props:G,state:jt,actions:{pause:mM,resume:mM,start(dt,Me){He?(Q0(jt,b._lastAsyncId),Me($m(b))):(dt.onRest=se,Me(mI(le,dt,jt,b)))}}})),jt.paused&&await new Promise(dt=>{jt.resumeQueue.add(dt)});const ye=YM(b,await Promise.all(pe));if(bt&&ye.finished&&!(Z&&ye.noop)){const dt=vI(G,bt,ot);if(dt)return wI(b,[dt]),yI(b,dt,!0)}return Ot&&ii.batchedUpdates(()=>Ot(ye,b,b.item)),ye}function DS(b,G){const Z=vo({},b.springs);return G&&wi(Js(G),tt=>{Ne.und(tt.keys)&&(tt=K0(tt)),Ne.obj(tt.to)||(tt=vo({},tt,{to:void 0})),_I(Z,tt,ot=>AI(ot))}),xI(b,Z),Z}function xI(b,G){ml(G,(Z,tt)=>{b.springs[tt]||(b.springs[tt]=Z,ig(Z,b))})}function AI(b,G){const Z=new RR;return Z.key=b,G&&ig(Z,G),Z}function _I(b,G,Z){G.keys&&wi(G.keys,tt=>{(b[tt]||(b[tt]=Z(tt)))._prepareNode(G)})}function wI(b,G){wi(G,Z=>{_I(b.springs,Z,tt=>AI(tt,b))})}function zR(b,G){if(b==null)return{};var Z={},tt=Object.keys(b),ot,ht;for(ht=0;ht<tt.length;ht++)ot=tt[ht],!(G.indexOf(ot)>=0)&&(Z[ot]=b[ot]);return Z}const NR=["children"],q2=b=>{let{children:G}=b,Z=zR(b,NR);const tt=Nr.exports.useContext(b2),ot=Z.pause||!!tt.pause,ht=Z.immediate||!!tt.immediate;Z=uR(()=>({pause:ot,immediate:ht}),[ot,ht]);const{Provider:bt}=b2;return Nr.exports.createElement(bt,{value:Z},G)},b2=UR(q2,{});q2.Provider=b2.Provider;q2.Consumer=b2.Consumer;function UR(b,G){return Object.assign(b,Nr.exports.createContext(G)),b.Provider._context=b,b.Consumer._context=b,b}const bR=()=>{const b=[],G=function(ot){sR();const ht=[];return wi(b,(bt,se)=>{if(Ne.und(ot))ht.push(bt.start());else{const Ot=Z(ot,bt,se);Ot&&ht.push(bt.start(Ot))}}),ht};G.current=b,G.add=function(tt){b.includes(tt)||b.push(tt)},G.delete=function(tt){const ot=b.indexOf(tt);~ot&&b.splice(ot,1)},G.pause=function(){return wi(b,tt=>tt.pause(...arguments)),this},G.resume=function(){return wi(b,tt=>tt.resume(...arguments)),this},G.set=function(tt){wi(b,ot=>ot.set(tt))},G.start=function(tt){const ot=[];return wi(b,(ht,bt)=>{if(Ne.und(tt))ot.push(ht.start());else{const se=this._getProps(tt,ht,bt);se&&ot.push(ht.start(se))}}),ot},G.stop=function(){return wi(b,tt=>tt.stop(...arguments)),this},G.update=function(tt){return wi(b,(ot,ht)=>ot.update(this._getProps(tt,ot,ht))),this};const Z=function(ot,ht,bt){return Ne.fun(ot)?ot(bt,ht):ot};return G._getProps=Z,G};function kR(b,G,Z){const tt=Ne.fun(G)&&G;tt&&!Z&&(Z=[]);const ot=Nr.exports.useMemo(()=>tt||arguments.length==3?bR():void 0,[]),ht=Nr.exports.useRef(0),bt=aI(),se=Nr.exports.useMemo(()=>({ctrls:[],queue:[],flush(vr,Tr){const fe=DS(vr,Tr);return ht.current>0&&!se.queue.length&&!Object.keys(fe).some(ui=>!vr.springs[ui])?CM(vr,Tr):new Promise(ui=>{xI(vr,fe),se.queue.push(()=>{ui(CM(vr,Tr))}),bt()})}}),[]),Ot=Nr.exports.useRef([...se.ctrls]),Jt=[],le=vS(b)||0;Nr.exports.useMemo(()=>{wi(Ot.current.slice(b,le),vr=>{wR(vr,ot),vr.stop(!0)}),Ot.current.length=b,jt(le,b)},[b]),Nr.exports.useMemo(()=>{jt(0,Math.min(le,b))},Z);function jt(vr,Tr){for(let fe=vr;fe<Tr;fe++){const Mr=Ot.current[fe]||(Ot.current[fe]=new BR(null,se.flush)),ui=tt?tt(fe,Mr):G[fe];ui&&(Jt[fe]=PR(ui))}}const pe=Ot.current.map((vr,Tr)=>DS(vr,Jt[Tr])),He=Nr.exports.useContext(q2),ye=vS(He),dt=He!==ye&&_R(He);VM(()=>{ht.current++,se.ctrls=Ot.current;const{queue:vr}=se;vr.length&&(se.queue=[],wi(vr,Tr=>Tr())),wi(Ot.current,(Tr,fe)=>{ot==null||ot.add(Tr),dt&&Tr.start({default:He});const Mr=Jt[fe];Mr&&(MR(Tr,Mr.ref),Tr.ref?Tr.queue.push(Mr):Tr.start(Mr))})}),uI(()=>()=>{wi(se.ctrls,vr=>vr.stop(!0))});const Me=pe.map(vr=>vo({},vr));return ot?[Me,ot]:Me}function HR(b,G){const Z=Ne.fun(b),[[tt],ot]=kR(1,Z?b:[b],Z?G||[]:G);return Z||arguments.length==2?[tt,ot]:tt}let OS;(function(b){b.MOUNT="mount",b.ENTER="enter",b.UPDATE="update",b.LEAVE="leave"})(OS||(OS={}));class GR extends ZM{constructor(G,Z){super(),this.key=void 0,this.idle=!0,this.calc=void 0,this._active=new Set,this.source=G,this.calc=X0(...Z);const tt=this._get(),ot=yM(tt);WM(this,ot.create(tt))}advance(G){const Z=this._get(),tt=this.get();_h(Z,tt)||(dl(this).setValue(Z),this._onChange(Z,this.idle)),!this.idle&&FS(this._active)&&uM(this)}_get(){const G=Ne.arr(this.source)?this.source.map(Ss):Js(Ss(this.source));return this.calc(...G)}_start(){this.idle&&!FS(this._active)&&(this.idle=!1,wi(Y2(this),G=>{G.done=!1}),gl.skipAnimation?(ii.batchedUpdates(()=>this.advance()),uM(this)):V2.start(this))}_attach(){let G=1;wi(Js(this.source),Z=>{Ea(Z)&&ig(Z,this),_M(Z)&&(Z.idle||this._active.add(Z),G=Math.max(G,Z.priority+1))}),this.priority=G,this._start()}_detach(){wi(Js(this.source),G=>{Ea(G)&&Z0(G,this)}),this._active.clear(),uM(this)}eventObserved(G){G.type=="change"?G.idle?this.advance():(this._active.add(G.parent),this._start()):G.type=="idle"?this._active.delete(G.parent):G.type=="priority"&&(this.priority=Js(this.source).reduce((Z,tt)=>Math.max(Z,(_M(tt)?tt.priority:0)+1),0))}}function VR(b){return b.idle!==!1}function FS(b){return!b.size||Array.from(b).every(VR)}function uM(b){b.idle||(b.idle=!0,wi(Y2(b),G=>{G.done=!0}),Y0(b,{type:"idle",parent:b}))}gl.assign({createStringInterpolator:oI,to:(b,G)=>new GR(b,G)});function qM(b,G){if(b==null)return{};var Z={},tt=Object.keys(b),ot,ht;for(ht=0;ht<tt.length;ht++)ot=tt[ht],!(G.indexOf(ot)>=0)&&(Z[ot]=b[ot]);return Z}const WR=["style","children","scrollTop","scrollLeft"],MI=/^--/;function jR(b,G){return G==null||typeof G=="boolean"||G===""?"":typeof G=="number"&&G!==0&&!MI.test(b)&&!(W0.hasOwnProperty(b)&&W0[b])?G+"px":(""+G).trim()}const BS={};function XR(b,G){if(!b.nodeType||!b.setAttribute)return!1;const Z=b.nodeName==="filter"||b.parentNode&&b.parentNode.nodeName==="filter",tt=G,{style:ot,children:ht,scrollTop:bt,scrollLeft:se}=tt,Ot=qM(tt,WR),Jt=Object.values(Ot),le=Object.keys(Ot).map(jt=>Z||b.hasAttribute(jt)?jt:BS[jt]||(BS[jt]=jt.replace(/([A-Z])/g,pe=>"-"+pe.toLowerCase())));ht!==void 0&&(b.textContent=ht);for(let jt in ot)if(ot.hasOwnProperty(jt)){const pe=jR(jt,ot[jt]);MI.test(jt)?b.style.setProperty(jt,pe):b.style[jt]=pe}le.forEach((jt,pe)=>{b.setAttribute(jt,Jt[pe])}),bt!==void 0&&(b.scrollTop=bt),se!==void 0&&(b.scrollLeft=se)}let W0={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0};const YR=(b,G)=>b+G.charAt(0).toUpperCase()+G.substring(1),ZR=["Webkit","Ms","Moz","O"];W0=Object.keys(W0).reduce((b,G)=>(ZR.forEach(Z=>b[YR(Z,G)]=b[G]),b),W0);const qR=["x","y","z"],JR=/^(matrix|translate|scale|rotate|skew)/,QR=/^(translate)/,KR=/^(rotate|skew)/,lM=(b,G)=>Ne.num(b)&&b!==0?b+G:b,P2=(b,G)=>Ne.arr(b)?b.every(Z=>P2(Z,G)):Ne.num(b)?b===G:parseFloat(b)===G;class $R extends Z2{constructor(G){let{x:Z,y:tt,z:ot}=G,ht=qM(G,qR);const bt=[],se=[];(Z||tt||ot)&&(bt.push([Z||0,tt||0,ot||0]),se.push(Ot=>[`translate3d(${Ot.map(Jt=>lM(Jt,"px")).join(",")})`,P2(Ot,0)])),ml(ht,(Ot,Jt)=>{if(Jt==="transform")bt.push([Ot||""]),se.push(le=>[le,le===""]);else if(JR.test(Jt)){if(delete ht[Jt],Ne.und(Ot))return;const le=QR.test(Jt)?"px":KR.test(Jt)?"deg":"";bt.push(Js(Ot)),se.push(Jt==="rotate3d"?([jt,pe,He,ye])=>[`rotate3d(${jt},${pe},${He},${lM(ye,le)})`,P2(ye,0)]:jt=>[`${Jt}(${jt.map(pe=>lM(pe,le)).join(",")})`,P2(jt,Jt.startsWith("scale")?1:0)])}}),bt.length&&(ht.transform=new tP(bt,se)),super(ht)}}class tP extends rI{constructor(G,Z){super(),this._value=null,this.inputs=G,this.transforms=Z}get(){return this._value||(this._value=this._get())}_get(){let G="",Z=!0;return wi(this.inputs,(tt,ot)=>{const ht=Ss(tt[0]),[bt,se]=this.transforms[ot](Ne.arr(ht)?ht:tt.map(Ss));G+=" "+bt,Z=Z&&se}),Z?"none":G}observerAdded(G){G==1&&wi(this.inputs,Z=>wi(Z,tt=>Ea(tt)&&ig(tt,this)))}observerRemoved(G){G==0&&wi(this.inputs,Z=>wi(Z,tt=>Ea(tt)&&Z0(tt,this)))}eventObserved(G){G.type=="change"&&(this._value=null),Y0(this,G)}}const eP=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"],rP=["scrollTop","scrollLeft"];gl.assign({batchedUpdates:OM.exports.unstable_batchedUpdates,createStringInterpolator:oI,colors:bL});const iP=gR(eP,{applyAnimatedValues:XR,createAnimatedStyle:b=>new $R(b),getComponentProps:b=>qM(b,rP)}),nP=iP.animated;function oP(b){const G=Nr.exports.useRef(b);return b&&(G.current=!0),!!G.current}function sP(b,G,Z){const tt=oP(b);return G||b?!0:tt?!Z:!1}const aP=PL(TL);function uP(b,G){let Z=0;function tt(ot){Ia.Children.forEach(ot,ht=>{mL.exports.isFragment(ht)?tt(ht.props.children):(G(ht,Z),Z+=1)})}tt(b)}const z0="adm-list",lP={mode:"default"},hP=Nr.exports.forwardRef((b,G)=>{const Z=gL(lP,b),tt=Nr.exports.useRef(null);return Nr.exports.useImperativeHandle(G,()=>({get nativeElement(){return tt.current}})),O2(Z,jp("div",{className:FM(z0,`${z0}-${Z.mode}`),ref:tt,children:[Z.header&&Oi("div",{className:`${z0}-header`,children:Z.header}),Oi("div",{className:`${z0}-body`,children:Oi("div",{className:`${z0}-body-inner`,children:Z.children})})]}))});function N0(b){return b!=null&&b!==!1}const Ah="adm-list-item",cP=b=>{var G;const Z=(G=b.clickable)!==null&&G!==void 0?G:!!b.onClick,tt=b.arrow===void 0?Z:b.arrow,ot=Ia.createElement("div",{className:`${Ah}-content`},N0(b.prefix)&&Ia.createElement("div",{className:`${Ah}-content-prefix`},b.prefix),Ia.createElement("div",{className:`${Ah}-content-main`},N0(b.title)&&Ia.createElement("div",{className:`${Ah}-title`},b.title),b.children,N0(b.description)&&Ia.createElement("div",{className:`${Ah}-description`},b.description)),N0(b.extra)&&Ia.createElement("div",{className:`${Ah}-content-extra`},b.extra),N0(tt)&&Ia.createElement("div",{className:`${Ah}-content-arrow`},tt===!0?Ia.createElement(ML,null):tt));return O2(b,Ia.createElement(Z?"a":"div",{className:FM(`${Ah}`,Z?["adm-plain-anchor"]:[],b.disabled&&`${Ah}-disabled`),onClick:b.disabled?void 0:b.onClick},ot))};var TM=jS(hP,{Item:cP});const Qm="adm-collapse",fP=()=>null,pP=b=>{const{visible:G}=b,Z=Nr.exports.useRef(null),tt=sP(G,b.forceRender,b.destroyOnClose),[{height:ot},ht]=HR(()=>({from:{height:0},config:{precision:.01,mass:1,tension:200,friction:25,clamp:!0}}));return OL(()=>{if(!G)return;const bt=Z.current;!bt||ht.start({height:bt.offsetHeight,immediate:!0})}),aP(()=>{const bt=Z.current;!bt||(G?ht.start({height:bt.offsetHeight}):(ht.start({height:bt.offsetHeight,immediate:!0}),ht.start({height:0})))},[G]),Ia.createElement(nP.div,{className:`${Qm}-panel-content`,style:{height:ot.to(bt=>ot.idle&&G?"auto":bt)}},Oi("div",{className:`${Qm}-panel-content-inner`,ref:Z,children:Oi(TM.Item,{children:tt&&b.children})}))},dP=b=>{var G;const Z=[];uP(b.children,bt=>{!Ia.isValidElement(bt)||typeof bt.key!="string"||Z.push(bt)});const[tt,ot]=SL(b.accordion?{value:b.activeKey===void 0?void 0:b.activeKey===null?[]:[b.activeKey],defaultValue:b.defaultActiveKey===void 0||b.defaultActiveKey===null?[]:[b.defaultActiveKey],onChange:bt=>{var se,Ot;(se=b.onChange)===null||se===void 0||se.call(b,(Ot=bt[0])!==null&&Ot!==void 0?Ot:null)}}:{value:b.activeKey,defaultValue:(G=b.defaultActiveKey)!==null&&G!==void 0?G:[],onChange:b.onChange}),ht=tt===null?[]:Array.isArray(tt)?tt:[tt];return O2(b,Oi("div",{className:Qm,children:Oi(TM,{children:Z.map(bt=>{const se=bt.key,Ot=ht.includes(se);function Jt(jt){var pe,He;b.accordion?ot(Ot?[]:[se]):ot(Ot?ht.filter(ye=>ye!==se):[...ht,se]),(He=(pe=bt.props).onClick)===null||He===void 0||He.call(pe,jt)}const le=()=>{let jt=Oi(EL,{});return b.arrow!==void 0&&(jt=b.arrow),bt.props.arrow!==void 0&&(jt=bt.props.arrow),typeof jt=="function"?jt(Ot):Oi("div",{className:FM(`${Qm}-arrow`,{[`${Qm}-arrow-active`]:Ot}),children:jt})};return jp(vL,{children:[O2(bt.props,Oi(TM.Item,{className:`${Qm}-panel-header`,onClick:Jt,disabled:bt.props.disabled,arrow:le(),children:bt.props.title})),Oi(pP,{visible:Ot,forceRender:!!bt.props.forceRender,destroyOnClose:!!bt.props.destroyOnClose,children:bt.props.children})]})})})}))};var zS=jS(dP,{Panel:fP});const mP=b=>({type:xL,data:b}),gP=b=>G=>{G(mP(!b))},vP=b=>({type:yL,data:b}),yP=()=>b=>{CL().then(G=>{b(vP(G.data.shoplist))})},xP=WS.div`
    text-align: center;
`,AP=WS.div`
.bigbox {
    margin-top: 0.5rem;
    text-align: center;
}
  .sale-box {
    width: 95%;
    height: 8rem;
    background-color: #fff;
    margin: 0 auto;
    margin-bottom: 0.5rem;
    border-radius: 0.5rem;
    box-shadow: 1px 1px 1rem rgba(0,0,0,0.2);
    .left {
        float: left;
        width: 75%;
        text-align: left;
        border-right: 1px solid rgba(0,0,0,0.1);
        .name {
            font-size: 17px;
            font-weight: 500;
            margin: 0.34rem;
        }
        .address {
            margin: 0.7rem 0.34rem;
        }
        .time {
            margin: 0.6rem 0.34rem;
        }
        span {
            font-size: 14px;
            color: #fff;
            display: inline-block;
            width: 3rem;
            height: 1.24rem;
            background-color: red;
            text-align: center;
            line-height: 1.24rem;
            border-radius: 5px;
            margin-top: 0.34rem;
            margin-left: 0.34rem;
        }
    }
    .right {
        float: right;
        .distance {
            margin-right: 0.5rem;
            margin-top: 1.5rem;
        }
        .icon1 {
            font-size: 19px;
            background-color: pink;
            display: inline-block;
            height: 1.5rem;
            width: 1.5rem;
            border-radius: 50%;
            margin-top:1.5rem;
            margin-right: 0.8rem;
        }
        .icon2 {
            font-size: 1.18rem;
            background-color: pink;
            display: inline-block;
            height: 1.5rem;
            width: 1.5rem;
            border-radius: 50%;
            margin-top: 1.5rem;
            margin-right: 0.5rem;
        }
    }
  }
`,_P=({message:b})=>Oi(AP,{children:Oi("div",{className:"bigbox",children:(()=>b.map(Z=>Oi(AL,{className:"milkTeaList",to:`/orderdetail/${Z.id}`,children:jp("div",{className:"sale-box",children:[jp("div",{className:"left",children:[Oi("div",{className:"name",children:Z.name}),Oi("div",{className:"address",children:Z.address}),Oi("div",{className:"time",children:Z.time}),Oi("span",{children:"\u8425\u4E1A\u4E2D"})]}),jp("div",{className:"right",children:[Oi("div",{className:"distance",children:Z.distance}),Oi("span",{className:"icon1",children:Oi(hS,{wrap:!0,style:{fontSize:18},children:Oi(RL,{color:"var(--adm-color-danger)"})})}),Oi("span",{className:"icon2",children:Oi(hS,{wrap:!0,style:{fontSize:18},children:Oi(LL,{color:"var(--adm-color-danger)"})})})]})]},Z.id)},Z.id)))()})});var k0={},Qi=_L(IL);window._hmt=window._hmt||[];(function(){var b=document.createElement("script");b.src="https://hm.baidu.com/hm.js?b97569d26a525941d8d163729d284198";var G=document.getElementsByTagName("script")[0];G.parentNode.insertBefore(b,G)})();var Qs={},Wo={},Eo={};Object.defineProperty(Eo,"__esModule",{value:!0});Eo.toggleMethods=Eo.unregisterEvents=Eo.registerEvents=void 0;var wP=Qi,SM=wP.__importDefault(Mu);function IM(b,G,Z){Z&&G&&G.addEventListener&&(b.registeredEvents={},Z.forEach(function(tt){var ot="on"+tt.substr(0,1).toUpperCase()+tt.substr(1);b.props[ot]&&typeof b.props[ot]=="function"&&(G.addEventListener(tt,b.props[ot]),b.registeredEvents[tt]=b.props[ot])}))}Eo.registerEvents=IM;function EM(b,G){b.registeredEvents&&G&&G.removeEventListener&&(Object.keys(b.registeredEvents).forEach(function(Z){G.removeEventListener(Z,b.registeredEvents[Z])}),b.registeredEvents=null)}Eo.unregisterEvents=EM;function LM(b,G,Z,tt){Z&&G&&Object.keys(Z).forEach(function(ot){(tt===void 0&&b.props[ot]!==void 0||tt!==void 0&&!SM.default(b.props[ot],tt[ot]))&&(b.props[ot]?G&&G[Z[ot][0]]():G&&G[Z[ot][1]]())})}Eo.toggleMethods=LM;function MP(b,G){var Z=b.prototype.getInstance,tt=b.prototype.componentDidMount,ot=b.prototype.componentDidUpdate;return Z&&G&&Object.keys(G).length>0&&(b.prototype.componentDidMount=function(){tt&&tt.call(this),LM(this,Z(this),G)},b.prototype.componentDidUpdate=function(ht,bt){LM(this,Z(this),G,ht),ot&&ot.call(this,ht,bt)}),b}function CP(b,G){var Z=b.prototype.getInstance,tt=b.prototype.componentDidUpdate,ot=b.prototype.componentDidMount,ht=b.prototype.componentWillUnmount;return G&&G.length>0&&(b.prototype.componentDidMount=function(){ot&&ot.call(this),IM(this,Z(this),G)},b.prototype.componentDidUpdate=function(bt,se){SM.default(this.props,bt)||EM(this,Z(this)),tt&&tt.call(this,bt,se),SM.default(this.props,bt)||IM(this,Z(this),G)},b.prototype.componentWillUnmount=function(){EM(this,Z(this)),ht&&ht.call(this)}),b}function TP(b,G,Z){var tt=MP(b,Z);return tt=CP(tt,G),tt}Eo.default=TP;var JM={};Object.defineProperty(JM,"__esModule",{value:!0});var SP=Qi,IP=Nr.exports,EP=function(b){SP.__extends(G,b);function G(){var Z=b!==null&&b.apply(this,arguments)||this;return Z.options=[],Z}return G.prototype.getMap=function(){return this.props.map||this.context.map},G.prototype.getInstance=function(Z){return Z.instance},G.prototype.getOptions=function(Z){Z===void 0&&(Z=this.props);var tt={};return this.options.map(function(ot){Z[ot]!==void 0&&(tt[ot]=Z[ot])}),tt},G}(IP.PureComponent);JM.default=EP;(function(b){Object.defineProperty(b,"__esModule",{value:!0});var G=Eo;Object.defineProperty(b,"Wrapper",{enumerable:!0,get:function(){return G.default}});var Z=JM;Object.defineProperty(b,"Component",{enumerable:!0,get:function(){return Z.default}})})(Wo);var J2={};Object.defineProperty(J2,"__esModule",{value:!0});function LP(b){return Object.prototype.toString.call(b)==="[object String]"}J2.default=LP;var Q2={},K2={};Object.defineProperty(K2,"__esModule",{value:!0});function RP(b){if(typeof b=="string")return b;if(!!b)return b.displayName||b.name||"Component"}K2.default=RP;Object.defineProperty(Q2,"__esModule",{value:!0});var k2=Qi,hM=k2.__importStar(Nr.exports),PP=k2.__importDefault(K2);Q2.default=function(b){return function(G){var Z;return Z=function(tt){k2.__extends(ot,tt);function ot(ht){var bt=tt.call(this,ht)||this;return bt.state={loaded:bt.isLoadReady()},bt.loadJSAPI=bt.loadJSAPI.bind(bt),bt.handleLoaded=bt.handleLoaded.bind(bt),bt}return ot.prototype.isLoadReady=function(){return!!(window.BMapGL&&window.BMapGL.Map)},ot.prototype.componentDidMount=function(){if(!this.isLoadReady()){if(!b.ak)throw new TypeError("MapApiLoaderHOC: ak is required");this.loadJSAPI()}},ot.prototype.componentWillUnmount=function(){this.apiTimer&&clearTimeout(this.apiTimer),this.loadedTimer&&clearTimeout(this.loadedTimer)},ot.prototype.loadJSAPI=function(){var ht=this;if(this.isLoadReady()){this.handleLoaded();return}if(window.loadingMap)this.apiTimer=window.setTimeout(function(){ht.loadJSAPI()},300);else if(!window.MapApiLoaderCallback){window.loadingMap=!0,window.MapApiLoaderCallback=function(){delete window.loadingMap,delete window.MapApiLoaderCallback};var bt=b.ak,se=document.createElement("script");se.type="text/javascript",se.src="//api.map.baidu.com/api?type=webgl&v=1.0&ak="+bt+"&callback=MapApiLoaderCallback",document.body.appendChild(se),this.loadedTimer=window.setTimeout(function(){ht.handleLoaded()},300)}},ot.prototype.handleLoaded=function(){var ht=this;if(!this.isLoadReady()){this.loadedTimer=window.setTimeout(function(){ht.handleLoaded()},300);return}this.setState({loaded:!0})},ot.prototype.render=function(){var ht=this.state.loaded;return ht?hM.default.createElement(G,k2.__assign({},this.props)):hM.default.createElement("div",null,"loading...")},ot}(hM.Component),Z.displayName="MapApiLoaderHOC("+PP.default(G)+")",Z}};(function(b){Object.defineProperty(b,"__esModule",{value:!0}),b.MapContext=void 0;var G=Qi,Z=G.__importDefault(Nr.exports),tt=Wo,ot=G.__importDefault(Eo),ht=G.__importDefault(Mu),bt=G.__importDefault(J2),se=["click","dblclick","rightclick","rightdblclick","maptypechange","mousemove","mouseover","mouseout","movestart","moving","moveend","zoomstart","zoomend","addoverlay","addcontrol","removecontrol","removeoverlay","clearoverlays","dragstart","dragging","dragend","addtilelayer","removetilelayer","load","resize","hotspotclick","hotspotover","hotspotout","tilesloaded","touchstart","touchmove","touchend","longpress"],Ot={enableScrollWheelZoom:["enableScrollWheelZoom","disableScrollWheelZoom"],enableDragging:["enableDragging","disableDragging"],enableDoubleClickZoom:["enableDoubleClickZoom","disableDoubleClickZoom"],enableKeyboard:["enableKeyboard","disableKeyboard"],enableInertialDragging:["enableInertialDragging","disableInertialDragging"],enableContinuousZoom:["enableContinuousZoom","disableContinuousZoom"],enablePinchToZoom:["enablePinchToZoom","disablePinchToZoom"],enableRotate:["enableRotate","disableRotate"],enableTilt:["enableTilt","disableTilt"],enableAutoResize:["enableAutoResize","disableAutoResize"]};b.MapContext=Z.default.createContext({map:void 0});var Jt=function(jt){G.__extends(pe,jt);function pe(He){var ye=jt.call(this,He)||this;return ye.el=Z.default.createRef(),ye.options=["minZoom","maxZoom","mapType","backgroundColor","displayOptions"],ye}return pe.prototype.componentDidMount=function(){this.initialize(),this.forceUpdate()},pe.prototype.componentDidUpdate=function(He){var ye=He.center,dt=He.zoom,Me=this.props,vr=Me.center,Tr=Me.zoom,fe=!!vr&&!ht.default(ye,vr),Mr=!!(Tr&&!ht.default(dt,Tr)),ui;if(bt.default(vr))ui=vr;else{var xi=vr,fn=xi.lng,Ln=xi.lat;ui=new BMapGL.Point(fn,Ln)}fe&&Mr?this.map.centerAndZoom(ui,Tr):fe?this.map.setCenter(ui):Mr&&this.map.setZoom(Tr)},pe.prototype.componentWillUnmount=function(){this.map&&this.map.destroy()},pe.prototype.initialize=function(){if(!this.map){var He=Object.assign({},this.props.defaultOptions,this.getOptions());He.mapType&&(He.mapType=He.mapType==="normal"?BMAP_NORMAL_MAP:He.mapType,He.mapType=He.mapType==="earth"?BMAP_EARTH_MAP:He.mapType),this.props.mapStyleV2&&(He.style=this.props.mapStyleV2);var ye=new BMapGL.Map(this.el.current,He);if(this.map=ye,this.instance=ye,bt.default(this.props.center))ye.centerAndZoom(this.props.center,this.props.zoom);else{var dt=this.props.center,Me=dt.lng,vr=dt.lat,Tr=new BMapGL.Point(Me,vr);ye.centerAndZoom(Tr,this.props.zoom)}this.props.heading&&ye.setHeading(this.props.heading),this.props.tilt&&ye.setTilt(this.props.tilt)}},pe.prototype.renderChildren=function(He,ye){var dt=this;if(!(!He||!ye))return Z.default.Children.map(He,function(Me){return Me?typeof Me.type=="string"||!Me.props?Me:Z.default.cloneElement(Me,{map:ye},dt.renderChildren(Me.props.children,ye)):null})},pe.prototype.render=function(){return Z.default.createElement("div",{style:this.props.style},Z.default.createElement("div",{ref:this.el,className:this.props.className,style:{height:"100%"}},"\u52A0\u8F7D\u5730\u56FE\u4E2D..."),Z.default.createElement(b.MapContext.Provider,{value:{map:this.map}},this.renderChildren(this.props.children,this.map)))},pe}(tt.Component);Jt.defaultProps={center:{lng:116.404449,lat:39.914889},zoom:12,defaultOptions:{},style:{position:"relative",height:"360px"}},b.default=ot.default(Jt,se,Ot);var le=Q2;Object.defineProperty(b,"MapApiLoaderHOC",{enumerable:!0,get:function(){return le.default}})})(Qs);var QM={},Zp={};Object.defineProperty(Zp,"__esModule",{value:!0});var CI=Qi,DP=Wo,NS=CI.__importDefault(Mu),OP=Qs,FP=function(b){CI.__extends(G,b);function G(Z){var tt=b.call(this,Z)||this;return tt.options=["anchor","offset"],tt}return G.prototype.componentDidUpdate=function(Z){if(!this.map){this.initialize();return}var tt=this.props,ot=tt.anchor,ht=tt.offset,bt=Z.anchor,se=Z.offset,Ot=!NS.default(ot,bt),Jt=!NS.default(ht,se);ot&&Ot&&this.control.setAnchor(ot),ht&&Jt&&this.control.setOffset(ht)},G.prototype.componentDidMount=function(){this.initialize()},G.prototype.componentWillUnmount=function(){this.destroy()},G.prototype.destroy=function(){this.control&&this.map&&(this.map.removeControl(this.control),this.control=null)},G.prototype.initialize=function(){var Z=this.map=this.getMap();!Z||(this.destroy(),this.control=this.getControl(),Z.addControl(this.control))},G.prototype.getControl=function(){throw new Error("Method getControl not implemented.")},G.contextType=OP.MapContext,G}(DP.Component);Zp.default=FP;Object.defineProperty(QM,"__esModule",{value:!0});var TI=Qi,BP=TI.__importDefault(Zp),zP=function(b){TI.__extends(G,b);function G(Z){return b.call(this,Z)||this}return G.prototype.getControl=function(){return new BMapGL.MapTypeControl(this.getOptions())},G.prototype.render=function(){return null},G}(BP.default);QM.default=zP;var KM={};Object.defineProperty(KM,"__esModule",{value:!0});var SI=Qi,NP=SI.__importDefault(Zp),UP=function(b){SI.__extends(G,b);function G(Z){return b.call(this,Z)||this}return G.prototype.getControl=function(){return new BMapGL.ScaleControl(this.getOptions())},G.prototype.render=function(){return null},G}(NP.default);KM.default=UP;var $M={};Object.defineProperty($M,"__esModule",{value:!0});var II=Qi,bP=II.__importDefault(Zp),kP=function(b){II.__extends(G,b);function G(Z){return b.call(this,Z)||this}return G.prototype.getControl=function(){return new BMapGL.ZoomControl(this.getOptions())},G.prototype.render=function(){return null},G}(bP.default);$M.default=kP;var tC={};Object.defineProperty(tC,"__esModule",{value:!0});var EI=Qi,HP=EI.__importDefault(Zp),GP=function(b){EI.__extends(G,b);function G(Z){return b.call(this,Z)||this}return G.prototype.getControl=function(){return new BMapGL.NavigationControl3D(this.getOptions())},G.prototype.render=function(){return null},G}(HP.default);tC.default=GP;var eC={};Object.defineProperty(eC,"__esModule",{value:!0});var LI=Qi,VP=LI.__importDefault(Zp),WP=function(b){LI.__extends(G,b);function G(Z){return b.call(this,Z)||this}return G.prototype.getControl=function(){return new BMapGL.CityListControl(this.getOptions())},G.prototype.render=function(){return null},G}(VP.default);eC.default=WP;var rC={};Object.defineProperty(rC,"__esModule",{value:!0});var iC=Qi,jP=Wo,XP=iC.__importDefault(Eo),U0=iC.__importDefault(Mu),YP=Qs;function ZP(){for(var b="//mapopen.bj.bcebos.com/cms/react-bmap/markers_new2x_fbb9e99.png",G={simple_red:new BMapGL.Icon(b,new BMapGL.Size(21,33),{imageOffset:new BMapGL.Size(227,189),imageSize:new BMapGL.Size(300,300)}),simple_blue:new BMapGL.Icon(b,new BMapGL.Size(21,33),{imageOffset:new BMapGL.Size(227,225),imageSize:new BMapGL.Size(300,300)}),loc_red:new BMapGL.Icon(b,new BMapGL.Size(23,35),{imageOffset:new BMapGL.Size(200,189),imageSize:new BMapGL.Size(300,300)}),loc_blue:new BMapGL.Icon(b,new BMapGL.Size(23,35),{imageOffset:new BMapGL.Size(200,225),imageSize:new BMapGL.Size(300,300)}),start:new BMapGL.Icon(b,new BMapGL.Size(25,40),{imageOffset:new BMapGL.Size(200,139),imageSize:new BMapGL.Size(300,300)}),end:new BMapGL.Icon(b,new BMapGL.Size(25,40),{imageOffset:new BMapGL.Size(225,139),imageSize:new BMapGL.Size(300,300)}),location:new BMapGL.Icon(b,new BMapGL.Size(14,20),{imageOffset:new BMapGL.Size(124,233),imageSize:new BMapGL.Size(300,300)})},Z=1;Z<=10;Z++)G["red"+Z]=new BMapGL.Icon(b,new BMapGL.Size(42/2,66/2),{imageOffset:new BMapGL.Size(42/2*(Z-1),0),imageSize:new BMapGL.Size(600/2,600/2)});for(var Z=1;Z<=10;Z++)G["blue"+Z]=new BMapGL.Icon(b,new BMapGL.Size(42/2,66/2),{imageOffset:new BMapGL.Size(42/2*(Z-1),132/2),imageSize:new BMapGL.Size(600/2,600/2)});return G}var qP=["click","dblclick","mousedown","mouseup","mouseout","mouseover","remove","infowindowclose","infowindowopen","dragstart","dragging","dragend","rightclick"],JP={enableMassClear:["enableMassClear","disableMassClear"],enableDragging:["enableDragging","disableDragging"]},RI=function(b){iC.__extends(G,b);function G(Z){var tt=b.call(this,Z)||this;return tt.options=["offset","icon","enableMassClear","enableDragging","enableClicking","raiseOnDrag","draggingCursor","rotation","title"],tt.defaultIcons=ZP(),tt}return G.prototype.componentDidUpdate=function(Z){if(!this.map){this.initialize();return}var tt=this.props,ot=tt.position,ht=tt.icon,bt=tt.autoViewport,se=tt.offset,Ot=tt.isTop,Jt=Z.position,le=Z.icon,jt=Z.autoViewport,pe=Z.offset,He=Z.isTop,ye=ot&&!U0.default(ot,Jt),dt=!!(ht&&!U0.default(ht,le)),Me=!U0.default(bt,jt),vr=!!(se&&!U0.default(se,pe)),Tr=!U0.default(Ot,He),fe=this.parsePosition(ot);if(ye&&this.marker.setPosition(fe),dt){var Mr=this.parseIcon(ht);this.marker.setIcon(Mr)}vr&&this.marker.setOffset(se),Tr&&this.marker.setTop(!!Ot),bt&&(ye||Me)&&this.map.setCenter(fe)},G.prototype.componentDidMount=function(){this.initialize()},G.prototype.componentWillUnmount=function(){this.destroy()},G.prototype.destroy=function(){this.marker&&this.map&&(this.map.removeOverlay(this.marker),this.instance=this.marker=void 0)},G.prototype.initialize=function(){var Z=this.map=this.getMap();if(!!Z){this.destroy();var tt=this.parseIcon(this.props.icon),ot=this.parsePosition(this.props.position),ht=this.getOptions();ht.icon=tt,this.instance=this.marker=new BMapGL.Marker(ot,ht),this.props.isTop&&this.marker.setTop(!0),Z.addOverlay(this.marker),this.props.autoViewport&&Z.setCenter(ot)}},G.prototype.parsePosition=function(Z){var tt=this.props.coordType==="bd09mc",ot;return Z instanceof Array?ot=new BMapGL.Point(Z[0],Z[1]):Z instanceof BMapGL.Point?ot=Z:ot=new BMapGL.Point(Z.lng,Z.lat),tt&&(ot=BMapGL.Projection.convertMC2LL(ot)),ot},G.prototype.parseIcon=function(Z){var tt;return Z&&Z instanceof BMapGL.Icon?tt=Z:Z&&this.defaultIcons[Z]?tt=this.defaultIcons[Z]:tt=this.defaultIcons.simple_red,tt},G.prototype.render=function(){return null},G.contextType=YP.MapContext,G}(jP.Component);RI.defaultProps={icon:"simple_red"};rC.default=XP.default(RI,qP,JP);var nC={},e1={};Object.defineProperty(e1,"__esModule",{value:!0});var oC=Qi,QP=Wo,KP=oC.__importDefault(Eo),Jm=oC.__importDefault(Mu),$P=Qs,t4=["click","dblclick","rightclick","mousedown","mouseup","mouseout","mouseover","mousemove","remove","lineupdate"],e4={enableMassClear:["enableMassClear","disableMassClear"],enableEditing:["enableEditing","disableEditing"]},r4=function(b){oC.__extends(G,b);function G(Z){var tt=b.call(this,Z)||this;return tt.options=["strokeColor","strokeWeight","strokeOpacity","strokeStyle","fillColor","fillOpacity","enableMassClear","enableEditing","enableClicking"],tt}return G.prototype.componentDidUpdate=function(Z){var tt=this.props,ot=tt.strokeColor,ht=tt.strokeWeight,bt=tt.strokeOpacity,se=tt.strokeStyle,Ot=tt.fillColor,Jt=tt.fillOpacity,le=Z.strokeColor,jt=Z.strokeWeight,pe=Z.strokeOpacity,He=Z.strokeStyle,ye=Z.fillColor,dt=Z.fillOpacity,Me=!Jm.default(ot,le),vr=!Jm.default(ht,jt),Tr=!Jm.default(bt,pe),fe=!Jm.default(se,He),Mr=!Jm.default(Ot,ye),ui=!Jm.default(Jt,dt);(Me||vr||Tr||fe||Mr||ui)&&this.overlay.setOptions(this.getOptions()),this.onDataUpdate(Z)},G.prototype.componentDidMount=function(){this.initialize()},G.prototype.componentWillUnmount=function(){this.destroy()},G.prototype.destroy=function(){this.overlay&&(this.map.removeOverlay(this.overlay),this.instance=this.overlay=void 0)},G.prototype.initialize=function(){var Z=this.map=this.getMap();if(!!Z){this.destroy(),this.instance=this.overlay=this.getOverlay(),Z.addOverlay(this.overlay);var tt;if(this.overlay instanceof BMapGL.Polyline||this.overlay instanceof BMapGL.Polygon){var ot=this.overlay.getPath();tt=Z.getViewport(ot,this.props.viewportOptions||{})}else if(this.overlay instanceof BMapGL.Circle){var ht=this.overlay.getBounds();tt=Z.getViewport(ht,this.props.viewportOptions||{})}tt&&this.props.autoViewport&&Z.setViewport(tt)}},G.prototype.getOverlay=function(){throw new Error("Method getOverlay not implemented.")},G.prototype.onDataUpdate=function(Z){throw new Error("Method onDataUpdate not implemented.")},G.contextType=$P.MapContext,G}(QP.Component);e1.default=KP.default(r4,t4,e4);Object.defineProperty(nC,"__esModule",{value:!0});var sC=Qi,i4=sC.__importDefault(e1),US=sC.__importDefault(Mu),n4=function(b){sC.__extends(G,b);function G(Z){var tt=b.call(this,Z)||this;return tt.options=["strokeColor","strokeWeight","strokeOpacity","strokeStyle","dashArray","enableMassClear","enableEditing"],tt}return G.prototype.onDataUpdate=function(Z){var tt=this.props,ot=tt.path,ht=tt.autoViewport,bt=Z.path,se=Z.autoViewport,Ot=ot&&!US.default(ot,bt),Jt=!US.default(ht,se);if(Ot&&this.overlay.setPath(this.parsePath(ot)),ht&&(Ot||Jt)){var le=this.overlay.getPath(),jt=this.props.map.getViewport(le,this.props.viewportOptions||{});this.props.map.setViewport(jt)}},G.prototype.getOverlay=function(){var Z=this.parsePath(this.props.path);return new BMapGL.Polyline(Z,this.getOptions())},G.prototype.parsePath=function(Z){var tt=this.props.coordType==="bd09mc",ot=Z.map(function(ht){var bt;return ht instanceof Array?bt=new BMapGL.Point(ht[0],ht[1]):ht instanceof BMapGL.Point?bt=ht:bt=new BMapGL.Point(ht.lng,ht.lat),tt&&(bt=BMapGL.Projection.convertMC2LL(bt)),bt});return ot},G.prototype.render=function(){return null},G}(i4.default);nC.default=n4;var aC={};Object.defineProperty(aC,"__esModule",{value:!0});var uC=Qi,o4=uC.__importDefault(e1),bS=uC.__importDefault(Mu),s4=function(b){uC.__extends(G,b);function G(Z){var tt=b.call(this,Z)||this;return tt.options=["strokeColor","strokeWeight","strokeOpacity","strokeStyle","fillColor","fillOpacity","enableMassClear","enableEditing"],tt}return G.prototype.onDataUpdate=function(Z){var tt=this.props,ot=tt.path,ht=tt.autoViewport,bt=Z.path,se=Z.autoViewport,Ot=ot&&!bS.default(ot,bt),Jt=!bS.default(ht,se);if(Ot&&this.overlay.setPath(this.parsePath(ot)),ht&&(Ot||Jt)){var le=this.overlay.getPath(),jt=this.props.map.getViewport(le,this.props.viewportOptions||{});this.props.map.setViewport(jt)}},G.prototype.getOverlay=function(){var Z=this.parsePath(this.props.path);return new BMapGL.Polygon(Z,this.getOptions())},G.prototype.parsePath=function(Z){var tt=this.props.coordType==="bd09mc",ot=Z.map(function(ht){var bt;return ht instanceof Array?bt=new BMapGL.Point(ht[0],ht[1]):ht instanceof BMapGL.Point?bt=ht:bt=new BMapGL.Point(ht.lng,ht.lat),tt&&(bt=BMapGL.Projection.convertMC2LL(bt)),bt});return ot},G.prototype.render=function(){return null},G}(o4.default);aC.default=s4;var lC={};Object.defineProperty(lC,"__esModule",{value:!0});var hC=Qi,a4=hC.__importDefault(e1),cM=hC.__importDefault(Mu),u4=function(b){hC.__extends(G,b);function G(Z){var tt=b.call(this,Z)||this;return tt.options=["strokeColor","strokeWeight","strokeOpacity","strokeStyle","fillColor","fillOpacity","enableMassClear","enableEditing"],tt}return G.prototype.onDataUpdate=function(Z){var tt=this.props,ot=tt.center,ht=tt.radius,bt=tt.autoViewport,se=Z.center,Ot=Z.radius,Jt=Z.autoViewport,le=ot&&!cM.default(ot,se),jt=!!(ht&&!cM.default(ht,Ot)),pe=!cM.default(bt,Jt);if(le&&this.overlay.setCenter(this.parseCenter(ot)),jt&&this.overlay.setRadius(ht),bt&&(le||jt||pe)){var He=this.overlay.getBounds(),ye=this.props.map.getViewport(He,this.props.viewportOptions||{});this.props.map.setViewport(ye)}},G.prototype.getOverlay=function(){var Z=this.props,tt=Z.center,ot=Z.radius;return new BMapGL.Circle(this.parseCenter(tt),ot,this.getOptions())},G.prototype.parseCenter=function(Z){var tt=this.props.coordType==="bd09mc",ot;return Z instanceof Array?ot=new BMapGL.Point(Z[0],Z[1]):Z instanceof BMapGL.Point?ot=Z:ot=new BMapGL.Point(Z.lng,Z.lat),tt&&(ot=BMapGL.Projection.convertMC2LL(ot)),ot},G.prototype.render=function(){return null},G}(a4.default);lC.default=u4;var cC={};Object.defineProperty(cC,"__esModule",{value:!0});var PI=Qi,l4=Wo,h4=PI.__importDefault(Eo),kS=OM.exports,c4=Qs,f4=["close","open","maximize","restore","clickclose"],p4={enableMaximize:["enableMaximize","disableMaximize"],enableAutoPan:["enableAutoPan","disableAutoPan"],enableCloseOnClick:["enableCloseOnClick","disableCloseOnClick"]},DI=function(b){PI.__extends(G,b);function G(Z){var tt=b.call(this,Z)||this;return tt.options=["width","height","maxWidth","offset","title","enableMassClear"],tt}return G.prototype.componentDidUpdate=function(Z){this.initialize()},G.prototype.componentDidMount=function(){this.initialize()},G.prototype.componentWillUnmount=function(){this.destroy()},G.prototype.destroy=function(){this.content&&kS.unmountComponentAtNode(this.content),this.infoWindow&&(this.map.closeInfoWindow(),this.instance=this.infoWindow=void 0)},G.prototype.initialize=function(){var Z=this.map=this.getMap();if(!!Z){this.destroy();var tt=this.getOptions(),ot=this.parsePosition(this.props.position);if(this.instance=this.infoWindow=new BMapGL.InfoWindow(this.props.text||"",tt),Z.openInfoWindow(this.infoWindow,ot),this.props.children!==void 0){var ht=this.content=document.createElement("div");kS.render(this.props.children,ht),this.infoWindow.setContent(ht)}}},G.prototype.parsePosition=function(Z){var tt=this.props.coordType==="bd09mc",ot;return Z instanceof Array?ot=new BMapGL.Point(Z[0],Z[1]):Z instanceof BMapGL.Point?ot=Z:ot=new BMapGL.Point(Z.lng,Z.lat),tt&&(ot=BMapGL.Projection.convertMC2LL(ot)),ot},G.prototype.render=function(){return null},G.contextType=c4.MapContext,G}(l4.Component);DI.defaultProps={};cC.default=h4.default(DI,f4,p4);var fC={};Object.defineProperty(fC,"__esModule",{value:!0});var pC=Qi,d4=Wo,m4=pC.__importDefault(Eo),E2=pC.__importDefault(Mu),g4=Qs,v4=["click","dblclick","rightclick","mousedown","mouseup","mouseout","mouseover","mousemove","remove"],y4={enableMassClear:["enableMassClear","disableMassClear"]},OI=function(b){pC.__extends(G,b);function G(Z){var tt=b.call(this,Z)||this;return tt.options=["position","offset","enableMassClear"],tt}return G.prototype.componentDidUpdate=function(Z){var tt=this.props,ot=tt.position,ht=tt.offset,bt=tt.text,se=tt.style,Ot=Z.position,Jt=Z.offset,le=Z.text,jt=Z.style,pe=ot&&!E2.default(ot,Ot),He=!!(ht&&!E2.default(ht,Jt)),ye=!E2.default(bt,le),dt=!!(se&&!E2.default(se,jt)),Me=this.parsePosition(ot);pe&&this.label.setPosition(Me),He&&this.label.setOffset(ht),ye&&this.label.setContent(bt),dt&&this.label.setStyle(se)},G.prototype.componentDidMount=function(){this.initialize()},G.prototype.componentWillUnmount=function(){this.destroy()},G.prototype.destroy=function(){this.label&&(this.map.removeOverlay(this.label),this.instance=this.label=void 0)},G.prototype.initialize=function(){var Z=this.map=this.getMap();if(!!Z){this.destroy();var tt=this.getOptions(),ot=this.parsePosition(this.props.position);tt.position=ot,this.instance=this.label=new BMapGL.Label(this.props.text||"",tt),Z.addOverlay(this.label),this.props.style&&this.label.setStyle(this.props.style)}},G.prototype.parsePosition=function(Z){var tt=this.props.coordType==="bd09mc",ot;return Z instanceof Array?ot=new BMapGL.Point(Z[0],Z[1]):Z instanceof BMapGL.Point?ot=Z:ot=new BMapGL.Point(Z.lng,Z.lat),tt&&(ot=BMapGL.Projection.convertMC2LL(ot)),ot},G.prototype.render=function(){return null},G.contextType=g4.MapContext,G}(d4.Component);OI.defaultProps={style:{color:"red"}};fC.default=m4.default(OI,v4,y4);var dC={},mC={};Object.defineProperty(mC,"__esModule",{value:!0});var FI=OM.exports;function $2(b,G){this._point=new BMapGL.Point(b.lng,b.lat),this._options=G||{},this._html=G.html||"";var Z=new BMapGL.Overlay;for(var tt in Z)tt!=="initialize"&&tt!=="draw"&&tt!=="destroy"&&(this.__proto__[tt]=Z[tt])}$2.prototype.initialize=function(b){return this._map=b,this._div=document.createElement("div"),this._div.style.position="absolute",this._div.style.zIndex=this._options.zIndex||BMapGL.Overlay.getZIndex(this._point.lat),FI.render(this._html,this._div),this._div.onmousedown=function(G){return G=G||window.event,G.preventDefault?G.preventDefault():G.returnValue=!1,!1},b.getPanes().floatShadow.appendChild(this._div),this._div};$2.prototype.destroy=function(){FI.unmountComponentAtNode(this._div)};$2.prototype.draw=function(){var b=this._map,G=b.pointToOverlayPixel(this._point),Z={width:0,height:0};this._options&&this._options.offset&&(Z=this._options.offset);var tt=Z.width,ot=Z.height;this._options&&this._options.unit&&this._options.unit==="m"&&(tt/=b.getZoomUnits(),ot/=b.getZoomUnits()),this._div.style.left=G.x+tt+"px",this._div.style.top=G.y+ot+"px",this._div.style.transform="translate(-50%, -100%)"};mC.default=$2;Object.defineProperty(dC,"__esModule",{value:!0});var gC=Qi,x4=Wo,A4=gC.__importDefault(Mu),_4=gC.__importDefault(mC),w4=Qs,M4=function(b){gC.__extends(G,b);function G(Z){var tt=b.call(this,Z)||this;return tt.options=["zIndex","offset","unit"],tt}return G.prototype.componentDidUpdate=function(Z){A4.default(this.props,Z)||this.initialize()},G.prototype.componentDidMount=function(){this.initialize()},G.prototype.componentWillUnmount=function(){this.destroy()},G.prototype.destroy=function(){this.overlay&&this.map&&(this.overlay.destroy(),this.map.removeOverlay(this.overlay),this.instance=this.overlay=void 0)},G.prototype.initialize=function(){var Z=this.map=this.getMap();if(!!Z){this.destroy();var tt=this.getOptions();tt.html=this.props.children;var ot=this.parsePosition(this.props.position);this.instance=this.overlay=new _4.default(ot,tt),Z.addOverlay(this.overlay),this.props.autoViewport&&Z.setCenter(ot)}},G.prototype.parsePosition=function(Z){var tt=this.props.coordType==="bd09mc",ot;return Z instanceof Array?ot=new BMapGL.Point(Z[0],Z[1]):Z instanceof BMapGL.Point?ot=Z:ot=new BMapGL.Point(Z.lng,Z.lat),tt&&(ot=BMapGL.Projection.convertMC2LL(ot)),ot},G.prototype.render=function(){return null},G.contextType=w4.MapContext,G}(x4.Component);dC.default=M4;var vC={},rg={exports:{}};(function(b,G){(function(Z,tt){tt(G)})(Gc,function(Z){function tt(l){this.options=l||{},this.paneName=this.options.paneName||"labelPane",this.zIndex=this.options.zIndex||1,this._map=l.map,this._lastDrawTime=null,this.show()}function ot(l){return l&&l.__esModule&&Object.prototype.hasOwnProperty.call(l,"default")?l.default:l}function ht(l,h){return h={exports:{}},l(h,h.exports),h.exports}function bt(l,h){return function(o){return h(l(o))}}function se(l){var h=function(o){return o==null?o:(1<arguments.length&&(o=Array.prototype.slice.call(arguments)),l(o))};return"conversion"in l&&(h.conversion=l.conversion),h}function Ot(l){var h=function(o){if(o==null)return o;1<arguments.length&&(o=Array.prototype.slice.call(arguments));var a=l(o);if((typeof a=="undefined"?"undefined":kn(a))==="object")for(var y=a.length,g=0;g<y;g++)a[g]=Math.round(a[g]);return a};return"conversion"in l&&(h.conversion=l.conversion),h}function Jt(l,h){if(!(this instanceof Jt))return new Jt(l,h);if(h&&h in zu&&(h=null),h&&!(h in Rn))throw Error("Unknown model: "+h);if(typeof l=="undefined")this.model="rgb",this.color=[0,0,0],this.valpha=1;else if(l instanceof Jt)this.model=l.model,this.color=l.color.slice(),this.valpha=l.valpha;else if(typeof l=="string"){if(h=zo.get(l),h===null)throw Error("Unable to parse color from string: "+l);this.model=h.model;var o=Rn[this.model].channels;this.color=h.value.slice(0,o),this.valpha=typeof h.value[o]=="number"?h.value[o]:1}else if(l.length)this.model=h||"rgb",o=Rn[this.model].channels,h=fs.call(l,0,o),this.color=He(h,o),this.valpha=typeof l[o]=="number"?l[o]:1;else if(typeof l=="number")l&=16777215,this.model="rgb",this.color=[l>>16&255,l>>8&255,l&255],this.valpha=1;else{if(this.valpha=1,h=bn(l),"alpha"in l&&(h.splice(h.indexOf("alpha"),1),this.valpha=typeof l.alpha=="number"?l.alpha:0),h=h.sort().join(""),!(h in ji))throw Error("Unable to parse color from object: "+bl(l));this.model=ji[h],o=Rn[this.model].labels;var a=[];for(h=0;h<o.length;h++)a.push(l[o[h]]);this.color=He(a)}if(jh[this.model])for(o=Rn[this.model].channels,h=0;h<o;h++)(l=jh[this.model][h])&&(this.color[h]=l(this.color[h]));this.valpha=Math.max(0,Math.min(1,this.valpha)),Wh&&Wh(this)}function le(l){return function(h){return Number(h.toFixed(l))}}function jt(l,h,o){return l=Array.isArray(l)?l:[l],l.forEach(function(a){(jh[a]||(jh[a]=[]))[h]=o}),l=l[0],function(a){if(arguments.length){o&&(a=o(a));var y=this[l]();return y.color[h]=a,y}return y=this[l]().color[h],o&&(y=o(y)),y}}function pe(l){return function(h){return Math.max(0,Math.min(l,h))}}function He(l,h){for(var o=0;o<h;o++)typeof l[o]!="number"&&(l[o]=0);return l}function ye(l){return l*Math.PI/180}function dt(l){return l/Math.PI*180}function Me(l){return Math.pow(2,Math.ceil(Math.log(l)/Math.LN2))}function vr(l){return Math.pow(2,Math.floor(Math.log(l)/Math.LN2))}function Tr(l,h){return 1e-8>Math.abs(l-h)}function fe(l){var h=l[0],o=l[l.length-1];return Math.sqrt(Math.pow(h[0]-o[0],2)+Math.pow(h[1]-o[1],2)+Math.pow((h[2]||0)-(o[2]||0),2))<(1<arguments.length&&arguments[1]!==void 0?arguments[1]:2e-7)}function Mr(){}function ui(l,h){for(var o in h)l[o]=h[o]}function xi(l,h){this.lng=l,this.lat=h}function fn(l,h){this.x=l,this.y=h}function Ln(l,h){var o=document.createElement("canvas");return l&&(o.width=l),h&&(o.height=h),o}function Li(l){l=l||{},this.gradient=l.gradient||{"0.25":"rgba(0, 0, 255, 1)","0.55":"rgba(0, 255, 0, 1)","0.85":"rgba(255, 255, 0, 1)",1:"rgba(255, 0, 0, 1)"},this.maxSize=l.maxSize===void 0?35:l.maxSize,this.minSize=l.minSize||0,this.max=l.max||100,this.min=l.min||0,this.initPalette()}function li(l){this.options=l||{},this._initialize()}function Oe(l,h,o,a,y){var g=1-l,x=1-l;return g*g*g*h+3*x*x*l*o+3*(1-l)*l*l*a+l*l*l*y}function yn(l){this.WORLD_SIZE_MC_HALF=20037726372307256e-9,this.WORLD_SIZE_MC=2*this.WORLD_SIZE_MC_HALF,this.options=l||{},this._initialize()}function Is(l,h){return l&&h?Math.round(Math.sqrt(Math.pow(l.lng-h.lng,2)+Math.pow(l.lat-h.lat,2))):0}function Ks(l){return l=l.split("|"),l[0]=l[0].split(","),{lng:parseFloat(l[0][0]),lat:parseFloat(l[0][1])}}function Es(l){for(var h=l.length;0<=--h;)l[h]=0}function Rr(l,h,o,a,y){this.static_tree=l,this.extra_bits=h,this.extra_base=o,this.elems=a,this.max_length=y,this.has_stree=l&&l.length}function Nn(l,h){this.dyn_tree=l,this.max_code=0,this.stat_desc=h}function wr(l,h,o,a,y){this.good_length=l,this.max_lazy=h,this.nice_length=o,this.max_chain=a,this.func=y}function og(){this.strm=null,this.status=0,this.pending_buf=null,this.wrap=this.pending=this.pending_out=this.pending_buf_size=0,this.gzhead=null,this.gzindex=0,this.method=Bs,this.last_flush=-1,this.w_mask=this.w_bits=this.w_size=0,this.window=null,this.window_size=0,this.head=this.prev=null,this.nice_match=this.good_match=this.strategy=this.level=this.max_lazy_match=this.max_chain_length=this.prev_length=this.lookahead=this.match_start=this.strstart=this.match_available=this.prev_match=this.match_length=this.block_start=this.hash_shift=this.hash_mask=this.hash_bits=this.hash_size=this.ins_h=0,this.dyn_ltree=new Uint16Array(1146),this.dyn_dtree=new Uint16Array(122),this.bl_tree=new Uint16Array(78),Gn(this.dyn_ltree),Gn(this.dyn_dtree),Gn(this.bl_tree),this.bl_desc=this.d_desc=this.l_desc=null,this.bl_count=new Uint16Array(16),this.heap=new Uint16Array(573),Gn(this.heap),this.heap_max=this.heap_len=0,this.depth=new Uint16Array(573),Gn(this.depth),this.bi_valid=this.bi_buf=this.insert=this.matches=this.static_len=this.opt_len=this.d_buf=this.last_lit=this.lit_bufsize=this.l_buf=0}function vl(l){l=this.options=Cn.assign({level:TA,method:po,chunkSize:16384,windowBits:15,memLevel:8,strategy:zi},l||{}),l.raw&&0<l.windowBits?l.windowBits=-l.windowBits:l.gzip&&0<l.windowBits&&16>l.windowBits&&(l.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Wl,this.strm.avail_out=0;var h=zs.deflateInit2(this.strm,l.level,l.method,l.windowBits,l.memLevel,l.strategy);if(h!==Ns)throw Error(Ya[h]);if(l.header&&zs.deflateSetHeader(this.strm,l.header),l.dictionary){if(l=typeof l.dictionary=="string"?oo.string2buf(l.dictionary):Df.call(l.dictionary)==="[object ArrayBuffer]"?new Uint8Array(l.dictionary):l.dictionary,h=zs.deflateSetDictionary(this.strm,l),h!==Ns)throw Error(Ya[h]);this._dict_set=!0}}function Yc(l,h){if(h=new vl(h),h.push(l,!0),h.err)throw h.msg||Ya[h.err];return h.result}function sg(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.total=this.check=this.dmax=this.flags=0,this.head=null,this.wnext=this.whave=this.wsize=this.wbits=0,this.window=null,this.extra=this.offset=this.length=this.bits=this.hold=0,this.distcode=this.lencode=null,this.have=this.ndist=this.nlen=this.ncode=this.distbits=this.lenbits=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.distdyn=this.lendyn=null,this.was=this.back=this.sane=0}function Ra(l){var h=this.options=Cn.assign({chunkSize:65536,windowBits:15,to:""},l||{});if(h.raw&&0<=h.windowBits&&16>h.windowBits&&(h.windowBits=-h.windowBits,h.windowBits===0&&(h.windowBits=-15)),!(0<=h.windowBits&&16>h.windowBits)||l&&l.windowBits||(h.windowBits+=32),15<h.windowBits&&48>h.windowBits&&(h.windowBits&15)===0&&(h.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Wl,this.strm.avail_out=0,l=ha.inflateInit2(this.strm,h.windowBits),l!==gs||(this.header=new Ug,ha.inflateGetHeader(this.strm,this.header),h.dictionary&&(typeof h.dictionary=="string"?h.dictionary=oo.string2buf(h.dictionary):F1.call(h.dictionary)==="[object ArrayBuffer]"&&(h.dictionary=new Uint8Array(h.dictionary)),h.raw&&(l=ha.inflateSetDictionary(this.strm,h.dictionary),l!==gs))))throw Error(Ya[l])}function Zc(l,h){if(h=new Ra(h),h.push(l),h.err)throw h.msg||Ya[h.err];return h.result}function wh(l,h){for(var o=["webgl2","experimental-webgl2","webgl","experimental-webgl"],a=void 0,y=0;y<o.length;y++)try{if(a=l.getContext(o[y],{stencil:!0,alpha:!0,premultipliedAlpha:!1,antialias:h.antialias||!0,preserveDrawingBuffer:h.preserveDrawingBuffer||!1}))break}catch{}return a}function Ge(l,h,o){var a=3<arguments.length&&arguments[3]!==void 0?arguments[3]:{};o=Vr({TEXTURE_MAG_FILTER:"LINEAR",TEXTURE_MIN_FILTER:"LINEAR",TEXTURE_WRAP_S:"REPEAT",TEXTURE_WRAP_T:"REPEAT"},o);var y=l.createTexture();if(l.bindTexture(l.TEXTURE_2D,y),l.pixelStorei(l.UNPACK_FLIP_Y_WEBGL,a.flipY||!0),a.format&&a.width){var g=l.LUMINANCE;a.format&&(g=l[a.format]),a.format!=="RGBA"&&a.format!=="RGB"?(h=new Float32Array(h),l.texImage2D(l.TEXTURE_2D,0,l.R32F,a.width,a.height,0,l.RED,l[a.type]||l.FLOAT,h)):l.texImage2D(l.TEXTURE_2D,0,g,a.width,a.height,0,g,l[a.type]||l.FLOAT,h)}else l.texImage2D(l.TEXTURE_2D,0,l.RGBA,l.RGBA,l.UNSIGNED_BYTE,h);for(var x in o)l.texParameteri(l.TEXTURE_2D,l[x],l[o[x]]);return l.bindTexture(l.TEXTURE_2D,null),{texture:y,data:{width:a.width,height:a.height,data:h,type:a.type}}}function xn(l,h,o,a,y){if((typeof h=="undefined"?"undefined":kn(h))==="object")h=Ge(l,h,a,y),o(h.texture,null,h.data);else{var g=new Image;g.crossOrigin="anonymous",g.onload=function(){var x=vr(g.width),v=vr(g.height),M=document.createElement("canvas");M.width=x,M.height=v;var D=M.getContext("2d");D.drawImage(g,0,0,x,v),g=M,M=Ge(l,g,a,y).texture,o(M,g,{width:x,height:v,data:D.getImageData(0,0,x,v),type:"RGBA"})},g.src=h}}function $s(l,h){if(h instanceof Array){var o={zero:l.ZERO,one:l.ONE,src_color:l.SRC_COLOR,one_minus_src_color:l.ONE_MINUS_SRC_COLOR,dst_color:l.DST_COLOR,one_minus_dst_color:l.ONE_MINUS_DST_COLOR,src_alpha:l.SRC_ALPHA,one_minus_src_alpha:l.ONE_MINUS_SRC_ALPHA,dst_alpha:l.DST_ALPHA,one_minus_dst_alpha:l.ONE_MINUS_DST_ALPHA,constant_color:l.CONSTANT_COLOR,one_minus_constant_color:l.ONE_MINUS_CONSTANT_COLOR,constant_alpha:l.CONSTANT_ALPHA,one_minus_constant_alpha:l.ONE_MINUS_CONSTANT_ALPHA,src_alpha_saturate:l.SRC_ALPHA_SATURATE};return h.map(function(a){return o[a]})}switch(h){case"default":return[l.ONE,l.ZERO];case"deeper":return[l.ONE,l.ONE_MINUS_SRC_ALPHA];case"normal":return[l.SRC_ALPHA,l.ONE];case"lighter":return[l.SRC_ALPHA,l.ONE_MINUS_SRC_ALPHA];default:return[l.ONE,l.ZERO]}}function ag(l,h){var o=2<arguments.length&&arguments[2]!==void 0?arguments[2]:[],a=3<arguments.length&&arguments[3]!==void 0?arguments[3]:"#ccc",y=4<arguments.length&&arguments[4]!==void 0?arguments[4]:1,g=document.createElement("canvas"),x=g.getContext("2d");g.width=256,g.height=y,g=h[0];var v=h[h.length-1];if(l.length===h.length){for(var M=x.createLinearGradient(0,0,256,1),D=0;D<l.length;++D)M.addColorStop((h[D]-g)/(v-g),l[D]);x.fillStyle=M,x.fillRect(0,0,256,y)}else if(l.length-h.length===-1){M=0,D=1;for(var U=0;U<l.length;++U){var C=Math.floor((h[D]-g)/(v-g)*256);x.fillStyle=l[U],x.fillRect(M,0,C,y),M=C,D++}}else x.fillStyle=a||"#ccc",x.fillRect(0,0,256,y);return-1>=l.length-h.length&&o.length===2&&(x.fillStyle=a||"#ccc",a=(o[0]-g)/(v-g),a=Math.floor(256*a),x.fillRect(0,0,a,y),a=(o[1]-g)/(v-g),a=Math.floor(256*a),x.fillRect(a,0,255,y)),{data:new Uint8Array(new Uint8ClampedArray(x.getImageData(0,0,256,y).data)),width:256,height:y}}function ke(l,h,o){o=o||2;var a=h&&h.length,y=a?h[0]*o:l.length,g=Zi(l,0,y,o,!0),x=[];if(!g||g.next===g.prev)return x;var v;if(a){var M=o;a=[];var D,U=0;for(D=h.length;U<D;U++){var C=h[U]*M,L=U<D-1?h[U+1]*M:l.length;C=Zi(l,C,L,M,!1),C===C.next&&(C.steiner=!0),a.push(Da(C))}for(a.sort(Mh),U=0;U<a.length;U++)M=a[U],h=g,(h=uo(M,h))&&(M=Qc(h,M),Pa(h,h.next),Pa(M,M.next)),g=Pa(g,g.next)}if(l.length>80*o){var B=v=l[0],O=a=l[1];for(M=o;M<y;M+=o)U=l[M],h=l[M+1],U<B&&(B=U),h<O&&(O=h),U>v&&(v=U),h>a&&(a=h);v=Math.max(v-B,a-O),v=v!==0?1/v:0}return Cu(g,x,o,B,O,v),x}function Zi(l,h,o,a,y){if(y===0<lg(l,h,o,a))for(y=h;y<o;y+=a)var g=Oa(y,l[y],l[y+1],g);else for(y=o-a;y>=h;y-=a)g=Oa(y,l[y],l[y+1],g);return g&&Tu(g,g.next)&&(Kc(g),g=g.next),g}function Pa(l,h){if(!l)return l;h||(h=l);do{var o=!1;if(l.steiner||!Tu(l,l.next)&&Vi(l.prev,l,l.next)!==0)l=l.next;else{if(Kc(l),l=h=l.prev,l===l.next)break;o=!0}}while(o||l!==h);return h}function Cu(l,h,o,a,y,g,x){if(l){if(!x&&g){var v=l,M=v;do M.z===null&&(M.z=Ki(M.x,M.y,a,y,g)),M.prevZ=M.prev,M=M.nextZ=M.next;while(M!==v);M.prevZ.nextZ=null,M.prevZ=null,v=M;var D,U,C,L,B=1;do{M=v;var O=v=null;for(U=0;M;){U++;var k=M;for(D=C=0;D<B&&(C++,k=k.nextZ,k);D++);for(L=B;0<C||0<L&&k;)C!==0&&(L===0||!k||M.z<=k.z)?(D=M,M=M.nextZ,C--):(D=k,k=k.nextZ,L--),O?O.nextZ=D:v=D,D.prevZ=O,O=D;M=k}O.nextZ=null,B*=2}while(1<U)}for(v=l;l.prev!==l.next;){if(M=l.prev,k=l.next,g)O=Gr(l,a,y,g);else t:if(O=l,U=O.prev,C=O,B=O.next,0<=Vi(U,C,B))O=!1;else{for(D=O.next.next;D!==O.prev;){if(en(U.x,U.y,C.x,C.y,B.x,B.y,D.x,D.y)&&0<=Vi(D.prev,D,D.next)){O=!1;break t}D=D.next}O=!0}if(O)h.push(M.i/o),h.push(l.i/o),h.push(k.i/o),Kc(l),v=l=k.next;else if(l=k,l===v){if(!x)Cu(Pa(l),h,o,a,y,g,1);else if(x===1){l=Pa(l),x=h,v=o,M=l;do k=M.prev,O=M.next.next,!Tu(k,O)&&yl(k,M,M.next,O)&&Jc(k,O)&&Jc(O,k)&&(x.push(k.i/v),x.push(M.i/v),x.push(O.i/v),Kc(M),Kc(M.next),M=l=O),M=M.next;while(M!==l);l=Pa(M),Cu(l,h,o,a,y,g,2)}else if(x===2)t:{x=l;do{for(v=x.next.next;v!==x.prev;){if(M=x.i!==v.i){if(M=x,k=v,O=M.next.i!==k.i&&M.prev.i!==k.i){e:{O=M;do{if(O.i!==M.i&&O.next.i!==M.i&&O.i!==k.i&&O.next.i!==k.i&&yl(O,O.next,M,k)){O=!0;break e}O=O.next}while(O!==M);O=!1}O=!O}if(O){if(O=Jc(M,k)&&Jc(k,M)){O=M,U=!1,C=(M.x+k.x)/2,B=(M.y+k.y)/2;do O.y>B!=O.next.y>B&&O.next.y!==O.y&&C<(O.next.x-O.x)*(B-O.y)/(O.next.y-O.y)+O.x&&(U=!U),O=O.next;while(O!==M);O=U}O=O&&(Vi(M.prev,M,k.prev)||Vi(M,k.prev,k))||Tu(M,k)&&0<Vi(M.prev,M,M.next)&&0<Vi(k.prev,k,k.next)}M=O}if(M){l=Qc(x,v),x=Pa(x,x.next),l=Pa(l,l.next),Cu(x,h,o,a,y,g),Cu(l,h,o,a,y,g);break t}v=v.next}x=x.next}while(x!==l)}break}}}}function Gr(l,h,o,a){var y=l.prev,g=l.next;if(0<=Vi(y,l,g))return!1;var x=y.x>l.x?y.x>g.x?y.x:g.x:l.x>g.x?l.x:g.x,v=y.y>l.y?y.y>g.y?y.y:g.y:l.y>g.y?l.y:g.y,M=Ki(y.x<l.x?y.x<g.x?y.x:g.x:l.x<g.x?l.x:g.x,y.y<l.y?y.y<g.y?y.y:g.y:l.y<g.y?l.y:g.y,h,o,a);for(h=Ki(x,v,h,o,a),o=l.prevZ,a=l.nextZ;o&&o.z>=M&&a&&a.z<=h;){if(o!==l.prev&&o!==l.next&&en(y.x,y.y,l.x,l.y,g.x,g.y,o.x,o.y)&&0<=Vi(o.prev,o,o.next)||(o=o.prevZ,a!==l.prev&&a!==l.next&&en(y.x,y.y,l.x,l.y,g.x,g.y,a.x,a.y)&&0<=Vi(a.prev,a,a.next)))return!1;a=a.nextZ}for(;o&&o.z>=M;){if(o!==l.prev&&o!==l.next&&en(y.x,y.y,l.x,l.y,g.x,g.y,o.x,o.y)&&0<=Vi(o.prev,o,o.next))return!1;o=o.prevZ}for(;a&&a.z<=h;){if(a!==l.prev&&a!==l.next&&en(y.x,y.y,l.x,l.y,g.x,g.y,a.x,a.y)&&0<=Vi(a.prev,a,a.next))return!1;a=a.nextZ}return!0}function Mh(l,h){return l.x-h.x}function uo(l,h){var o=h,a=l.x,y=l.y,g=-1/0;do{if(y<=o.y&&y>=o.next.y&&o.next.y!==o.y){var x=o.x+(y-o.y)*(o.next.x-o.x)/(o.next.y-o.y);if(x<=a&&x>g){if(g=x,x===a){if(y===o.y)return o;if(y===o.next.y)return o.next}var v=o.x<o.next.x?o:o.next}}o=o.next}while(o!==h);if(!v)return null;if(a===g)return v;h=v,x=v.x;var M=v.y,D=1/0;o=v;do{if(a>=o.x&&o.x>=x&&a!==o.x&&en(y<M?a:g,y,x,M,y<M?g:a,y,o.x,o.y)){var U=Math.abs(y-o.y)/(a-o.x),C;if((C=Jc(o,l))&&!(C=U<D)&&(C=U===D)&&!(C=o.x>v.x)&&(C=o.x===v.x)){C=v;var L=o;C=0>Vi(C.prev,C,L.prev)&&0>Vi(L.next,C,C.next)}C&&(v=o,D=U)}o=o.next}while(o!==h);return v}function Ki(l,h,o,a,y){return l=32767*(l-o)*y,h=32767*(h-a)*y,l=(l|l<<8)&16711935,l=(l|l<<4)&252645135,l=(l|l<<2)&858993459,h=(h|h<<8)&16711935,h=(h|h<<4)&252645135,h=(h|h<<2)&858993459,(l|l<<1)&1431655765|((h|h<<1)&1431655765)<<1}function Da(l){var h=l,o=l;do(h.x<o.x||h.x===o.x&&h.y<o.y)&&(o=h),h=h.next;while(h!==l);return o}function en(l,h,o,a,y,g,x,v){return 0<=(y-x)*(h-v)-(l-x)*(g-v)&&0<=(l-x)*(a-v)-(o-x)*(h-v)&&0<=(o-x)*(g-v)-(y-x)*(a-v)}function Vi(l,h,o){return(h.y-l.y)*(o.x-h.x)-(h.x-l.x)*(o.y-h.y)}function Tu(l,h){return l.x===h.x&&l.y===h.y}function yl(l,h,o,a){var y=qc(Vi(l,h,o)),g=qc(Vi(l,h,a)),x=qc(Vi(o,a,l)),v=qc(Vi(o,a,h));return!!(y!==g&&x!==v||y===0&&Su(l,o,h)||g===0&&Su(l,a,h)||x===0&&Su(o,l,a)||v===0&&Su(o,h,a))}function Su(l,h,o){return h.x<=Math.max(l.x,o.x)&&h.x>=Math.min(l.x,o.x)&&h.y<=Math.max(l.y,o.y)&&h.y>=Math.min(l.y,o.y)}function qc(l){return 0<l?1:0>l?-1:0}function Jc(l,h){return 0>Vi(l.prev,l,l.next)?0<=Vi(l,h,l.next)&&0<=Vi(l,l.prev,h):0>Vi(l,h,l.prev)||0>Vi(l,l.next,h)}function Qc(l,h){var o=new ug(l.i,l.x,l.y),a=new ug(h.i,h.x,h.y),y=l.next,g=h.prev;return l.next=h,h.prev=l,o.next=y,y.prev=o,a.next=o,o.prev=a,g.next=a,a.prev=g,a}function Oa(l,h,o,a){return l=new ug(l,h,o),a?(l.next=a.next,l.prev=a,a.next.prev=l,a.next=l):(l.prev=l,l.next=l),l}function Kc(l){l.next.prev=l.prev,l.prev.next=l.next,l.prevZ&&(l.prevZ.nextZ=l.nextZ),l.nextZ&&(l.nextZ.prevZ=l.prevZ)}function ug(l,h,o){this.i=l,this.x=h,this.y=o,this.nextZ=this.prevZ=this.z=this.next=this.prev=null,this.steiner=!1}function lg(l,h,o,a){for(var y=0,g=o-a;h<o;h+=a)y+=(l[g]-l[h])*(l[h+1]+l[g+1]),g=h;return y}function r1(l){try{return Vu.createObjectURL(new Blob([l],{type:"application/javascript"}))}catch{var h=new nv;return h.append(l),Vu.createObjectURL(h.getBlob(type))}}function xl(l,h){this.shapeLayer=l,this.gl=h,this.initData()}function i1(l,h,o,a){var y=[];return a=a*Math.PI/180,y[0]=(l-o[0])*Math.cos(a)-(h-o[1])*Math.sin(a)+o[0],y[1]=(l-o[0])*Math.sin(a)+(h-o[1])*Math.cos(a)+o[1],y}function Iu(l){var h=0,o=0,a=!0,y=!1,g=void 0;try{for(var x=Bu(l),v;!(a=(v=x.next()).done);a=!0){var M=v.value;h+=M.w*M.h,o=Math.max(o,M.w)}}catch(k){y=!0,g=k}finally{try{!a&&x.return&&x.return()}finally{if(y)throw g}}l.sort(function(k,j){return j.h-k.h}),o=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(h/.95)),o),h:1/0}],y=a=0,g=!0,x=!1,v=void 0;try{for(var D=Bu(l),U;!(g=(U=D.next()).done);g=!0)for(var C=U.value,L=o.length-1;0<=L;L--){var B=o[L];if(!(C.w>B.w||C.h>B.h)){if(C.x=B.x,C.y=B.y,y=Math.max(y,C.y+C.h),a=Math.max(a,C.x+C.w),C.w===B.w&&C.h===B.h){var O=o.pop();L<o.length&&(o[L]=O)}else C.h===B.h?(B.x+=C.w,B.w-=C.w):(C.w!==B.w&&o.push({x:B.x+C.w,y:B.y,w:B.w-C.w,h:C.h}),B.y+=C.h,B.h-=C.h);break}}}catch(k){x=!0,v=k}finally{try{!g&&D.return&&D.return()}finally{if(x)throw v}}return{w:a,h:y,fill:h/(a*y)||0}}function as(l,h){var o=[];return l.forEach(function(a){o.push(h?-a:a,a)}),o}function n1(l){for(var h=1<arguments.length&&arguments[1]!==void 0?arguments[1]:0,o=[],a=0;a<l-1;a++){var y=2*(a+h);o.push(y,y+1,y+2),o.push(y+2,y+1,y+3)}return o}function qp(l){return function(h,o,a){return h=o+l,o=a.length-1,a[0<o?0>h?0:h>o?o:h:h<o?o:0<h?0:h]}}function ta(l){if(!l[0]||!l[0].length)return l;for(var h=l[0].length,o=[],a=0,y=0;y<l.length;y++)for(var g=0;g<h;g++)o[a++]=l[y][g];return o}function Fa(){for(var l=0<arguments.length&&arguments[0]!==void 0?arguments[0]:[],h=[],o=0,a=0;a<l.length;a++){var y=l[a];if(0<a){var g=l[a-1];o+=Math.sqrt(Math.pow(y[0]-g[0],2)+Math.pow(y[1]-g[1],2))}h.push(o)}return{arr:h,total:o}}function Ch(){var l=document.createElement("canvas");l.width=l.height=32;var h=l.getContext("2d");return{canvas:l,ctx:h}}function Th(){var l=(0<arguments.length&&arguments[0]!==void 0?arguments[0]:{}).color,h=Ch(),o=h.canvas;return h=h.ctx,h.save(),h.moveTo(0,0),h.lineTo(20,0),h.lineTo(32,16),h.lineTo(20,32),h.lineTo(0,32),h.lineTo(10,16),h.fillStyle=l||"#fff",h.fill(),h.restore(),o}function Ba(l,h){return Zr.set(l,-h[1],h[0])}function jo(l,h,o){return Zr.sub(l,h,o),Zr.normalize(l,l),l}function Xo(l){var h,o;this.promise=new l(function(a,y){if(h!==void 0||o!==void 0)throw TypeError("Bad Promise constructor");h=a,o=y}),this.resolve=Rs(h),this.reject=Rs(o)}function o1(l,h,o){return o=Math.PI/180*(60*o+30),[l.x+h*Math.cos(o),l.y+h*Math.sin(o)]}function tA(l,h,o){for(var a={},y=[],g=l.length,x=h/2/Math.sin(Math.PI/3),v=1.5*x,M=1,D=0;D<g;++D){var U=l[D].geometry.coordinates;o&&(U=o(U));var C=+U[0],L=+U[1];if(!isNaN(C)&&!isNaN(L)){U=Math.round(L/=v);var B=Math.round(C=C/h-(U&1)/2),O=L-U;if(1<3*Math.abs(O)){var k=C-B,j=B+(C<B?-1:1)/2,V=U+(L<U?-1:1);C-=j,L-=V,k*k+O*O>C*C+L*L&&(B=j+(U&1?1:-1)/2,U=V)}O=B+"-"+U,(k=a[O])?(k.count+=l[D].count||1,M=Math.max(M,k.count)):(a[O]={center:{x:(B+(U&1)/2)*h,y:U*v},count:l[D].count||1},y.push(a[O]))}}return y.max=M,y.r=x,y}function eA(l,h,o,a){switch(a){case 5122:return new Int16Array(l,h,o);case 5123:return new Uint16Array(l,h,o);case 5124:return new Int32Array(l,h,o);case 5125:return new Uint32Array(l,h,o);case 5126:return new Float32Array(l,h,o);default:return null}}function Jp(l){return eA(l.bufferView.data,l.byteOffset,l.count*wv[l.type],l.componentType)}function rA(l){var h="",o=l.lastIndexOf("/");return o!==-1&&(h=l.substring(0,o+1)),h}function iA(l,h){var o=new XMLHttpRequest;o.overrideMimeType("application/json"),o.open("GET",l,!0),o.onreadystatechange=function(){o.readyState==4&&o.status=="200"&&h(o.responseText,this)},o.send(null)}function nA(l,h){var o=new XMLHttpRequest;o.responseType="arraybuffer",o.open("GET",l,!0),o.onreadystatechange=function(){if(o.readyState==4&&o.status=="200"){var a=o.response;a&&h&&h(a)}},o.send(null)}function oA(l,h,o){var a=new Image;a.crossOrigin="Anonymous",a.src=l,a.onload=function(){o(a,h)}}function sA(l){function h(ee,Re){o.uniform1i(ee,Re.index),o.activeTexture(o.TEXTURE0+Re.index),ee=ct.glTF.textures[Re.index],o.bindTexture(o.TEXTURE_2D,ee.texture),o.bindSampler(Re.index,ee.sampler?ee.sampler.sampler:x)}var o=l.gl,a=0,y=[];l=o.canvas;var g=function(ee,Re,xr){for(this.glTFScene=ee,this.glTF=Re,this.id=xr,this.rootTransform=Ke.create(),this.nodeMatrix=Array(Re.nodes.length),ee=0,Re=this.nodeMatrix.length;ee<Re;ee++)this.nodeMatrix[ee]=Ke.create()},x=o.createSampler();o.samplerParameteri(x,o.TEXTURE_MIN_FILTER,o.NEAREST_MIPMAP_LINEAR),o.samplerParameteri(x,o.TEXTURE_MAG_FILTER,o.LINEAR),o.samplerParameteri(x,o.TEXTURE_WRAP_S,o.REPEAT),o.samplerParameteri(x,o.TEXTURE_WRAP_T,o.REPEAT),o.bindVertexArray(null),o.bindVertexArray(null);var v={HAS_SKIN:1,SKIN_VEC8:2,HAS_BASECOLORMAP:4,HAS_NORMALMAP:8,HAS_METALROUGHNESSMAP:16,HAS_OCCLUSIONMAP:32,HAS_EMISSIVEMAP:64},M={},D=function(){this.flags=0,this.programObject=null};D.prototype.hasSkin=function(){return this.flags&v.HAS_SKIN},D.prototype.hasBaseColorMap=function(){return this.flags&v.HAS_BASECOLORMAP},D.prototype.hasNormalMap=function(){return this.flags&v.HAS_NORMALMAP},D.prototype.hasMetalRoughnessMap=function(){return this.flags&v.HAS_METALROUGHNESSMAP},D.prototype.hasOcclusionMap=function(){return this.flags&v.HAS_OCCLUSIONMAP},D.prototype.hasEmissiveMap=function(){return this.flags&v.HAS_EMISSIVEMAP},D.prototype.defineMacro=function(ee){v[ee]!==void 0&&(this.flags|=v[ee])},D.prototype.compile=function(){var ee=M[this.flags];if(ee)this.programObject=ee;else{var Re=ee="";this.flags&v.HAS_SKIN&&(ee+=`#define HAS_SKIN
`),this.flags&v.SKIN_VEC8&&(ee+=`#define SKIN_VEC8
`),this.flags&v.HAS_BASECOLORMAP&&(Re+=`#define HAS_BASECOLORMAP
`),this.flags&v.HAS_NORMALMAP&&(Re+=`#define HAS_NORMALMAP
`),this.flags&v.HAS_METALROUGHNESSMAP&&(Re+=`#define HAS_METALROUGHNESSMAP
`),this.flags&v.HAS_OCCLUSIONMAP&&(Re+=`#define HAS_OCCLUSIONMAP
`),this.flags&v.HAS_EMISSIVEMAP&&(Re+=`#define HAS_EMISSIVEMAP
`),ee=cc.createProgram(o,`#version 300 es
`+ee+`#define POSITION_LOCATION 0
#define NORMAL_LOCATION 1
#define TEXCOORD_0_LOCATION 2
#define JOINTS_0_LOCATION 3
#define JOINTS_1_LOCATION 5
#define WEIGHTS_0_LOCATION 4
#define WEIGHTS_1_LOCATION 6
#define TANGENT_LOCATION 7
precision highp float;precision highp int;uniform mat4 u_MVP;uniform mat4 u_MV;uniform mat4 u_MVNormal;
#ifdef HAS_SKIN
uniform JointMatrix{mat4 matrix[65];}u_jointMatrix;
#endif
layout(location=POSITION_LOCATION)in vec3 position;layout(location=NORMAL_LOCATION)in vec3 normal;layout(location=TEXCOORD_0_LOCATION)in vec2 uv;
#ifdef HAS_SKIN
layout(location=JOINTS_0_LOCATION)in vec4 joint0;layout(location=WEIGHTS_0_LOCATION)in vec4 weight0;
#ifdef SKIN_VEC8
layout(location=JOINTS_1_LOCATION)in vec4 joint1;layout(location=WEIGHTS_1_LOCATION)in vec4 weight1;
#endif
#endif
out vec3 v_position;out vec3 v_normal;out vec2 v_uv;void main(){
#ifdef HAS_SKIN
mat4 skinMatrix=weight0.x*u_jointMatrix.matrix[int(joint0.x)]+weight0.y*u_jointMatrix.matrix[int(joint0.y)]+weight0.z*u_jointMatrix.matrix[int(joint0.z)]+weight0.w*u_jointMatrix.matrix[int(joint0.w)];
#ifdef SKIN_VEC8
skinMatrix+=weight1.x*u_jointMatrix.matrix[int(joint1.x)]+weight1.y*u_jointMatrix.matrix[int(joint1.y)]+weight1.z*u_jointMatrix.matrix[int(joint1.z)]+weight1.w*u_jointMatrix.matrix[int(joint1.w)];
#endif
#endif
v_uv=uv;
#ifdef HAS_SKIN
v_normal=normalize((u_MVNormal*transpose(inverse(skinMatrix))*vec4(normal,0)).xyz);vec4 pos=u_MV*skinMatrix*vec4(position,1.0);gl_Position=u_MVP*skinMatrix*vec4(position,1.0);
#else
v_normal=normalize((u_MVNormal*vec4(normal,0)).xyz);vec4 pos=u_MV*vec4(position,1.0);gl_Position=u_MVP*vec4(position,1.0);
#endif
v_position=vec3(pos.xyz)/pos.w;}`,`#version 300 es
`+Re+`#define FRAG_COLOR_LOCATION 0
precision highp float;precision highp int;uniform sampler2D u_brdfLUT;uniform vec4 u_baseColorFactor;
#ifdef HAS_BASECOLORMAP
uniform sampler2D u_baseColorTexture;
#endif
#ifdef HAS_NORMALMAP
uniform sampler2D u_normalTexture;uniform float u_normalTextureScale;
#endif
#ifdef HAS_EMISSIVEMAP
uniform sampler2D u_emissiveTexture;uniform vec3 u_emissiveFactor;
#endif
#ifdef HAS_METALROUGHNESSMAP
uniform sampler2D u_metallicRoughnessTexture;
#endif
uniform float u_metallicFactor;uniform float u_roughnessFactor;
#ifdef HAS_OCCLUSIONMAP
uniform sampler2D u_occlusionTexture;uniform float u_occlusionStrength;
#endif
in vec3 v_position;in vec3 v_normal;in vec2 v_uv;layout(location=FRAG_COLOR_LOCATION)out vec4 frag_color;struct PBRInfo{float NdotL;float NdotV;float NdotH;float LdotH;float VdotH;float perceptualRoughness;float metalness;vec3 reflectance0;vec3 reflectance90;float alphaRoughness;vec3 diffuseColor;vec3 specularColor;};const float M_PI=3.141592653589793;const float c_MinRoughness=0.04;vec3 getNormal(){vec3 pos_dx=dFdx(v_position);vec3 pos_dy=dFdy(v_position);vec3 tex_dx=dFdx(vec3(v_uv,0.0));vec3 tex_dy=dFdy(vec3(v_uv,0.0));vec3 t=(tex_dy.t*pos_dx-tex_dx.t*pos_dy)/(tex_dx.s*tex_dy.t-tex_dy.s*tex_dx.t);vec3 ng=v_normal;t=normalize(t-ng*dot(ng,t));vec3 b=normalize(cross(ng,t));mat3 tbn=mat3(t,b,ng);
#ifdef HAS_NORMALMAP
vec3 n=texture(u_normalTexture,v_uv).rgb;n=normalize(tbn*((2.0*n-1.0)*vec3(u_normalTextureScale,u_normalTextureScale,1.0)));
#else
vec3 n=tbn[2].xyz;
#endif
return n;}vec3 getIBLContribution(PBRInfo pbrInputs,vec3 n,vec3 reflection){float mipCount=10.0;float lod=(pbrInputs.perceptualRoughness*mipCount);vec3 brdf=texture(u_brdfLUT,vec2(pbrInputs.NdotV,1.0-pbrInputs.perceptualRoughness)).rgb;vec3 diffuseLight=vec3(0.6,0.6,0.6);vec3 specularLight=vec3(0.6,0.6,0.6);vec3 diffuse=diffuseLight*pbrInputs.diffuseColor;vec3 specular=specularLight*(pbrInputs.specularColor*brdf.x+brdf.y);return diffuse+specular;}vec3 diffuse(PBRInfo pbrInputs){return pbrInputs.diffuseColor/M_PI;}vec3 specularReflection(PBRInfo pbrInputs){return pbrInputs.reflectance0+(pbrInputs.reflectance90-pbrInputs.reflectance0)*pow(clamp(1.0-pbrInputs.VdotH,0.0,1.0),5.0);}float geometricOcclusion(PBRInfo pbrInputs){float NdotL=pbrInputs.NdotL;float NdotV=pbrInputs.NdotV;float r=pbrInputs.alphaRoughness;float attenuationL=2.0*NdotL/(NdotL+sqrt(r*r+(1.0-r*r)*(NdotL*NdotL)));float attenuationV=2.0*NdotV/(NdotV+sqrt(r*r+(1.0-r*r)*(NdotV*NdotV)));return attenuationL*attenuationV;}float microfacetDistribution(PBRInfo pbrInputs){float roughnessSq=pbrInputs.alphaRoughness*pbrInputs.alphaRoughness;float f=(pbrInputs.NdotH*roughnessSq-pbrInputs.NdotH)*pbrInputs.NdotH+1.0;return roughnessSq/(M_PI*f*f);}void main(){float perceptualRoughness=u_roughnessFactor;float metallic=u_metallicFactor;
#ifdef HAS_METALROUGHNESSMAP
vec4 mrSample=texture(u_metallicRoughnessTexture,v_uv);perceptualRoughness=mrSample.g*perceptualRoughness;metallic=mrSample.b*metallic;
#endif
perceptualRoughness=clamp(perceptualRoughness,c_MinRoughness,1.0);metallic=clamp(metallic,0.0,1.0);float alphaRoughness=perceptualRoughness*perceptualRoughness;
#ifdef HAS_BASECOLORMAP
vec4 baseColor=texture(u_baseColorTexture,v_uv)*u_baseColorFactor;
#else
vec4 baseColor=u_baseColorFactor;
#endif
vec3 f0=vec3(0.04);vec3 diffuseColor=baseColor.rgb*(vec3(1.0)-f0);diffuseColor*=1.0-metallic;vec3 specularColor=mix(f0,baseColor.rgb,metallic);float reflectance=max(max(specularColor.r,specularColor.g),specularColor.b);float reflectance90=clamp(reflectance*25.0,0.0,1.0);vec3 specularEnvironmentR0=specularColor.rgb;vec3 specularEnvironmentR90=vec3(1.0,1.0,1.0)*reflectance90;vec3 n=getNormal();vec3 v=normalize(-v_position);vec3 l=normalize(vec3(1.0,1.0,1.0));vec3 h=normalize(l+v);vec3 reflection=-normalize(reflect(v,n));float NdotL=clamp(dot(n,l),0.001,1.0);float NdotV=abs(dot(n,v))+0.001;float NdotH=clamp(dot(n,h),0.0,1.0);float LdotH=clamp(dot(l,h),0.0,1.0);float VdotH=clamp(dot(v,h),0.0,1.0);PBRInfo pbrInputs=PBRInfo(NdotL,NdotV,NdotH,LdotH,VdotH,perceptualRoughness,metallic,specularEnvironmentR0,specularEnvironmentR90,alphaRoughness,diffuseColor,specularColor);vec3 F=specularReflection(pbrInputs);float G=geometricOcclusion(pbrInputs);float D=microfacetDistribution(pbrInputs);vec3 diffuseContrib=(1.0-F)*diffuse(pbrInputs);vec3 specContrib=max(vec3(0.0),F*G*D/(4.0*NdotL*NdotV));vec3 color=NdotL*(diffuseContrib+specContrib);color+=getIBLContribution(pbrInputs,n,reflection);
#ifdef HAS_OCCLUSIONMAP
float ao=texture(u_occlusionTexture,v_uv).r;color=mix(color,color*ao,u_occlusionStrength);
#endif
#ifdef HAS_EMISSIVEMAP
vec3 emissive=texture(u_emissiveTexture,v_uv).rgb*u_emissiveFactor;color+=emissive;
#endif
frag_color=vec4(color,baseColor.a);}`),this.programObject={program:ee,uniformLocations:{},uniformBlockIndices:{}},this.flags&v.HAS_SKIN&&(this.programObject.uniformBlockIndices.JointMatrix=o.getUniformBlockIndex(ee,"JointMatrix")),Re=this.programObject.uniformLocations,Re.MVP=o.getUniformLocation(ee,"u_MVP"),Re.MVNormal=o.getUniformLocation(ee,"u_MVNormal"),Re.MV=o.getUniformLocation(ee,"u_MV"),Re.baseColorFactor=o.getUniformLocation(ee,"u_baseColorFactor"),Re.metallicFactor=o.getUniformLocation(ee,"u_metallicFactor"),Re.roughnessFactor=o.getUniformLocation(ee,"u_roughnessFactor"),this.flags&v.HAS_BASECOLORMAP&&(Re.baseColorTexture=o.getUniformLocation(ee,"u_baseColorTexture")),this.flags&v.HAS_NORMALMAP&&(Re.normalTexture=o.getUniformLocation(ee,"u_normalTexture"),Re.normalTextureScale=o.getUniformLocation(ee,"u_normalTextureScale")),this.flags&v.HAS_METALROUGHNESSMAP&&(Re.metallicRoughnessTexture=o.getUniformLocation(ee,"u_metallicRoughnessTexture")),this.flags&v.HAS_OCCLUSIONMAP&&(Re.occlusionTexture=o.getUniformLocation(ee,"u_occlusionTexture"),Re.occlusionStrength=o.getUniformLocation(ee,"u_occlusionStrength")),this.flags&v.HAS_EMISSIVEMAP&&(Re.emissiveTexture=o.getUniformLocation(ee,"u_emissiveTexture"),Re.emissiveFactor=o.getUniformLocation(ee,"u_emissiveFactor")),o.useProgram(null),M[this.flags]=this.programObject}};var U=1,C=dr.create(),L=Ke.create();Nf.create();var B=[];o.enable(o.CULL_FACE),o.cullFace(o.BACK),o.frontFace(o.CCW);var O=!0;o.enable(o.DEPTH_TEST),o.depthFunc(o.LEQUAL);var k=k||{},j=null;dr.create();var V=Ke.create();Ke.perspective(V,.785,l.width/l.height,.01,100),Ke.create();var Y=Ke.create(),Q=Ke.create(),nt=Ke.create();Ke.create();var ut,ct,Tt=[1,1,1,1],Lt=k.drawPrimitive=function(ee,Re){if(mr){Q=Y=mr.matrix,Ke.invert(nt,Y),Ke.transpose(nt,nt),Re=Tt;var xr=ee.shader,gr=ee.material;if(gr!==null){var Be=gr.pbrMetallicRoughness;Re=Be.baseColorFactor,ee.material.doubleSided===O&&((O=!ee.material.doubleSided)?o.enable(o.CULL_FACE):o.disable(o.CULL_FACE))}j!=ee.shader.programObject&&(j=ee.shader.programObject,o.useProgram(j.program)),gr&&(xr.hasBaseColorMap()&&h(j.uniformLocations.baseColorTexture,Be.baseColorTexture),xr.hasNormalMap()&&(h(j.uniformLocations.normalTexture,gr.normalTexture),o.uniform1f(j.uniformLocations.normalTextureScale,gr.normalTexture.scale)),xr.hasMetalRoughnessMap()&&h(j.uniformLocations.metallicRoughnessTexture,Be.metallicRoughnessTexture),o.uniform1f(j.uniformLocations.metallicFactor,Be.metallicFactor),o.uniform1f(j.uniformLocations.roughnessFactor,Be.roughnessFactor),xr.hasOcclusionMap()&&(h(j.uniformLocations.occlusionTexture,gr.occlusionTexture),o.uniform1f(j.uniformLocations.occlusionStrength,gr.occlusionTexture.strength)),xr.hasEmissiveMap()&&(h(j.uniformLocations.emissiveTexture,gr.emissiveTexture),o.uniform3fv(j.uniformLocations.emissiveFactor,gr.emissiveFactor))),xr.hasSkin()&&o.uniformBlockBinding(j.program,j.uniformBlockIndices.JointMatrix,ut),o.activeTexture(o.TEXTURE0+29),o.bindTexture(o.TEXTURE_2D,null),o.uniform4fv(j.uniformLocations.baseColorFactor,Re),o.uniformMatrix4fv(j.uniformLocations.MV,!1,Y),o.uniformMatrix4fv(j.uniformLocations.MVP,!1,Q),o.uniformMatrix4fv(j.uniformLocations.MVNormal,!1,nt),o.bindVertexArray(ee.vertexArray),ee.indices!==null?o.drawElements(ee.mode,ee.indicesLength,ee.indicesComponentType,ee.indicesOffset):o.drawArrays(ee.mode,ee.drawArraysOffset,ee.drawArraysCount),o.bindVertexArray(null)}},Dt=Ke.create(),ae=Ke.create(),ne=k.drawNode=function(ee,Re,xr,gr){if(Re=xr[Re],gr!==void 0?Ke.mul(Re,gr,ee.matrix):Ke.copy(Re,ee.matrix),ee.skin!==null){var Be=ee.skin;ut=Be.uniformBlockID;var Mo=ee.skin.joints;for(Ke.invert(ae,Re),gr=0,Ii=Mo.length;gr<Ii;gr++){var Ni=Mo[gr];Ke.mul(Dt,xr[Ni.nodeID],Be.inverseBindMatrix[gr]),Ke.mul(Dt,ae,Dt),Be.jointMatrixUnidormBufferData.set(Dt,16*gr)}o.bindBuffer(o.UNIFORM_BUFFER,Be.jointMatrixUniformBuffer),o.bufferSubData(o.UNIFORM_BUFFER,0,Be.jointMatrixUnidormBufferData,0,Be.jointMatrixUnidormBufferData.length)}var Ii;if(ee.mesh!==null)for(Be=ee.mesh,gr=0,Ii=Be.primitives.length;gr<Ii;gr++)Lt(Be.primitives[gr],Re);for(ee.skin!==null&&o.bindBuffer(o.UNIFORM_BUFFER,null),gr=0,Ii=ee.children.length;gr<Ii;gr++)ne(ee.children[gr],ee.children[gr].nodeID,xr,Re)},we=k.drawScene=function(ee){var Re=ee.glTF;if(Re.animations){var xr=Re.animations[a],gr,Be=0;for(gr=xr.samplers.length;Be<gr;Be++)xr.samplers[Be].getValue(Ye);for(Be=0,gr=xr.channels.length;Be<gr;Be++){var Mo=xr.channels[Be],Ni=Mo.sampler,Ii=Re.nodes[Mo.target.nodeID];switch(Mo.target.path){case"rotation":on.copy(Ii.rotation,Ni.curValue);break;case"translation":dr.copy(Ii.translation,Ni.curValue);break;case"scale":dr.copy(Ii.scale,Ni.curValue)}Ii.updateMatrixFromTRS()}}for(xr=0,Re=ee.glTFScene.nodes.length;xr<Re;xr++)ne(ee.glTFScene.nodes[xr],ee.glTFScene.nodes[xr].nodeID,ee.nodeMatrix,ee.rootTransform)},xe=performance.now(),Ye=0,mr;return{setupScene:function(ee,Re){function xr(op,Nd){if(op!==void 0){var _s=op.bufferView;return _s.target===null?(o.bindBuffer(o.ARRAY_BUFFER,_s.buffer),o.bufferData(o.ARRAY_BUFFER,_s.data,o.STATIC_DRAW)):o.bindBuffer(_s.target,_s.buffer),op.prepareVertexAttrib(Nd,o),!0}return!1}var gr;if(ee.animations){var Be=0;for(gr=ee.animations.length;Be<gr;Be++)y.add(ee.animations[Be].name||Be)}a=0,Be=ee.scenes[ee.defaultScene],dr.fromValues(1.2*Be.boundingBox.transform[0],0,0),dr.create(),Re?Re=B[Re.id]=new g(Be,ee,Re.id):(Re=new g(Be,ee,B.length),B.push(Re)),B.length===1&&(Ke.identity(L),U=1/Math.max(Be.boundingBox.transform[0],Math.max(Be.boundingBox.transform[5],Be.boundingBox.transform[10])),Ke.getTranslation(C,Be.boundingBox.transform),dr.scale(C,C,-1),C[0]+=-.5*Be.boundingBox.transform[0],C[1]+=-.5*Be.boundingBox.transform[5],C[2]+=-.5*Be.boundingBox.transform[10],U*=.5,L[0]=U,L[5]=U,L[10]=U,Ke.translate(L,L,C),dr.set(C,0,0,-1.5),U=1);var Mo;for(Be=0,gr=ee.bufferViews.length;Be<gr;Be++){var Ni=ee.bufferViews[Be];Ni.createBuffer(o),Ni.bindData(o)}if(ee.textures)for(Be=0,gr=ee.textures.length;Be<gr;Be++){var Ii=ee.textures[Be];Ii.createTexture(o)}if(ee.samplers)for(Be=0,gr=ee.samplers.length;Be<gr;Be++)Ii=ee.samplers[Be],Ii.createSampler(o);if(ee.skins)for(Be=0,gr=ee.skins.length;Be<gr;Be++)Ii=ee.skins[Be],Ii.jointMatrixUniformBuffer=o.createBuffer(),o.bindBufferBase(o.UNIFORM_BUFFER,Ii.uniformBlockID,Ii.jointMatrixUniformBuffer),o.bindBuffer(o.UNIFORM_BUFFER,Ii.jointMatrixUniformBuffer),o.bufferData(o.UNIFORM_BUFFER,Ii.jointMatrixUnidormBufferData,o.DYNAMIC_DRAW),o.bufferSubData(o.UNIFORM_BUFFER,0,Ii.jointMatrixUnidormBufferData),o.bindBuffer(o.UNIFORM_BUFFER,null);var Mv=0;for(Mo=ee.meshes.length;Mv<Mo;Mv++)for(Ii=ee.meshes[Mv],Be=0,gr=Ii.primitives.length;Be<gr;++Be){var Hi=Ii.primitives[Be];Hi.shader=new D,Hi.vertexArray=Ni=o.createVertexArray(),o.bindVertexArray(Ni),xr(Hi.attributes.POSITION,0),xr(Hi.attributes.NORMAL,1),xr(Hi.attributes.TEXCOORD_0,2),xr(Hi.attributes.JOINTS_0,3)&&xr(Hi.attributes.WEIGHTS_0,4)&&Hi.shader.defineMacro("HAS_SKIN"),xr(Hi.attributes.JOINTS_1,5)&&xr(Hi.attributes.WEIGHTS_1,6)&&Hi.shader.defineMacro("SKIN_VEC8"),Hi.indices!==null&&(Ni=ee.accessors[Hi.indices],Ni=Ni.bufferView,Ni.target===null?(o.bindBuffer(o.ELEMENT_ARRAY_BUFFER,Ni.buffer),o.bufferData(o.ELEMENT_ARRAY_BUFFER,Ni.data,o.STATIC_DRAW)):o.bindBuffer(o.ELEMENT_ARRAY_BUFFER,Ni.buffer)),o.bindVertexArray(null),o.bindBuffer(o.ARRAY_BUFFER,null),o.bindBuffer(o.ELEMENT_ARRAY_BUFFER,null),(Ni=Hi.material)&&(Ni.pbrMetallicRoughness.baseColorTexture&&Hi.shader.defineMacro("HAS_BASECOLORMAP"),Ni.pbrMetallicRoughness.metallicRoughnessTexture&&Hi.shader.defineMacro("HAS_METALROUGHNESSMAP"),Ni.normalTexture&&Hi.shader.defineMacro("HAS_NORMALMAP"),Ni.occlusionTexture&&Hi.shader.defineMacro("HAS_OCCLUSIONMAP"),Ni.emissiveTexture&&Hi.shader.defineMacro("HAS_EMISSIVEMAP")),Hi.shader.compile()}return Re},render:k.render=function(ee){mr=ee,ee=new Date().getTime();var Re,xr=0;for(Re=B.length;xr<Re;xr++)ct=B[xr],we(B[xr]);j=null,Ye=.001*(ee-xe)}}}function aA(l,h,o,a,y,g){if(typeof h=="string"&&typeof o=="number"&&typeof a=="number")for(h=h.split(g),g=0;g<h.length;g++)l.fillText(h[g],o,a),a+=y}function An(l){this.options=l=l||{},l.colors=l.colors||["rgba(0,192,73,0.99609375)","rgba(242,48,48,0.99609375)","rgba(255,159,25,0.99609375)"];var h=l.colors;this.drawTogether=!0,this.parseColors(h),this.tileSize=256,this.ratio=window.devicePixelRatio,this.cache={},l.getTileUrl&&(this.getTileUrl=l.getTileUrl),this._loadCount={}}function uA(l){var h=l/2,o=l+h,a=new Ln(2*o,2*o),y=a.getContext("2d");return y.shadowBlur=h,y.shadowColor="black",y.shadowOffsetX=y.shadowOffsetY=1e4,y.beginPath(),y.arc(o-1e4,o-1e4,l,0,2*Math.PI,!0),y.closePath(),y.fill(),a}var hg=window.BMapGL||window.BMap;hg&&hg.Overlay&&(tt.prototype=new hg.Overlay),tt.prototype.initialize=function(l){this._map=l;var h=this.canvas=document.createElement("canvas"),o=this.ctx=this.canvas.getContext("2d");h.style.cssText="position:absolute;left:0;top:0;z-index:"+this.zIndex+";",this.adjustSize(),this.adjustRatio(o),l.getContainer().appendChild(h);var a=this;return l.addEventListener("resize",function(){a.adjustSize(),a._draw()}),this.canvas},tt.prototype.adjustSize=function(){var l=this._map.getSize(),h=this.canvas;h.width=l.width,h.height=l.height,h.style.width=h.width+"px",h.style.height=h.height+"px"},tt.prototype.adjustRatio=function(l){var h=(window.devicePixelRatio||1)/(l.backingStorePixelRatio||l.webkitBackingStorePixelRatio||l.mozBackingStorePixelRatio||l.msBackingStorePixelRatio||l.oBackingStorePixelRatio||l.backingStorePixelRatio||1),o=l.canvas.width,a=l.canvas.height;l.canvas.width=o*h,l.canvas.height=a*h,l.canvas.style.width=o+"px",l.canvas.style.height=a+"px",l.scale(h,h)},tt.prototype.draw=function(){this._draw.apply(this,arguments)},tt.prototype._draw=function(){this.dispatchEvent("draw"),this.options.update&&this.options.update.apply(this,arguments)},tt.prototype.getContainer=function(){return this.canvas},tt.prototype.show=function(){this.canvas||this._map.addOverlay(this),this.canvas.style.display="block"},tt.prototype.hide=function(){this.canvas.style.display="none"},tt.prototype.setZIndex=function(l){this.canvas.style.zIndex=l},tt.prototype.getZIndex=function(){return this.zIndex};var s1=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof Gc!="undefined"?Gc:typeof self!="undefined"?self:{},lA=ht(function(l,h){h.__esModule=!0,h.default=function(o,a){if(!(o instanceof a))throw new TypeError("Cannot call a class as a function")}}),Xe=ot(lA),Eu=function(l){if(l==null)throw TypeError("Can't call method on  "+l);return l},hA={}.hasOwnProperty,Wi=function(l,h){return hA.call(l,h)},cA={}.toString,Al=function(l){return cA.call(l).slice(8,-1)},cg=Object("z").propertyIsEnumerable(0)?Object:function(l){return Al(l)=="String"?l.split(""):Object(l)},ea=function(l){return cg(Eu(l))},fA=Math.ceil,pA=Math.floor,fg=function(l){return isNaN(l=+l)?0:(0<l?pA:fA)(l)},dA=Math.min,Qp=function(l){return 0<l?dA(fg(l),9007199254740991):0},mA=Math.max,gA=Math.min,Ui=ht(function(l){l=l.exports={version:"2.6.5"},typeof __e=="number"&&(__e=l)}),Qr=ht(function(l){l=l.exports=typeof window!="undefined"&&Math==Math?window:typeof self!="undefined"&&self.Math==Math?self:Function("return this")(),typeof __g=="number"&&(__g=l)}),$c=ht(function(l){var h=Qr["__core-js_shared__"]||(Qr["__core-js_shared__"]={});(l.exports=function(o,a){return h[o]||(h[o]=a!==void 0?a:{})})("versions",[]).push({version:Ui.version,mode:"pure",copyright:"\xA9 2019 Denis Pushkarev (zloirock.ru)"})}),a1=0,u1=Math.random(),Ls=function(l){return"Symbol(".concat(l===void 0?"":l,")_",(++a1+u1).toString(36))},pg=$c("keys"),Kp=function(l){return pg[l]||(pg[l]=Ls(l))},l1=function(l){return function(h,o,a){h=ea(h);var y=Qp(h.length);if(a=fg(a),a=0>a?mA(a+y,0):gA(a,y),l&&o!=o){for(;y>a;)if(o=h[a++],o!=o)return!0}else for(;y>a;a++)if((l||a in h)&&h[a]===o)return l||a||0;return!l&&-1}}(!1),tf=Kp("IE_PROTO"),h1=function(l,h){l=ea(l);var o=0,a=[],y;for(y in l)y!=tf&&Wi(l,y)&&a.push(y);for(;h.length>o;)Wi(l,y=h[o++])&&(~l1(a,y)||a.push(y));return a},$p="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" "),Sh=Object.keys||function(l){return h1(l,$p)},Rs=function(l){if(typeof l!="function")throw TypeError(l+" is not a function!");return l},Un=function(l,h,o){if(Rs(l),h===void 0)return l;switch(o){case 1:return function(a){return l.call(h,a)};case 2:return function(a,y){return l.call(h,a,y)};case 3:return function(a,y,g){return l.call(h,a,y,g)}}return function(){return l.apply(h,arguments)}},$n=function(l){return typeof l=="object"?l!==null:typeof l=="function"},to=function(l){if(!$n(l))throw TypeError(l+" is not an object!");return l},za=function(l){try{return!!l()}catch{return!0}},Lo=!za(function(){return Object.defineProperty({},"a",{get:function(){return 7}}).a!=7}),_l=Qr.document,td=$n(_l)&&$n(_l.createElement),c1=!Lo&&!za(function(){return Object.defineProperty(td?_l.createElement("div"):{},"a",{get:function(){return 7}}).a!=7}),ef=function(l,h){if(!$n(l))return l;var o,a;if(h&&typeof(o=l.toString)=="function"&&!$n(a=o.call(l))||typeof(o=l.valueOf)=="function"&&!$n(a=o.call(l))||!h&&typeof(o=l.toString)=="function"&&!$n(a=o.call(l)))return a;throw TypeError("Can't convert object to primitive value")},vA=Object.defineProperty,Yo={f:Lo?Object.defineProperty:function(l,h,o){if(to(l),h=ef(h,!0),to(o),c1)try{return vA(l,h,o)}catch{}if("get"in o||"set"in o)throw TypeError("Accessors not supported!");return"value"in o&&(l[h]=o.value),l}},Lu=function(l,h){return{enumerable:!(l&1),configurable:!(l&2),writable:!(l&4),value:h}},Na=Lo?function(l,h,o){return Yo.f(l,h,Lu(1,o))}:function(l,h,o){return l[h]=o,l},lo=function(l,h,o){var a=l&lo.F,y=l&lo.G,g=l&lo.S,x=l&lo.P,v=l&lo.B,M=l&lo.W,D=y?Ui:Ui[h]||(Ui[h]={}),U=D.prototype;g=y?Qr:g?Qr[h]:(Qr[h]||{}).prototype;var C;y&&(o=h);for(C in o)if(h=!a&&g&&g[C]!==void 0,!h||!Wi(D,C)){var L=h?g[C]:o[C];D[C]=y&&typeof g[C]!="function"?o[C]:v&&h?Un(L,Qr):M&&g[C]==L?function(B){var O=function(k,j,V){if(this instanceof B){switch(arguments.length){case 0:return new B;case 1:return new B(k);case 2:return new B(k,j)}return new B(k,j,V)}return B.apply(this,arguments)};return O.prototype=B.prototype,O}(L):x&&typeof L=="function"?Un(Function.call,L):L,x&&((D.virtual||(D.virtual={}))[C]=L,l&lo.R&&U&&!U[C]&&Na(U,C,L))}};lo.F=1,lo.G=2,lo.S=4,lo.P=8,lo.B=16,lo.W=32,lo.U=64,lo.R=128;var Ar=lo,rf=function(l,h){var o=(Ui.Object||{})[l]||Object[l],a={};a[l]=h(o),Ar(Ar.S+Ar.F*za(function(){o(1)}),"Object",a)};rf("keys",function(){return function(l){return Sh(Object(Eu(l)))}});var yA=Ui.Object.keys,xA=ht(function(l){l.exports={default:yA,__esModule:!0}}),bn=ot(xA),dg=Object.getOwnPropertySymbols,ed={}.propertyIsEnumerable,nf=Object.assign,AA=!nf||za(function(){var l={},h={},o=Symbol();return l[o]=7,"abcdefghijklmnopqrst".split("").forEach(function(a){h[a]=a}),nf({},l)[o]!=7||Object.keys(nf({},h)).join("")!="abcdefghijklmnopqrst"})?function(l,h){for(var o=Object(Eu(l)),a=arguments.length,y=1,g=dg,x=ed;a>y;)for(var v=cg(arguments[y++]),M=g?Sh(v).concat(g(v)):Sh(v),D=M.length,U=0,C;D>U;)x.call(v,C=M[U++])&&(o[C]=v[C]);return o}:nf;Ar(Ar.S+Ar.F,"Object",{assign:AA});var wl=Ui.Object.assign,Ml=ht(function(l){l.exports={default:wl,__esModule:!0}}),Vr=ot(Ml),f1=Kp("IE_PROTO"),_A=Object.prototype,p1=Object.getPrototypeOf||function(l){return l=Object(Eu(l)),Wi(l,f1)?l[f1]:typeof l.constructor=="function"&&l instanceof l.constructor?l.constructor.prototype:l instanceof Object?_A:null};rf("getPrototypeOf",function(){return function(l){return p1(Object(Eu(l)))}});var mg=Ui.Object.getPrototypeOf,Zo=ht(function(l){l.exports={default:mg,__esModule:!0}}),ur=ot(Zo);Ar(Ar.S+Ar.F*!Lo,"Object",{defineProperty:Yo.f});var d1=Ui.Object,wA=function(l,h,o){return d1.defineProperty(l,h,o)},ra=ht(function(l){l.exports={default:wA,__esModule:!0}}),pn=ot(ra),gg=ht(function(l,h){h.__esModule=!0;var o=ra&&ra.__esModule?ra:{default:ra};h.default=function(){function a(y,g){for(var x=0;x<g.length;x++){var v=g[x];v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),(0,o.default)(y,v.key,v)}}return function(y,g,x){return g&&a(y.prototype,g),x&&a(y,x),y}}()}),Ue=ot(gg),Ro={},Cl=Lo?Object.defineProperties:function(l,h){to(l);for(var o=Sh(h),a=o.length,y=0,g;a>y;)Yo.f(l,g=o[y++],h[g]);return l},rd=Qr.document,Ih=rd&&rd.documentElement,id=Kp("IE_PROTO"),Eh=function(){},Tl=function(){var l=td?_l.createElement("iframe"):{},h=$p.length;for(l.style.display="none",Ih.appendChild(l),l.src="javascript:",l=l.contentWindow.document,l.open(),l.write("<script>document.F=Object<\/script>"),l.close(),Tl=l.F;h--;)delete Tl.prototype[$p[h]];return Tl()},ia=Object.create||function(l,h){if(l!==null){Eh.prototype=to(l);var o=new Eh;Eh.prototype=null,o[id]=l}else o=Tl();return h===void 0?o:Cl(o,h)},_n=ht(function(l){var h=$c("wks"),o=Qr.Symbol,a=typeof o=="function";(l.exports=function(y){return h[y]||(h[y]=a&&o[y]||(a?o:Ls)("Symbol."+y))}).store=h}),$i=Yo.f,Po=_n("toStringTag"),Fi=function(l,h,o){l&&!Wi(l=o?l:l.prototype,Po)&&$i(l,Po,{configurable:!0,value:h})},of={};Na(of,_n("iterator"),function(){return this});var Ps=function(l,h,o){l.prototype=ia(of,{next:Lu(1,o)}),Fi(l,h+" Iterator")},Ru=_n("iterator"),sf=!([].keys&&"next"in[].keys()),m1=function(){return this},Sl=function(l,h,o,a,y,g,x){Ps(o,h,a),a=function(V){return!sf&&V in U?U[V]:function(){return new o(this,V)}};var v=h+" Iterator",M=y=="values",D=!1,U=l.prototype,C=U[Ru]||U["@@iterator"]||y&&U[y],L=C||a(y),B=y?M?a("entries"):L:void 0,O=h=="Array"&&U.entries||C,k;if(O&&(l=p1(O.call(new l)),l!==Object.prototype&&l.next&&Fi(l,v,!0)),M&&C&&C.name!=="values"&&(D=!0,L=function(){return C.call(this)}),x&&(sf||D||!U[Ru])&&Na(U,Ru,L),Ro[h]=L,Ro[v]=m1,y){var j={values:M?L:a("values"),keys:g?L:a("keys"),entries:B};if(x)for(k in j)k in U||Na(U,k,j[k]);else Ar(Ar.P+Ar.F*(sf||D),h,j)}return j},nd=function(l){return function(h,o){h=String(Eu(h)),o=fg(o);var a=h.length,y;if(0>o||o>=a)return l?"":void 0;var g=h.charCodeAt(o);return 55296>g||56319<g||o+1===a||56320>(y=h.charCodeAt(o+1))||57343<y?l?h.charAt(o):g:l?h.slice(o,o+2):(g-55296<<10)+(y-56320)+65536}}(!0);Sl(String,"String",function(l){this._t=String(l),this._i=0},function(){var l=this._t,h=this._i;return h>=l.length?{value:void 0,done:!0}:(l=nd(l,h),this._i+=l.length,{value:l,done:!1})});var Ds=function(l,h){return{value:h,done:!!l}};Sl(Array,"Array",function(l,h){this._t=ea(l),this._i=0,this._k=h},function(){var l=this._t,h=this._k,o=this._i++;return!l||o>=l.length?(this._t=void 0,Ds(1)):h=="keys"?Ds(0,o):h=="values"?Ds(0,l[o]):Ds(0,[o,l[o]])},"values"),Ro.Arguments=Ro.Array;for(var af=_n("toStringTag"),uf="CSSRuleList CSSStyleDeclaration CSSValueList ClientRectList DOMRectList DOMStringList DOMTokenList DataTransferItemList FileList HTMLAllCollection HTMLCollection HTMLFormElement HTMLSelectElement MediaList MimeTypeArray NamedNodeMap NodeList PaintRequestList Plugin PluginArray SVGLengthList SVGNumberList SVGPathSegList SVGPointList SVGStringList SVGTransformList SourceBufferList StyleSheetList TextTrackCueList TextTrackList TouchList".split(" "),Il=0;Il<uf.length;Il++){var Lh=uf[Il],Do=Qr[Lh],Rh=Do&&Do.prototype;Rh&&!Rh[af]&&Na(Rh,af,Lh),Ro[Lh]=Ro.Array}var Pu={f:_n},od=Pu.f("iterator"),na=ht(function(l){l.exports={default:od,__esModule:!0}});ot(na);var El=ht(function(l){var h=Ls("meta"),o=Yo.f,a=0,y=Object.isExtensible||function(){return!0},g=!za(function(){return y(Object.preventExtensions({}))}),x=function(M){o(M,h,{value:{i:"O"+ ++a,w:{}}})},v=l.exports={KEY:h,NEED:!1,fastKey:function(M,D){if(!$n(M))return typeof M=="symbol"?M:(typeof M=="string"?"S":"P")+M;if(!Wi(M,h)){if(!y(M))return"F";if(!D)return"E";x(M)}return M[h].i},getWeak:function(M,D){if(!Wi(M,h)){if(!y(M))return!0;if(!D)return!1;x(M)}return M[h].w},onFreeze:function(M){return g&&v.NEED&&y(M)&&!Wi(M,h)&&x(M),M}}}),lf=Yo.f,Ph=function(l){var h=Ui.Symbol||(Ui.Symbol={});l.charAt(0)=="_"||l in h||lf(h,l,{value:Pu.f(l)})},Ll=Array.isArray||function(l){return Al(l)=="Array"},sd=$p.concat("length","prototype"),Rl=Object.getOwnPropertyNames||function(l){return h1(l,sd)},hf=Rl,cf={}.toString,ff=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],Dh=function(l){if(ff&&cf.call(l)=="[object Window]")try{var h=hf(l)}catch{h=ff.slice()}else h=hf(ea(l));return h},vg=Object.getOwnPropertyDescriptor,Os={f:Lo?vg:function(l,h){if(l=ea(l),h=ef(h,!0),c1)try{return vg(l,h)}catch{}if(Wi(l,h))return Lu(!ed.call(l,h),l[h])}},pf=El.KEY,g1=Os.f,Pl=Yo.f,v1=Dh,ho=Qr.Symbol,ad=Qr.JSON,Ua=ad&&ad.stringify,pi=_n("_hidden"),df=_n("toPrimitive"),y1={}.propertyIsEnumerable,Du=$c("symbol-registry"),us=$c("symbols"),ba=$c("op-symbols"),ls=Object.prototype,Dl=typeof ho=="function",Ol=Qr.QObject,mf=!Ol||!Ol.prototype||!Ol.prototype.findChild,ud=Lo&&za(function(){return ia(Pl({},"a",{get:function(){return Pl(this,"a",{value:7}).a}})).a!=7})?function(l,h,o){var a=g1(ls,h);a&&delete ls[h],Pl(l,h,o),a&&l!==ls&&Pl(ls,h,a)}:Pl,yg=function(l){var h=us[l]=ia(ho.prototype);return h._k=l,h},Ou=Dl&&typeof ho.iterator=="symbol"?function(l){return typeof l=="symbol"}:function(l){return l instanceof ho},hs=function(l,h,o){return l===ls&&hs(ba,h,o),to(l),h=ef(h,!0),to(o),Wi(us,h)?(o.enumerable?(Wi(l,pi)&&l[pi][h]&&(l[pi][h]=!1),o=ia(o,{enumerable:Lu(0,!1)})):(Wi(l,pi)||Pl(l,pi,Lu(1,{})),l[pi][h]=!0),ud(l,h,o)):Pl(l,h,o)},xg=function(l,h){to(l);var o=h=ea(h),a=Sh(o),y=dg;if(y){y=y(o);for(var g=ed,x=0,v;y.length>x;)g.call(o,v=y[x++])&&a.push(v)}o=0,v=a.length;for(var M;v>o;)hs(l,M=a[o++],h[M]);return l},ld=function(l){var h=y1.call(this,l=ef(l,!0));return this===ls&&Wi(us,l)&&!Wi(ba,l)?!1:h||!Wi(this,l)||!Wi(us,l)||Wi(this,pi)&&this[pi][l]?h:!0},Oh=function(l,h){if(l=ea(l),h=ef(h,!0),l!==ls||!Wi(us,h)||Wi(ba,h)){var o=g1(l,h);return!o||!Wi(us,h)||Wi(l,pi)&&l[pi][h]||(o.enumerable=!0),o}},gf=function(l){l=v1(ea(l));for(var h=[],o=0,a;l.length>o;)Wi(us,a=l[o++])||a==pi||a==pf||h.push(a);return h},Fl=function(l){var h=l===ls;l=v1(h?ba:ea(l));for(var o=[],a=0,y;l.length>a;)Wi(us,y=l[a++])&&(h?Wi(ls,y):1)&&o.push(us[y]);return o};Dl||(ho=function(){if(this instanceof ho)throw TypeError("Symbol is not a constructor!");var l=Ls(0<arguments.length?arguments[0]:void 0),h=function(o){this===ls&&h.call(ba,o),Wi(this,pi)&&Wi(this[pi],l)&&(this[pi][l]=!1),ud(this,l,Lu(1,o))};return Lo&&mf&&ud(ls,l,{configurable:!0,set:h}),yg(l)},Na(ho.prototype,"toString",function(){return this._k}),Os.f=Oh,Yo.f=hs,Rl=Dh=gf,ed=ld,dg=Fl,Pu.f=function(l){return yg(_n(l))}),Ar(Ar.G+Ar.W+Ar.F*!Dl,{Symbol:ho});for(var vf="hasInstance isConcatSpreadable iterator match replace search species split toPrimitive toStringTag unscopables".split(" "),Fh=0;vf.length>Fh;)_n(vf[Fh++]);for(var yf=Sh(_n.store),Bh=0;yf.length>Bh;)Ph(yf[Bh++]);Ar(Ar.S+Ar.F*!Dl,"Symbol",{for:function(l){return Wi(Du,l+="")?Du[l]:Du[l]=ho(l)},keyFor:function(l){if(!Ou(l))throw TypeError(l+" is not a symbol!");for(var h in Du)if(Du[h]===l)return h},useSetter:function(){mf=!0},useSimple:function(){mf=!1}}),Ar(Ar.S+Ar.F*!Dl,"Object",{create:function(l,h){return h===void 0?ia(l):xg(ia(l),h)},defineProperty:hs,defineProperties:xg,getOwnPropertyDescriptor:Oh,getOwnPropertyNames:gf,getOwnPropertySymbols:Fl}),ad&&Ar(Ar.S+Ar.F*(!Dl||za(function(){var l=ho();return Ua([l])!="[null]"||Ua({a:l})!="{}"||Ua(Object(l))!="{}"})),"JSON",{stringify:function(l){for(var h=[l],o=1,a;arguments.length>o;)h.push(arguments[o++]);if(a=o=h[1],($n(o)||l!==void 0)&&!Ou(l))return Ll(o)||(o=function(y,g){if(typeof a=="function"&&(g=a.call(this,y,g)),!Ou(g))return g}),h[1]=o,Ua.apply(ad,h)}}),ho.prototype[df]||Na(ho.prototype,df,ho.prototype.valueOf),Fi(ho,"Symbol"),Fi(Math,"Math",!0),Fi(Qr.JSON,"JSON",!0),Ph("asyncIterator"),Ph("observable");var zh=Ui.Symbol,oa=ht(function(l){l.exports={default:zh,__esModule:!0}}),Ag=ot(oa),ka=ht(function(l,h){h.__esModule=!0,l=na&&na.__esModule?na:{default:na};var o=oa&&oa.__esModule?oa:{default:oa},a=typeof o.default=="function"&&typeof l.default=="symbol"?function(y){return typeof y}:function(y){return y&&typeof o.default=="function"&&y.constructor===o.default&&y!==o.default.prototype?"symbol":typeof y};h.default=typeof o.default=="function"&&a(l.default)==="symbol"?function(y){return typeof y=="undefined"?"undefined":a(y)}:function(y){return y&&typeof o.default=="function"&&y.constructor===o.default&&y!==o.default.prototype?"symbol":typeof y=="undefined"?"undefined":a(y)}}),kn=ot(ka),Fu=ht(function(l,h){h.__esModule=!0;var o=ka&&ka.__esModule?ka:{default:ka};h.default=function(a,y){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!y||(typeof y=="undefined"?"undefined":(0,o.default)(y))!=="object"&&typeof y!="function"?a:y}}),_r=ot(Fu),hd=Object.setPrototypeOf||("__proto__"in{}?function(l,h,o){try{o=Un(Function.call,Os.f(Object.prototype,"__proto__").set,2),o(l,[]),h=!(l instanceof Array)}catch{h=!0}return function(a,y){if(to(a),!$n(y)&&y!==null)throw TypeError(y+": can't set as prototype!");return h?a.__proto__=y:o(a,y),a}}({},!1):void 0);Ar(Ar.S,"Object",{setPrototypeOf:hd});var cd=Ui.Object.setPrototypeOf,Nh=ht(function(l){l.exports={default:cd,__esModule:!0}});ot(Nh),Ar(Ar.S,"Object",{create:ia});var Uh=Ui.Object,xf=function(l,h){return Uh.create(l,h)},yo=ht(function(l){l.exports={default:xf,__esModule:!0}}),Bl=ot(yo),Ha=ht(function(l,h){function o(x){return x&&x.__esModule?x:{default:x}}h.__esModule=!0;var a=o(Nh),y=o(yo),g=o(ka);h.default=function(x,v){if(typeof v!="function"&&v!==null)throw new TypeError("Super expression must either be null or a function, not "+(typeof v=="undefined"?"undefined":(0,g.default)(v)));x.prototype=(0,y.default)(v&&v.prototype,{constructor:{value:x,enumerable:!1,writable:!0,configurable:!0}}),v&&(a.default?(0,a.default)(x,v):x.__proto__=v)}}),yr=ot(Ha),bh=_n("toStringTag"),kh=Al(function(){return arguments}())=="Arguments",Ga=function(l){var h;if(l===void 0)var o="Undefined";else{if(l===null)var a="Null";else{t:{var y=l=Object(l);try{a=y[bh];break t}catch{}a=void 0}a=typeof(o=a)=="string"?o:kh?Al(l):(h=Al(l))=="Object"&&typeof l.callee=="function"?"Arguments":h}o=a}return o},Hh=_n("iterator"),Oo=Ui.isIterable=function(l){return l=Object(l),l[Hh]!==void 0||"@@iterator"in l||Ro.hasOwnProperty(Ga(l))},zl=ht(function(l){l.exports={default:Oo,__esModule:!0}});ot(zl);var fd=_n("iterator"),Af=Ui.getIteratorMethod=function(l){if(l!=null)return l[fd]||l["@@iterator"]||Ro[Ga(l)]},co=Ui.getIterator=function(l){var h=Af(l);if(typeof h!="function")throw TypeError(l+" is not iterable!");return to(h.call(l))},Nl=ht(function(l){l.exports={default:co,__esModule:!0}}),Bu=ot(Nl),Gh=ht(function(l,h){h.__esModule=!0;var o=zl&&zl.__esModule?zl:{default:zl},a=Nl&&Nl.__esModule?Nl:{default:Nl};h.default=function(){return function(y,g){if(Array.isArray(y))return y;if((0,o.default)(Object(y))){var x=[],v=!0,M=!1,D=void 0;try{for(var U=(0,a.default)(y),C;!(v=(C=U.next()).done)&&(x.push(C.value),!g||x.length!==g);v=!0);}catch(L){M=!0,D=L}finally{try{!v&&U.return&&U.return()}finally{if(M)throw D}}return x}throw new TypeError("Invalid attempt to destructure non-iterable instance")}}()}),Ri=ot(Gh),Vh=function(l,h,o,a){try{return a?h(to(o)[0],o[1]):h(o)}catch(y){throw h=l.return,h!==void 0&&to(h.call(l)),y}},pd=_n("iterator"),Ul=Array.prototype,Fo=_n("iterator"),x1=!1;try{[7][Fo]().return=function(){x1=!0}}catch{}var A1=function(l,h){if(!h&&!x1)return!1;var o=!1;try{h=[7];var a=h[Fo]();a.next=function(){return{done:o=!0}},h[Fo]=function(){return a},l(h)}catch{}return o};Ar(Ar.S+Ar.F*!A1(function(l){}),"Array",{from:function(l){var h=Object(Eu(l)),o=typeof this=="function"?this:Array,a=arguments.length,y=1<a?arguments[1]:void 0,g=y!==void 0,x=0,v=Af(h),M;if(g&&(y=Un(y,2<a?arguments[2]:void 0,2)),v!=null&&(o!=Array||v===void 0||Ro.Array!==v&&Ul[pd]!==v))for(h=v.call(h),o=new o;!(M=h.next()).done;x++)a=o,v=x,M=g?Vh(h,y,[M.value,x],!0):M.value,v in a?Yo.f(a,v,Lu(0,M)):a[v]=M;else for(a=Qp(h.length),o=new o(a);a>x;x++){v=o,M=x;var D=g?y(h[x],x):h[x];M in v?Yo.f(v,M,Lu(0,D)):v[M]=D}return o.length=x,o}});var _1=Ui.Array.from,ai=ht(function(l){l.exports={default:_1,__esModule:!0}}),eo=ot(ai),w1=ht(function(l,h){h.__esModule=!0;var o=ai&&ai.__esModule?ai:{default:ai};h.default=function(a){if(Array.isArray(a)){for(var y=0,g=Array(a.length);y<a.length;y++)g[y]=a[y];return g}return(0,o.default)(a)}}),Wr=ot(w1),M1=El.onFreeze;rf("freeze",function(l){return function(h){return l&&$n(h)?l(M1(h)):h}});var _f=Ui.Object.freeze,_g=ht(function(l){l.exports={default:_f,__esModule:!0}}),Wh=ot(_g),Ir=Ui.JSON||(Ui.JSON={stringify:JSON.stringify}),cs=function(l){return Ir.stringify.apply(Ir,arguments)},wf=ht(function(l){l.exports={default:cs,__esModule:!0}}),bl=ot(wf),ln={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},C1=Os.f;rf("getOwnPropertyDescriptor",function(){return function(l,h){return C1(ea(l),h)}});var Mf=Ui.Object,Cf=function(l,h){return Mf.getOwnPropertyDescriptor(l,h)},Bo=ht(function(l){l.exports={default:Cf,__esModule:!0}}),Bi=ot(Bo),ro=ht(function(l){var h=Array.prototype.concat,o=Array.prototype.slice,a=l.exports=function(y){for(var g=[],x=0,v=y.length;x<v;x++){var M=y[x],D=(D=M)&&typeof D!="string"?D instanceof Array||Array.isArray(D)||0<=D.length&&(D.splice instanceof Function||Bi(D,D.length-1)&&D.constructor.name!=="String"):!1;D?g=h.call(g,o.call(M)):g.push(M)}return g};a.wrap=function(y){return function(){return y(a(arguments))}}}),zo=ht(function(l){function h(x,v,M){return Math.min(Math.max(v,x),M)}function o(x){return x=x.toString(16).toUpperCase(),2>x.length?"0"+x:x}var a={},y;for(y in ln)ln.hasOwnProperty(y)&&(a[ln[y]]=y);var g=l.exports={to:{},get:{}};g.get=function(x){switch(x.substring(0,3).toLowerCase()){case"hsl":x=g.get.hsl(x);var v="hsl";break;case"hwb":x=g.get.hwb(x),v="hwb";break;default:x=g.get.rgb(x),v="rgb"}return x?{model:v,value:x}:null},g.get.rgb=function(x){if(!x)return null;var v=/^#([a-f0-9]{3,4})$/i,M=/^rgba?\(\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/,D=/^rgba?\(\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/,U=/(\D+)/,C=[0,0,0,1],L;if(L=x.match(/^#([a-f0-9]{6})([a-f0-9]{2})?$/i)){for(v=L[2],L=L[1],x=0;3>x;x++)M=2*x,C[x]=parseInt(L.slice(M,M+2),16);v&&(C[3]=Math.round(parseInt(v,16)/255*100)/100)}else if(L=x.match(v)){for(L=L[1],v=L[3],x=0;3>x;x++)C[x]=parseInt(L[x]+L[x],16);v&&(C[3]=Math.round(parseInt(v+v,16)/255*100)/100)}else if(L=x.match(M)){for(x=0;3>x;x++)C[x]=parseInt(L[x+1],0);L[4]&&(C[3]=parseFloat(L[4]))}else if(L=x.match(D)){for(x=0;3>x;x++)C[x]=Math.round(2.55*parseFloat(L[x+1]));L[4]&&(C[3]=parseFloat(L[4]))}else return(L=x.match(U))?L[1]==="transparent"?[0,0,0,0]:(C=ln[L[1]],C?(C[3]=1,C):null):null;for(x=0;3>x;x++)C[x]=h(C[x],0,255);return C[3]=h(C[3],0,1),C},g.get.hsl=function(x){if(!x)return null;var v=x.match(/^hsla?\(\s*([+-]?(?:\d*\.)?\d+)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/);if(v){var M=parseFloat(v[4]);x=(parseFloat(v[1])+360)%360;var D=h(parseFloat(v[2]),0,100);return v=h(parseFloat(v[3]),0,100),M=h(isNaN(M)?1:M,0,1),[x,D,v,M]}return null},g.get.hwb=function(x){if(!x)return null;var v=x.match(/^hwb\(\s*([+-]?\d*[\.]?\d+)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/);if(v){var M=parseFloat(v[4]);x=(parseFloat(v[1])%360+360)%360;var D=h(parseFloat(v[2]),0,100);return v=h(parseFloat(v[3]),0,100),M=h(isNaN(M)?1:M,0,1),[x,D,v,M]}return null},g.to.hex=function(){var x=ro(arguments);return"#"+o(x[0])+o(x[1])+o(x[2])+(1>x[3]?o(Math.round(255*x[3])):"")},g.to.rgb=function(){var x=ro(arguments);return 4>x.length||x[3]===1?"rgb("+Math.round(x[0])+", "+Math.round(x[1])+", "+Math.round(x[2])+")":"rgba("+Math.round(x[0])+", "+Math.round(x[1])+", "+Math.round(x[2])+", "+x[3]+")"},g.to.rgb.percent=function(){var x=ro(arguments),v=Math.round(x[0]/255*100),M=Math.round(x[1]/255*100),D=Math.round(x[2]/255*100);return 4>x.length||x[3]===1?"rgb("+v+"%, "+M+"%, "+D+"%)":"rgba("+v+"%, "+M+"%, "+D+"%, "+x[3]+")"},g.to.hsl=function(){var x=ro(arguments);return 4>x.length||x[3]===1?"hsl("+x[0]+", "+x[1]+"%, "+x[2]+"%)":"hsla("+x[0]+", "+x[1]+"%, "+x[2]+"%, "+x[3]+")"},g.to.hwb=function(){var x=ro(arguments),v="";return 4<=x.length&&x[3]!==1&&(v=", "+x[3]),"hwb("+x[0]+", "+x[1]+"%, "+x[2]+"%"+v+")"},g.to.keyword=function(x){return a[x.slice(0,3)]}}),fo=ht(function(l){var h={};for(y in ln)ln.hasOwnProperty(y)&&(h[ln[y]]=y);var o=l.exports={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},lch:{channels:3,labels:"lch"},hex:{channels:1,labels:["hex"]},keyword:{channels:1,labels:["keyword"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}},a;for(a in o)if(o.hasOwnProperty(a)){if(!("channels"in o[a]))throw Error("missing channels property: "+a);if(!("labels"in o[a]))throw Error("missing channel labels property: "+a);if(o[a].labels.length!==o[a].channels)throw Error("channel and label counts mismatch: "+a);l=o[a].channels;var y=o[a].labels;delete o[a].channels,delete o[a].labels,Object.defineProperty(o[a],"channels",{value:l}),Object.defineProperty(o[a],"labels",{value:y})}o.rgb.hsl=function(g){var x=g[0]/255,v=g[1]/255,M=g[2]/255;g=Math.min(x,v,M);var D=Math.max(x,v,M),U=D-g,C;return D===g?C=0:x===D?C=(v-M)/U:v===D?C=2+(M-x)/U:M===D&&(C=4+(x-v)/U),C=Math.min(60*C,360),0>C&&(C+=360),x=(g+D)/2,[C,100*(D===g?0:.5>=x?U/(D+g):U/(2-D-g)),100*x]},o.rgb.hsv=function(g){var x,v=g[0]/255,M=g[1]/255,D=g[2]/255,U=Math.max(v,M,D),C=U-Math.min(v,M,D);if(C===0)var L=x=0;else{x=C/U,g=(U-v)/6/C+.5;var B=(U-M)/6/C+.5;C=(U-D)/6/C+.5,v===U?L=C-B:M===U?L=1/3+g-C:D===U&&(L=2/3+B-g),0>L?L+=1:1<L&&--L}return[360*L,100*x,100*U]},o.rgb.hwb=function(g){var x=g[0],v=g[1],M=g[2];g=o.rgb.hsl(g)[0];var D=1/255*Math.min(x,Math.min(v,M));return M=1-1/255*Math.max(x,Math.max(v,M)),[g,100*D,100*M]},o.rgb.cmyk=function(g){var x=g[0]/255,v=g[1]/255;g=g[2]/255;var M=Math.min(1-x,1-v,1-g);return[100*((1-x-M)/(1-M)||0),100*((1-v-M)/(1-M)||0),100*((1-g-M)/(1-M)||0),100*M]},o.rgb.keyword=function(g){var x=h[g];if(x)return x;x=1/0;var v;for(v in ln)if(ln.hasOwnProperty(v)){var M=ln[v];if(M=Math.pow(g[0]-M[0],2)+Math.pow(g[1]-M[1],2)+Math.pow(g[2]-M[2],2),M<x){x=M;var D=v}}return D},o.keyword.rgb=function(g){return ln[g]},o.rgb.xyz=function(g){var x=g[0]/255,v=g[1]/255;return g=g[2]/255,x=.04045<x?Math.pow((x+.055)/1.055,2.4):x/12.92,v=.04045<v?Math.pow((v+.055)/1.055,2.4):v/12.92,g=.04045<g?Math.pow((g+.055)/1.055,2.4):g/12.92,[100*(.4124*x+.3576*v+.1805*g),100*(.2126*x+.7152*v+.0722*g),100*(.0193*x+.1192*v+.9505*g)]},o.rgb.lab=function(g){var x=o.rgb.xyz(g);g=x[0];var v=x[1];return x=x[2],g/=95.047,v/=100,x/=108.883,g=.008856<g?Math.pow(g,1/3):7.787*g+16/116,v=.008856<v?Math.pow(v,1/3):7.787*v+16/116,x=.008856<x?Math.pow(x,1/3):7.787*x+16/116,[116*v-16,500*(g-v),200*(v-x)]},o.hsl.rgb=function(g){var x=g[0]/360,v=g[1]/100;if(g=g[2]/100,v===0){var M=255*g;return[M,M,M]}v=.5>g?g*(1+v):g+v-g*v,g=2*g-v;for(var D=[0,0,0],U=0;3>U;U++)M=x+1/3*-(U-1),0>M&&M++,1<M&&M--,M=1>6*M?g+6*(v-g)*M:1>2*M?v:2>3*M?g+(v-g)*(2/3-M)*6:g,D[U]=255*M;return D},o.hsl.hsv=function(g){var x=g[0],v=g[1]/100;g=g[2]/100;var M=v,D=Math.max(g,.01);return g*=2,v*=1>=g?g:2-g,M*=1>=D?D:2-D,[x,100*(g===0?2*M/(D+M):2*v/(g+v)),(g+v)/2*100]},o.hsv.rgb=function(g){var x=g[0]/60,v=g[1]/100;g=g[2]/100;var M=Math.floor(x)%6,D=x-Math.floor(x);x=255*g*(1-v);var U=255*g*(1-v*D);switch(v=255*g*(1-v*(1-D)),g*=255,M){case 0:return[g,v,x];case 1:return[U,g,x];case 2:return[x,g,v];case 3:return[x,U,g];case 4:return[v,x,g];case 5:return[g,x,U]}},o.hsv.hsl=function(g){var x=g[0],v=g[1]/100;g=g[2]/100;var M=Math.max(g,.01),D=(2-v)*M;return M=v*M/(1>=D?D:2-D)||0,[x,100*M,(2-v)*g/2*100]},o.hwb.rgb=function(g){var x=g[0]/360,v=g[1]/100;g=g[2]/100;var M=v+g;switch(1<M&&(v/=M,g/=M),M=Math.floor(6*x),g=1-g,x=6*x-M,(M&1)!==0&&(x=1-x),x=v+x*(g-v),M){default:case 6:case 0:M=g;var D=x;break;case 1:M=x,D=g;break;case 2:M=v,D=g,v=x;break;case 3:M=v,D=x,v=g;break;case 4:M=x,D=v,v=g;break;case 5:M=g,D=v,v=x}return[255*M,255*D,255*v]},o.cmyk.rgb=function(g){var x=g[3]/100;return[255*(1-Math.min(1,g[0]/100*(1-x)+x)),255*(1-Math.min(1,g[1]/100*(1-x)+x)),255*(1-Math.min(1,g[2]/100*(1-x)+x))]},o.xyz.rgb=function(g){var x=g[0]/100,v=g[1]/100,M=g[2]/100;g=3.2406*x+-1.5372*v+-.4986*M;var D=-.9689*x+1.8758*v+.0415*M;return x=.0557*x+-.204*v+1.057*M,g=.0031308<g?1.055*Math.pow(g,1/2.4)-.055:12.92*g,D=.0031308<D?1.055*Math.pow(D,1/2.4)-.055:12.92*D,x=.0031308<x?1.055*Math.pow(x,1/2.4)-.055:12.92*x,g=Math.min(Math.max(0,g),1),D=Math.min(Math.max(0,D),1),x=Math.min(Math.max(0,x),1),[255*g,255*D,255*x]},o.xyz.lab=function(g){var x=g[0],v=g[1];return g=g[2],x/=95.047,v/=100,g/=108.883,x=.008856<x?Math.pow(x,1/3):7.787*x+16/116,v=.008856<v?Math.pow(v,1/3):7.787*v+16/116,g=.008856<g?Math.pow(g,1/3):7.787*g+16/116,[116*v-16,500*(x-v),200*(v-g)]},o.lab.xyz=function(g){var x=g[1],v=g[2];g=(g[0]+16)/116,x=x/500+g,v=g-v/200;var M=Math.pow(g,3),D=Math.pow(x,3),U=Math.pow(v,3);return[95.047*(.008856<D?D:(x-16/116)/7.787),100*(.008856<M?M:(g-16/116)/7.787),108.883*(.008856<U?U:(v-16/116)/7.787)]},o.lab.lch=function(g){var x=g[0],v=g[1];g=g[2];var M=360*Math.atan2(g,v)/2/Math.PI;return 0>M&&(M+=360),[x,Math.sqrt(v*v+g*g),M]},o.lch.lab=function(g){var x=g[0],v=g[1];return g=g[2]/360*2*Math.PI,[x,v*Math.cos(g),v*Math.sin(g)]},o.rgb.ansi16=function(g){var x=g[0],v=g[1],M=g[2],D=1 in arguments?arguments[1]:o.rgb.hsv(g)[2];return D=Math.round(D/50),D===0?30:(x=30+(Math.round(M/255)<<2|Math.round(v/255)<<1|Math.round(x/255)),D===2&&(x+=60),x)},o.hsv.ansi16=function(g){return o.rgb.ansi16(o.hsv.rgb(g),g[2])},o.rgb.ansi256=function(g){var x=g[0],v=g[1];return g=g[2],x===v&&v===g?8>x?16:248<x?231:Math.round((x-8)/247*24)+232:16+36*Math.round(x/255*5)+6*Math.round(v/255*5)+Math.round(g/255*5)},o.ansi16.rgb=function(g){var x=g%10;return x===0||x===7?(50<g&&(x+=3.5),x=x/10.5*255,[x,x,x]):(g=.5*(~~(50<g)+1),[(x&1)*g*255,(x>>1&1)*g*255,(x>>2&1)*g*255])},o.ansi256.rgb=function(g){if(232<=g){var x=10*(g-232)+8;return[x,x,x]}g-=16,x=Math.floor(g/36)/5*255;var v=Math.floor((g%=36)/6)/5*255;return[x,v,g%6/5*255]},o.rgb.hex=function(g){return g=(((Math.round(g[0])&255)<<16)+((Math.round(g[1])&255)<<8)+(Math.round(g[2])&255)).toString(16).toUpperCase(),"000000".substring(g.length)+g},o.hex.rgb=function(g){if(g=g.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i),!g)return[0,0,0];var x=g[0];return g[0].length===3&&(x=x.split("").map(function(v){return v+v}).join("")),g=parseInt(x,16),[g>>16&255,g>>8&255,g&255]},o.rgb.hcg=function(g){var x=g[0]/255,v=g[1]/255;g=g[2]/255;var M=Math.max(Math.max(x,v),g),D=Math.min(Math.min(x,v),g),U=M-D;return[(0>=U?0:M===x?(v-g)/U%6:M===v?2+(g-x)/U:(x-v)/U+8)/6%1*360,100*U,100*(1>U?D/(1-U):0)]},o.hsl.hcg=function(g){var x=g[1]/100,v=g[2]/100,M=0;return x=.5>v?2*x*v:2*x*(1-v),1>x&&(M=(v-.5*x)/(1-x)),[g[0],100*x,100*M]},o.hsv.hcg=function(g){var x=g[2]/100,v=g[1]/100*x,M=0;return 1>v&&(M=(x-v)/(1-v)),[g[0],100*v,100*M]},o.hcg.rgb=function(g){var x=g[1]/100,v=g[2]/100;if(x===0)return[255*v,255*v,255*v];var M=[0,0,0];g=g[0]/360%1*6;var D=g%1,U=1-D;switch(Math.floor(g)){case 0:M[0]=1,M[1]=D,M[2]=0;break;case 1:M[0]=U,M[1]=1,M[2]=0;break;case 2:M[0]=0,M[1]=1,M[2]=D;break;case 3:M[0]=0,M[1]=U,M[2]=1;break;case 4:M[0]=D,M[1]=0,M[2]=1;break;default:M[0]=1,M[1]=0,M[2]=U}return v*=1-x,[255*(x*M[0]+v),255*(x*M[1]+v),255*(x*M[2]+v)]},o.hcg.hsv=function(g){var x=g[1]/100,v=x+g[2]/100*(1-x),M=0;return 0<v&&(M=x/v),[g[0],100*M,100*v]},o.hcg.hsl=function(g){var x=g[1]/100,v=g[2]/100*(1-x)+.5*x,M=0;return 0<v&&.5>v?M=x/(2*v):.5<=v&&1>v&&(M=x/(2*(1-v))),[g[0],100*M,100*v]},o.hcg.hwb=function(g){var x=g[1]/100,v=x+g[2]/100*(1-x);return[g[0],100*(v-x),100*(1-v)]},o.hwb.hcg=function(g){var x=1-g[2]/100,v=x-g[1]/100,M=0;return 1>v&&(M=(x-v)/(1-v)),[g[0],100*v,100*M]},o.apple.rgb=function(g){return[g[0]/65535*255,g[1]/65535*255,g[2]/65535*255]},o.rgb.apple=function(g){return[g[0]/255*65535,g[1]/255*65535,g[2]/255*65535]},o.gray.rgb=function(g){return[g[0]/100*255,g[0]/100*255,g[0]/100*255]},o.gray.hsl=o.gray.hsv=function(g){return[0,0,g[0]]},o.gray.hwb=function(g){return[0,100,g[0]]},o.gray.cmyk=function(g){return[0,0,0,g[0]]},o.gray.lab=function(g){return[g[0],0,0]},o.gray.hex=function(g){return g=Math.round(g[0]/100*255)&255,g=((g<<16)+(g<<8)+g).toString(16).toUpperCase(),"000000".substring(g.length)+g},o.rgb.gray=function(g){return[(g[0]+g[1]+g[2])/3/255*100]}}),Va=function(l){for(var h={},o=bn(fo),a=o.length,y=0;y<a;y++)h[o[y]]={distance:-1,parent:null};for(o=[l],h[l].distance=0;o.length;){l=o.pop(),a=bn(fo[l]),y=a.length;for(var g=0;g<y;g++){var x=a[g],v=h[x];v.distance===-1&&(v.distance=h[l].distance+1,v.parent=l,o.unshift(x))}}for(o={},l=bn(h),a=l.length,y=0;y<a;y++){var M=l[y];if(h[M].parent!==null){g=M,x=h,v=[x[M].parent,M];var D=fo[x[M].parent][M];for(M=x[M].parent;x[M].parent;)v.unshift(x[M].parent),D=bt(fo[x[M].parent][M],D),M=x[M].parent;D.conversion=v,o[g]=D}}return o},xo={};bn(fo).forEach(function(l){xo[l]={},Object.defineProperty(xo[l],"channels",{value:fo[l].channels}),Object.defineProperty(xo[l],"labels",{value:fo[l].labels});var h=Va(l);bn(h).forEach(function(o){var a=h[o];xo[l][o]=Ot(a),xo[l][o].raw=se(a)})});var Rn=xo,fs=[].slice,zu=["keyword","gray","hex"],ji={};bn(Rn).forEach(function(l){ji[fs.call(Rn[l].labels).sort().join("")]=l});var jh={};Jt.prototype={toString:function(){return this.string()},toJSON:function(){return this[this.model]()},string:function(l){var h=this.model in zo.to?this:this.rgb();return h=h.round(typeof l=="number"?l:1),l=h.valpha===1?h.color:h.color.concat(this.valpha),zo.to[h.model](l)},percentString:function(l){return l=this.rgb().round(typeof l=="number"?l:1),l=l.valpha===1?l.color:l.color.concat(this.valpha),zo.to.rgb.percent(l)},array:function(){return this.valpha===1?this.color.slice():this.color.concat(this.valpha)},object:function(){for(var l={},h=Rn[this.model].channels,o=Rn[this.model].labels,a=0;a<h;a++)l[o[a]]=this.color[a];return this.valpha!==1&&(l.alpha=this.valpha),l},unitArray:function(){var l=this.rgb().color;return l[0]/=255,l[1]/=255,l[2]/=255,this.valpha!==1&&l.push(this.valpha),l},unitObject:function(){var l=this.rgb().object();return l.r/=255,l.g/=255,l.b/=255,this.valpha!==1&&(l.alpha=this.valpha),l},round:function(l){return l=Math.max(l||0,0),new Jt(this.color.map(le(l)).concat(this.valpha),this.model)},alpha:function(l){return arguments.length?new Jt(this.color.concat(Math.max(0,Math.min(1,l))),this.model):this.valpha},red:jt("rgb",0,pe(255)),green:jt("rgb",1,pe(255)),blue:jt("rgb",2,pe(255)),hue:jt(["hsl","hsv","hsl","hwb","hcg"],0,function(l){return(l%360+360)%360}),saturationl:jt("hsl",1,pe(100)),lightness:jt("hsl",2,pe(100)),saturationv:jt("hsv",1,pe(100)),value:jt("hsv",2,pe(100)),chroma:jt("hcg",1,pe(100)),gray:jt("hcg",2,pe(100)),white:jt("hwb",1,pe(100)),wblack:jt("hwb",2,pe(100)),cyan:jt("cmyk",0,pe(100)),magenta:jt("cmyk",1,pe(100)),yellow:jt("cmyk",2,pe(100)),black:jt("cmyk",3,pe(100)),x:jt("xyz",0,pe(100)),y:jt("xyz",1,pe(100)),z:jt("xyz",2,pe(100)),l:jt("lab",0,pe(100)),a:jt("lab",1),b:jt("lab",2),keyword:function(l){return arguments.length?new Jt(l):Rn[this.model].keyword(this.color)},hex:function(l){return arguments.length?new Jt(l):zo.to.hex(this.rgb().round().color)},rgbNumber:function(){var l=this.rgb().color;return(l[0]&255)<<16|(l[1]&255)<<8|l[2]&255},luminosity:function(){for(var l=this.rgb().color,h=[],o=0;o<l.length;o++){var a=l[o]/255;h[o]=.03928>=a?a/12.92:Math.pow((a+.055)/1.055,2.4)}return .2126*h[0]+.7152*h[1]+.0722*h[2]},contrast:function(l){var h=this.luminosity();return l=l.luminosity(),h>l?(h+.05)/(l+.05):(l+.05)/(h+.05)},level:function(l){return l=this.contrast(l),7.1<=l?"AAA":4.5<=l?"AA":""},isDark:function(){var l=this.rgb().color;return 128>(299*l[0]+587*l[1]+114*l[2])/1e3},isLight:function(){return!this.isDark()},negate:function(){for(var l=this.rgb(),h=0;3>h;h++)l.color[h]=255-l.color[h];return l},lighten:function(l){var h=this.hsl();return h.color[2]+=h.color[2]*l,h},darken:function(l){var h=this.hsl();return h.color[2]-=h.color[2]*l,h},saturate:function(l){var h=this.hsl();return h.color[1]+=h.color[1]*l,h},desaturate:function(l){var h=this.hsl();return h.color[1]-=h.color[1]*l,h},whiten:function(l){var h=this.hwb();return h.color[1]+=h.color[1]*l,h},blacken:function(l){var h=this.hwb();return h.color[2]+=h.color[2]*l,h},grayscale:function(){var l=this.rgb().color;return l=.3*l[0]+.59*l[1]+.11*l[2],Jt.rgb(l,l,l)},fade:function(l){return this.alpha(this.valpha-this.valpha*l)},opaquer:function(l){return this.alpha(this.valpha+this.valpha*l)},rotate:function(l){var h=this.hsl(),o=h.color[0];return o=(o+l)%360,h.color[0]=0>o?360+o:o,h},mix:function(l,h){if(!l||!l.rgb)throw Error('Argument to "mix" was not a Color instance, but rather an instance of '+(typeof l=="undefined"?"undefined":kn(l)));l=l.rgb();var o=this.rgb();h=h===void 0?.5:h;var a=2*h-1,y=l.alpha()-o.alpha();return a=((a*y===-1?a:(a+y)/(1+a*y))+1)/2,y=1-a,Jt.rgb(a*l.red()+y*o.red(),a*l.green()+y*o.green(),a*l.blue()+y*o.blue(),l.alpha()*h+o.alpha()*(1-h))}},bn(Rn).forEach(function(l){if(zu.indexOf(l)===-1){var h=Rn[l].channels;Jt.prototype[l]=function(){if(this.model===l)return new Jt(this);if(arguments.length)return new Jt(arguments,l);var o=typeof arguments[h]=="number"?h:this.valpha,a=Rn[this.model][l].raw(this.color);return a=Array.isArray(a)?a:[a],new Jt(a.concat(o),l)},Jt[l]=function(o){return typeof o=="number"&&(o=He(fs.call(arguments),h)),new Jt(o,l)}}}),ui(xi.prototype,{equals:function(l){return this.lat===l.lat&&this.lng===l.lng},clone:function(){return new xi(this.lat,this.lng)},getLngSpan:function(l){return l=Math.abs(l-this.lng),180<l&&(l=360-l),l},sub:function(l){return new xi(this.lat-l.lat,this.lng-l.lng)},toString:function(){return"Point"}}),ui(Mr,{EARTHRADIUS:637099681e-2,MCBAND:[1289059486e-2,836237787e-2,5591021,348198983e-2,167804312e-2,0],LLBAND:[75,60,45,30,15,0],MC2LL:[[1410526172116255e-23,898305509648872e-20,-1.9939833816331,200.9824383106796,-187.2403703815547,91.6087516669843,-23.38765649603339,2.57121317296198,-.03801003308653,173379812e-1],[-7435856389565537e-24,8983055097726239e-21,-.78625201886289,96.32687599759846,-1.85204757529826,-59.36935905485877,47.40033549296737,-16.50741931063887,2.28786674699375,1026014486e-2],[-3030883460898826e-23,898305509983578e-20,.30071316287616,59.74293618442277,7.357984074871,-25.38371002664745,13.45380521110908,-3.29883767235584,.32710905363475,685681737e-2],[-1981981304930552e-23,8983055099779535e-21,.03278182852591,40.31678527705744,.65659298677277,-4.44255534477492,.85341911805263,.12923347998204,-.04625736007561,448277706e-2],[309191371068437e-23,8983055096812155e-21,6995724062e-14,23.10934304144901,-.00023663490511,-.6321817810242,-.00663494467273,.03430082397953,-.00466043876332,25551644e-1],[2890871144776878e-24,8983055095805407e-21,-3068298e-14,7.47137025468032,-353937994e-14,-.02145144861037,-1234426596e-14,.00010322952773,-323890364e-14,826088.5]],LL2MC:[[-.0015702102444,111320.7020616939,0x60e374c3105a3,-0x24bb4115e2e164,0x5cc55543bb0ae8,-0x7ce070193f3784,0x5e7ca61ddf8150,-0x261a578d8b24d0,0x665d60f3742ca,82.5],[.0008277824516172526,111320.7020463578,6477955746671607e-7,-4082003173641316e-6,1077490566351142e-5,-1517187553151559e-5,1205306533862167e-5,-5124939663577472e-6,9133119359512032e-7,67.5],[.00337398766765,111320.7020202162,4481351045890365e-9,-2339375119931662e-8,7968221547186455e-8,-1159649932797253e-7,9723671115602145e-8,-4366194633752821e-8,8477230501135234e-9,52.5],[.00220636496208,111320.7020209128,51751.86112841131,3796837749470245e-9,992013.7397791013,-122195221711287e-8,1340652697009075e-9,-620943.6990984312,144416.9293806241,37.5],[-.0003441963504368392,111320.7020576856,278.2353980772752,2485758690035394e-9,6070.750963243378,54821.18345352118,9540.606633304236,-2710.55326746645,1405.483844121726,22.5],[-.0003218135878613132,111320.7020701615,.00369383431289,823725.6402795718,.46104986909093,2351.343141331292,1.58060784298199,8.77738589078284,.37238884252424,7.45]],getDistanceByMC:function(l,h){if(!l||!h||(l=this.convertMC2LL(l),!l))return 0;var o=this.toRadians(l.lng);if(l=this.toRadians(l.lat),h=this.convertMC2LL(h),!h)return 0;var a=this.toRadians(h.lng);return h=this.toRadians(h.lat),this.getDistance(o,a,l,h)},getDistanceByLL:function(l,h){if(!l||!h)return 0;l.lng=this.getLoop(l.lng,-180,180),l.lat=this.getRange(l.lat,-74,74),h.lng=this.getLoop(h.lng,-180,180),h.lat=this.getRange(h.lat,-74,74);var o=this.toRadians(l.lng),a=this.toRadians(l.lat);return l=this.toRadians(h.lng),h=this.toRadians(h.lat),this.getDistance(o,l,a,h)},convertMC2LL:function(l){if(l==null)return new xi(0,0);if(180>l.lng&&-180<l.lng&&90>l.lat&&-90<l.lat)return l;for(var h=new xi(Math.abs(l.lng),Math.abs(l.lat)),o=0;o<this.MCBAND.length;o++)if(h.lat>=this.MCBAND[o]){var a=this.MC2LL[o];break}return l=this.convertor(l,a),l=new xi(l.lng.toFixed(6),l.lat.toFixed(6))},convertLL2MC:function(l){if(l==null)return new xi(0,0);if(180<l.lng||-180>l.lng||90<l.lat||-90>l.lat)return l;l.lng=this.getLoop(l.lng,-180,180),l.lat=this.getRange(l.lat,-74,74);for(var h=new xi(l.lng,l.lat),o=0;o<this.LLBAND.length;o++)if(h.lat>=this.LLBAND[o]){var a=this.LL2MC[o];break}if(!a){for(o=0;o<this.LLBAND.length;o++)if(h.lat<=-this.LLBAND[o]){a=this.LL2MC[o];break}}return l=this.convertor(l,a),l=new xi(Number(l.lng.toFixed(2)),Number(l.lat.toFixed(2)))},convertor:function(l,h){if(l&&h){var o=h[0]+h[1]*Math.abs(l.lng),a=Math.abs(l.lat)/h[9];return h=h[2]+h[3]*a+h[4]*a*a+h[5]*a*a*a+h[6]*a*a*a*a+h[7]*a*a*a*a*a+h[8]*a*a*a*a*a*a,o*=0>l.lng?-1:1,h*=0>l.lat?-1:1,new xi(o,h)}},getDistance:function(l,h,o,a){return this.EARTHRADIUS*Math.acos(Math.sin(o)*Math.sin(a)+Math.cos(o)*Math.cos(a)*Math.cos(h-l))},toRadians:function(l){return Math.PI*l/180},toDegrees:function(l){return 180*l/Math.PI},getRange:function(l,h,o){return h!=null&&(l=Math.max(l,h)),o!=null&&(l=Math.min(l,o)),l},getLoop:function(l,h,o){for(;l>o;)l-=o-h;for(;l<h;)l+=o-h;return l}}),ui(Mr.prototype,{lngLatToMercator:function(l){return Mr.convertLL2MC(l)},lngLatToPoint:function(l){return l=Mr.convertLL2MC(l),new fn(l.lng,l.lat)},mercatorToLngLat:function(l){return Mr.convertMC2LL(l)},pointToLngLat:function(l){return l=new xi(l.x,l.y),Mr.convertMC2LL(l)},pointToPixel:function(l,h,o,a,y){if(l)return l=this.lngLatToMercator(l,y),h=this.getZoomUnits(h),new fn(Math.round((l.lng-o.lng)/h+a.width/2),Math.round((o.lat-l.lat)/h+a.height/2))},pixelToPoint:function(l,h,o,a,y){if(l)return h=this.getZoomUnits(h),l=new xi(o.lng+h*(l.x-a.width/2),o.lat-h*(l.y-a.height/2)),this.mercatorToLngLat(l,y)},getZoomUnits:function(l){return Math.pow(2,18-l)}}),Li.prototype.setMax=function(l){this.max=l||100},Li.prototype.setMin=function(l){this.min=l||0},Li.prototype.setMaxSize=function(l){this.maxSize=l||35},Li.prototype.setMinSize=function(l){this.minSize=l||0},Li.prototype.initPalette=function(){var l=this.gradient,h=this.paletteCtx=new Ln(256,1).getContext("2d"),o=h.createLinearGradient(0,0,256,1);bn(l).forEach(function(a){o.addColorStop(parseFloat(a),l[a])}),h.fillStyle=o,h.fillRect(0,0,256,1),h.imageData=h.getImageData(0,0,256,1).data},Li.prototype.getColor=function(l){return l=this.getImageData(l),"rgba("+l[0]+", "+l[1]+", "+l[2]+", "+l[3]/256+")"},Li.prototype.getImageData=function(l){var h=this.paletteCtx.imageData;if(l===void 0)return h;var o=this.max,a=this.min;return l>o&&(l=o),l<a&&(l=a),l=4*Math.floor((l-a)/(o-a)*255),[h[l],h[l+1],h[l+2],h[l+3]]},Li.prototype.getSize=function(l){var h=this.max,o=this.min,a=this.maxSize,y=this.minSize;return l>h&&(l=h),l<o&&(l=o),y+(l-o)/(h-o)*(a-y)},li.prototype._initialize=function(){this.v0=this._normalizaCoord(this.options.start),this.v3=this._normalizaCoord(this.options.end),this.v1=this._getControlPoint(this.v0,this.v3,4),this.v2=this._getControlPoint(this.v3,this.v0,5),this.v0[2]||(this.v0[2]=0),this.v3[2]||(this.v3[2]=0)},li.prototype.setOptions=function(l){this.options=l||{},this._initialize()},li.prototype.getPoints=function(l){l===void 0&&(l=20);for(var h=[],o=0;o<=l;o++)h.push(this._getPoint(o/l));return h},li.prototype._normalizaCoord=function(l){return l?(l=Mr.convertLL2MC({lng:Number(l[0]),lat:Number(l[1])}),[l.lng,l.lat]):[]},li.prototype._getControlPoint=function(l,h){var o=2<arguments.length&&arguments[2]!==void 0?arguments[2]:1;return[].concat(Wr(this._getQuarter(l,h)),[this._getDistance(l,h)/o])},li.prototype._getQuarter=function(l,h){return[(3*l[0]+h[0])/4,(3*l[1]+h[1])/4]},li.prototype._getDistance=function(l,h){return Math.sqrt(Math.pow(l[0]-h[0],2)+Math.pow(l[1]-h[1],2))},li.prototype._getPoint=function(l){var h=[],o=this.v0,a=this.v1,y=this.v2,g=this.v3;return h.push(Oe(l,o[0],a[0],y[0],g[0]),Oe(l,o[1],a[1],y[1],g[1]),Oe(l,o[2],a[2],y[2],g[2])),h},yn.prototype._initialize=function(){this.points=this.options.points||this.options.point||[],this.greatCirclePoints=[];for(var l=[],h=0;h<this.points.length;h++){var o=this._normalizaCoord(this.points[h]);o&&l.push(o)}this.points=l},yn.prototype.setOptions=function(l){this.options=l||{},this._initialize()},yn.prototype.getPoints=function(){if(this.greatCirclePoints.length===0)for(var l=0;l<this.points.length-1;l++)this._calcGreatCirclePoints(this.points[l],this.points[l+1]);return this.greatCirclePoints},yn.prototype._normalizaCoord=function(l){if(!l)return null;l instanceof Array&&(l={lng:Number(l[0]),lat:Number(l[1])});var h=Mr.convertLL2MC(l);return l=Mr.convertMC2LL(l),h.latLng=l,h},yn.prototype._calcGreatCirclePoints=function(l,h){var o=l.latLng,a=h.latLng;if(!Tr(o.lng,a.lng)||!Tr(o.lat,a.lat)){var y=Mr.getDistance(ye(o.lng),ye(o.lat),ye(a.lng),ye(a.lat));if(!(25e4>y)){y=Math.round(y/15e4);var g=this._calcAngularDistance(o,a);this.greatCirclePoints.push([l.lng,l.lat]);for(var x=0;x<y;x++){var v=this._calcMiddlePoint(o,a,x/y,g);v=Mr.convertLL2MC(v);var M=Is(v,l);30037726<M&&(v.lng=v.lng<l.lng?v.lng+this.WORLD_SIZE_MC:v.lng-this.WORLD_SIZE_MC),this.greatCirclePoints.push([v.lng,v.lat]),l=v}M=Is(h,l),30037726<M&&(h.lng=h.lng<l.lng?h.lng+this.WORLD_SIZE_MC:h.lng-this.WORLD_SIZE_MC),this.greatCirclePoints.push([h.lng,h.lat])}}},yn.prototype._calcAngularDistance=function(l,h){var o=ye(l.lat),a=ye(h.lat);return l=ye(l.lng),h=ye(h.lng),Math.acos(Math.sin(o)*Math.sin(a)+Math.cos(o)*Math.cos(a)*Math.cos(Math.abs(h-l)))},yn.prototype._calcMiddlePoint=function(l,h,o,a){var y=h.lat,g=l.lng;h=h.lng,l=ye(l.lat),y=ye(y),g=ye(g);var x=ye(h);return h=Math.sin((1-o)*a)/Math.sin(a),a=Math.sin(o*a)/Math.sin(a),o=h*Math.cos(l)*Math.cos(g)+a*Math.cos(y)*Math.cos(x),g=h*Math.cos(l)*Math.sin(g)+a*Math.cos(y)*Math.sin(x),l=Math.atan2(h*Math.sin(l)+a*Math.sin(y),Math.sqrt(Math.pow(o,2)+Math.pow(g,2))),new xi(dt(Math.atan2(g,o)),dt(l))};var Wa=function(){function l(){var h=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};Xe(this,l),this.options=h,this._initialize()}return Ue(l,[{key:"_initialize",value:function(){this.points=this.options.points}},{key:"_normalizaCoord",value:function(h){return h?(h instanceof Array&&(h={lng:Number(h[0]),lat:Number(h[1])}),Mr.convertLL2MC(h)):null}},{key:"setOptions",value:function(){this.options=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{},this._initialize()}},{key:"getPoints",value:function(h){for(var o=[],a=this.points,y=0;y<a.length-1;y++){var g=this.getCurveByTwoPoints(this._normalizaCoord(a[y]),this._normalizaCoord(a[y+1]),h);g&&0<g.length&&(o=o.concat(g))}return o}},{key:"getCurveByTwoPoints",value:function(h,o){var a=2<arguments.length&&arguments[2]!==void 0?arguments[2]:20;if(!h||!o)return null;var y=[],g=0;if((typeof o=="undefined"?"undefined":kn(o))===void 0)typeof y=="undefined"||kn(y);else{var x=parseFloat(h.lat),v=parseFloat(o.lat),M=parseFloat(h.lng),D=parseFloat(o.lng);D>M&&180<parseFloat(D-M)&&0>M&&(M=parseFloat(360+M),D=parseFloat(360+D));var U=0;if(v===x)var C=0,L=M-D;else D===M?(C=Math.PI/2,L=x-v):(C=Math.atan((v-x)/(D-M)),L=(v-x)/Math.sin(C));for(U===0&&(U=C+Math.PI/5),L/=2,C=L*Math.cos(U)+M,U=L*Math.sin(U)+x,L=0;L<a+1;L++){var B=M*(1-2*g+g*g)+C*(2*g-2*g*g)+D*g*g,O=o.lng;y.push([0>h.lng&&0<O?B-360:B,x*(1-2*g+g*g)+U*(2*g-2*g*g)+v*g*g]),g+=1/a}return y}}}]),l}(),Tf=[{n:"\u5317\u4EAC",g:"116.395645,39.929986|12"},{n:"\u4E0A\u6D77",g:"121.487899,31.249162|12"},{n:"\u5929\u6D25",g:"117.210813,39.14393|12"},{n:"\u91CD\u5E86",g:"106.530635,29.544606|12"}],sa=[{n:"\u5B89\u5FBD",g:"117.216005,31.859252|8",cities:[{n:"\u5408\u80A5",g:"117.282699,31.866942|12"},{n:"\u5B89\u5E86",g:"117.058739,30.537898|13"},{n:"\u868C\u57E0",g:"117.35708,32.929499|13"},{n:"\u4EB3\u5DDE",g:"115.787928,33.871211|13"},{n:"\u5DE2\u6E56",g:"117.88049,31.608733|13"},{n:"\u6C60\u5DDE",g:"117.494477,30.660019|14"},{n:"\u6EC1\u5DDE",g:"118.32457,32.317351|13"},{n:"\u961C\u9633",g:"115.820932,32.901211|13"},{n:"\u6DEE\u5317",g:"116.791447,33.960023|13"},{n:"\u6DEE\u5357",g:"117.018639,32.642812|13"},{n:"\u9EC4\u5C71",g:"118.29357,29.734435|13"},{n:"\u516D\u5B89",g:"116.505253,31.755558|13"},{n:"\u9A6C\u978D\u5C71",g:"118.515882,31.688528|13"},{n:"\u5BBF\u5DDE",g:"116.988692,33.636772|13"},{n:"\u94DC\u9675",g:"117.819429,30.94093|14"},{n:"\u829C\u6E56",g:"118.384108,31.36602|12"},{n:"\u5BA3\u57CE",g:"118.752096,30.951642|13"}]},{n:"\u798F\u5EFA",g:"117.984943,26.050118|8",cities:[{n:"\u798F\u5DDE",g:"119.330221,26.047125|12"},{n:"\u9F99\u5CA9",g:"117.017997,25.078685|13"},{n:"\u5357\u5E73",g:"118.181883,26.643626|13"},{n:"\u5B81\u5FB7",g:"119.542082,26.656527|14"},{n:"\u8386\u7530",g:"119.077731,25.44845|13"},{n:"\u6CC9\u5DDE",g:"118.600362,24.901652|12"},{n:"\u4E09\u660E",g:"117.642194,26.270835|14"},{n:"\u53A6\u95E8",g:"118.103886,24.489231|12"},{n:"\u6F33\u5DDE",g:"117.676205,24.517065|12"}]},{n:"\u7518\u8083",g:"102.457625,38.103267|6",cities:[{n:"\u5170\u5DDE",g:"103.823305,36.064226|12"},{n:"\u767D\u94F6",g:"104.171241,36.546682|13"},{n:"\u5B9A\u897F",g:"104.626638,35.586056|13"},{n:"\u7518\u5357\u5DDE",g:"102.917442,34.992211|14"},{n:"\u5609\u5CEA\u5173",g:"98.281635,39.802397|13"},{n:"\u91D1\u660C",g:"102.208126,38.516072|13"},{n:"\u9152\u6CC9",g:"98.508415,39.741474|13"},{n:"\u4E34\u590F\u5DDE",g:"103.215249,35.598514|13"},{n:"\u9647\u5357",g:"104.934573,33.39448|14"},{n:"\u5E73\u51C9",g:"106.688911,35.55011|13"},{n:"\u5E86\u9633",g:"107.644227,35.726801|13"},{n:"\u5929\u6C34",g:"105.736932,34.584319|13"},{n:"\u6B66\u5A01",g:"102.640147,37.933172|13"},{n:"\u5F20\u6396",g:"100.459892,38.93932|13"}]},{n:"\u5E7F\u4E1C",g:"113.394818,23.408004|8",cities:[{n:"\u5E7F\u5DDE",g:"113.30765,23.120049|12"},{n:"\u6F6E\u5DDE",g:"116.630076,23.661812|13"},{n:"\u4E1C\u839E",g:"113.763434,23.043024|12"},{n:"\u4F5B\u5C71",g:"113.134026,23.035095|13"},{n:"\u6CB3\u6E90",g:"114.713721,23.757251|12"},{n:"\u60E0\u5DDE",g:"114.410658,23.11354|12"},{n:"\u6C5F\u95E8",g:"113.078125,22.575117|13"},{n:"\u63ED\u9633",g:"116.379501,23.547999|13"},{n:"\u8302\u540D",g:"110.931245,21.668226|13"},{n:"\u6885\u5DDE",g:"116.126403,24.304571|13"},{n:"\u6E05\u8FDC",g:"113.040773,23.698469|13"},{n:"\u6C55\u5934",g:"116.72865,23.383908|13"},{n:"\u6C55\u5C3E",g:"115.372924,22.778731|14"},{n:"\u97F6\u5173",g:"113.594461,24.80296|13"},{n:"\u6DF1\u5733",g:"114.025974,22.546054|12"},{n:"\u9633\u6C5F",g:"111.97701,21.871517|14"},{n:"\u4E91\u6D6E",g:"112.050946,22.937976|13"},{n:"\u6E5B\u6C5F",g:"110.365067,21.257463|13"},{n:"\u8087\u5E86",g:"112.479653,23.078663|13"},{n:"\u4E2D\u5C71",g:"113.42206,22.545178|12"},{n:"\u73E0\u6D77",g:"113.562447,22.256915|13"}]},{n:"\u5E7F\u897F",g:"108.924274,23.552255|7",cities:[{n:"\u5357\u5B81",g:"108.297234,22.806493|12"},{n:"\u767E\u8272",g:"106.631821,23.901512|13"},{n:"\u5317\u6D77",g:"109.122628,21.472718|13"},{n:"\u5D07\u5DE6",g:"107.357322,22.415455|14"},{n:"\u9632\u57CE\u6E2F",g:"108.351791,21.617398|15"},{n:"\u6842\u6797",g:"110.26092,25.262901|12"},{n:"\u8D35\u6E2F",g:"109.613708,23.103373|13"},{n:"\u6CB3\u6C60",g:"108.069948,24.699521|14"},{n:"\u8D3A\u5DDE",g:"111.552594,24.411054|14"},{n:"\u6765\u5BBE",g:"109.231817,23.741166|14"},{n:"\u67F3\u5DDE",g:"109.422402,24.329053|12"},{n:"\u94A6\u5DDE",g:"108.638798,21.97335|13"},{n:"\u68A7\u5DDE",g:"111.305472,23.485395|13"},{n:"\u7389\u6797",g:"110.151676,22.643974|14"}]},{n:"\u8D35\u5DDE",g:"106.734996,26.902826|8",cities:[{n:"\u8D35\u9633",g:"106.709177,26.629907|12"},{n:"\u5B89\u987A",g:"105.92827,26.228595|13"},{n:"\u6BD5\u8282\u5730\u533A",g:"105.300492,27.302612|14"},{n:"\u516D\u76D8\u6C34",g:"104.852087,26.591866|13"},{n:"\u94DC\u4EC1\u5730\u533A",g:"109.196161,27.726271|14"},{n:"\u9075\u4E49",g:"106.93126,27.699961|13"},{n:"\u9ED4\u897F\u5357\u5DDE",g:"104.900558,25.095148|11"},{n:"\u9ED4\u4E1C\u5357\u5DDE",g:"107.985353,26.583992|11"},{n:"\u9ED4\u5357\u5DDE",g:"107.523205,26.264536|11"}]},{n:"\u6D77\u5357",g:"109.733755,19.180501|9",cities:[{n:"\u6D77\u53E3",g:"110.330802,20.022071|13"},{n:"\u767D\u6C99",g:"109.358586,19.216056|12"},{n:"\u4FDD\u4EAD",g:"109.656113,18.597592|12"},{n:"\u660C\u6C5F",g:"109.0113,19.222483|12"},{n:"\u510B\u5DDE",g:"109.413973,19.571153|13"},{n:"\u6F84\u8FC8",g:"109.996736,19.693135|13"},{n:"\u4E1C\u65B9",g:"108.85101,18.998161|13"},{n:"\u5B9A\u5B89",g:"110.32009,19.490991|13"},{n:"\u743C\u6D77",g:"110.414359,19.21483|13"},{n:"\u743C\u4E2D",g:"109.861849,19.039771|12"},{n:"\u4E50\u4E1C",g:"109.062698,18.658614|12"},{n:"\u4E34\u9AD8",g:"109.724101,19.805922|13"},{n:"\u9675\u6C34",g:"109.948661,18.575985|12"},{n:"\u4E09\u4E9A",g:"109.522771,18.257776|12"},{n:"\u5C6F\u660C",g:"110.063364,19.347749|13"},{n:"\u4E07\u5B81",g:"110.292505,18.839886|13"},{n:"\u6587\u660C",g:"110.780909,19.750947|13"},{n:"\u4E94\u6307\u5C71",g:"109.51775,18.831306|13"}]},{n:"\u6CB3\u5317",g:"115.661434,38.61384|7",cities:[{n:"\u77F3\u5BB6\u5E84",g:"114.522082,38.048958|12"},{n:"\u4FDD\u5B9A",g:"115.49481,38.886565|13"},{n:"\u6CA7\u5DDE",g:"116.863806,38.297615|13"},{n:"\u627F\u5FB7",g:"117.933822,40.992521|14"},{n:"\u90AF\u90F8",g:"114.482694,36.609308|13"},{n:"\u8861\u6C34",g:"115.686229,37.746929|13"},{n:"\u5ECA\u574A",g:"116.703602,39.518611|13"},{n:"\u79E6\u7687\u5C9B",g:"119.604368,39.945462|12"},{n:"\u5510\u5C71",g:"118.183451,39.650531|13"},{n:"\u90A2\u53F0",g:"114.520487,37.069531|13"},{n:"\u5F20\u5BB6\u53E3",g:"114.893782,40.811188|13"}]},{n:"\u6CB3\u5357",g:"113.486804,34.157184|7",cities:[{n:"\u90D1\u5DDE",g:"113.649644,34.75661|12"},{n:"\u5B89\u9633",g:"114.351807,36.110267|12"},{n:"\u9E64\u58C1",g:"114.29777,35.755426|13"},{n:"\u7126\u4F5C",g:"113.211836,35.234608|13"},{n:"\u5F00\u5C01",g:"114.351642,34.801854|13"},{n:"\u6D1B\u9633",g:"112.447525,34.657368|12"},{n:"\u6F2F\u6CB3",g:"114.046061,33.576279|13"},{n:"\u5357\u9633",g:"112.542842,33.01142|13"},{n:"\u5E73\u9876\u5C71",g:"113.300849,33.745301|13"},{n:"\u6FEE\u9633",g:"115.026627,35.753298|12"},{n:"\u4E09\u95E8\u5CE1",g:"111.181262,34.78332|13"},{n:"\u5546\u4E18",g:"115.641886,34.438589|13"},{n:"\u65B0\u4E61",g:"113.91269,35.307258|13"},{n:"\u4FE1\u9633",g:"114.085491,32.128582|13"},{n:"\u8BB8\u660C",g:"113.835312,34.02674|13"},{n:"\u5468\u53E3",g:"114.654102,33.623741|13"},{n:"\u9A7B\u9A6C\u5E97",g:"114.049154,32.983158|13"}]},{n:"\u9ED1\u9F99\u6C5F",g:"128.047414,47.356592|6",cities:[{n:"\u54C8\u5C14\u6EE8",g:"126.657717,45.773225|12"},{n:"\u5927\u5E86",g:"125.02184,46.596709|12"},{n:"\u5927\u5174\u5B89\u5CAD\u5730\u533A",g:"124.196104,51.991789|10"},{n:"\u9E64\u5C97",g:"130.292472,47.338666|13"},{n:"\u9ED1\u6CB3",g:"127.50083,50.25069|14"},{n:"\u9E21\u897F",g:"130.941767,45.32154|13"},{n:"\u4F73\u6728\u65AF",g:"130.284735,46.81378|12"},{n:"\u7261\u4E39\u6C5F",g:"129.608035,44.588521|13"},{n:"\u4E03\u53F0\u6CB3",g:"131.019048,45.775005|14"},{n:"\u9F50\u9F50\u54C8\u5C14",g:"123.987289,47.3477|13"},{n:"\u53CC\u9E2D\u5C71",g:"131.171402,46.655102|13"},{n:"\u7EE5\u5316",g:"126.989095,46.646064|13"},{n:"\u4F0A\u6625",g:"128.910766,47.734685|14"}]},{n:"\u6E56\u5317",g:"112.410562,31.209316|8",cities:[{n:"\u6B66\u6C49",g:"114.3162,30.581084|12"},{n:"\u9102\u5DDE",g:"114.895594,30.384439|14"},{n:"\u6069\u65BD",g:"109.517433,30.308978|14"},{n:"\u9EC4\u5188",g:"114.906618,30.446109|14"},{n:"\u9EC4\u77F3",g:"115.050683,30.216127|13"},{n:"\u8346\u95E8",g:"112.21733,31.042611|13"},{n:"\u8346\u5DDE",g:"112.241866,30.332591|12"},{n:"\u6F5C\u6C5F",g:"112.768768,30.343116|13"},{n:"\u795E\u519C\u67B6\u6797\u533A",g:"110.487231,31.595768|13"},{n:"\u5341\u5830",g:"110.801229,32.636994|13"},{n:"\u968F\u5DDE",g:"113.379358,31.717858|13"},{n:"\u5929\u95E8",g:"113.12623,30.649047|13"},{n:"\u4ED9\u6843",g:"113.387448,30.293966|13"},{n:"\u54B8\u5B81",g:"114.300061,29.880657|13"},{n:"\u8944\u9633",g:"112.176326,32.094934|12"},{n:"\u5B5D\u611F",g:"113.935734,30.927955|13"},{n:"\u5B9C\u660C",g:"111.310981,30.732758|13"}]},{n:"\u6E56\u5357",g:"111.720664,27.695864|7",cities:[{n:"\u957F\u6C99",g:"112.979353,28.213478|12"},{n:"\u5E38\u5FB7",g:"111.653718,29.012149|12"},{n:"\u90F4\u5DDE",g:"113.037704,25.782264|13"},{n:"\u8861\u9633",g:"112.583819,26.898164|13"},{n:"\u6000\u5316",g:"109.986959,27.557483|13"},{n:"\u5A04\u5E95",g:"111.996396,27.741073|13"},{n:"\u90B5\u9633",g:"111.461525,27.236811|13"},{n:"\u6E58\u6F6D",g:"112.935556,27.835095|13"},{n:"\u6E58\u897F\u5DDE",g:"109.745746,28.317951|14"},{n:"\u76CA\u9633",g:"112.366547,28.588088|13"},{n:"\u6C38\u5DDE",g:"111.614648,26.435972|13"},{n:"\u5CB3\u9633",g:"113.146196,29.378007|13"},{n:"\u5F20\u5BB6\u754C",g:"110.48162,29.124889|13"},{n:"\u682A\u6D32",g:"113.131695,27.827433|13"}]},{n:"\u6C5F\u82CF",g:"119.368489,33.013797|8",cities:[{n:"\u5357\u4EAC",g:"118.778074,32.057236|12"},{n:"\u5E38\u5DDE",g:"119.981861,31.771397|12"},{n:"\u6DEE\u5B89",g:"119.030186,33.606513|12"},{n:"\u8FDE\u4E91\u6E2F",g:"119.173872,34.601549|12"},{n:"\u5357\u901A",g:"120.873801,32.014665|12"},{n:"\u82CF\u5DDE",g:"120.619907,31.317987|12"},{n:"\u5BBF\u8FC1",g:"118.296893,33.95205|13"},{n:"\u6CF0\u5DDE",g:"119.919606,32.476053|13"},{n:"\u65E0\u9521",g:"120.305456,31.570037|12"},{n:"\u5F90\u5DDE",g:"117.188107,34.271553|12"},{n:"\u76D0\u57CE",g:"120.148872,33.379862|12"},{n:"\u626C\u5DDE",g:"119.427778,32.408505|13"},{n:"\u9547\u6C5F",g:"119.455835,32.204409|13"}]},{n:"\u6C5F\u897F",g:"115.676082,27.757258|7",cities:[{n:"\u5357\u660C",g:"115.893528,28.689578|12"},{n:"\u629A\u5DDE",g:"116.360919,27.954545|13"},{n:"\u8D63\u5DDE",g:"114.935909,25.845296|13"},{n:"\u5409\u5B89",g:"114.992039,27.113848|13"},{n:"\u666F\u5FB7\u9547",g:"117.186523,29.303563|12"},{n:"\u4E5D\u6C5F",g:"115.999848,29.71964|13"},{n:"\u840D\u4E61",g:"113.859917,27.639544|13"},{n:"\u4E0A\u9976",g:"117.955464,28.457623|13"},{n:"\u65B0\u4F59",g:"114.947117,27.822322|13"},{n:"\u5B9C\u6625",g:"114.400039,27.81113|13"},{n:"\u9E70\u6F6D",g:"117.03545,28.24131|13"}]},{n:"\u5409\u6797",g:"126.262876,43.678846|7",cities:[{n:"\u957F\u6625",g:"125.313642,43.898338|12"},{n:"\u767D\u57CE",g:"122.840777,45.621086|13"},{n:"\u767D\u5C71",g:"126.435798,41.945859|13"},{n:"\u5409\u6797",g:"126.564544,43.871988|12"},{n:"\u8FBD\u6E90",g:"125.133686,42.923303|13"},{n:"\u56DB\u5E73",g:"124.391382,43.175525|12"},{n:"\u677E\u539F",g:"124.832995,45.136049|13"},{n:"\u901A\u5316",g:"125.94265,41.736397|13"},{n:"\u5EF6\u8FB9",g:"129.485902,42.896414|13"}]},{n:"\u8FBD\u5B81",g:"122.753592,41.6216|8",cities:[{n:"\u6C88\u9633",g:"123.432791,41.808645|12"},{n:"\u978D\u5C71",g:"123.007763,41.118744|13"},{n:"\u672C\u6EAA",g:"123.778062,41.325838|12"},{n:"\u671D\u9633",g:"120.446163,41.571828|13"},{n:"\u5927\u8FDE",g:"121.593478,38.94871|12"},{n:"\u4E39\u4E1C",g:"124.338543,40.129023|12"},{n:"\u629A\u987A",g:"123.92982,41.877304|12"},{n:"\u961C\u65B0",g:"121.660822,42.01925|14"},{n:"\u846B\u82A6\u5C9B",g:"120.860758,40.74303|13"},{n:"\u9526\u5DDE",g:"121.147749,41.130879|13"},{n:"\u8FBD\u9633",g:"123.172451,41.273339|14"},{n:"\u76D8\u9526",g:"122.073228,41.141248|13"},{n:"\u94C1\u5CAD",g:"123.85485,42.299757|13"},{n:"\u8425\u53E3",g:"122.233391,40.668651|13"}]},{n:"\u5185\u8499\u53E4",g:"114.415868,43.468238|5",cities:[{n:"\u547C\u548C\u6D69\u7279",g:"111.660351,40.828319|12"},{n:"\u963F\u62C9\u5584\u76DF",g:"105.695683,38.843075|14"},{n:"\u5305\u5934",g:"109.846239,40.647119|12"},{n:"\u5DF4\u5F66\u6DD6\u5C14",g:"107.423807,40.76918|12"},{n:"\u8D64\u5CF0",g:"118.930761,42.297112|12"},{n:"\u9102\u5C14\u591A\u65AF",g:"109.993706,39.81649|12"},{n:"\u547C\u4F26\u8D1D\u5C14",g:"119.760822,49.201636|12"},{n:"\u901A\u8FBD",g:"122.260363,43.633756|12"},{n:"\u4E4C\u6D77",g:"106.831999,39.683177|13"},{n:"\u4E4C\u5170\u5BDF\u5E03",g:"113.112846,41.022363|12"},{n:"\u9521\u6797\u90ED\u52D2\u76DF",g:"116.02734,43.939705|11"},{n:"\u5174\u5B89\u76DF",g:"122.048167,46.083757|11"}]},{n:"\u5B81\u590F",g:"106.155481,37.321323|8",cities:[{n:"\u94F6\u5DDD",g:"106.206479,38.502621|12"},{n:"\u56FA\u539F",g:"106.285268,36.021523|13"},{n:"\u77F3\u5634\u5C71",g:"106.379337,39.020223|13"},{n:"\u5434\u5FE0",g:"106.208254,37.993561|14"},{n:"\u4E2D\u536B",g:"105.196754,37.521124|14"}]},{n:"\u9752\u6D77",g:"96.202544,35.499761|7",cities:[{n:"\u897F\u5B81",g:"101.767921,36.640739|12"},{n:"\u679C\u6D1B\u5DDE",g:"100.223723,34.480485|11"},{n:"\u6D77\u4E1C\u5730\u533A",g:"102.085207,36.51761|11"},{n:"\u6D77\u5317\u5DDE",g:"100.879802,36.960654|11"},{n:"\u6D77\u5357\u5DDE",g:"100.624066,36.284364|11"},{n:"\u6D77\u897F\u5DDE",g:"97.342625,37.373799|11"},{n:"\u9EC4\u5357\u5DDE",g:"102.0076,35.522852|11"},{n:"\u7389\u6811\u5DDE",g:"97.013316,33.00624|14"}]},{n:"\u5C71\u4E1C",g:"118.527663,36.09929|8",cities:[{n:"\u6D4E\u5357",g:"117.024967,36.682785|12"},{n:"\u6EE8\u5DDE",g:"117.968292,37.405314|12"},{n:"\u4E1C\u8425",g:"118.583926,37.487121|12"},{n:"\u5FB7\u5DDE",g:"116.328161,37.460826|12"},{n:"\u83CF\u6CFD",g:"115.46336,35.26244|13"},{n:"\u6D4E\u5B81",g:"116.600798,35.402122|13"},{n:"\u83B1\u829C",g:"117.684667,36.233654|13"},{n:"\u804A\u57CE",g:"115.986869,36.455829|12"},{n:"\u4E34\u6C82",g:"118.340768,35.072409|12"},{n:"\u9752\u5C9B",g:"120.384428,36.105215|12"},{n:"\u65E5\u7167",g:"119.50718,35.420225|12"},{n:"\u6CF0\u5B89",g:"117.089415,36.188078|13"},{n:"\u5A01\u6D77",g:"122.093958,37.528787|13"},{n:"\u6F4D\u574A",g:"119.142634,36.716115|12"},{n:"\u70DF\u53F0",g:"121.309555,37.536562|12"},{n:"\u67A3\u5E84",g:"117.279305,34.807883|13"},{n:"\u6DC4\u535A",g:"118.059134,36.804685|12"}]},{n:"\u5C71\u897F",g:"112.515496,37.866566|7",cities:[{n:"\u592A\u539F",g:"112.550864,37.890277|12"},{n:"\u957F\u6CBB",g:"113.120292,36.201664|12"},{n:"\u5927\u540C",g:"113.290509,40.113744|12"},{n:"\u664B\u57CE",g:"112.867333,35.499834|13"},{n:"\u664B\u4E2D",g:"112.738514,37.693362|13"},{n:"\u4E34\u6C7E",g:"111.538788,36.099745|13"},{n:"\u5415\u6881",g:"111.143157,37.527316|14"},{n:"\u6714\u5DDE",g:"112.479928,39.337672|13"},{n:"\u5FFB\u5DDE",g:"112.727939,38.461031|12"},{n:"\u9633\u6CC9",g:"113.569238,37.869529|13"},{n:"\u8FD0\u57CE",g:"111.006854,35.038859|13"}]},{n:"\u9655\u897F",g:"109.503789,35.860026|7",cities:[{n:"\u897F\u5B89",g:"108.953098,34.2778|12"},{n:"\u5B89\u5EB7",g:"109.038045,32.70437|13"},{n:"\u5B9D\u9E21",g:"107.170645,34.364081|12"},{n:"\u6C49\u4E2D",g:"107.045478,33.081569|13"},{n:"\u5546\u6D1B",g:"109.934208,33.873907|13"},{n:"\u94DC\u5DDD",g:"108.968067,34.908368|13"},{n:"\u6E2D\u5357",g:"109.483933,34.502358|13"},{n:"\u54B8\u9633",g:"108.707509,34.345373|13"},{n:"\u5EF6\u5B89",g:"109.50051,36.60332|13"},{n:"\u6986\u6797",g:"109.745926,38.279439|12"}]},{n:"\u56DB\u5DDD",g:"102.89916,30.367481|7",cities:[{n:"\u6210\u90FD",g:"104.067923,30.679943|12"},{n:"\u963F\u575D\u5DDE",g:"102.228565,31.905763|15"},{n:"\u5DF4\u4E2D",g:"106.757916,31.869189|14"},{n:"\u8FBE\u5DDE",g:"107.494973,31.214199|14"},{n:"\u5FB7\u9633",g:"104.402398,31.13114|13"},{n:"\u7518\u5B5C\u5DDE",g:"101.969232,30.055144|15"},{n:"\u5E7F\u5B89",g:"106.63572,30.463984|13"},{n:"\u5E7F\u5143",g:"105.819687,32.44104|13"},{n:"\u4E50\u5C71",g:"103.760824,29.600958|13"},{n:"\u51C9\u5C71\u5DDE",g:"102.259591,27.892393|14"},{n:"\u6CF8\u5DDE",g:"105.44397,28.89593|14"},{n:"\u5357\u5145",g:"106.105554,30.800965|13"},{n:"\u7709\u5C71",g:"103.84143,30.061115|13"},{n:"\u7EF5\u9633",g:"104.705519,31.504701|12"},{n:"\u5185\u6C5F",g:"105.073056,29.599462|13"},{n:"\u6500\u679D\u82B1",g:"101.722423,26.587571|14"},{n:"\u9042\u5B81",g:"105.564888,30.557491|12"},{n:"\u96C5\u5B89",g:"103.009356,29.999716|13"},{n:"\u5B9C\u5BBE",g:"104.633019,28.769675|13"},{n:"\u8D44\u9633",g:"104.63593,30.132191|13"},{n:"\u81EA\u8D21",g:"104.776071,29.359157|13"}]},{n:"\u897F\u85CF",g:"89.137982,31.367315|6",cities:[{n:"\u62C9\u8428",g:"91.111891,29.662557|13"},{n:"\u963F\u91CC\u5730\u533A",g:"81.107669,30.404557|11"},{n:"\u660C\u90FD\u5730\u533A",g:"97.185582,31.140576|15"},{n:"\u6797\u829D\u5730\u533A",g:"94.349985,29.666941|11"},{n:"\u90A3\u66F2\u5730\u533A",g:"92.067018,31.48068|14"},{n:"\u65E5\u5580\u5219\u5730\u533A",g:"88.891486,29.269023|14"},{n:"\u5C71\u5357\u5730\u533A",g:"91.750644,29.229027|11"}]},{n:"\u65B0\u7586",g:"85.614899,42.127001|6",cities:[{n:"\u4E4C\u9C81\u6728\u9F50",g:"87.564988,43.84038|12"},{n:"\u963F\u62C9\u5C14",g:"81.291737,40.61568|13"},{n:"\u963F\u514B\u82CF\u5730\u533A",g:"80.269846,41.171731|12"},{n:"\u963F\u52D2\u6CF0\u5730\u533A",g:"88.137915,47.839744|13"},{n:"\u5DF4\u97F3\u90ED\u695E",g:"86.121688,41.771362|12"},{n:"\u535A\u5C14\u5854\u62C9\u5DDE",g:"82.052436,44.913651|11"},{n:"\u660C\u5409\u5DDE",g:"87.296038,44.007058|13"},{n:"\u54C8\u5BC6\u5730\u533A",g:"93.528355,42.858596|13"},{n:"\u548C\u7530\u5730\u533A",g:"79.930239,37.116774|13"},{n:"\u5580\u4EC0\u5730\u533A",g:"75.992973,39.470627|12"},{n:"\u514B\u62C9\u739B\u4F9D",g:"84.88118,45.594331|13"},{n:"\u514B\u5B5C\u52D2\u82CF\u5DDE",g:"76.137564,39.750346|11"},{n:"\u77F3\u6CB3\u5B50",g:"86.041865,44.308259|13"},{n:"\u5854\u57CE\u5730\u533A",g:"82.974881,46.758684|12"},{n:"\u56FE\u6728\u8212\u514B",g:"79.198155,39.889223|13"},{n:"\u5410\u9C81\u756A\u5730\u533A",g:"89.181595,42.96047|13"},{n:"\u4E94\u5BB6\u6E20",g:"87.565449,44.368899|13"},{n:"\u4F0A\u7281\u5DDE",g:"81.297854,43.922248|11"}]},{n:"\u4E91\u5357",g:"101.592952,24.864213|7",cities:[{n:"\u6606\u660E",g:"102.714601,25.049153|12"},{n:"\u4FDD\u5C71",g:"99.177996,25.120489|13"},{n:"\u695A\u96C4\u5DDE",g:"101.529382,25.066356|13"},{n:"\u5927\u7406\u5DDE",g:"100.223675,25.5969|14"},{n:"\u5FB7\u5B8F\u5DDE",g:"98.589434,24.44124|14"},{n:"\u8FEA\u5E86\u5DDE",g:"99.713682,27.831029|14"},{n:"\u7EA2\u6CB3\u5DDE",g:"103.384065,23.367718|11"},{n:"\u4E3D\u6C5F",g:"100.229628,26.875351|13"},{n:"\u4E34\u6CA7",g:"100.092613,23.887806|14"},{n:"\u6012\u6C5F\u5DDE",g:"98.859932,25.860677|14"},{n:"\u666E\u6D31",g:"100.980058,22.788778|14"},{n:"\u66F2\u9756",g:"103.782539,25.520758|12"},{n:"\u662D\u901A",g:"103.725021,27.340633|13"},{n:"\u6587\u5C71",g:"104.089112,23.401781|14"},{n:"\u897F\u53CC\u7248\u7EB3",g:"100.803038,22.009433|13"},{n:"\u7389\u6EAA",g:"102.545068,24.370447|13"}]},{n:"\u6D59\u6C5F",g:"119.957202,29.159494|8",cities:[{n:"\u676D\u5DDE",g:"120.219375,30.259244|12"},{n:"\u6E56\u5DDE",g:"120.137243,30.877925|12"},{n:"\u5609\u5174",g:"120.760428,30.773992|13"},{n:"\u91D1\u534E",g:"119.652576,29.102899|12"},{n:"\u4E3D\u6C34",g:"119.929576,28.4563|13"},{n:"\u5B81\u6CE2",g:"121.579006,29.885259|12"},{n:"\u8862\u5DDE",g:"118.875842,28.95691|12"},{n:"\u7ECD\u5174",g:"120.592467,30.002365|13"},{n:"\u53F0\u5DDE",g:"121.440613,28.668283|13"},{n:"\u6E29\u5DDE",g:"120.690635,28.002838|12"},{n:"\u821F\u5C71",g:"122.169872,30.03601|13"}]}],Sf=[{n:"\u9999\u6E2F",g:"114.186124,22.293586|11"},{n:"\u6FB3\u95E8",g:"113.557519,22.204118|13"},{n:"\u53F0\u6E7E",g:"120.961454,23.80406|8"}],Nu=void 0,ja=function(){if(Nu!==void 0)return Nu;var l=navigator.userAgent,h="Android;iPhone;SymbianOS;Windows Phone;iPad;iPod".split(";");Nu=!1;for(var o=0;o<h.length;o++)if(0<l.indexOf(h[o])){Nu=!0;break}return Nu}(),If=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),kl=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),wg=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),dd=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Fs=Array(576);Es(Fs);var Ao=Array(60);Es(Ao);var Xa=Array(512);Es(Xa);var Uu=Array(256);Es(Uu);var Ef=Array(29);Es(Ef);var Xh=Array(30);Es(Xh);var md=void 0,Mg=void 0,Cg=void 0,Yh=function(l,h){l.pending_buf[l.pending++]=h&255,l.pending_buf[l.pending++]=h>>>8&255},_o=function(l,h,o){l.bi_valid>16-o?(l.bi_buf|=h<<l.bi_valid&65535,Yh(l,l.bi_buf),l.bi_buf=h>>16-l.bi_valid,l.bi_valid+=o-16):(l.bi_buf|=h<<l.bi_valid&65535,l.bi_valid+=o)},ps=function(l,h,o){_o(l,o[2*h],o[2*h+1])},Tg=function(l,h){var o=0;do o|=l&1,l>>>=1,o<<=1;while(0<--h);return o>>>1},Sg=function(l,h,o){var a=Array(16),y=0,g;for(g=1;15>=g;g++)a[g]=y=y+o[g-1]<<1;for(o=0;o<=h;o++)y=l[2*o+1],y!==0&&(l[2*o]=Tg(a[y]++,y))},gd=function(l){var h;for(h=0;286>h;h++)l.dyn_ltree[2*h]=0;for(h=0;30>h;h++)l.dyn_dtree[2*h]=0;for(h=0;19>h;h++)l.bl_tree[2*h]=0;l.dyn_ltree[512]=1,l.opt_len=l.static_len=0,l.last_lit=l.matches=0},Ig=function(l){8<l.bi_valid?Yh(l,l.bi_buf):0<l.bi_valid&&(l.pending_buf[l.pending++]=l.bi_buf),l.bi_buf=0,l.bi_valid=0},Zh=function(l,h,o,a){var y=2*h,g=2*o;return l[y]<l[g]||l[y]===l[g]&&a[h]<=a[o]},vd=function(l,h,o){for(var a=l.heap[o],y=o<<1;y<=l.heap_len&&(y<l.heap_len&&Zh(h,l.heap[y+1],l.heap[y],l.depth)&&y++,!Zh(h,a,l.heap[y],l.depth));)l.heap[o]=l.heap[y],o=y,y<<=1;l.heap[o]=a},Eg=function(l,h,o){var a=0;if(l.last_lit!==0)do{var y=l.pending_buf[l.d_buf+2*a]<<8|l.pending_buf[l.d_buf+2*a+1],g=l.pending_buf[l.l_buf+a];if(a++,y===0)ps(l,g,h);else{var x=Uu[g];ps(l,x+256+1,h);var v=If[x];v!==0&&(g-=Ef[x],_o(l,g,v)),y--,x=256>y?Xa[y]:Xa[256+(y>>>7)],ps(l,x,o),v=kl[x],v!==0&&(y-=Xh[x],_o(l,y,v))}}while(a<l.last_lit);ps(l,256,h)},yd=function(l,h){var o=h.dyn_tree,a=h.stat_desc.static_tree,y=h.stat_desc.has_stree,g=h.stat_desc.elems,x,v=-1;for(l.heap_len=0,l.heap_max=573,x=0;x<g;x++)o[2*x]!==0?(l.heap[++l.heap_len]=v=x,l.depth[x]=0):o[2*x+1]=0;for(;2>l.heap_len;){var M=l.heap[++l.heap_len]=2>v?++v:0;o[2*M]=1,l.depth[M]=0,l.opt_len--,y&&(l.static_len-=a[2*M+1])}for(h.max_code=v,x=l.heap_len>>1;1<=x;x--)vd(l,o,x);M=g;do x=l.heap[1],l.heap[1]=l.heap[l.heap_len--],vd(l,o,1),a=l.heap[1],l.heap[--l.heap_max]=x,l.heap[--l.heap_max]=a,o[2*M]=o[2*x]+o[2*a],l.depth[M]=(l.depth[x]>=l.depth[a]?l.depth[x]:l.depth[a])+1,o[2*x+1]=o[2*a+1]=M,l.heap[1]=M++,vd(l,o,1);while(2<=l.heap_len);l.heap[--l.heap_max]=l.heap[1],x=h.dyn_tree,M=h.max_code,a=h.stat_desc.static_tree,y=h.stat_desc.has_stree,g=h.stat_desc.extra_bits;var D=h.stat_desc.extra_base,U=h.stat_desc.max_length,C,L=0;for(C=0;15>=C;C++)l.bl_count[C]=0;for(x[2*l.heap[l.heap_max]+1]=0,h=l.heap_max+1;573>h;h++){var B=l.heap[h];if(C=x[2*x[2*B+1]+1]+1,C>U&&(C=U,L++),x[2*B+1]=C,!(B>M)){l.bl_count[C]++;var O=0;B>=D&&(O=g[B-D]);var k=x[2*B];l.opt_len+=k*(C+O),y&&(l.static_len+=k*(a[2*B+1]+O))}}if(L!==0){do{for(C=U-1;l.bl_count[C]===0;)C--;l.bl_count[C]--,l.bl_count[C+1]+=2,l.bl_count[U]--,L-=2}while(0<L);for(C=U;C!==0;C--)for(B=l.bl_count[C];B!==0;)a=l.heap[--h],a>M||(x[2*a+1]!==C&&(l.opt_len+=(C-x[2*a+1])*x[2*a],x[2*a+1]=C),B--)}Sg(o,v,l.bl_count)},Lg=function(l,h,o){var a,y=-1,g=h[1],x=0,v=7,M=4;for(g===0&&(v=138,M=3),h[2*(o+1)+1]=65535,a=0;a<=o;a++){var D=g;g=h[2*(a+1)+1],++x<v&&D===g||(x<M?l.bl_tree[2*D]+=x:D!==0?(D!==y&&l.bl_tree[2*D]++,l.bl_tree[32]++):10>=x?l.bl_tree[34]++:l.bl_tree[36]++,x=0,y=D,g===0?(v=138,M=3):D===g?(v=6,M=3):(v=7,M=4))}},io=function(l,h,o){var a,y=-1,g=h[1],x=0,v=7,M=4;for(g===0&&(v=138,M=3),a=0;a<=o;a++){var D=g;if(g=h[2*(a+1)+1],!(++x<v&&D===g)){if(x<M)do ps(l,D,l.bl_tree);while(--x!==0);else D!==0?(D!==y&&(ps(l,D,l.bl_tree),x--),ps(l,16,l.bl_tree),_o(l,x-3,2)):10>=x?(ps(l,17,l.bl_tree),_o(l,x-3,3)):(ps(l,18,l.bl_tree),_o(l,x-11,7));x=0,y=D,g===0?(v=138,M=3):D===g?(v=6,M=3):(v=7,M=4)}}},T1=function(l){var h=4093624447,o;for(o=0;31>=o;o++,h>>>=1)if(h&1&&l.dyn_ltree[2*o]!==0)return 0;if(l.dyn_ltree[18]!==0||l.dyn_ltree[20]!==0||l.dyn_ltree[26]!==0)return 1;for(o=32;256>o;o++)if(l.dyn_ltree[2*o]!==0)return 1;return 0},Rg=!1,xd=function(l,h,o,a){_o(l,a?1:0,3),Ig(l),Yh(l,o),Yh(l,~o),l.pending_buf.set(l.window.subarray(h,h+o),l.pending),l.pending+=o},qh=function(l,h,o,a){var y=l&65535|0;l=l>>>16&65535|0;for(var g;o!==0;){g=2e3<o?2e3:o,o-=g;do y=y+h[a++]|0,l=l+y|0;while(--g);y%=65521,l%=65521}return y|l<<16|0},S1=new Uint32Array(function(){for(var l,h=[],o=0;256>o;o++){l=o;for(var a=0;8>a;a++)l=l&1?3988292384^l>>>1:l>>>1;h[o]=l}return h}()),Hn=function(l,h,o,a){for(o=a+o,l^=-1;a<o;a++)l=l>>>8^S1[(l^h[a])&255];return l^-1},Ya={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},br={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8},Za=function(l,h,o){return l.pending_buf[l.d_buf+2*l.last_lit]=h>>>8&255,l.pending_buf[l.d_buf+2*l.last_lit+1]=h&255,l.pending_buf[l.l_buf+l.last_lit]=o&255,l.last_lit++,h===0?l.dyn_ltree[2*o]++:(l.matches++,h--,l.dyn_ltree[2*(Uu[o]+256+1)]++,l.dyn_dtree[2*(256>h?Xa[h]:Xa[256+(h>>>7)])]++),l.last_lit===l.lit_bufsize-1},aa=br.Z_NO_FLUSH,Lf=br.Z_PARTIAL_FLUSH,I1=br.Z_FULL_FLUSH,qo=br.Z_FINISH,Jh=br.Z_BLOCK,No=br.Z_OK,Ad=br.Z_STREAM_END,Jo=br.Z_STREAM_ERROR,Rf=br.Z_DATA_ERROR,Qh=br.Z_BUF_ERROR,wn=br.Z_DEFAULT_COMPRESSION,Hl=br.Z_FILTERED,Gl=br.Z_HUFFMAN_ONLY,_d=br.Z_RLE,bu=br.Z_FIXED,Pg=br.Z_DEFAULT_STRATEGY,E1=br.Z_UNKNOWN,Bs=br.Z_DEFLATED,ua=function(l,h){return l.msg=Ya[h],h},Gn=function(l){for(var h=l.length;0<=--h;)l[h]=0},qa=function(l,h,o){return(h<<l.hash_shift^o)&l.hash_mask},Qo=function(l){var h=l.state,o=h.pending;o>l.avail_out&&(o=l.avail_out),o!==0&&(l.output.set(h.pending_buf.subarray(h.pending_out,h.pending_out+o),l.next_out),l.next_out+=o,h.pending_out+=o,l.total_out+=o,l.avail_out-=o,h.pending-=o,h.pending===0&&(h.pending_out=0))},no=function(l,h){var o=0<=l.block_start?l.block_start:-1,a=l.strstart-l.block_start,y=0;if(0<l.level){for(l.strm.data_type===2&&(l.strm.data_type=T1(l)),yd(l,l.l_desc),yd(l,l.d_desc),Lg(l,l.dyn_ltree,l.l_desc.max_code),Lg(l,l.dyn_dtree,l.d_desc.max_code),yd(l,l.bl_desc),y=18;3<=y&&l.bl_tree[2*dd[y]+1]===0;y--);l.opt_len+=3*(y+1)+14;var g=l.opt_len+3+7>>>3,x=l.static_len+3+7>>>3;x<=g&&(g=x)}else g=x=a+5;if(a+4<=g&&o!==-1)xd(l,o,a,h);else if(l.strategy===4||x===g)_o(l,2+(h?1:0),3),Eg(l,Fs,Ao);else{for(_o(l,4+(h?1:0),3),o=l.l_desc.max_code+1,a=l.d_desc.max_code+1,y+=1,_o(l,o-257,5),_o(l,a-1,5),_o(l,y-4,4),g=0;g<y;g++)_o(l,l.bl_tree[2*dd[g]+1],3);io(l,l.dyn_ltree,o-1),io(l,l.dyn_dtree,a-1),Eg(l,l.dyn_ltree,l.dyn_dtree)}gd(l),h&&Ig(l),l.block_start=l.strstart,Qo(l.strm)},Mi=function(l,h){l.pending_buf[l.pending++]=h},Pf=function(l,h){l.pending_buf[l.pending++]=h>>>8&255,l.pending_buf[l.pending++]=h&255},Vn=function(l,h){var o=l.max_chain_length,a=l.strstart,y=l.prev_length,g=l.nice_match,x=l.strstart>l.w_size-262?l.strstart-(l.w_size-262):0,v=l.window,M=l.w_mask,D=l.prev,U=l.strstart+258,C=v[a+y-1],L=v[a+y];l.prev_length>=l.good_match&&(o>>=2),g>l.lookahead&&(g=l.lookahead);do{var B=h;if(v[B+y]===L&&v[B+y-1]===C&&v[B]===v[a]&&v[++B]===v[a+1]){for(a+=2,B++;v[++a]===v[++B]&&v[++a]===v[++B]&&v[++a]===v[++B]&&v[++a]===v[++B]&&v[++a]===v[++B]&&v[++a]===v[++B]&&v[++a]===v[++B]&&v[++a]===v[++B]&&a<U;);if(B=258-(U-a),a=U-258,B>y){if(l.match_start=h,y=B,B>=g)break;C=v[a+y-1],L=v[a+y]}}}while((h=D[h&M])>x&&--o!==0);return y<=l.lookahead?y:l.lookahead},Vl=function(l){var h=l.w_size,o;do{var a=l.window_size-l.lookahead-l.strstart;if(l.strstart>=h+(h-262)){l.window.set(l.window.subarray(h,h+h),0),l.match_start-=h,l.strstart-=h,l.block_start-=h;var y=o=l.hash_size;do{var g=l.head[--y];l.head[y]=g>=h?g-h:0}while(--o);y=o=h;do g=l.prev[--y],l.prev[y]=g>=h?g-h:0;while(--o);a+=h}if(l.strm.avail_in===0)break;y=l.strm,o=l.window,g=l.strstart+l.lookahead;var x=y.avail_in;if(x>a&&(x=a),x===0?o=0:(y.avail_in-=x,o.set(y.input.subarray(y.next_in,y.next_in+x),g),y.state.wrap===1?y.adler=qh(y.adler,o,x,g):y.state.wrap===2&&(y.adler=Hn(y.adler,o,x,g)),y.next_in+=x,y.total_in+=x,o=x),l.lookahead+=o,3<=l.lookahead+l.insert)for(a=l.strstart-l.insert,l.ins_h=l.window[a],l.ins_h=qa(l,l.ins_h,l.window[a+1]);l.insert&&(l.ins_h=qa(l,l.ins_h,l.window[a+3-1]),l.prev[a&l.w_mask]=l.head[l.ins_h],l.head[l.ins_h]=a,a++,l.insert--,!(3>l.lookahead+l.insert)););}while(262>l.lookahead&&l.strm.avail_in!==0)},rn=function(l,h){for(var o;;){if(262>l.lookahead){if(Vl(l),262>l.lookahead&&h===aa)return 1;if(l.lookahead===0)break}if(o=0,3<=l.lookahead&&(l.ins_h=qa(l,l.ins_h,l.window[l.strstart+3-1]),o=l.prev[l.strstart&l.w_mask]=l.head[l.ins_h],l.head[l.ins_h]=l.strstart),o!==0&&l.strstart-o<=l.w_size-262&&(l.match_length=Vn(l,o)),3<=l.match_length)if(o=Za(l,l.strstart-l.match_start,l.match_length-3),l.lookahead-=l.match_length,l.match_length<=l.max_lazy_match&&3<=l.lookahead){l.match_length--;do l.strstart++,l.ins_h=qa(l,l.ins_h,l.window[l.strstart+3-1]),l.prev[l.strstart&l.w_mask]=l.head[l.ins_h],l.head[l.ins_h]=l.strstart;while(--l.match_length!==0);l.strstart++}else l.strstart+=l.match_length,l.match_length=0,l.ins_h=l.window[l.strstart],l.ins_h=qa(l,l.ins_h,l.window[l.strstart+1]);else o=Za(l,0,l.window[l.strstart]),l.lookahead--,l.strstart++;if(o&&(no(l,!1),l.strm.avail_out===0))return 1}return l.insert=2>l.strstart?l.strstart:2,h===qo?(no(l,!0),l.strm.avail_out===0?3:4):l.last_lit&&(no(l,!1),l.strm.avail_out===0)?1:2},nn=function(l,h){for(var o,a;;){if(262>l.lookahead){if(Vl(l),262>l.lookahead&&h===aa)return 1;if(l.lookahead===0)break}if(o=0,3<=l.lookahead&&(l.ins_h=qa(l,l.ins_h,l.window[l.strstart+3-1]),o=l.prev[l.strstart&l.w_mask]=l.head[l.ins_h],l.head[l.ins_h]=l.strstart),l.prev_length=l.match_length,l.prev_match=l.match_start,l.match_length=2,o!==0&&l.prev_length<l.max_lazy_match&&l.strstart-o<=l.w_size-262&&(l.match_length=Vn(l,o),5>=l.match_length&&(l.strategy===Hl||l.match_length===3&&4096<l.strstart-l.match_start)&&(l.match_length=2)),3<=l.prev_length&&l.match_length<=l.prev_length){a=l.strstart+l.lookahead-3,o=Za(l,l.strstart-1-l.prev_match,l.prev_length-3),l.lookahead-=l.prev_length-1,l.prev_length-=2;do++l.strstart<=a&&(l.ins_h=qa(l,l.ins_h,l.window[l.strstart+3-1]),l.prev[l.strstart&l.w_mask]=l.head[l.ins_h],l.head[l.ins_h]=l.strstart);while(--l.prev_length!==0);if(l.match_available=0,l.match_length=2,l.strstart++,o&&(no(l,!1),l.strm.avail_out===0))return 1}else if(l.match_available){if((o=Za(l,0,l.window[l.strstart-1]))&&no(l,!1),l.strstart++,l.lookahead--,l.strm.avail_out===0)return 1}else l.match_available=1,l.strstart++,l.lookahead--}return l.match_available&&(Za(l,0,l.window[l.strstart-1]),l.match_available=0),l.insert=2>l.strstart?l.strstart:2,h===qo?(no(l,!0),l.strm.avail_out===0?3:4):l.last_lit&&(no(l,!1),l.strm.avail_out===0)?1:2},Dg=function(l,h){for(var o,a,y,g=l.window;;){if(258>=l.lookahead){if(Vl(l),258>=l.lookahead&&h===aa)return 1;if(l.lookahead===0)break}if(l.match_length=0,3<=l.lookahead&&0<l.strstart&&(a=l.strstart-1,o=g[a],o===g[++a]&&o===g[++a]&&o===g[++a])){for(y=l.strstart+258;o===g[++a]&&o===g[++a]&&o===g[++a]&&o===g[++a]&&o===g[++a]&&o===g[++a]&&o===g[++a]&&o===g[++a]&&a<y;);l.match_length=258-(y-a),l.match_length>l.lookahead&&(l.match_length=l.lookahead)}if(3<=l.match_length?(o=Za(l,1,l.match_length-3),l.lookahead-=l.match_length,l.strstart+=l.match_length,l.match_length=0):(o=Za(l,0,l.window[l.strstart]),l.lookahead--,l.strstart++),o&&(no(l,!1),l.strm.avail_out===0))return 1}return l.insert=0,h===qo?(no(l,!0),l.strm.avail_out===0?3:4):l.last_lit&&(no(l,!1),l.strm.avail_out===0)?1:2},MA=function(l,h){for(var o;;){if(l.lookahead===0&&(Vl(l),l.lookahead===0)){if(h===aa)return 1;break}if(l.match_length=0,o=Za(l,0,l.window[l.strstart]),l.lookahead--,l.strstart++,o&&(no(l,!1),l.strm.avail_out===0))return 1}return l.insert=0,h===qo?(no(l,!0),l.strm.avail_out===0?3:4):l.last_lit&&(no(l,!1),l.strm.avail_out===0)?1:2},Mn=[new wr(0,0,0,0,function(l,h){var o=65535;for(o>l.pending_buf_size-5&&(o=l.pending_buf_size-5);;){if(1>=l.lookahead){if(Vl(l),l.lookahead===0&&h===aa)return 1;if(l.lookahead===0)break}l.strstart+=l.lookahead,l.lookahead=0;var a=l.block_start+o;if((l.strstart===0||l.strstart>=a)&&(l.lookahead=l.strstart-a,l.strstart=a,no(l,!1),l.strm.avail_out===0)||l.strstart-l.block_start>=l.w_size-262&&(no(l,!1),l.strm.avail_out===0))return 1}return l.insert=0,h===qo?(no(l,!0),l.strm.avail_out===0?3:4):(l.strstart>l.block_start&&no(l,!1),1)}),new wr(4,4,8,4,rn),new wr(4,5,16,8,rn),new wr(4,6,32,32,rn),new wr(4,4,16,16,nn),new wr(8,16,32,32,nn),new wr(8,16,128,128,nn),new wr(8,32,128,256,nn),new wr(32,128,258,1024,nn),new wr(32,258,258,4096,nn)],Og=function(l){if(!l||!l.state)return ua(l,Jo);l.total_in=l.total_out=0,l.data_type=E1;var h=l.state;if(h.pending=0,h.pending_out=0,0>h.wrap&&(h.wrap=-h.wrap),h.status=h.wrap?42:113,l.adler=h.wrap===2?0:1,h.last_flush=aa,!Rg){var o,a,y;for(l=Array(16),y=a=0;28>y;y++)for(Ef[y]=a,o=0;o<1<<If[y];o++)Uu[a++]=y;for(Uu[a-1]=y,y=a=0;16>y;y++)for(Xh[y]=a,o=0;o<1<<kl[y];o++)Xa[a++]=y;for(a>>=7;30>y;y++)for(Xh[y]=a<<7,o=0;o<1<<kl[y]-7;o++)Xa[256+a++]=y;for(o=0;15>=o;o++)l[o]=0;for(o=0;143>=o;)Fs[2*o+1]=8,o++,l[8]++;for(;255>=o;)Fs[2*o+1]=9,o++,l[9]++;for(;279>=o;)Fs[2*o+1]=7,o++,l[7]++;for(;287>=o;)Fs[2*o+1]=8,o++,l[8]++;for(Sg(Fs,287,l),o=0;30>o;o++)Ao[2*o+1]=5,Ao[2*o]=Tg(o,5);md=new Rr(Fs,If,257,286,15),Mg=new Rr(Ao,kl,0,30,15),Cg=new Rr([],wg,0,19,7),Rg=!0}return h.l_desc=new Nn(h.dyn_ltree,md),h.d_desc=new Nn(h.dyn_dtree,Mg),h.bl_desc=new Nn(h.bl_tree,Cg),h.bi_buf=0,h.bi_valid=0,gd(h),No},Yr=function(l){var h=Og(l);return h===No&&(l=l.state,l.window_size=2*l.w_size,Gn(l.head),l.max_lazy_match=Mn[l.level].max_lazy,l.good_match=Mn[l.level].good_length,l.nice_match=Mn[l.level].nice_length,l.max_chain_length=Mn[l.level].max_chain,l.strstart=0,l.block_start=0,l.lookahead=0,l.insert=0,l.match_length=l.prev_length=2,l.match_available=0,l.ins_h=0),h},yi=function(l,h,o,a,y,g){if(!l)return Jo;var x=1;if(h===wn&&(h=6),0>a?(x=0,a=-a):15<a&&(x=2,a-=16),1>y||9<y||o!==Bs||8>a||15<a||0>h||9<h||0>g||g>bu)return ua(l,Jo);a===8&&(a=9);var v=new og;return l.state=v,v.strm=l,v.wrap=x,v.gzhead=null,v.w_bits=a,v.w_size=1<<v.w_bits,v.w_mask=v.w_size-1,v.hash_bits=y+7,v.hash_size=1<<v.hash_bits,v.hash_mask=v.hash_size-1,v.hash_shift=~~((v.hash_bits+3-1)/3),v.window=new Uint8Array(2*v.w_size),v.head=new Uint16Array(v.hash_size),v.prev=new Uint16Array(v.w_size),v.lit_bufsize=1<<y+6,v.pending_buf_size=4*v.lit_bufsize,v.pending_buf=new Uint8Array(v.pending_buf_size),v.d_buf=1*v.lit_bufsize,v.l_buf=3*v.lit_bufsize,v.level=h,v.strategy=g,v.method=o,Yr(l)},zs={deflateInit:function(l,h){return yi(l,h,Bs,15,8,Pg)},deflateInit2:yi,deflateReset:Yr,deflateResetKeep:Og,deflateSetHeader:function(l,h){return!l||!l.state||l.state.wrap!==2?Jo:(l.state.gzhead=h,No)},deflate:function(l,h){if(!l||!l.state||h>Jh||0>h)return l?ua(l,Jo):Jo;var o=l.state;if(!l.output||!l.input&&l.avail_in!==0||o.status===666&&h!==qo)return ua(l,l.avail_out===0?Qh:Jo);o.strm=l;var a=o.last_flush;if(o.last_flush=h,o.status===42)if(o.wrap===2)l.adler=0,Mi(o,31),Mi(o,139),Mi(o,8),o.gzhead?(Mi(o,(o.gzhead.text?1:0)+(o.gzhead.hcrc?2:0)+(o.gzhead.extra?4:0)+(o.gzhead.name?8:0)+(o.gzhead.comment?16:0)),Mi(o,o.gzhead.time&255),Mi(o,o.gzhead.time>>8&255),Mi(o,o.gzhead.time>>16&255),Mi(o,o.gzhead.time>>24&255),Mi(o,o.level===9?2:o.strategy>=Gl||2>o.level?4:0),Mi(o,o.gzhead.os&255),o.gzhead.extra&&o.gzhead.extra.length&&(Mi(o,o.gzhead.extra.length&255),Mi(o,o.gzhead.extra.length>>8&255)),o.gzhead.hcrc&&(l.adler=Hn(l.adler,o.pending_buf,o.pending,0)),o.gzindex=0,o.status=69):(Mi(o,0),Mi(o,0),Mi(o,0),Mi(o,0),Mi(o,0),Mi(o,o.level===9?2:o.strategy>=Gl||2>o.level?4:0),Mi(o,3),o.status=113);else{var y=Bs+(o.w_bits-8<<4)<<8;y|=(o.strategy>=Gl||2>o.level?0:6>o.level?1:o.level===6?2:3)<<6,o.strstart!==0&&(y|=32),o.status=113,Pf(o,y+(31-y%31)),o.strstart!==0&&(Pf(o,l.adler>>>16),Pf(o,l.adler&65535)),l.adler=1}if(o.status===69)if(o.gzhead.extra){for(y=o.pending;o.gzindex<(o.gzhead.extra.length&65535)&&(o.pending!==o.pending_buf_size||(o.gzhead.hcrc&&o.pending>y&&(l.adler=Hn(l.adler,o.pending_buf,o.pending-y,y)),Qo(l),y=o.pending,o.pending!==o.pending_buf_size));)Mi(o,o.gzhead.extra[o.gzindex]&255),o.gzindex++;o.gzhead.hcrc&&o.pending>y&&(l.adler=Hn(l.adler,o.pending_buf,o.pending-y,y)),o.gzindex===o.gzhead.extra.length&&(o.gzindex=0,o.status=73)}else o.status=73;if(o.status===73)if(o.gzhead.name){y=o.pending;do{if(o.pending===o.pending_buf_size&&(o.gzhead.hcrc&&o.pending>y&&(l.adler=Hn(l.adler,o.pending_buf,o.pending-y,y)),Qo(l),y=o.pending,o.pending===o.pending_buf_size)){var g=1;break}g=o.gzindex<o.gzhead.name.length?o.gzhead.name.charCodeAt(o.gzindex++)&255:0,Mi(o,g)}while(g!==0);o.gzhead.hcrc&&o.pending>y&&(l.adler=Hn(l.adler,o.pending_buf,o.pending-y,y)),g===0&&(o.gzindex=0,o.status=91)}else o.status=91;if(o.status===91)if(o.gzhead.comment){y=o.pending;do{if(o.pending===o.pending_buf_size&&(o.gzhead.hcrc&&o.pending>y&&(l.adler=Hn(l.adler,o.pending_buf,o.pending-y,y)),Qo(l),y=o.pending,o.pending===o.pending_buf_size)){g=1;break}g=o.gzindex<o.gzhead.comment.length?o.gzhead.comment.charCodeAt(o.gzindex++)&255:0,Mi(o,g)}while(g!==0);o.gzhead.hcrc&&o.pending>y&&(l.adler=Hn(l.adler,o.pending_buf,o.pending-y,y)),g===0&&(o.status=103)}else o.status=103;if(o.status===103&&(o.gzhead.hcrc?(o.pending+2>o.pending_buf_size&&Qo(l),o.pending+2<=o.pending_buf_size&&(Mi(o,l.adler&255),Mi(o,l.adler>>8&255),l.adler=0,o.status=113)):o.status=113),o.pending!==0){if(Qo(l),l.avail_out===0)return o.last_flush=-1,No}else if(l.avail_in===0&&(h<<1)-(4<h?9:0)<=(a<<1)-(4<a?9:0)&&h!==qo)return ua(l,Qh);if(o.status===666&&l.avail_in!==0)return ua(l,Qh);if(l.avail_in!==0||o.lookahead!==0||h!==aa&&o.status!==666){if(a=o.strategy===Gl?MA(o,h):o.strategy===_d?Dg(o,h):Mn[o.level].func(o,h),(a===3||a===4)&&(o.status=666),a===1||a===3)return l.avail_out===0&&(o.last_flush=-1),No;if(a===2&&(h===Lf?(_o(o,2,3),ps(o,256,Fs),o.bi_valid===16?(Yh(o,o.bi_buf),o.bi_buf=0,o.bi_valid=0):8<=o.bi_valid&&(o.pending_buf[o.pending++]=o.bi_buf&255,o.bi_buf>>=8,o.bi_valid-=8)):h!==Jh&&(xd(o,0,0,!1),h===I1&&(Gn(o.head),o.lookahead===0&&(o.strstart=0,o.block_start=0,o.insert=0))),Qo(l),l.avail_out===0))return o.last_flush=-1,No}return h!==qo?No:0>=o.wrap?Ad:(o.wrap===2?(Mi(o,l.adler&255),Mi(o,l.adler>>8&255),Mi(o,l.adler>>16&255),Mi(o,l.adler>>24&255),Mi(o,l.total_in&255),Mi(o,l.total_in>>8&255),Mi(o,l.total_in>>16&255),Mi(o,l.total_in>>24&255)):(Pf(o,l.adler>>>16),Pf(o,l.adler&65535)),Qo(l),0<o.wrap&&(o.wrap=-o.wrap),o.pending!==0?No:Ad)},deflateEnd:function(l){if(!l||!l.state)return Jo;var h=l.state.status;return h!==42&&h!==69&&h!==73&&h!==91&&h!==103&&h!==113&&h!==666?ua(l,Jo):(l.state=null,h===113?ua(l,Rf):No)},deflateSetDictionary:function(l,h){var o=h.length;if(!l||!l.state)return Jo;var a=l.state,y=a.wrap;if(y===2||y===1&&a.status!==42||a.lookahead)return Jo;if(y===1&&(l.adler=qh(l.adler,h,o,0)),a.wrap=0,o>=a.w_size){y===0&&(Gn(a.head),a.strstart=0,a.block_start=0,a.insert=0);var g=new Uint8Array(a.w_size);g.set(h.subarray(o-a.w_size,o),0),h=g,o=a.w_size}g=l.avail_in;var x=l.next_in,v=l.input;for(l.avail_in=o,l.next_in=0,l.input=h,Vl(a);3<=a.lookahead;){h=a.strstart,o=a.lookahead-2;do a.ins_h=qa(a,a.ins_h,a.window[h+3-1]),a.prev[h&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=h,h++;while(--o);a.strstart=h,a.lookahead=2,Vl(a)}return a.strstart+=a.lookahead,a.block_start=a.strstart,a.insert=a.lookahead,a.lookahead=0,a.match_length=a.prev_length=2,a.match_available=0,l.next_in=x,l.input=v,l.avail_in=g,a.wrap=y,No},deflateInfo:"pako deflate (from Nodeca project)"},Cn={assign:function(l){for(var h=Array.prototype.slice.call(arguments,1);h.length;){var o=h.shift();if(o){if((typeof o=="undefined"?"undefined":kn(o))!=="object")throw new TypeError(o+"must be non-object");for(var a in o)Object.prototype.hasOwnProperty.call(o,a)&&(l[a]=o[a])}}return l},flattenChunks:function(l){for(var h=0,o=0,a=l.length;o<a;o++)h+=l[o].length;h=new Uint8Array(h),a=o=0;for(var y=l.length;o<y;o++){var g=l[o];h.set(g,a),a+=g.length}return h}},dn=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{dn=!1}for(var Pn=new Uint8Array(256),wo=0;256>wo;wo++)Pn[wo]=252<=wo?6:248<=wo?5:240<=wo?4:224<=wo?3:192<=wo?2:1;Pn[254]=Pn[254]=1;var oo={string2buf:function(l){var h,o,a=l.length,y=0;for(h=0;h<a;h++){var g=l.charCodeAt(h);if((g&64512)===55296&&h+1<a){var x=l.charCodeAt(h+1);(x&64512)===56320&&(g=65536+(g-55296<<10)+(x-56320),h++)}y+=128>g?1:2048>g?2:65536>g?3:4}var v=new Uint8Array(y);for(h=o=0;o<y;h++)g=l.charCodeAt(h),(g&64512)===55296&&h+1<a&&(x=l.charCodeAt(h+1),(x&64512)===56320&&(g=65536+(g-55296<<10)+(x-56320),h++)),128>g?v[o++]=g:(2048>g?v[o++]=192|g>>>6:(65536>g?v[o++]=224|g>>>12:(v[o++]=240|g>>>18,v[o++]=128|g>>>12&63),v[o++]=128|g>>>6&63),v[o++]=128|g&63);return v},buf2string:function(l,h){var o,a,y=h||l.length;for(h=Array(2*y),o=a=0;o<y;){var g=l[o++];if(128>g)h[a++]=g;else{var x=Pn[g];if(4<x)h[a++]=65533,o+=x-1;else{for(g&=x===2?31:x===3?15:7;1<x&&o<y;)g=g<<6|l[o++]&63,x--;1<x?h[a++]=65533:65536>g?h[a++]=g:(g-=65536,h[a++]=55296|g>>10&1023,h[a++]=56320|g&1023)}}}if(l=a,65534>l&&h.subarray&&dn)h=String.fromCharCode.apply(null,h.length===l?h:h.subarray(0,l));else{for(o="",a=0;a<l;a++)o+=String.fromCharCode(h[a]);h=o}return h},utf8border:function(l,h){h=h||l.length,h>l.length&&(h=l.length);for(var o=h-1;0<=o&&(l[o]&192)===128;)o--;return 0>o||o===0?h:o+Pn[l[o]]>h?o:h}},Wl=function(){this.input=null,this.total_in=this.avail_in=this.next_in=0,this.output=null,this.total_out=this.avail_out=this.next_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0},Df=Object.prototype.toString,L1=br.Z_NO_FLUSH,Of=br.Z_SYNC_FLUSH,CA=br.Z_FULL_FLUSH,Ko=br.Z_FINISH,Ns=br.Z_OK,la=br.Z_STREAM_END,TA=br.Z_DEFAULT_COMPRESSION,zi=br.Z_DEFAULT_STRATEGY,po=br.Z_DEFLATED;vl.prototype.push=function(l,h){var o=this.strm,a=this.options.chunkSize;if(this.ended)return!1;for(h=h===~~h?h:h===!0?Ko:L1,typeof l=="string"?o.input=oo.string2buf(l):Df.call(l)==="[object ArrayBuffer]"?o.input=new Uint8Array(l):o.input=l,o.next_in=0,o.avail_in=o.input.length;;)if(o.avail_out===0&&(o.output=new Uint8Array(a),o.next_out=0,o.avail_out=a),(h===Of||h===CA)&&6>=o.avail_out)this.onData(o.output.subarray(0,o.next_out)),o.avail_out=0;else{if(l=zs.deflate(o,h),l===la)return 0<o.next_out&&this.onData(o.output.subarray(0,o.next_out)),l=zs.deflateEnd(this.strm),this.onEnd(l),this.ended=!0,l===Ns;if(o.avail_out===0)this.onData(o.output);else if(0<h&&0<o.next_out)this.onData(o.output.subarray(0,o.next_out)),o.avail_out=0;else if(o.avail_in===0)break}return!0},vl.prototype.onData=function(l){this.chunks.push(l)},vl.prototype.onEnd=function(l){l===Ns&&(this.result=Cn.flattenChunks(this.chunks)),this.chunks=[],this.err=l,this.msg=this.strm.msg};var er=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),SA=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),jl=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),Fg=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),ds=function(l,h,o,a,y,g,x,v){var M=v.bits,D,U,C,L,B,O,k=0,j=new Uint16Array(16),V=new Uint16Array(16),Y,Q=0;for(D=0;15>=D;D++)j[D]=0;for(U=0;U<a;U++)j[h[o+U]]++;var nt=M;for(C=15;1<=C&&j[C]===0;C--);if(nt>C&&(nt=C),C===0)return y[g++]=20971520,y[g++]=20971520,v.bits=1,0;for(M=1;M<C&&j[M]===0;M++);for(nt<M&&(nt=M),D=L=1;15>=D;D++)if(L<<=1,L-=j[D],0>L)return-1;if(0<L&&(l===0||C!==1))return-1;for(V[1]=0,D=1;15>D;D++)V[D+1]=V[D]+j[D];for(U=0;U<a;U++)h[o+U]!==0&&(x[V[h[o+U]]++]=U);if(l===0)var ut=Y=x,ct=19;else l===1?(ut=er,k-=257,Y=SA,Q-=257,ct=256):(ut=jl,Y=Fg,ct=-1);U=B=0,D=M;var Tt=g;a=nt,V=0;var Lt=-1,Dt=1<<nt,ae=Dt-1;if(l===1&&852<Dt||l===2&&592<Dt)return 1;for(;;){var ne=D-V;if(x[U]<ct)var we=0,xe=x[U];else x[U]>ct?(we=Y[Q+x[U]],xe=ut[k+x[U]]):(we=96,xe=0);L=1<<D-V,M=O=1<<a;do O-=L,y[Tt+(B>>V)+O]=ne<<24|we<<16|xe|0;while(O!==0);for(L=1<<D-1;B&L;)L>>=1;if(L!==0?(B&=L-1,B+=L):B=0,U++,--j[D]===0){if(D===C)break;D=h[o+x[U]]}if(D>nt&&(B&ae)!==Lt){for(V===0&&(V=nt),Tt+=M,a=D-V,L=1<<a;a+V<C&&(L-=j[a+V],!(0>=L));)a++,L<<=1;if(Dt+=1<<a,l===1&&852<Dt||l===2&&592<Dt)return 1;Lt=B&ae,y[Lt]=nt<<24|a<<16|Tt-g|0}}return B!==0&&(y[Tt+B]=D-V<<24|4194304),v.bits=nt,0},Us=br.Z_FINISH,IA=br.Z_BLOCK,wd=br.Z_TREES,Ja=br.Z_OK,EA=br.Z_STREAM_END,Md=br.Z_NEED_DICT,ms=br.Z_STREAM_ERROR,R1=br.Z_DATA_ERROR,Ff=br.Z_MEM_ERROR,LA=br.Z_BUF_ERROR,P1=br.Z_DEFLATED,Bf=function(l){return(l>>>24&255)+(l>>>8&65280)+((l&65280)<<8)+((l&255)<<24)},Bg=function(l){if(!l||!l.state)return ms;var h=l.state;return l.total_in=l.total_out=h.total=0,l.msg="",h.wrap&&(l.adler=h.wrap&1),h.mode=1,h.last=0,h.havedict=0,h.dmax=32768,h.head=null,h.hold=0,h.bits=0,h.lencode=h.lendyn=new Int32Array(852),h.distcode=h.distdyn=new Int32Array(592),h.sane=1,h.back=-1,Ja},Cd=function(l){if(!l||!l.state)return ms;var h=l.state;return h.wsize=0,h.whave=0,h.wnext=0,Bg(l)},D1=function(l,h){if(!l||!l.state)return ms;var o=l.state;if(0>h){var a=0;h=-h}else a=(h>>4)+1,48>h&&(h&=15);return h&&(8>h||15<h)?ms:(o.window!==null&&o.wbits!==h&&(o.window=null),o.wrap=a,o.wbits=h,Cd(l))},O1=function(l,h){if(!l)return ms;var o=new sg;return l.state=o,o.window=null,h=D1(l,h),h!==Ja&&(l.state=null),h},zg=!0,Kh=void 0,ku=void 0,Ng=function(l,h,o,a){var y=l.state;return y.window===null&&(y.wsize=1<<y.wbits,y.wnext=0,y.whave=0,y.window=new Uint8Array(y.wsize)),a>=y.wsize?(y.window.set(h.subarray(o-y.wsize,o),0),y.wnext=0,y.whave=y.wsize):(l=y.wsize-y.wnext,l>a&&(l=a),y.window.set(h.subarray(o-a,o-a+l),y.wnext),(a-=l)?(y.window.set(h.subarray(o-a,o),0),y.wnext=a,y.whave=y.wsize):(y.wnext+=l,y.wnext===y.wsize&&(y.wnext=0),y.whave<y.wsize&&(y.whave+=l))),0},ha={inflateReset:Cd,inflateReset2:D1,inflateResetKeep:Bg,inflateInit:function(l){return O1(l,15)},inflateInit2:O1,inflate:function(l,h){var o=new Uint8Array(4),a=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(!l||!l.state||!l.output||!l.input&&l.avail_in!==0)return ms;var y=l.state;y.mode===12&&(y.mode=13);var g=l.next_out,x=l.output,v=l.avail_out,M=l.next_in,D=l.input,U=l.avail_in,C=y.hold,L=y.bits,B=U,O=v,k=Ja;t:for(;;)switch(y.mode){case 1:if(y.wrap===0){y.mode=13;break}for(;16>L;){if(U===0)break t;U--,C+=D[M++]<<L,L+=8}if(y.wrap&2&&C===35615){y.check=0,o[0]=C&255,o[1]=C>>>8&255,y.check=Hn(y.check,o,2,0),L=C=0,y.mode=2;break}if(y.flags=0,y.head&&(y.head.done=!1),!(y.wrap&1)||(((C&255)<<8)+(C>>8))%31){l.msg="incorrect header check",y.mode=30;break}if((C&15)!==P1){l.msg="unknown compression method",y.mode=30;break}C>>>=4,L-=4;var j=(C&15)+8;if(y.wbits===0)y.wbits=j;else if(j>y.wbits){l.msg="invalid window size",y.mode=30;break}y.dmax=1<<y.wbits,l.adler=y.check=1,y.mode=C&512?10:12,L=C=0;break;case 2:for(;16>L;){if(U===0)break t;U--,C+=D[M++]<<L,L+=8}if(y.flags=C,(y.flags&255)!==P1){l.msg="unknown compression method",y.mode=30;break}if(y.flags&57344){l.msg="unknown header flags set",y.mode=30;break}y.head&&(y.head.text=C>>8&1),y.flags&512&&(o[0]=C&255,o[1]=C>>>8&255,y.check=Hn(y.check,o,2,0)),L=C=0,y.mode=3;case 3:for(;32>L;){if(U===0)break t;U--,C+=D[M++]<<L,L+=8}y.head&&(y.head.time=C),y.flags&512&&(o[0]=C&255,o[1]=C>>>8&255,o[2]=C>>>16&255,o[3]=C>>>24&255,y.check=Hn(y.check,o,4,0)),L=C=0,y.mode=4;case 4:for(;16>L;){if(U===0)break t;U--,C+=D[M++]<<L,L+=8}y.head&&(y.head.xflags=C&255,y.head.os=C>>8),y.flags&512&&(o[0]=C&255,o[1]=C>>>8&255,y.check=Hn(y.check,o,2,0)),L=C=0,y.mode=5;case 5:if(y.flags&1024){for(;16>L;){if(U===0)break t;U--,C+=D[M++]<<L,L+=8}y.length=C,y.head&&(y.head.extra_len=C),y.flags&512&&(o[0]=C&255,o[1]=C>>>8&255,y.check=Hn(y.check,o,2,0)),L=C=0}else y.head&&(y.head.extra=null);y.mode=6;case 6:if(y.flags&1024){var V=y.length;if(V>U&&(V=U),V&&(y.head&&(j=y.head.extra_len-y.length,y.head.extra||(y.head.extra=new Uint8Array(y.head.extra_len)),y.head.extra.set(D.subarray(M,M+V),j)),y.flags&512&&(y.check=Hn(y.check,D,V,M)),U-=V,M+=V,y.length-=V),y.length)break t}y.length=0,y.mode=7;case 7:if(y.flags&2048){if(U===0)break t;V=0;do j=D[M+V++],y.head&&j&&65536>y.length&&(y.head.name+=String.fromCharCode(j));while(j&&V<U);if(y.flags&512&&(y.check=Hn(y.check,D,V,M)),U-=V,M+=V,j)break t}else y.head&&(y.head.name=null);y.length=0,y.mode=8;case 8:if(y.flags&4096){if(U===0)break t;V=0;do j=D[M+V++],y.head&&j&&65536>y.length&&(y.head.comment+=String.fromCharCode(j));while(j&&V<U);if(y.flags&512&&(y.check=Hn(y.check,D,V,M)),U-=V,M+=V,j)break t}else y.head&&(y.head.comment=null);y.mode=9;case 9:if(y.flags&512){for(;16>L;){if(U===0)break t;U--,C+=D[M++]<<L,L+=8}if(C!==(y.check&65535)){l.msg="header crc mismatch",y.mode=30;break}L=C=0}y.head&&(y.head.hcrc=y.flags>>9&1,y.head.done=!0),l.adler=y.check=0,y.mode=12;break;case 10:for(;32>L;){if(U===0)break t;U--,C+=D[M++]<<L,L+=8}l.adler=y.check=Bf(C),L=C=0,y.mode=11;case 11:if(y.havedict===0)return l.next_out=g,l.avail_out=v,l.next_in=M,l.avail_in=U,y.hold=C,y.bits=L,Md;l.adler=y.check=1,y.mode=12;case 12:if(h===IA||h===wd)break t;case 13:if(y.last){C>>>=L&7,L-=L&7,y.mode=27;break}for(;3>L;){if(U===0)break t;U--,C+=D[M++]<<L,L+=8}switch(y.last=C&1,C>>>=1,--L,C&3){case 0:y.mode=14;break;case 1:if(V=y,zg){for(Kh=new Int32Array(512),ku=new Int32Array(32),j=0;144>j;)V.lens[j++]=8;for(;256>j;)V.lens[j++]=9;for(;280>j;)V.lens[j++]=7;for(;288>j;)V.lens[j++]=8;for(ds(1,V.lens,0,288,Kh,0,V.work,{bits:9}),j=0;32>j;)V.lens[j++]=5;ds(2,V.lens,0,32,ku,0,V.work,{bits:5}),zg=!1}if(V.lencode=Kh,V.lenbits=9,V.distcode=ku,V.distbits=5,y.mode=20,h===wd){C>>>=2,L-=2;break t}break;case 2:y.mode=17;break;case 3:l.msg="invalid block type",y.mode=30}C>>>=2,L-=2;break;case 14:for(C>>>=L&7,L-=L&7;32>L;){if(U===0)break t;U--,C+=D[M++]<<L,L+=8}if((C&65535)!==(C>>>16^65535)){l.msg="invalid stored block lengths",y.mode=30;break}if(y.length=C&65535,L=C=0,y.mode=15,h===wd)break t;case 15:y.mode=16;case 16:if(V=y.length){if(V>U&&(V=U),V>v&&(V=v),V===0)break t;x.set(D.subarray(M,M+V),g),U-=V,M+=V,v-=V,g+=V,y.length-=V;break}y.mode=12;break;case 17:for(;14>L;){if(U===0)break t;U--,C+=D[M++]<<L,L+=8}if(y.nlen=(C&31)+257,C>>>=5,L-=5,y.ndist=(C&31)+1,C>>>=5,L-=5,y.ncode=(C&15)+4,C>>>=4,L-=4,286<y.nlen||30<y.ndist){l.msg="too many length or distance symbols",y.mode=30;break}y.have=0,y.mode=18;case 18:for(;y.have<y.ncode;){for(;3>L;){if(U===0)break t;U--,C+=D[M++]<<L,L+=8}y.lens[a[y.have++]]=C&7,C>>>=3,L-=3}for(;19>y.have;)y.lens[a[y.have++]]=0;if(y.lencode=y.lendyn,y.lenbits=7,V={bits:y.lenbits},k=ds(0,y.lens,0,19,y.lencode,0,y.work,V),y.lenbits=V.bits,k){l.msg="invalid code lengths set",y.mode=30;break}y.have=0,y.mode=19;case 19:for(;y.have<y.nlen+y.ndist;){for(;;){var Y=y.lencode[C&(1<<y.lenbits)-1];if(V=Y>>>24,Y&=65535,V<=L)break;if(U===0)break t;U--,C+=D[M++]<<L,L+=8}if(16>Y)C>>>=V,L-=V,y.lens[y.have++]=Y;else{if(Y===16){for(j=V+2;L<j;){if(U===0)break t;U--,C+=D[M++]<<L,L+=8}if(C>>>=V,L-=V,y.have===0){l.msg="invalid bit length repeat",y.mode=30;break}j=y.lens[y.have-1],V=3+(C&3),C>>>=2,L-=2}else if(Y===17){for(j=V+3;L<j;){if(U===0)break t;U--,C+=D[M++]<<L,L+=8}C>>>=V,L-=V,j=0,V=3+(C&7),C>>>=3,L-=3}else{for(j=V+7;L<j;){if(U===0)break t;U--,C+=D[M++]<<L,L+=8}C>>>=V,L-=V,j=0,V=11+(C&127),C>>>=7,L-=7}if(y.have+V>y.nlen+y.ndist){l.msg="invalid bit length repeat",y.mode=30;break}for(;V--;)y.lens[y.have++]=j}}if(y.mode===30)break;if(y.lens[256]===0){l.msg="invalid code -- missing end-of-block",y.mode=30;break}if(y.lenbits=9,V={bits:y.lenbits},k=ds(1,y.lens,0,y.nlen,y.lencode,0,y.work,V),y.lenbits=V.bits,k){l.msg="invalid literal/lengths set",y.mode=30;break}if(y.distbits=6,y.distcode=y.distdyn,V={bits:y.distbits},k=ds(2,y.lens,y.nlen,y.ndist,y.distcode,0,y.work,V),y.distbits=V.bits,k){l.msg="invalid distances set",y.mode=30;break}if(y.mode=20,h===wd)break t;case 20:y.mode=21;case 21:if(6<=U&&258<=v){l.next_out=g,l.avail_out=v,l.next_in=M,l.avail_in=U,y.hold=C,y.bits=L,D=l;var Q=D.state;x=D.next_in;var nt=D.input;M=x+(D.avail_in-5),g=D.next_out;var ut=D.output;U=g-(O-D.avail_out),v=g+(D.avail_out-257),C=Q.dmax,L=Q.wsize,V=Q.whave,j=Q.wnext;var ct=Q.window,Tt=Q.hold,Lt=Q.bits;Y=Q.lencode;var Dt=Q.distcode,ae=(1<<Q.lenbits)-1,ne=(1<<Q.distbits)-1;e:do{15>Lt&&(Tt+=nt[x++]<<Lt,Lt+=8,Tt+=nt[x++]<<Lt,Lt+=8);var we=Y[Tt&ae];r:for(;;){var xe=we>>>24;if(Tt>>>=xe,Lt-=xe,xe=we>>>16&255,xe===0)ut[g++]=we&65535;else if(xe&16){var Ye=we&65535;(xe&=15)&&(Lt<xe&&(Tt+=nt[x++]<<Lt,Lt+=8),Ye+=Tt&(1<<xe)-1,Tt>>>=xe,Lt-=xe),15>Lt&&(Tt+=nt[x++]<<Lt,Lt+=8,Tt+=nt[x++]<<Lt,Lt+=8),we=Dt[Tt&ne];i:for(;;){if(xe=we>>>24,Tt>>>=xe,Lt-=xe,xe=we>>>16&255,xe&16){if(we&=65535,xe&=15,Lt<xe&&(Tt+=nt[x++]<<Lt,Lt+=8,Lt<xe&&(Tt+=nt[x++]<<Lt,Lt+=8)),we+=Tt&(1<<xe)-1,we>C){D.msg="invalid distance too far back",Q.mode=30;break e}if(Tt>>>=xe,Lt-=xe,xe=g-U,we>xe){if(xe=we-xe,xe>V&&Q.sane){D.msg="invalid distance too far back",Q.mode=30;break e}var mr=0,ee=ct;if(j===0){if(mr+=L-xe,xe<Ye){Ye-=xe;do ut[g++]=ct[mr++];while(--xe);mr=g-we,ee=ut}}else if(j<xe){if(mr+=L+j-xe,xe-=j,xe<Ye){Ye-=xe;do ut[g++]=ct[mr++];while(--xe);if(mr=0,j<Ye){xe=j,Ye-=xe;do ut[g++]=ct[mr++];while(--xe);mr=g-we,ee=ut}}}else if(mr+=j-xe,xe<Ye){Ye-=xe;do ut[g++]=ct[mr++];while(--xe);mr=g-we,ee=ut}for(;2<Ye;)ut[g++]=ee[mr++],ut[g++]=ee[mr++],ut[g++]=ee[mr++],Ye-=3;Ye&&(ut[g++]=ee[mr++],1<Ye&&(ut[g++]=ee[mr++]))}else{mr=g-we;do ut[g++]=ut[mr++],ut[g++]=ut[mr++],ut[g++]=ut[mr++],Ye-=3;while(2<Ye);Ye&&(ut[g++]=ut[mr++],1<Ye&&(ut[g++]=ut[mr++]))}}else if((xe&64)===0){we=Dt[(we&65535)+(Tt&(1<<xe)-1)];continue i}else{D.msg="invalid distance code",Q.mode=30;break e}break}}else if((xe&64)===0){we=Y[(we&65535)+(Tt&(1<<xe)-1)];continue r}else{xe&32?Q.mode=12:(D.msg="invalid literal/length code",Q.mode=30);break e}break}}while(x<M&&g<v);Ye=Lt>>3,x-=Ye,Lt-=Ye<<3,D.next_in=x,D.next_out=g,D.avail_in=x<M?5+(M-x):5-(x-M),D.avail_out=g<v?257+(v-g):257-(g-v),Q.hold=Tt&(1<<Lt)-1,Q.bits=Lt,g=l.next_out,x=l.output,v=l.avail_out,M=l.next_in,D=l.input,U=l.avail_in,C=y.hold,L=y.bits,y.mode===12&&(y.back=-1);break}for(y.back=0;Y=y.lencode[C&(1<<y.lenbits)-1],V=Y>>>24,j=Y>>>16&255,Y&=65535,!(V<=L);){if(U===0)break t;U--,C+=D[M++]<<L,L+=8}if(j&&(j&240)===0){for(ct=V,Tt=j,Lt=Y;Y=y.lencode[Lt+((C&(1<<ct+Tt)-1)>>ct)],V=Y>>>24,j=Y>>>16&255,Y&=65535,!(ct+V<=L);){if(U===0)break t;U--,C+=D[M++]<<L,L+=8}C>>>=ct,L-=ct,y.back+=ct}if(C>>>=V,L-=V,y.back+=V,y.length=Y,j===0){y.mode=26;break}if(j&32){y.back=-1,y.mode=12;break}if(j&64){l.msg="invalid literal/length code",y.mode=30;break}y.extra=j&15,y.mode=22;case 22:if(y.extra){for(j=y.extra;L<j;){if(U===0)break t;U--,C+=D[M++]<<L,L+=8}y.length+=C&(1<<y.extra)-1,C>>>=y.extra,L-=y.extra,y.back+=y.extra}y.was=y.length,y.mode=23;case 23:for(;Y=y.distcode[C&(1<<y.distbits)-1],V=Y>>>24,j=Y>>>16&255,Y&=65535,!(V<=L);){if(U===0)break t;U--,C+=D[M++]<<L,L+=8}if((j&240)===0){for(ct=V,Tt=j,Lt=Y;Y=y.distcode[Lt+((C&(1<<ct+Tt)-1)>>ct)],V=Y>>>24,j=Y>>>16&255,Y&=65535,!(ct+V<=L);){if(U===0)break t;U--,C+=D[M++]<<L,L+=8}C>>>=ct,L-=ct,y.back+=ct}if(C>>>=V,L-=V,y.back+=V,j&64){l.msg="invalid distance code",y.mode=30;break}y.offset=Y,y.extra=j&15,y.mode=24;case 24:if(y.extra){for(j=y.extra;L<j;){if(U===0)break t;U--,C+=D[M++]<<L,L+=8}y.offset+=C&(1<<y.extra)-1,C>>>=y.extra,L-=y.extra,y.back+=y.extra}if(y.offset>y.dmax){l.msg="invalid distance too far back",y.mode=30;break}y.mode=25;case 25:if(v===0)break t;if(V=O-v,y.offset>V){if(V=y.offset-V,V>y.whave&&y.sane){l.msg="invalid distance too far back",y.mode=30;break}V>y.wnext?(V-=y.wnext,j=y.wsize-V):j=y.wnext-V,V>y.length&&(V=y.length),ct=y.window}else ct=x,j=g-y.offset,V=y.length;V>v&&(V=v),v-=V,y.length-=V;do x[g++]=ct[j++];while(--V);y.length===0&&(y.mode=21);break;case 26:if(v===0)break t;x[g++]=y.length,v--,y.mode=21;break;case 27:if(y.wrap){for(;32>L;){if(U===0)break t;U--,C|=D[M++]<<L,L+=8}if(O-=v,l.total_out+=O,y.total+=O,O&&(l.adler=y.check=y.flags?Hn(y.check,x,O,g-O):qh(y.check,x,O,g-O)),O=v,(y.flags?C:Bf(C))!==y.check){l.msg="incorrect data check",y.mode=30;break}L=C=0}y.mode=28;case 28:if(y.wrap&&y.flags){for(;32>L;){if(U===0)break t;U--,C+=D[M++]<<L,L+=8}if(C!==(y.total&4294967295)){l.msg="incorrect length check",y.mode=30;break}L=C=0}y.mode=29;case 29:k=EA;break t;case 30:k=R1;break t;case 31:return Ff;default:return ms}return l.next_out=g,l.avail_out=v,l.next_in=M,l.avail_in=U,y.hold=C,y.bits=L,(y.wsize||O!==l.avail_out&&30>y.mode&&(27>y.mode||h!==Us))&&Ng(l,l.output,l.next_out,O-l.avail_out),B-=l.avail_in,O-=l.avail_out,l.total_in+=B,l.total_out+=O,y.total+=O,y.wrap&&O&&(l.adler=y.check=y.flags?Hn(y.check,x,O,l.next_out-O):qh(y.check,x,O,l.next_out-O)),l.data_type=y.bits+(y.last?64:0)+(y.mode===12?128:0)+(y.mode===20||y.mode===15?256:0),(B===0&&O===0||h===Us)&&k===Ja&&(k=LA),k},inflateEnd:function(l){if(!l||!l.state)return ms;var h=l.state;return h.window&&(h.window=null),l.state=null,Ja},inflateGetHeader:function(l,h){return!l||!l.state||(l=l.state,(l.wrap&2)===0)?ms:(l.head=h,h.done=!1,Ja)},inflateSetDictionary:function(l,h){var o=h.length;if(!l||!l.state)return ms;var a=l.state;if(a.wrap!==0&&a.mode!==11)return ms;if(a.mode===11){var y=qh(1,h,o,0);if(y!==a.check)return R1}return Ng(l,h,o,o),a.havedict=1,Ja},inflateInfo:"pako inflate (from Nodeca project)"},Ug=function(){this.os=this.xflags=this.time=this.text=0,this.extra=null,this.extra_len=0,this.comment=this.name="",this.hcrc=0,this.done=!1},F1=Object.prototype.toString,bg=br.Z_NO_FLUSH,Td=br.Z_FINISH,gs=br.Z_OK,kg=br.Z_STREAM_END,Hg=br.Z_NEED_DICT,B1=br.Z_STREAM_ERROR,ft=br.Z_DATA_ERROR,Gg=br.Z_MEM_ERROR;Ra.prototype.push=function(l,h){var o=this.strm,a=this.options.chunkSize,y=this.options.dictionary;if(this.ended)return!1;var g=h===~~h?h:h===!0?Td:bg;for(F1.call(l)==="[object ArrayBuffer]"?o.input=new Uint8Array(l):o.input=l,o.next_in=0,o.avail_in=o.input.length;;){for(o.avail_out===0&&(o.output=new Uint8Array(a),o.next_out=0,o.avail_out=a),h=ha.inflate(o,g),h===Hg&&y&&(h=ha.inflateSetDictionary(o,y),h===gs?h=ha.inflate(o,g):h===ft&&(h=Hg));0<o.avail_in&&h===kg&&0<o.state.wrap&&l[o.next_in]!==0;)ha.inflateReset(o),h=ha.inflate(o,g);switch(h){case B1:case ft:case Hg:case Gg:return this.onEnd(h),this.ended=!0,!1}var x=o.avail_out;if(o.next_out&&(o.avail_out===0||h===kg))if(this.options.to==="string"){var v=oo.utf8border(o.output,o.next_out),M=o.next_out-v,D=oo.buf2string(o.output,v);o.next_out=M,o.avail_out=a-M,M&&o.output.set(o.output.subarray(v,v+M),0),this.onData(D)}else this.onData(o.output.length===o.next_out?o.output:o.output.subarray(0,o.next_out));if(h!==gs||x!==0){if(h===kg){h=ha.inflateEnd(this.strm),this.onEnd(h),this.ended=!0;break}if(o.avail_in===0)break}}return!0},Ra.prototype.onData=function(l){this.chunks.push(l)},Ra.prototype.onEnd=function(l){l===gs&&(this.result=this.options.to==="string"?this.chunks.join(""):Cn.flattenChunks(this.chunks)),this.chunks=[],this.err=l,this.msg=this.strm.msg};var zf={Deflate:vl,deflate:Yc,deflateRaw:function(l,h){return h=h||{},h.raw=!0,Yc(l,h)},gzip:function(l,h){return h=h||{},h.gzip=!0,Yc(l,h)},Inflate:Ra,inflate:Zc,inflateRaw:function(l,h){return h=h||{},h.raw=!0,Zc(l,h)},ungzip:Zc,constants:br},Uo=ht(function(l,h){Object.defineProperty(h,"__esModule",{value:!0}),h.setMatrixArrayType=function(g){h.ARRAY_TYPE=a=g},h.toRadian=function(g){return g*y},h.equals=function(g,x){return Math.abs(g-x)<=o*Math.max(1,Math.abs(g),Math.abs(x))},h.RANDOM=h.ARRAY_TYPE=h.EPSILON=void 0;var o=1e-6;h.EPSILON=o;var a=typeof Float32Array!="undefined"?Float32Array:Array;h.ARRAY_TYPE=a,h.RANDOM=Math.random;var y=Math.PI/180});ot(Uo);var Vg=ht(function(l,h){function o(g,x,v){var M=x[0],D=x[1],U=x[2];x=x[3];var C=v[0],L=v[1],B=v[2];return v=v[3],g[0]=M*C+U*L,g[1]=D*C+x*L,g[2]=M*B+U*v,g[3]=D*B+x*v,g}function a(g,x,v){return g[0]=x[0]-v[0],g[1]=x[1]-v[1],g[2]=x[2]-v[2],g[3]=x[3]-v[3],g}Object.defineProperty(h,"__esModule",{value:!0}),h.create=function(){var g=new y.ARRAY_TYPE(4);return y.ARRAY_TYPE!=Float32Array&&(g[1]=0,g[2]=0),g[0]=1,g[3]=1,g},h.clone=function(g){var x=new y.ARRAY_TYPE(4);return x[0]=g[0],x[1]=g[1],x[2]=g[2],x[3]=g[3],x},h.copy=function(g,x){return g[0]=x[0],g[1]=x[1],g[2]=x[2],g[3]=x[3],g},h.identity=function(g){return g[0]=1,g[1]=0,g[2]=0,g[3]=1,g},h.fromValues=function(g,x,v,M){var D=new y.ARRAY_TYPE(4);return D[0]=g,D[1]=x,D[2]=v,D[3]=M,D},h.set=function(g,x,v,M,D){return g[0]=x,g[1]=v,g[2]=M,g[3]=D,g},h.transpose=function(g,x){if(g===x){var v=x[1];g[1]=x[2],g[2]=v}else g[0]=x[0],g[1]=x[2],g[2]=x[1],g[3]=x[3];return g},h.invert=function(g,x){var v=x[0],M=x[1],D=x[2];x=x[3];var U=v*x-D*M;return U?(U=1/U,g[0]=x*U,g[1]=-M*U,g[2]=-D*U,g[3]=v*U,g):null},h.adjoint=function(g,x){var v=x[0];return g[0]=x[3],g[1]=-x[1],g[2]=-x[2],g[3]=v,g},h.determinant=function(g){return g[0]*g[3]-g[2]*g[1]},h.multiply=o,h.rotate=function(g,x,v){var M=x[0],D=x[1],U=x[2];x=x[3];var C=Math.sin(v);return v=Math.cos(v),g[0]=M*v+U*C,g[1]=D*v+x*C,g[2]=M*-C+U*v,g[3]=D*-C+x*v,g},h.scale=function(g,x,v){var M=x[1],D=x[2],U=x[3],C=v[0];return v=v[1],g[0]=x[0]*C,g[1]=M*C,g[2]=D*v,g[3]=U*v,g},h.fromRotation=function(g,x){var v=Math.sin(x);return x=Math.cos(x),g[0]=x,g[1]=v,g[2]=-v,g[3]=x,g},h.fromScaling=function(g,x){return g[0]=x[0],g[1]=0,g[2]=0,g[3]=x[1],g},h.str=function(g){return"mat2("+g[0]+", "+g[1]+", "+g[2]+", "+g[3]+")"},h.frob=function(g){return Math.sqrt(Math.pow(g[0],2)+Math.pow(g[1],2)+Math.pow(g[2],2)+Math.pow(g[3],2))},h.LDU=function(g,x,v,M){return g[2]=M[2]/M[0],v[0]=M[0],v[1]=M[1],v[3]=M[3]-g[2]*v[1],[g,x,v]},h.add=function(g,x,v){return g[0]=x[0]+v[0],g[1]=x[1]+v[1],g[2]=x[2]+v[2],g[3]=x[3]+v[3],g},h.subtract=a,h.exactEquals=function(g,x){return g[0]===x[0]&&g[1]===x[1]&&g[2]===x[2]&&g[3]===x[3]},h.equals=function(g,x){var v=g[0],M=g[1],D=g[2];g=g[3];var U=x[0],C=x[1],L=x[2];return x=x[3],Math.abs(v-U)<=y.EPSILON*Math.max(1,Math.abs(v),Math.abs(U))&&Math.abs(M-C)<=y.EPSILON*Math.max(1,Math.abs(M),Math.abs(C))&&Math.abs(D-L)<=y.EPSILON*Math.max(1,Math.abs(D),Math.abs(L))&&Math.abs(g-x)<=y.EPSILON*Math.max(1,Math.abs(g),Math.abs(x))},h.multiplyScalar=function(g,x,v){return g[0]=x[0]*v,g[1]=x[1]*v,g[2]=x[2]*v,g[3]=x[3]*v,g},h.multiplyScalarAndAdd=function(g,x,v,M){return g[0]=x[0]+v[0]*M,g[1]=x[1]+v[1]*M,g[2]=x[2]+v[2]*M,g[3]=x[3]+v[3]*M,g},h.sub=h.mul=void 0;var y=function(g){if(g&&g.__esModule)return g;var x={};if(g!=null){for(var v in g)if(Object.prototype.hasOwnProperty.call(g,v)){var M=pn&&Bi?Bi(g,v):{};M.get||M.set?pn(x,v,M):x[v]=g[v]}}return x.default=g,x}(Uo);h.mul=o,h.sub=a});ot(Vg);var z1=ht(function(l,h){function o(g,x,v){var M=x[0],D=x[1],U=x[2],C=x[3],L=x[4];x=x[5];var B=v[0],O=v[1],k=v[2],j=v[3],V=v[4];return v=v[5],g[0]=M*B+U*O,g[1]=D*B+C*O,g[2]=M*k+U*j,g[3]=D*k+C*j,g[4]=M*V+U*v+L,g[5]=D*V+C*v+x,g}function a(g,x,v){return g[0]=x[0]-v[0],g[1]=x[1]-v[1],g[2]=x[2]-v[2],g[3]=x[3]-v[3],g[4]=x[4]-v[4],g[5]=x[5]-v[5],g}Object.defineProperty(h,"__esModule",{value:!0}),h.create=function(){var g=new y.ARRAY_TYPE(6);return y.ARRAY_TYPE!=Float32Array&&(g[1]=0,g[2]=0,g[4]=0,g[5]=0),g[0]=1,g[3]=1,g},h.clone=function(g){var x=new y.ARRAY_TYPE(6);return x[0]=g[0],x[1]=g[1],x[2]=g[2],x[3]=g[3],x[4]=g[4],x[5]=g[5],x},h.copy=function(g,x){return g[0]=x[0],g[1]=x[1],g[2]=x[2],g[3]=x[3],g[4]=x[4],g[5]=x[5],g},h.identity=function(g){return g[0]=1,g[1]=0,g[2]=0,g[3]=1,g[4]=0,g[5]=0,g},h.fromValues=function(g,x,v,M,D,U){var C=new y.ARRAY_TYPE(6);return C[0]=g,C[1]=x,C[2]=v,C[3]=M,C[4]=D,C[5]=U,C},h.set=function(g,x,v,M,D,U,C){return g[0]=x,g[1]=v,g[2]=M,g[3]=D,g[4]=U,g[5]=C,g},h.invert=function(g,x){var v=x[0],M=x[1],D=x[2],U=x[3],C=x[4];x=x[5];var L=v*U-M*D;return L?(L=1/L,g[0]=U*L,g[1]=-M*L,g[2]=-D*L,g[3]=v*L,g[4]=(D*x-U*C)*L,g[5]=(M*C-v*x)*L,g):null},h.determinant=function(g){return g[0]*g[3]-g[1]*g[2]},h.multiply=o,h.rotate=function(g,x,v){var M=x[0],D=x[1],U=x[2],C=x[3],L=x[4];x=x[5];var B=Math.sin(v);return v=Math.cos(v),g[0]=M*v+U*B,g[1]=D*v+C*B,g[2]=M*-B+U*v,g[3]=D*-B+C*v,g[4]=L,g[5]=x,g},h.scale=function(g,x,v){var M=x[1],D=x[2],U=x[3],C=x[4],L=x[5],B=v[0];return v=v[1],g[0]=x[0]*B,g[1]=M*B,g[2]=D*v,g[3]=U*v,g[4]=C,g[5]=L,g},h.translate=function(g,x,v){var M=x[0],D=x[1],U=x[2],C=x[3],L=x[4];x=x[5];var B=v[0];return v=v[1],g[0]=M,g[1]=D,g[2]=U,g[3]=C,g[4]=M*B+U*v+L,g[5]=D*B+C*v+x,g},h.fromRotation=function(g,x){var v=Math.sin(x);return x=Math.cos(x),g[0]=x,g[1]=v,g[2]=-v,g[3]=x,g[4]=0,g[5]=0,g},h.fromScaling=function(g,x){return g[0]=x[0],g[1]=0,g[2]=0,g[3]=x[1],g[4]=0,g[5]=0,g},h.fromTranslation=function(g,x){return g[0]=1,g[1]=0,g[2]=0,g[3]=1,g[4]=x[0],g[5]=x[1],g},h.str=function(g){return"mat2d("+g[0]+", "+g[1]+", "+g[2]+", "+g[3]+", "+g[4]+", "+g[5]+")"},h.frob=function(g){return Math.sqrt(Math.pow(g[0],2)+Math.pow(g[1],2)+Math.pow(g[2],2)+Math.pow(g[3],2)+Math.pow(g[4],2)+Math.pow(g[5],2)+1)},h.add=function(g,x,v){return g[0]=x[0]+v[0],g[1]=x[1]+v[1],g[2]=x[2]+v[2],g[3]=x[3]+v[3],g[4]=x[4]+v[4],g[5]=x[5]+v[5],g},h.subtract=a,h.multiplyScalar=function(g,x,v){return g[0]=x[0]*v,g[1]=x[1]*v,g[2]=x[2]*v,g[3]=x[3]*v,g[4]=x[4]*v,g[5]=x[5]*v,g},h.multiplyScalarAndAdd=function(g,x,v,M){return g[0]=x[0]+v[0]*M,g[1]=x[1]+v[1]*M,g[2]=x[2]+v[2]*M,g[3]=x[3]+v[3]*M,g[4]=x[4]+v[4]*M,g[5]=x[5]+v[5]*M,g},h.exactEquals=function(g,x){return g[0]===x[0]&&g[1]===x[1]&&g[2]===x[2]&&g[3]===x[3]&&g[4]===x[4]&&g[5]===x[5]},h.equals=function(g,x){var v=g[0],M=g[1],D=g[2],U=g[3],C=g[4];g=g[5];var L=x[0],B=x[1],O=x[2],k=x[3],j=x[4];return x=x[5],Math.abs(v-L)<=y.EPSILON*Math.max(1,Math.abs(v),Math.abs(L))&&Math.abs(M-B)<=y.EPSILON*Math.max(1,Math.abs(M),Math.abs(B))&&Math.abs(D-O)<=y.EPSILON*Math.max(1,Math.abs(D),Math.abs(O))&&Math.abs(U-k)<=y.EPSILON*Math.max(1,Math.abs(U),Math.abs(k))&&Math.abs(C-j)<=y.EPSILON*Math.max(1,Math.abs(C),Math.abs(j))&&Math.abs(g-x)<=y.EPSILON*Math.max(1,Math.abs(g),Math.abs(x))},h.sub=h.mul=void 0;var y=function(g){if(g&&g.__esModule)return g;var x={};if(g!=null){for(var v in g)if(Object.prototype.hasOwnProperty.call(g,v)){var M=pn&&Bi?Bi(g,v):{};M.get||M.set?pn(x,v,M):x[v]=g[v]}}return x.default=g,x}(Uo);h.mul=o,h.sub=a});ot(z1);var Wg=ht(function(l,h){function o(g,x,v){var M=x[0],D=x[1],U=x[2],C=x[3],L=x[4],B=x[5],O=x[6],k=x[7];x=x[8];var j=v[0],V=v[1],Y=v[2],Q=v[3],nt=v[4],ut=v[5],ct=v[6],Tt=v[7];return v=v[8],g[0]=j*M+V*C+Y*O,g[1]=j*D+V*L+Y*k,g[2]=j*U+V*B+Y*x,g[3]=Q*M+nt*C+ut*O,g[4]=Q*D+nt*L+ut*k,g[5]=Q*U+nt*B+ut*x,g[6]=ct*M+Tt*C+v*O,g[7]=ct*D+Tt*L+v*k,g[8]=ct*U+Tt*B+v*x,g}function a(g,x,v){return g[0]=x[0]-v[0],g[1]=x[1]-v[1],g[2]=x[2]-v[2],g[3]=x[3]-v[3],g[4]=x[4]-v[4],g[5]=x[5]-v[5],g[6]=x[6]-v[6],g[7]=x[7]-v[7],g[8]=x[8]-v[8],g}Object.defineProperty(h,"__esModule",{value:!0}),h.create=function(){var g=new y.ARRAY_TYPE(9);return y.ARRAY_TYPE!=Float32Array&&(g[1]=0,g[2]=0,g[3]=0,g[5]=0,g[6]=0,g[7]=0),g[0]=1,g[4]=1,g[8]=1,g},h.fromMat4=function(g,x){return g[0]=x[0],g[1]=x[1],g[2]=x[2],g[3]=x[4],g[4]=x[5],g[5]=x[6],g[6]=x[8],g[7]=x[9],g[8]=x[10],g},h.clone=function(g){var x=new y.ARRAY_TYPE(9);return x[0]=g[0],x[1]=g[1],x[2]=g[2],x[3]=g[3],x[4]=g[4],x[5]=g[5],x[6]=g[6],x[7]=g[7],x[8]=g[8],x},h.copy=function(g,x){return g[0]=x[0],g[1]=x[1],g[2]=x[2],g[3]=x[3],g[4]=x[4],g[5]=x[5],g[6]=x[6],g[7]=x[7],g[8]=x[8],g},h.fromValues=function(g,x,v,M,D,U,C,L,B){var O=new y.ARRAY_TYPE(9);return O[0]=g,O[1]=x,O[2]=v,O[3]=M,O[4]=D,O[5]=U,O[6]=C,O[7]=L,O[8]=B,O},h.set=function(g,x,v,M,D,U,C,L,B,O){return g[0]=x,g[1]=v,g[2]=M,g[3]=D,g[4]=U,g[5]=C,g[6]=L,g[7]=B,g[8]=O,g},h.identity=function(g){return g[0]=1,g[1]=0,g[2]=0,g[3]=0,g[4]=1,g[5]=0,g[6]=0,g[7]=0,g[8]=1,g},h.transpose=function(g,x){if(g===x){var v=x[1],M=x[2],D=x[5];g[1]=x[3],g[2]=x[6],g[3]=v,g[5]=x[7],g[6]=M,g[7]=D}else g[0]=x[0],g[1]=x[3],g[2]=x[6],g[3]=x[1],g[4]=x[4],g[5]=x[7],g[6]=x[2],g[7]=x[5],g[8]=x[8];return g},h.invert=function(g,x){var v=x[0],M=x[1],D=x[2],U=x[3],C=x[4],L=x[5],B=x[6],O=x[7];x=x[8];var k=x*C-L*O,j=-x*U+L*B,V=O*U-C*B,Y=v*k+M*j+D*V;return Y?(Y=1/Y,g[0]=k*Y,g[1]=(-x*M+D*O)*Y,g[2]=(L*M-D*C)*Y,g[3]=j*Y,g[4]=(x*v-D*B)*Y,g[5]=(-L*v+D*U)*Y,g[6]=V*Y,g[7]=(-O*v+M*B)*Y,g[8]=(C*v-M*U)*Y,g):null},h.adjoint=function(g,x){var v=x[0],M=x[1],D=x[2],U=x[3],C=x[4],L=x[5],B=x[6],O=x[7];return x=x[8],g[0]=C*x-L*O,g[1]=D*O-M*x,g[2]=M*L-D*C,g[3]=L*B-U*x,g[4]=v*x-D*B,g[5]=D*U-v*L,g[6]=U*O-C*B,g[7]=M*B-v*O,g[8]=v*C-M*U,g},h.determinant=function(g){var x=g[3],v=g[4],M=g[5],D=g[6],U=g[7],C=g[8];return g[0]*(C*v-M*U)+g[1]*(-C*x+M*D)+g[2]*(U*x-v*D)},h.multiply=o,h.translate=function(g,x,v){var M=x[0],D=x[1],U=x[2],C=x[3],L=x[4],B=x[5],O=x[6],k=x[7];x=x[8];var j=v[0];return v=v[1],g[0]=M,g[1]=D,g[2]=U,g[3]=C,g[4]=L,g[5]=B,g[6]=j*M+v*C+O,g[7]=j*D+v*L+k,g[8]=j*U+v*B+x,g},h.rotate=function(g,x,v){var M=x[0],D=x[1],U=x[2],C=x[3],L=x[4],B=x[5],O=x[6],k=x[7];x=x[8];var j=Math.sin(v);return v=Math.cos(v),g[0]=v*M+j*C,g[1]=v*D+j*L,g[2]=v*U+j*B,g[3]=v*C-j*M,g[4]=v*L-j*D,g[5]=v*B-j*U,g[6]=O,g[7]=k,g[8]=x,g},h.scale=function(g,x,v){var M=v[0];return v=v[1],g[0]=M*x[0],g[1]=M*x[1],g[2]=M*x[2],g[3]=v*x[3],g[4]=v*x[4],g[5]=v*x[5],g[6]=x[6],g[7]=x[7],g[8]=x[8],g},h.fromTranslation=function(g,x){return g[0]=1,g[1]=0,g[2]=0,g[3]=0,g[4]=1,g[5]=0,g[6]=x[0],g[7]=x[1],g[8]=1,g},h.fromRotation=function(g,x){var v=Math.sin(x);return x=Math.cos(x),g[0]=x,g[1]=v,g[2]=0,g[3]=-v,g[4]=x,g[5]=0,g[6]=0,g[7]=0,g[8]=1,g},h.fromScaling=function(g,x){return g[0]=x[0],g[1]=0,g[2]=0,g[3]=0,g[4]=x[1],g[5]=0,g[6]=0,g[7]=0,g[8]=1,g},h.fromMat2d=function(g,x){return g[0]=x[0],g[1]=x[1],g[2]=0,g[3]=x[2],g[4]=x[3],g[5]=0,g[6]=x[4],g[7]=x[5],g[8]=1,g},h.fromQuat=function(g,x){var v=x[0],M=x[1],D=x[2];x=x[3];var U=v+v,C=M+M,L=D+D;v*=U;var B=M*U;M*=C;var O=D*U,k=D*C;return D*=L,U*=x,C*=x,x*=L,g[0]=1-M-D,g[3]=B-x,g[6]=O+C,g[1]=B+x,g[4]=1-v-D,g[7]=k-U,g[2]=O-C,g[5]=k+U,g[8]=1-v-M,g},h.normalFromMat4=function(g,x){var v=x[0],M=x[1],D=x[2],U=x[3],C=x[4],L=x[5],B=x[6],O=x[7],k=x[8],j=x[9],V=x[10],Y=x[11],Q=x[12],nt=x[13],ut=x[14];x=x[15];var ct=v*L-M*C,Tt=v*B-D*C,Lt=v*O-U*C,Dt=M*B-D*L,ae=M*O-U*L,ne=D*O-U*B,we=k*nt-j*Q,xe=k*ut-V*Q;k=k*x-Y*Q;var Ye=j*ut-V*nt;return j=j*x-Y*nt,V=V*x-Y*ut,Y=ct*V-Tt*j+Lt*Ye+Dt*k-ae*xe+ne*we,Y?(Y=1/Y,g[0]=(L*V-B*j+O*Ye)*Y,g[1]=(B*k-C*V-O*xe)*Y,g[2]=(C*j-L*k+O*we)*Y,g[3]=(D*j-M*V-U*Ye)*Y,g[4]=(v*V-D*k+U*xe)*Y,g[5]=(M*k-v*j-U*we)*Y,g[6]=(nt*ne-ut*ae+x*Dt)*Y,g[7]=(ut*Lt-Q*ne-x*Tt)*Y,g[8]=(Q*ae-nt*Lt+x*ct)*Y,g):null},h.projection=function(g,x,v){return g[0]=2/x,g[1]=0,g[2]=0,g[3]=0,g[4]=-2/v,g[5]=0,g[6]=-1,g[7]=1,g[8]=1,g},h.str=function(g){return"mat3("+g[0]+", "+g[1]+", "+g[2]+", "+g[3]+", "+g[4]+", "+g[5]+", "+g[6]+", "+g[7]+", "+g[8]+")"},h.frob=function(g){return Math.sqrt(Math.pow(g[0],2)+Math.pow(g[1],2)+Math.pow(g[2],2)+Math.pow(g[3],2)+Math.pow(g[4],2)+Math.pow(g[5],2)+Math.pow(g[6],2)+Math.pow(g[7],2)+Math.pow(g[8],2))},h.add=function(g,x,v){return g[0]=x[0]+v[0],g[1]=x[1]+v[1],g[2]=x[2]+v[2],g[3]=x[3]+v[3],g[4]=x[4]+v[4],g[5]=x[5]+v[5],g[6]=x[6]+v[6],g[7]=x[7]+v[7],g[8]=x[8]+v[8],g},h.subtract=a,h.multiplyScalar=function(g,x,v){return g[0]=x[0]*v,g[1]=x[1]*v,g[2]=x[2]*v,g[3]=x[3]*v,g[4]=x[4]*v,g[5]=x[5]*v,g[6]=x[6]*v,g[7]=x[7]*v,g[8]=x[8]*v,g},h.multiplyScalarAndAdd=function(g,x,v,M){return g[0]=x[0]+v[0]*M,g[1]=x[1]+v[1]*M,g[2]=x[2]+v[2]*M,g[3]=x[3]+v[3]*M,g[4]=x[4]+v[4]*M,g[5]=x[5]+v[5]*M,g[6]=x[6]+v[6]*M,g[7]=x[7]+v[7]*M,g[8]=x[8]+v[8]*M,g},h.exactEquals=function(g,x){return g[0]===x[0]&&g[1]===x[1]&&g[2]===x[2]&&g[3]===x[3]&&g[4]===x[4]&&g[5]===x[5]&&g[6]===x[6]&&g[7]===x[7]&&g[8]===x[8]},h.equals=function(g,x){var v=g[0],M=g[1],D=g[2],U=g[3],C=g[4],L=g[5],B=g[6],O=g[7];g=g[8];var k=x[0],j=x[1],V=x[2],Y=x[3],Q=x[4],nt=x[5],ut=x[6],ct=x[7];return x=x[8],Math.abs(v-k)<=y.EPSILON*Math.max(1,Math.abs(v),Math.abs(k))&&Math.abs(M-j)<=y.EPSILON*Math.max(1,Math.abs(M),Math.abs(j))&&Math.abs(D-V)<=y.EPSILON*Math.max(1,Math.abs(D),Math.abs(V))&&Math.abs(U-Y)<=y.EPSILON*Math.max(1,Math.abs(U),Math.abs(Y))&&Math.abs(C-Q)<=y.EPSILON*Math.max(1,Math.abs(C),Math.abs(Q))&&Math.abs(L-nt)<=y.EPSILON*Math.max(1,Math.abs(L),Math.abs(nt))&&Math.abs(B-ut)<=y.EPSILON*Math.max(1,Math.abs(B),Math.abs(ut))&&Math.abs(O-ct)<=y.EPSILON*Math.max(1,Math.abs(O),Math.abs(ct))&&Math.abs(g-x)<=y.EPSILON*Math.max(1,Math.abs(g),Math.abs(x))},h.sub=h.mul=void 0;var y=function(g){if(g&&g.__esModule)return g;var x={};if(g!=null){for(var v in g)if(Object.prototype.hasOwnProperty.call(g,v)){var M=pn&&Bi?Bi(g,v):{};M.get||M.set?pn(x,v,M):x[v]=g[v]}}return x.default=g,x}(Uo);h.mul=o,h.sub=a});ot(Wg);var pt=ht(function(l,h){function o(v){return v[0]=1,v[1]=0,v[2]=0,v[3]=0,v[4]=0,v[5]=1,v[6]=0,v[7]=0,v[8]=0,v[9]=0,v[10]=1,v[11]=0,v[12]=0,v[13]=0,v[14]=0,v[15]=1,v}function a(v,M,D){var U=M[0],C=M[1],L=M[2],B=M[3],O=M[4],k=M[5],j=M[6],V=M[7],Y=M[8],Q=M[9],nt=M[10],ut=M[11],ct=M[12],Tt=M[13],Lt=M[14];M=M[15];var Dt=D[0],ae=D[1],ne=D[2],we=D[3];return v[0]=Dt*U+ae*O+ne*Y+we*ct,v[1]=Dt*C+ae*k+ne*Q+we*Tt,v[2]=Dt*L+ae*j+ne*nt+we*Lt,v[3]=Dt*B+ae*V+ne*ut+we*M,Dt=D[4],ae=D[5],ne=D[6],we=D[7],v[4]=Dt*U+ae*O+ne*Y+we*ct,v[5]=Dt*C+ae*k+ne*Q+we*Tt,v[6]=Dt*L+ae*j+ne*nt+we*Lt,v[7]=Dt*B+ae*V+ne*ut+we*M,Dt=D[8],ae=D[9],ne=D[10],we=D[11],v[8]=Dt*U+ae*O+ne*Y+we*ct,v[9]=Dt*C+ae*k+ne*Q+we*Tt,v[10]=Dt*L+ae*j+ne*nt+we*Lt,v[11]=Dt*B+ae*V+ne*ut+we*M,Dt=D[12],ae=D[13],ne=D[14],we=D[15],v[12]=Dt*U+ae*O+ne*Y+we*ct,v[13]=Dt*C+ae*k+ne*Q+we*Tt,v[14]=Dt*L+ae*j+ne*nt+we*Lt,v[15]=Dt*B+ae*V+ne*ut+we*M,v}function y(v,M,D){var U=M[0],C=M[1],L=M[2],B=M[3],O=U+U,k=C+C,j=L+L;M=U*O;var V=U*k;U*=j;var Y=C*k;return C*=j,L*=j,O*=B,k*=B,B*=j,v[0]=1-(Y+L),v[1]=V+B,v[2]=U-k,v[3]=0,v[4]=V-B,v[5]=1-(M+L),v[6]=C+O,v[7]=0,v[8]=U+k,v[9]=C-O,v[10]=1-(M+Y),v[11]=0,v[12]=D[0],v[13]=D[1],v[14]=D[2],v[15]=1,v}function g(v,M,D){return v[0]=M[0]-D[0],v[1]=M[1]-D[1],v[2]=M[2]-D[2],v[3]=M[3]-D[3],v[4]=M[4]-D[4],v[5]=M[5]-D[5],v[6]=M[6]-D[6],v[7]=M[7]-D[7],v[8]=M[8]-D[8],v[9]=M[9]-D[9],v[10]=M[10]-D[10],v[11]=M[11]-D[11],v[12]=M[12]-D[12],v[13]=M[13]-D[13],v[14]=M[14]-D[14],v[15]=M[15]-D[15],v}Object.defineProperty(h,"__esModule",{value:!0}),h.create=function(){var v=new x.ARRAY_TYPE(16);return x.ARRAY_TYPE!=Float32Array&&(v[1]=0,v[2]=0,v[3]=0,v[4]=0,v[6]=0,v[7]=0,v[8]=0,v[9]=0,v[11]=0,v[12]=0,v[13]=0,v[14]=0),v[0]=1,v[5]=1,v[10]=1,v[15]=1,v},h.clone=function(v){var M=new x.ARRAY_TYPE(16);return M[0]=v[0],M[1]=v[1],M[2]=v[2],M[3]=v[3],M[4]=v[4],M[5]=v[5],M[6]=v[6],M[7]=v[7],M[8]=v[8],M[9]=v[9],M[10]=v[10],M[11]=v[11],M[12]=v[12],M[13]=v[13],M[14]=v[14],M[15]=v[15],M},h.copy=function(v,M){return v[0]=M[0],v[1]=M[1],v[2]=M[2],v[3]=M[3],v[4]=M[4],v[5]=M[5],v[6]=M[6],v[7]=M[7],v[8]=M[8],v[9]=M[9],v[10]=M[10],v[11]=M[11],v[12]=M[12],v[13]=M[13],v[14]=M[14],v[15]=M[15],v},h.fromValues=function(v,M,D,U,C,L,B,O,k,j,V,Y,Q,nt,ut,ct){var Tt=new x.ARRAY_TYPE(16);return Tt[0]=v,Tt[1]=M,Tt[2]=D,Tt[3]=U,Tt[4]=C,Tt[5]=L,Tt[6]=B,Tt[7]=O,Tt[8]=k,Tt[9]=j,Tt[10]=V,Tt[11]=Y,Tt[12]=Q,Tt[13]=nt,Tt[14]=ut,Tt[15]=ct,Tt},h.set=function(v,M,D,U,C,L,B,O,k,j,V,Y,Q,nt,ut,ct,Tt){return v[0]=M,v[1]=D,v[2]=U,v[3]=C,v[4]=L,v[5]=B,v[6]=O,v[7]=k,v[8]=j,v[9]=V,v[10]=Y,v[11]=Q,v[12]=nt,v[13]=ut,v[14]=ct,v[15]=Tt,v},h.identity=o,h.transpose=function(v,M){if(v===M){var D=M[1],U=M[2],C=M[3],L=M[6],B=M[7],O=M[11];v[1]=M[4],v[2]=M[8],v[3]=M[12],v[4]=D,v[6]=M[9],v[7]=M[13],v[8]=U,v[9]=L,v[11]=M[14],v[12]=C,v[13]=B,v[14]=O}else v[0]=M[0],v[1]=M[4],v[2]=M[8],v[3]=M[12],v[4]=M[1],v[5]=M[5],v[6]=M[9],v[7]=M[13],v[8]=M[2],v[9]=M[6],v[10]=M[10],v[11]=M[14],v[12]=M[3],v[13]=M[7],v[14]=M[11],v[15]=M[15];return v},h.invert=function(v,M){var D=M[0],U=M[1],C=M[2],L=M[3],B=M[4],O=M[5],k=M[6],j=M[7],V=M[8],Y=M[9],Q=M[10],nt=M[11],ut=M[12],ct=M[13],Tt=M[14];M=M[15];var Lt=D*O-U*B,Dt=D*k-C*B,ae=D*j-L*B,ne=U*k-C*O,we=U*j-L*O,xe=C*j-L*k,Ye=V*ct-Y*ut,mr=V*Tt-Q*ut,ee=V*M-nt*ut,Re=Y*Tt-Q*ct,xr=Y*M-nt*ct,gr=Q*M-nt*Tt,Be=Lt*gr-Dt*xr+ae*Re+ne*ee-we*mr+xe*Ye;return Be?(Be=1/Be,v[0]=(O*gr-k*xr+j*Re)*Be,v[1]=(C*xr-U*gr-L*Re)*Be,v[2]=(ct*xe-Tt*we+M*ne)*Be,v[3]=(Q*we-Y*xe-nt*ne)*Be,v[4]=(k*ee-B*gr-j*mr)*Be,v[5]=(D*gr-C*ee+L*mr)*Be,v[6]=(Tt*ae-ut*xe-M*Dt)*Be,v[7]=(V*xe-Q*ae+nt*Dt)*Be,v[8]=(B*xr-O*ee+j*Ye)*Be,v[9]=(U*ee-D*xr-L*Ye)*Be,v[10]=(ut*we-ct*ae+M*Lt)*Be,v[11]=(Y*ae-V*we-nt*Lt)*Be,v[12]=(O*mr-B*Re-k*Ye)*Be,v[13]=(D*Re-U*mr+C*Ye)*Be,v[14]=(ct*Dt-ut*ne-Tt*Lt)*Be,v[15]=(V*ne-Y*Dt+Q*Lt)*Be,v):null},h.adjoint=function(v,M){var D=M[0],U=M[1],C=M[2],L=M[3],B=M[4],O=M[5],k=M[6],j=M[7],V=M[8],Y=M[9],Q=M[10],nt=M[11],ut=M[12],ct=M[13],Tt=M[14];return M=M[15],v[0]=O*(Q*M-nt*Tt)-Y*(k*M-j*Tt)+ct*(k*nt-j*Q),v[1]=-(U*(Q*M-nt*Tt)-Y*(C*M-L*Tt)+ct*(C*nt-L*Q)),v[2]=U*(k*M-j*Tt)-O*(C*M-L*Tt)+ct*(C*j-L*k),v[3]=-(U*(k*nt-j*Q)-O*(C*nt-L*Q)+Y*(C*j-L*k)),v[4]=-(B*(Q*M-nt*Tt)-V*(k*M-j*Tt)+ut*(k*nt-j*Q)),v[5]=D*(Q*M-nt*Tt)-V*(C*M-L*Tt)+ut*(C*nt-L*Q),v[6]=-(D*(k*M-j*Tt)-B*(C*M-L*Tt)+ut*(C*j-L*k)),v[7]=D*(k*nt-j*Q)-B*(C*nt-L*Q)+V*(C*j-L*k),v[8]=B*(Y*M-nt*ct)-V*(O*M-j*ct)+ut*(O*nt-j*Y),v[9]=-(D*(Y*M-nt*ct)-V*(U*M-L*ct)+ut*(U*nt-L*Y)),v[10]=D*(O*M-j*ct)-B*(U*M-L*ct)+ut*(U*j-L*O),v[11]=-(D*(O*nt-j*Y)-B*(U*nt-L*Y)+V*(U*j-L*O)),v[12]=-(B*(Y*Tt-Q*ct)-V*(O*Tt-k*ct)+ut*(O*Q-k*Y)),v[13]=D*(Y*Tt-Q*ct)-V*(U*Tt-C*ct)+ut*(U*Q-C*Y),v[14]=-(D*(O*Tt-k*ct)-B*(U*Tt-C*ct)+ut*(U*k-C*O)),v[15]=D*(O*Q-k*Y)-B*(U*Q-C*Y)+V*(U*k-C*O),v},h.determinant=function(v){var M=v[0],D=v[1],U=v[2],C=v[3],L=v[4],B=v[5],O=v[6],k=v[7],j=v[8],V=v[9],Y=v[10],Q=v[11],nt=v[12],ut=v[13],ct=v[14];return v=v[15],(M*B-D*L)*(Y*v-Q*ct)-(M*O-U*L)*(V*v-Q*ut)+(M*k-C*L)*(V*ct-Y*ut)+(D*O-U*B)*(j*v-Q*nt)-(D*k-C*B)*(j*ct-Y*nt)+(U*k-C*O)*(j*ut-V*nt)},h.multiply=a,h.translate=function(v,M,D){var U=D[0],C=D[1];if(D=D[2],M===v)v[12]=M[0]*U+M[4]*C+M[8]*D+M[12],v[13]=M[1]*U+M[5]*C+M[9]*D+M[13],v[14]=M[2]*U+M[6]*C+M[10]*D+M[14],v[15]=M[3]*U+M[7]*C+M[11]*D+M[15];else{var L=M[0],B=M[1],O=M[2],k=M[3],j=M[4],V=M[5],Y=M[6],Q=M[7],nt=M[8],ut=M[9],ct=M[10],Tt=M[11];v[0]=L,v[1]=B,v[2]=O,v[3]=k,v[4]=j,v[5]=V,v[6]=Y,v[7]=Q,v[8]=nt,v[9]=ut,v[10]=ct,v[11]=Tt,v[12]=L*U+j*C+nt*D+M[12],v[13]=B*U+V*C+ut*D+M[13],v[14]=O*U+Y*C+ct*D+M[14],v[15]=k*U+Q*C+Tt*D+M[15]}return v},h.scale=function(v,M,D){var U=D[0],C=D[1];return D=D[2],v[0]=M[0]*U,v[1]=M[1]*U,v[2]=M[2]*U,v[3]=M[3]*U,v[4]=M[4]*C,v[5]=M[5]*C,v[6]=M[6]*C,v[7]=M[7]*C,v[8]=M[8]*D,v[9]=M[9]*D,v[10]=M[10]*D,v[11]=M[11]*D,v[12]=M[12],v[13]=M[13],v[14]=M[14],v[15]=M[15],v},h.rotate=function(v,M,D,U){var C=U[0],L=U[1];U=U[2];var B=Math.sqrt(C*C+L*L+U*U);if(B<x.EPSILON)return null;B=1/B,C*=B,L*=B,U*=B;var O=Math.sin(D),k=Math.cos(D),j=1-k;D=M[0],B=M[1];var V=M[2],Y=M[3],Q=M[4],nt=M[5],ut=M[6],ct=M[7],Tt=M[8],Lt=M[9],Dt=M[10],ae=M[11],ne=C*C*j+k,we=L*C*j+U*O,xe=U*C*j-L*O,Ye=C*L*j-U*O,mr=L*L*j+k,ee=U*L*j+C*O,Re=C*U*j+L*O;return C=L*U*j-C*O,L=U*U*j+k,v[0]=D*ne+Q*we+Tt*xe,v[1]=B*ne+nt*we+Lt*xe,v[2]=V*ne+ut*we+Dt*xe,v[3]=Y*ne+ct*we+ae*xe,v[4]=D*Ye+Q*mr+Tt*ee,v[5]=B*Ye+nt*mr+Lt*ee,v[6]=V*Ye+ut*mr+Dt*ee,v[7]=Y*Ye+ct*mr+ae*ee,v[8]=D*Re+Q*C+Tt*L,v[9]=B*Re+nt*C+Lt*L,v[10]=V*Re+ut*C+Dt*L,v[11]=Y*Re+ct*C+ae*L,M!==v&&(v[12]=M[12],v[13]=M[13],v[14]=M[14],v[15]=M[15]),v},h.rotateX=function(v,M,D){var U=Math.sin(D);D=Math.cos(D);var C=M[4],L=M[5],B=M[6],O=M[7],k=M[8],j=M[9],V=M[10],Y=M[11];return M!==v&&(v[0]=M[0],v[1]=M[1],v[2]=M[2],v[3]=M[3],v[12]=M[12],v[13]=M[13],v[14]=M[14],v[15]=M[15]),v[4]=C*D+k*U,v[5]=L*D+j*U,v[6]=B*D+V*U,v[7]=O*D+Y*U,v[8]=k*D-C*U,v[9]=j*D-L*U,v[10]=V*D-B*U,v[11]=Y*D-O*U,v},h.rotateY=function(v,M,D){var U=Math.sin(D);D=Math.cos(D);var C=M[0],L=M[1],B=M[2],O=M[3],k=M[8],j=M[9],V=M[10],Y=M[11];return M!==v&&(v[4]=M[4],v[5]=M[5],v[6]=M[6],v[7]=M[7],v[12]=M[12],v[13]=M[13],v[14]=M[14],v[15]=M[15]),v[0]=C*D-k*U,v[1]=L*D-j*U,v[2]=B*D-V*U,v[3]=O*D-Y*U,v[8]=C*U+k*D,v[9]=L*U+j*D,v[10]=B*U+V*D,v[11]=O*U+Y*D,v},h.rotateZ=function(v,M,D){var U=Math.sin(D);D=Math.cos(D);var C=M[0],L=M[1],B=M[2],O=M[3],k=M[4],j=M[5],V=M[6],Y=M[7];return M!==v&&(v[8]=M[8],v[9]=M[9],v[10]=M[10],v[11]=M[11],v[12]=M[12],v[13]=M[13],v[14]=M[14],v[15]=M[15]),v[0]=C*D+k*U,v[1]=L*D+j*U,v[2]=B*D+V*U,v[3]=O*D+Y*U,v[4]=k*D-C*U,v[5]=j*D-L*U,v[6]=V*D-B*U,v[7]=Y*D-O*U,v},h.fromTranslation=function(v,M){return v[0]=1,v[1]=0,v[2]=0,v[3]=0,v[4]=0,v[5]=1,v[6]=0,v[7]=0,v[8]=0,v[9]=0,v[10]=1,v[11]=0,v[12]=M[0],v[13]=M[1],v[14]=M[2],v[15]=1,v},h.fromScaling=function(v,M){return v[0]=M[0],v[1]=0,v[2]=0,v[3]=0,v[4]=0,v[5]=M[1],v[6]=0,v[7]=0,v[8]=0,v[9]=0,v[10]=M[2],v[11]=0,v[12]=0,v[13]=0,v[14]=0,v[15]=1,v},h.fromRotation=function(v,M,D){var U=D[0],C=D[1];D=D[2];var L=Math.sqrt(U*U+C*C+D*D);if(L<x.EPSILON)return null;L=1/L,U*=L,C*=L,D*=L,L=Math.sin(M),M=Math.cos(M);var B=1-M;return v[0]=U*U*B+M,v[1]=C*U*B+D*L,v[2]=D*U*B-C*L,v[3]=0,v[4]=U*C*B-D*L,v[5]=C*C*B+M,v[6]=D*C*B+U*L,v[7]=0,v[8]=U*D*B+C*L,v[9]=C*D*B-U*L,v[10]=D*D*B+M,v[11]=0,v[12]=0,v[13]=0,v[14]=0,v[15]=1,v},h.fromXRotation=function(v,M){var D=Math.sin(M);return M=Math.cos(M),v[0]=1,v[1]=0,v[2]=0,v[3]=0,v[4]=0,v[5]=M,v[6]=D,v[7]=0,v[8]=0,v[9]=-D,v[10]=M,v[11]=0,v[12]=0,v[13]=0,v[14]=0,v[15]=1,v},h.fromYRotation=function(v,M){var D=Math.sin(M);return M=Math.cos(M),v[0]=M,v[1]=0,v[2]=-D,v[3]=0,v[4]=0,v[5]=1,v[6]=0,v[7]=0,v[8]=D,v[9]=0,v[10]=M,v[11]=0,v[12]=0,v[13]=0,v[14]=0,v[15]=1,v},h.fromZRotation=function(v,M){var D=Math.sin(M);return M=Math.cos(M),v[0]=M,v[1]=D,v[2]=0,v[3]=0,v[4]=-D,v[5]=M,v[6]=0,v[7]=0,v[8]=0,v[9]=0,v[10]=1,v[11]=0,v[12]=0,v[13]=0,v[14]=0,v[15]=1,v},h.fromRotationTranslation=y,h.fromQuat2=function(v,M){var D=new x.ARRAY_TYPE(3),U=-M[0],C=-M[1],L=-M[2],B=M[3],O=M[4],k=M[5],j=M[6],V=M[7],Y=U*U+C*C+L*L+B*B;return 0<Y?(D[0]=2*(O*B+V*U+k*L-j*C)/Y,D[1]=2*(k*B+V*C+j*U-O*L)/Y,D[2]=2*(j*B+V*L+O*C-k*U)/Y):(D[0]=2*(O*B+V*U+k*L-j*C),D[1]=2*(k*B+V*C+j*U-O*L),D[2]=2*(j*B+V*L+O*C-k*U)),y(v,M,D),v},h.getTranslation=function(v,M){return v[0]=M[12],v[1]=M[13],v[2]=M[14],v},h.getScaling=function(v,M){var D=M[0],U=M[1],C=M[2],L=M[4],B=M[5],O=M[6],k=M[8],j=M[9];return M=M[10],v[0]=Math.sqrt(D*D+U*U+C*C),v[1]=Math.sqrt(L*L+B*B+O*O),v[2]=Math.sqrt(k*k+j*j+M*M),v},h.getRotation=function(v,M){var D=M[0]+M[5]+M[10];return 0<D?(D=2*Math.sqrt(D+1),v[3]=.25*D,v[0]=(M[6]-M[9])/D,v[1]=(M[8]-M[2])/D,v[2]=(M[1]-M[4])/D):M[0]>M[5]&&M[0]>M[10]?(D=2*Math.sqrt(1+M[0]-M[5]-M[10]),v[3]=(M[6]-M[9])/D,v[0]=.25*D,v[1]=(M[1]+M[4])/D,v[2]=(M[8]+M[2])/D):M[5]>M[10]?(D=2*Math.sqrt(1+M[5]-M[0]-M[10]),v[3]=(M[8]-M[2])/D,v[0]=(M[1]+M[4])/D,v[1]=.25*D,v[2]=(M[6]+M[9])/D):(D=2*Math.sqrt(1+M[10]-M[0]-M[5]),v[3]=(M[1]-M[4])/D,v[0]=(M[8]+M[2])/D,v[1]=(M[6]+M[9])/D,v[2]=.25*D),v},h.fromRotationTranslationScale=function(v,M,D,U){var C=M[0],L=M[1],B=M[2],O=M[3],k=C+C,j=L+L,V=B+B;M=C*k;var Y=C*j;C*=V;var Q=L*j;L*=V,B*=V,k*=O,j*=O,O*=V,V=U[0];var nt=U[1];return U=U[2],v[0]=(1-(Q+B))*V,v[1]=(Y+O)*V,v[2]=(C-j)*V,v[3]=0,v[4]=(Y-O)*nt,v[5]=(1-(M+B))*nt,v[6]=(L+k)*nt,v[7]=0,v[8]=(C+j)*U,v[9]=(L-k)*U,v[10]=(1-(M+Q))*U,v[11]=0,v[12]=D[0],v[13]=D[1],v[14]=D[2],v[15]=1,v},h.fromRotationTranslationScaleOrigin=function(v,M,D,U,C){var L=M[0],B=M[1],O=M[2],k=M[3],j=L+L,V=B+B,Y=O+O;M=L*j;var Q=L*V,nt=L*Y;L=B*V,B*=Y;var ut=O*Y;O=k*j,V*=k;var ct=k*Y,Tt=U[0],Lt=U[1];Y=U[2],U=C[0],k=C[1],C=C[2],j=(1-(L+ut))*Tt;var Dt=(Q+ct)*Tt;return Tt*=nt-V,Q=(Q-ct)*Lt,ut=(1-(M+ut))*Lt,Lt*=B+O,nt=(nt+V)*Y,B=(B-O)*Y,M=(1-(M+L))*Y,v[0]=j,v[1]=Dt,v[2]=Tt,v[3]=0,v[4]=Q,v[5]=ut,v[6]=Lt,v[7]=0,v[8]=nt,v[9]=B,v[10]=M,v[11]=0,v[12]=D[0]+U-(j*U+Q*k+nt*C),v[13]=D[1]+k-(Dt*U+ut*k+B*C),v[14]=D[2]+C-(Tt*U+Lt*k+M*C),v[15]=1,v},h.fromQuat=function(v,M){var D=M[0],U=M[1],C=M[2];M=M[3];var L=D+D,B=U+U,O=C+C;D*=L;var k=U*L;U*=B;var j=C*L,V=C*B;return C*=O,L*=M,B*=M,M*=O,v[0]=1-U-C,v[1]=k+M,v[2]=j-B,v[3]=0,v[4]=k-M,v[5]=1-D-C,v[6]=V+L,v[7]=0,v[8]=j+B,v[9]=V-L,v[10]=1-D-U,v[11]=0,v[12]=0,v[13]=0,v[14]=0,v[15]=1,v},h.frustum=function(v,M,D,U,C,L,B){var O=1/(D-M),k=1/(C-U),j=1/(L-B);return v[0]=2*L*O,v[1]=0,v[2]=0,v[3]=0,v[4]=0,v[5]=2*L*k,v[6]=0,v[7]=0,v[8]=(D+M)*O,v[9]=(C+U)*k,v[10]=(B+L)*j,v[11]=-1,v[12]=0,v[13]=0,v[14]=B*L*2*j,v[15]=0,v},h.perspective=function(v,M,D,U,C){return M=1/Math.tan(M/2),v[0]=M/D,v[1]=0,v[2]=0,v[3]=0,v[4]=0,v[5]=M,v[6]=0,v[7]=0,v[8]=0,v[9]=0,v[11]=-1,v[12]=0,v[13]=0,v[15]=0,C!=null&&C!==1/0?(D=1/(U-C),v[10]=(C+U)*D,v[14]=2*C*U*D):(v[10]=-1,v[14]=-2*U),v},h.perspectiveFromFieldOfView=function(v,M,D,U){var C=Math.tan(M.upDegrees*Math.PI/180),L=Math.tan(M.downDegrees*Math.PI/180),B=Math.tan(M.leftDegrees*Math.PI/180);M=Math.tan(M.rightDegrees*Math.PI/180);var O=2/(B+M),k=2/(C+L);return v[0]=O,v[1]=0,v[2]=0,v[3]=0,v[4]=0,v[5]=k,v[6]=0,v[7]=0,v[8]=-((B-M)*O*.5),v[9]=(C-L)*k*.5,v[10]=U/(D-U),v[11]=-1,v[12]=0,v[13]=0,v[14]=U*D/(D-U),v[15]=0,v},h.ortho=function(v,M,D,U,C,L,B){var O=1/(M-D),k=1/(U-C),j=1/(L-B);return v[0]=-2*O,v[1]=0,v[2]=0,v[3]=0,v[4]=0,v[5]=-2*k,v[6]=0,v[7]=0,v[8]=0,v[9]=0,v[10]=2*j,v[11]=0,v[12]=(M+D)*O,v[13]=(C+U)*k,v[14]=(B+L)*j,v[15]=1,v},h.lookAt=function(v,M,D,U){var C=M[0],L=M[1];M=M[2];var B=U[0],O=U[1],k=U[2],j=D[0];U=D[1];var V=D[2];if(Math.abs(C-j)<x.EPSILON&&Math.abs(L-U)<x.EPSILON&&Math.abs(M-V)<x.EPSILON)return o(v);D=C-j,U=L-U,j=M-V;var Y=1/Math.sqrt(D*D+U*U+j*j);D*=Y,U*=Y,j*=Y,V=O*j-k*U,k=k*D-B*j,B=B*U-O*D,(Y=Math.sqrt(V*V+k*k+B*B))?(Y=1/Y,V*=Y,k*=Y,B*=Y):B=k=V=0,O=U*B-j*k;var Q=j*V-D*B,nt=D*k-U*V;return(Y=Math.sqrt(O*O+Q*Q+nt*nt))?(Y=1/Y,O*=Y,Q*=Y,nt*=Y):nt=Q=O=0,v[0]=V,v[1]=O,v[2]=D,v[3]=0,v[4]=k,v[5]=Q,v[6]=U,v[7]=0,v[8]=B,v[9]=nt,v[10]=j,v[11]=0,v[12]=-(V*C+k*L+B*M),v[13]=-(O*C+Q*L+nt*M),v[14]=-(D*C+U*L+j*M),v[15]=1,v},h.targetTo=function(v,M,D,U){var C=M[0],L=M[1];M=M[2];var B=U[0],O=U[1],k=U[2];U=C-D[0];var j=L-D[1];D=M-D[2];var V=U*U+j*j+D*D;0<V&&(V=1/Math.sqrt(V),U*=V,j*=V,D*=V);var Y=O*D-k*j;return k=k*U-B*D,B=B*j-O*U,V=Y*Y+k*k+B*B,0<V&&(V=1/Math.sqrt(V),Y*=V,k*=V,B*=V),v[0]=Y,v[1]=k,v[2]=B,v[3]=0,v[4]=j*B-D*k,v[5]=D*Y-U*B,v[6]=U*k-j*Y,v[7]=0,v[8]=U,v[9]=j,v[10]=D,v[11]=0,v[12]=C,v[13]=L,v[14]=M,v[15]=1,v},h.str=function(v){return"mat4("+v[0]+", "+v[1]+", "+v[2]+", "+v[3]+", "+v[4]+", "+v[5]+", "+v[6]+", "+v[7]+", "+v[8]+", "+v[9]+", "+v[10]+", "+v[11]+", "+v[12]+", "+v[13]+", "+v[14]+", "+v[15]+")"},h.frob=function(v){return Math.sqrt(Math.pow(v[0],2)+Math.pow(v[1],2)+Math.pow(v[2],2)+Math.pow(v[3],2)+Math.pow(v[4],2)+Math.pow(v[5],2)+Math.pow(v[6],2)+Math.pow(v[7],2)+Math.pow(v[8],2)+Math.pow(v[9],2)+Math.pow(v[10],2)+Math.pow(v[11],2)+Math.pow(v[12],2)+Math.pow(v[13],2)+Math.pow(v[14],2)+Math.pow(v[15],2))},h.add=function(v,M,D){return v[0]=M[0]+D[0],v[1]=M[1]+D[1],v[2]=M[2]+D[2],v[3]=M[3]+D[3],v[4]=M[4]+D[4],v[5]=M[5]+D[5],v[6]=M[6]+D[6],v[7]=M[7]+D[7],v[8]=M[8]+D[8],v[9]=M[9]+D[9],v[10]=M[10]+D[10],v[11]=M[11]+D[11],v[12]=M[12]+D[12],v[13]=M[13]+D[13],v[14]=M[14]+D[14],v[15]=M[15]+D[15],v},h.subtract=g,h.multiplyScalar=function(v,M,D){return v[0]=M[0]*D,v[1]=M[1]*D,v[2]=M[2]*D,v[3]=M[3]*D,v[4]=M[4]*D,v[5]=M[5]*D,v[6]=M[6]*D,v[7]=M[7]*D,v[8]=M[8]*D,v[9]=M[9]*D,v[10]=M[10]*D,v[11]=M[11]*D,v[12]=M[12]*D,v[13]=M[13]*D,v[14]=M[14]*D,v[15]=M[15]*D,v},h.multiplyScalarAndAdd=function(v,M,D,U){return v[0]=M[0]+D[0]*U,v[1]=M[1]+D[1]*U,v[2]=M[2]+D[2]*U,v[3]=M[3]+D[3]*U,v[4]=M[4]+D[4]*U,v[5]=M[5]+D[5]*U,v[6]=M[6]+D[6]*U,v[7]=M[7]+D[7]*U,v[8]=M[8]+D[8]*U,v[9]=M[9]+D[9]*U,v[10]=M[10]+D[10]*U,v[11]=M[11]+D[11]*U,v[12]=M[12]+D[12]*U,v[13]=M[13]+D[13]*U,v[14]=M[14]+D[14]*U,v[15]=M[15]+D[15]*U,v},h.exactEquals=function(v,M){return v[0]===M[0]&&v[1]===M[1]&&v[2]===M[2]&&v[3]===M[3]&&v[4]===M[4]&&v[5]===M[5]&&v[6]===M[6]&&v[7]===M[7]&&v[8]===M[8]&&v[9]===M[9]&&v[10]===M[10]&&v[11]===M[11]&&v[12]===M[12]&&v[13]===M[13]&&v[14]===M[14]&&v[15]===M[15]},h.equals=function(v,M){var D=v[0],U=v[1],C=v[2],L=v[3],B=v[4],O=v[5],k=v[6],j=v[7],V=v[8],Y=v[9],Q=v[10],nt=v[11],ut=v[12],ct=v[13],Tt=v[14];v=v[15];var Lt=M[0],Dt=M[1],ae=M[2],ne=M[3],we=M[4],xe=M[5],Ye=M[6],mr=M[7],ee=M[8],Re=M[9],xr=M[10],gr=M[11],Be=M[12],Mo=M[13],Ni=M[14];return M=M[15],Math.abs(D-Lt)<=x.EPSILON*Math.max(1,Math.abs(D),Math.abs(Lt))&&Math.abs(U-Dt)<=x.EPSILON*Math.max(1,Math.abs(U),Math.abs(Dt))&&Math.abs(C-ae)<=x.EPSILON*Math.max(1,Math.abs(C),Math.abs(ae))&&Math.abs(L-ne)<=x.EPSILON*Math.max(1,Math.abs(L),Math.abs(ne))&&Math.abs(B-we)<=x.EPSILON*Math.max(1,Math.abs(B),Math.abs(we))&&Math.abs(O-xe)<=x.EPSILON*Math.max(1,Math.abs(O),Math.abs(xe))&&Math.abs(k-Ye)<=x.EPSILON*Math.max(1,Math.abs(k),Math.abs(Ye))&&Math.abs(j-mr)<=x.EPSILON*Math.max(1,Math.abs(j),Math.abs(mr))&&Math.abs(V-ee)<=x.EPSILON*Math.max(1,Math.abs(V),Math.abs(ee))&&Math.abs(Y-Re)<=x.EPSILON*Math.max(1,Math.abs(Y),Math.abs(Re))&&Math.abs(Q-xr)<=x.EPSILON*Math.max(1,Math.abs(Q),Math.abs(xr))&&Math.abs(nt-gr)<=x.EPSILON*Math.max(1,Math.abs(nt),Math.abs(gr))&&Math.abs(ut-Be)<=x.EPSILON*Math.max(1,Math.abs(ut),Math.abs(Be))&&Math.abs(ct-Mo)<=x.EPSILON*Math.max(1,Math.abs(ct),Math.abs(Mo))&&Math.abs(Tt-Ni)<=x.EPSILON*Math.max(1,Math.abs(Tt),Math.abs(Ni))&&Math.abs(v-M)<=x.EPSILON*Math.max(1,Math.abs(v),Math.abs(M))},h.sub=h.mul=void 0;var x=function(v){if(v&&v.__esModule)return v;var M={};if(v!=null){for(var D in v)if(Object.prototype.hasOwnProperty.call(v,D)){var U=pn&&Bi?Bi(v,D):{};U.get||U.set?pn(M,D,U):M[D]=v[D]}}return M.default=v,M}(Uo);h.mul=a,h.sub=g});ot(pt);var jg=ht(function(l,h){function o(){var O=new B.ARRAY_TYPE(3);return B.ARRAY_TYPE!=Float32Array&&(O[0]=0,O[1]=0,O[2]=0),O}function a(O){var k=O[0],j=O[1];return O=O[2],Math.sqrt(k*k+j*j+O*O)}function y(O,k,j){var V=new B.ARRAY_TYPE(3);return V[0]=O,V[1]=k,V[2]=j,V}function g(O,k,j){return O[0]=k[0]-j[0],O[1]=k[1]-j[1],O[2]=k[2]-j[2],O}function x(O,k,j){return O[0]=k[0]*j[0],O[1]=k[1]*j[1],O[2]=k[2]*j[2],O}function v(O,k,j){return O[0]=k[0]/j[0],O[1]=k[1]/j[1],O[2]=k[2]/j[2],O}function M(O,k){var j=k[0]-O[0],V=k[1]-O[1];return O=k[2]-O[2],Math.sqrt(j*j+V*V+O*O)}function D(O,k){var j=k[0]-O[0],V=k[1]-O[1];return O=k[2]-O[2],j*j+V*V+O*O}function U(O){var k=O[0],j=O[1];return O=O[2],k*k+j*j+O*O}function C(O,k){var j=k[0],V=k[1],Y=k[2];return j=j*j+V*V+Y*Y,0<j&&(j=1/Math.sqrt(j)),O[0]=k[0]*j,O[1]=k[1]*j,O[2]=k[2]*j,O}function L(O,k){return O[0]*k[0]+O[1]*k[1]+O[2]*k[2]}Object.defineProperty(h,"__esModule",{value:!0}),h.create=o,h.clone=function(O){var k=new B.ARRAY_TYPE(3);return k[0]=O[0],k[1]=O[1],k[2]=O[2],k},h.length=a,h.fromValues=y,h.copy=function(O,k){return O[0]=k[0],O[1]=k[1],O[2]=k[2],O},h.set=function(O,k,j,V){return O[0]=k,O[1]=j,O[2]=V,O},h.add=function(O,k,j){return O[0]=k[0]+j[0],O[1]=k[1]+j[1],O[2]=k[2]+j[2],O},h.subtract=g,h.multiply=x,h.divide=v,h.ceil=function(O,k){return O[0]=Math.ceil(k[0]),O[1]=Math.ceil(k[1]),O[2]=Math.ceil(k[2]),O},h.floor=function(O,k){return O[0]=Math.floor(k[0]),O[1]=Math.floor(k[1]),O[2]=Math.floor(k[2]),O},h.min=function(O,k,j){return O[0]=Math.min(k[0],j[0]),O[1]=Math.min(k[1],j[1]),O[2]=Math.min(k[2],j[2]),O},h.max=function(O,k,j){return O[0]=Math.max(k[0],j[0]),O[1]=Math.max(k[1],j[1]),O[2]=Math.max(k[2],j[2]),O},h.round=function(O,k){return O[0]=Math.round(k[0]),O[1]=Math.round(k[1]),O[2]=Math.round(k[2]),O},h.scale=function(O,k,j){return O[0]=k[0]*j,O[1]=k[1]*j,O[2]=k[2]*j,O},h.scaleAndAdd=function(O,k,j,V){return O[0]=k[0]+j[0]*V,O[1]=k[1]+j[1]*V,O[2]=k[2]+j[2]*V,O},h.distance=M,h.squaredDistance=D,h.squaredLength=U,h.negate=function(O,k){return O[0]=-k[0],O[1]=-k[1],O[2]=-k[2],O},h.inverse=function(O,k){return O[0]=1/k[0],O[1]=1/k[1],O[2]=1/k[2],O},h.normalize=C,h.dot=L,h.cross=function(O,k,j){var V=k[0],Y=k[1];k=k[2];var Q=j[0],nt=j[1];return j=j[2],O[0]=Y*j-k*nt,O[1]=k*Q-V*j,O[2]=V*nt-Y*Q,O},h.lerp=function(O,k,j,V){var Y=k[0],Q=k[1];return k=k[2],O[0]=Y+V*(j[0]-Y),O[1]=Q+V*(j[1]-Q),O[2]=k+V*(j[2]-k),O},h.hermite=function(O,k,j,V,Y,Q){var nt=Q*Q,ut=nt*(2*Q-3)+1,ct=nt*(Q-2)+Q,Tt=nt*(Q-1);return Q=nt*(3-2*Q),O[0]=k[0]*ut+j[0]*ct+V[0]*Tt+Y[0]*Q,O[1]=k[1]*ut+j[1]*ct+V[1]*Tt+Y[1]*Q,O[2]=k[2]*ut+j[2]*ct+V[2]*Tt+Y[2]*Q,O},h.bezier=function(O,k,j,V,Y,Q){var nt=1-Q,ut=nt*nt,ct=Q*Q,Tt=ut*nt;return ut*=3*Q,nt*=3*ct,Q*=ct,O[0]=k[0]*Tt+j[0]*ut+V[0]*nt+Y[0]*Q,O[1]=k[1]*Tt+j[1]*ut+V[1]*nt+Y[1]*Q,O[2]=k[2]*Tt+j[2]*ut+V[2]*nt+Y[2]*Q,O},h.random=function(O,k){k=k||1;var j=2*B.RANDOM()*Math.PI,V=2*B.RANDOM()-1,Y=Math.sqrt(1-V*V)*k;return O[0]=Math.cos(j)*Y,O[1]=Math.sin(j)*Y,O[2]=V*k,O},h.transformMat4=function(O,k,j){var V=k[0],Y=k[1];k=k[2];var Q=j[3]*V+j[7]*Y+j[11]*k+j[15];return Q=Q||1,O[0]=(j[0]*V+j[4]*Y+j[8]*k+j[12])/Q,O[1]=(j[1]*V+j[5]*Y+j[9]*k+j[13])/Q,O[2]=(j[2]*V+j[6]*Y+j[10]*k+j[14])/Q,O},h.transformMat3=function(O,k,j){var V=k[0],Y=k[1];return k=k[2],O[0]=V*j[0]+Y*j[3]+k*j[6],O[1]=V*j[1]+Y*j[4]+k*j[7],O[2]=V*j[2]+Y*j[5]+k*j[8],O},h.transformQuat=function(O,k,j){var V=j[0],Y=j[1],Q=j[2],nt=k[0],ut=k[1];k=k[2];var ct=Y*k-Q*ut,Tt=Q*nt-V*k,Lt=V*ut-Y*nt;return j=2*j[3],O[0]=nt+ct*j+2*(Y*Lt-Q*Tt),O[1]=ut+Tt*j+2*(Q*ct-V*Lt),O[2]=k+Lt*j+2*(V*Tt-Y*ct),O},h.rotateX=function(O,k,j,V){var Y=[],Q=[];return Y[0]=k[0]-j[0],Y[1]=k[1]-j[1],Y[2]=k[2]-j[2],Q[0]=Y[0],Q[1]=Y[1]*Math.cos(V)-Y[2]*Math.sin(V),Q[2]=Y[1]*Math.sin(V)+Y[2]*Math.cos(V),O[0]=Q[0]+j[0],O[1]=Q[1]+j[1],O[2]=Q[2]+j[2],O},h.rotateY=function(O,k,j,V){var Y=[],Q=[];return Y[0]=k[0]-j[0],Y[1]=k[1]-j[1],Y[2]=k[2]-j[2],Q[0]=Y[2]*Math.sin(V)+Y[0]*Math.cos(V),Q[1]=Y[1],Q[2]=Y[2]*Math.cos(V)-Y[0]*Math.sin(V),O[0]=Q[0]+j[0],O[1]=Q[1]+j[1],O[2]=Q[2]+j[2],O},h.rotateZ=function(O,k,j,V){var Y=[],Q=[];return Y[0]=k[0]-j[0],Y[1]=k[1]-j[1],Y[2]=k[2]-j[2],Q[0]=Y[0]*Math.cos(V)-Y[1]*Math.sin(V),Q[1]=Y[0]*Math.sin(V)+Y[1]*Math.cos(V),Q[2]=Y[2],O[0]=Q[0]+j[0],O[1]=Q[1]+j[1],O[2]=Q[2]+j[2],O},h.angle=function(O,k){return O=y(O[0],O[1],O[2]),k=y(k[0],k[1],k[2]),C(O,O),C(k,k),k=L(O,k),1<k?0:-1>k?Math.PI:Math.acos(k)},h.zero=function(O){return O[0]=0,O[1]=0,O[2]=0,O},h.str=function(O){return"vec3("+O[0]+", "+O[1]+", "+O[2]+")"},h.exactEquals=function(O,k){return O[0]===k[0]&&O[1]===k[1]&&O[2]===k[2]},h.equals=function(O,k){var j=O[0],V=O[1];O=O[2];var Y=k[0],Q=k[1];return k=k[2],Math.abs(j-Y)<=B.EPSILON*Math.max(1,Math.abs(j),Math.abs(Y))&&Math.abs(V-Q)<=B.EPSILON*Math.max(1,Math.abs(V),Math.abs(Q))&&Math.abs(O-k)<=B.EPSILON*Math.max(1,Math.abs(O),Math.abs(k))},h.forEach=h.sqrLen=h.len=h.sqrDist=h.dist=h.div=h.mul=h.sub=void 0;var B=function(O){if(O&&O.__esModule)return O;var k={};if(O!=null){for(var j in O)if(Object.prototype.hasOwnProperty.call(O,j)){var V=pn&&Bi?Bi(O,j):{};V.get||V.set?pn(k,j,V):k[j]=O[j]}}return k.default=O,k}(Uo);h.sub=g,h.mul=x,h.div=v,h.dist=M,h.sqrDist=D,h.len=a,h.sqrLen=U,l=function(){var O=o();return function(k,j,V,Y,Q,nt){for(j||(j=3),V||(V=0),Y=Y?Math.min(Y*j+V,k.length):k.length;V<Y;V+=j)O[0]=k[V],O[1]=k[V+1],O[2]=k[V+2],Q(O,O,nt),k[V]=O[0],k[V+1]=O[1],k[V+2]=O[2];return k}}(),h.forEach=l});ot(jg);var Xg=ht(function(l,h){function o(){var C=new U.ARRAY_TYPE(4);return U.ARRAY_TYPE!=Float32Array&&(C[0]=0,C[1]=0,C[2]=0,C[3]=0),C}function a(C,L,B){return C[0]=L[0]-B[0],C[1]=L[1]-B[1],C[2]=L[2]-B[2],C[3]=L[3]-B[3],C}function y(C,L,B){return C[0]=L[0]*B[0],C[1]=L[1]*B[1],C[2]=L[2]*B[2],C[3]=L[3]*B[3],C}function g(C,L,B){return C[0]=L[0]/B[0],C[1]=L[1]/B[1],C[2]=L[2]/B[2],C[3]=L[3]/B[3],C}function x(C,L){var B=L[0]-C[0],O=L[1]-C[1],k=L[2]-C[2];return C=L[3]-C[3],Math.sqrt(B*B+O*O+k*k+C*C)}function v(C,L){var B=L[0]-C[0],O=L[1]-C[1],k=L[2]-C[2];return C=L[3]-C[3],B*B+O*O+k*k+C*C}function M(C){var L=C[0],B=C[1],O=C[2];return C=C[3],Math.sqrt(L*L+B*B+O*O+C*C)}function D(C){var L=C[0],B=C[1],O=C[2];return C=C[3],L*L+B*B+O*O+C*C}Object.defineProperty(h,"__esModule",{value:!0}),h.create=o,h.clone=function(C){var L=new U.ARRAY_TYPE(4);return L[0]=C[0],L[1]=C[1],L[2]=C[2],L[3]=C[3],L},h.fromValues=function(C,L,B,O){var k=new U.ARRAY_TYPE(4);return k[0]=C,k[1]=L,k[2]=B,k[3]=O,k},h.copy=function(C,L){return C[0]=L[0],C[1]=L[1],C[2]=L[2],C[3]=L[3],C},h.set=function(C,L,B,O,k){return C[0]=L,C[1]=B,C[2]=O,C[3]=k,C},h.add=function(C,L,B){return C[0]=L[0]+B[0],C[1]=L[1]+B[1],C[2]=L[2]+B[2],C[3]=L[3]+B[3],C},h.subtract=a,h.multiply=y,h.divide=g,h.ceil=function(C,L){return C[0]=Math.ceil(L[0]),C[1]=Math.ceil(L[1]),C[2]=Math.ceil(L[2]),C[3]=Math.ceil(L[3]),C},h.floor=function(C,L){return C[0]=Math.floor(L[0]),C[1]=Math.floor(L[1]),C[2]=Math.floor(L[2]),C[3]=Math.floor(L[3]),C},h.min=function(C,L,B){return C[0]=Math.min(L[0],B[0]),C[1]=Math.min(L[1],B[1]),C[2]=Math.min(L[2],B[2]),C[3]=Math.min(L[3],B[3]),C},h.max=function(C,L,B){return C[0]=Math.max(L[0],B[0]),C[1]=Math.max(L[1],B[1]),C[2]=Math.max(L[2],B[2]),C[3]=Math.max(L[3],B[3]),C},h.round=function(C,L){return C[0]=Math.round(L[0]),C[1]=Math.round(L[1]),C[2]=Math.round(L[2]),C[3]=Math.round(L[3]),C},h.scale=function(C,L,B){return C[0]=L[0]*B,C[1]=L[1]*B,C[2]=L[2]*B,C[3]=L[3]*B,C},h.scaleAndAdd=function(C,L,B,O){return C[0]=L[0]+B[0]*O,C[1]=L[1]+B[1]*O,C[2]=L[2]+B[2]*O,C[3]=L[3]+B[3]*O,C},h.distance=x,h.squaredDistance=v,h.length=M,h.squaredLength=D,h.negate=function(C,L){return C[0]=-L[0],C[1]=-L[1],C[2]=-L[2],C[3]=-L[3],C},h.inverse=function(C,L){return C[0]=1/L[0],C[1]=1/L[1],C[2]=1/L[2],C[3]=1/L[3],C},h.normalize=function(C,L){var B=L[0],O=L[1],k=L[2];L=L[3];var j=B*B+O*O+k*k+L*L;return 0<j&&(j=1/Math.sqrt(j)),C[0]=B*j,C[1]=O*j,C[2]=k*j,C[3]=L*j,C},h.dot=function(C,L){return C[0]*L[0]+C[1]*L[1]+C[2]*L[2]+C[3]*L[3]},h.cross=function(C,L,B,O){var k=B[0]*O[1]-B[1]*O[0],j=B[0]*O[2]-B[2]*O[0],V=B[0]*O[3]-B[3]*O[0],Y=B[1]*O[2]-B[2]*O[1],Q=B[1]*O[3]-B[3]*O[1];B=B[2]*O[3]-B[3]*O[2],O=L[0];var nt=L[1],ut=L[2];return L=L[3],C[0]=nt*B-ut*Q+L*Y,C[1]=-(O*B)+ut*V-L*j,C[2]=O*Q-nt*V+L*k,C[3]=-(O*Y)+nt*j-ut*k,C},h.lerp=function(C,L,B,O){var k=L[0],j=L[1],V=L[2];return L=L[3],C[0]=k+O*(B[0]-k),C[1]=j+O*(B[1]-j),C[2]=V+O*(B[2]-V),C[3]=L+O*(B[3]-L),C},h.random=function(C,L){L=L||1;do var B=2*U.RANDOM()-1,O=2*U.RANDOM()-1,k=B*B+O*O;while(1<=k);do var j=2*U.RANDOM()-1,V=2*U.RANDOM()-1,Y=j*j+V*V;while(1<=Y);return k=Math.sqrt((1-k)/Y),C[0]=L*B,C[1]=L*O,C[2]=L*j*k,C[3]=L*V*k,C},h.transformMat4=function(C,L,B){var O=L[0],k=L[1],j=L[2];return L=L[3],C[0]=B[0]*O+B[4]*k+B[8]*j+B[12]*L,C[1]=B[1]*O+B[5]*k+B[9]*j+B[13]*L,C[2]=B[2]*O+B[6]*k+B[10]*j+B[14]*L,C[3]=B[3]*O+B[7]*k+B[11]*j+B[15]*L,C},h.transformQuat=function(C,L,B){var O=L[0],k=L[1],j=L[2],V=B[0],Y=B[1],Q=B[2];B=B[3];var nt=B*O+Y*j-Q*k,ut=B*k+Q*O-V*j,ct=B*j+V*k-Y*O;return O=-V*O-Y*k-Q*j,C[0]=nt*B+O*-V+ut*-Q-ct*-Y,C[1]=ut*B+O*-Y+ct*-V-nt*-Q,C[2]=ct*B+O*-Q+nt*-Y-ut*-V,C[3]=L[3],C},h.zero=function(C){return C[0]=0,C[1]=0,C[2]=0,C[3]=0,C},h.str=function(C){return"vec4("+C[0]+", "+C[1]+", "+C[2]+", "+C[3]+")"},h.exactEquals=function(C,L){return C[0]===L[0]&&C[1]===L[1]&&C[2]===L[2]&&C[3]===L[3]},h.equals=function(C,L){var B=C[0],O=C[1],k=C[2];C=C[3];var j=L[0],V=L[1],Y=L[2];return L=L[3],Math.abs(B-j)<=U.EPSILON*Math.max(1,Math.abs(B),Math.abs(j))&&Math.abs(O-V)<=U.EPSILON*Math.max(1,Math.abs(O),Math.abs(V))&&Math.abs(k-Y)<=U.EPSILON*Math.max(1,Math.abs(k),Math.abs(Y))&&Math.abs(C-L)<=U.EPSILON*Math.max(1,Math.abs(C),Math.abs(L))},h.forEach=h.sqrLen=h.len=h.sqrDist=h.dist=h.div=h.mul=h.sub=void 0;var U=function(C){if(C&&C.__esModule)return C;var L={};if(C!=null){for(var B in C)if(Object.prototype.hasOwnProperty.call(C,B)){var O=pn&&Bi?Bi(C,B):{};O.get||O.set?pn(L,B,O):L[B]=C[B]}}return L.default=C,L}(Uo);h.sub=a,h.mul=y,h.div=g,h.dist=x,h.sqrDist=v,h.len=M,h.sqrLen=D,l=function(){var C=o();return function(L,B,O,k,j,V){for(B||(B=4),O||(O=0),k=k?Math.min(k*B+O,L.length):L.length;O<k;O+=B)C[0]=L[O],C[1]=L[O+1],C[2]=L[O+2],C[3]=L[O+3],j(C,C,V),L[O]=C[0],L[O+1]=C[1],L[O+2]=C[2],L[O+3]=C[3];return L}}(),h.forEach=l});ot(Xg);var Yg=ht(function(l,h){function o(B){if(B&&B.__esModule)return B;var O={};if(B!=null){for(var k in B)if(Object.prototype.hasOwnProperty.call(B,k)){var j=pn&&Bi?Bi(B,k):{};j.get||j.set?pn(O,k,j):O[k]=B[k]}}return O.default=B,O}function a(){var B=new M.ARRAY_TYPE(4);return M.ARRAY_TYPE!=Float32Array&&(B[0]=0,B[1]=0,B[2]=0),B[3]=1,B}function y(B,O,k){k*=.5;var j=Math.sin(k);return B[0]=j*O[0],B[1]=j*O[1],B[2]=j*O[2],B[3]=Math.cos(k),B}function g(B,O,k){var j=O[0],V=O[1],Y=O[2];O=O[3];var Q=k[0],nt=k[1],ut=k[2];return k=k[3],B[0]=j*k+O*Q+V*ut-Y*nt,B[1]=V*k+O*nt+Y*Q-j*ut,B[2]=Y*k+O*ut+j*nt-V*Q,B[3]=O*k-j*Q-V*nt-Y*ut,B}function x(B,O,k,j){var V=O[0],Y=O[1],Q=O[2];O=O[3];var nt=k[0],ut=k[1],ct=k[2];k=k[3];var Tt=V*nt+Y*ut+Q*ct+O*k;if(0>Tt&&(Tt=-Tt,nt=-nt,ut=-ut,ct=-ct,k=-k),1-Tt>M.EPSILON){var Lt=Math.acos(Tt),Dt=Math.sin(Lt);Tt=Math.sin((1-j)*Lt)/Dt,j=Math.sin(j*Lt)/Dt}else Tt=1-j;return B[0]=Tt*V+j*nt,B[1]=Tt*Y+j*ut,B[2]=Tt*Q+j*ct,B[3]=Tt*O+j*k,B}function v(B,O){var k=O[0]+O[4]+O[8];if(0<k)k=Math.sqrt(k+1),B[3]=.5*k,k=.5/k,B[0]=(O[5]-O[7])*k,B[1]=(O[6]-O[2])*k,B[2]=(O[1]-O[3])*k;else{var j=0;O[4]>O[0]&&(j=1),O[8]>O[3*j+j]&&(j=2);var V=(j+1)%3,Y=(j+2)%3;k=Math.sqrt(O[3*j+j]-O[3*V+V]-O[3*Y+Y]+1),B[j]=.5*k,k=.5/k,B[3]=(O[3*V+Y]-O[3*Y+V])*k,B[V]=(O[3*V+j]+O[3*j+V])*k,B[Y]=(O[3*Y+j]+O[3*j+Y])*k}return B}Object.defineProperty(h,"__esModule",{value:!0}),h.create=a,h.identity=function(B){return B[0]=0,B[1]=0,B[2]=0,B[3]=1,B},h.setAxisAngle=y,h.getAxisAngle=function(B,O){var k=2*Math.acos(O[3]),j=Math.sin(k/2);return j>M.EPSILON?(B[0]=O[0]/j,B[1]=O[1]/j,B[2]=O[2]/j):(B[0]=1,B[1]=0,B[2]=0),k},h.multiply=g,h.rotateX=function(B,O,k){k*=.5;var j=O[0],V=O[1],Y=O[2];O=O[3];var Q=Math.sin(k);return k=Math.cos(k),B[0]=j*k+O*Q,B[1]=V*k+Y*Q,B[2]=Y*k-V*Q,B[3]=O*k-j*Q,B},h.rotateY=function(B,O,k){k*=.5;var j=O[0],V=O[1],Y=O[2];O=O[3];var Q=Math.sin(k);return k=Math.cos(k),B[0]=j*k-Y*Q,B[1]=V*k+O*Q,B[2]=Y*k+j*Q,B[3]=O*k-V*Q,B},h.rotateZ=function(B,O,k){k*=.5;var j=O[0],V=O[1],Y=O[2];O=O[3];var Q=Math.sin(k);return k=Math.cos(k),B[0]=j*k+V*Q,B[1]=V*k-j*Q,B[2]=Y*k+O*Q,B[3]=O*k-Y*Q,B},h.calculateW=function(B,O){var k=O[0],j=O[1];return O=O[2],B[0]=k,B[1]=j,B[2]=O,B[3]=Math.sqrt(Math.abs(1-k*k-j*j-O*O)),B},h.slerp=x,h.random=function(B){var O=M.RANDOM(),k=M.RANDOM(),j=M.RANDOM(),V=Math.sqrt(1-O);return O=Math.sqrt(O),B[0]=V*Math.sin(2*Math.PI*k),B[1]=V*Math.cos(2*Math.PI*k),B[2]=O*Math.sin(2*Math.PI*j),B[3]=O*Math.cos(2*Math.PI*j),B},h.invert=function(B,O){var k=O[0],j=O[1],V=O[2];O=O[3];var Y=k*k+j*j+V*V+O*O;return Y=Y?1/Y:0,B[0]=-k*Y,B[1]=-j*Y,B[2]=-V*Y,B[3]=O*Y,B},h.conjugate=function(B,O){return B[0]=-O[0],B[1]=-O[1],B[2]=-O[2],B[3]=O[3],B},h.fromMat3=v,h.fromEuler=function(B,O,k,j){var V=.5*Math.PI/180;O*=V,k*=V,j*=V,V=Math.sin(O),O=Math.cos(O);var Y=Math.sin(k);k=Math.cos(k);var Q=Math.sin(j);return j=Math.cos(j),B[0]=V*k*j-O*Y*Q,B[1]=O*Y*j+V*k*Q,B[2]=O*k*Q-V*Y*j,B[3]=O*k*j+V*Y*Q,B},h.str=function(B){return"quat("+B[0]+", "+B[1]+", "+B[2]+", "+B[3]+")"},h.setAxes=h.sqlerp=h.rotationTo=h.equals=h.exactEquals=h.normalize=h.sqrLen=h.squaredLength=h.len=h.length=h.lerp=h.dot=h.scale=h.mul=h.add=h.set=h.copy=h.fromValues=h.clone=void 0;var M=o(Uo),D=o(Wg),U=o(jg);l=o(Xg),h.clone=l.clone,h.fromValues=l.fromValues,h.copy=l.copy,h.set=l.set,h.add=l.add,h.mul=g,h.scale=l.scale,h.dot=l.dot,h.lerp=l.lerp;var C=l.length;h.length=C,h.len=C,C=l.squaredLength,h.squaredLength=C,h.sqrLen=C;var L=l.normalize;h.normalize=L,h.exactEquals=l.exactEquals,h.equals=l.equals,l=function(){var B=U.create(),O=U.fromValues(1,0,0),k=U.fromValues(0,1,0);return function(j,V,Y){var Q=U.dot(V,Y);return-.999999>Q?(U.cross(B,O,V),1e-6>U.len(B)&&U.cross(B,k,V),U.normalize(B,B),y(j,B,Math.PI),j):.999999<Q?(j[0]=0,j[1]=0,j[2]=0,j[3]=1,j):(U.cross(B,V,Y),j[0]=B[0],j[1]=B[1],j[2]=B[2],j[3]=1+Q,L(j,j))}}(),h.rotationTo=l,l=function(){var B=a(),O=a();return function(k,j,V,Y,Q,nt){return x(B,j,Q,nt),x(O,V,Y,nt),x(k,B,O,2*nt*(1-nt)),k}}(),h.sqlerp=l,l=function(){var B=D.create();return function(O,k,j,V){return B[0]=j[0],B[3]=j[1],B[6]=j[2],B[1]=V[0],B[4]=V[1],B[7]=V[2],B[2]=-k[0],B[5]=-k[1],B[8]=-k[2],L(O,v(O,B))}}(),h.setAxes=l});ot(Yg);var bs=ht(function(l,h){function o(C){if(C&&C.__esModule)return C;var L={};if(C!=null){for(var B in C)if(Object.prototype.hasOwnProperty.call(C,B)){var O=pn&&Bi?Bi(C,B):{};O.get||O.set?pn(L,B,O):L[B]=C[B]}}return L.default=C,L}function a(C,L,B){var O=.5*B[0],k=.5*B[1];B=.5*B[2];var j=L[0],V=L[1],Y=L[2];return L=L[3],C[0]=j,C[1]=V,C[2]=Y,C[3]=L,C[4]=O*L+k*Y-B*V,C[5]=k*L+B*j-O*Y,C[6]=B*L+O*V-k*j,C[7]=-O*j-k*V-B*Y,C}function y(C,L){return C[0]=L[0],C[1]=L[1],C[2]=L[2],C[3]=L[3],C[4]=L[4],C[5]=L[5],C[6]=L[6],C[7]=L[7],C}function g(C,L,B){var O=L[0],k=L[1],j=L[2],V=L[3],Y=B[4],Q=B[5],nt=B[6],ut=B[7],ct=L[4],Tt=L[5],Lt=L[6];L=L[7];var Dt=B[0],ae=B[1],ne=B[2];return B=B[3],C[0]=O*B+V*Dt+k*ne-j*ae,C[1]=k*B+V*ae+j*Dt-O*ne,C[2]=j*B+V*ne+O*ae-k*Dt,C[3]=V*B-O*Dt-k*ae-j*ne,C[4]=O*ut+V*Y+k*nt-j*Q+ct*B+L*Dt+Tt*ne-Lt*ae,C[5]=k*ut+V*Q+j*Y-O*nt+Tt*B+L*ae+Lt*Dt-ct*ne,C[6]=j*ut+V*nt+O*Q-k*Y+Lt*B+L*ne+ct*ae-Tt*Dt,C[7]=V*ut-O*Y-k*Q-j*nt+L*B-ct*Dt-Tt*ae-Lt*ne,C}Object.defineProperty(h,"__esModule",{value:!0}),h.create=function(){var C=new x.ARRAY_TYPE(8);return x.ARRAY_TYPE!=Float32Array&&(C[0]=0,C[1]=0,C[2]=0,C[4]=0,C[5]=0,C[6]=0,C[7]=0),C[3]=1,C},h.clone=function(C){var L=new x.ARRAY_TYPE(8);return L[0]=C[0],L[1]=C[1],L[2]=C[2],L[3]=C[3],L[4]=C[4],L[5]=C[5],L[6]=C[6],L[7]=C[7],L},h.fromValues=function(C,L,B,O,k,j,V,Y){var Q=new x.ARRAY_TYPE(8);return Q[0]=C,Q[1]=L,Q[2]=B,Q[3]=O,Q[4]=k,Q[5]=j,Q[6]=V,Q[7]=Y,Q},h.fromRotationTranslationValues=function(C,L,B,O,k,j,V){var Y=new x.ARRAY_TYPE(8);return Y[0]=C,Y[1]=L,Y[2]=B,Y[3]=O,k*=.5,j*=.5,V*=.5,Y[4]=k*O+j*B-V*L,Y[5]=j*O+V*C-k*B,Y[6]=V*O+k*L-j*C,Y[7]=-k*C-j*L-V*B,Y},h.fromRotationTranslation=a,h.fromTranslation=function(C,L){return C[0]=0,C[1]=0,C[2]=0,C[3]=1,C[4]=.5*L[0],C[5]=.5*L[1],C[6]=.5*L[2],C[7]=0,C},h.fromRotation=function(C,L){return C[0]=L[0],C[1]=L[1],C[2]=L[2],C[3]=L[3],C[4]=0,C[5]=0,C[6]=0,C[7]=0,C},h.fromMat4=function(C,L){var B=v.create();M.getRotation(B,L);var O=new x.ARRAY_TYPE(3);return M.getTranslation(O,L),a(C,B,O),C},h.copy=y,h.identity=function(C){return C[0]=0,C[1]=0,C[2]=0,C[3]=1,C[4]=0,C[5]=0,C[6]=0,C[7]=0,C},h.set=function(C,L,B,O,k,j,V,Y,Q){return C[0]=L,C[1]=B,C[2]=O,C[3]=k,C[4]=j,C[5]=V,C[6]=Y,C[7]=Q,C},h.getDual=function(C,L){return C[0]=L[4],C[1]=L[5],C[2]=L[6],C[3]=L[7],C},h.setDual=function(C,L){return C[4]=L[0],C[5]=L[1],C[6]=L[2],C[7]=L[3],C},h.getTranslation=function(C,L){var B=L[4],O=L[5],k=L[6],j=L[7],V=-L[0],Y=-L[1],Q=-L[2];return L=L[3],C[0]=2*(B*L+j*V+O*Q-k*Y),C[1]=2*(O*L+j*Y+k*V-B*Q),C[2]=2*(k*L+j*Q+B*Y-O*V),C},h.translate=function(C,L,B){var O=L[0],k=L[1],j=L[2],V=L[3],Y=.5*B[0],Q=.5*B[1];B=.5*B[2];var nt=L[4],ut=L[5],ct=L[6];return L=L[7],C[0]=O,C[1]=k,C[2]=j,C[3]=V,C[4]=V*Y+k*B-j*Q+nt,C[5]=V*Q+j*Y-O*B+ut,C[6]=V*B+O*Q-k*Y+ct,C[7]=-O*Y-k*Q-j*B+L,C},h.rotateX=function(C,L,B){var O=-L[0],k=-L[1],j=-L[2],V=L[3],Y=L[4],Q=L[5],nt=L[6],ut=L[7],ct=Y*V+ut*O+Q*j-nt*k,Tt=Q*V+ut*k+nt*O-Y*j,Lt=nt*V+ut*j+Y*k-Q*O;return Y=ut*V-Y*O-Q*k-nt*j,v.rotateX(C,L,B),O=C[0],k=C[1],j=C[2],V=C[3],C[4]=ct*V+Y*O+Tt*j-Lt*k,C[5]=Tt*V+Y*k+Lt*O-ct*j,C[6]=Lt*V+Y*j+ct*k-Tt*O,C[7]=Y*V-ct*O-Tt*k-Lt*j,C},h.rotateY=function(C,L,B){var O=-L[0],k=-L[1],j=-L[2],V=L[3],Y=L[4],Q=L[5],nt=L[6],ut=L[7],ct=Y*V+ut*O+Q*j-nt*k,Tt=Q*V+ut*k+nt*O-Y*j,Lt=nt*V+ut*j+Y*k-Q*O;return Y=ut*V-Y*O-Q*k-nt*j,v.rotateY(C,L,B),O=C[0],k=C[1],j=C[2],V=C[3],C[4]=ct*V+Y*O+Tt*j-Lt*k,C[5]=Tt*V+Y*k+Lt*O-ct*j,C[6]=Lt*V+Y*j+ct*k-Tt*O,C[7]=Y*V-ct*O-Tt*k-Lt*j,C},h.rotateZ=function(C,L,B){var O=-L[0],k=-L[1],j=-L[2],V=L[3],Y=L[4],Q=L[5],nt=L[6],ut=L[7],ct=Y*V+ut*O+Q*j-nt*k,Tt=Q*V+ut*k+nt*O-Y*j,Lt=nt*V+ut*j+Y*k-Q*O;return Y=ut*V-Y*O-Q*k-nt*j,v.rotateZ(C,L,B),O=C[0],k=C[1],j=C[2],V=C[3],C[4]=ct*V+Y*O+Tt*j-Lt*k,C[5]=Tt*V+Y*k+Lt*O-ct*j,C[6]=Lt*V+Y*j+ct*k-Tt*O,C[7]=Y*V-ct*O-Tt*k-Lt*j,C},h.rotateByQuatAppend=function(C,L,B){var O=B[0],k=B[1],j=B[2];B=B[3];var V=L[0],Y=L[1],Q=L[2],nt=L[3];return C[0]=V*B+nt*O+Y*j-Q*k,C[1]=Y*B+nt*k+Q*O-V*j,C[2]=Q*B+nt*j+V*k-Y*O,C[3]=nt*B-V*O-Y*k-Q*j,V=L[4],Y=L[5],Q=L[6],nt=L[7],C[4]=V*B+nt*O+Y*j-Q*k,C[5]=Y*B+nt*k+Q*O-V*j,C[6]=Q*B+nt*j+V*k-Y*O,C[7]=nt*B-V*O-Y*k-Q*j,C},h.rotateByQuatPrepend=function(C,L,B){var O=L[0],k=L[1],j=L[2];L=L[3];var V=B[0],Y=B[1],Q=B[2],nt=B[3];return C[0]=O*nt+L*V+k*Q-j*Y,C[1]=k*nt+L*Y+j*V-O*Q,C[2]=j*nt+L*Q+O*Y-k*V,C[3]=L*nt-O*V-k*Y-j*Q,V=B[4],Y=B[5],Q=B[6],nt=B[7],C[4]=O*nt+L*V+k*Q-j*Y,C[5]=k*nt+L*Y+j*V-O*Q,C[6]=j*nt+L*Q+O*Y-k*V,C[7]=L*nt-O*V-k*Y-j*Q,C},h.rotateAroundAxis=function(C,L,B,O){if(Math.abs(O)<x.EPSILON)return y(C,L);var k=Math.sqrt(B[0]*B[0]+B[1]*B[1]+B[2]*B[2]);O*=.5;var j=Math.sin(O),V=j*B[0]/k,Y=j*B[1]/k;B=j*B[2]/k,O=Math.cos(O),k=L[0],j=L[1];var Q=L[2],nt=L[3];return C[0]=k*O+nt*V+j*B-Q*Y,C[1]=j*O+nt*Y+Q*V-k*B,C[2]=Q*O+nt*B+k*Y-j*V,C[3]=nt*O-k*V-j*Y-Q*B,k=L[4],j=L[5],Q=L[6],L=L[7],C[4]=k*O+L*V+j*B-Q*Y,C[5]=j*O+L*Y+Q*V-k*B,C[6]=Q*O+L*B+k*Y-j*V,C[7]=L*O-k*V-j*Y-Q*B,C},h.add=function(C,L,B){return C[0]=L[0]+B[0],C[1]=L[1]+B[1],C[2]=L[2]+B[2],C[3]=L[3]+B[3],C[4]=L[4]+B[4],C[5]=L[5]+B[5],C[6]=L[6]+B[6],C[7]=L[7]+B[7],C},h.multiply=g,h.scale=function(C,L,B){return C[0]=L[0]*B,C[1]=L[1]*B,C[2]=L[2]*B,C[3]=L[3]*B,C[4]=L[4]*B,C[5]=L[5]*B,C[6]=L[6]*B,C[7]=L[7]*B,C},h.lerp=function(C,L,B,O){var k=1-O;return 0>D(L,B)&&(O=-O),C[0]=L[0]*k+B[0]*O,C[1]=L[1]*k+B[1]*O,C[2]=L[2]*k+B[2]*O,C[3]=L[3]*k+B[3]*O,C[4]=L[4]*k+B[4]*O,C[5]=L[5]*k+B[5]*O,C[6]=L[6]*k+B[6]*O,C[7]=L[7]*k+B[7]*O,C},h.invert=function(C,L){var B=U(L);return C[0]=-L[0]/B,C[1]=-L[1]/B,C[2]=-L[2]/B,C[3]=L[3]/B,C[4]=-L[4]/B,C[5]=-L[5]/B,C[6]=-L[6]/B,C[7]=L[7]/B,C},h.conjugate=function(C,L){return C[0]=-L[0],C[1]=-L[1],C[2]=-L[2],C[3]=L[3],C[4]=-L[4],C[5]=-L[5],C[6]=-L[6],C[7]=L[7],C},h.normalize=function(C,L){var B=U(L);if(0<B){B=Math.sqrt(B);var O=L[0]/B,k=L[1]/B,j=L[2]/B,V=L[3]/B,Y=L[4],Q=L[5],nt=L[6];L=L[7];var ut=O*Y+k*Q+j*nt+V*L;C[0]=O,C[1]=k,C[2]=j,C[3]=V,C[4]=(Y-O*ut)/B,C[5]=(Q-k*ut)/B,C[6]=(nt-j*ut)/B,C[7]=(L-V*ut)/B}return C},h.str=function(C){return"quat2("+C[0]+", "+C[1]+", "+C[2]+", "+C[3]+", "+C[4]+", "+C[5]+", "+C[6]+", "+C[7]+")"},h.exactEquals=function(C,L){return C[0]===L[0]&&C[1]===L[1]&&C[2]===L[2]&&C[3]===L[3]&&C[4]===L[4]&&C[5]===L[5]&&C[6]===L[6]&&C[7]===L[7]},h.equals=function(C,L){var B=C[0],O=C[1],k=C[2],j=C[3],V=C[4],Y=C[5],Q=C[6];C=C[7];var nt=L[0],ut=L[1],ct=L[2],Tt=L[3],Lt=L[4],Dt=L[5],ae=L[6];return L=L[7],Math.abs(B-nt)<=x.EPSILON*Math.max(1,Math.abs(B),Math.abs(nt))&&Math.abs(O-ut)<=x.EPSILON*Math.max(1,Math.abs(O),Math.abs(ut))&&Math.abs(k-ct)<=x.EPSILON*Math.max(1,Math.abs(k),Math.abs(ct))&&Math.abs(j-Tt)<=x.EPSILON*Math.max(1,Math.abs(j),Math.abs(Tt))&&Math.abs(V-Lt)<=x.EPSILON*Math.max(1,Math.abs(V),Math.abs(Lt))&&Math.abs(Y-Dt)<=x.EPSILON*Math.max(1,Math.abs(Y),Math.abs(Dt))&&Math.abs(Q-ae)<=x.EPSILON*Math.max(1,Math.abs(Q),Math.abs(ae))&&Math.abs(C-L)<=x.EPSILON*Math.max(1,Math.abs(C),Math.abs(L))},h.sqrLen=h.squaredLength=h.len=h.length=h.dot=h.mul=h.setReal=h.getReal=void 0;var x=o(Uo),v=o(Yg),M=o(pt);h.getReal=v.copy,h.setReal=v.copy,h.mul=g;var D=v.dot;h.dot=D,l=v.length,h.length=l,h.len=l;var U=v.squaredLength;h.squaredLength=U,h.sqrLen=U});ot(bs);var Dn=ht(function(l,h){function o(){var C=new U.ARRAY_TYPE(2);return U.ARRAY_TYPE!=Float32Array&&(C[0]=0,C[1]=0),C}function a(C,L,B){return C[0]=L[0]-B[0],C[1]=L[1]-B[1],C}function y(C,L,B){return C[0]=L[0]*B[0],C[1]=L[1]*B[1],C}function g(C,L,B){return C[0]=L[0]/B[0],C[1]=L[1]/B[1],C}function x(C,L){var B=L[0]-C[0];return C=L[1]-C[1],Math.sqrt(B*B+C*C)}function v(C,L){var B=L[0]-C[0];return C=L[1]-C[1],B*B+C*C}function M(C){var L=C[0];return C=C[1],Math.sqrt(L*L+C*C)}function D(C){var L=C[0];return C=C[1],L*L+C*C}Object.defineProperty(h,"__esModule",{value:!0}),h.create=o,h.clone=function(C){var L=new U.ARRAY_TYPE(2);return L[0]=C[0],L[1]=C[1],L},h.fromValues=function(C,L){var B=new U.ARRAY_TYPE(2);return B[0]=C,B[1]=L,B},h.copy=function(C,L){return C[0]=L[0],C[1]=L[1],C},h.set=function(C,L,B){return C[0]=L,C[1]=B,C},h.add=function(C,L,B){return C[0]=L[0]+B[0],C[1]=L[1]+B[1],C},h.subtract=a,h.multiply=y,h.divide=g,h.ceil=function(C,L){return C[0]=Math.ceil(L[0]),C[1]=Math.ceil(L[1]),C},h.floor=function(C,L){return C[0]=Math.floor(L[0]),C[1]=Math.floor(L[1]),C},h.min=function(C,L,B){return C[0]=Math.min(L[0],B[0]),C[1]=Math.min(L[1],B[1]),C},h.max=function(C,L,B){return C[0]=Math.max(L[0],B[0]),C[1]=Math.max(L[1],B[1]),C},h.round=function(C,L){return C[0]=Math.round(L[0]),C[1]=Math.round(L[1]),C},h.scale=function(C,L,B){return C[0]=L[0]*B,C[1]=L[1]*B,C},h.scaleAndAdd=function(C,L,B,O){return C[0]=L[0]+B[0]*O,C[1]=L[1]+B[1]*O,C},h.distance=x,h.squaredDistance=v,h.length=M,h.squaredLength=D,h.negate=function(C,L){return C[0]=-L[0],C[1]=-L[1],C},h.inverse=function(C,L){return C[0]=1/L[0],C[1]=1/L[1],C},h.normalize=function(C,L){var B=L[0],O=L[1];return B=B*B+O*O,0<B&&(B=1/Math.sqrt(B)),C[0]=L[0]*B,C[1]=L[1]*B,C},h.dot=function(C,L){return C[0]*L[0]+C[1]*L[1]},h.cross=function(C,L,B){return L=L[0]*B[1]-L[1]*B[0],C[0]=C[1]=0,C[2]=L,C},h.lerp=function(C,L,B,O){var k=L[0];return L=L[1],C[0]=k+O*(B[0]-k),C[1]=L+O*(B[1]-L),C},h.random=function(C,L){L=L||1;var B=2*U.RANDOM()*Math.PI;return C[0]=Math.cos(B)*L,C[1]=Math.sin(B)*L,C},h.transformMat2=function(C,L,B){var O=L[0];return L=L[1],C[0]=B[0]*O+B[2]*L,C[1]=B[1]*O+B[3]*L,C},h.transformMat2d=function(C,L,B){var O=L[0];return L=L[1],C[0]=B[0]*O+B[2]*L+B[4],C[1]=B[1]*O+B[3]*L+B[5],C},h.transformMat3=function(C,L,B){var O=L[0];return L=L[1],C[0]=B[0]*O+B[3]*L+B[6],C[1]=B[1]*O+B[4]*L+B[7],C},h.transformMat4=function(C,L,B){var O=L[0];return L=L[1],C[0]=B[0]*O+B[4]*L+B[12],C[1]=B[1]*O+B[5]*L+B[13],C},h.rotate=function(C,L,B,O){var k=L[0]-B[0];L=L[1]-B[1];var j=Math.sin(O);return O=Math.cos(O),C[0]=k*O-L*j+B[0],C[1]=k*j+L*O+B[1],C},h.angle=function(C,L){var B=C[0];C=C[1];var O=L[0];L=L[1];var k=B*B+C*C;0<k&&(k=1/Math.sqrt(k));var j=O*O+L*L;return 0<j&&(j=1/Math.sqrt(j)),B=(B*O+C*L)*k*j,1<B?0:-1>B?Math.PI:Math.acos(B)},h.zero=function(C){return C[0]=0,C[1]=0,C},h.str=function(C){return"vec2("+C[0]+", "+C[1]+")"},h.exactEquals=function(C,L){return C[0]===L[0]&&C[1]===L[1]},h.equals=function(C,L){var B=C[0];C=C[1];var O=L[0];return L=L[1],Math.abs(B-O)<=U.EPSILON*Math.max(1,Math.abs(B),Math.abs(O))&&Math.abs(C-L)<=U.EPSILON*Math.max(1,Math.abs(C),Math.abs(L))},h.forEach=h.sqrLen=h.sqrDist=h.dist=h.div=h.mul=h.sub=h.len=void 0;var U=function(C){if(C&&C.__esModule)return C;var L={};if(C!=null){for(var B in C)if(Object.prototype.hasOwnProperty.call(C,B)){var O=pn&&Bi?Bi(C,B):{};O.get||O.set?pn(L,B,O):L[B]=C[B]}}return L.default=C,L}(Uo);h.len=M,h.sub=a,h.mul=y,h.div=g,h.dist=x,h.sqrDist=v,h.sqrLen=D,l=function(){var C=o();return function(L,B,O,k,j,V){for(B||(B=2),O||(O=0),k=k?Math.min(k*B+O,L.length):L.length;O<k;O+=B)C[0]=L[O],C[1]=L[O+1],j(C,C,V),L[O]=C[0],L[O+1]=C[1];return L}}(),h.forEach=l});ot(Dn);var vs=ht(function(l,h){function o(a){if(a&&a.__esModule)return a;var y={};if(a!=null){for(var g in a)if(Object.prototype.hasOwnProperty.call(a,g)){var x=pn&&Bi?Bi(a,g):{};x.get||x.set?pn(y,g,x):y[g]=a[g]}}return y.default=a,y}Object.defineProperty(h,"__esModule",{value:!0}),h.vec4=h.vec3=h.vec2=h.quat2=h.quat=h.mat4=h.mat3=h.mat2d=h.mat2=h.glMatrix=void 0,l=o(Uo),h.glMatrix=l,l=o(Vg),h.mat2=l,l=o(z1),h.mat2d=l,l=o(Wg),h.mat3=l,l=o(pt),h.mat4=l,l=o(Yg),h.quat=l,l=o(bs),h.quat2=l,l=o(Dn),h.vec2=l,l=o(jg),h.vec3=l,l=o(Xg),h.vec4=l});ot(vs);var on=vs.vec4,dr=vs.vec3,Zr=vs.vec2,RA=vs.quat2,Nf=vs.quat,Ke=vs.mat4,N1=vs.mat3,Zg=vs.mat2d,qg=vs.mat2,PA=vs.glMatrix,jr=function(){function l(h,o,a){Xe(this,l),this.options=o,this.gl=h,a&&(this.map=a.map),a=this.getVertexShader(o.vertexShader);var y=this.getFragmentShader(o.fragmentShader);o=h.createShader(h.VERTEX_SHADER),h.shaderSource(o,a),h.compileShader(o),h.getShaderParameter(o,h.COMPILE_STATUS)?(a=h.createShader(h.FRAGMENT_SHADER),h.shaderSource(a,y),h.compileShader(a),h.getShaderParameter(a,h.COMPILE_STATUS)?(y=h.createProgram(),h.attachShader(y,o),h.attachShader(y,a),h.deleteShader(o),h.deleteShader(a),h.linkProgram(y),h.getProgramParameter(y,h.LINK_STATUS)?o=y:(o="Shader program failed to link.  The error log is:"+h.getProgramInfoLog(y),console.error(o),o=-1)):(o="Fragment shader failed to compile.  The error log is:"+h.getShaderInfoLog(a),console.error(o),o=-1)):(o="Vertex shader failed to compile.  The error log is:"+h.getShaderInfoLog(o),console.error(o),o=-1),o=this.program=o,a={},y=h.getProgramParameter(o,h.ACTIVE_ATTRIBUTES);for(var g=0;g<y;g++){var x=h.getActiveAttrib(o,g);a[x.name]=h.getAttribLocation(o,x.name)}g={},x={};for(var v=h.getProgramParameter(o,h.ACTIVE_UNIFORMS),M=0;M<v;M++){var D=h.getActiveUniform(o,M);g[D.name]=h.getUniformLocation(o,D.name),x[D.name]=D.type}this.parameter=h={attributes:a,numAttributes:y,uniformsType:x,uniforms:g},this.attributes=h.attributes,this.uniforms=h.uniforms,this.parameter=h}return Ue(l,[{key:"getVertexShader",value:function(h){var o="";return this.map&&this.map.type==="cesium"&&(o=`#define LOG_DEPTH
`),o+=`#ifdef LOG_DEPTH
uniform float currentFrustumX;varying float v_depthFromNearPlusOne;
#endif
uniform vec2 MAPV_resolution;
#if defined(PICK)
uniform bool uIsPickRender;attribute vec3 aPickColor;uniform vec3 uPickedColor;varying vec4 vPickColor;uniform bool uEnablePicked;bool mapvIsPicked(){return uEnablePicked&&aPickColor==uPickedColor;}
#endif
void afterMain(){
#if defined(LOG_DEPTH)
v_depthFromNearPlusOne=(gl_Position.w-currentFrustumX)+1.0;gl_Position.z=clamp(gl_Position.z/gl_Position.w,-1.0,1.0)*gl_Position.w;
#endif
#if defined(PICK)
vPickColor=vec4(aPickColor,0.0);if(mapvIsPicked()){vPickColor.a=1.0;}
#endif
}`,h=this.getDefines()+o+h,h=h.replace("void main","void originMain"),h+"void main() {originMain(); afterMain();}"}},{key:"getFragmentShader",value:function(h){var o="";return this.map&&this.map.type==="cesium"&&(o=`#define LOG_DEPTH
`),o+=`#if defined(LOG_DEPTH)
#extension GL_EXT_frag_depth : enable
#endif
precision highp float;uniform vec2 MAPV_resolution;uniform bool uIsPickRender;
#if defined(PICK)
varying vec4 vPickColor;bool mapvIsPicked(){return vPickColor.a==1.0;}
#endif
#if defined(LOG_DEPTH)
uniform float oneOverLog2FarDepthFromNearPlusOne;uniform float farDepthFromNearPlusOne;varying float v_depthFromNearPlusOne;void writeLogDepth(float depth){if(depth<=0.9999999||depth>farDepthFromNearPlusOne){discard;}gl_FragDepthEXT=log2(depth)*oneOverLog2FarDepthFromNearPlusOne;}
#endif
void afterMain(){
#if defined(PICK)
if(uIsPickRender){gl_FragColor=vec4(vPickColor.rgb,1.0);return;}
#endif
#if defined(LOG_DEPTH)
writeLogDepth(v_depthFromNearPlusOne);
#endif
}`,h=this.getDefines()+o+h,h=h.replace("void main","void originMain"),h+"void main() {originMain(); afterMain();}"}},{key:"getDefines",value:function(){var h="",o=this.options.defines;if(o)for(var a=0;a<o.length;a++)h+="#define "+o[a]+`
`;return h}},{key:"use",value:function(h,o){this.gl=h,h.useProgram(this.program),this.map&&this.map.type==="cesium"&&this.setUniforms({currentFrustumX:this.map.map.scene.camera.frustum.near,oneOverLog2FarDepthFromNearPlusOne:this.map.map.scene.context.uniformState.oneOverLog2FarDepthFromNearPlusOne,farDepthFromNearPlusOne:this.map.map.scene.context.uniformState.farDepthFromNearPlusOne}),this.uniforms.MAPV_resolution&&this.setUniforms({MAPV_resolution:[h.canvas.width,h.canvas.height]})}},{key:"setUniform",value:function(h,o){var a=this.gl,y=this.uniforms[h];if(y)switch(this.parameter.uniformsType[h]){case a.FLOAT:a.uniform1f(y,o);break;case a.FLOAT_VEC2:a.uniform2f(y,o[0],o[1]);break;case a.FLOAT_VEC3:a.uniform3f(y,o[0],o[1],o[2]);break;case a.FLOAT_VEC4:a.uniform4f(y,o[0],o[1],o[2],o[3]);break;case a.SAMPLER_2D:case a.SAMPLER_CUBE:a.activeTexture(a["TEXTURE"+this.textureIndex]),a.uniform1i(y,this.textureIndex),a.bindTexture(a.TEXTURE_2D,o),this.textureIndex++;break;case a.INT:case a.BOOL:a.uniform1i(y,o);break;case a.INT_VEC2:case a.BOOL_VEC2:a.uniform2i(y,o[0],o[1]);break;case a.INT_VEC3:case a.BOOL_VEC3:a.uniform3i(y,o[0],o[1],o[2]);break;case a.INT_VEC4:case a.BOOL_VEC4:a.uniform4i(y,o[0],o[1],o[2],o[3]);break;case a.FLOAT_MAT2:a.uniformMatrix2fv(y,!1,o);break;case a.FLOAT_MAT3:a.uniformMatrix3fv(y,!1,o);break;case a.FLOAT_MAT4:a.uniformMatrix4fv(y,!1,o);break;default:console.error("Unrecognized uniform type: "+h)}else console.warn("Unrecognized uniform type: "+h)}},{key:"setUniforms",value:function(h){this.textureIndex=0;for(var o in h)this.setUniform(o,h[o])}}]),l}(),Qa=function(l,h,o,a){var y=o?o.call(a,l,h):void 0;if(y!==void 0)return!!y;if(l===h)return!0;if((typeof l=="undefined"?"undefined":kn(l))!=="object"||!l||(typeof h=="undefined"?"undefined":kn(h))!=="object"||!h)return!1;var g=bn(l),x=bn(h);if(g.length!==x.length)return!1;x=Object.prototype.hasOwnProperty.bind(h);for(var v=0;v<g.length;v++){if(y=g[v],!x(y))return!1;var M=l[y],D=h[y];if(y=o?o.call(a,M,D,y):void 0,y===!1||y===void 0&&M!==D)return!1}return!0},Jg=function(){function l(h){Xe(this,l),this.options=h,this.gl=h.gl,this.savedState=[],this.currentState=this.getDefaultState()}return Ue(l,[{key:"setDefaultState",value:function(){this.setState()}},{key:"getDefaultState",value:function(){var h=this.gl;return{blend:!1,blendEquation:h.FUNC_ADD,blendFunc:[h.ONE,h.ZERO],depthMask:!0,depthTest:!0,depthFunc:h.LEQUAL,polygonOffset:[0,0],cullFace:!1,stencilTest:!1}}},{key:"getRealState",value:function(){var h=this.gl;return{blend:h.getParameter(h.BLEND),blendEquation:h.getParameter(h.BLEND_EQUATION),depthMask:h.getParameter(h.DEPTH_WRITEMASK),depthTest:h.getParameter(h.DEPTH_TEST),depthFunc:h.getParameter(h.DEPTH_FUNC),polygonOffset:[h.getParameter(h.POLYGON_OFFSET_FACTOR),h.getParameter(h.POLYGON_OFFSET_UNITS)],cullFace:h.getParameter(h.CULL_FACE),stencilTest:h.getParameter(h.STENCIL_TEST)}}},{key:"getCurrentState",value:function(){return this.currentState}},{key:"save",value:function(){this.savedState.push(this.getCurrentState())}},{key:"restore",value:function(){var h=this.savedState.pop();this.setState(h,{force:!0})}},{key:"setState",value:function(h){var o=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{};h=Vr(this.getDefaultState(),h),this.setBlend(h,o),this.setDepth(h,o),this.setCullFace(h,o),this.setPolygonOffset(h,o),this.setStencil(h,o),this.currentState=h}},{key:"setBlend",value:function(h,o){var a=this.gl,y=this.getCurrentState();((o=o.force)||!Qa(h.blend,y.blend))&&(h.blend?a.enable(a.BLEND):a.disable(a.BLEND)),!o&&Qa(h.blendEquation,y.blendEquation)||a.blendEquation(h.blendEquation),!o&&Qa(h.blendFunc,y.blendFunc)||a.blendFunc(h.blendFunc[0],h.blendFunc[1])}},{key:"setDepth",value:function(h,o){var a=this.gl,y=this.getCurrentState();((o=o.force)||!Qa(h.depthTest,y.depthTest))&&(h.depthTest?a.enable(a.DEPTH_TEST):a.disable(a.DEPTH_TEST)),(o||!Qa(h.depthMask,y.depthMask))&&(h.depthMask?a.depthMask(!0):a.depthMask(!1)),!o&&Qa(h.depthFunc,y.depthFunc)||a.depthFunc(h.depthFunc)}},{key:"setPolygonOffset",value:function(h,o){var a=this.gl,y=this.getCurrentState();(o.force||!Qa(h.polygonOffset,y.polygonOffset))&&(h.polygonOffset[0]!==0&&h.polygonOffset[1]!==0?a.enable(a.POLYGON_OFFSET_FILL):a.disable(a.POLYGON_OFFSET_FILL),a.polygonOffset(h.polygonOffset[0],h.polygonOffset[1]))}},{key:"setCullFace",value:function(h,o){var a=this.gl,y=this.getCurrentState();(o.force||!Qa(h.cullFace,y.cullFace))&&(h.cullFace?(a.enable(a.CULL_FACE),a.cullFace(a.BACK)):a.disable(a.CULL_FACE))}},{key:"setStencil",value:function(h,o){var a=this.gl,y=this.getCurrentState();(o.force||!Qa(h.stencilTest,y.stencilTest))&&(h.stencilTest?a.enable(a.STENCIL_TEST):a.disable(a.STENCIL_TEST))}}]),l}(),qe=function(){function l(h){Xe(this,l),this.options=h,this.gl=h.gl,this.buffer=this.gl.createBuffer(),h.data&&this.updateData(h.data)}return Ue(l,[{key:"updateData",value:function(h){var o=this.options,a=this.gl;this.bind(),a.bufferData(a[o.target],h,a[o.usage])}},{key:"bind",value:function(h){h=h||this.gl,h.bindBuffer(h[this.options.target],this.buffer)}},{key:"unBind",value:function(h){h=h||this.gl,h.bindBuffer(h[this.options.target],null)}},{key:"destroy",value:function(){this.buffer=null}}]),l}(),U1={BYTE:1,UNSIGNED_BYTE:1,SHORT:2,UNSIGNED_SHORT:2,FLOAT:4},bi=function(){function l(h){for(Xe(this,l),this.options=h,this.attributes=h.attributes,this.gl=h.gl,this.program=h.program,h=this.stride=0;h<this.attributes.length;h++)this.stride+=U1[this.attributes[h].type]*this.attributes[h].size}return Ue(l,[{key:"setVertexAttribPointers",value:function(){for(var h=this.gl,o=this.program,a=0;a<this.attributes.length;a++){var y=this.attributes[a],g=o.attributes[y.name];g!==void 0&&(y.buffer.bind(h),h.vertexAttribPointer(g,y.size,h[y.type],y.normalize||!1,y.stride!==void 0?y.stride:this.stride,y.offset),h.enableVertexAttribArray(g))}}},{key:"bind",value:function(){this.setVertexAttribPointers()}},{key:"destroy",value:function(){}}]),l}(),Zn=function l(h,o,a){Xe(this,l),o=o||h.canvas.width,a=a||h.canvas.height;var y=h.createFramebuffer(),g=h.createTexture();h.bindTexture(h.TEXTURE_2D,g),h.texImage2D(h.TEXTURE_2D,0,h.RGBA,o,a,0,h.RGBA,h.UNSIGNED_BYTE,null),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MAG_FILTER,h.LINEAR),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MIN_FILTER,h.LINEAR),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_S,h.CLAMP_TO_EDGE),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_T,h.CLAMP_TO_EDGE),y.texture=g;var x=h.createRenderbuffer();h.bindRenderbuffer(h.RENDERBUFFER,x),h.renderbufferStorage(h.RENDERBUFFER,h.DEPTH_STENCIL,o,a),y.depthBuffer=x,h.bindFramebuffer(h.FRAMEBUFFER,y),h.framebufferTexture2D(h.FRAMEBUFFER,h.COLOR_ATTACHMENT0,h.TEXTURE_2D,g,0),h.framebufferRenderbuffer(h.FRAMEBUFFER,h.DEPTH_STENCIL_ATTACHMENT,h.RENDERBUFFER,x),o=h.checkFramebufferStatus(h.FRAMEBUFFER),h.FRAMEBUFFER_COMPLETE===o&&(h.bindFramebuffer(h.FRAMEBUFFER,null),h.bindTexture(h.TEXTURE_2D,null),h.bindRenderbuffer(h.RENDERBUFFER,null),this.framebuffer=y)},Ka=function(){function l(h){Xe(this,l),this.options={},Vr(this.options,h),this.vertex=[-1,1,0,-1,-1,0,1,1,0,1,1,0,-1,-1,0,1,-1,0],this.sampleCoord=[0,1,0,0,1,1,1,1,0,0,1,0]}return Ue(l,[{key:"getOptions",value:function(){return this.options}},{key:"onResize",value:function(h){}},{key:"render",value:function(h){var o=h.gl;h=h.texture;var a=this.programSample;o.useProgram(a.program);var y=o.createBuffer();o.bindBuffer(o.ARRAY_BUFFER,y);var g=[-1,-1,0,-1,1,0,1,1,0,1,1,0,-1,-1,0,1,-1,0];o.bufferData(o.ARRAY_BUFFER,new Float32Array(g),o.STATIC_DRAW),o.enableVertexAttribArray(a.attributes.aPos),o.vertexAttribPointer(a.attributes.aPos,3,o.FLOAT,!1,0,0),y=o.createBuffer(),o.bindBuffer(o.ARRAY_BUFFER,y),o.bufferData(o.ARRAY_BUFFER,new Float32Array([0,0,0,1,1,1,1,1,0,0,1,0]),o.STATIC_DRAW),o.enableVertexAttribArray(a.attributes.aTextureCoord),o.vertexAttribPointer(a.attributes.aTextureCoord,2,o.FLOAT,!1,0,0),o.activeTexture(o.TEXTURE0),o.bindTexture(o.TEXTURE_2D,h),o.uniform1i(a.uniforms.uSampler,0),o.drawArrays(o.TRIANGLES,0,g.length/3)}}]),l}(),DA=function(l){function h(o){return Xe(this,h),_r(this,(h.__proto__||ur(h)).call(this,o))}return yr(h,l),Ue(h,[{key:"getProgram",value:function(o){return this.programSample||(this.programSample=new jr(o,{vertexShader:"attribute vec3 aPos;attribute vec2 aTextureCoord;varying vec2 vTextureCoord;void main(void){vTextureCoord=aTextureCoord;gl_Position=vec4(aPos,1.0);}",fragmentShader:"precision highp float;uniform sampler2D uSampler;uniform vec2 canvasSize;varying vec2 vTextureCoord;vec4 fxaa_2_0(sampler2D tex,vec2 fragCoord,vec2 resolution,vec2 v_rgbNW,vec2 v_rgbNE,vec2 v_rgbSW,vec2 v_rgbSE,vec2 v_rgbM){vec4 color;mediump vec2 inverseVP=vec2(1.0/resolution.x,1.0/resolution.y);vec3 rgbNW=texture2D(tex,v_rgbNW).xyz;vec3 rgbNE=texture2D(tex,v_rgbNE).xyz;vec3 rgbSW=texture2D(tex,v_rgbSW).xyz;vec3 rgbSE=texture2D(tex,v_rgbSE).xyz;vec4 texColor=texture2D(tex,v_rgbM);vec3 rgbM=texColor.xyz;vec3 luma=vec3(0.299,0.587,0.114);float lumaNW=dot(rgbNW,luma);float lumaNE=dot(rgbNE,luma);float lumaSW=dot(rgbSW,luma);float lumaSE=dot(rgbSE,luma);float lumaM=dot(rgbM,luma);float lumaMin=min(lumaM,min(min(lumaNW,lumaNE),min(lumaSW,lumaSE)));float lumaMax=max(lumaM,max(max(lumaNW,lumaNE),max(lumaSW,lumaSE)));mediump vec2 dir;dir.x=-((lumaNW+lumaNE)-(lumaSW+lumaSE));dir.y=((lumaNW+lumaSW)-(lumaNE+lumaSE));float dirReduce=max((lumaNW+lumaNE+lumaSW+lumaSE)*(0.25*1.0/8.0),1.0/128.0);float rcpDirMin=1.0/(min(abs(dir.x),abs(dir.y))+dirReduce);dir=min(vec2(8.0,8.0),max(vec2(-8.0,-8.0),dir*rcpDirMin))*inverseVP;vec3 rgbA=0.5*(texture2D(tex,fragCoord*inverseVP+dir*(1.0/3.0-0.5)).xyz+texture2D(tex,fragCoord*inverseVP+dir*(2.0/3.0-0.5)).xyz);vec3 rgbB=rgbA*0.5+0.25*(texture2D(tex,fragCoord*inverseVP+dir*-0.5).xyz+texture2D(tex,fragCoord*inverseVP+dir*0.5).xyz);float lumaB=dot(rgbB,luma);if((lumaB<lumaMin)||(lumaB>lumaMax)){color=vec4(rgbA,texColor.a);}else{color=vec4(rgbB,texColor.a);}return color;}void texcoords_3_1(vec2 fragCoord,vec2 resolution,out vec2 v_rgbNW,out vec2 v_rgbNE,out vec2 v_rgbSW,out vec2 v_rgbSE,out vec2 v_rgbM){vec2 inverseVP=1.0/resolution.xy;v_rgbNW=(fragCoord+vec2(-1.0,-1.0))*inverseVP;v_rgbNE=(fragCoord+vec2(1.0,-1.0))*inverseVP;v_rgbSW=(fragCoord+vec2(-1.0,1.0))*inverseVP;v_rgbSE=(fragCoord+vec2(1.0,1.0))*inverseVP;v_rgbM=vec2(fragCoord*inverseVP);}vec4 apply_1_2(sampler2D tex,vec2 fragCoord,vec2 resolution){mediump vec2 v_rgbNW;mediump vec2 v_rgbNE;mediump vec2 v_rgbSW;mediump vec2 v_rgbSE;mediump vec2 v_rgbM;texcoords_3_1(fragCoord,resolution,v_rgbNW,v_rgbNE,v_rgbSW,v_rgbSE,v_rgbM);return fxaa_2_0(tex,fragCoord,resolution,v_rgbNW,v_rgbNE,v_rgbSW,v_rgbSE,v_rgbM);}void main(void){vec2 fragCoord=vTextureCoord*canvasSize;gl_FragColor=apply_1_2(uSampler,fragCoord,canvasSize);}"})),this.programSample}},{key:"render",value:function(o){var a=o.gl;o=o.texture,this.getOptions(),a.clearColor(0,0,0,0),a.clear(a.COLOR_BUFFER_BIT|a.DEPTH_BUFFER_BIT);var y=this.getProgram(a);a.useProgram(y.program);var g=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,g),a.bufferData(a.ARRAY_BUFFER,new Float32Array(this.vertex),a.STATIC_DRAW),a.enableVertexAttribArray(y.attributes.aPos),a.vertexAttribPointer(y.attributes.aPos,3,a.FLOAT,!1,0,0),g=a.createBuffer(),a.bindBuffer(a.ARRAY_BUFFER,g),a.bufferData(a.ARRAY_BUFFER,new Float32Array(this.sampleCoord),a.STATIC_DRAW),a.enableVertexAttribArray(y.attributes.aTextureCoord),a.vertexAttribPointer(y.attributes.aTextureCoord,2,a.FLOAT,!1,0,0),a.activeTexture(a.TEXTURE1),a.bindTexture(a.TEXTURE_2D,o),a.uniform1i(y.uniforms.uSampler,1),a.uniform2fv(y.uniforms.canvasSize,[a.canvas.width,a.canvas.height]),a.drawArrays(a.TRIANGLES,0,this.vertex.length/3),a.bindBuffer(a.ARRAY_BUFFER,null),a.useProgram(null)}}]),h}(Ka),Qg=function(l){function h(o){return Xe(this,h),_r(this,(h.__proto__||ur(h)).call(this,o))}return yr(h,l),Ue(h,[{key:"getProgram",value:function(o){if(this.program1||(this.program1=new jr(o,{vertexShader:"attribute vec3 position;attribute vec2 uv;uniform vec2 resolution;varying vec2 vUv;varying vec4 vOffset[3];void SMAAEdgeDetectionVS(vec2 texcoord){vOffset[0]=texcoord.xyxy+resolution.xyxy*vec4(-1.0,0.0,0.0,1.0);vOffset[1]=texcoord.xyxy+resolution.xyxy*vec4(1.0,0.0,0.0,-1.0);vOffset[2]=texcoord.xyxy+resolution.xyxy*vec4(-2.0,0.0,0.0,2.0);}void main(){vUv=uv;SMAAEdgeDetectionVS(vUv);gl_Position=vec4(position,1.0);}",fragmentShader:`precision highp float;
#define SMAA_THRESHOLD 0.1
uniform sampler2D tDiffuse;varying vec2 vUv;varying vec4 vOffset[3];vec4 SMAAColorEdgeDetectionPS(vec2 texcoord,vec4 offset[3],sampler2D colorTex){vec2 threshold=vec2(SMAA_THRESHOLD,SMAA_THRESHOLD);vec4 delta;vec3 C=texture2D(colorTex,texcoord).rgb;vec3 Cleft=texture2D(colorTex,offset[0].xy).rgb;vec3 t=abs(C-Cleft);delta.x=max(max(t.r,t.g),t.b);vec3 Ctop=texture2D(colorTex,offset[0].zw).rgb;t=abs(C-Ctop);delta.y=max(max(t.r,t.g),t.b);vec2 edges=step(threshold,delta.xy);if(dot(edges,vec2(1.0,1.0))==0.0)discard;vec3 Cright=texture2D(colorTex,offset[1].xy).rgb;t=abs(C-Cright);delta.z=max(max(t.r,t.g),t.b);vec3 Cbottom=texture2D(colorTex,offset[1].zw).rgb;t=abs(C-Cbottom);delta.w=max(max(t.r,t.g),t.b);float maxDelta=max(max(max(delta.x,delta.y),delta.z),delta.w);vec3 Cleftleft=texture2D(colorTex,offset[2].xy).rgb;t=abs(C-Cleftleft);delta.z=max(max(t.r,t.g),t.b);vec3 Ctoptop=texture2D(colorTex,offset[2].zw).rgb;t=abs(C-Ctoptop);delta.w=max(max(t.r,t.g),t.b);maxDelta=max(max(maxDelta,delta.z),delta.w);edges.xy*=step(0.5*maxDelta,delta.xy);return vec4(edges,0.0,0.0);}void main(){gl_FragColor=SMAAColorEdgeDetectionPS(vUv,vOffset,tDiffuse);}`})),this.program2||(this.program2=new jr(o,{vertexShader:`precision highp float;
#define SMAA_MAX_SEARCH_STEPS 8
#define SMAA_AREATEX_MAX_DISTANCE 16
#define SMAA_AREATEX_PIXEL_SIZE ( 1.0 / vec2( 160.0, 560.0 ) )
#define SMAA_AREATEX_SUBTEX_SIZE ( 1.0 / 7.0 )
attribute vec3 position;attribute vec2 uv;uniform vec2 resolution;varying vec2 vUv;varying vec4 vOffset[3];varying vec2 vPixcoord;void SMAABlendingWeightCalculationVS(vec2 texcoord){vPixcoord=texcoord/resolution;vOffset[0]=texcoord.xyxy+resolution.xyxy*vec4(-0.25,0.125,1.25,0.125);vOffset[1]=texcoord.xyxy+resolution.xyxy*vec4(-0.125,0.25,-0.125,-1.25);vOffset[2]=vec4(vOffset[0].xz,vOffset[1].yw)+vec4(-2.0,2.0,-2.0,2.0)*resolution.xxyy*float(SMAA_MAX_SEARCH_STEPS);}void main(){vUv=uv;SMAABlendingWeightCalculationVS(vUv);gl_Position=vec4(position,1.0);}`,fragmentShader:`precision highp float;
#define SMAA_MAX_SEARCH_STEPS 8
#define SMAA_AREATEX_MAX_DISTANCE 16
#define SMAA_AREATEX_PIXEL_SIZE ( 1.0 / vec2( 160.0, 560.0 ) )
#define SMAA_AREATEX_SUBTEX_SIZE ( 1.0 / 7.0 )
#define SMAASampleLevelZeroOffset( tex, coord, offset ) texture2D( tex, coord + float( offset ) * resolution, 0.0 )
uniform sampler2D tDiffuse;uniform sampler2D tArea;uniform sampler2D tSearch;uniform vec2 resolution;varying vec2 vUv;varying vec4 vOffset[3];varying vec2 vPixcoord;vec2 round(vec2 x){return sign(x)*floor(abs(x)+0.5);}float SMAASearchLength(sampler2D searchTex,vec2 e,float bias,float scale){e.r=bias+e.r*scale;return 255.0*texture2D(searchTex,e,0.0).r;}float SMAASearchXLeft(sampler2D edgesTex,sampler2D searchTex,vec2 texcoord,float end){/***@PSEUDO_GATHER4*This texcoord has been offset by(-0.25,-0.125)in the vertex shader to*sample between edge,thus fetching four edges in a row.*Sampling with different offsets in each direction allows to disambiguate*which edges are active from the four fetched ones.*/vec2 e=vec2(0.0,1.0);for(int i=0;i<SMAA_MAX_SEARCH_STEPS;i++){e=texture2D(edgesTex,texcoord,0.0).rg;texcoord-=vec2(2.0,0.0)*resolution;if(!(texcoord.x>end&&e.g>0.8281&&e.r==0.0))break;}texcoord.x+=0.25*resolution.x;texcoord.x+=resolution.x;texcoord.x+=2.0*resolution.x;texcoord.x-=resolution.x*SMAASearchLength(searchTex,e,0.0,0.5);return texcoord.x;}float SMAASearchXRight(sampler2D edgesTex,sampler2D searchTex,vec2 texcoord,float end){vec2 e=vec2(0.0,1.0);for(int i=0;i<SMAA_MAX_SEARCH_STEPS;i++){e=texture2D(edgesTex,texcoord,0.0).rg;texcoord+=vec2(2.0,0.0)*resolution;if(!(texcoord.x<end&&e.g>0.8281&&e.r==0.0))break;}texcoord.x-=0.25*resolution.x;texcoord.x-=resolution.x;texcoord.x-=2.0*resolution.x;texcoord.x+=resolution.x*SMAASearchLength(searchTex,e,0.5,0.5);return texcoord.x;}float SMAASearchYUp(sampler2D edgesTex,sampler2D searchTex,vec2 texcoord,float end){vec2 e=vec2(1.0,0.0);for(int i=0;i<SMAA_MAX_SEARCH_STEPS;i++){e=texture2D(edgesTex,texcoord,0.0).rg;texcoord+=vec2(0.0,2.0)*resolution;if(!(texcoord.y>end&&e.r>0.8281&&e.g==0.0))break;}texcoord.y-=0.25*resolution.y;texcoord.y-=resolution.y;texcoord.y-=2.0*resolution.y;texcoord.y+=resolution.y*SMAASearchLength(searchTex,e.gr,0.0,0.5);return texcoord.y;}float SMAASearchYDown(sampler2D edgesTex,sampler2D searchTex,vec2 texcoord,float end){vec2 e=vec2(1.0,0.0);for(int i=0;i<SMAA_MAX_SEARCH_STEPS;i++){e=texture2D(edgesTex,texcoord,0.0).rg;texcoord-=vec2(0.0,2.0)*resolution;if(!(texcoord.y<end&&e.r>0.8281&&e.g==0.0))break;}texcoord.y+=0.25*resolution.y;texcoord.y+=resolution.y;texcoord.y+=2.0*resolution.y;texcoord.y-=resolution.y*SMAASearchLength(searchTex,e.gr,0.5,0.5);return texcoord.y;}vec2 SMAAArea(sampler2D areaTex,vec2 dist,float e1,float e2,float offset){vec2 texcoord=float(SMAA_AREATEX_MAX_DISTANCE)*round(4.0*vec2(e1,e2))+dist;texcoord=SMAA_AREATEX_PIXEL_SIZE*texcoord+(0.5*SMAA_AREATEX_PIXEL_SIZE);texcoord.y+=SMAA_AREATEX_SUBTEX_SIZE*offset;return texture2D(areaTex,texcoord,0.0).rg;}vec4 SMAABlendingWeightCalculationPS(vec2 texcoord,vec2 pixcoord,vec4 offset[3],sampler2D edgesTex,sampler2D areaTex,sampler2D searchTex,ivec4 subsampleIndices){vec4 weights=vec4(0.0,0.0,0.0,0.0);vec2 e=texture2D(edgesTex,texcoord).rg;if(e.g>0.0){vec2 d;vec2 coords;coords.x=SMAASearchXLeft(edgesTex,searchTex,offset[0].xy,offset[2].x);coords.y=offset[1].y;d.x=coords.x;float e1=texture2D(edgesTex,coords,0.0).r;coords.x=SMAASearchXRight(edgesTex,searchTex,offset[0].zw,offset[2].y);d.y=coords.x;d=d/resolution.x-pixcoord.x;vec2 sqrt_d=sqrt(abs(d));coords.y-=1.0*resolution.y;float e2=SMAASampleLevelZeroOffset(edgesTex,coords,ivec2(1,0)).r;weights.rg=SMAAArea(areaTex,sqrt_d,e1,e2,float(subsampleIndices.y));}if(e.r>0.0){vec2 d;vec2 coords;coords.y=SMAASearchYUp(edgesTex,searchTex,offset[1].xy,offset[2].z);coords.x=offset[0].x;d.x=coords.y;float e1=texture2D(edgesTex,coords,0.0).g;coords.y=SMAASearchYDown(edgesTex,searchTex,offset[1].zw,offset[2].w);d.y=coords.y;d=d/resolution.y-pixcoord.y;vec2 sqrt_d=sqrt(abs(d));coords.y-=1.0*resolution.y;float e2=SMAASampleLevelZeroOffset(edgesTex,coords,ivec2(0,1)).g;weights.ba=SMAAArea(areaTex,sqrt_d,e1,e2,float(subsampleIndices.x));}return weights;}void main(){gl_FragColor=SMAABlendingWeightCalculationPS(vUv,vPixcoord,vOffset,tDiffuse,tArea,tSearch,ivec4(0.0));}`})),this.program3||(this.program3=new jr(o,{vertexShader:"precision highp float;uniform vec2 resolution;attribute vec3 position;attribute vec2 uv;varying vec2 vUv;varying vec4 vOffset[2];void SMAANeighborhoodBlendingVS(vec2 texcoord){vOffset[0]=texcoord.xyxy+resolution.xyxy*vec4(-1.0,0.0,0.0,1.0);vOffset[1]=texcoord.xyxy+resolution.xyxy*vec4(1.0,0.0,0.0,-1.0);}void main(){vUv=uv;SMAANeighborhoodBlendingVS(vUv);gl_Position=vec4(position,1.0);}",fragmentShader:"precision highp float;uniform sampler2D tDiffuse;uniform sampler2D tColor;uniform vec2 resolution;varying vec2 vUv;varying vec4 vOffset[2];vec4 SMAANeighborhoodBlendingPS(vec2 texcoord,vec4 offset[2],sampler2D colorTex,sampler2D blendTex){vec4 a;a.xz=texture2D(blendTex,texcoord).xz;a.y=texture2D(blendTex,offset[1].zw).g;a.w=texture2D(blendTex,offset[1].xy).a;if(dot(a,vec4(1.0,1.0,1.0,1.0))<1e-5){return texture2D(colorTex,texcoord,0.0);}else{vec2 offset;offset.x=a.a>a.b ? a.a :-a.b;offset.y=a.g>a.r ?-a.g : a.r;if(abs(offset.x)>abs(offset.y)){offset.y=0.0;}else{offset.x=0.0;}vec4 C=texture2D(colorTex,texcoord,0.0);texcoord+=sign(offset)*resolution;vec4 Cop=texture2D(colorTex,texcoord,0.0);float s=abs(offset.x)>abs(offset.y)? abs(offset.x): abs(offset.y);C.xyz=pow(C.xyz,vec3(2.2));Cop.xyz=pow(Cop.xyz,vec3(2.2));vec4 mixed=mix(C,Cop,s);mixed.xyz=pow(mixed.xyz,vec3(1.0/2.2));return mixed;}}void main(){gl_FragColor=SMAANeighborhoodBlendingPS(vUv,vOffset,tColor,tDiffuse);}"})),!this.vertexBuffer||!this.sampleBuffer){this.vertexBuffer=new qe({gl:o,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.sampleBuffer=new qe({gl:o,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.vertexBuffer.updateData(new Float32Array(this.vertex)),this.sampleBuffer.updateData(new Float32Array(this.sampleCoord));var a=[{stride:12,name:"position",buffer:this.vertexBuffer,size:3,type:"FLOAT",offset:0},{stride:8,name:"uv",buffer:this.sampleBuffer,size:2,type:"FLOAT",offset:0}];this.vertexArray1=new bi({gl:o,program:this.program1,attributes:a}),this.vertexArray2=new bi({gl:o,program:this.program2,attributes:a}),this.vertexArray3=new bi({gl:o,program:this.program3,attributes:a})}return{program1:this.program1,program2:this.program2,program3:this.program3}}},{key:"onResize",value:function(o){this.collectBrightBuffer=new Zn(o),this.bloomBuffer=new Zn(o)}},{key:"getExtraFbo",value:function(o){return this.collectBrightBuffer||(this.collectBrightBuffer=new Zn(o)),this.bloomBuffer||(this.bloomBuffer=new Zn(o)),{collectBrightBuffer:this.collectBrightBuffer.framebuffer,bloomBuffer:this.bloomBuffer.framebuffer}}},{key:"render",value:function(o){var a=o.gl,y=o.texture;o=o.fbo,this.getOptions(),a.clearColor(0,0,0,0),a.clear(a.COLOR_BUFFER_BIT|a.DEPTH_BUFFER_BIT);var g=this.getProgram(a),x=g.program1,v=g.program2;g=g.program3;var M=this.getExtraFbo(a),D=M.collectBrightBuffer;M=M.bloomBuffer;var U=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,U),a.bufferData(a.ARRAY_BUFFER,new Float32Array(this.vertex),a.STATIC_DRAW),a.enableVertexAttribArray(x.attributes.position),a.vertexAttribPointer(x.attributes.position,3,a.FLOAT,!1,0,0),a.enableVertexAttribArray(v.attributes.position),a.vertexAttribPointer(v.attributes.position,3,a.FLOAT,!1,0,0),a.enableVertexAttribArray(g.attributes.position),a.vertexAttribPointer(g.attributes.position,3,a.FLOAT,!1,0,0),U=a.createBuffer(),a.bindBuffer(a.ARRAY_BUFFER,U),a.bufferData(a.ARRAY_BUFFER,new Float32Array(this.sampleCoord),a.STATIC_DRAW),a.enableVertexAttribArray(x.attributes.uv),a.vertexAttribPointer(x.attributes.uv,2,a.FLOAT,!1,0,0),a.enableVertexAttribArray(v.attributes.uv),a.vertexAttribPointer(v.attributes.uv,2,a.FLOAT,!1,0,0),a.enableVertexAttribArray(g.attributes.uv),a.vertexAttribPointer(g.attributes.uv,2,a.FLOAT,!1,0,0),a.useProgram(x.program),a.bindFramebuffer(a.FRAMEBUFFER,D),a.clearColor(0,0,0,0),a.clear(a.COLOR_BUFFER_BIT|a.DEPTH_BUFFER_BIT),a.activeTexture(a.TEXTURE2),a.bindTexture(a.TEXTURE_2D,y),a.uniform1i(x.uniforms.tDiffuse,2),a.uniform2fv(x.uniforms.resolution,[a.canvas.width,a.canvas.height]),a.drawArrays(a.TRIANGLES,0,this.vertex.length/3),a.useProgram(v.program),a.bindFramebuffer(a.FRAMEBUFFER,M),a.clearColor(0,0,0,0),a.clear(a.COLOR_BUFFER_BIT|a.DEPTH_BUFFER_BIT),a.activeTexture(a.TEXTURE2),a.bindTexture(a.TEXTURE_2D,D.texture),a.uniform1i(v.uniforms.uSampler,2),a.uniform2fv(v.uniforms.resolution,[a.canvas.width,a.canvas.height]),a.drawArrays(a.TRIANGLES,0,this.vertex.length/3),a.useProgram(g.program),a.bindFramebuffer(a.FRAMEBUFFER,o),a.clearColor(0,0,0,0),a.clear(a.COLOR_BUFFER_BIT|a.DEPTH_BUFFER_BIT),a.activeTexture(a.TEXTURE2),a.bindTexture(a.TEXTURE_2D,y),a.uniform1i(g.uniforms.tDiffuse,2),a.activeTexture(a.TEXTURE3),a.bindTexture(a.TEXTURE_2D,M.texture),a.uniform1i(g.uniforms.tColor,3),a.uniform2fv(g.uniforms.resolution,[a.canvas.width,a.canvas.height]),a.drawArrays(a.TRIANGLES,0,this.vertex.length/3),a.bindBuffer(a.ARRAY_BUFFER,null),a.useProgram(null)}},{key:"getAreaTexture",value:function(){return"data:image/png;base64,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"}},{key:"getSearchTexture",value:function(){return"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEIAAAAhCAIAAADiVupLAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAFZJREFUeNrs00EKgAAIRNEZ739mTQoiwmhRi4L/FiKiu9ERISkzbXdTVV3H4WhfOG6ehl1rNR7qDSF8hwkVcJXt+3A//I0Nv0GoCBUAAAAAAMA/LAIMAB+Dcg2OE2zsAAAAAElFTkSuQmCC"}}]),h}(Ka),Kg=function(l){function h(o){return Xe(this,h),_r(this,(h.__proto__||ur(h)).call(this,o))}return yr(h,l),Ue(h,[{key:"getProgram",value:function(o){return this.programSample||(this.programSample=new jr(o,{vertexShader:"attribute vec3 aPos;attribute vec2 aTextureCoord;varying vec2 vTextureCoord;void main(){vTextureCoord=aTextureCoord;gl_Position=vec4(aPos,1.0);}",fragmentShader:"precision mediump float;uniform sampler2D uSampler;varying vec2 vTextureCoord;void main(){float fStep=1.0/512.0;vec4 sample11=texture2D(uSampler,vec2(vTextureCoord.s-1.0*fStep,vTextureCoord.t+1.0*fStep));vec4 sample12=texture2D(uSampler,vec2(vTextureCoord.s,vTextureCoord.t+1.0*fStep));vec4 sample13=texture2D(uSampler,vec2(vTextureCoord.s+1.0*fStep,vTextureCoord.t+1.0*fStep));vec4 sample21=texture2D(uSampler,vec2(vTextureCoord.s-1.0*fStep,vTextureCoord.t));vec4 sample22=texture2D(uSampler,vec2(vTextureCoord.s,vTextureCoord.t));vec4 sample23=texture2D(uSampler,vec2(vTextureCoord.s+1.0*fStep,vTextureCoord.t));vec4 sample31=texture2D(uSampler,vec2(vTextureCoord.s-1.0*fStep,vTextureCoord.t-1.0*fStep));vec4 sample32=texture2D(uSampler,vec2(vTextureCoord.s,vTextureCoord.t-1.0*fStep));vec4 sample33=texture2D(uSampler,vec2(vTextureCoord.s+1.0*fStep,vTextureCoord.t-1.0*fStep));vec4 blurSample=(sample11+sample12+sample13+sample21+2.0*sample22+sample23+sample31+sample32+sample33)/10.0;gl_FragColor=blurSample;}"}),this.vertexBuffer=new qe({gl:o,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.sampleBuffer=new qe({gl:o,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.vertexBuffer.updateData(new Float32Array(this.vertex)),this.sampleBuffer.updateData(new Float32Array(this.sampleCoord)),this.vertexArray=new bi({gl:o,program:this.programSample,attributes:[{stride:12,name:"aPos",buffer:this.vertexBuffer,size:3,type:"FLOAT",offset:0},{stride:8,name:"aTextureCoord",buffer:this.sampleBuffer,size:2,type:"FLOAT",offset:0}]})),this.programSample}},{key:"render",value:function(o){var a=o.gl;o=o.texture,a.clearColor(0,0,0,0),a.clear(a.COLOR_BUFFER_BIT|a.DEPTH_BUFFER_BIT);var y=this.getProgram(a);y.use(a),this.vertexArray.bind(),a.activeTexture(a.TEXTURE1),a.bindTexture(a.TEXTURE_2D,o),a.uniform1i(y.uniforms.uSampler,1),a.drawArrays(a.TRIANGLES,0,this.vertex.length/3)}}]),h}(Ka),b1=function(l){function h(o){return Xe(this,h),_r(this,(h.__proto__||ur(h)).call(this,o))}return yr(h,l),Ue(h,[{key:"getProgram",value:function(o){return this.programBright||(this.programBright=new jr(o,{vertexShader:"attribute vec3 aPos;attribute vec2 aTextureCoord;varying vec2 vTextureCoord;void main(){vTextureCoord=aTextureCoord;gl_Position=vec4(aPos,1.0);}",fragmentShader:"precision mediump float;uniform sampler2D uSampler;uniform float threshold;varying vec2 vTextureCoord;void main(){vec4 color=texture2D(uSampler,vTextureCoord);vec4 lightColor=max(vec4(0.0),(color-(1.0-threshold)/5.0));float brightness=dot(color.rgb,vec3(0.2126,0.7152,0.0722));if(brightness>threshold){color=lightColor;}else{color=vec4(0.0);}gl_FragColor=color;}"})),this.programBloom||(this.programBloom=new jr(o,{vertexShader:"attribute vec3 aPos;attribute vec2 aTextureCoord;varying vec2 vTextureCoord;void main(){vTextureCoord=aTextureCoord;gl_Position=vec4(aPos,1.0);}",fragmentShader:"precision mediump float;uniform sampler2D uSampler;uniform bool isVertical;uniform vec2 canvasSize;uniform float blurSize;uniform float devicePixelRatio;varying vec2 vTextureCoord;void main(){float weight[10];weight[0]=0.2270270270;weight[1]=0.1945945946;weight[2]=0.1216216216;weight[3]=0.1135135135;weight[4]=0.0972972973;weight[5]=0.0608108108;weight[6]=0.0540540541;weight[7]=0.0270270270;weight[8]=0.0162162162;weight[9]=0.0081081081;vec2 offset=vec2(blurSize/canvasSize.x,blurSize/canvasSize.y)*devicePixelRatio;vec4 result=texture2D(uSampler,vTextureCoord)*weight[0];if(isVertical){for(int i=1;i<10;++i){result+=texture2D(uSampler,vTextureCoord+vec2(0.0,offset.y*float(i)))*weight[i];result+=texture2D(uSampler,vTextureCoord-vec2(0.0,offset.y*float(i)))*weight[i];}}else{for(int i=1;i<10;++i){result+=texture2D(uSampler,vTextureCoord+vec2(offset.x*float(i),0.0))*weight[i];result+=texture2D(uSampler,vTextureCoord-vec2(offset.x*float(i),0.0))*weight[i];}}gl_FragColor=result;}"})),this.programResult||(this.programResult=new jr(o,{vertexShader:"attribute vec3 aPos;attribute vec2 aTextureCoord;varying vec2 vTextureCoord;void main(){vTextureCoord=aTextureCoord;gl_Position=vec4(aPos,1.0);}",fragmentShader:"precision mediump float;uniform sampler2D originalTexture;uniform sampler2D bloomTexture;varying vec2 vTextureCoord;void main(){vec4 color=texture2D(originalTexture,vTextureCoord);vec4 bloomColor=texture2D(bloomTexture,vTextureCoord);color+=bloomColor;gl_FragColor=color;}"})),{programBright:this.programBright,programBloom:this.programBloom,programResult:this.programResult}}},{key:"onResize",value:function(o){this.collectBrightBuffer=new Zn(o),this.bloomBuffer=new Zn(o)}},{key:"getExtraFbo",value:function(o){return this.collectBrightBuffer||(this.collectBrightBuffer=new Zn(o)),this.bloomBuffer||(this.bloomBuffer=new Zn(o)),{collectBrightBuffer:this.collectBrightBuffer.framebuffer,bloomBuffer:this.bloomBuffer.framebuffer}}},{key:"render",value:function(o){var a=o.gl,y=o.texture;o=o.fbo;var g=this.getOptions();a.clearColor(0,0,0,0),a.clear(a.COLOR_BUFFER_BIT|a.DEPTH_BUFFER_BIT);var x=this.getProgram(a),v=x.programBright,M=x.programBloom;x=x.programResult;var D=this.getExtraFbo(a),U=D.collectBrightBuffer;D=D.bloomBuffer;var C=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,C),a.bufferData(a.ARRAY_BUFFER,new Float32Array(this.vertex),a.STATIC_DRAW),a.enableVertexAttribArray(v.attributes.aPos),a.vertexAttribPointer(v.attributes.aPos,3,a.FLOAT,!1,0,0),a.enableVertexAttribArray(M.attributes.aPos),a.vertexAttribPointer(M.attributes.aPos,3,a.FLOAT,!1,0,0),a.enableVertexAttribArray(x.attributes.aPos),a.vertexAttribPointer(x.attributes.aPos,3,a.FLOAT,!1,0,0),C=a.createBuffer(),a.bindBuffer(a.ARRAY_BUFFER,C),a.bufferData(a.ARRAY_BUFFER,new Float32Array(this.sampleCoord),a.STATIC_DRAW),a.enableVertexAttribArray(v.attributes.aTextureCoord),a.vertexAttribPointer(v.attributes.aTextureCoord,2,a.FLOAT,!1,0,0),a.enableVertexAttribArray(M.attributes.aTextureCoord),a.vertexAttribPointer(M.attributes.aTextureCoord,2,a.FLOAT,!1,0,0),a.enableVertexAttribArray(x.attributes.aTextureCoord),a.vertexAttribPointer(x.attributes.aTextureCoord,2,a.FLOAT,!1,0,0),a.useProgram(v.program),a.bindFramebuffer(a.FRAMEBUFFER,U),a.clearColor(0,0,0,0),a.clear(a.COLOR_BUFFER_BIT|a.DEPTH_BUFFER_BIT),a.activeTexture(a.TEXTURE1),a.bindTexture(a.TEXTURE_2D,y),a.uniform1i(v.uniforms.uSampler,1),a.uniform1f(v.uniforms.threshold,g.threshold||0),a.drawArrays(a.TRIANGLES,0,this.vertex.length/3),a.useProgram(M.program),a.bindFramebuffer(a.FRAMEBUFFER,D),a.clearColor(0,0,0,0),a.clear(a.COLOR_BUFFER_BIT|a.DEPTH_BUFFER_BIT),a.activeTexture(a.TEXTURE1),a.bindTexture(a.TEXTURE_2D,U.texture),a.uniform1i(M.uniforms.uSampler,1),a.uniform1i(M.uniforms.isVertical,!0),a.uniform1f(M.uniforms.blurSize,g.blurSize||2),a.uniform1f(M.uniforms.devicePixelRatio,window.devicePixelRatio),a.uniform2fv(M.uniforms.canvasSize,[a.canvas.width,a.canvas.height]),a.drawArrays(a.TRIANGLES,0,this.vertex.length/3),a.useProgram(M.program),a.bindFramebuffer(a.FRAMEBUFFER,U),a.clearColor(0,0,0,0),a.clear(a.COLOR_BUFFER_BIT|a.DEPTH_BUFFER_BIT),a.activeTexture(a.TEXTURE1),a.bindTexture(a.TEXTURE_2D,D.texture),a.uniform1i(M.uniforms.uSampler,1),a.uniform1i(M.uniforms.isVertical,!1),a.uniform1f(M.uniforms.blurSize,g.blurSize||2),a.uniform1f(M.uniforms.devicePixelRatio,window.devicePixelRatio),a.uniform2fv(M.uniforms.canvasSize,[a.canvas.width,a.canvas.height]),a.drawArrays(a.TRIANGLES,0,this.vertex.length/3),a.useProgram(x.program),a.bindFramebuffer(a.FRAMEBUFFER,o),a.clearColor(0,0,0,0),a.clear(a.COLOR_BUFFER_BIT|a.DEPTH_BUFFER_BIT),a.activeTexture(a.TEXTURE1),a.bindTexture(a.TEXTURE_2D,y),a.uniform1i(x.uniforms.originalTexture,1),a.activeTexture(a.TEXTURE0),a.bindTexture(a.TEXTURE_2D,U.texture),a.uniform1i(x.uniforms.bloomTexture,0),a.drawArrays(a.TRIANGLES,0,this.vertex.length/3),a.bindBuffer(a.ARRAY_BUFFER,null),a.useProgram(null)}}]),h}(Ka),k1=function(l){function h(o){return Xe(this,h),_r(this,(h.__proto__||ur(h)).call(this,o))}return yr(h,l),Ue(h,[{key:"getProgram",value:function(o){return this.programBright||(this.programBright=new jr(o,{vertexShader:"attribute vec3 aPos;attribute vec2 aTextureCoord;varying vec2 vTextureCoord;void main(){vTextureCoord=aTextureCoord;gl_Position=vec4(aPos,1.0);}",fragmentShader:"precision mediump float;uniform sampler2D uSampler;uniform float threshold;varying vec2 vTextureCoord;void main(){vec4 color=texture2D(uSampler,vTextureCoord);vec4 lightColor=max(vec4(0.0),(color-threshold));gl_FragColor=lightColor;}"})),this.programBloom||(this.programBloom=new jr(o,{vertexShader:"attribute vec3 aPos;attribute vec2 aTextureCoord;varying vec2 vTextureCoord;void main(){vTextureCoord=aTextureCoord;gl_Position=vec4(aPos,1.0);}",fragmentShader:"precision mediump float;uniform sampler2D uSampler;uniform bool isVertical;uniform vec2 canvasSize;uniform float blurSize;uniform float devicePixelRatio;varying vec2 vTextureCoord;void main(){float weight[10];weight[0]=0.2270270270;weight[1]=0.1945945946;weight[2]=0.1216216216;weight[3]=0.1135135135;weight[4]=0.0972972973;weight[5]=0.0608108108;weight[6]=0.0540540541;weight[7]=0.0270270270;weight[8]=0.0162162162;weight[9]=0.0081081081;vec2 offset=vec2(blurSize/canvasSize.x,blurSize/canvasSize.y)*devicePixelRatio;vec4 result=texture2D(uSampler,vTextureCoord)*weight[0];if(isVertical){for(int i=1;i<10;++i){result+=texture2D(uSampler,vTextureCoord+vec2(0.0,offset.y*float(i)))*weight[i];result+=texture2D(uSampler,vTextureCoord-vec2(0.0,offset.y*float(i)))*weight[i];}}else{for(int i=1;i<10;++i){result+=texture2D(uSampler,vTextureCoord+vec2(offset.x*float(i),0.0))*weight[i];result+=texture2D(uSampler,vTextureCoord-vec2(offset.x*float(i),0.0))*weight[i];}}gl_FragColor=result;}"})),this.programResult||(this.programResult=new jr(o,{vertexShader:"attribute vec3 aPos;attribute vec2 aTextureCoord;varying vec2 vTextureCoord;void main(){vTextureCoord=aTextureCoord;gl_Position=vec4(aPos,1.0);}",fragmentShader:"precision mediump float;uniform sampler2D originalTexture;uniform sampler2D bloomTexture;uniform float toneScale;varying vec2 vTextureCoord;void main(){vec4 color=texture2D(originalTexture,vTextureCoord)*toneScale;vec4 bloomColor=texture2D(bloomTexture,vTextureCoord);color+=bloomColor;gl_FragColor=color;}"})),{programBright:this.programBright,programBloom:this.programBloom,programResult:this.programResult}}},{key:"onResize",value:function(o){this.collectBrightBuffer=new Zn(o),this.bloomBuffer=new Zn(o)}},{key:"getExtraFbo",value:function(o){return this.collectBrightBuffer||(this.collectBrightBuffer=new Zn(o)),this.bloomBuffer||(this.bloomBuffer=new Zn(o)),{collectBrightBuffer:this.collectBrightBuffer.framebuffer,bloomBuffer:this.bloomBuffer.framebuffer}}},{key:"render",value:function(o){var a=o.gl,y=o.texture;o=o.fbo;var g=this.getOptions(),x="clarity"in g?g.clarity:1;x=Math.max(0,x),x=Math.min(1,x),a.clearColor(0,0,0,0),a.clear(a.COLOR_BUFFER_BIT|a.DEPTH_BUFFER_BIT);var v=this.getProgram(a),M=v.programBright,D=v.programBloom;v=v.programResult;var U=this.getExtraFbo(a),C=U.collectBrightBuffer;U=U.bloomBuffer;var L=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,L),a.bufferData(a.ARRAY_BUFFER,new Float32Array(this.vertex),a.STATIC_DRAW),a.enableVertexAttribArray(M.attributes.aPos),a.vertexAttribPointer(M.attributes.aPos,3,a.FLOAT,!1,0,0),a.enableVertexAttribArray(D.attributes.aPos),a.vertexAttribPointer(D.attributes.aPos,3,a.FLOAT,!1,0,0),a.enableVertexAttribArray(v.attributes.aPos),a.vertexAttribPointer(v.attributes.aPos,3,a.FLOAT,!1,0,0),L=a.createBuffer(),a.bindBuffer(a.ARRAY_BUFFER,L),a.bufferData(a.ARRAY_BUFFER,new Float32Array(this.sampleCoord),a.STATIC_DRAW),a.enableVertexAttribArray(M.attributes.aTextureCoord),a.vertexAttribPointer(M.attributes.aTextureCoord,2,a.FLOAT,!1,0,0),a.enableVertexAttribArray(D.attributes.aTextureCoord),a.vertexAttribPointer(D.attributes.aTextureCoord,2,a.FLOAT,!1,0,0),a.enableVertexAttribArray(v.attributes.aTextureCoord),a.vertexAttribPointer(v.attributes.aTextureCoord,2,a.FLOAT,!1,0,0),a.useProgram(M.program),a.bindFramebuffer(a.FRAMEBUFFER,C),a.clearColor(0,0,0,0),a.clear(a.COLOR_BUFFER_BIT|a.DEPTH_BUFFER_BIT),a.activeTexture(a.TEXTURE1),a.bindTexture(a.TEXTURE_2D,y),a.uniform1i(M.uniforms.uSampler,1),a.uniform1f(M.uniforms.threshold,g.threshold||0),a.drawArrays(a.TRIANGLES,0,this.vertex.length/3),a.useProgram(D.program),a.bindFramebuffer(a.FRAMEBUFFER,U),a.clearColor(0,0,0,0),a.clear(a.COLOR_BUFFER_BIT|a.DEPTH_BUFFER_BIT),a.activeTexture(a.TEXTURE1),a.bindTexture(a.TEXTURE_2D,C.texture),a.uniform1i(D.uniforms.uSampler,1),a.uniform1i(D.uniforms.isVertical,!0),a.uniform1f(D.uniforms.blurSize,g.blurSize||2),a.uniform1f(D.uniforms.devicePixelRatio,window.devicePixelRatio),a.uniform2fv(D.uniforms.canvasSize,[a.canvas.width,a.canvas.height]),a.drawArrays(a.TRIANGLES,0,this.vertex.length/3),a.useProgram(D.program),a.bindFramebuffer(a.FRAMEBUFFER,C),a.clearColor(0,0,0,0),a.clear(a.COLOR_BUFFER_BIT|a.DEPTH_BUFFER_BIT),a.activeTexture(a.TEXTURE1),a.bindTexture(a.TEXTURE_2D,U.texture),a.uniform1i(D.uniforms.uSampler,1),a.uniform1i(D.uniforms.isVertical,!1),a.uniform1f(D.uniforms.blurSize,g.blurSize||2),a.uniform1f(D.uniforms.devicePixelRatio,window.devicePixelRatio),a.uniform2fv(D.uniforms.canvasSize,[a.canvas.width,a.canvas.height]),a.drawArrays(a.TRIANGLES,0,this.vertex.length/3),a.useProgram(v.program),a.bindFramebuffer(a.FRAMEBUFFER,o),a.clearColor(0,0,0,0),a.clear(a.COLOR_BUFFER_BIT|a.DEPTH_BUFFER_BIT),a.activeTexture(a.TEXTURE1),a.bindTexture(a.TEXTURE_2D,y),a.uniform1i(v.uniforms.originalTexture,1),a.uniform1f(v.uniforms.toneScale,x),a.activeTexture(a.TEXTURE0),a.bindTexture(a.TEXTURE_2D,C.texture),a.uniform1i(v.uniforms.bloomTexture,0),a.drawArrays(a.TRIANGLES,0,this.vertex.length/3),a.bindBuffer(a.ARRAY_BUFFER,null),a.useProgram(null)}}]),h}(Ka),OA=function(l){function h(o){return Xe(this,h),_r(this,(h.__proto__||ur(h)).call(this,o))}return yr(h,l),Ue(h,[{key:"getProgram",value:function(o){return this.programSample||(this.programSample=new jr(o,{vertexShader:"attribute vec3 aPos;attribute vec2 aTextureCoord;varying vec2 vTextureCoord;void main(){vTextureCoord=aTextureCoord;gl_Position=vec4(aPos,1.0);}",fragmentShader:"precision mediump float;uniform sampler2D uSampler;uniform vec2 canvasSize;varying vec2 vTextureCoord;void main(){float fStep=1.0/312.0;vec4 sample11=texture2D(uSampler,vec2(vTextureCoord.s-1.0*fStep,vTextureCoord.t+1.0*fStep));vec4 sample12=texture2D(uSampler,vec2(vTextureCoord.s,vTextureCoord.t+1.0*fStep));vec4 sample13=texture2D(uSampler,vec2(vTextureCoord.s+1.0*fStep,vTextureCoord.t+1.0*fStep));vec4 sample21=texture2D(uSampler,vec2(vTextureCoord.s-1.0*fStep,vTextureCoord.t));vec4 sample22=texture2D(uSampler,vec2(vTextureCoord.s,vTextureCoord.t));vec4 sample23=texture2D(uSampler,vec2(vTextureCoord.s+1.0*fStep,vTextureCoord.t));vec4 sample31=texture2D(uSampler,vec2(vTextureCoord.s-1.0*fStep,vTextureCoord.t-1.0*fStep));vec4 sample32=texture2D(uSampler,vec2(vTextureCoord.s,vTextureCoord.t-1.0*fStep));vec4 sample33=texture2D(uSampler,vec2(vTextureCoord.s+1.0*fStep,vTextureCoord.t-1.0*fStep));vec4 blurSample=(sample11+sample12+sample13+sample21+2.0*sample22+sample23+sample31+sample32+sample33)/10.0;float desX=abs((gl_FragCoord.x-canvasSize.x/2.0)/(canvasSize.x/2.0));float desY=abs((gl_FragCoord.y-canvasSize.y/2.0)/(canvasSize.y/2.0));float factor=max(desX,desY);gl_FragColor=(sample22*(1.0-factor)+blurSample*factor);}"})),this.programSample}},{key:"render",value:function(o){var a=o.gl;o=o.texture;var y=this.getProgram(a);a.useProgram(y.program);var g=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,g),a.bufferData(a.ARRAY_BUFFER,new Float32Array(this.vertex),a.STATIC_DRAW),a.enableVertexAttribArray(y.attributes.aPos),a.vertexAttribPointer(y.attributes.aPos,3,a.FLOAT,!1,0,0),g=a.createBuffer(),a.bindBuffer(a.ARRAY_BUFFER,g),a.bufferData(a.ARRAY_BUFFER,new Float32Array(this.sampleCoord),a.STATIC_DRAW),a.enableVertexAttribArray(y.attributes.aTextureCoord),a.vertexAttribPointer(y.attributes.aTextureCoord,2,a.FLOAT,!1,0,0),a.activeTexture(a.TEXTURE1),a.bindTexture(a.TEXTURE_2D,o),a.uniform1i(y.uniforms.uSampler,1),a.uniform2fv(y.uniforms.canvasSize,[a.canvas.width,a.canvas.height]),a.drawArrays(a.TRIANGLES,0,this.vertex.length/3)}}]),h}(Ka),$h=function(){function l(h){Xe(this,l),this.gl=h,this.effects=[],this.initFbo()}return Ue(l,[{key:"addEffect",value:function(h){this.effects.push(h)}},{key:"removeEffect",value:function(h){}},{key:"setEffects",value:function(h){this.effects=h}},{key:"onResize",value:function(){this.initFbo();var h=this.gl,o=this.effects;if(o&&1<o.length)for(var a=1;a<o.length;a++){var y=o[a];y.onResize&&y.onResize(h)}}},{key:"initFbo",value:function(){var h=this.gl;h&&(this.fbo=[new Zn(h),new Zn(h)])}},{key:"destroy",value:function(){this.effects=[],this.fbo=[],this.gl=null}},{key:"render",value:function(){var h=this.gl,o=this.effects;if(o&&0<o.length)for(var a={},y=0;y<o.length;y++){var g=this.fbo[y%2].framebuffer;y===o.length-1&&(g=null),h.bindFramebuffer(h.FRAMEBUFFER,g);var x=[0,0,0,0];h.clearColor(x[0],x[1],x[2],x[3]),h.clear(h.COLOR_BUFFER_BIT|h.DEPTH_BUFFER_BIT),o[y].render({isPickRender:!1,gl:h,texture:a.texture,fbo:g}),a=g}}}]),l}(),Hu=function(){function l(h,o){Xe(this,l),this.map=h,this.options=o||{},this.eventMap={}}return Ue(l,[{key:"onResize",value:function(h){}},{key:"onUpdate",value:function(h){throw"\u672A\u5B9E\u73B0onUpdate\u65B9\u6CD5"}},{key:"getContainer",value:function(){throw"\u672A\u5B9E\u73B0getContainer\u65B9\u6CD5"}},{key:"getSize",value:function(){throw"\u672A\u5B9E\u73B0getSize\u65B9\u6CD5"}},{key:"getTilt",value:function(){throw"\u672A\u5B9E\u73B0getTilt\u65B9\u6CD5"}},{key:"getHeading",value:function(){throw"\u672A\u5B9E\u73B0getHeading\u65B9\u6CD5"}},{key:"getZoomUnits",value:function(){throw"\u672A\u5B9E\u73B0getZoomUnits\u65B9\u6CD5"}},{key:"getCenter",value:function(){throw"\u672A\u5B9E\u73B0getCenter\u65B9\u6CD5"}},{key:"getMapType",value:function(){throw"\u672A\u5B9E\u73B0getMapType\u65B9\u6CD5"}},{key:"lnglatToMercator",value:function(h,o){return this.options.coordinateSystem==="gcj02"?(o=o*Math.PI/180,o=31890685e-1*Math.log((1+Math.sin(o))/(1-Math.sin(o))),[parseFloat((h*Math.PI/180*6378137).toFixed(2)),parseFloat(o.toFixed(2))]):(h=Mr.convertLL2MC({lng:h,lat:o}),[h.lng,h.lat])}}]),l}(),Gu=function(l){function h(o){return Xe(this,h),o=_r(this,(h.__proto__||ur(h)).call(this,o)),o.eventMap={},o}return yr(h,l),Ue(h,[{key:"onResize",value:function(o){this.map.addEventListener("resize",o),this.eventMap.resize=o}},{key:"onMousemove",value:function(o){o=this.extendCallback(o),this.map.addEventListener("mousemove",o),this.eventMap.mousemove=o}},{key:"onClick",value:function(o){o=this.extendCallback(o),this.map.addEventListener("click",o),this.eventMap.click=o}},{key:"onDblClick",value:function(o){o=this.extendCallback(o),this.map.addEventListener("dblclick",o),this.eventMap.dblclick=o}},{key:"onRightClick",value:function(o){o=this.extendCallback(o),this.map.addEventListener("rightclick",o),this.eventMap.rightclick=o}},{key:"onUpdate",value:function(o){this.map.addEventListener("update",o),this.map.addEventListener("onearthstatuschange",o),this.eventMap.update=o,this.eventMap.onearthstatuschange=o}},{key:"extendCallback",value:function(o){return function(a){o(Vr(a,{x:a.x,y:a.y}))}}},{key:"unbind",value:function(o){var a=this;this.eventMap[o]?(this.map.removeEventListener(o,this.eventMap[o]),delete this.eventMap[o]):(bn(this.eventMap).forEach(function(y){a.map.removeEventListener(y,a.eventMap[y])}),this.eventMap={})}},{key:"getContainer",value:function(){return this.map.getContainer()}},{key:"getSize",value:function(){return this.map.getSize()}},{key:"getBounds",value:function(){return this.map.getBounds()}},{key:"getTilt",value:function(){return this.map.getTilt()}},{key:"getHeading",value:function(){return this.map.getHeading()}},{key:"getZoomUnits",value:function(){return this.map.getZoomUnits()}},{key:"getZoom",value:function(){return this.map.getZoom()}},{key:"getCenter",value:function(){var o=this.map.getCenter();return-180<=o.lng&&180>=o.lng&&(o=this.map.lnglatToMercator(o.lng,o.lat),o={lng:o[0],lat:o[1]}),o}},{key:"getMapType",value:function(){return this.map.getMapType()}},{key:"lnglatToMercator",value:function(o,a){return this.map.lnglatToMercator(o,a)}},{key:"mercatorToLnglat",value:function(o,a){return this.map.mercatorToLnglat(o,a)}},{key:"pixelToPointIn",value:function(o){return o=this.map.pixelToPointIn(o),this.mercatorToLnglat(o.lng,o.lat)}}]),h}(Hu),H1=function(l){function h(o){return Xe(this,h),o=_r(this,(h.__proto__||ur(h)).call(this,o)),o.div=document.createElement("div"),o.div.style.position="absolute",o.div.style.userSelect="none",o.map.getPanes().mapPane.appendChild(o.div),o.eventMap={},o}return yr(h,l),Ue(h,[{key:"onResize",value:function(o){this.map.addEventListener("resize",o),this.eventMap.resize=o}},{key:"onMousemove",value:function(o){o=this.extendCallback(o),this.map.addEventListener("mousemove",o),this.eventMap.mousemove=o}},{key:"onClick",value:function(o){o=this.extendCallback(o),ja?(this.map.addEventListener("touchend",o),this.eventMap.touchend=o):(this.map.addEventListener("click",o),this.eventMap.click=o)}},{key:"onDblClick",value:function(o){o=this.extendCallback(o),this.map.addEventListener("dblclick",o),this.eventMap.dblclick=o}},{key:"onRightClick",value:function(o){o=this.extendCallback(o),this.map.addEventListener("rightclick",o),this.eventMap.rightclick=o}},{key:"changeCanvas",value:function(){var o=this.map,a=o.getSize(),y=o.getCenter();o=o.pointToOverlayPixel(y),this.div.style.left=o.x-a.width/2+"px",this.div.style.top=o.y-a.height/2+"px"}},{key:"onUpdate",value:function(o){var a=this,y=function(){a.changeCanvas(),o()};this.map.addEventListener("moveend",y),this.map.addEventListener("moving",y),this.map.addEventListener("zoomend",y),this.eventMap.moveend=y,this.eventMap.moving=y,this.eventMap.zoomend=y}},{key:"extendCallback",value:function(o){return function(a){o(Vr(a,{x:a.pixel.x,y:a.pixel.y}))}}},{key:"unbind",value:function(){var o=this;bn(this.eventMap).forEach(function(a){o.map.removeEventListener(a,o.eventMap[a])}),this.eventMap={}}},{key:"getContainer",value:function(){return this.div}},{key:"getSize",value:function(){return this.map.getSize()}},{key:"getBounds",value:function(){return this.map.getBounds()}},{key:"getTilt",value:function(){return 0}},{key:"getHeading",value:function(){return 0}},{key:"getZoom",value:function(){return this.map.getZoom()}},{key:"getZoomUnits",value:function(){var o=this.getZoom();return this.map.getMapType().getZoomUnits?this.map.getMapType().getZoomUnits(o):Math.pow(2,18-o)}},{key:"getCenter",value:function(){var o=this.map.getMapType().getProjection().lngLatToPoint(this.map.getCenter());return{lng:o.x,lat:o.y}}},{key:"lnglatToMercator",value:function(o,a){return o=this.map.getMapType().getProjection().lngLatToPoint({lng:o,lat:a}),[o.x,o.y]}},{key:"mercatorToLnglat",value:function(o,a){return o=this.map.getMapType().getProjection().pointToLngLat({lng:o,lat:a}),[o.lng,o.lat]}}]),h}(Hu),G1=function(l){function h(o){return Xe(this,h),o=_r(this,(h.__proto__||ur(h)).call(this,o)),o.eventMap={},o}return yr(h,l),Ue(h,[{key:"onResize",value:function(o){window.addEventListener("resize",o),this.eventMap.resize=o}},{key:"onUpdate",value:function(o){}},{key:"unbind",value:function(){var o=this;bn(this.eventMap).forEach(function(a){window.removeEventListener(a,o.eventMap[a])}),this.eventMap={}}},{key:"getContainer",value:function(){return this.map.container.getElementsByClassName("cesium-widget")[0]}},{key:"getSize",value:function(){var o=this.map;return{width:o.canvas.clientWidth,height:o.canvas.clientHeight}}},{key:"getTilt",value:function(){return 180*this.map.camera.pitch/Math.PI+90}},{key:"getHeading",value:function(){return 360-180*this.map.camera.heading/Math.PI}},{key:"getZoomUnits",value:function(){var o=this.map;return 6.8*o.scene.globe.ellipsoid.cartesianToCartographic(o.camera.position).height/6500}},{key:"getZoom",value:function(){return 10}},{key:"getCenter",value:function(){var o=this.map;return o=o.camera.pickEllipsoid(new Cesium.Cartesian2(o.canvas.clientWidth/2,o.canvas.clientHeight/2)),o=Cesium.Ellipsoid.WGS84.cartesianToCartographic(o),o=this.getMercator([180*o.longitude/Math.PI,180*o.latitude/Math.PI]),{lng:o[0],lat:o[1]}}},{key:"getMercator",value:function(o){var a=[];return a[0]=o[0]*Math.PI/180*6378137,o=o[1]*Math.PI/180,a[1]=31890685e-1*Math.log((1+Math.sin(o))/(1-Math.sin(o))),a}}]),h}(Hu),$g=function(l){function h(o){return Xe(this,h),o=_r(this,(h.__proto__||ur(h)).call(this,o)),o.eventMap={},o}return yr(h,l),Ue(h,[{key:"onResize",value:function(o){window.addEventListener("resize",o),this.eventMap.resize=o}},{key:"onUpdate",value:function(o){}},{key:"unbind",value:function(){var o=this;bn(this.eventMap).forEach(function(a){window.removeEventListener(a,o.eventMap[a])}),this.eventMap={}}},{key:"getContainer",value:function(){return this.map.container}},{key:"getSize",value:function(){return{width:this.map.container.clientWidth,height:this.map.container.clientHeight}}},{key:"getTilt",value:function(){return this.map.tilt}},{key:"getHeading",value:function(){return this.map.heading}},{key:"getZoomUnits",value:function(){return this.map.zoomUnits}},{key:"getZoom",value:function(){return this.map.zoom}},{key:"getCenter",value:function(){return this.map.center}}]),h}(Hu),tv=function(l){function h(o,a){return Xe(this,h),o=_r(this,(h.__proto__||ur(h)).call(this,o,a)),o.eventMap={},o}return yr(h,l),Ue(h,[{key:"onResize",value:function(o){window.addEventListener("resize",o),this.eventMap.resize=o}},{key:"onUpdate",value:function(o){}},{key:"unbind",value:function(){var o=this;bn(this.eventMap).forEach(function(a){window.removeEventListener(a,o.eventMap[a])}),this.eventMap={}}},{key:"getContainer",value:function(){return this.map.container}},{key:"getSize",value:function(){return{width:this.map.container.clientWidth,height:this.map.container.clientHeight}}},{key:"getTilt",value:function(){return this.map.tilt}},{key:"getHeading",value:function(){return this.map.heading}},{key:"getZoomUnits",value:function(){return this.map.zoomUnits}},{key:"getCenter",value:function(){return this.map.center}}]),h}(Hu),ev=function(){function l(h,o){var a=this;Xe(this,l),o=o||{},o.mapType==="bmap"?this.map=new H1(h,o):o.mapType==="blank"?this.map=new $g(h,o):o.mapType==="cesium"?this.map=new G1(h,o):o.mapType==="three"?this.map=new tv(h,o):(o.mapType="bmapgl",this.map=new Gu(h,o)),this.map.type=o.mapType,this._dpr=window.devicePixelRatio,o.mapType==="bmapgl"&&(this._dpr=this.map.map.config.ratio),this.options=o||{},this.renderArr=[],(h=o.canvas)||(h=document.createElement("canvas")),this.canvas=h,this.gl=o.gl?o.gl:wh(h,o),["OES_texture_float","OES_element_index_uint","WEBGL_color_buffer_float","EXT_float_blend"].forEach(function(y){a.gl.getExtension(y)}),this.changeSize(),this.projectionMatrix=Ke.create(Float64Array),this.orthoMatrix=Ke.create(Float64Array),this.matrix=Ke.create(Float64Array),this.viewMatrix=Ke.create(Float64Array),this.pointToPixelMatrix=Ke.create(Float64Array),this.pixelToViewMatrix=Ke.create(Float64Array),this.fovy=35,this.fps=Math.min(o.fps,60)||60,this.renderTime=new Date().valueOf(),this._animation=this.animation.bind(this),this._update=this.update.bind(this),this.onInitialize(this.options.onInitialize),this.options.onRender&&this.renderArr.push(this.options.onRender),this.stateManager=new Jg({gl:this.gl}),this.pickFBO=new Zn(this.gl),this.transferOptions={},this.bind()}return Ue(l,[{key:"bind",value:function(){var h=this,o=this.map;o.onResize(function(){h.changeSize(),h.render()}),o.onUpdate(this._update),o.onClick&&o.onClick(function(a){h.onClick&&h.onClick(a)}),o.onDblClick&&o.onDblClick(function(a){h.onDblClick&&h.onDblClick(a)}),o.onRightClick&&o.onRightClick(function(a){h.onRightClick&&h.onRightClick(a)}),o.onMousemove&&o.onMousemove(function(a){h.onMousemove&&h.onMousemove(a)}),this.options.canvas||o.getContainer().appendChild(this.canvas)}},{key:"unbind",value:function(){var h=this.map;h.unbind&&h.unbind()}},{key:"setOptions",value:function(h){this.options=h}},{key:"onInitialize",value:function(h){h&&(this.transferOptions=h.bind(this)(this.gl)||{})}},{key:"bindFramebuffer",value:function(h){var o=this.gl;h?o.bindFramebuffer(o.FRAMEBUFFER,h.framebuffer):o.bindFramebuffer(o.FRAMEBUFFER,null)}},{key:"saveFramebuffer",value:function(){var h=this.gl;this.preFramebuffer=h.getParameter(h.FRAMEBUFFER_BINDING)}},{key:"restoreFramebuffer",value:function(){var h=this.gl;h.bindFramebuffer(h.FRAMEBUFFER,this.preFramebuffer)}},{key:"onRender",value:function(h){this.renderArr.push(h)}},{key:"changeSize",value:function(){var h=this.canvas,o=this.options;if(h){var a=h.style,y=this.map.getSize(),g=this._dpr;h.width=y.width*g,h.height=y.height*g,a.cssText="position: absolute;left:0;top:0;width:"+y.width+"px;height:"+y.height+"px;z-index:2;",o.mapType!=="cesium"||o.canvas||(a.pointerEvents="none"),this.gl.viewport(0,0,h.width,h.height)}}},{key:"update",value:function(){this.options.autoUpdate===!1||this.isAnimation&&60<=this.fps||this.render()}},{key:"pixelToPointIn",value:function(h){return this.map.pixelToPointIn(h)}},{key:"render",value:function(){if(this.map&&this.gl){var h=this.options,o=this.projectionMatrix,a=this.viewMatrix;if(h.mapType==="three")a=this.map.map.camera,o=a.projectionMatrix.elements,a=a.matrixWorldInverse.elements;else if(h.mapType==="cesium"){a=this.map.map;var y=a.camera.frustum.projectionMatrix;o=new Float32Array([y[0],y[1],y[2],y[3],y[4],y[5],y[6],y[7],y[8],y[9],y[10],y[11],y[12],y[13],y[14],y[15]]),y=a.camera.viewMatrix,a=new Float32Array([y[0],y[1],y[2],y[3],y[4],y[5],y[6],y[7],y[8],y[9],y[10],y[11],y[12],y[13],y[14],y[15]])}else this.map.map.mapType==="B_EARTH_MAP"?(o=this.map.map.getEarth().scene._camera.getProjectionMatrix(),a=this.map.map.getEarth().scene._camera.getModelViewMatrix()):(this.updateProjectionMatrix(),this.updateModelViewMatrix());for(y=Ke.multiply(this.matrix,o,a),Vr(this.transferOptions,{gl:this.gl,matrix:y,pointToPixelMatrix:this.pointToPixelMatrix,pixelToViewMatrix:this.pixelToViewMatrix,projectionMatrix:o,orthoMatrix:this.orthoMatrix,viewMatrix:a,stateManager:this.stateManager}),h.mapType!=="three"&&h.mapType!=="cesium"&&h.autoUpdate!==!1&&this.clear(),h=0;h<this.renderArr.length;h++)this.renderArr[h]&&this.renderArr[h].bind(this)(this.transferOptions)}}},{key:"clear",value:function(h){var o=this.gl,a=this.options.clearColor||[0,0,0,0];o.clearColor(a[0],a[1],a[2],a[3]),h&&(h instanceof Array||(h=Jt(h).unitArray()),o.clearColor(h[0],h[1],h[2],h[3])),o.clear(o.COLOR_BUFFER_BIT|o.DEPTH_BUFFER_BIT)}},{key:"updateProjectionMatrix",value:function(){var h=this.gl.canvas.width/this.gl.canvas.height,o=this.options.cameraNear||1,a=this.options.cameraFar||4e3;Ke.perspective(this.projectionMatrix,ye(this.fovy),h,o,a),h=this.map.getSize(),Ke.ortho(this.orthoMatrix,-h.width/2,h.width/2,-h.height/2,h.height/2,o,a)}},{key:"updateModelViewMatrix",value:function(){var h=this.map,o=this.viewMatrix,a=this.pointToPixelMatrix,y=this.pixelToViewMatrix;Ke.identity(o),Ke.identity(a),Ke.identity(y);var g=h.getSize();g=Math.round(-g.height/(2*Math.tan(ye(this.fovy)/2))),Ke.translate(y,y,[0,0,g]),Ke.rotate(y,y,ye(h.getTilt()),[-1,0,0]),Ke.rotate(y,y,ye(h.getHeading()),[0,0,-1]),g=h.getCenter();var x=this.options.pointOffset||[0,0];h=h.getZoomUnits(),Ke.translate(a,a,[(x[0]-g.lng)/h,(x[1]-g.lat)/h,0]),h=1/h,Ke.scale(a,a,[h,h,h]),Ke.multiply(o,y,a)}},{key:"destroy",value:function(){this.stopAnimation(),this.unbind();var h=this.gl.getExtension("WEBGL_lose_context");h&&h.loseContext(),this.map.getContainer().removeChild(this.canvas),this.gl=this.canvas=null}},{key:"animation",value:function(){if(this.isAnimation){if(60<=this.fps)this.render();else{var h=new Date().valueOf(),o=Math.floor(1e3/this.fps),a=h-this.renderTime;a>o&&(this.render(),this.renderTime=h-a%o)}window.requestAnimationFrame(this._animation)}}},{key:"startAnimation",value:function(){this.isAnimation||(this.isAnimation=!0,window.requestAnimationFrame(this._animation))}},{key:"stopAnimation",value:function(){this.isAnimation=!1}}]),l}(),rv=function(){function l(h){Xe(this,l),this.layers=[],this.options=h,this.webglLayer=h.webglLayer}return Ue(l,[{key:"addLayer",value:function(h){for(var o=!1,a=0;a<this.layers.length;a++)if(this.layers[a]===h){o=!0;break}o||(h.map=this.webglLayer.map,h.layerType==="threeLayer"?(h.setWebglLayer(this.webglLayer),o=h.getThreeLayer(),this.addLayer(o),h.initialize&&h.initialize(o)):(h.setWebglLayer(this.webglLayer),h.commonInitialize&&h.commonInitialize(this.webglLayer.gl),h.initialize&&h.initialize(this.webglLayer.gl),h.onOptionsChanged(h.getOptions(),{}),h.onDataChanged(h.getData()),h.onChanged(h.getOptions(),h.getData())),this.putInLayer(h)),this.options.autoUpdate&&(this.isRequestAnimation()?this.webglLayer.startAnimation():this.webglLayer.stopAnimation()),this.webglLayer.render()}},{key:"putInLayer",value:function(h){h.options.renderOrder===void 0&&(h.options.renderOrder=this.layers.length),this.layers.push(h),this.layers=this.layers.sort(function(o,a){return o.options.renderOrder-a.options.renderOrder})}},{key:"removeLayer",value:function(h){for(var o=0;o<this.layers.length;o++)this.layers[o]===h&&this.layers.splice(o,1);this.options.autoUpdate&&(this.isRequestAnimation()?this.webglLayer.startAnimation():this.webglLayer.stopAnimation()),this.webglLayer.render()}},{key:"showLayer",value:function(h){for(var o=0;o<this.layers.length;o++)this.layers[o]===h&&h.show();this.options.autoUpdate&&(this.isRequestAnimation()?this.webglLayer.startAnimation():this.webglLayer.stopAnimation()),this.webglLayer.render()}},{key:"hideLayer",value:function(h){for(var o=0;o<this.layers.length;o++)this.layers[o]===h&&h.hide();this.options.autoUpdate&&(this.isRequestAnimation()?this.webglLayer.startAnimation():this.webglLayer.stopAnimation()),this.webglLayer.render()}},{key:"removeAllLayers",value:function(){this.layers=[],this.webglLayer.stopAnimation(),this.webglLayer.render()}},{key:"destroyAllLayers",value:function(){for(var h=0;h<this.layers.length;h++){var o=this.layers[h];o.destroy&&o.destroy()}}},{key:"getAllLayers",value:function(){return this.layers}},{key:"getAllThreeLayers",value:function(){for(var h=[],o=0;o<this.layers.length;o++){var a=this.layers[o];a.layerType==="ThreeLayer"&&h.push(a)}return h}},{key:"isRequestAnimation",value:function(){for(var h=!1,o=0;o<this.layers.length;o++)if(this.layers[o].isRequestAnimation()){h=!0;break}return h}},{key:"beforeRender",value:function(h){h.gl&&this.webglLayer.stateManager.setDefaultState()}},{key:"afterRender",value:function(h){(h=h.gl)&&(h.bindBuffer(h.ARRAY_BUFFER,null),h.bindBuffer(h.ELEMENT_ARRAY_BUFFER,null),h.useProgram(null))}},{key:"renderGLLayers",value:function(h){this.webglLayer.stateManager.save();for(var o=0;o<this.layers.length;o++){var a=this.layers[o];if(a._visible===!0&&a.layerType!=="threeLayer"&&a.layerType!=="ThreeLayer"){var y=a.map.getZoom(),g=a.getOptions().zoomThreshold;g&&(y<g[0]||y>=g[1])||(this.beforeRender(h),a.render(h),this.afterRender(h))}}this.webglLayer.stateManager.restore()}},{key:"renderThreeLayer",value:function(h){this.webglLayer.stateManager.save(),this.webglLayer.stateManager.setState({blendFunc:[h.gl.SRC_ALPHA,h.gl.ONE],depthMask:!1,depthTest:!0,depthFunc:h.gl.LESS,cullFace:!1});for(var o=0;o<this.layers.length;o++){var a=this.layers[o];if(a._visible===!0&&a.layerType==="ThreeLayer"){var y=a.map.getZoom(),g=a.getOptions().zoomThreshold;g&&(y<g[0]||y>=g[1])||a.render(h)}}this.webglLayer.stateManager.restore()}},{key:"renderThreeLayers",value:function(h){this.webglLayer.stateManager.save(),this.webglLayer.stateManager.setState({blendFunc:[h.gl.SRC_ALPHA,h.gl.ONE],depthMask:!1,depthTest:!0,depthFunc:h.gl.LESS,cullFace:!1});for(var o=0;o<this.layers.length;o++){var a=this.layers[o];if(a._visible===!0&&a.layerType==="threeLayer"){var y=a.map.getZoom(),g=a.getOptions().zoomThreshold;g&&(y<g[0]||y>=g[1])||a.render(h)}}this.webglLayer.stateManager.restore()}},{key:"onClick",value:function(h){for(var o=0;o<this.layers.length;o++){var a=this.layers[o];if(a._visible===!0&&a.layerType!=="threeLayer"&&a.layerType!=="ThreeLayer"){var y=a.map.getZoom(),g=a.getOptions().zoomThreshold;g&&(y<=g[0]||y>=g[1])||!a.options.enablePicked||!a.options.onClick||!a.pick||(y=a.pick(h.x,h.y),a.options.onClick(y,h),a.options.autoSelect&&this.webglLayer.render())}}}},{key:"onDblClick",value:function(h){for(var o=0;o<this.layers.length;o++){var a=this.layers[o];if(a._visible===!0&&a.layerType!=="threeLayer"&&a.layerType!=="ThreeLayer"){var y=a.map.getZoom(),g=a.getOptions().zoomThreshold;g&&(y<=g[0]||y>=g[1])||!a.options.enablePicked||!a.options.onDblClick||!a.pick||(y=a.pick(h.x,h.y),a.options.onDblClick(y,h),a.options.autoSelect&&this.webglLayer.render())}}}},{key:"onRightClick",value:function(h){for(var o=0;o<this.layers.length;o++){var a=this.layers[o];if(a._visible===!0&&a.layerType!=="threeLayer"&&a.layerType!=="ThreeLayer"){var y=a.map.getZoom(),g=a.getOptions().zoomThreshold;g&&(y<=g[0]||y>=g[1])||!a.options.enablePicked||!a.options.onRightClick||!a.pick||(y=a.pick(h.x,h.y),a.options.onRightClick(y,h),a.options.autoSelect&&this.webglLayer.render())}}}},{key:"onMousemove",value:function(h){for(var o=!1,a=0;a<this.layers.length;a++){var y=this.layers[a];if(y._visible===!0&&y.layerType!=="threeLayer"&&y.layerType!=="ThreeLayer"){var g=y.map.getZoom(),x=y.getOptions().zoomThreshold;(!x||!(g<=x[0]||g>=x[1]))&&y.options.enablePicked&&y.pick&&(y.options.onMousemove||y.options.autoSelect)&&(g=y.pick(h.x,h.y),this.webglLayer.map.map.platform.style.cursor=g.dataIndex===-1?"default":"pointer",y.options.onMousemove&&y.options.onMousemove(g,h),y.options.autoSelect&&(o=!0))}}o&&(this.webglLayer.isAnimation||this.webglLayer.render())}},{key:"destroy",value:function(){this.destroyAllLayers(),this.removeAllLayers()}}]),l}(),Xl=function(){function l(h){var o=this;Xe(this,l),this.options={autoUpdate:!0},this._visible=!0,Vr(this.options,h);var a=h.pointOffset;this.webglLayer=h.webglLayer||new ev(h.map,this.options),this.layerManager=new rv({autoUpdate:this.options.autoUpdate,webglLayer:this.webglLayer}),this.effectManager=new $h(this.webglLayer.gl),this.webglRender={render:function(){}},this.options.effects&&this.effectManager.setEffects([this.webglRender].concat(this.options.effects)),this.webglLayer.onRender(function(y){o._render(y)}),this.webglLayer.onClick=function(y){o._visible&&o.layerManager.onClick(y)},this.webglLayer.onDblClick=function(y){o._visible&&o.layerManager.onDblClick(y)},this.webglLayer.onRightClick=function(y){o._visible&&o.layerManager.onRightClick(y)},this.webglLayer.onMousemove=function(y){o._visible&&o.layerManager.onMousemove(y)},a||this.webglLayer.options.mapType==="cesium"||(a=this.webglLayer.map.getCenter(),this.webglLayer.options.pointOffset=[a.lng,a.lat]),this.webglLayer.map.onResize(function(){o.effectManager.onResize()}),(this.postProcessing=h.postProcessing)&&(this.postProcessing.setWebglLayer(this.webglLayer),h=this.postProcessing.getThreeLayer(),this.addLayer(h),this.postProcessing.initialize(h),h.postProcessing=this.postProcessing)}return Ue(l,[{key:"renderCanvas",value:function(h){var o=this;this.postProcessing?this.postProcessing.addRender(function(){o.layerManager.renderGLLayers(h)}):this.layerManager.renderGLLayers(h),this.layerManager.renderThreeLayers(h),this.layerManager.renderThreeLayer(h)}},{key:"render",value:function(){this.webglLayer&&this.webglLayer.render()}},{key:"_render",value:function(h){var o=this;if(this._visible){var a=this.options.effects;a&&0<a.length?(this.webglRender.render=function(){o.renderCanvas(h)},this.effectManager.render()):(this.webglLayer.saveFramebuffer(),this.renderCanvas(h),this.webglLayer.restoreFramebuffer())}}},{key:"onRender",value:function(h){this.webglLayer.onRender(h)}},{key:"destroy",value:function(){this.stopAnimation(),this.layerManager.destroy(),this.effectManager.destroy(),this.webglLayer.destroy()}},{key:"isRequestAnimation",value:function(){return this.layerManager.isRequestAnimation()}},{key:"startAnimation",value:function(){this.webglLayer.startAnimation()}},{key:"stopAnimation",value:function(){this.webglLayer.stopAnimation()}},{key:"show",value:function(){this._visible!==!0&&(this._visible=!0,this.webglLayer.render(),this.isRequestAnimation()&&this.startAnimation())}},{key:"hide",value:function(){this._visible!==!1&&(this._visible=!1,this.stopAnimation(),this.webglLayer.clear())}},{key:"showLayer",value:function(h){this.layerManager.showLayer(h)}},{key:"hideLayer",value:function(h){this.layerManager.hideLayer(h)}},{key:"add",value:function(h){this.addLayer(h)}},{key:"remove",value:function(h){this.removeLayer(h)}},{key:"addLayer",value:function(h){this.layerManager.addLayer(h)}},{key:"removeLayer",value:function(h){this.layerManager.removeLayer(h)}},{key:"removeAllLayers",value:function(){this.layerManager.removeAllLayers()}},{key:"getAllLayers",value:function(){return this.layerManager.getAllLayers()}},{key:"getAllThreeLayers",value:function(){return this.layerManager.getAllThreeLayers()}}]),l}(),ca=function(){function l(h){Xe(this,l),this._visible=!0,this.options=this.getCommonDefaultOptions(),this.options=Vr(this.options,this.getDefaultOptions()),this.autoUpdate=!1,this.options=Vr(this.options,h),this.options.data&&(this.data=this.options.data,delete this.options.data)}return Ue(l,[{key:"getCommonDefaultOptions",value:function(){return{}}},{key:"getDefaultOptions",value:function(){return{}}},{key:"initialize",value:function(h){}},{key:"destroy",value:function(){this.onDestroy&&this.onDestroy()}},{key:"show",value:function(){this._visible=!0}},{key:"hide",value:function(){this._visible=!1}},{key:"render",value:function(){}},{key:"clear",value:function(){this.setData([])}},{key:"setData",value:function(h,o){o=o||{},this.data=h,this.onDataChanged&&this.onDataChanged(this.getData()),this.onChanged&&this.onChanged(this.getOptions(),this.getData(),o),o.autoRender!==!1&&this.webglLayer&&this.webglLayer.render()}},{key:"getData",value:function(){return this.data||[]}},{key:"setOptions",value:function(h,o){h=h||{},o=o||{};var a=Vr({},this.getOptions());Vr(this.options,h),this.onOptionsChanged&&this.onOptionsChanged(this.getOptions(),a),this.onChanged&&this.onChanged(this.getOptions(),this.getData(),o),h.data?(this.setData(h.data,o),delete h.data):o.autoRender!==!1&&this.webglLayer&&this.webglLayer.render()}},{key:"getOptions",value:function(){return this.options||{}}},{key:"onOptionsChanged",value:function(h,o){}},{key:"onDataChanged",value:function(h){}},{key:"onChanged",value:function(h,o){}},{key:"onDestroy",value:function(){}},{key:"lnglatToMercator",value:function(h,o){}},{key:"setWebglLayer",value:function(h){this.webglLayer=h}},{key:"getWebglLayer",value:function(){return this.webglLayer}},{key:"isRequestAnimation",value:function(){return this.autoUpdate}}]),l}(),Ci=function(l){function h(o){return Xe(this,h),o=_r(this,(h.__proto__||ur(h)).call(this,o)),o.pickedColor=[-1,-1,-1],o}return yr(h,l),Ue(h,[{key:"getCommonDefaultOptions",value:function(){return{blend:"default",zIndex:0,zoomThreshold:[0,30],repeat:!1,enablePicked:!1,autoSelect:!1,selectedIndex:-1,selectedColor:"rgba(20, 20, 200, 1.0)"}}},{key:"commonInitialize",value:function(o){var a=this.getOptions();this.gl=o,a.enablePicked&&(this.pickBuffer=new qe({gl:o,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}))}},{key:"getCommonAttributes",value:function(){var o=[];return this.getOptions().enablePicked&&o.push({name:"aPickColor",buffer:this.pickBuffer,size:3,type:"FLOAT",stride:12,offset:0}),o}},{key:"getProperty",value:function(o,a,y){return Object.prototype.toString.call(a)==="[object Function]"?a(y):(a=y[o]||a,"properties"in y&&o in y.properties&&(a=y.properties[o]),a)}},{key:"normizedColor",value:function(o){var a=o;return o instanceof Array||(a=Jt(o).unitArray()),a[3]===void 0&&(a[3]=1),a}},{key:"normizedPoint",value:function(o){var a=this.getPointOffset();if(!o||!o[0]||!o[1])return[a[0],a[1],0];var y=Number(o[0]),g=Number(o[1]);-180<=y&&180>=y&&-90<=g&&90>=g&&(g=this.webglLayer.map.lnglatToMercator(y,g),y=g[0],g=g[1]);var x=Number(o[2])||0;return this.webglLayer&&this.webglLayer.options.mapType==="cesium"&&window.Cesium?(y=this.convertLngLat([y,g]),x=window.Cesium.Cartesian3.fromDegrees(y[0],y[1],x),y=x.x,g=x.y,x=x.z):this.webglLayer&&this.webglLayer.options.mapType==="bmapgl"&&this.webglLayer.map.map.mapType==="B_EARTH_MAP"&&(y=this.convertLngLat([y,g]),x=this.webglLayer.map.map.getEarth().scene.fromLatLngToXYZ({lng:y[0],lat:y[1]}),y=x.x,g=x.y,x=x.z),3<o.length?[y-a[0],g-a[1],x].concat(Wr(o.slice(3))):[y-a[0],g-a[1],x]}},{key:"convertLngLat",value:function(o){return[o[0]/2003750834e-2*180,180/Math.PI*(2*Math.atan(Math.exp(o[1]/2003750834e-2*180*Math.PI/180))-Math.PI/2)]}},{key:"getPointOffset",value:function(){var o=[0,0],a=this.getOptions();return this.webglLayer&&this.webglLayer.options.pointOffset?o=this.webglLayer.options.pointOffset:a.pointOffset&&(o=a.pointOffset),o}},{key:"indexToRgb",value:function(o){o++;var a=Math.floor(o/65536);o-=65536*a;var y=Math.floor(o/256);return[o-256*y,y,a]}},{key:"rgbToIndex",value:function(o){return o[0]+256*o[1]+65536*o[2]-1}},{key:"getCommonUniforms",value:function(o){o=o.isPickRender;var a=this.getOptions(),y={};if(a.enablePicked){var g=0<=a.selectedIndex?a.selectedIndex:-1;g=a.autoSelect?this.pickedColor:this.indexToRgb(g),y=Vr(y,{uSelectedColor:this.normizedColor(a.selectedColor),uEnablePicked:a.enablePicked,uPickedColor:g.map(function(x){return x/255}),uIsPickRender:!!o})}return y}},{key:"pick",value:function(o,a){var y=this.gl,g=this.webglLayer._dpr;this.webglLayer.saveFramebuffer(),this.webglLayer.bindFramebuffer(this.webglLayer.pickFBO),this.webglLayer.clear(),this.render({gl:y,isPickRender:!0,matrix:this.webglLayer.matrix,projectionMatrix:this.webglLayer.projectionMatrix,viewMatrix:this.webglLayer.viewMatrix,orthoMatrix:this.webglLayer.orthoMatrix});var x=new Uint8Array(4);return y.readPixels(o*g,y.canvas.height-a*g,1,1,y.RGBA,y.UNSIGNED_BYTE,x),o=this.rgbToIndex(x),this.pickAfter&&(o=this.pickAfter(x,o+1)),a=this.getData(),this.pickedColor=[x[0],x[1],x[2]],this.webglLayer.restoreFramebuffer(),{dataIndex:o,dataItem:a[o]}}},{key:"setGLState",value:function(o){this.webglLayer.stateManager.setState(o,this.options)}},{key:"addMultipleCoords",value:function(o,a,y){if(!this.options.repeat||!this.webglLayer||this.webglLayer.options.mapType!=="bmapgl"||this.webglLayer.map.map.mapType==="B_EARTH_MAP")return[o];var g=this.webglLayer.map.map;a=a||g.getZoom();var x=y?g.worldSize(a):4007545274461451e-8;if(a=function(B){return[[B[0]-x,B[1],B[2]||0],[B[0]+x,B[1],B[2]||0]]},o instanceof Array&&!(o[0]instanceof Array))return a=a(o),a=Ri(a,2),[o,a[0],a[1]];if(o instanceof Array&&o[0]instanceof Array&&!(o[0][0]instanceof Array)){y=[],g=[];for(var v=0;v<o.length;v++){var M=a(o[v]);M=Ri(M,2);var D=M[1];y.push(M[0]),g.push(D)}return[o,y,g]}for(y=[],g=[],v=0;v<o.length;v++){M=[],D=[];for(var U=0;U<o[v].length;U++){var C=a(o[v][U]);C=Ri(C,2);var L=C[1];M.push(C[0]),D.push(L)}y.push(M),g.push(D)}return[o,y,g]}}]),h}(ca),V1=function(l){function h(o){return Xe(this,h),o=_r(this,(h.__proto__||ur(h)).call(this,o)),o.name="CircleLayer",o.bufferData=[],o.initializeTime=new Date,o}return yr(h,l),Ue(h,[{key:"getDefaultOptions",value:function(){return{depthWrite:!0,depthTest:!0,size:10,unit:"px",color:"blue",borderWidth:0,borderColor:"#000000",antialias:!0}}},{key:"initialize",value:function(o){this.gl=o;var a=this.getOptions();this.program=new jr(this.gl,{vertexShader:`attribute vec3 aPos;attribute float aSize;attribute float aIndex;attribute vec4 aColor;attribute float aBorderWidth;attribute vec4 aBorderColor;varying vec4 vColor;varying vec3 vPosition;varying vec3 vFragPosition;varying float vSize;varying float vBorderWidth;varying vec4 vBorderColor;uniform mat4 uMatrix;uniform float uZoomUnits;uniform vec4 uSelectedColor;void main(){vColor=aColor;vBorderWidth=aBorderWidth*uZoomUnits;vBorderColor=aBorderColor;float x=aPos.x;float y=aPos.y;float z=aPos.z*uZoomUnits;vSize=aSize*uZoomUnits+vBorderWidth;if(aIndex==1.0){x+=vSize;y-=vSize;}else if(aIndex==2.0){x-=vSize;y+=vSize;}else if(aIndex==3.0){x+=vSize;y+=vSize;}else{x-=vSize;y-=vSize;}vPosition=aPos;vFragPosition=vec3(x,y,z);gl_Position=uMatrix*vec4(vFragPosition,1.0);
#if defined(PICK)
if(mapvIsPicked()){vColor=uSelectedColor;}
#endif
}`,fragmentShader:"varying vec3 vPosition;varying float vSize;varying vec3 vFragPosition;varying vec4 vColor;varying float vBorderWidth;varying vec4 vBorderColor;uniform mat4 uMatrix;uniform float uTime;uniform float duration;uniform float trail;uniform float lineWidth;uniform float uAntiAliasing;void main(){float d=distance(vFragPosition.xy,vPosition.xy);if(d>vSize){discard;}vec4 color=vColor;float r=vSize-vBorderWidth;if(vBorderWidth>0.0){if(d>r){color=vBorderColor;}else if(uAntiAliasing==1.0&&d>0.95*r){color=vBorderColor;float st=1.0-smoothstep(0.95*r,r,d);color.r+=(vColor.r-vBorderColor.r)*st;color.g+=(vColor.g-vBorderColor.g)*st;color.b+=(vColor.b-vBorderColor.b)*st;color.a+=(vColor.a-vBorderColor.a)*st;}}if(uAntiAliasing==1.0&&d>0.95*vSize&&d<=vSize){color.a*=1.0-smoothstep(0.95*vSize,vSize,d);}gl_FragColor=color;}",defines:a.enablePicked?["PICK"]:[]},this),this.buffer=new qe({gl:o,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.indexBuffer=new qe({gl:o,target:"ELEMENT_ARRAY_BUFFER",usage:"STATIC_DRAW"}),a=Float32Array.BYTES_PER_ELEMENT;var y=14*a;a=[{stride:y,name:"aPos",buffer:this.buffer,size:3,type:"FLOAT",offset:0},{stride:y,name:"aSize",buffer:this.buffer,size:1,type:"FLOAT",offset:3*a},{stride:y,name:"aIndex",buffer:this.buffer,size:1,type:"FLOAT",offset:4*a},{stride:y,name:"aColor",buffer:this.buffer,size:4,type:"FLOAT",offset:5*a},{stride:y,name:"aBorderWidth",buffer:this.buffer,size:1,type:"FLOAT",offset:9*a},{stride:y,name:"aBorderColor",buffer:this.buffer,size:4,type:"FLOAT",offset:10*a}],a=a.concat(this.getCommonAttributes()),this.vertexArray=new bi({gl:o,program:this.program,attributes:a})}},{key:"onChanged",value:function(o,a){this.gl&&a&&(this.uniforms={},this.data=a,this.processData(),o.enablePicked&&this.parsePickData(a))}},{key:"processData",value:function(){var o=this,a=[],y=[];this.data.forEach(function(g,x){var v=g.properties||{},M=function(O){return g[O]||v[O]||o.options[O]},D=M("color"),U=M("size"),C=M("borderWidth");M=M("borderColor"),D=o.normizedColor(D),M=o.normizedColor(M);for(var L=o.normizedPoint(g.geometry.coordinates),B=0;4>B;B++)a.push(L[0],L[1],L[2]||0,U,B),a.push(D[0],D[1],D[2],D[3]),a.push(C,M[0],M[1],M[2],M[3]);D=4*x,0<x&&y.push(D-1,D),y.push(D,D+1,D+2,D+3)}),this.bufferData=a,this.indexData=y,this.buffer.updateData(new Float32Array(a)),this.indexBuffer.updateData(new Uint32Array(y))}},{key:"parsePickData",value:function(o){var a=[];if(this.getOptions().enablePicked){for(var y=0;y<o.length;y++){var g=this.indexToRgb(y);a.push(g[0]/255,g[1]/255,g[2]/255),a.push(g[0]/255,g[1]/255,g[2]/255),a.push(g[0]/255,g[1]/255,g[2]/255),a.push(g[0]/255,g[1]/255,g[2]/255)}this.pickBuffer.updateData(new Float32Array(a))}}},{key:"render",value:function(o){var a=this.getOptions(),y=this.program,g=o.gl,x=o.matrix;this.setGLState({blend:!0,blendEquation:g.FUNC_ADD,blendFunc:$s(g,a.blend||"lighter"),depthTest:a.depthTest,depthMask:a.depthWrite}),y.use(g),this.vertexArray.bind(),this.indexBuffer.bind(),a=this.map.getZoomUnits(),Vr(this.uniforms,this.getCommonUniforms(o),{uZoomUnits:this.options.unit==="px"?a:1,uMatrix:x,uAntiAliasing:this.options.antialias?1:0}),y.setUniforms(this.uniforms),g.drawElements(g.TRIANGLE_STRIP,this.indexData.length,g.UNSIGNED_INT,0)}}]),h}(Ci),W1={wave:"varying vec4 vPosition;varying float vSize;varying vec4 vFragPosition;varying vec4 vColor;varying float vStartTime;varying float vRadius;uniform mat4 uMatrix;uniform float uTime;uniform float duration;uniform float trail;uniform float uAntiAliasing;varying float vWidth;void main(){float d=distance(vFragPosition.xy,vPosition.xy);if(d>=vRadius){discard;}vec4 color=vColor;float R=vRadius;float center=vSize;float time=vStartTime+uTime;float alpha=sin((R-d)/R*trail*2.0*3.14+time/duration);if(d<=center){if(uAntiAliasing==1.0&&d>0.9*center&&d<=center){if(alpha>=0.5){color.a=0.9;}else{color.a=1.0-smoothstep(0.9*center,center,d);}}}else{if(alpha>=0.5){color.a=0.9;if(uAntiAliasing==1.0){if(alpha>=0.5&&alpha<=0.6){color.a*=smoothstep(0.0,0.1,alpha-0.5);}if(d>=0.98*R&&d<=R){color.a*=1.0-smoothstep(0.98,1.0,d/R);}}}else{color.a=0.0;}}gl_FragColor=color;}",bubble:"varying vec4 vPosition;varying float vSize;varying vec4 vFragPosition;varying vec4 vColor;varying float vStartTime;varying float vRadius;uniform mat4 uMatrix;uniform float uTime;uniform float duration;uniform float trail;uniform float uAntiAliasing;varying float vWidth;void main(){float d=distance(vFragPosition.xy,vPosition.xy);if(d>=vRadius){discard;}float time=vStartTime+uTime;float range=mod(time,(duration+trail));float percent=0.0;if(range<=duration){percent=range/duration;}else{percent=1.0;}float center=vSize;float R=vRadius;float r=R*percent;vec4 color=vColor;if(d<=center){if(uAntiAliasing==1.0&&d>0.9*center&&d<=center){color.a=1.0-smoothstep(0.9*center,center,d);}}else{if(d<r){color.a=smoothstep(0.1,0.9,pow(d/r,2.0)*0.9);if(uAntiAliasing==1.0&&d>=0.9*r&&d<=r){color.a*=1.0-smoothstep(0.9,1.0,d/r);}if(range>duration){color.a*=1.0-(range-duration)/trail;}}else{color.a=0.0;}}gl_FragColor=color;}",breath:"varying vec4 vPosition;varying vec4 vFragPosition;varying vec4 vColor;varying float vStartTime;varying float vRadius;uniform float uTime;uniform float duration;uniform float trail;uniform float uAntiAliasing;void main(){float d=distance(vFragPosition.xy,vPosition.xy);if(d>=vRadius){discard;}vec4 color=vColor;if(uAntiAliasing==1.0&&d>0.9*vRadius&&d<=vRadius){color.a=1.0-smoothstep(0.9*vRadius,vRadius,d);}float time=vStartTime+uTime;float range=mod(time,(duration+trail));float percent=0.0;if(range<=duration){percent=range/duration;}else{percent=1.0;}color.a*=abs(1.0-percent*2.0)+0.2;gl_FragColor=color;}",radar:"varying vec4 vPosition;varying float vSize;varying vec4 vFragPosition;varying vec4 vColor;varying float vStartTime;varying float vRadius;uniform mat4 uMatrix;uniform float uTime;uniform float duration;uniform float trail;uniform float uAntiAliasing;varying float vWidth;void main(){float d=distance(vFragPosition.xy,vPosition.xy);if(d>=vRadius){discard;}float time=vStartTime+uTime;float range=mod(time,duration);float percent=range/duration;float center=vSize;float startDeg=360.0*percent;vec4 color=vColor;float deltaX=vFragPosition.x-vPosition.x;float deltaY=vFragPosition.y-vPosition.y;float currDeg=degrees(atan(deltaX/deltaY));if(deltaX>=0.0&&deltaY<=0.0){currDeg=180.0+currDeg;}if(deltaX<=0.0&&deltaY<=0.0){currDeg=180.0+currDeg;}if(deltaX<=0.0&&deltaY>=0.0){currDeg=360.0+currDeg;}float maxDeg=trail;if(trail<0.0){currDeg=-currDeg;maxDeg=-trail;}float modDeg=mod((currDeg-startDeg),360.0);if(modDeg<maxDeg){color.a=modDeg/maxDeg;}else{color.a=0.0;}if(uAntiAliasing==1.0&&d>0.95*vRadius&&d<=vRadius){color.a=color.a-smoothstep(0.95*vRadius,vRadius,d);}gl_FragColor=color;}"},j1=function(l){function h(o){return Xe(this,h),o=_r(this,(h.__proto__||ur(h)).call(this,o)),o.name="RippleCircleLayer",o.autoUpdate=!0,o.bufferData=[],o.initializeTime=new Date,o}return yr(h,l),Ue(h,[{key:"getDefaultOptions",value:function(){var o=1;return this.options.type==="radar"&&(o=120),{depthWrite:!1,depthTest:!0,type:"bubble",size:10,duration:1,trail:o,unit:"px",random:!0,color:"blue",antialias:!0,radius:function(a){return 2*a}}}},{key:"initialize",value:function(o){this.gl=o,this.program=new jr(this.gl,{vertexShader:`attribute vec3 aPos;attribute float aSize;attribute float aIndex;attribute vec4 aColor;attribute float aStartTime;attribute float aRadius;varying vec4 vColor;varying vec4 vPosition;varying vec4 vFragPosition;varying float vSize;varying float vWidth;varying float vStartTime;varying float vRadius;uniform mat4 uMatrix;uniform float uZoomUnits;uniform vec4 uSelectedColor;void main(){vColor=aColor;vStartTime=aStartTime;vSize=aSize*uZoomUnits;vRadius=aRadius*uZoomUnits;float x=aPos.x;float y=aPos.y;float z=aPos.z*uZoomUnits;float R=vRadius;if(aIndex==1.0){x+=R;y-=R;}else if(aIndex==2.0){x-=R;y+=R;}else if(aIndex==3.0){x+=R;y+=R;}else{x-=R;y-=R;}vPosition=vec4(aPos.xy,z,1.0);vFragPosition=vec4(x,y,z,1.0);gl_Position=uMatrix*vFragPosition;
#if defined(PICK)
if(mapvIsPicked()){vColor=uSelectedColor;}
#endif
}`,fragmentShader:W1[this.options.type]||"bubble",defines:this.options.enablePicked?["PICK"]:[]},this),this.buffer=new qe({gl:o,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.indexBuffer=new qe({gl:o,target:"ELEMENT_ARRAY_BUFFER",usage:"STATIC_DRAW"});var a=[{stride:44,name:"aPos",buffer:this.buffer,size:3,type:"FLOAT",offset:0},{stride:44,name:"aSize",buffer:this.buffer,size:1,type:"FLOAT",offset:12},{stride:44,name:"aIndex",buffer:this.buffer,size:1,type:"FLOAT",offset:16},{stride:44,name:"aColor",buffer:this.buffer,size:4,type:"FLOAT",offset:20},{stride:44,name:"aRadius",buffer:this.buffer,size:1,type:"FLOAT",offset:36},{stride:44,name:"aStartTime",buffer:this.buffer,size:1,type:"FLOAT",offset:40}];a=a.concat(this.getCommonAttributes()),this.vertexArray=new bi({gl:o,program:this.program,attributes:a})}},{key:"onChanged",value:function(o,a){this.gl&&a&&(this.uniforms={duration:o.duration,trail:o.trail},this.data=a,this.processData(),o.enablePicked&&this.parsePickData(a))}},{key:"processData",value:function(){var o=this,a=[],y=[];this.data.forEach(function(g,x){var v=g.size||o.options.size,M=g.radius||o.options.radius||1.618*v;typeof M=="function"&&(M=M(v));var D=g.color||o.options.color;D=o.normizedColor(D),g=o.normizedPoint(g.geometry.coordinates);for(var U=o.options.random?Math.random()*o.data.length*9999:0,C=0;4>C;C++)a.push(g[0],g[1],g[2]||0,v,C),a.push(D[0],D[1],D[2],D[3]),a.push(M),a.push(U);v=4*x,0<x&&y.push(v-1,v),y.push(v,v+1,v+2,v+3)}),this.bufferData=a,this.indexData=y,this.buffer.updateData(new Float32Array(a)),this.indexBuffer.updateData(new Uint32Array(y))}},{key:"parsePickData",value:function(o){var a=[];if(this.getOptions().enablePicked){for(var y=0;y<o.length;y++){var g=this.indexToRgb(y);a.push(g[0]/255,g[1]/255,g[2]/255),a.push(g[0]/255,g[1]/255,g[2]/255),a.push(g[0]/255,g[1]/255,g[2]/255),a.push(g[0]/255,g[1]/255,g[2]/255)}this.pickBuffer.updateData(new Float32Array(a))}}},{key:"render",value:function(o){var a=this.getOptions(),y=this.program,g=o.gl,x=o.matrix;y.use(g);var v=this.map.getZoomUnits();Vr(this.uniforms,this.getCommonUniforms(o),{uTime:(new Date-this.initializeTime)/1e3,uZoomUnits:a.unit==="m"?1:v,uMatrix:x,uAntiAliasing:a.antialias?1:0}),y.setUniforms(this.uniforms),this.setGLState({blend:!0,blendEquation:g.FUNC_ADD,blendFunc:[g.SRC_ALPHA,g.ONE_MINUS_SRC_ALPHA],depthTest:a.depthTest,depthMask:a.depthWrite}),0<this.indexData.length&&(this.vertexArray.bind(),this.indexBuffer.bind(),g.drawElements(g.TRIANGLE_STRIP,this.indexData.length,g.UNSIGNED_INT,0))}}]),h}(Ci),iv=bn(W1),X1=ht(function(l,h){h.__esModule=!0;var o=Zo&&Zo.__esModule?Zo:{default:Zo},a=Bo&&Bo.__esModule?Bo:{default:Bo};h.default=function y(g,x,v){g===null&&(g=Function.prototype);var M=(0,a.default)(g,x);if(M===void 0){if(g=(0,o.default)(g),g!==null)return y(g,x,v)}else return"value"in M?M.value:(x=M.get,x===void 0?void 0:x.call(v))}}),fa=ot(X1);ke.deviation=function(l,h,o,a){var y=h&&h.length,g=Math.abs(lg(l,0,y?h[0]*o:l.length,o));if(y){y=0;for(var x=h.length;y<x;y++)g-=Math.abs(lg(l,h[y]*o,y<x-1?h[y+1]*o:l.length,o))}for(y=h=0;y<a.length;y+=3){x=a[y]*o;var v=a[y+1]*o,M=a[y+2]*o;h+=Math.abs((l[x]-l[M])*(l[v+1]-l[x+1])-(l[x]-l[v])*(l[M+1]-l[x+1]))}return g===0&&h===0?0:Math.abs((h-g)/g)},ke.flatten=function(l){for(var h=l[0][0].length,o={vertices:[],holes:[],dimensions:h},a=0,y=0;y<l.length;y++){for(var g=0;g<l[y].length;g++)for(var x=0;x<h;x++)o.vertices.push(l[y][g][x]);0<y&&(a+=l[y-1].length,o.holes.push(a))}return o},ke.default=ke;var Sd=typeof Ag=="undefined"?"__target":Ag(),nv=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder,Vu=window.URL||window.webkitURL,pa=window.Worker;if(pa){var ov=r1("self.onmessage = function () {}"),tc=new Uint8Array(1);try{if(/(?:Trident|Edge)\/(?:[567]|12)/i.test(navigator.userAgent))throw Error("Not available");var Id=new pa(ov);Id.postMessage(tc,[tc.buffer])}catch{pa=null}finally{Vu.revokeObjectURL(ov),Id&&Id.terminate()}}var Y1=new function(l,h){return function(o){var a=this;if(h){if(pa&&!o)return o=(""+h).replace(/^function.+?{/,"").slice(0,-1),o=r1(o),this[Sd]=new pa(o),Vu.revokeObjectURL(o),this[Sd];var y={postMessage:function(g){a.onmessage&&setTimeout(function(){return a.onmessage({data:g,target:y})})}};h.call(y),this.postMessage=function(g){setTimeout(function(){return y.onmessage({data:g,target:a})})},this.isThisThread=!0}else return new pa(l)}}("./worker.js",function(l,h){}),Ed={window:1,windowAnimation:2,gradual:3,ripple:4,water:6},Uf=function(l){function h(o,a){return Xe(this,h),o=_r(this,(h.__proto__||ur(h)).call(this,o,a)),o.name="ShapeLayer",o._isShow=!0,a=o.getOptions(),(a.style==="windowAnimation"||a.style==="ripple"||0<a.riseTime)&&(o.autoUpdate=!0),o.selectedColor=[-1,-1,-1],o.textureCache={},o}return yr(h,l),Ue(h,[{key:"getDefaultOptions",value:function(){return{color:"rgba(50, 50, 230, 1.0)",opacity:.8,height:0,isTextureFull:!1,topColor:"rgba(76, 76, 76, 0.8)",textureRotate:0,textureScale:1,useLight:!0,useTopColor:!1,riseTime:0,polygonOffset:[0,0],depthTest:!0,zIndex:0}}},{key:"initialize",value:function(o){this.gl=o;var a=this.getOptions();this.dataMgr=new xl(this,this.gl),this.texture=null,this.isUseTexture=!1;var y=[];a.enablePicked&&y.push("PICK"),a.texture&&y.push("USE_TEXTURE"),this.program=new jr(this.gl,{vertexShader:`precision highp float;uniform vec4 uSelectedColor;attribute vec4 a_pos;attribute vec3 a_normal;attribute vec4 a_color;attribute vec4 a_pre_color;attribute float a_height;attribute float a_pre_height;
#if defined(USE_TEXTURE)
attribute vec2 a_texture_coord;
#endif
uniform mat4 u_proj_matrix;uniform mat4 u_mv_matrix;uniform mat4 u_normal_matrix;uniform vec3 u_side_light_dir;uniform bool u_use_lighting;uniform bool u_use_texture;uniform vec3 u_ripple_center;uniform float u_radius;uniform float style;uniform float alpha;uniform float time;uniform float dataTime;uniform float riseTime;uniform vec2 uMapCenter;uniform float uMapZoom;uniform float u_zIndex;varying float v_height;varying vec4 v_color;varying vec3 v_position;varying vec2 v_texture_coord;const vec3 point_color=vec3(0.06,0.06,0.06);const vec3 light_color=vec3(0.53,0.53,0.53);const vec3 light_color_2=vec3(0.4,0.4,0.4);const vec3 uAmbientColor=vec3(0.8,0.8,0.8);const vec3 uLightingDirection=vec3(0.0,1.0,1.0);const vec3 uDirectionalColor=vec3(1.0,1.0,1.0);float getTransitionValue(float pre_value,float to_value,float dataTime,float riseTime){float result=0.0;if(pre_value==to_value){result=to_value;}else{if(riseTime>0.0&&dataTime<riseTime){result=(pre_value+(to_value-pre_value)*(dataTime/riseTime));}else{result=to_value;}}return result;}void main(){vec4 pos=a_pos;pos.z=pos.z+pos.w*getTransitionValue(a_pre_height,a_height,dataTime,riseTime);v_position=pos.xyz;v_height=a_height;
#if defined(USE_TEXTURE)
if(u_use_texture){v_texture_coord=a_texture_coord;}
#endif
pos.z+=u_zIndex;vec4 position=u_proj_matrix*u_mv_matrix*vec4(pos.xyz,1.0);gl_Position=position;vec4 icolor=a_color;
#if defined(PICK)
if(mapvIsPicked()){icolor=uSelectedColor;}
#endif
if(u_use_lighting){vec3 N=normalize(vec3(u_normal_matrix*vec4(a_normal,1.0)));vec4 point_dir=u_mv_matrix*vec4(0,1,0,0);vec3 L_point=normalize(point_dir.xyz);float lambert_point=max(0.0,dot(N,-L_point));vec4 light_dir=u_mv_matrix*vec4(u_side_light_dir,0);vec3 L=normalize(light_dir.xyz);float lambert=max(0.0,dot(N,-L));if(pos.z<5.0){float deepGradientColor=(5.0-pos.z)/8.0;lambert=lambert-deepGradientColor;}vec4 light_dir_2=u_mv_matrix*vec4(0,0,-1,0);vec3 L2=normalize(light_dir_2.xyz);float lambert_2=max(0.0,dot(N,-L2));if(a_pre_color.r==a_color.r&&a_pre_color.g==a_color.g&&a_pre_color.b==a_color.b){}else{if(riseTime>0.0&&dataTime<riseTime){icolor.r=a_pre_color.r+(a_color.r-a_pre_color.r)*(dataTime/riseTime);icolor.g=a_pre_color.g+(a_color.g-a_pre_color.g)*(dataTime/riseTime);icolor.b=a_pre_color.b+(a_color.b-a_pre_color.b)*(dataTime/riseTime);}}v_color.rgb=icolor.rgb+icolor.rgb*light_color*lambert+icolor.rgb*light_color_2*lambert_2+icolor.rgb*point_color*lambert_point;v_color.a=icolor.a;if(u_use_texture){mat3 normalMatrix=mat3(u_normal_matrix);vec3 transformedNormal=normalMatrix*a_normal;vec3 dir=uLightingDirection;dir=vec3(normalMatrix*vec3(0.0,-1.0,2.0));float directionalLightWeighting=max(dot(normalize(transformedNormal),normalize(dir)),0.0);vec4 vLightWeighting;vLightWeighting=vec4(uAmbientColor+uDirectionalColor*directionalLightWeighting,1.0);v_color=vLightWeighting;}}else{v_color=icolor;}}`,fragmentShader:"precision highp float;varying vec4 v_color;varying vec3 v_position;varying float v_height;varying vec2 v_texture_coord;uniform vec3 u_ripple_center;uniform vec4 top_color;uniform float u_radius;uniform float style;uniform float alpha;uniform float time;uniform sampler2D u_sampler;uniform bool u_use_lighting;uniform bool u_use_texture;uniform bool u_use_top_color;void main(){vec4 color=vec4(v_color);vec4 textureColor=vec4(1.0,1.0,1.0,1.0);if(u_use_texture){if(style==6.0){float x=v_texture_coord.s;float y=v_texture_coord.t;vec2 cPos=-1.0+2.0*gl_FragCoord.xy/MAPV_resolution;float cLength=length(cPos);vec2 uv=gl_FragCoord.xy/MAPV_resolution+(cPos/cLength)*cos(cLength*12.0-time/1000.0*4.0)*0.03;textureColor=texture2D(u_sampler,uv/2.0+vec2(x,y));}else{textureColor=texture2D(u_sampler,vec2(v_texture_coord.s,v_texture_coord.t));}if(u_use_lighting){color=vec4(textureColor*v_color*1.1);}else{color=textureColor;}}if(u_use_top_color&&v_position.z>=v_height){color=top_color;}if(style==1.0||style==2.0){float t=time/1000.0;float diffDistance=5.0;float modX=mod(v_position.x,diffDistance*2.0);float modZ=mod(v_position.z,diffDistance*2.0);if(modX<diffDistance&&modZ<diffDistance&&v_position.z<v_height){color*=1.05;if(time>0.0&&style==2.0){float iX=ceil(v_position.x/diffDistance);float iZ=ceil(v_position.z/diffDistance);float timeDistance=8.0;t+=tan(sin(iZ));color*=(1.0+mod(t,timeDistance)/timeDistance);}}color.a=alpha;}else if(style==5.0){float t=time/1000.0;float diffDistance=10.0;float modZ=mod(v_position.z-t*40.0,diffDistance*2.0);color.a=1.0-pow(v_position.z/v_height,0.5);if(v_position.z/v_height<0.3){color.r+=0.2;color.g+=0.2;color.b+=0.2;}if(modZ<diffDistance*2.0-4.0){discard;}}else if(style==3.0){float diffDistance=10.0;float modX=mod(v_position.x,diffDistance*2.0);color.a=1.0-pow(v_position.z/v_height,0.3);}else if(style==4.0){float dis=distance(u_ripple_center,v_position);float rSize=400.0;if(v_position.z>=v_height){color=top_color;}if(dis>u_radius-rSize&&dis<u_radius+rSize){color*=(1.0-abs(dis-u_radius)/rSize)*2.0+1.0;}}else if(style==6.0){}gl_FragColor=color;}",defines:y},this),this.vertexBuffer=new qe({gl:o,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.colorBuffer=new qe({gl:o,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.heightBuffer=new qe({gl:o,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.textureBuffer=new qe({gl:o,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.indexBuffer=new qe({gl:o,target:"ELEMENT_ARRAY_BUFFER",usage:"STATIC_DRAW"}),y=[{name:"a_pos",buffer:this.vertexBuffer,stride:28,size:4,type:"FLOAT",offset:0},{name:"a_normal",buffer:this.vertexBuffer,size:3,stride:28,type:"FLOAT",offset:16},{name:"a_color",buffer:this.colorBuffer,size:4,stride:32,type:"FLOAT",offset:0},{name:"a_pre_color",buffer:this.colorBuffer,size:4,stride:32,type:"FLOAT",offset:16},{name:"a_height",buffer:this.heightBuffer,size:1,stride:8,type:"FLOAT",offset:0},{name:"a_pre_height",buffer:this.heightBuffer,size:1,stride:8,type:"FLOAT",offset:4}],a.texture&&y.push({name:"a_texture_coord",buffer:this.textureBuffer,size:2,stride:8,type:"FLOAT",offset:0}),y=y.concat(this.getCommonAttributes()),this.vertexArray=new bi({gl:o,program:this.program,attributes:y}),this.initializeTime=new Date,this.normalMatrix=Ke.create()}},{key:"onDestroy",value:function(){}},{key:"onChanged",value:function(o,a){var y=this;this.gl&&(this.loadTextureTime&&clearTimeout(this.loadTextureTime),this.loadTextureTime=setTimeout(function(){y.loadTexture(function(){y.dataMgr.parseData(a),y.dataTime=new Date,y.webglLayer.render()})},0))}},{key:"render",value:function(o){var a=o.gl,y=o.projectionMatrix,g=o.viewMatrix;if(this._isShow){var x=this.getData();if(x&&!(0>=x.length)){x=this.getOptions();var v=this.program;if(v.use(a),!x.texture||this.texture){var M=0;x.style&&Ed[x.style]&&(M=Ed[x.style]);var D=[a.ONE,a.ZERO];if(x.blend&&(D=$s(a,x.blend)),(x.height===0||x.style==="gradual")&&(D=[a.ONE,a.ONE_MINUS_SRC_ALPHA]),this.setGLState({cullFace:!1,blend:!0,blendEquation:a.FUNC_ADD,blendFunc:D,polygonOffset:x.polygonOffset,depthTest:x.depthTest,depthMask:x.style!=="gradual"}),D=this.normizedColor(x.topColor),x.style==="ripple"&&x.rippleLayer&&x.rippleLayer.data&&x.rippleLayer.data[0]){var U=this.normizedPoint(x.rippleLayer.data[0].geometry.coordinates);v.setUniforms({u_ripple_center:[U[0],U[1],0],u_radius:x.rippleLayer.options.size*x.rippleLayer.currentScale})}U=dr.fromValues(0,-1,2),x.lightDir&&(U=dr.fromValues(x.lightDir[0],x.lightDir[1],x.lightDir[2]));var C=this.normalMatrix;Ke.invert(C,g),Ke.transpose(C,C),v.setUniforms(Vr(this.getCommonUniforms(o),{u_normal_matrix:C,u_sampler:this.texture,u_proj_matrix:y,u_mv_matrix:g,style:M,u_use_top_color:x.useTopColor,top_color:D,u_use_lighting:x.useLight,u_use_texture:this.isUseTexture,alpha:x.opacity===void 0?.8:parseFloat(x.opacity),time:new Date-this.initializeTime,dataTime:new Date-this.dataTime,riseTime:x.riseTime,u_side_light_dir:U,u_zIndex:x.zIndex})),o=this.dataMgr.getData(),0<o.vertex.length&&(this.vertexArray.bind(),this.indexBuffer.bind(),a.drawElements(a.TRIANGLES,o.index.length,a.UNSIGNED_INT,0))}}}else this.webglLayer.clear()}},{key:"loadTexture",value:function(o){var a=this,y=this.getOptions();y.texture?(this.isUseTexture=!0,xn(this.gl,y.texture,function(g,x){a.image=x,a.texture=g,o&&o(),a.webglLayer.render()})):(this.isUseTexture=!1,this.image=this.texture=null,o&&o())}}]),h}(Ci);xl.prototype.initData=function(){this.outBuilding3d={pickColorVertex:[],vertex:[],texture:[],color:[],height:[],index:[]}},xl.prototype.getData=function(){return this.outBuilding3d},xl.prototype.initWorker=function(){this.worker=new Y1,this.worker.onmessage=function(l){}},xl.prototype.parseData=function(l){var h=this;this.initData();for(var o=this.shapeLayer.getOptions(),a=0;a<l.length;a++){var y=l[a],g=y.height||o.height;"properties"in y&&"height"in y.properties&&(g=y.properties.height),g*=1;var x=y.color||o.color;"properties"in y&&"color"in y.properties&&(x=y.properties.color),"properties"in y&&"fillColor"in y.properties&&(x=y.properties.fillColor),Object.prototype.toString.call(x)==="[object Function]"&&(x=x(y)),x=this.shapeLayer.normizedColor(x);var v=this.shapeLayer.getProperty("angle",o.textureRotate,y),M=void 0;o.enablePicked&&(M=this.shapeLayer.indexToRgb(a));var D=void 0,U=void 0;if(o.riseTime&&(U=y.preColor,"properties"in y&&"preColor"in y.properties&&(U=y.properties.preColor),D=y.preHeight,"properties"in y&&"preHeight"in y.properties&&(D=y.properties.preHeight),D===void 0&&(D=0)),y.geometry.coordinates){if(y.geometry.type==="LineString"){var C=y.geometry.coordinates.map(function(V){return h.shapeLayer.normizedPoint(V)}),L=ke.flatten([C]);C=L.vertices,L=L.holes;for(var B=[],O=[],k=0;k<C.length;k+=3)B.push(C[k+0],C[k+1]),O.push(C[k+2]);this.parseBuilding3d(this.outBuilding3d,B,O,D,g,U,x,M,v,L)}if(y.geometry.type==="MultiPolygon"){for(C=y.geometry.coordinates,y=[],L=0;L<C.length;L++)y.push(C[L].map(function(V){return V.map(function(Y){return h.shapeLayer.normizedPoint(Y)})}));for(C=0;C<y.length;C++){L=[],B=[],k=ke.flatten(y[C]),O=k.vertices,k=k.holes;for(var j=0;j<O.length;j+=3)L.push(O[j+0],O[j+1]),B.push(O[j+2]);this.parseBuilding3d(this.outBuilding3d,L,B,D,g,U,x,M,v,k)}}else{for(C=[],L=0;L<y.geometry.coordinates.length;L++)C.push(y.geometry.coordinates[L].map(function(V){return h.shapeLayer.normizedPoint(V)}));for(C=ke.flatten(C),y=C.vertices,C=C.holes,L=[],B=[],O=0;O<y.length;O+=3)L.push(y[O+0],y[O+1]),B.push(y[O+2]);this.parseBuilding3d(this.outBuilding3d,L,B,D,g,U,x,M,v,C)}}}this.shapeLayer.vertexBuffer.updateData(new Float32Array(this.outBuilding3d.vertex)),this.shapeLayer.colorBuffer.updateData(new Float32Array(this.outBuilding3d.color)),this.shapeLayer.heightBuffer.updateData(new Float32Array(this.outBuilding3d.height)),this.shapeLayer.textureBuffer.updateData(new Float32Array(this.outBuilding3d.texture)),this.shapeLayer.indexBuffer.updateData(new Uint32Array(this.outBuilding3d.index)),o.enablePicked&&this.shapeLayer.pickBuffer.updateData(new Float32Array(this.outBuilding3d.pickColorVertex))},xl.prototype.getBounds=function(l,h){for(var o=l[0],a=l[1],y=l[0],g=l[1],x=0;x<l.length;x+=2)o=Math.min(l[x],o),a=Math.min(l[x+1],a),y=Math.max(l[x],y),g=Math.max(l[x+1],g);if(x=[(y-o)/2+o,(g-a)/2+a],h===0||!h)return{minX:o,minY:a,maxX:y,maxY:g,width:y-o,height:g-a,center:x};for(o=l.slice(0),a=0;a<o.length;a+=2)y=i1(l[a],l[a+1],x,h),o[a]=y[0],o[a+1]=y[1];return this.getBounds(o,0)},xl.prototype.parseBuilding3d=function(l,h,o,a,y,g,x,v,M,D){a===void 0&&(a=y);var U=this.shapeLayer.options,C=l.vertex,L=l.texture,B=l.color,O=l.height,k=l.pickColorVertex;l=l.index,g===void 0&&(g=x);var j=0,V=0;if(this.shapeLayer.image&&(j=this.shapeLayer.image.width*U.textureScale,V=this.shapeLayer.image.height*U.textureScale),U.style!=="gradual"){D=D&&D.length?ke(h,D,2):ke(h);var Y=D[0],Q=D[1],nt=D[2];Y=[h[2*Y],h[2*Y+1],1],Q=[h[2*Q],h[2*Q+1],1];var ut=[h[2*nt],h[2*nt+1],1];nt=[],dr.cross(nt,[ut[0]-Q[0],ut[1]-Q[1],ut[2]-Q[2]],[Y[0]-Q[0],Y[1]-Q[1],Y[2]-Q[2]]),Q=C.length/7;var ct;U.texture&&(ct=this.getBounds(h,M)),Y=U.isTextureFull,ut=0;for(var Tt=h.length;ut<Tt;ut+=2){if(C.push(h[ut],h[ut+1],o[ut/2],1,nt[0],nt[1],nt[2]),B.push(x[0],x[1],x[2],x[3],g[0],g[1],g[2],g[3]),O.push(y,a),U.texture){var Lt=i1(h[ut],h[ut+1],ct.center,M),Dt=Ri(Lt,2);Lt=Dt[0],Dt=Dt[1],Y?(Lt=(Lt-ct.minX)/ct.width,Dt=(Dt-ct.minY)/ct.height):(Lt=(Lt-ct.minX)/j,Dt=(Dt-ct.minY)/V),L.push(Lt,Dt)}v&&k.push(v[0]/255,v[1]/255,v[2]/255)}for(M=0,ct=D.length;M<ct;M++)l.push(D[M]+Q)}if(!(y===a&&0>=y))for(M=0,D=h.length;M<D;M+=2)ct=C.length/7,Tt=h[M],Lt=h[M+1],nt=[Tt,Lt,o[M/2],0],Q=[Tt,Lt,o[M/2],1],ut=M+2,Dt=M+3,M===D-2&&(ut=0,Dt=1),ut=h[ut],Dt=h[Dt],Tt=Math.sqrt(Math.pow(ut-Tt,2),Math.pow(Dt-Lt,2)),Lt=[ut,Dt,o[M/2],0],ut=[ut,Dt,o[M/2],1],Dt=[],dr.cross(Dt,[Lt[0]-nt[0],Lt[1]-nt[1],Lt[2]-nt[2]],[Q[0]-nt[0],Q[1]-nt[1],Q[2]-nt[2]]),C.push(nt[0],nt[1],nt[2],nt[3]),C.push(Dt[0],Dt[1],Dt[2]),C.push(Q[0],Q[1],Q[2],Q[3]),C.push(Dt[0],Dt[1],Dt[2]),C.push(Lt[0],Lt[1],Lt[2],Lt[3]),C.push(Dt[0],Dt[1],Dt[2]),C.push(ut[0],ut[1],ut[2],ut[3]),C.push(Dt[0],Dt[1],Dt[2]),B.push(x[0],x[1],x[2],x[3]),B.push(g[0],g[1],g[2],g[3]),B.push(x[0],x[1],x[2],x[3]),B.push(g[0],g[1],g[2],g[3]),B.push(x[0],x[1],x[2],x[3]),B.push(g[0],g[1],g[2],g[3]),B.push(x[0],x[1],x[2],x[3]),B.push(g[0],g[1],g[2],g[3]),O.push(y),O.push(a),O.push(y),O.push(a),O.push(y),O.push(a),O.push(y),O.push(a),U.texture&&(Y?(L.push(0,0),L.push(0,1),L.push(1,0),L.push(1,1)):(L.push(0,0),L.push(0,y/V),L.push(Tt/j,0),L.push(Tt/j,y/V))),v&&(k.push(v[0]/255,v[1]/255,v[2]/255),k.push(v[0]/255,v[1]/255,v[2]/255),k.push(v[0]/255,v[1]/255,v[2]/255),k.push(v[0]/255,v[1]/255,v[2]/255)),l.push(ct,ct+2,ct+3,ct,ct+3,ct+1)};var Wu=ht(function(l,h){(function(o,a){l.exports=a()})(s1,function(){function o(V,Y,Q,nt,ut){for(;nt>Q;){if(600<nt-Q){var ct=nt-Q+1,Tt=Y-Q+1,Lt=Math.log(ct),Dt=.5*Math.exp(2*Lt/3);Lt=.5*Math.sqrt(Lt*Dt*(ct-Dt)/ct)*(0>Tt-ct/2?-1:1),o(V,Y,Math.max(Q,Math.floor(Y-Tt*Dt/ct+Lt)),Math.min(nt,Math.floor(Y+(ct-Tt)*Dt/ct+Lt)),ut)}for(ct=V[Y],Tt=Q,Dt=nt,a(V,Q,Y),0<ut(V[nt],ct)&&a(V,Q,nt);Tt<Dt;){for(a(V,Tt,Dt),Tt++,Dt--;0>ut(V[Tt],ct);)Tt++;for(;0<ut(V[Dt],ct);)Dt--}ut(V[Q],ct)===0?a(V,Q,Dt):(Dt++,a(V,Dt,nt)),Dt<=Y&&(Q=Dt+1),Y<=Dt&&(nt=Dt-1)}}function a(V,Y,Q){var nt=V[Y];V[Y]=V[Q],V[Q]=nt}function y(V,Y){return V<Y?-1:V>Y?1:0}function g(V,Y){x(V,0,V.children.length,Y,V)}function x(V,Y,Q,nt,ut){for(ut||(ut=O(null)),ut.minX=1/0,ut.minY=1/0,ut.maxX=-1/0,ut.maxY=-1/0;Y<Q;Y++){var ct=V.children[Y];v(ut,V.leaf?nt(ct):ct)}return ut}function v(V,Y){return V.minX=Math.min(V.minX,Y.minX),V.minY=Math.min(V.minY,Y.minY),V.maxX=Math.max(V.maxX,Y.maxX),V.maxY=Math.max(V.maxY,Y.maxY),V}function M(V,Y){return V.minX-Y.minX}function D(V,Y){return V.minY-Y.minY}function U(V){return(V.maxX-V.minX)*(V.maxY-V.minY)}function C(V){return V.maxX-V.minX+(V.maxY-V.minY)}function L(V,Y){return V.minX<=Y.minX&&V.minY<=Y.minY&&Y.maxX<=V.maxX&&Y.maxY<=V.maxY}function B(V,Y){return Y.minX<=V.maxX&&Y.minY<=V.maxY&&Y.maxX>=V.minX&&Y.maxY>=V.minY}function O(V){return{children:V,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function k(V,Y,Q,nt,ut){for(var ct=[Y,Q];ct.length;)if(Q=ct.pop(),Y=ct.pop(),!(Q-Y<=nt)){var Tt=Y+Math.ceil((Q-Y)/nt/2)*nt;o(V,Tt,Y||0,Q||V.length-1,ut||y),ct.push(Y,Tt,Tt,Q)}}var j=function(V){V===void 0&&(V=9),this._maxEntries=Math.max(4,V),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};return j.prototype.all=function(){return this._all(this.data,[])},j.prototype.search=function(V){var Y=this.data,Q=[];if(!B(V,Y))return Q;for(var nt=this.toBBox,ut=[];Y;){for(var ct=0;ct<Y.children.length;ct++){var Tt=Y.children[ct],Lt=Y.leaf?nt(Tt):Tt;B(V,Lt)&&(Y.leaf?Q.push(Tt):L(V,Lt)?this._all(Tt,Q):ut.push(Tt))}Y=ut.pop()}return Q},j.prototype.collides=function(V){var Y=this.data;if(!B(V,Y))return!1;for(var Q=[];Y;){for(var nt=0;nt<Y.children.length;nt++){var ut=Y.children[nt],ct=Y.leaf?this.toBBox(ut):ut;if(B(V,ct)){if(Y.leaf||L(V,ct))return!0;Q.push(ut)}}Y=Q.pop()}return!1},j.prototype.load=function(V){if(!V||!V.length)return this;if(V.length<this._minEntries){for(var Y=0;Y<V.length;Y++)this.insert(V[Y]);return this}return V=this._build(V.slice(),0,V.length-1,0),this.data.children.length?this.data.height===V.height?this._splitRoot(this.data,V):(this.data.height<V.height&&(Y=this.data,this.data=V,V=Y),this._insert(V,this.data.height-V.height-1,!0)):this.data=V,this},j.prototype.insert=function(V){return V&&this._insert(V,this.data.height-1),this},j.prototype.clear=function(){return this.data=O([]),this},j.prototype.remove=function(V,Y){if(!V)return this;for(var Q=this.data,nt=this.toBBox(V),ut=[],ct=[],Tt,Lt,Dt;Q||ut.length;){if(Q||(Q=ut.pop(),Lt=ut[ut.length-1],Tt=ct.pop(),Dt=!0),Q.leaf){t:{var ae=V,ne=Q.children,we=Y;if(we){for(var xe=0;xe<ne.length;xe++)if(we(ae,ne[xe])){ae=xe;break t}ae=-1}else ae=ne.indexOf(ae)}if(ae!==-1){Q.children.splice(ae,1),ut.push(Q),this._condense(ut);break}}Dt||Q.leaf||!L(Q,nt)?Lt?(Tt++,Q=Lt.children[Tt],Dt=!1):Q=null:(ut.push(Q),ct.push(Tt),Tt=0,Lt=Q,Q=Q.children[0])}return this},j.prototype.toBBox=function(V){return V},j.prototype.compareMinX=function(V,Y){return V.minX-Y.minX},j.prototype.compareMinY=function(V,Y){return V.minY-Y.minY},j.prototype.toJSON=function(){return this.data},j.prototype.fromJSON=function(V){return this.data=V,this},j.prototype._all=function(V,Y){for(var Q=[];V;)V.leaf?Y.push.apply(Y,V.children):Q.push.apply(Q,V.children),V=Q.pop();return Y},j.prototype._build=function(V,Y,Q,nt){var ut=Q-Y+1,ct=this._maxEntries;if(ut<=ct){var Tt=O(V.slice(Y,Q+1));return g(Tt,this.toBBox),Tt}for(nt||(nt=Math.ceil(Math.log(ut)/Math.log(ct)),ct=Math.ceil(ut/Math.pow(ct,nt-1))),Tt=O([]),Tt.leaf=!1,Tt.height=nt,ut=Math.ceil(ut/ct),ct=ut*Math.ceil(Math.sqrt(ct)),k(V,Y,Q,ct,this.compareMinX);Y<=Q;Y+=ct){var Lt=Math.min(Y+ct-1,Q);k(V,Y,Lt,ut,this.compareMinY);for(var Dt=Y;Dt<=Lt;Dt+=ut)Tt.children.push(this._build(V,Dt,Math.min(Dt+ut-1,Lt),nt-1))}return g(Tt,this.toBBox),Tt},j.prototype._chooseSubtree=function(V,Y,Q,nt){for(;nt.push(Y),!(Y.leaf||nt.length-1===Q);){for(var ut=1/0,ct=1/0,Tt=void 0,Lt=0;Lt<Y.children.length;Lt++){var Dt=Y.children[Lt],ae=U(Dt),ne=(Math.max(Dt.maxX,V.maxX)-Math.min(Dt.minX,V.minX))*(Math.max(Dt.maxY,V.maxY)-Math.min(Dt.minY,V.minY))-ae;ne<ct?(ct=ne,ut=ae<ut?ae:ut,Tt=Dt):ne===ct&&ae<ut&&(ut=ae,Tt=Dt)}Y=Tt||Y.children[0]}return Y},j.prototype._insert=function(V,Y,Q){Q=Q?V:this.toBBox(V);var nt=[],ut=this._chooseSubtree(Q,this.data,Y,nt);for(ut.children.push(V),v(ut,Q);0<=Y&&nt[Y].children.length>this._maxEntries;)this._split(nt,Y),Y--;this._adjustParentBBoxes(Q,nt,Y)},j.prototype._split=function(V,Y){var Q=V[Y],nt=Q.children.length,ut=this._minEntries;this._chooseSplitAxis(Q,ut,nt),nt=this._chooseSplitIndex(Q,ut,nt),nt=O(Q.children.splice(nt,Q.children.length-nt)),nt.height=Q.height,nt.leaf=Q.leaf,g(Q,this.toBBox),g(nt,this.toBBox),Y?V[Y-1].children.push(nt):this._splitRoot(Q,nt)},j.prototype._splitRoot=function(V,Y){this.data=O([V,Y]),this.data.height=V.height+1,this.data.leaf=!1,g(this.data,this.toBBox)},j.prototype._chooseSplitIndex=function(V,Y,Q){for(var nt,ut=1/0,ct=1/0,Tt=Y;Tt<=Q-Y;Tt++){var Lt=x(V,0,Tt,this.toBBox),Dt=x(V,Tt,Q,this.toBBox),ae=Math.max(0,Math.min(Lt.maxX,Dt.maxX)-Math.max(Lt.minX,Dt.minX))*Math.max(0,Math.min(Lt.maxY,Dt.maxY)-Math.max(Lt.minY,Dt.minY));Lt=U(Lt)+U(Dt),ae<ut?(ut=ae,nt=Tt,ct=Lt<ct?Lt:ct):ae===ut&&Lt<ct&&(ct=Lt,nt=Tt)}return nt||Q-Y},j.prototype._chooseSplitAxis=function(V,Y,Q){var nt=V.leaf?this.compareMinX:M,ut=V.leaf?this.compareMinY:D,ct=this._allDistMargin(V,Y,Q,nt);Y=this._allDistMargin(V,Y,Q,ut),ct<Y&&V.children.sort(nt)},j.prototype._allDistMargin=function(V,Y,Q,nt){V.children.sort(nt),nt=this.toBBox;for(var ut=x(V,0,Y,nt),ct=x(V,Q-Y,Q,nt),Tt=C(ut)+C(ct),Lt=Y;Lt<Q-Y;Lt++){var Dt=V.children[Lt];v(ut,V.leaf?nt(Dt):Dt),Tt+=C(ut)}for(Q=Q-Y-1;Q>=Y;Q--)ut=V.children[Q],v(ct,V.leaf?nt(ut):ut),Tt+=C(ct);return Tt},j.prototype._adjustParentBBoxes=function(V,Y,Q){for(;0<=Q;Q--)v(Y[Q],V)},j.prototype._condense=function(V){for(var Y=V.length-1,Q;0<=Y;Y--)V[Y].children.length===0?0<Y?(Q=V[Y-1].children,Q.splice(Q.indexOf(V[Y]),1)):this.clear():g(V[Y],this.toBBox)},j})}),Yl=function(l){function h(o){Xe(this,h),o=_r(this,(h.__proto__||ur(h)).call(this,o)),o.name="TextLayer";var a=o.canvas=document.createElement("canvas");return a=o.ctx=a.getContext("2d"),a.textAlign="start",a.textBaseline="top",o}return yr(h,l),Ue(h,[{key:"getDefaultOptions",value:function(){return{depthWrite:!1,depthTest:!0,color:"#fff",fontFamily:"Microsoft Yahei",fontSize:14,flat:!1,collides:!0,unit:"px",angle:0,offset:[0,0],padding:[2,2],margin:[0,0],polygonOffset:[0,0],shadow:{},stroke:{color:"#000"}}}},{key:"initialize",value:function(o){this.gl=o;var a=this.getOptions();this.texture=null,this.lastUpdateTime=0,this.program=new jr(this.gl,{vertexShader:"precision highp float;uniform mat4 matrix;uniform bool uFlat;uniform bool uUnitPx;uniform float zoomUnits;uniform float devicePixelRatio;uniform float zIndex;uniform vec2 offset;attribute vec3 position;attribute float corner;attribute float scale;attribute float rotation;attribute vec2 size;attribute vec2 aTextCoord;varying vec2 vTextCoord;/***\u70B9A(x,y)\uFF0C\u7ED5\u539F\u70B9\u987A\u65F6\u9488\u65CB\u8F6C\u89D2\u5EA6a\u65B0\u5750\u6807\u7684\u8BA1\u7B97\u516C\u5F0F*x1=x*cos(a)+y*sin(a)*y1=y*cos(a)-x*sin(a)*/vec3 transformCoord(vec3 coord,vec2 size,float corner){float x=coord.x;float y=coord.y;if(corner==1.0){x+=-size.x*cos(rotation)+size.y*sin(rotation);y+=size.y*cos(rotation)+size.x*sin(rotation);}else if(corner==2.0){x+=size.x*cos(rotation)+size.y*sin(rotation);y+=size.y*cos(rotation)-size.x*sin(rotation);}else if(corner==3.0){x+=size.x*cos(rotation)-size.y*sin(rotation);y+=-size.y*cos(rotation)-size.x*sin(rotation);}else{x+=-size.x*cos(rotation)-size.y*sin(rotation);y+=-size.y*cos(rotation)+size.x*sin(rotation);}return vec3(x,y,coord.z);}void main(){vTextCoord=aTextCoord;if(uFlat){vec2 pixelOffset=offset;vec2 halfSize=size/2.0*scale;if(uUnitPx){halfSize*=zoomUnits;pixelOffset*=zoomUnits;}vec3 current=transformCoord(position,halfSize,corner);current.z+=zIndex;gl_Position=matrix*vec4(current.x+pixelOffset[0],current.y-pixelOffset[1],current.z,1.0);}else{vec2 pixelOffset=offset*zoomUnits;vec4 projection=matrix*vec4(position.x+pixelOffset[0],position.y-pixelOffset[1],position.z+zIndex,1.0);vec3 screen=projection.xyz/projection.w;vec2 halfSize=size/MAPV_resolution*devicePixelRatio*scale;vec3 current=transformCoord(screen,halfSize,corner);gl_Position=vec4(current,1.0);}}",fragmentShader:`precision highp float;uniform sampler2D textureImage;uniform vec4 uSelectedColor;varying vec2 vTextCoord;void main(){gl_FragColor=texture2D(textureImage,vec2(vTextCoord.x,1.0-vTextCoord.y));
#if defined(PICK)
if(mapvIsPicked()){gl_FragColor=vec4(uSelectedColor.rgb,gl_FragColor.a);}
#endif
}`,defines:a.enablePicked?["PICK"]:[]},this),this.vertexBuffer=new qe({gl:o,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.uvBuffer=new qe({gl:o,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.indexBuffer=new qe({gl:o,target:"ELEMENT_ARRAY_BUFFER",usage:"STATIC_DRAW"}),a=[{name:"position",buffer:this.vertexBuffer,size:3,stride:32,type:"FLOAT",offset:0},{name:"corner",buffer:this.vertexBuffer,size:1,stride:32,type:"FLOAT",offset:12},{name:"size",buffer:this.vertexBuffer,size:2,stride:32,type:"FLOAT",offset:16},{name:"scale",buffer:this.vertexBuffer,size:1,stride:32,type:"FLOAT",offset:24},{name:"rotation",buffer:this.vertexBuffer,size:1,stride:32,type:"FLOAT",offset:28},{name:"aTextCoord",buffer:this.uvBuffer,size:2,stride:8,type:"FLOAT",offset:0}],a=a.concat(this.getCommonAttributes()),this.vertexArray=new bi({gl:o,program:this.program,attributes:a})}},{key:"onDestroy",value:function(){}},{key:"onChanged",value:function(o,a){this.gl&&this.processCache(o,a)}},{key:"processCache",value:function(o,a){this.cachedData=[];for(var y=0;y<a.length;y++){var g=this.normizedPoint(a[y].geometry.coordinates),x=a[y].text;"properties"in a[y]&&"text"in a[y].properties&&(x=a[y].properties.text);var v=this.getProperty("angle",o.angle,a[y]),M=this.getProperty("color",o.color,a[y]);g&&x!==void 0&&this.cachedData.push({point:g,text:x,angle:v,color:M,index:y})}}},{key:"render",value:function(o){if(this.cachedData&&this.cachedData.length&&this.map){var a=o.gl,y=o.matrix,g=this.getOptions(),x=this.program;x.use(a),this.throttleUpdate(o),this.setGLState({blend:!0,blendEquation:a.FUNC_ADD,blendFunc:[a.SRC_ALPHA,a.ONE_MINUS_SRC_ALPHA],polygonOffset:g.polygonOffset,depthTest:g.depthTest,depthMask:g.depthWrite});var v=this.map.getZoomUnits();x.setUniforms(Vr(this.getCommonUniforms(o),{matrix:y,devicePixelRatio:window.devicePixelRatio,textureImage:this.texture,uFlat:g.flat,offset:g.offset,zoomUnits:v,zIndex:g.zIndex,uUnitPx:g.unit==="px"})),0<this.index.length&&(this.indexBuffer.bind(),this.vertexArray.bind(),a.drawElements(a.TRIANGLES,this.index.length,a.UNSIGNED_INT,0))}}},{key:"throttleUpdate",value:function(o){this.updateText(o)}},{key:"updateText",value:function(o){var a=o.gl,y=o.matrix,g=this.getOptions();o=g.fontSize;var x=g.fontFamily,v=g.padding,M=g.margin,D=g.collides,U=g.enablePicked,C=g.shadow;g=g.stroke;var L=a.canvas.width/window.devicePixelRatio,B=a.canvas.height/window.devicePixelRatio,O=this.canvas;a=this.ctx,a.save(),a.scale(window.devicePixelRatio,window.devicePixelRatio),a.textBaseline="top",a.font="20px "+x;for(var k=new Wu,j=[],V=0;V<this.cachedData.length;V++){var Y=this.cachedData[V],Q=Y.point,nt=Y.text,ut=Y.angle,ct=Y.color;Y=Y.index;var Tt=Ri(Q,3),Lt=on.clone([Tt[0],Tt[1],Tt[2],1]);on.transformMat4(Lt,Lt,y),on.scale(Lt,Lt,1/Lt[3]),Tt=this.map.getHeading()%360;var Dt=(Lt[0]+1)/2*L,ae=(-Lt[1]+1)/2*B;Lt=Dt*Math.cos(Tt*Math.PI/180)-ae*Math.sin(Tt*Math.PI/180);var ne=Dt*Math.sin(Tt*Math.PI/180)+ae*Math.cos(Tt*Math.PI/180);ae=a.measureText(nt),Tt=ae.width+2*v[0],Dt=20,ae.actualBoundingBoxAscent&&ae.actualBoundingBoxDescent&&(Dt=ae.actualBoundingBoxDescent-ae.actualBoundingBoxAscent),Dt+=2*v[1];var we=Tt+M[0];if(ae=Dt+M[1],Lt-=we/2,ne-=ae/2,we=Lt+we,ae=ne+ae,D){if(Lt={minX:Lt,maxX:we,minY:ne,maxY:ae},k.collides(Lt))continue;k.insert(Lt)}j.push({w:Tt,h:Dt,point:Q,text:nt,angle:ut,color:ct,dataIndex:Y})}for(a.restore(),M=Iu(j),y=M.w,M=M.h,0>=y&&(y=1),0>=M&&(M=1),O.width=y*window.devicePixelRatio,O.height=M*window.devicePixelRatio,a.save(),a.scale(window.devicePixelRatio,window.devicePixelRatio),a.textBaseline="top",a.font="20px "+x,a.shadowColor=C&&C.color,a.shadowOffsetX=C&&C.offsetX,a.shadowOffsetY=C&&C.offsetY,a.shadowBlur=C&&C.blur,x=[],C=[],O=[],D=[],L=0,B=j.length;L<B;++L){for(k=j[L],a.lineWidth=2,a.strokeStyle=g.color,a.strokeText(k.text,k.x+v[0],k.y+v[1]),a.fillStyle=k.color,a.fillText(k.text,k.x+v[0],k.y+v[1]),nt=Ri(k.point,3),V=nt[0],Q=nt[1],nt=nt[2],ut=0;4>ut;ut++)x.push(V,Q,nt),x.push(ut),x.push(k.w,k.h),x.push(o/20,k.angle*Math.PI/180);V=k.x/y,Q=(k.x+k.w)/y,nt=(k.y+k.h)/M,ut=k.y/M,C.push(V,nt,V,ut,Q,ut,Q,nt),V=4*L,O.push(V,V+2,V+1,V,V+3,V+2),U&&(k=this.indexToRgb(k.dataIndex),D.push(k[0]/255,k[1]/255,k[2]/255),D.push(k[0]/255,k[1]/255,k[2]/255),D.push(k[0]/255,k[1]/255,k[2]/255),D.push(k[0]/255,k[1]/255,k[2]/255))}a.restore(),this.loadTexture(),this.index=O,this.vertexBuffer.updateData(new Float32Array(x)),this.uvBuffer.updateData(new Float32Array(C)),this.indexBuffer.updateData(new Uint32Array(O)),U&&this.pickBuffer.updateData(new Float32Array(D))}},{key:"loadTexture",value:function(){var o=this;this.canvas?xn(this.gl,this.canvas,function(a){o.texture=a},{TEXTURE_WRAP_S:"CLAMP_TO_EDGE",TEXTURE_WRAP_T:"CLAMP_TO_EDGE"}):this.texture=null}}]),h}(Ci),da=function(l){function h(o){return Xe(this,h),_r(this,(h.__proto__||ur(h)).call(this,o))}return yr(h,l),Ue(h,[{key:"initialize",value:function(o){var a=this;this.children&&this.children.forEach(function(y){y.map=a.map,y.setWebglLayer(a.getWebglLayer()),y.commonInitialize&&y.commonInitialize(o),y.initialize&&y.initialize(o),y.onOptionsChanged(y.getOptions()),y.onDataChanged(y.getData()),y.onChanged(y.getOptions(),y.getData())})}},{key:"isRequestAnimation",value:function(){if(this.autoUpdate!==void 0)return fa(h.prototype.__proto__||ur(h.prototype),"isRequestAnimation",this).call(this);for(var o=!1,a=0;a<this.children.length;a++)if(this.children[a].isRequestAnimation()){o=!0;break}return o}},{key:"render",value:function(o){this.children&&this.children.forEach(function(a){a.render(o)})}},{key:"onDestroy",value:function(o){this.children&&this.children.forEach(function(a){a.onDestroy(o)})}}]),h}(ca),Ld=function(l){function h(o){return Xe(this,h),o=_r(this,(h.__proto__||ur(h)).call(this,o)),o.preHeightMapper={},o.preColorMapper={},o}return yr(h,l),Ue(h,[{key:"getDefaultOptions",value:function(){return Vr(fa(h.prototype.__proto__||ur(h.prototype),"getDefaultOptions",this).call(this),{style:"grid",gridSize:500,gridGap:5,height:function(){return 1e3},color:function(){return"rgb(200, 200, 20)"}})}},{key:"generateGrid",value:function(o,a){var y=a.gridSize,g=[],x={};a=o.length;for(var v=this.getPointOffset(),M=0;M<a;M++){var D=this.normizedPoint(o[M].geometry.coordinates);D=~~((D[0]+v[0])/y)+"_"+~~((D[1]+v[1])/y),x[D]===void 0&&(x[D]=0);var U=~~o[M].count||1;"properties"in o[M]&&"count"in o[M].properties&&(U=~~o[M].properties.count),x[D]+=U}return bn(x).forEach(function(C){var L=C.split("_");g.push([L[0]*y+y/2,L[1]*y+y/2,x[C]])}),g}},{key:"onChanged",value:function(o,a){a=this.processData(a),fa(h.prototype.__proto__||ur(h.prototype),"onChanged",this).call(this,o,a)}},{key:"getGridDataRange",value:function(){var o=this.gridData,a=void 0,y=void 0;o[0]&&(a=o[0][2],y=o[0][2]);for(var g=o.length,x=0;x<g;x++){var v=o[x];a=Math.max(v[2],a),y=Math.min(v[2],y)}return{max:a/2,min:y}}},{key:"processData",value:function(o){var a=this.getOptions(),y=a.gridSize,g=[];if(a.style==="normal")for(var x=this.getPointOffset(),v=0;v<o.length;v++){var M=this.normizedPoint(o[v].geometry.coordinates),D=M[0]+x[0];M=M[1]+x[1];var U=~~o[v].count||1;"properties"in o[v]&&"count"in o[v].properties&&(U=~~o[v].properties.count);var C=o[v].color;"properties"in o[v]&&"color"in o[v].properties&&(C=~~o[v].properties.color),g.push([D,M,U,C])}else g=this.generateGrid(o,a);for(o=[],this._preHeightMapper={},this._preColorMapper={},x=0;x<g.length;x++)v=g[x],v[0]=v[0],v[1]=v[1],D=v[2],a.height&&(D=typeof a.height=="function"?a.height({count:v[2],coordinates:[v[0],v[1]]}):a.height),M=y/2-a.gridGap,U=v[3],a.color&&(U=typeof a.color=="function"?a.color({count:v[2],color:v[3]}):Jt(U||a.color).unitArray()),C="p"+v[0]+v[1],o.push({geometry:{type:"Polygon",coordinates:[[[v[0]-M,v[1]-M],[v[0]-M,v[1]+M],[v[0]+M,v[1]+M],[v[0]+M,v[1]-M]]]},color:U,origin:v,count:v[2],preHeight:this.preHeightMapper[C],preColor:this.preColorMapper[C],height:D}),this._preHeightMapper[C]=D,this._preColorMapper[C]=U;return this.preHeightMapper=this._preHeightMapper,this.preColorMapper=this._preColorMapper,this.gridData=o}}]),h}(Uf),bf=function(l){function h(o){Xe(this,h);var a=_r(this,(h.__proto__||ur(h)).call(this,o));return a.gridLayer=new Ld(o),a.options.textOptions=Vr({show:!1,flat:!0,unit:"m",fontSize:100,collides:!1},o.textOptions||{}),a.textLayer=new Yl(a.options.textOptions),a.children=[a.gridLayer,a.textLayer],a}return yr(h,l),Ue(h,[{key:"pick",value:function(o,a){return this.gridLayer.pick(o,a)}},{key:"setData",value:function(o){this.gridLayer.setData(o),this.options.textOptions.show&&this.setTextData()}},{key:"setTextData",value:function(){var o=this.gridLayer.gridData.map(function(a){return{geometry:{type:"Point",coordinates:[a.origin[0],a.origin[1],a.height+5]},properties:{text:a.count}}});this.textLayer.setData(o)}},{key:"setOptions",value:function(){var o=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{},a=this.options.textOptions;Vr(this.options,o),this.gridLayer.setOptions(this.options),o.textOptions&&(this.options.textOptions.show&&this.setTextData(),this.options.textOptions=Vr(a||{},o.textOptions),this.textLayer.setOptions(this.options.textOptions))}},{key:"getData",value:function(){return this.gridLayer.getData()}},{key:"render",value:function(o){this.gridLayer.render(o),this.options.textOptions.show&&this.textLayer.render(o)}}]),h}(da),Z1=function(l){function h(o){return Xe(this,h),o=_r(this,(h.__proto__||ur(h)).call(this,o)),o.gridLayer=new bf(o.getGridOptions()),o.children=[o.gridLayer],o.options.riseTime&&(o.autoUpdate=!0),o}return yr(h,l),Ue(h,[{key:"pick",value:function(o,a){return this.gridLayer.pick(o,a)}},{key:"onDataChanged",value:function(o){this.gridLayer.setData(o)}},{key:"getGridOptions",value:function(){var o=this.getOptions(),a=o.max,y=o.min;a===void 0&&(y=this.gridLayer.getGridDataRange(),a=y.max,y=y.min);var g=new Li({max:a,min:y,gradient:o.gradient,maxSize:o.maxHeight,minSize:o.minHeight});return o.height=function(x){var v=g.getSize(x.count);return"properties"in x&&"count"in x.properties&&(v=g.getSize(x.properties.count)),v},o.color=function(x){var v=g.getImageData(x.count);return"properties"in x&&"count"in x.properties&&(v=g.getImageData(x.properties.count)),[v[0]/255,v[1]/255,v[2]/255,v[3]/255]},o}},{key:"onOptionsChanged",value:function(o){this.gridLayer.setOptions(this.getGridOptions())}},{key:"getDefaultOptions",value:function(){return{enablePicked:!1,selectedIndex:-1,selectedColor:"#ff0000",autoSelect:!0,style:"grid",gridSize:500,maxHeight:8e3,minHeight:200,gradient:{0:"rgb(50, 50, 256)","0.1":"rgb(50, 250, 56)","0.5":"rgb(250, 250, 56)",1:"rgb(250, 50, 56)"}}}}]),h}(da),q1=function(l){function h(o,a){return Xe(this,h),o=_r(this,(h.__proto__||ur(h)).call(this,o,a)),o.name="SimpleLineLayer",o.bufferData=[],o}return yr(h,l),Ue(h,[{key:"initialize",value:function(o){this.gl=o;var a=this.getOptions();this.program=new jr(this.gl,{vertexShader:`uniform mat4 u_matrix;attribute vec3 aPos;attribute vec4 aColor;varying vec4 vColor;
#if defined(DASH)
varying vec3 vPos;
#endif
void main(){if(aColor.w>=0.0&&aColor.w<=1.0){vColor=aColor;}else{vColor=vec4(aColor.xyz,1.0);}gl_Position=u_matrix*vec4(aPos,1.0);
#if defined(DASH)
vPos=aPos;
#endif
}`,fragmentShader:`precision highp float;varying vec4 vColor;varying vec3 vPos;void main(){
#if defined(DASH)
if(mod(vPos.x,3.0)<1.5){discard;}
#endif
gl_FragColor=vColor;}`,defines:a.useDash?["DASH"]:""},this),this.buffer=new qe({gl:o,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.vertexArray=new bi({gl:o,program:this.program,attributes:[{stride:28,name:"aPos",buffer:this.buffer,size:3,type:"FLOAT",offset:0},{stride:28,name:"aColor",buffer:this.buffer,size:4,type:"FLOAT",offset:12}]})}},{key:"onDestroy",value:function(){this.bufferData=[]}},{key:"onChanged",value:function(o,a){var y=this;if(this.gl){var g=[],x=function(C,L){if(C)for(var B=0;B<C.length-1;B++){var O=y.normizedPoint(C[B]);g.push(O[0]),g.push(O[1]),g.push(O[2]),g.push(L[0],L[1],L[2],L[3]),O=y.normizedPoint(C[B+1]),g.push(O[0]),g.push(O[1]),g.push(O[2]),g.push(L[0],L[1],L[2],L[3])}};o=o.color;for(var v=0;v<a.length;v++){var M=this.getProperty("color",o,a[v]);M=this.normizedColor(M);var D=a[v].geometry,U=D.coordinates;if(D.type==="MultiPolygon"){if(U)for(D=0;D<U.length;D++)x(U[D][0],M)}else if(D.type==="Polygon")U&&x(U[0],M);else if(D.type==="MultiLineString"){if(U)for(D=0;D<U.length;D++)x(U[D],M)}else x(U,M)}this.bufferData=g,this.buffer.updateData(new Float32Array(g))}}},{key:"render",value:function(o){var a=o.gl;if(o=o.matrix,this.bufferData&&!(0>=this.bufferData.length)){var y=this.program;y.use(a),this.vertexArray.bind(),y.setUniforms({u_matrix:o}),o=this.getOptions(),this.setGLState({blend:!0,blendFunc:o.blend==="lighter"?[a.SRC_ALPHA,a.ONE]:[a.SRC_ALPHA,a.ONE_MINUS_SRC_ALPHA],blendEquation:a.FUNC_ADD}),a.drawArrays(a.LINES,0,this.bufferData.length/7)}}}]),h}(Ci),sv=Pu.f("species"),Rd=ht(function(l){l.exports={default:sv,__esModule:!0}});ot(Rd);var av=typeof Gc!="undefined"?Gc:typeof self!="undefined"?self:typeof window!="undefined"?window:{};av.TYPED_ARRAY_SUPPORT!==void 0&&av.TYPED_ARRAY_SUPPORT;var Pd={normal:null,road:Th()},J1=function(l){function h(o,a){return Xe(this,h),o=_r(this,(h.__proto__||ur(h)).call(this,o,a)),o.name="LineLayer3D",o.initData(),o}return yr(h,l),Ue(h,[{key:"getDefaultOptions",value:function(){return{color:"rgba(25, 25, 250, 1)",offset:0,blend:"normal",width:4,unit:"px",flat:!1,antialias:!1,style:"normal",dashArray:[0,0],dashOffset:0,polygonOffset:[0,0]}}},{key:"initData",value:function(){this.dataMgr={position:[],prev:[],next:[],direction:[],color:[],index:[],counter:[],uv:[]}}},{key:"initialize",value:function(o){this.gl=o;var a=this.getOptions(),y=[];a.enablePicked&&y.push("PICK"),Pd[a.style]&&(this.isUseTexture=!0,y.push("USE_TEXTURE")),this.program=new jr(this.gl,{vertexShader:`precision highp float;uniform vec4 uSelectedColor;uniform mat4 uMatrix;uniform bool uFlat;uniform bool uUnitPx;uniform vec2 uDashArray;uniform float thickness;uniform float zoomUnits;uniform float devicePixelRatio;uniform float uOffset;attribute vec3 position;attribute vec3 next;attribute vec3 previous;attribute float direction;attribute vec4 aColor;attribute float aDistance;attribute float aTotalDistance;
#if defined(USE_TEXTURE)
attribute vec2 uv;
#endif
varying vec4 vColor;varying vec2 vNormal;varying vec2 vUV;varying vec2 vDashArray;varying float vTotalDistance;varying float vCounter;vec2 project(vec4 coord){vec3 screen=coord.xyz/coord.w;vec2 clip=(screen.xy+1.0)/2.0;return clip*MAPV_resolution;}vec4 unproject(vec2 projected,float z,float w){vec2 clip=projected/MAPV_resolution;vec2 screen=clip*2.0-1.0;return vec4(screen*w,z,w);}vec3 getNormalAndWidth(vec2 currentScreen,vec2 previousScreen,vec2 nextScreen,float thickness){vec2 dir=vec2(0.0);if(currentScreen==previousScreen){dir=normalize(nextScreen-currentScreen);}else if(currentScreen==nextScreen){dir=normalize(currentScreen-previousScreen);}else{vec2 dirA=normalize((currentScreen-previousScreen));vec2 dirB=normalize((nextScreen-currentScreen));vec2 tangent=normalize(dirA+dirB);vec2 perp=vec2(-dirA.y,dirA.x);vec2 miter=vec2(-tangent.y,tangent.x);dir=tangent;float angle=40.0;if(dot(dirA,dirB)>cos(radians(angle))){thickness=thickness/dot(miter,perp);}}vec2 normal=vec2(-dir.y,dir.x);return vec3(normal,thickness);}void main(){vColor=aColor;vCounter=aDistance/aTotalDistance;vDashArray=uDashArray/aTotalDistance;if(uUnitPx){vDashArray*=zoomUnits;}vTotalDistance=aTotalDistance;
#if defined(USE_TEXTURE)
vUV=uv;
#endif
#if defined(PICK)
if(mapvIsPicked()){vColor=uSelectedColor;}
#endif
if(uFlat){float width=thickness;if(uUnitPx){width*=zoomUnits;}vec3 nw=getNormalAndWidth(position.xy,previous.xy,next.xy,width);width=nw.z;vec2 normal=nw.xy;vNormal=normal*direction;normal*=width/2.0;float offsetXy=uOffset;float offsetHeight=uOffset/100.0;if(uUnitPx){offsetXy/=zoomUnits;offsetHeight*=zoomUnits;}gl_Position=uMatrix*vec4(position.xy+normal*(direction+offsetXy),position.z+offsetHeight,1.0);}else{vec4 previousProjected=uMatrix*vec4(previous,1.0);vec4 currentProjected=uMatrix*vec4(position,1.0);vec4 nextProjected=uMatrix*vec4(next,1.0);vec2 currentScreen=project(currentProjected);vec2 previousScreen=project(previousProjected);vec2 nextScreen=project(nextProjected);float width=thickness*devicePixelRatio;if(!uUnitPx){width/=zoomUnits;}vec3 nw=getNormalAndWidth(currentScreen,previousScreen,nextScreen,width);width=nw.z;vec2 normal=nw.xy;vNormal=normal*direction;normal*=width/2.0;vec2 pos=currentScreen+normal*direction;vec4 finalPos=unproject(pos,currentProjected.z,currentProjected.w);gl_Position=finalPos;}}`,fragmentShader:`precision highp float;varying vec4 vColor;varying vec2 vNormal;varying vec2 vUV;varying vec2 vDashArray;varying float vCounter;varying float vTotalDistance;uniform bool uAntialias;uniform float uDashOffset;uniform float zoomUnits;uniform float thickness;
#if defined(USE_TEXTURE)
uniform float uTextureMargin;uniform sampler2D textureImage;
#endif
void main(){vec4 color=vColor;if(uAntialias){float blur=1.0;blur=1.0-smoothstep(0.8,1.0,length(vNormal));color.a*=blur;}
#if defined(USE_TEXTURE)
float segLen=uTextureMargin*zoomUnits;float textureLen=thickness*zoomUnits;float deltaX=mod(vUV.x,segLen);float middle=segLen/2.0;if(deltaX>=middle&&deltaX<=middle+textureLen){float uvx=(deltaX-middle)/textureLen;vec4 texture=texture2D(textureImage,vec2(uvx,vUV.y));color=texture.a>=0.5 ? texture : color;}
#endif
if(vDashArray.y>0.0){float offset=uDashOffset*zoomUnits/vTotalDistance;color.a*=(1.0-step(vDashArray.x,mod(vCounter+offset,vDashArray.x+vDashArray.y)));}gl_FragColor=color;}`,defines:y},this),this.prevBuffer=new qe({gl:o,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.currentBuffer=new qe({gl:o,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.nextBuffer=new qe({gl:o,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.directionBuffer=new qe({gl:o,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.colorBuffer=new qe({gl:o,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.counterBuffer=new qe({gl:o,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.uvBuffer=new qe({gl:o,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.indexBuffer=new qe({gl:o,target:"ELEMENT_ARRAY_BUFFER",usage:"STATIC_DRAW"}),y=[{stride:12,name:"previous",buffer:this.prevBuffer,size:3,type:"FLOAT",offset:0},{stride:12,name:"position",buffer:this.currentBuffer,size:3,type:"FLOAT",offset:0},{stride:12,name:"next",buffer:this.nextBuffer,size:3,type:"FLOAT",offset:0},{stride:4,name:"direction",buffer:this.directionBuffer,size:1,type:"FLOAT",offset:0},{stride:16,name:"aColor",buffer:this.colorBuffer,size:4,type:"FLOAT",offset:0},{stride:8,name:"aDistance",buffer:this.counterBuffer,size:1,type:"FLOAT",offset:0},{stride:8,name:"aTotalDistance",buffer:this.counterBuffer,size:1,type:"FLOAT",offset:4}],y=y.concat(this.getCommonAttributes()),Pd[a.style]&&(y.push({stride:8,name:"uv",buffer:this.uvBuffer,size:2,type:"FLOAT",offset:0}),this.setOptions({texture:Pd[a.style]}),this.loadTexture()),this.vertexArray=new bi({gl:o,program:this.program,attributes:y})}},{key:"onDestroy",value:function(){}},{key:"onChanged",value:function(o,a){var y=this;if(this.gl){this.initData();for(var g=o.color,x=[],v=0;v<a.length;v++){var M=[],D=a[v].geometry.coordinates;D&&0<D.length&&(M=a[v].geometry.type==="MultiPolygon"?D.reduce(function(L,B){return L.concat(B)})[0].map(function(L){return y.normizedPoint(L)}):a[v].geometry.type==="Polygon"||a[v].geometry.type==="MultiLineString"?D[0].map(function(L){return y.normizedPoint(L)}):D.map(function(L){return y.normizedPoint(L)})),D=this.getProperty("color",g,a[v]),D=this.getProperty("lineColor",g,a[v]),D=this.normizedColor(D);for(var U=this.addMultipleCoords(M),C=0;C<U.length;C++)this.processData(this.dataMgr,U[C],D);if(o.enablePicked)for(D=this.indexToRgb(v),U=0;U<M.length;U++)x.push(D[0]/255,D[1]/255,D[2]/255),x.push(D[0]/255,D[1]/255,D[2]/255),o.repeat&&(x.push(D[0]/255,D[1]/255,D[2]/255),x.push(D[0]/255,D[1]/255,D[2]/255),x.push(D[0]/255,D[1]/255,D[2]/255),x.push(D[0]/255,D[1]/255,D[2]/255))}this.counterBuffer.updateData(new Float32Array(this.dataMgr.counter)),this.currentBuffer.updateData(new Float32Array(this.dataMgr.position)),this.prevBuffer.updateData(new Float32Array(this.dataMgr.prev)),this.nextBuffer.updateData(new Float32Array(this.dataMgr.next)),this.directionBuffer.updateData(new Float32Array(this.dataMgr.direction)),this.colorBuffer.updateData(new Float32Array(this.dataMgr.color)),this.indexBuffer.updateData(new Uint32Array(this.dataMgr.index)),this.isUseTexture&&this.uvBuffer.updateData(new Float32Array(this.dataMgr.uv)),o.enablePicked&&this.pickBuffer.updateData(new Float32Array(x))}}},{key:"processData",value:function(o,a,y){var g,x,v,M,D,U,C,L,B=a.length,O=o.position.length/6,k=Fa(a),j=k.arr,V=k.total;k=as(j.map(function(ct){return[ct,V]})),j=j.map(function(ct){return[ct,0,ct,1]});var Y=as(a.map(function(ct){return-1}),!0),Q=as(a),nt=as(a.map(qp(-1))),ut=as(a.map(qp(1)));a=as(a.map(function(ct){return y})),B=n1(B,O),(g=o.uv).push.apply(g,Wr(ta(j))),(x=o.counter).push.apply(x,Wr(ta(k))),(v=o.position).push.apply(v,Wr(ta(Q))),(M=o.prev).push.apply(M,Wr(ta(nt))),(D=o.next).push.apply(D,Wr(ta(ut))),(U=o.direction).push.apply(U,Wr(Y)),(C=o.color).push.apply(C,Wr(ta(a))),(L=o.index).push.apply(L,Wr(B))}},{key:"render",value:function(o){var a=o.gl,y=o.matrix,g=this.dataMgr;if(g&&!(0>=g.index.length)&&this.map){var x=this.getOptions(),v=this.program;v.use(a),o=Vr(this.getCommonUniforms(o),{uMatrix:y,uFlat:x.flat,uUnitPx:x.unit==="px",zoomUnits:this.map.getZoomUnits(),devicePixelRatio:window.devicePixelRatio,thickness:x.width,uDashArray:x.dashArray,uDashOffset:x.dashOffset,uAntialias:x.antialias,uOffset:x.offset}),this.isUseTexture&&(o=Vr(o,{uTextureMargin:140,textureImage:this.texture})),v.setUniforms(o),this.setGLState({blend:!0,blendEquation:a.FUNC_ADD,blendFunc:x.blend==="lighter"?[a.SRC_ALPHA,a.ONE]:[a.SRC_ALPHA,a.ONE_MINUS_SRC_ALPHA],polygonOffset:x.polygonOffset}),this.indexBuffer.bind(),this.vertexArray.bind(),a.drawElements(a.TRIANGLES,g.index.length,a.UNSIGNED_INT,0)}}},{key:"loadTexture",value:function(o){var a=this,y=this.getOptions();y.texture?xn(this.gl,y.texture,function(g,x){a.image=x,a.texture=g,o&&o(),a.webglLayer.render()}):(this.image=this.texture=null,o&&o())}}]),h}(Ci),Q1=function(){function l(h){Xe(this,l),this.join=h.join||"miter",this.cap=h.cap||"butt",this.thickness=h.thickness||4,this.miterLimit=h.miterLimit||2*this.thickness,this.dash=h.dash||!1,this.complex={positions:[],indices:[],normals:[],colors:[],uvs:[],startIndex:0,maxDistance:0},this._lastFlip=-1,this._started=!1,this._normal=null,this._totalDistance=0,this._colorFlag=!1,this._count=0}return Ue(l,[{key:"extrude",value:function(h,o,a,y){var g=this.complex;if(1>=h.length)return g;this._lastFlip=-1,this._started=!1,this._normal=null,this._totalDistance=0;for(var x=h.length,v=g.startIndex,M=null,D=1;D<x;D++){var U=M||h[D-1],C=h[D],L=D<x-1?h[D+1]:null;L&&C[0]===L[0]&&C[1]===L[1]&&C[2]===L[2]?M=U:(U=this._segment(g,v,U,C,L,o,a,y),U!==-1&&(v+=U,M=null))}return this.dash&&(g.maxDistance=Math.max(this._totalDistance,g.maxDistance)),g.startIndex=g.positions.length/7,g}},{key:"_segment",value:function(h,o,a,y,g,x,v,M){M[0]instanceof Array&&(this._colorFlag=!0);var D=0,U=Zr.create(),C=Zr.create(),L=Zr.create(),B=Zr.create(),O=h.indices,k=h.positions,j=h.normals,V=h.colors;h=h.uvs;var Y=this.cap==="square",Q=this.cap==="round",nt=this.join==="bevel",ut=this.join==="round",ct=[y[0],y[1]],Tt=[a[0],a[1]];jo(C,ct,Tt);var Lt=0;if(this.dash&&(Lt=this._calcDistance(ct,Tt),this._totalDistance+=Lt),this._normal||(this._normal=Zr.create(),Ba(this._normal,C)),!this._started)if(this._started=!0,Y){Tt=Zr.create();var Dt=Zr.create();Zr.add(Tt,this._normal,C),Zr.sub(Dt,this._normal,C),j.push(Dt[0],Dt[1],0),j.push(Tt[0],Tt[1],0),k.push(a[0],a[1],a[2],this._totalDistance-Lt,x,v,0),k.push(a[0],a[1],a[2],this._totalDistance-Lt,-x,v,0),h.push(this._totalDistance-Lt,0,this._totalDistance-Lt,1),this._colorFlag?(V.push(M[0][0],M[0][1],M[0][2],M[0][3]),V.push(M[0][0],M[0][1],M[0][2],M[0][3])):(V.push(M[0],M[1],M[2],M[3]),V.push(M[0],M[1],M[2],M[3]))}else if(Q){Tt=Zr.fromValues(-C[0],-C[1]),Dt=Zr.create(),Zr.sub(Dt,this._normal,C),Zr.normalize(Dt,Dt);var ae=Zr.create();Zr.add(ae,this._normal,C),Zr.normalize(ae,ae);var ne=Zr.fromValues(this._normal[0],this._normal[1]),we=Zr.fromValues(-this._normal[0],-this._normal[1]);for(j.push(Tt[0],Tt[1],0),j.push(Dt[0],Dt[1],0),j.push(-ae[0],-ae[1],0),j.push(ne[0],ne[1],0),j.push(we[0],we[1],0),Tt=0;5>Tt;Tt++)k.push(a[0],a[1],a[2],this._totalDistance-Lt,x,v,0),h.push(this._totalDistance-Lt,0),this._colorFlag?V.push(M[0][0],M[0][1],M[0][2],M[0][3]):V.push(M[0],M[1],M[2],M[3]);O.push(o+0,o+2,o+1,o+1,o+2,o+3,o+3,o+2,o+4),D+=3,o+=3}else this._extrusions(k,j,h,V,a,this._normal,x,this._totalDistance-Lt,v,M,0);if(O.push.apply(O,Wr(this._lastFlip===-1?[o+0,o+1,o+2]:[o+1,o+0,o+2])),g)jo(L,[g[0],g[1]],ct),this._count++,Zr.create(),Zr.add(B,C,L),Zr.normalize(B,B),Q=Zr.fromValues(-B[1],B[0]),C=Zr.fromValues(-C[1],C[0]),C=[x/Zr.dot(Q,C),Q],C=Ri(C,2),Q=C[0],C=C[1],B=0<Zr.dot(B,this._normal)?-1:1,nt||this.join!=="miter"||Math.abs(Q)>this.miterLimit&&(nt=!0),nt?(ut=Math.min(2*x,Math.abs(Q)),j.push(this._normal[0],this._normal[1],0),j.push(C[0],C[1],0),k.push(y[0],y[1],y[2],this._totalDistance,x*B,v,0),k.push(y[0],y[1],y[2],this._totalDistance,-ut*B,v,0),O.push.apply(O,Wr(this._lastFlip===-B?[o+2,o+1,o+3]:[o+0,o+2,o+3])),Ba(U,L),Zr.copy(this._normal,U),j.push(this._normal[0],this._normal[1],0),k.push(y[0],y[1],y[2],this._totalDistance,x*B,v,0),O.push.apply(O,Wr(B===1?[o+2,o+3,o+4]:[o+3,o+2,o+4])),this._flipedUV(h,this._totalDistance,B,!0),this._colorFlag?(V.push(M[this._count][0],M[this._count][1],M[this._count][2],M[this._count][3]),V.push(M[this._count][0],M[this._count][1],M[this._count][2],M[this._count][3]),V.push(M[this._count][0],M[this._count][1],M[this._count][2],M[this._count][3])):(V.push(M[0],M[1],M[2],M[3]),V.push(M[0],M[1],M[2],M[3]),V.push(M[0],M[1],M[2],M[3])),D+=3):ut?(ut=Math.min(2*x,Math.abs(Q)),j.push(this._normal[0],this._normal[1],0),j.push(C[0],C[1],0),j.push(C[0],C[1],0),k.push(y[0],y[1],y[2],this._totalDistance,x*B,v,0),k.push(y[0],y[1],y[2],this._totalDistance,x*B,v,0),k.push(y[0],y[1],y[2],this._totalDistance,-ut*B,v,0),O.push.apply(O,Wr(this._lastFlip===-B?[o+2,o+1,o+4,o+2,o+4,o+3]:[o+0,o+2,o+4,o+2,o+3,o+4])),Ba(U,L),Zr.copy(this._normal,U),j.push(this._normal[0],this._normal[1],0),k.push(y[0],y[1],y[2],this._totalDistance,x*B,v,0),O.push.apply(O,Wr(B===1?[o+4,o+3,o+5]:[o+3,o+4,o+5])),this._flipedUV(h,this._totalDistance,B,!1),this._colorFlag?(V.push(M[this._count][0],M[this._count][1],M[this._count][2],M[this._count][3]),V.push(M[this._count][0],M[this._count][1],M[this._count][2],M[this._count][3]),V.push(M[this._count][0],M[this._count][1],M[this._count][2],M[this._count][3]),V.push(M[this._count][0],M[this._count][1],M[this._count][2],M[this._count][3])):(V.push(M[0],M[1],M[2],M[3]),V.push(M[0],M[1],M[2],M[3]),V.push(M[0],M[1],M[2],M[3]),V.push(M[0],M[1],M[2],M[3])),D+=4):(this._extrusions(k,j,h,V,y,C,Q,this._totalDistance,v,M,this._count),O.push.apply(O,Wr(this._lastFlip===-1?[o+2,o+1,o+3]:[o+2,o+0,o+3])),B=-1,Zr.copy(this._normal,C),D+=2),this._lastFlip=B;else if(Ba(this._normal,C),U=M.length-1,Y?(L=Zr.create(),ut=Zr.create(),Zr.add(L,C,this._normal),Zr.sub(ut,C,this._normal),j.push(L[0],L[1],0),j.push(ut[0],ut[1],0),k.push(y[0],y[1],y[2],this._totalDistance,x,v,0),k.push(y[0],y[1],y[2],this._totalDistance,x,v,0),h.push(this._totalDistance,0,this._totalDistance,1),this._colorFlag?(V.push(M[U][0],M[U][1],M[U][2],M[U][3]),V.push(M[U][0],M[U][1],M[U][2],M[U][3])):(V.push(M[0],M[1],M[2],M[3]),V.push(M[0],M[1],M[2],M[3]))):this._extrusions(k,j,h,V,y,this._normal,x,this._totalDistance,v,M,U),O.push.apply(O,Wr(this._lastFlip===-1?[o+2,o+1,o+3]:[o+2,o+0,o+3])),D+=2,Q){for(L=Zr.create(),Zr.add(L,C,this._normal),Zr.normalize(L,L),ut=Zr.create(),Zr.sub(ut,C,this._normal),Zr.normalize(ut,ut),C=Zr.fromValues(C[0],C[1]),j.push(L[0],L[1],0),j.push(ut[0],ut[1],0),j.push(C[0],C[1],0),j=0;3>j;j++)k.push(y[0],y[1],y[2],this._totalDistance,x,v,0),h.push(this._totalDistance,0),this._colorFlag?V.push(M[U][0],M[U][1],M[U][2],M[U][3]):V.push(M[0],M[1],M[2],M[3]);O.push(o+2,o+3,o+4,o+4,o+3,o+5,o+4,o+5,o+6),D+=3}return D}},{key:"_extrusions",value:function(h,o,a,y,g,x,v,M,D,U,C){o.push(x[0],x[1],0),o.push(x[0],x[1],0),h.push(g[0],g[1],g[2],M,v,D,0),h.push(g[0],g[1],g[2],M,-v,D,0),a.push(M,0,M,1),this._colorFlag?(y.push(U[C][0],U[C][1],U[C][2],U[C][3]),y.push(U[C][0],U[C][1],U[C][2],U[C][3])):(y.push(U[0],U[1],U[2],U[3]),y.push(U[0],U[1],U[2],U[3]))}},{key:"_calcDistance",value:function(h,o){return Math.sqrt(Math.pow(h[0]-o[0],2)+Math.pow(h[1]-o[1],2))}},{key:"_flipedUV",value:function(h,o,a,y){y?a===-1?h.push(o,0,o,1,o,0):h.push(o,1,o,0,o,1):a===-1?h.push(o,0,o,0,o,1,o,0):h.push(o,1,o,1,o,0,o,1)}}]),l}(),ju={normal:null,road:Th,arrow:function(){var l=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{},h=l.width;l=l.color;var o=Ch(),a=o.canvas;return o=o.ctx,o.save(),o.moveTo(5,0),o.lineTo(32,16),o.lineTo(5,32),o.strokeStyle=l||"#fff",o.lineWidth=h||8,o.stroke(),o.restore(),a}},Dd=function(l){function h(o,a){return Xe(this,h),o=_r(this,(h.__proto__||ur(h)).call(this,o,a)),o.name="LineLayer",o}return yr(h,l),Ue(h,[{key:"getDefaultOptions",value:function(){return{style:"normal",styleOptions:{},color:"rgba(25, 25, 250, 1)",blend:"default",lineJoin:"miter",lineCap:"butt",unit:"px",width:4,offset:0,antialias:!1,dashArray:[0,0],dashOffset:0,animation:!1,interval:.1,duration:2,trailLength:.5,minZoom:2,maxZoom:25,polygonOffset:[0,0],depthTest:!0,depthWrite:!0}}},{key:"initialize",value:function(o){this.gl=o;var a=this.getOptions(),y=[];a.enablePicked&&y.push("PICK"),ju[a.style]&&(this.isUseTexture=!0,this.prevStyle=a.style,this.prevStyleOptions=a.styleOptions,y.push("USE_TEXTURE")),a.animation===!0&&(this.isAnimateLine=!0,this.date=new Date,this.autoUpdate=!0,y.push("USE_LINE_ANIMATION")),a.useDash===!0&&y.push("USE_SIMPLE_DASH"),this.program=new jr(this.gl,{vertexShader:`precision highp float;uniform vec4 uSelectedColor;uniform mat4 u_matrix;uniform vec2 u_dash_array;uniform float u_zoom_units;uniform float u_zIndex;uniform bool u_unit_px;attribute vec4 a_color;attribute vec3 a_position;attribute vec3 a_normal;attribute float a_distance;attribute float a_total_distance;attribute float a_width;attribute float a_offset;
#if defined(USE_TEXTURE)
attribute vec2 uv;
#endif
varying vec4 v_color;varying vec2 v_normal;varying vec2 v_uv;varying vec2 v_dash_array;varying float v_total_distance;varying float v_counter;varying float v_width;
#if defined(USE_SIMPLE_DASH)
varying vec3 v_position;
#endif
void main(){v_width=a_width;v_color=a_color;v_counter=a_distance/a_total_distance;v_dash_array=u_dash_array/a_total_distance;if(u_unit_px){v_dash_array*=u_zoom_units;}v_total_distance=a_total_distance;v_normal=vec2(normalize(a_normal.xy)*sign(a_width));
#if defined(USE_TEXTURE)
v_uv=uv;
#endif
#if defined(PICK)
if(mapvIsPicked()){v_color=uSelectedColor;}
#endif
vec2 extrude=a_normal.xy*a_width/2.0;if(u_unit_px){extrude*=u_zoom_units;}vec2 offsetXY=a_normal.xy*-a_offset;float offsetZ=a_offset/100.0+u_zIndex;if(u_unit_px){offsetXY*=u_zoom_units;offsetZ*=u_zoom_units;}
#if defined(USE_SIMPLE_DASH)
v_position=a_position;
#endif
gl_Position=u_matrix*vec4(a_position.xy+extrude+offsetXY,a_position.z+offsetZ,1.0);}`,fragmentShader:`precision highp float;varying vec4 v_color;varying vec2 v_normal;varying vec2 v_uv;varying vec2 v_dash_array;varying float v_counter;varying float v_total_distance;varying float v_width;
#if defined(USE_SIMPLE_DASH)
varying vec3 v_position;
#endif
uniform bool u_antialias;uniform float u_dash_offset;uniform float u_zoom_units;
#if defined(USE_LINE_ANIMATION)
uniform bool u_animate;uniform float u_time;uniform float u_duration;uniform float u_interval;uniform float u_trail_length;
#endif
#if defined(USE_TEXTURE)
uniform float u_texture_width;uniform float u_texture_margin;uniform sampler2D u_sampler;
#endif
void main(){vec4 color=v_color;
#if defined(USE_SIMPLE_DASH)
if(mod(v_position.x,5.0)<3.0){discard;}
#endif
if(u_antialias){float blur=1.0;blur=1.0-smoothstep(0.9,1.0,length(v_normal));color.a*=blur;}
#if defined(USE_LINE_ANIMATION)
if(u_animate){float alpha=1.0-fract(mod(1.0-v_counter,u_interval)*(1.0/u_interval)+u_time/u_duration);alpha=(alpha+u_trail_length-1.0)/u_trail_length;color.a*=alpha;gl_FragColor=color;return;}
#endif
#if defined(USE_TEXTURE)
float margin_width=u_texture_margin*u_zoom_units;float margin_width_half=margin_width/2.0;float texture_width=u_texture_width*u_zoom_units;float delta=mod(v_uv.x,texture_width+margin_width);if(delta>=margin_width_half&&delta<=margin_width_half+texture_width){float uvx=(delta-margin_width_half)/texture_width;vec4 texture=texture2D(u_sampler,vec2(uvx,v_uv.y));color=texture.a>=0.5 ? texture : color;}
#endif
if(v_dash_array.y>0.0){float offset=u_dash_offset*u_zoom_units/v_total_distance;color.a*=(1.0-step(v_dash_array.x,mod(v_counter+offset,v_dash_array.x+v_dash_array.y)));}gl_FragColor=color;}`,defines:y},this),this.positionBuffer=new qe({gl:o,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.colorBuffer=new qe({gl:o,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.normalBuffer=new qe({gl:o,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.indexBuffer=new qe({gl:o,target:"ELEMENT_ARRAY_BUFFER",usage:"STATIC_DRAW"}),y=[{stride:28,name:"a_position",buffer:this.positionBuffer,size:3,type:"FLOAT",offset:0},{stride:28,name:"a_distance",buffer:this.positionBuffer,size:1,type:"FLOAT",offset:12},{stride:28,name:"a_width",buffer:this.positionBuffer,size:1,type:"FLOAT",offset:16},{stride:28,name:"a_offset",buffer:this.positionBuffer,size:1,type:"FLOAT",offset:20},{stride:28,name:"a_total_distance",buffer:this.positionBuffer,size:1,type:"FLOAT",offset:24},{stride:12,name:"a_normal",buffer:this.normalBuffer,size:3,type:"FLOAT",offset:0},{stride:16,name:"a_color",buffer:this.colorBuffer,size:4,type:"FLOAT",offset:0}],y=y.concat(this.getCommonAttributes()),this.isUseTexture&&(this.uvBuffer=new qe({gl:o,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),y.push({stride:8,name:"uv",buffer:this.uvBuffer,size:2,type:"FLOAT",offset:0}),a=(0,ju[a.style])(a.styleOptions),this.setOptions({texture:a}),this.loadTexture()),this.vertexArray=new bi({gl:o,program:this.program,attributes:y})}},{key:"onDestroy",value:function(){}},{key:"onChanged",value:function(o,a){var y=this,g=2<arguments.length&&arguments[2]!==void 0?arguments[2]:{};if(this.gl)if(!this.isUseTexture||this.prevStyle===o.style&&bl(this.prevStyleOptions)===bl(o.styleOptions))this.parseData(o,a,g);else{this.prevStyle=o.style,this.prevStyleOptions=o.styleOptions;var x=(0,ju[o.style])(o.styleOptions);this.setOptions({texture:x}),this.loadTextureTime&&clearTimeout(this.loadTextureTime),this.loadTextureTime=setTimeout(function(){y.loadTexture(function(){y.parseData(o,a,g)})},0)}}},{key:"onParseProperties",value:function(o){return this.normizedColor(o)}},{key:"parseData",value:function(o,a,y){var g=this,x=o.dashArray,v=o.width,M=o.color,D=o.offset;x=!!this.isUseTexture||!!x[1]||!!this.isAnimateLine;for(var U=new Q1({dash:x,cap:o.lineCap,join:o.lineJoin,miterLimit:o.miterLimit,thickness:v}),C=[],L=function(O){var k=a[O].geometry.coordinates;k&&0<k.length&&(a[O].geometry.type==="MultiPolygon"?k=k.reduce(function(ut,ct){return ut.concat(ct)}):a[O].geometry.type==="LineString"&&(k=[k]),k=k.map(function(ut){return ut=ut.map(function(ct){return g.normizedPoint(ct)}),y.closePath===!0&&ut[0].toString()!==ut[ut.length-1].toString()&&ut.push(ut[0]),ut}));var j=g.getProperty("color",M,a[O]);j=g.onParseProperties(j,a[0].geometry.coordinates.length);var V=g.getProperty("width",v,a[O]);V=Number(V);var Y=g.getProperty("offset",D,a[O]);Y=Number(Y);var Q=U.complex.startIndex;k=g.addMultipleCoords(k);for(var nt=0;nt<k.length;nt++)k[nt].forEach(function(ut){U.extrude(ut,V,Y,j)});if(o.enablePicked)for(O=g.indexToRgb(O),k=U.complex.startIndex;Q<k;Q++)C.push(O[0]/255,O[1]/255,O[2]/255),o.repeat&&(C.push(O[0]/255,O[1]/255,O[2]/255),C.push(O[0]/255,O[1]/255,O[2]/255))},B=0;B<a.length;B++)L(B);if(L=U.complex,x)for(B=0;B<L.positions.length/7;B++)L.positions[7*B+6]=L.maxDistance;this.lineData=L,this.positionBuffer.updateData(new Float32Array(L.positions)),this.normalBuffer.updateData(new Float32Array(L.normals)),this.colorBuffer.updateData(new Float32Array(L.colors)),this.indexBuffer.updateData(new Uint32Array(L.indices)),this.isUseTexture&&this.uvBuffer.updateData(new Float32Array(L.uvs)),o.enablePicked&&this.pickBuffer.updateData(new Float32Array(C))}},{key:"render",value:function(o){var a=o.gl,y=o.matrix,g=this.lineData;if(g&&!(0>=g.indices.length)&&this.map){var x=this.getOptions(),v=this.program;v.use(a),o=Vr(this.getCommonUniforms(o),{u_matrix:y,u_zoom_units:this.map.getZoomUnits(),u_dash_array:x.dashArray,u_dash_offset:x.dashOffset,u_antialias:x.antialias,u_unit_px:x.unit==="px",u_zIndex:x.zIndex}),this.isUseTexture&&(o=Vr(o,{u_texture_width:x.width,u_texture_margin:140,u_sampler:this.texture})),this.isAnimateLine&&(y=this.map.getZoom(),o=Vr(o,{u_time:(new Date-this.date)/1e3,u_animate:!!(y>=x.minZoom&&y<=x.maxZoom&&this.autoUpdate),u_duration:x.duration,u_interval:x.interval,u_trail_length:x.trailLength})),v.setUniforms(o),this.setGLState({blend:!0,blendEquation:a.FUNC_ADD,blendFunc:$s(a,x.blend),polygonOffset:x.polygonOffset,depthTest:x.depthTest,depthMask:x.depthWrite}),this.indexBuffer.bind(),this.vertexArray.bind(),a.drawElements(a.TRIANGLES,g.indices.length,a.UNSIGNED_INT,0)}}},{key:"loadTexture",value:function(o){var a=this,y=this.getOptions();y.texture?xn(this.gl,y.texture,function(g,x){a.image=x,a.texture=g,o&&o(),a.webglLayer.render()}):(this.image=this.texture=null,o&&o())}}]),h}(Ci),FA=function(l){function h(o,a){return Xe(this,h),o=_r(this,(h.__proto__||ur(h)).call(this,o,a)),o.name="LineRainbowLayer",o}return yr(h,l),Ue(h,[{key:"getDefaultOptions",value:function(){return{style:"normal",styleOptions:{},color:"rgba(25, 25, 250, 1)",blend:"normal",lineJoin:"miter",lineCap:"butt",unit:"px",width:4,offset:0,antialias:!1,dashArray:[0,0],dashOffset:0,animation:!1,interval:.1,duration:2,trailLength:.5,minZoom:2,maxZoom:25,polygonOffset:[0,0],depthTest:!0,depthWrite:!0}}},{key:"onDestroy",value:function(){this.options&&this.options.enablePicked&&(this.pickBuffer=null),this.options=this.data=this.indexBuffer=this.normalBuffer=this.colorBuffer=this.positionBuffer=this.program=this.vertexArray=null}},{key:"onParseProperties",value:function(o,a){var y=o.length;if(o instanceof Array){var g=[];if(y<a){var x=Math.floor(a/y);a%=y;for(var v=0,M=0;v<y;v++,M++)for(var D=M<a?x+1:x,U=0;U<D;U++)g.push(o[v]);o=g}for(y=[],x=0;x<o.length;x++)y.push(this.normizedColor(o[x]))}else y=this.normizedColor(o);return y}}]),h}(Dd),ma=function(){function l(h,o){Xe(this,l),this.layer=h,this.gl=o,this.initData()}return Ue(l,[{key:"initData",value:function(){this.outWall3d={vertex:[],vertexBuffer:[],index:[],indexBuffer:[]},this.maxLength=0}},{key:"getData",value:function(){return this.outWall3d}},{key:"getMaxDataLength",value:function(){return this.maxLength}},{key:"onLayerChange",value:function(h,o){this.initData();var a=h.color,y=h.height,g=h.gradient;h=this.gl;for(var x=0;x<o.length;x++){var v=o[x].geometry.coordinates,M=v.length;this.maxLength=M>this.maxLength?M:this.maxLength;for(var D=[],U=0;U<M;U++){var C=this.layer.normizedPoint(v[U]);D.push(C)}M=o[x].color||a,"properties"in o[x]&&"color"in o[x].properties&&(M=o[x].properties.color),g||Object.prototype.toString.call(M)!=="[object Function]"||(M=M(o[x])),v=this.layer.normizedColor(g?g[0]:M),M=this.layer.normizedColor(g?g[1]:M),U=o[x].height||y,"properties"in o[x]&&"height"in o[x].properties&&(U=o[x].properties.height),Object.prototype.toString.call(U)==="[object Function]"&&(U=U(o[x])),this.processData(this.outWall3d,D,v,M,U)}for(o=0;o<this.outWall3d.vertex.length;o++){for(a=[],y=this.outWall3d.vertex[o].length,g=0;g<y;g++)a.push.apply(a,Wr(this.outWall3d.vertex[o][g]));y=h.createBuffer(),h.bindBuffer(h.ARRAY_BUFFER,y),h.bufferData(h.ARRAY_BUFFER,new Float32Array(a),h.STATIC_DRAW),this.outWall3d.vertexBuffer[o]=y,h.bindBuffer(h.ARRAY_BUFFER,null),y=h.createBuffer(),h.bindBuffer(h.ELEMENT_ARRAY_BUFFER,y),h.bufferData(h.ELEMENT_ARRAY_BUFFER,new Uint16Array(this.outWall3d.index[o]),h.STATIC_DRAW),this.outWall3d.indexBuffer[o]=y,h.bindBuffer(h.ELEMENT_ARRAY_BUFFER,null)}}},{key:"processData",value:function(h,o,a,y,g){var x=h.vertex[h.vertex.length-1],v=h.index[h.index.length-1],M=o.length;(!v||65536<=v.length+2*M+2)&&(x=[],v=[],h.vertex.push(x),h.index.push(v)),(h=x.length)&&v.push(h-1,h);for(var D=h=0;D<M;D++){var U=[],C=[],L=o[D];U.push(L[0],L[1]),U.push(L[2]?Number(L[2])+g:g),U.push(L[3]?Number(L[3]):D),U.push(h),U.push(a[0],a[1],a[2],a[3]),C.push(L[0],L[1]),C.push(L[2]?Number(L[2]):0),C.push(L[3]?Number(L[3]):D),C.push(h),C.push(y[0],y[1],y[2],y[3]),L=x.length,x.push(U,C),v.push(L,L+1),D<M-1&&(h+=this.getDistance(o[D],o[D+1]))}}},{key:"getDistance",value:function(h,o){return Math.sqrt(Math.pow(Math.abs(h[0]-o[0]),2)+Math.pow(Math.abs(h[1]-o[1]),2))}}]),l}(),kf=function(l){function h(o,a){return Xe(this,h),o=_r(this,(h.__proto__||ur(h)).call(this,o,a)),o.startTime=o.options.startTime||0,o.endTime=o.options.endTime,o.time=o.startTime,o.autoUpdate=!0,o}return yr(h,l),Ue(h,[{key:"getDefaultOptions",value:function(){return{height:100,color:[1,1,1,1],trailLength:3,step:.1}}},{key:"initialize",value:function(o){this.gl=o,this.dataMgr=new ma(this,this.gl),this.program=new jr(this.gl,{vertexShader:"uniform mat4 u_matrix;uniform float currentTime;uniform float trailLength;attribute vec4 aPos;attribute float aDistance;attribute vec4 aColor;varying vec4 vColor;varying float vHeight;varying float vTime;varying float vDistance;void main(){vTime=1.0-((currentTime-aPos.w)/trailLength);vHeight=aPos.z;vColor=aColor;vDistance=aDistance;gl_Position=u_matrix*vec4(aPos.xyz,1.0);}",fragmentShader:"precision highp float;varying vec4 vColor;varying float vTime;varying float vDistance;varying float vHeight;uniform float currentTime;void main(){if(vTime>1.0||vTime<0.0){}float radius=2.5;float distance=vDistance+currentTime*20.0;float modDistance=mod(distance,9.0);float alpha=1.0;if(modDistance>radius*2.0){discard;}else{float x=abs(modDistance-radius);float y=abs(vHeight-radius);float dis=sqrt(pow(x,2.0)+pow(y,2.0));if(dis>radius){discard;}alpha=dis/radius;}gl_FragColor=vec4(vColor.rgb,1.0-alpha);}"})}},{key:"onChanged",value:function(o,a){this.gl&&(this.dataMgr.onLayerChange(o,a),o.endTime===void 0&&(this.endTime=this.dataMgr.getMaxDataLength()))}},{key:"render",value:function(o){var a=o.gl,y=o.matrix;if((o=this.dataMgr.getData())&&!(0>=o.vertex.length)){var g=this.getOptions(),x=this.program;for(a.useProgram(x.program),this.setGLState({blend:!0,blendEquation:a.FUNC_ADD,blendFunc:[a.SRC_ALPHA,a.ONE_MINUS_SRC_ALPHA]}),a.enableVertexAttribArray(x.attributes.aPos),a.enableVertexAttribArray(x.attributes.aDistance),a.enableVertexAttribArray(x.attributes.aColor),a.uniformMatrix4fv(x.uniforms.u_matrix,!1,y),a.uniform1f(x.uniforms.currentTime,this.time),a.uniform1f(x.uniforms.trailLength,g.trailLength),y=0;y<o.vertex.length;y++)if(!(0>=o.vertex[y].length)){var v=o.vertex[y],M=new Float32Array(v[0]).BYTES_PER_ELEMENT;v=M*v[0].length,a.bindBuffer(a.ARRAY_BUFFER,o.vertexBuffer[y]),a.vertexAttribPointer(x.attributes.aPos,4,a.FLOAT,!1,v,0),a.vertexAttribPointer(x.attributes.aDistance,1,a.FLOAT,!1,v,4*M),a.vertexAttribPointer(x.attributes.aColor,4,a.FLOAT,!1,v,5*M),a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,o.indexBuffer[y]),a.drawElements(a.TRIANGLE_STRIP,o.index[y].length,a.UNSIGNED_SHORT,0),a.bindBuffer(a.ARRAY_BUFFER,null),a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,null)}this.time+=g.step,this.time>this.endTime&&(this.time=this.startTime)}}}]),h}(Ci),Zl=function(l,h,o,a){if(!(l instanceof h)||a!==void 0&&a in l)throw TypeError(o+": incorrect invocation!");return l},Xu=ht(function(l){var h={},o={};l=l.exports=function(a,y,g,x,v){v=v?function(){return a}:Af(a),g=Un(g,x,y?2:1),x=0;var M,D;if(typeof v!="function")throw TypeError(a+" is not iterable!");if(v===void 0||Ro.Array!==v&&Ul[pd]!==v){for(x=v.call(a);!(D=x.next()).done;)if(v=Vh(x,g,D.value,y),v===h||v===o)return v}else for(M=Qp(a.length);M>x;x++)if(v=y?g(to(D=a[x])[0],D[1]):g(a[x]),v===h||v===o)return v},l.BREAK=h,l.RETURN=o}),Hf=_n("species"),Gf=function(l,h){l=to(l).constructor;var o;return l===void 0||(o=to(l)[Hf])==null?h:Rs(o)},K1=function(l,h,o){var a=o===void 0;switch(h.length){case 0:return a?l():l.call(o);case 1:return a?l(h[0]):l.call(o,h[0]);case 2:return a?l(h[0],h[1]):l.call(o,h[0],h[1]);case 3:return a?l(h[0],h[1],h[2]):l.call(o,h[0],h[1],h[2]);case 4:return a?l(h[0],h[1],h[2],h[3]):l.call(o,h[0],h[1],h[2],h[3])}return l.apply(o,h)},Od=Qr.process,uv=Qr.setImmediate,$1=Qr.clearImmediate,ql=Qr.MessageChannel,Vf=Qr.Dispatch,Wf=0,jf={},ec=function(){var l=+this;if(jf.hasOwnProperty(l)){var h=jf[l];delete jf[l],h()}},ty=function(l){ec.call(l.data)};if(!uv||!$1)if(uv=function(l){for(var h=[],o=1;arguments.length>o;)h.push(arguments[o++]);return jf[++Wf]=function(){K1(typeof l=="function"?l:Function(l),h)},Xf(Wf),Wf},$1=function(l){delete jf[l]},Al(Od)=="process")var Xf=function(l){Od.nextTick(Un(ec,l,1))};else if(Vf&&Vf.now)Xf=function(l){Vf.now(Un(ec,l,1))};else if(ql){var di=new ql,Yu=di.port2;di.port1.onmessage=ty,Xf=Un(Yu.postMessage,Yu,1)}else Qr.addEventListener&&typeof postMessage=="function"&&!Qr.importScripts?(Xf=function(l){Qr.postMessage(l+"","*")},Qr.addEventListener("message",ty,!1)):Xf="onreadystatechange"in(td?_l.createElement("script"):{})?function(l){Ih.appendChild(td?_l.createElement("script"):{}).onreadystatechange=function(){Ih.removeChild(this),ec.call(l)}}:function(l){setTimeout(Un(ec,l,1),0)};var rc=uv,ey=Qr.MutationObserver||Qr.WebKitMutationObserver,lv=Qr.process,hv=Qr.Promise,$a=Al(lv)=="process",ic={f:function(l){return new Xo(l)}},Fd=function(l){try{return{e:!1,v:l()}}catch(h){return{e:!0,v:h}}},nc=Qr.navigator,BA=nc&&nc.userAgent||"",Yf=function(l,h){if(to(l),$n(h)&&h.constructor===l)return h;l=ic.f(l);var o=l.resolve;return o(h),l.promise},Zf=function(l,h,o){for(var a in h)o&&l[a]?l[a]=h[a]:Na(l,a,h[a]);return l},ry=_n("species"),cv=function(l){l=typeof Ui[l]=="function"?Ui[l]:Qr[l],Lo&&l&&!l[ry]&&Yo.f(l,ry,{configurable:!0,get:function(){return this}})},fv=function(){var l,h,o=function(){var v;for($a&&(v=lv.domain)&&v.exit();l;){var M=l.fn;l=l.next;try{M()}catch(D){throw l?a():h=void 0,D}}h=void 0,v&&v.enter()};if($a)var a=function(){lv.nextTick(o)};else if(!ey||Qr.navigator&&Qr.navigator.standalone)if(hv&&hv.resolve){var y=hv.resolve(void 0);a=function(){y.then(o)}}else a=function(){rc.call(Qr,o)};else{var g=!0,x=document.createTextNode("");new ey(o).observe(x,{characterData:!0}),a=function(){x.data=g=!g}}return function(v){v={fn:v,next:void 0},h&&(h.next=v),l||(l=v,a()),h=v}}(),iy=Qr.TypeError,Jl=Qr.process,pv=Jl&&Jl.versions,ny=pv&&pv.v8||"",$o=Qr.Promise,qf=Ga(Jl)=="process",Jf=function(){},Zu,oc=Zu=ic.f,so=!!function(){try{var l=$o.resolve(1),h=(l.constructor={})[_n("species")]=function(o){o(Jf,Jf)};return(qf||typeof PromiseRejectionEvent=="function")&&l.then(Jf)instanceof h&&ny.indexOf("6.6")!==0&&BA.indexOf("Chrome/66")===-1}catch{}}(),Qf=function(l){var h;return $n(l)&&typeof(h=l.then)=="function"?h:!1},sc=function(l,h){if(!l._n){l._n=!0;var o=l._c;fv(function(){for(var a=l._v,y=l._s==1,g=0;o.length>g;){var x=void 0,v=void 0,M=void 0,D=o[g++],U=y?D.ok:D.fail,C=D.resolve,L=D.reject,B=D.domain;try{U?(y||(l._h==2&&oy(l),l._h=1),U===!0?M=a:(B&&B.enter(),M=U(a),B&&(B.exit(),x=!0)),M===D.promise?L(iy("Promise-chain cycle")):(v=Qf(M))?v.call(M,C,L):C(M)):L(a)}catch(O){B&&!x&&B.exit(),L(O)}}l._c=[],l._n=!1,h&&!l._h&&bo(l)})}},bo=function(l){rc.call(Qr,function(){var h=l._v,o=l._h!==1&&(l._a||l._c).length===0,a,y;if(o){var g=Fd(function(){qf?Jl.emit("unhandledRejection",h,l):(a=Qr.onunhandledrejection)?a({promise:l,reason:h}):(y=Qr.console)&&y.error&&y.error("Unhandled promise rejection",h)});l._h=qf||l._h!==1&&(l._a||l._c).length===0?2:1}if(l._a=void 0,o&&g.e)throw g.v})},oy=function(l){rc.call(Qr,function(){var h;qf?Jl.emit("rejectionHandled",l):(h=Qr.onrejectionhandled)&&h({promise:l,reason:l._v})})},ac=function(l){var h=this;h._d||(h._d=!0,h=h._w||h,h._v=l,h._s=2,h._a||(h._a=h._c.slice()),sc(h,!0))},Ql=function(l){var h=this,o;if(!h._d){h._d=!0,h=h._w||h;try{if(h===l)throw iy("Promise can't be resolved itself");(o=Qf(l))?fv(function(){var a={_w:h,_d:!1};try{o.call(l,Un(Ql,a,1),Un(ac,a,1))}catch(y){ac.call(a,y)}}):(h._v=l,h._s=1,sc(h,!1))}catch(a){ac.call({_w:h,_d:!1},a)}}};if(!so){$o=function(l){Zl(this,$o,"Promise","_h"),Rs(l),ks.call(this);try{l(Un(Ql,this,1),Un(ac,this,1))}catch(h){ac.call(this,h)}};var ks=function(l){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1};ks.prototype=Zf($o.prototype,{then:function(l,h){var o=oc(Gf(this,$o));return o.ok=typeof l=="function"?l:!0,o.fail=typeof h=="function"&&h,o.domain=qf?Jl.domain:void 0,this._c.push(o),this._a&&this._a.push(o),this._s&&sc(this,!1),o.promise},catch:function(l){return this.then(void 0,l)}});var Kf=function(){var l=new ks;this.promise=l,this.resolve=Un(Ql,l,1),this.reject=Un(ac,l,1)};ic.f=oc=function(l){return l===$o||l===ys?new Kf(l):Zu(l)}}Ar(Ar.G+Ar.W+Ar.F*!so,{Promise:$o}),Fi($o,"Promise"),cv("Promise");var ys=Ui.Promise;Ar(Ar.S+Ar.F*!so,"Promise",{reject:function(l){var h=oc(this),o=h.reject;return o(l),h.promise}}),Ar(Ar.S+1*Ar.F,"Promise",{resolve:function(l){return Yf(this===ys?$o:this,l)}}),Ar(Ar.S+Ar.F*!(so&&A1(function(l){$o.all(l).catch(Jf)})),"Promise",{all:function(l){var h=this,o=oc(h),a=o.resolve,y=o.reject,g=Fd(function(){var x=[],v=0,M=1;Xu(l,!1,function(D){var U=v++,C=!1;x.push(void 0),M++,h.resolve(D).then(function(L){C||(C=!0,x[U]=L,--M||a(x))},y)}),--M||a(x)});return g.e&&y(g.v),o.promise},race:function(l){var h=this,o=oc(h),a=o.reject,y=Fd(function(){Xu(l,!1,function(g){h.resolve(g).then(o.resolve,a)})});return y.e&&a(y.v),o.promise}}),Ar(Ar.P+Ar.R,"Promise",{finally:function(l){var h=Gf(this,Ui.Promise||Qr.Promise),o=typeof l=="function";return this.then(o?function(a){return Yf(h,l()).then(function(){return a})}:l,o?function(a){return Yf(h,l()).then(function(){throw a})}:l)}}),Ar(Ar.S,"Promise",{try:function(l){var h=ic.f(this);return l=Fd(l),(l.e?h.reject:h.resolve)(l.v),h.promise}});var uc=Ui.Promise,dv=ht(function(l){l.exports={default:uc,__esModule:!0}}),ga=ot(dv),va=function(l,h){if(!$n(l)||l._t!==h)throw TypeError("Incompatible receiver, "+h+" required!");return l},sy=Yo.f,Bd=El.fastKey,qu=Lo?"_s":"size",$f=function(l,h){var o=Bd(h);if(o!=="F")return l._i[o];for(l=l._f;l;l=l.n)if(l.k==h)return l},mv={getConstructor:function(l,h,o,a){var y=l(function(g,x){Zl(g,y,h,"_i"),g._t=h,g._i=ia(null),g._f=void 0,g._l=void 0,g[qu]=0,x!=null&&Xu(x,o,g[a],g)});return Zf(y.prototype,{clear:function(){for(var g=va(this,h),x=g._i,v=g._f;v;v=v.n)v.r=!0,v.p&&(v.p=v.p.n=void 0),delete x[v.i];g._f=g._l=void 0,g[qu]=0},delete:function(g){var x=va(this,h);if(g=$f(x,g)){var v=g.n,M=g.p;delete x._i[g.i],g.r=!0,M&&(M.n=v),v&&(v.p=M),x._f==g&&(x._f=v),x._l==g&&(x._l=M),x[qu]--}return!!g},forEach:function(g){va(this,h);for(var x=Un(g,1<arguments.length?arguments[1]:void 0,3),v;v=v?v.n:this._f;)for(x(v.v,v.k,this);v&&v.r;)v=v.p},has:function(g){return!!$f(va(this,h),g)}}),Lo&&sy(y.prototype,"size",{get:function(){return va(this,h)[qu]}}),y},def:function(l,h,o){var a=$f(l,h),y;return a?a.v=o:(l._l=a={i:y=Bd(h,!0),k:h,v:o,p:h=l._l,n:void 0,r:!1},l._f||(l._f=a),h&&(h.n=a),l[qu]++,y!=="F"&&(l._i[y]=a)),l},getEntry:$f,setStrong:function(l,h,o){Sl(l,h,function(a,y){this._t=va(a,h),this._k=y,this._l=void 0},function(){for(var a=this._k,y=this._l;y&&y.r;)y=y.p;return this._t&&(this._l=y=y?y.n:this._t._f)?a=="keys"?Ds(0,y.k):a=="values"?Ds(0,y.v):Ds(0,[y.k,y.v]):(this._t=void 0,Ds(1))},o?"entries":"values",!o,!0),cv(h)}},ay=_n("species"),uy=function(l,h){if(Ll(l)){var o=l.constructor;typeof o!="function"||o!==Array&&!Ll(o.prototype)||(o=void 0),$n(o)&&(o=o[ay],o===null&&(o=void 0))}return new(o===void 0?Array:o)(h)},ly=Yo.f,hy=function(l,h){var o=l==1,a=l==2,y=l==3,g=l==4,x=l==6,v=l==5||x,M=h||uy;return function(D,U,C){var L=Object(Eu(D)),B=cg(L);U=Un(U,C,3),C=Qp(B.length);var O=0;D=o?M(D,C):a?M(D,0):void 0;for(var k,j;C>O;O++)if((v||O in B)&&(k=B[O],j=U(k,O,L),l)){if(o)D[O]=j;else if(j)switch(l){case 3:return!0;case 5:return k;case 6:return O;case 2:D.push(k)}else if(g)return!1}return x?-1:y||g?g:D}}(0);(function(l,h,o,a,y,g){var x=Qr[l],v=x,M=y?"set":"add",D=v&&v.prototype,U={};return Lo&&typeof v=="function"&&(g||D.forEach&&!za(function(){new v().entries().next()}))?(v=h(function(C,L){Zl(C,v,l,"_c"),C._c=new x,L!=null&&Xu(L,y,C[M],C)}),hy("add clear delete forEach get has set keys values entries toJSON".split(" "),function(C){var L=C=="add"||C=="set";C in D&&(!g||C!="clear")&&Na(v.prototype,C,function(B,O){return Zl(this,v,C),!L&&g&&!$n(B)?C=="get"?void 0:!1:(B=this._c[C](B===0?0:B,O),L?this:B)})}),g||ly(v.prototype,"size",{get:function(){return this._c.size}})):(v=a.getConstructor(h,l,y,M),Zf(v.prototype,o),El.NEED=!0),Fi(v,l),U[l]=v,Ar(Ar.G+Ar.W+Ar.F,U),g||a.setStrong(v,l,y),v})("Map",function(l){return function(){return l(this,0<arguments.length?arguments[0]:void 0)}},{get:function(l){return(l=mv.getEntry(va(this,"Map"),l))&&l.v},set:function(l,h){return mv.def(va(this,"Map"),l===0?0:l,h)}},mv,!0),Ar(Ar.P+Ar.R,"Map",{toJSON:function(l){return function(){if(Ga(this)!=l)throw TypeError(l+"#toJSON isn't generic");var h=[];return Xu(this,!1,h.push,h,void 0),h}}("Map")}),function(l){Ar(Ar.S,l,{of:function(){for(var h=arguments.length,o=Array(h);h--;)o[h]=arguments[h];return new this(o)}})}("Map"),function(l){Ar(Ar.S,l,{from:function(h,o,a){var y;if(Rs(this),(y=o!==void 0)&&Rs(o),h==null)return new this;var g=[];if(y){var x=0,v=Un(o,a,2);Xu(h,!1,function(M){g.push(v(M,x++))})}else Xu(h,!1,g.push,g);return new this(g)}})}("Map");var cy=Ui.Map,fy=ht(function(l){l.exports={default:cy,__esModule:!0}}),tu=ot(fy),zA=ht(function(l,h){h.__esModule=!0;var o=ra&&ra.__esModule?ra:{default:ra};h.default=function(a,y,g){return y in a?(0,o.default)(a,y,{value:g,enumerable:!0,configurable:!0,writable:!0}):a[y]=g,a}}),ya=ot(zA),xa,ts,es=(xa={},ya(xa,1,1),ya(xa,2,1),ya(xa,3,1),xa),NA=(ts={},ya(ts,1,1),ya(ts,2,1),ya(ts,3,1),ts),Ju=function(l){function h(o,a){return Xe(this,h),o=_r(this,(h.__proto__||ur(h)).call(this,o,a)),o.vertCount=0,o.bufferMap={},o.bufferData=[],o.autoUpdate=!0,a=o.canvas=document.createElement("canvas"),o.ctx=a.getContext("2d"),o.iconHash=new tu,o}return yr(h,l),Ue(h,[{key:"getDefaultOptions",value:function(){return{color:[1,1,1,.8],speed:1,size:5,pointFade:!0,pointFadeBuffer:1,minLineLength:2,animationType:2,shapeType:2,depthTest:!1,delay:0,unit:"px",padding:0}}},{key:"initialize",value:function(o){this.gl=o,this.texture=null,this.isUseTexture=!1;var a=this.getOptions();this.updateUniformsFromOptions(a),this.program=new jr(this.gl,{vertexShader:"precision highp float;attribute vec3 aPos;attribute vec3 aNextPos;attribute vec4 aColor;attribute float aIndex;attribute float aNextIndex;attribute float aLength;attribute float aSpeed;attribute float aDelay;attribute vec3 aUV;uniform float uSize;uniform mat4 u_matrix;uniform float uOriginSpeed;uniform float uElapsedSteps;uniform int uAnimationType;uniform int uPointFade;uniform float uPointFadeBuffer;uniform float uZoomUnits;varying float vAddOpacity;varying vec3 vUV;varying vec4 vColor;void main(){vColor=aColor;if(uAnimationType==1){if(abs(aIndex-mod(uElapsedSteps,aLength))>.1){gl_Position=vec4(-2.,-2.,0,1.0);return;}gl_Position=u_matrix*vec4(aPos.xyz,1.0);vAddOpacity=1.;}else if(uAnimationType==2){float lineLength=aLength-1.;float cIndex=mod(uElapsedSteps,lineLength);float rest=cIndex-aIndex;if(rest<1.&&rest>=0.){if(uPointFade==1){if(cIndex<uPointFadeBuffer){vAddOpacity=cIndex/uPointFadeBuffer;}else if(cIndex>lineLength-uPointFadeBuffer){vAddOpacity=(lineLength-cIndex)/uPointFadeBuffer;}else{vAddOpacity=1.;}}else{vAddOpacity=1.;}gl_Position=u_matrix*vec4(aPos.x+(aNextPos.x-aPos.x)*rest,aPos.y+(aNextPos.y-aPos.y)*rest,aPos.z+(aNextPos.z-aPos.z)*rest,1.0);}else{gl_Position=vec4(-2.,-2.,0,1.0);return;}}else if(uAnimationType==3){float speedRatio=aSpeed/uOriginSpeed;float percent=mod(mod(uElapsedSteps*aSpeed,aLength)/aLength-aDelay,1.0);if(percent<=aNextIndex&&percent>=aIndex){if(uPointFade==1){float fadePercent=uPointFadeBuffer*1000./aLength;if(percent<fadePercent){vAddOpacity=percent/fadePercent;}else if(percent>1.-fadePercent){vAddOpacity=(1.-percent)/fadePercent;}else{vAddOpacity=1.;}}else{vAddOpacity=1.;}float rest=(percent-aIndex)/(aNextIndex-aIndex);gl_Position=u_matrix*vec4(aPos.x+(aNextPos.x-aPos.x)*rest,aPos.y+(aNextPos.y-aPos.y)*rest,aPos.z+(aNextPos.z-aPos.z)*rest,1.0);}else{gl_Position=vec4(-2.,-2.,0,1.0);return;}}vUV=aUV;gl_PointSize=uSize/uZoomUnits;}",fragmentShader:"precision highp float;uniform int ushapeType;uniform bool uUseTexture;uniform sampler2D uSampler;varying float vAddOpacity;varying vec4 vColor;varying vec3 vUV;void main(){if(ushapeType==2){float d=distance(gl_PointCoord,vec2(0.5,0.5));if(d>0.5){discard;}gl_FragColor=vec4(vColor.rgb,vColor.a*vAddOpacity);}else if(ushapeType==3){float d=distance(gl_PointCoord,vec2(0.5,0.5));if(d>0.5){discard;}gl_FragColor=vec4(vColor.rgb,vColor.a*smoothstep(1.0,0.0,d*2.)*vAddOpacity);}else{gl_FragColor=vec4(vColor.rgb,vColor.a*vAddOpacity);}if(uUseTexture){float ratio=vUV.z;vec2 uv=vUV.xy;gl_FragColor=texture2D(uSampler,vec2(gl_PointCoord.x*ratio+uv.x,1.0-(uv.y+gl_PointCoord.y*ratio)));}}"}),this.buffer=o.createBuffer(),o.bindBuffer(o.ARRAY_BUFFER,this.buffer)}},{key:"bindAttributeBufferData",value:function(o,a,y,g){var x=o.createBuffer();o.bindBuffer(o.ARRAY_BUFFER,x),y=new Float32Array(y),o.bufferData(o.ARRAY_BUFFER,y,o.STATIC_DRAW),this.bufferMap[a]={buffer:x,data:y,elementSize:g}}},{key:"onChanged",value:function(o,a){var y=2<arguments.length&&arguments[2]!==void 0?arguments[2]:{};this.gl&&(Array.isArray(a)||(a=[]),this.processCache(o,a,y))}},{key:"processCache",value:function(o,a,y){var g=this;this.cachedData=[];for(var x=o.icon,v=o.speed,M=o.color,D=0;D<a.length;D++){var U=a[D].geometry.coordinates,C=this.getProperty("color",M,a[D]);C=this.normizedColor(C);var L=this.getProperty("icon",x,a[D]),B=this.getProperty("speed",v,a[D]),O=this.getProperty("delay",0,a[D]);U&&(this.cachedData.push({coordinates:U,color:C,icon:L,speed:B,delay:O}),this.iconHash.get(L)||this.iconHash.set(L,L))}a=eo(this.iconHash.entries()).filter(function(k){return typeof k[1]=="string"}).map(function(k){var j=Ri(k,2)[0];return new ga(function(V,Y){g.url2canvas(j,function(Q){g.iconHash.set(j,Q),V()})})}),ga.all(a).then(function(k){g.buildSprite(o),y.autoRender!==!1&&g.webglLayer&&g.webglLayer.render()})}},{key:"buildSprite",value:function(o){var a=o.padding,y=this.canvas,g=this.ctx,x=0,v=[],M=new tu;if(o.icon){x=!0;var D=!1,U=void 0;try{for(var C=Bu(this.iconHash),L;!(x=(L=C.next()).done);x=!0){var B=Ri(L.value,2),O=B[1];if(typeof O!="string"){var k=O.width,j=k+a;v.push({w:j,h:j,width:k,key:B[0],icon:O})}}}catch(V){D=!0,U=V}finally{try{!x&&C.return&&C.return()}finally{if(D)throw U}}for(C=Iu(v),L=0;L<v.length;L++)B=v[L],M.get(B.key)||M.set(B.key,B);for(x=Math.max(Me(C.w),Me(C.h)),y.width=x||1,y.height=x||1,g.save(),y=0;y<v.length;y++)C=v[y],g.drawImage(C.icon,C.x+a,C.y+a,C.width,C.width);g.restore()}this.loadTexture(),this.buildVertex(o,M,x)}},{key:"buildVertex",value:function(o,a,y){var g=this.gl;this.updateUniformsFromOptions(o);for(var x=[],v=[],M=[],D=[],U=[],C=[],L=[],B=[],O=[],k=o.minLineLength,j=0;j<this.cachedData.length;j++){var V=this.cachedData[j],Y=V.coordinates,Q=V.icon,nt=V.speed,ut=V.delay;V=V.color;var ct=Y.length,Tt=[];if(!(ct<k)){for(o.icon&&(Tt=(Tt=a.get(Q))?[Tt.x/y,Tt.y/y,Tt.w/y]:[0,0,0]),Q=0;Q<ct;++Q){var Lt=this.normizedPoint(Y[Q]);x.push(Lt[0]),x.push(Lt[1]),x.push(Lt[2]||0),v.push.apply(v,Wr(V)),O.push.apply(O,Wr(Tt)),this.animationType!==3&&(M.push(Q),U.push(ct))}if(this.animationType!==1){for(Tt=x.length-3*ct+3,ct=x.length,Y=Tt;Y<ct;++Y)C.push(x[Y]);if(x.splice(ct-3,3),O.splice(ct-3,2),v.splice(ct-3,4),this.animationType===2)M.pop(),U.pop();else if(this.animationType===3){for(Tt-=3,ct=x.length-3,Y=0,V=[],Q=Tt;Q<=ct;Q+=3)Tt=Math.sqrt(Math.pow(C[Q]-x[Q],2)+Math.pow(C[Q+1]-x[Q+1],2)+Math.pow(C[Q+2]-x[Q+2],2)),Y+=Tt,V.push(Tt);for(M.push(0),L.push(nt),ut/=Y/nt,B.push(ut),Q=ct=0,Lt=V.length-1;Q<Lt;++Q)ct+=V[Q],Tt=ct/Y,M.push(Tt),D.push(Tt),U.push(Y),L.push(nt),B.push(ut);D.push(1),U.push(Y)}}}}this.bindAttributeBufferData(g,"aPos",x,3),this.bindAttributeBufferData(g,"aIndex",M,1),this.bindAttributeBufferData(g,"aLength",U,1),this.bindAttributeBufferData(g,"aColor",v,4),this.animationType!==1&&(this.bindAttributeBufferData(g,"aNextPos",C,3),this.animationType===3&&(this.bindAttributeBufferData(g,"aNextIndex",D,1),this.bindAttributeBufferData(g,"aSpeed",L,1),this.bindAttributeBufferData(g,"aDelay",B,1))),o.icon&&this.bindAttributeBufferData(g,"aUV",O,3),this.vertCount=x.length/3}},{key:"updateUniformsFromOptions",value:function(o){this.startTime=new Date().getTime(),es[o.animationType]||(o.animationType=2),NA[o.shapeType]||(o.shapeType=2),(isNaN(o.minLineLength)||2>o.minLineLength)&&(o.minLineLength=2),this.animationType=o.animationType}},{key:"renderAttributeArr",value:function(o,a,y){if(a.attributes[y]!==void 0){var g=this.bufferMap[y];g&&(o.bindBuffer(o.ARRAY_BUFFER,g.buffer),o.enableVertexAttribArray(a.attributes[y]),o.vertexAttribPointer(a.attributes[y],g.elementSize,o.FLOAT,!1,g.data.BYTES_PER_ELEMENT*g.elementSize,0))}}},{key:"render",value:function(o){var a=o.gl;if(o=o.matrix,!(0>=this.vertCount)){var y=this.getOptions(),g=this.program;a.useProgram(g.program),this.renderAttributeArr(a,g,"aPos"),this.renderAttributeArr(a,g,"aIndex"),this.renderAttributeArr(a,g,"aLength"),this.renderAttributeArr(a,g,"aColor"),this.animationType!==1&&(this.renderAttributeArr(a,g,"aNextPos"),this.animationType===3&&(this.renderAttributeArr(a,g,"aNextIndex"),this.renderAttributeArr(a,g,"aSpeed"),this.renderAttributeArr(a,g,"aDelay"))),y.icon&&this.texture&&(this.renderAttributeArr(a,g,"aUV"),a.activeTexture(a.TEXTURE0),a.bindTexture(a.TEXTURE_2D,this.texture),a.uniform1i(g.uniforms.uSampler,0)),a.uniform1i(g.uniforms.uUseTexture,this.isUseTexture);var x=new Date().getTime()-this.startTime;x<this.options.delay?x=0:(x-=this.options.delay,x=this.animationType===1?Math.round(x/1e3*this.options.speed*20):this.animationType===3?x/1e3*this.options.speed*1e3:x/1e3*this.options.speed);var v=this.options.size;if(Array.isArray(v)){var M=this.map.map.getMaxZoom(),D=this.map.map.getMinZoom();v=v[0]+(this.map.getZoom()-D)/(M-D)*(v[1]-v[0])}a.uniformMatrix4fv(g.uniforms.u_matrix,!1,o),a.uniform1f(g.uniforms.uSize,v),a.uniform1f(g.uniforms.uElapsedSteps,x),a.uniform1f(g.uniforms.uOriginSpeed,this.options.speed),a.uniform1i(g.uniforms.uAnimationType,this.animationType),a.uniform1i(g.uniforms.ushapeType,this.options.shapeType),a.uniform1i(g.uniforms.uPointFade,this.options.pointFade?1:0),a.uniform1f(g.uniforms.uPointFadeBuffer,this.options.pointFadeBuffer),a.uniform1f(g.uniforms.uZoomUnits,this.options.unit==="m"?this.map.getZoomUnits():1),this.setGLState({blend:!0,blendEquation:a.FUNC_ADD,blendFunc:y.blend==="lighter"?[a.SRC_ALPHA,a.ONE]:[a.SRC_ALPHA,a.ONE_MINUS_SRC_ALPHA],depthTest:!!y.depthTest}),a.drawArrays(a.POINTS,0,this.vertCount)}}},{key:"url2canvas",value:function(o,a){if((typeof o=="undefined"?"undefined":kn(o))==="object")a(o);else{var y=new Image;y.crossOrigin="anonymous",y.onload=function(){var g=document.createElement("canvas");g.width=128,g.height=128,g.getContext("2d").drawImage(y,0,0,128,128),a(g)},y.src=o}}},{key:"loadTexture",value:function(){var o=this;this.canvas&&this.getOptions().icon?xn(this.gl,this.canvas,function(a){o.isUseTexture=!0,o.texture=a}):(this.isUseTexture=!1,this.texture=null)}}]),h}(Ci);Ju.ANIMATION_TYPE_LEAP=1,Ju.ANIMATION_TYPE_SMOOTH=2,Ju.ANIMATION_TYPE_UNIFORM_SPEED=3,Ju.SHAPE_TYPE_SQUARE=1,Ju.SHAPE_TYPE_CIRCLE=2,Ju.SHAPE_TYPE_CIRCLE_GRADIENT=3;var tp=function(){function l(h,o){Xe(this,l),this.layer=h,this.gl=o,this.initData()}return Ue(l,[{key:"initData",value:function(){this.outWall3d={vertex:[],vertexBuffer:[],index:[],indexBuffer:[]}}},{key:"getData",value:function(){return this.outWall3d}},{key:"onLayerChange",value:function(h,o){this.initData();for(var a=h.color,y=h.height,g=h.gradient,x=h.enablePreciseMap,v=h.repeatMap,M=h.closePath,D=this.gl,U=0;U<o.length;U++){var C=o[U],L=C.color||a;"properties"in C&&"color"in C.properties&&(L=C.properties.color),g||Object.prototype.toString.call(L)!=="[object Function]"||(L=L(C));var B=this.layer.normizedColor(g?g[0]:L);L=this.layer.normizedColor(g?g[1]:L);var O=C.height||y;if("properties"in C&&"height"in C.properties&&(O=C.properties.height),Object.prototype.toString.call(O)==="[object Function]"&&(O=O(C)),C.geometry.type==="MultiLineString"||C.geometry.type==="Polygon")for(var k=0;k<C.geometry.coordinates.length;k++){var j=C.geometry.coordinates[k];M&&!fe(j)&&j.push(j[0]);for(var V=[],Y=[],Q=0,nt=0;nt<j.length;nt++){var ut=this.layer.normizedPoint(j[nt]);if(0<nt&&(x||v)){var ct=this.layer.normizedPoint(j[nt-1]);Q+=Math.sqrt(Math.pow(ut[0]-ct[0],2)+Math.pow(ut[1]-ct[1],2))}V.push(ut),Y.push(Q)}this.processData(this.outWall3d,h,V,Y,B,L,O)}else{for(C=C.geometry.coordinates,M&&!fe(C)&&C.push(C[0]),k=[],j=[],Y=V=0;Y<C.length;Y++)Q=this.layer.normizedPoint(C[Y]),0<Y&&(x||v)&&(nt=this.layer.normizedPoint(C[Y-1]),V+=Math.sqrt(Math.pow(Q[0]-nt[0],2)+Math.pow(Q[1]-nt[1],2))),k.push(Q),j.push(V);this.processData(this.outWall3d,h,k,j,B,L,O)}}for(h=0;h<this.outWall3d.vertex.length;h++){for(o=[],a=this.outWall3d.vertex[h].length,y=0;y<a;y++)o.push.apply(o,Wr(this.outWall3d.vertex[h][y]));a=D.createBuffer(),D.bindBuffer(D.ARRAY_BUFFER,a),D.bufferData(D.ARRAY_BUFFER,new Float32Array(o),D.STATIC_DRAW),this.outWall3d.vertexBuffer[h]=a,D.bindBuffer(D.ARRAY_BUFFER,null),a=D.createBuffer(),D.bindBuffer(D.ELEMENT_ARRAY_BUFFER,a),D.bufferData(D.ELEMENT_ARRAY_BUFFER,new Uint16Array(this.outWall3d.index[h]),D.STATIC_DRAW),this.outWall3d.indexBuffer[h]=a,D.bindBuffer(D.ELEMENT_ARRAY_BUFFER,null)}}},{key:"processData",value:function(h,o,a,y,g,x,v){var M=y[y.length-1],D=h.vertex[h.vertex.length-1],U=h.index[h.index.length-1],C=a.length;for((!U||65536<=U.length+2*C+2)&&(D=[],U=[],h.vertex.push(D),h.index.push(U)),(h=D.length)&&U.push(h-1,h),h=0;h<C;h++){var L=[],B=[],O=a[h];L.push(O[0],O[1],O[2]+v),L.push(g[0],g[1],g[2],g[3]),B.push(O[0],O[1],O[2]),B.push(x[0],x[1],x[2],x[3]),o.texture&&(O=y[h],o.enablePreciseMap||o.repeatMap?(L.push(O,1,M),B.push(O,0,M)):(L.push(h,1,C-1),B.push(h,0,C-1))),O=D.length,D.push(L,B),U.push(O,O+1)}}}]),l}(),zd=function(l){function h(o,a){return Xe(this,h),_r(this,(h.__proto__||ur(h)).call(this,o,a))}return yr(h,l),Ue(h,[{key:"getDefaultOptions",value:function(){return{texture:null,enablePreciseMap:!1,repeatMap:0,height:100,closePath:!1,color:[1,1,1,1]}}},{key:"initialize",value:function(o){this.gl=o,this.dataMgr=new tp(this,this.gl),this.texture=null,this.isUseTexture=!1,this.vertexLength=10,this.program=new jr(this.gl,{vertexShader:"uniform mat4 u_matrix;uniform bool uUseTexture;attribute vec3 aPos;attribute vec4 aColor;attribute vec2 aTextureCoords;attribute float aTotalDistance;varying vec2 vTextureCoords;varying float vTotalDistance;varying vec4 vColor;void main(){if(aColor.w>=0.0&&aColor.w<=1.0){vColor=aColor;}else{vColor=vec4(aColor.xyz,1.0);}if(uUseTexture){vTextureCoords=aTextureCoords;vTotalDistance=aTotalDistance;}gl_Position=u_matrix*vec4(aPos,1.0);}",fragmentShader:"precision highp float;uniform bool uUseTexture;uniform float uDistance;uniform sampler2D uSampler;varying vec2 vTextureCoords;varying float vTotalDistance;varying vec4 vColor;void main(){if(uUseTexture){float uvx=vTextureCoords.x/vTotalDistance;if(uDistance>0.0){uvx=mod(vTextureCoords.x,uDistance)/uDistance;}gl_FragColor=vec4(1.0,1.0,1.0,1.0)*texture2D(uSampler,vec2(uvx,vTextureCoords.y));}else{gl_FragColor=vColor;}}"}),this.loadTexture()}},{key:"onChanged",value:function(o,a){var y=this;this.gl&&(this.loadTextureTime&&clearTimeout(this.loadTextureTime),this.loadTextureTime=setTimeout(function(){y.loadTexture(function(){y.dataMgr.onLayerChange(o,a),y.webglLayer.render()})},0))}},{key:"render",value:function(o){var a=o.gl,y=o.matrix;if((o=this.dataMgr.getData())&&!(0>=o.vertex.length)){var g=this.getOptions(),x=this.program;if(a.useProgram(x.program),g.texture){if(!this.texture)return;a.activeTexture(a.TEXTURE0),a.bindTexture(a.TEXTURE_2D,this.texture),a.uniform1i(x.uniforms.uSampler,0)}for(this.setGLState({blend:!0,blendEquation:a.FUNC_ADD,blendFunc:[a.SRC_ALPHA,a.ONE_MINUS_SRC_ALPHA],depthMask:!!g.texture,depthFunc:g.texture?a.LESS:a.LEQUAL}),g.texture?a.enableVertexAttribArray(x.attributes.aTextureCoords):a.disableVertexAttribArray(x.attributes.aTextureCoords),a.enableVertexAttribArray(x.attributes.aPos),a.enableVertexAttribArray(x.attributes.aColor),a.uniformMatrix4fv(x.uniforms.u_matrix,!1,y),a.uniform1i(x.uniforms.uUseTexture,this.isUseTexture),a.uniform1f(x.uniforms.uDistance,g.repeatMap),y=0;y<o.vertex.length;y++)if(!(0>=o.vertex[y].length)){var v=o.vertex[y],M=new Float32Array(v[0]).BYTES_PER_ELEMENT;v=M*v[0].length,a.bindBuffer(a.ARRAY_BUFFER,o.vertexBuffer[y]),a.vertexAttribPointer(x.attributes.aPos,3,a.FLOAT,!1,v,0),a.vertexAttribPointer(x.attributes.aColor,4,a.FLOAT,!1,v,3*M),g.texture&&(a.vertexAttribPointer(x.attributes.aTextureCoords,2,a.FLOAT,!1,v,7*M),a.vertexAttribPointer(x.attributes.aTotalDistance,1,a.FLOAT,!1,v,9*M)),a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,o.indexBuffer[y]),a.drawElements(a.TRIANGLE_STRIP,o.index[y].length,a.UNSIGNED_SHORT,0),a.bindBuffer(a.ARRAY_BUFFER,null),a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,null)}}}},{key:"loadTexture",value:function(o){var a=this,y=this.getOptions();y.texture?(this.isUseTexture=!0,xn(this.gl,y.texture,function(g,x){a.image=x,a.texture=g,o&&o(),a.webglLayer.render()})):(this.isUseTexture=!1,this.image=this.texture=null,o&&o())}}]),h}(Ci),gv=function(){function l(h,o){Xe(this,l),this.layer=h,this.gl=o,this.initData()}return Ue(l,[{key:"initData",value:function(){this.outWall3d={vertex:[],vertexBuffer:[],index:[],indexBuffer:[]},this.maxLength=0}},{key:"getData",value:function(){return this.outWall3d}},{key:"getMaxDataLength",value:function(){return this.maxLength}},{key:"onLayerChange",value:function(h,o){this.initData();var a=h.color,y=h.height,g=h.gradient;h=this.gl;for(var x=0;x<o.length;x++){var v=o[x].geometry.coordinates,M=v.length;this.maxLength=M>this.maxLength?M:this.maxLength;for(var D=[],U=0;U<M;U++){var C=this.layer.normizedPoint(v[U]);D.push(C)}M=o[x].color||a,"properties"in o[x]&&"color"in o[x].properties&&(M=o[x].properties.color),g||Object.prototype.toString.call(M)!=="[object Function]"||(M=M(o[x])),v=this.layer.normizedColor(g?g[0]:M),M=this.layer.normizedColor(g?g[1]:M),U=o[x].height||y,"properties"in o[x]&&"height"in o[x].properties&&(U=o[x].properties.height),Object.prototype.toString.call(U)==="[object Function]"&&(U=U(o[x])),this.processData(this.outWall3d,D,v,M,U)}for(o=0;o<this.outWall3d.vertex.length;o++){for(a=[],y=this.outWall3d.vertex[o].length,g=0;g<y;g++)a.push.apply(a,Wr(this.outWall3d.vertex[o][g]));y=h.createBuffer(),h.bindBuffer(h.ARRAY_BUFFER,y),h.bufferData(h.ARRAY_BUFFER,new Float32Array(a),h.STATIC_DRAW),this.outWall3d.vertexBuffer[o]=y,h.bindBuffer(h.ARRAY_BUFFER,null),y=h.createBuffer(),h.bindBuffer(h.ELEMENT_ARRAY_BUFFER,y),h.bufferData(h.ELEMENT_ARRAY_BUFFER,new Uint16Array(this.outWall3d.index[o]),h.STATIC_DRAW),this.outWall3d.indexBuffer[o]=y,h.bindBuffer(h.ELEMENT_ARRAY_BUFFER,null)}}},{key:"processData",value:function(h,o,a,y,g){var x=h.vertex[h.vertex.length-1],v=h.index[h.index.length-1],M=o.length;for((!v||65536<=v.length+2*M+2)&&(x=[],v=[],h.vertex.push(x),h.index.push(v)),(h=x.length)&&v.push(h-1,h),h=0;h<M;h++){var D=[],U=[],C=o[h];D.push(C[0],C[1]),D.push(C[2]?Number(C[2])+g:g),D.push(C[3]?Number(C[3]):h),D.push(a[0],a[1],a[2],a[3]),U.push(C[0],C[1]),U.push(C[2]?Number(C[2]):0),U.push(C[3]?Number(C[3]):h),U.push(y[0],y[1],y[2],y[3]),C=x.length,x.push(D,U),v.push(C,C+1)}}}]),l}(),UA=function(l){function h(o,a){return Xe(this,h),o=_r(this,(h.__proto__||ur(h)).call(this,o,a)),o.startTime=o.options.startTime||0,o.endTime=o.options.endTime,o.time=o.startTime,o.autoUpdate=!0,o}return yr(h,l),Ue(h,[{key:"getDefaultOptions",value:function(){return{height:100,color:[1,1,1,1],trailLength:3,step:.1}}},{key:"initialize",value:function(o){this.gl=o,this.dataMgr=new gv(this,this.gl),this.program=new jr(this.gl,{vertexShader:"uniform mat4 u_matrix;uniform float currentTime;uniform float trailLength;attribute vec4 aPos;attribute vec4 aColor;varying vec4 vColor;varying float vTime;void main(){vTime=1.0-((currentTime-aPos.w)/trailLength);vColor=aColor;gl_Position=u_matrix*vec4(aPos.xyz,1.0);}",fragmentShader:"precision highp float;varying vec4 vColor;varying float vTime;void main(){if(vTime>1.0||vTime<0.0){discard;}gl_FragColor=vec4(vColor.rgb,1.0*vTime);}"})}},{key:"onChanged",value:function(o,a){this.gl&&(this.dataMgr.onLayerChange(o,a),o.endTime===void 0&&(this.endTime=this.dataMgr.getMaxDataLength()))}},{key:"render",value:function(o){var a=o.gl,y=o.matrix;if((o=this.dataMgr.getData())&&!(0>=o.vertex.length)){var g=this.getOptions(),x=this.program;for(a.useProgram(x.program),this.setGLState({blend:!0,blendEquation:a.FUNC_ADD,blendFunc:[a.SRC_ALPHA,a.ONE_MINUS_SRC_ALPHA]}),a.enableVertexAttribArray(x.attributes.aPos),a.enableVertexAttribArray(x.attributes.aColor),a.uniformMatrix4fv(x.uniforms.u_matrix,!1,y),a.uniform1f(x.uniforms.currentTime,this.time),a.uniform1f(x.uniforms.trailLength,g.trailLength),y=0;y<o.vertex.length;y++)if(!(0>=o.vertex[y].length)){var v=o.vertex[y],M=new Float32Array(v[0]).BYTES_PER_ELEMENT;v=M*v[0].length,a.bindBuffer(a.ARRAY_BUFFER,o.vertexBuffer[y]),a.vertexAttribPointer(x.attributes.aPos,4,a.FLOAT,!1,v,0),a.vertexAttribPointer(x.attributes.aColor,4,a.FLOAT,!1,v,4*M),a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,o.indexBuffer[y]),a.drawElements(a.TRIANGLE_STRIP,o.index[y].length,a.UNSIGNED_SHORT,0),a.bindBuffer(a.ARRAY_BUFFER,null),a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,null)}this.time+=g.step,this.time>this.endTime&&(this.time=this.startTime)}}}]),h}(Ci),bA=function(l){function h(o,a){return Xe(this,h),o=_r(this,(h.__proto__||ur(h)).call(this,o,a)),o.simpleLineLayer=new q1(o.getHeatOptions()),o.children=[o.simpleLineLayer],o}return yr(h,l),Ue(h,[{key:"getDefaultOptions",value:function(){return{blend:"normal",gradient:{0:"rgb(50, 50, 256)","0.1":"rgb(50, 250, 56)","0.5":"rgb(250, 250, 56)",1:"rgb(250, 50, 56)"}}}},{key:"onDataChanged",value:function(o){this.simpleLineLayer.setData(o)}},{key:"onOptionsChanged",value:function(o){this.simpleLineLayer.setOptions(this.getHeatOptions())}},{key:"getHeatOptions",value:function(){var o=this.getOptions(),a=o.max,y=o.min;a===void 0&&(y=this.getDataRange(),a=y.max,y=y.min);var g=new Li({max:a,min:y,gradient:o.gradient});return o.color=function(x){var v=~~x.count||1;return"properties"in x&&"count"in x.properties&&(v=~~x.properties.count),x=g.getImageData(v),[x[0]/255,x[1]/255,x[2]/255,x[3]/255]},o}},{key:"getDataRange",value:function(){var o=this.getData(),a=0,y=0;o[0]&&(a=~~o[0].count||1,y=~~o[0].count||1),"properties"in o[0]&&"count"in o[0].properties&&(a=~~o[0].properties.count,y=~~o[0].properties.count);for(var g=o.length,x=0;x<g;x++){var v=~~o[x].count||1;"properties"in o[x]&&"count"in o[x].properties&&(v=~~o[x].properties.count),a=Math.max(v,a),y=Math.min(v,y)}return{max:a/2,min:y}}}]),h}(da),ep=ht(function(l,h){(function(o,a){l.exports=a()})(s1,function(){function o(Y,Q,nt,ut,ct,Tt){if(!(ct-ut<=nt)){var Lt=ut+ct>>1;a(Y,Q,Lt,ut,ct,Tt%2),o(Y,Q,nt,ut,Lt-1,Tt+1),o(Y,Q,nt,Lt+1,ct,Tt+1)}}function a(Y,Q,nt,ut,ct,Tt){for(;ct>ut;){if(600<ct-ut){var Lt=ct-ut+1,Dt=nt-ut+1,ae=Math.log(Lt),ne=.5*Math.exp(2*ae/3);ae=.5*Math.sqrt(ae*ne*(Lt-ne)/Lt)*(0>Dt-Lt/2?-1:1),a(Y,Q,nt,Math.max(ut,Math.floor(nt-Dt*ne/Lt+ae)),Math.min(ct,Math.floor(nt+(Lt-Dt)*ne/Lt+ae)),Tt)}for(Lt=Q[2*nt+Tt],Dt=ut,ne=ct,y(Y,Q,ut,nt),Q[2*ct+Tt]>Lt&&y(Y,Q,ut,ct);Dt<ne;){for(y(Y,Q,Dt,ne),Dt++,ne--;Q[2*Dt+Tt]<Lt;)Dt++;for(;Q[2*ne+Tt]>Lt;)ne--}Q[2*ut+Tt]===Lt?y(Y,Q,ut,ne):(ne++,y(Y,Q,ne,ct)),ne<=nt&&(ut=ne+1),nt<=ne&&(ct=ne-1)}}function y(Y,Q,nt,ut){g(Y,nt,ut),g(Q,2*nt,2*ut),g(Q,2*nt+1,2*ut+1)}function g(Y,Q,nt){var ut=Y[Q];Y[Q]=Y[nt],Y[nt]=ut}function x(Y,Q){return Y=Y.geometry.coordinates,{x:Y[0]/360+.5,y:D(Y[1]),zoom:1/0,index:Q,parentId:-1}}function v(Y){var Q=Y.id,nt=M(Y);return{type:"Feature",id:Q,properties:nt,geometry:{type:"Point",coordinates:[360*(Y.x-.5),360*Math.atan(Math.exp((180-360*Y.y)*Math.PI/180))/Math.PI-90]}}}function M(Y){var Q=Y.numPoints,nt=1e4<=Q?Math.round(Q/1e3)+"k":1e3<=Q?Math.round(Q/100)/10+"k":Q;return U(U({},Y.properties),{cluster:!0,cluster_id:Y.id,point_count:Q,point_count_abbreviated:nt})}function D(Y){return Y=Math.sin(Y*Math.PI/180),Y=.5-.25*Math.log((1+Y)/(1-Y))/Math.PI,0>Y?0:1<Y?1:Y}function U(Y,Q){for(var nt in Q)Y[nt]=Q[nt];return Y}function C(Y){return Y.x}function L(Y){return Y.y}var B=function(Y){return Y[0]},O=function(Y){return Y[1]},k=function(Y,Q,nt,ut,ct){Q===void 0&&(Q=B),nt===void 0&&(nt=O),ut===void 0&&(ut=64),ct===void 0&&(ct=Float64Array),this.nodeSize=ut,this.points=Y;var Tt=this.ids=new(65536>Y.length?Uint16Array:Uint32Array)(Y.length);ct=this.coords=new ct(2*Y.length);for(var Lt=0;Lt<Y.length;Lt++)Tt[Lt]=Lt,ct[2*Lt]=Q(Y[Lt]),ct[2*Lt+1]=nt(Y[Lt]);o(Tt,ct,ut,0,Tt.length-1,0)};k.prototype.range=function(Y,Q,nt,ut){for(var ct=this.ids,Tt=this.coords,Lt=this.nodeSize,Dt=[0,ct.length-1,0],ae=[],ne,we;Dt.length;){var xe=Dt.pop(),Ye=Dt.pop(),mr=Dt.pop();if(Ye-mr<=Lt)for(xe=mr;xe<=Ye;xe++)ne=Tt[2*xe],we=Tt[2*xe+1],ne>=Y&&ne<=nt&&we>=Q&&we<=ut&&ae.push(ct[xe]);else{var ee=Math.floor((mr+Ye)/2);ne=Tt[2*ee],we=Tt[2*ee+1],ne>=Y&&ne<=nt&&we>=Q&&we<=ut&&ae.push(ct[ee]);var Re=(xe+1)%2;(xe===0?Y<=ne:Q<=we)&&(Dt.push(mr),Dt.push(ee-1),Dt.push(Re)),(xe===0?nt>=ne:ut>=we)&&(Dt.push(ee+1),Dt.push(Ye),Dt.push(Re))}}return ae},k.prototype.within=function(Y,Q,nt){for(var ut=this.ids,ct=this.coords,Tt=this.nodeSize,Lt=[0,ut.length-1,0],Dt=[],ae=nt*nt;Lt.length;){var ne=Lt.pop(),we=Lt.pop(),xe=Lt.pop();if(we-xe<=Tt)for(ne=xe;ne<=we;ne++){xe=ct[2*ne]-Y;var Ye=ct[2*ne+1]-Q;xe*xe+Ye*Ye<=ae&&Dt.push(ut[ne])}else{Ye=Math.floor((xe+we)/2);var mr=ct[2*Ye],ee=ct[2*Ye+1],Re=mr-Y,xr=ee-Q;Re*Re+xr*xr<=ae&&Dt.push(ut[Ye]),Re=(ne+1)%2,(ne===0?Y-nt<=mr:Q-nt<=ee)&&(Lt.push(xe),Lt.push(Ye-1),Lt.push(Re)),(ne===0?Y+nt>=mr:Q+nt>=ee)&&(Lt.push(Ye+1),Lt.push(we),Lt.push(Re))}}return Dt};var j={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(Y){return Y}},V=function(Y){this.options=U(Bl(j),Y),this.trees=Array(this.options.maxZoom+1)};return V.prototype.load=function(Y){var Q=this.options,nt=Q.minZoom,ut=Q.maxZoom;Q=Q.nodeSize,this.points=Y;for(var ct=[],Tt=0;Tt<Y.length;Tt++)Y[Tt].geometry&&ct.push(x(Y[Tt],Tt));for(this.trees[ut+1]=new k(ct,C,L,Q,Float32Array),Y=ut;Y>=nt;Y--)ct=this._cluster(ct,Y),this.trees[Y]=new k(ct,C,L,Q,Float32Array);return this},V.prototype.getClusters=function(Y,Q){var nt=((Y[0]+180)%360+360)%360-180,ut=Math.max(-90,Math.min(90,Y[1])),ct=Y[2]===180?180:((Y[2]+180)%360+360)%360-180,Tt=Math.max(-90,Math.min(90,Y[3]));if(360<=Y[2]-Y[0])nt=-180,ct=180;else if(nt>ct)return nt=this.getClusters([nt,ut,180,Tt],Q),ut=this.getClusters([-180,ut,ct,Tt],Q),nt.concat(ut);Q=this.trees[this._limitZoom(Q)],Y=[];var Lt=0;for(ut=Q.range(nt/360+.5,D(Tt),ct/360+.5,D(ut));Lt<ut.length;Lt+=1)ct=Q.points[ut[Lt]],Y.push(ct.numPoints?v(ct):this.points[ct.index]);return Y},V.prototype.getChildren=function(Y){var Q=this._getOriginId(Y),nt=this._getOriginZoom(Y),ut=this.trees[nt];if(!ut)throw Error("No cluster with the specified id.");var ct=ut.points[Q];if(!ct)throw Error("No cluster with the specified id.");Q=[];var Tt=0;for(nt=ut.within(ct.x,ct.y,this.options.radius/(this.options.extent*Math.pow(2,nt-1)));Tt<nt.length;Tt+=1)ct=ut.points[nt[Tt]],ct.parentId===Y&&Q.push(ct.numPoints?v(ct):this.points[ct.index]);if(Q.length===0)throw Error("No cluster with the specified id.");return Q},V.prototype.getLeaves=function(Y,Q,nt){var ut=[];return this._appendLeaves(ut,Y,Q||10,nt||0,0),ut},V.prototype.getTile=function(Y,Q,nt){var ut=this.trees[this._limitZoom(Y)];Y=Math.pow(2,Y);var ct=this.options;ct=ct.radius/ct.extent;var Tt=(nt-ct)/Y,Lt=(nt+1+ct)/Y,Dt={features:[]};return this._addTileFeatures(ut.range((Q-ct)/Y,Tt,(Q+1+ct)/Y,Lt),ut.points,Q,nt,Y,Dt),Q===0&&this._addTileFeatures(ut.range(1-ct/Y,Tt,1,Lt),ut.points,Y,nt,Y,Dt),Q===Y-1&&this._addTileFeatures(ut.range(0,Tt,ct/Y,Lt),ut.points,-1,nt,Y,Dt),Dt.features.length?Dt:null},V.prototype.getClusterExpansionZoom=function(Y){for(var Q=this._getOriginZoom(Y)-1;Q<=this.options.maxZoom&&(Y=this.getChildren(Y),Q++,Y.length===1);)Y=Y[0].properties.cluster_id;return Q},V.prototype._appendLeaves=function(Y,Q,nt,ut,ct){var Tt=0;for(Q=this.getChildren(Q);Tt<Q.length;Tt+=1){var Lt=Q[Tt],Dt=Lt.properties;if(Dt&&Dt.cluster?ct=ct+Dt.point_count<=ut?ct+Dt.point_count:this._appendLeaves(Y,Dt.cluster_id,nt,ut,ct):ct<ut?ct++:Y.push(Lt),Y.length===nt)break}return ct},V.prototype._addTileFeatures=function(Y,Q,nt,ut,ct,Tt){for(var Lt=0;Lt<Y.length;Lt+=1){var Dt=Q[Y[Lt]],ae=Dt.numPoints,ne={type:1,geometry:[[Math.round(this.options.extent*(Dt.x*ct-nt)),Math.round(this.options.extent*(Dt.y*ct-ut))]],tags:ae?M(Dt):this.points[Dt.index].properties},we=void 0;ae?we=Dt.id:this.options.generateId?we=Dt.index:this.points[Dt.index].id&&(we=this.points[Dt.index].id),we!==void 0&&(ne.id=we),Tt.features.push(ne)}},V.prototype._limitZoom=function(Y){return Math.max(this.options.minZoom,Math.min(+Y,this.options.maxZoom+1))},V.prototype._cluster=function(Y,Q){var nt=[],ut=this.options,ct=ut.reduce,Tt=ut.minPoints;ut=ut.radius/(ut.extent*Math.pow(2,Q));for(var Lt=0;Lt<Y.length;Lt++){var Dt=Y[Lt];if(!(Dt.zoom<=Q)){Dt.zoom=Q;for(var ae=this.trees[Q+1],ne=ae.within(Dt.x,Dt.y,ut),we=Dt.numPoints||1,xe=we,Ye=0,mr=ne;Ye<mr.length;Ye+=1){var ee=ae.points[mr[Ye]];ee.zoom>Q&&(xe+=ee.numPoints||1)}if(xe>=Tt){Ye=Dt.x*we,mr=Dt.y*we,we=ct&&1<we?this._map(Dt,!0):null,ee=(Lt<<5)+(Q+1)+this.points.length;for(var Re=0;Re<ne.length;Re+=1){var xr=ae.points[ne[Re]];if(!(xr.zoom<=Q)){xr.zoom=Q;var gr=xr.numPoints||1;Ye+=xr.x*gr,mr+=xr.y*gr,xr.parentId=ee,ct&&(we||(we=this._map(Dt,!0)),ct(we,this._map(xr)))}}Dt.parentId=ee,nt.push({x:Ye/xe,y:mr/xe,zoom:1/0,id:ee,parentId:-1,numPoints:xe,properties:we})}else if(nt.push(Dt),1<xe)for(Dt=0,xe=ne;Dt<xe.length;Dt+=1)ne=ae.points[xe[Dt]],ne.zoom<=Q||(ne.zoom=Q,nt.push(ne))}}return nt},V.prototype._getOriginId=function(Y){return Y-this.points.length>>5},V.prototype._getOriginZoom=function(Y){return(Y-this.points.length)%32},V.prototype._map=function(Y,Q){if(Y.numPoints)return Q?U({},Y.properties):Y.properties;Y=this.points[Y.index].properties;var nt=this.options.map(Y);return Q&&nt===Y?U({},nt):nt},V})}),kA=function(l){function h(o){return Xe(this,h),o=_r(this,(h.__proto__||ur(h)).call(this,o)),o.shapeLayer=new Uf(o.options),o.textLayer=new Yl(o.options.textOptions),o.children=[o.shapeLayer,o.textLayer],o.max=[],o}return yr(h,l),Ue(h,[{key:"getDefaultOptions",value:function(){return{size:50,height:0,maxZoom:19,minZoom:5,gradient:{0:"rgb(50, 50, 256)","0.1":"rgb(50, 250, 56)","0.5":"rgb(250, 250, 56)",1:"rgb(250, 50, 56)"},enableCluster:!1,showText:!0,textOptions:{fontSize:13,color:"white"}}}},{key:"onOptionsChanged",value:function(o){this.textLayer.setOptions(o.textOptions)}},{key:"setOptions",value:function(){var o=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{},a=this.options.textOptions;o.textOptions&&Vr(a,o.textOptions);var y=o.minZoom,g=o.maxZoom,x=o.size;y=g&&g!==this.options.maxZoom||y&&y!==this.options.minZoom||x&&x!==this.options.size,Vr(this.options,o,{textOptions:a}),y?this.onChanged(this.options,this.data):this.refreshLayer(),this.onOptionsChanged(this.getOptions())}},{key:"onChanged",value:function(o,a){if(a&&a.length){this.zoom=Math.floor(this.map.getZoom());var y=o.maxZoom,g=o.minZoom,x=o.enableCluster;o=o.size,this.zoom>y?this.zoom=y:this.zoom<g&&(this.zoom=g),x&&(this.supercluster=new ep({maxZoom:y,minZoom:g,radius:o/2}),this.supercluster.load(a)),this.refreshLayer()}}},{key:"refreshLayer",value:function(){var o=0<arguments.length&&arguments[0]!==void 0?arguments[0]:this.options,a=1<arguments.length&&arguments[1]!==void 0?arguments[1]:this.data,y=this.map,g=this.zoom;if(o.enableCluster&&this.supercluster&&(a=this.getClusterData(o)),a&&a.length){var x=o.gradient,v=o.showText,M=o.textOptions,D=o.height,U=o.size;U*=Math.pow(2,18-g),a=tA(a,U,function(B){var O=Ri(B,2),k=O[0];return O=O[1],-180<=k&&180>=k&&-90<=O&&90>=O&&(O=y.lnglatToMercator(k,O),k=O[0],O=O[1]),B[0]=k,B[1]=O,B}),this.max[g]=Math.max(this.max[g]||0,a.max);var C=new Li({max:this.max[g],min:0,maxSize:D*Math.pow(2,18-g),minSize:0,gradient:x});if(x=[],v){var L=M&&M.format;L=typeof L=="function"?L:null,x=a.map(function(B){return{geometry:{coordinates:[B.center.x,B.center.y,C.getSize(B.count)+M.fontSize/2*Math.pow(2,18-g)]},text:L?L(B.count):B.count}})}this.textLayer.setData(x),v=a.map(function(B){for(var O=B.center,k=a.r,j=[],V=0;6>V;V++)j.push(o1({x:O.x,y:O.y},k,V));return{geometry:{type:"Polygon",coordinates:[j]},properties:{height:C.getSize(B.count),color:C.getColor(B.count)}}}),this.shapeLayer.setData(v),o.enablePicked&&o.autoSelect&&this.pick(-1,-1)}}},{key:"getClusterData",value:function(){var o=this.map,a=o.getBounds(),y=a.ne;a=a.sw,this.ne=y,this.sw=a;var g=y,x=g.lng;g=g.lat;var v=[];return-180<=x&&180>=x&&-90<=g&&90>=g?v=[a.lng,a.lat,y.lng,y.lat]:(y=o.mercatorToLnglat(this.ne.lng,this.ne.lat),a=o.mercatorToLnglat(this.sw.lng,this.sw.lat),v=a.concat(y)),this.supercluster.getClusters(v,this.zoom).map(function(M){var D=0;return M.properties&&M.properties.point_count&&(D=M.properties.point_count),{geometry:M.geometry,count:D}})}},{key:"pick",value:function(o,a){return this.shapeLayer.pick(o,a)}},{key:"shouldUpdate",value:function(){if(!this.data)return!1;var o=this.map,a=Math.floor(o.getZoom()),y=this.options,g=y.maxZoom;if(y=y.minZoom,a>g?a=g:a<y&&(a=y),this.zoom!==a)return this.zoom=a,!0;if(!this.options.enableCluster||(a=o.getBounds(),o=a.ne,a=a.sw,!(o&&a&&this.ne&&this.sw)))return!1;if(this.ne.lng!==o.lng||this.ne.lat!==o.lat||this.sw.lng!==a.lng||this.sw.lat!==a.lat)return!0}},{key:"render",value:function(o){this.shouldUpdate()?this.refreshLayer():fa(h.prototype.__proto__||ur(h.prototype),"render",this).call(this,o)}}]),h}(da),rp=function(l){function h(o){return Xe(this,h),o=_r(this,(h.__proto__||ur(h)).call(this,o)),o.name="PointLayer",o.bufferData=[],o}return yr(h,l),Ue(h,[{key:"getDefaultOptions",value:function(){return{color:[.1,.1,.9,1],blend:"default",shape:"circle",size:5,unit:"px",borderWidth:0,borderColor:[1,1,1,.9],polygonOffset:[0,0],depthTest:!0}}},{key:"initialize",value:function(o){this.gl=o;var a=this.getOptions(),y=[];a.enablePicked&&y.push("PICK"),a.shape&&a.shape==="circle"&&y.push("SHAPE_CIRCLE"),this.program=new jr(this.gl,{vertexShader:`attribute vec3 aPos;attribute vec4 aColor;attribute float aSize;attribute float aBorderWidth;attribute vec4 aBorderColor;uniform mat4 uMatrix;uniform vec4 uSelectedColor;uniform bool uUnitPx;uniform float zoomUnits;uniform float devicePixelRatio;varying vec4 vColor;varying float vSize;varying float vBorderWidth;varying vec4 vBorderColor;void main(void){if(aColor.w>=0.0&&aColor.w<=1.0){vColor=aColor;}else{vColor=vec4(aColor.xyz,1.0);}float size=aSize*devicePixelRatio;float borderWidth=aBorderWidth*devicePixelRatio;gl_Position=uMatrix*vec4(aPos.xyz,1.0);gl_PointSize=uUnitPx ? size : size/zoomUnits;vSize=size;vBorderWidth=borderWidth;vBorderColor=aBorderColor;
#if defined(PICK)
if(mapvIsPicked()){vColor=uSelectedColor;}
#endif
}`,fragmentShader:`varying vec4 vColor;varying float vSize;varying float vBorderWidth;varying vec4 vBorderColor;void main(void){vec4 color=vColor;
#if defined(SHAPE_CIRCLE)
float d=distance(gl_PointCoord,vec2(0.5,0.5));float ratio=1.0-vBorderWidth/vSize*2.0;if(d>0.5){discard;}if(d>ratio*0.5){color=vBorderColor;}float blur=1.0;blur=1.0-smoothstep(0.49,0.5,d);color.a*=blur;
#else
float ratio=vBorderWidth/vSize;if(gl_PointCoord.x<ratio||gl_PointCoord.x>1.0-ratio||gl_PointCoord.y<ratio||gl_PointCoord.y>1.0-ratio){color=vBorderColor;}
#endif
gl_FragColor=color;}`,defines:y},this),this.buffer=new qe({gl:o,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),a=[{stride:52,name:"aPos",buffer:this.buffer,size:3,type:"FLOAT",offset:0},{stride:52,name:"aColor",buffer:this.buffer,size:4,type:"FLOAT",offset:12},{stride:52,name:"aSize",buffer:this.buffer,size:1,type:"FLOAT",offset:28},{stride:52,name:"aBorderWidth",buffer:this.buffer,size:1,type:"FLOAT",offset:32},{stride:52,name:"aBorderColor",buffer:this.buffer,size:4,type:"FLOAT",offset:36}],a=a.concat(this.getCommonAttributes()),this.vertexArray=new bi({gl:o,program:this.program,attributes:a})}},{key:"onDestroy",value:function(){this.bufferData=[]}},{key:"onChanged",value:function(o,a){if(this.gl){for(var y=[],g=o.color,x=o.size,v=o.borderWidth,M=o.borderColor,D=0;D<a.length;D++){var U=this.normizedPoint(a[D].geometry.coordinates),C=this.getProperty("color",g,a[D]);C=this.normizedColor(C);var L=this.getProperty("size",x,a[D]);L=Number(L);var B=this.getProperty("borderWidth",v,a[D]);B=Number(B);var O=this.getProperty("borderColor",M,a[D]);O=this.normizedColor(O),U=this.addMultipleCoords(U);for(var k=0;k<U.length;k++){var j=U[k];y.push(j[0],j[1],Number(j[2]||0)),y.push(C[0],C[1],C[2],C[3]),y.push(L),y.push(B,O[0],O[1],O[2],O[3])}}this.bufferData=y,this.buffer.updateData(new Float32Array(y)),o.enablePicked&&this.parsePickData(a)}}},{key:"parsePickData",value:function(o){var a=this.getOptions(),y=[];if(a.enablePicked)for(var g=0;g<o.length;g++){var x=this.indexToRgb(g);y.push(x[0]/255,x[1]/255,x[2]/255),a.repeat&&(y.push(x[0]/255,x[1]/255,x[2]/255),y.push(x[0]/255,x[1]/255,x[2]/255))}a.enablePicked&&this.pickBuffer.updateData(new Float32Array(y))}},{key:"render",value:function(o){var a=o.gl,y=o.matrix,g=o.isPickRender;if(!(0>=this.bufferData.length)){var x=this.getOptions(),v=this.program;v.use(a),o=this.getCommonUniforms(o),o=Vr(o,{uMatrix:y,uUnitPx:x.unit==="px",zoomUnits:this.map.getZoomUnits(),devicePixelRatio:window.devicePixelRatio}),v.setUniforms(o),this.setGLState({blend:!g,blendFunc:$s(a,x.blend),blendEquation:a.FUNC_ADD,polygonOffset:x.polygonOffset,depthTest:x.depthTest}),this.vertexArray.bind(),a.drawArrays(a.POINTS,0,this.bufferData.length/13)}}}]),h}(Ci),py=function(l){function h(o,a){return Xe(this,h),o=_r(this,(h.__proto__||ur(h)).call(this,o,a)),o.name="GroundRippleLayer",o.bufferDataArr=[],o.indexDataArr=[],o.vertexBuffer=[],o.indexBuffer=[],o.position=[],o.opacity=1,o.currentScale=1,o.autoUpdate=!0,o}return yr(h,l),Ue(h,[{key:"getDefaultOptions",value:function(){return{color:[.1,.1,.9,1],size:5,segs:32,scale:2,unit:"m",step:.1}}},{key:"initialize",value:function(o){this.gl=o,this.program=new jr(this.gl,{vertexShader:"uniform mat4 u_projectionMatrix;uniform mat4 u_modelViewMatrix;uniform mat4 u_modelMatrix;uniform float u_opacity;attribute vec4 aPos;attribute vec4 aColor;varying vec4 vColor;void main(){vColor=aColor;vColor.a=u_opacity;gl_Position=u_projectionMatrix*u_modelViewMatrix*u_modelMatrix*vec4(aPos.xyz,1.0);}",fragmentShader:"precision highp float;varying vec4 vColor;void main(){if(vColor.a==0.0){discard;}gl_FragColor=vColor;}"})}},{key:"onDestroy",value:function(){this.bufferDataArr=[],this.indexDataArr=[],this.vertexBuffer=[],this.indexBuffer=[]}},{key:"onChanged",value:function(o,a){var y=this.gl;if(y&&(this.currentScale=this.opacity=1,(this.data=a)&&a.length)){var g=o.color,x=o.segs;o=o.size;for(var v=360/x,M=0;M<a.length;M++){var D=[],U=[],C=this.normizedPoint(a[M].geometry.coordinates),L=g;Object.prototype.toString.call(L)==="[object Function]"?L=L(a[M]):(L=a[M].color||g,"properties"in a[M]&&"color"in a[M].properties&&(L=a[M].properties.color)),L=this.normizedColor(L);var B=Object.prototype.toString.call(o)==="[object Function]"?o(a[M]):Number(o),O=C[0],k=C[1];D.push(0,0,-.5),D.push(L[0],L[1],L[2],0);for(var j=1,V=0;j<=x;j++,V+=v)D.push(C[0]-O+Math.cos(Math.PI/180*V)*B,C[1]-k+Math.sin(Math.PI/180*V)*B,-.5),D.push(L[0],L[1],L[2],this.opacity),j===x?U.push(0,0+j,1):U.push(0,0+j,0+j+1);L=y.createBuffer(),y.bindBuffer(y.ARRAY_BUFFER,L),y.bufferData(y.ARRAY_BUFFER,new Float32Array(D),y.STATIC_DRAW),this.vertexBuffer[M]=L,this.bufferDataArr[M]=D,y.bindBuffer(y.ARRAY_BUFFER,null),D=y.createBuffer(),y.bindBuffer(y.ELEMENT_ARRAY_BUFFER,D),y.bufferData(y.ELEMENT_ARRAY_BUFFER,new Uint16Array(U),y.STATIC_DRAW),this.indexBuffer[M]=D,this.indexDataArr[M]=U,y.bindBuffer(y.ELEMENT_ARRAY_BUFFER,null),this.position[M]=[C[0],C[1]]}this.webglLayer&&this.webglLayer.render()}}},{key:"render",value:function(o){var a=o.gl,y=o.projectionMatrix,g=o.viewMatrix;for(o=this.program,a.useProgram(o.program),a.uniformMatrix4fv(o.uniforms.u_projectionMatrix,!1,y),a.uniformMatrix4fv(o.uniforms.u_modelViewMatrix,!1,g),y=this.opacity,this.options.opacity!==void 0&&(y=this.options.opacity),a.uniform1f(o.uniforms.u_opacity,y),this.setGLState({blend:!0,blendEquation:a.FUNC_ADD,blendFunc:[a.SRC_ALPHA,a.DST_ALPHA]}),a.enableVertexAttribArray(o.attributes.aPos),a.enableVertexAttribArray(o.attributes.aColor),y=0;y<this.bufferDataArr.length;y++)if(!(0>=this.bufferDataArr[y].length)){g=new Float32Array(this.bufferDataArr[y]).BYTES_PER_ELEMENT,a.bindBuffer(a.ARRAY_BUFFER,this.vertexBuffer[y]),a.vertexAttribPointer(o.attributes.aColor,4,a.FLOAT,!1,7*g,3*g),a.vertexAttribPointer(o.attributes.aPos,3,a.FLOAT,!1,7*g,0),g=this.position[y];var x=Ke.create(),v=[this.currentScale,this.currentScale,this.currentScale];this.options.unit==="px"&&this.map&&(v=this.map.getZoomUnits(),v=[this.currentScale*v,this.currentScale*v,this.currentScale]),Ke.identity(x),Ke.translate(x,x,[g[0],g[1],0]),Ke.scale(x,x,v),a.uniformMatrix4fv(o.uniforms.u_modelMatrix,!1,x),a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,this.indexBuffer[y]),a.drawElements(a.TRIANGLES,this.indexDataArr[y].length,a.UNSIGNED_SHORT,0),a.bindBuffer(a.ARRAY_BUFFER,null),a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,null)}o=this.getOptions(),a=o.scale,o=o.step,this.opacity-=o/10,this.currentScale+=a*o,0>this.opacity&&(this.currentScale=this.opacity=1)}}]),h}(Ci),dy=function(l){function h(o){return Xe(this,h),o=_r(this,(h.__proto__||ur(h)).call(this,o)),o.name="RippleLayer",o.bufferData=[],o.date=new Date,o.autoUpdate=!0,o}return yr(h,l),Ue(h,[{key:"getDefaultOptions",value:function(){return{depthTest:!0,polygonOffset:[0,0],color:[.1,.1,.9,1],blend:"normal",size:20,unit:"px",duration:2}}},{key:"initialize",value:function(o){this.gl=o;var a=this.getOptions();this.program=new jr(this.gl,{vertexShader:`attribute vec3 aPos;attribute vec4 aColor;attribute float aSize;uniform mat4 uMatrix;uniform vec4 uSelectedColor;uniform float uTime;uniform float duration;uniform float zoomUnits;varying vec4 vColor;void main(void){if(aColor.w>=0.0&&aColor.w<=1.0){vColor=aColor;}else{vColor=vec4(aColor.xyz,1.0);}float percent=mod(uTime,duration)/duration;vColor.a=1.-percent;gl_Position=uMatrix*vec4(aPos.xyz,1.0);gl_PointSize=aSize/zoomUnits*percent;
#if defined(PICK)
if(mapvIsPicked()){vColor=uSelectedColor;}
#endif
}`,fragmentShader:"varying vec4 vColor;void main(void){vec4 color=vColor;float d=distance(gl_PointCoord,vec2(0.5,0.5));if(d>0.5){discard;}float blur=1.0;blur=1.0-smoothstep(0.49,0.5,d);color.a*=blur;gl_FragColor=color;}",defines:a.enablePicked?["PICK"]:[]},this),this.buffer=new qe({gl:o,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),a=[{stride:32,name:"aPos",buffer:this.buffer,size:3,type:"FLOAT",offset:0},{stride:32,name:"aColor",buffer:this.buffer,size:4,type:"FLOAT",offset:12},{stride:32,name:"aSize",buffer:this.buffer,size:1,type:"FLOAT",offset:28}],a=a.concat(this.getCommonAttributes()),this.vertexArray=new bi({gl:o,program:this.program,attributes:a})}},{key:"onDestroy",value:function(){this.bufferData=[]}},{key:"onChanged",value:function(o,a){if(this.gl){for(var y=[],g=o.color,x=o.size,v=0;v<a.length;v++){var M=a[v].geometry.coordinates,D=g;Object.prototype.toString.call(D)==="[object Function]"?D=D(a[v]):(D=a[v].color||g,"properties"in a[v]&&"color"in a[v].properties&&(D=a[v].properties.color)),D=this.normizedColor(D),M=this.normizedPoint(M);var U=a[v].size||x;"properties"in a[v]&&"size"in a[v].properties&&(U=a[v].properties.size),U=Object.prototype.toString.call(U)==="[object Function]"?U(a[v]):Number(U),y.push(M[0],M[1],Number(M[2]||0)),y.push(D[0],D[1],D[2],D[3]),y.push(U*window.devicePixelRatio)}this.bufferData=y,this.buffer.updateData(new Float32Array(y)),o.enablePicked&&this.parsePickData(a)}}},{key:"parsePickData",value:function(o){var a=this.getOptions(),y=[];if(a.enablePicked)for(var g=0;g<o.length;g++){var x=this.indexToRgb(g);y.push(x[0]/255,x[1]/255,x[2]/255)}a.enablePicked&&this.pickBuffer.updateData(new Float32Array(y))}},{key:"render",value:function(o){var a=o.gl,y=o.matrix,g=o.isPickRender;if(!(0>=this.bufferData.length)){var x=this.getOptions(),v=this.program;v.use(a),this.vertexArray.bind(),o=this.getCommonUniforms(o);var M=1;x.unit==="m"&&this.map&&(M=this.map.getZoomUnits()),o=Vr(o,{zoomUnits:M,uTime:(new Date-this.date)/1e3,duration:x.duration,uMatrix:y}),v.setUniforms(o),this.setGLState({blend:!g,blendFunc:x.blend==="lighter"?[a.SRC_ALPHA,a.ONE]:[a.SRC_ALPHA,a.ONE_MINUS_SRC_ALPHA],blendEquation:a.FUNC_ADD,polygonOffset:x.polygonOffset,depthTest:x.depthTest}),a.drawArrays(a.POINTS,0,this.bufferData.length/8)}}}]),h}(Ci),my=function(l){function h(o,a){return Xe(this,h),o=_r(this,(h.__proto__||ur(h)).call(this,o,a)),o.name="SparkLayer",o.bufferData=[],o.startTime=Number(o.options.startTime)||0,o.endTime=Number(o.options.endTime),o.time=o.startTime,o.segs=Number(o.options.segs)||10,o.autoUpdate=!0,o}return yr(h,l),Ue(h,[{key:"getDefaultOptions",value:function(){return{color:[.9,.1,.1,1],trailLength:3,height:100,step:.1,segs:10,polygonOffset:[0,0]}}},{key:"setTime",value:function(o){this.time=o}},{key:"initialize",value:function(o){this.gl=o,this.program=new jr(this.gl,{vertexShader:"precision mediump float;attribute vec4 aPos;uniform mat4 u_matrix;uniform float currentTime;uniform float trailLength;varying float vTime;void main(){gl_Position=u_matrix*vec4(aPos.xyz,1.0);vTime=1.0-((currentTime-aPos.w)/trailLength);}",fragmentShader:"precision mediump float;uniform vec3 uFragColor;varying float vTime;void main(){if(vTime>1.0||vTime<0.0){discard;}gl_FragColor=vec4(uFragColor,1.0*vTime);}"}),this.buffer=o.createBuffer(),o.bindBuffer(o.ARRAY_BUFFER,this.buffer)}},{key:"onDestroy",value:function(){this.bufferData=[]}},{key:"onChanged",value:function(o,a){var y=this.gl;if(y){this.buffer=y.createBuffer(),y.bindBuffer(y.ARRAY_BUFFER,this.buffer);for(var g=[],x=o.height,v=0;v<a.length;v++)for(var M=a[v].geometry.coordinates,D=Object.prototype.toString.call(x)==="[object Function]"?x(a[v]):Number(x),U=0,C=0;C<this.segs;C++){var L=this.normizedPoint(M);g.push(L[0],L[1],U),M[2]===void 0?g.push(C):g.push(Number(M[2])),U+=D/this.segs,g.push(L[0],L[1],U),M[2]===void 0?g.push(C+1):g.push(Number(M[2]))}o.endTime===void 0&&(this.endTime=this.segs),this.bufferData=g,y.bufferData(y.ARRAY_BUFFER,new Float32Array(g),y.STATIC_DRAW),this.webglLayer&&this.webglLayer.render()}}},{key:"render",value:function(o){var a=o.gl,y=o.matrix;o=this.program,a.useProgram(o.program),a.uniformMatrix4fv(o.uniforms.u_matrix,!1,y),a.bindBuffer(a.ARRAY_BUFFER,this.buffer),a.enableVertexAttribArray(o.attributes.aPos),a.vertexAttribPointer(o.attributes.aPos,4,a.FLOAT,!1,0,0),y=this.normizedColor(this.options.color),a.uniform3f(o.uniforms.uFragColor,y[0],y[1],y[2]),a.uniform1f(o.uniforms.currentTime,this.time),a.uniform1f(o.uniforms.trailLength,this.options.trailLength),this.setGLState({blend:!0,blendFunc:[a.SRC_ALPHA,a.ONE],blendEquation:a.FUNC_ADD,polygonOffset:this.options.polygonOffset}),a.drawArrays(a.LINES,0,this.bufferData.length/4),this.time+=Number(this.options.step),this.time>1.5*this.endTime&&(this.time=this.startTime)}}]),h}(Ci),gy=function(l){function h(o,a){return Xe(this,h),o=_r(this,(h.__proto__||ur(h)).call(this,o,a)),o.name="IconLayer",o.index=[],a=o.canvas=document.createElement("canvas"),o.ctx=a.getContext("2d"),o.iconHash=new tu,o}return yr(h,l),Ue(h,[{key:"getDefaultOptions",value:function(){return{depthWrite:!0,depthTest:!0,blend:"default",flat:!1,unit:"px",scale:1,angle:0,opacity:1,offset:[0,0],padding:[0,0],polygonOffset:[0,0]}}},{key:"initialize",value:function(o){this.gl=o;var a=this.getOptions();this.texture=null,this.program=new jr(this.gl,{vertexShader:"precision highp float;attribute vec3 a_pos;attribute float a_corner;attribute float a_rotation;attribute vec2 a_size;attribute vec2 a_offset;attribute vec2 a_texture_coord;uniform mat4 u_matrix;uniform vec2 u_size;uniform float devicePixelRatio;uniform float u_zoom_units;uniform float u_zIndex;uniform float u_scale;uniform bool u_unit_px;uniform bool u_flat;varying vec2 v_texture_coord;/***\u70B9A(x,y)\uFF0C\u7ED5\u539F\u70B9\u987A\u65F6\u9488\u65CB\u8F6C\u89D2\u5EA6a\u65B0\u5750\u6807\u7684\u8BA1\u7B97\u516C\u5F0F*x1=x*cos(a)+y*sin(a)*y1=y*cos(a)-x*sin(a)*/vec3 transformCoord(vec3 coord,vec2 size,float corner){float x=coord.x;float y=coord.y;if(corner==1.0){x+=-size.x*cos(a_rotation)+size.y*sin(a_rotation);y+=size.y*cos(a_rotation)+size.x*sin(a_rotation);}else if(corner==2.0){x+=size.x*cos(a_rotation)+size.y*sin(a_rotation);y+=size.y*cos(a_rotation)-size.x*sin(a_rotation);}else if(corner==3.0){x+=size.x*cos(a_rotation)-size.y*sin(a_rotation);y+=-size.y*cos(a_rotation)-size.x*sin(a_rotation);}else{x+=-size.x*cos(a_rotation)-size.y*sin(a_rotation);y+=-size.y*cos(a_rotation)+size.x*sin(a_rotation);}return vec3(x,y,coord.z);}void main(){v_texture_coord=a_texture_coord;if(u_flat){vec2 offset=a_offset;vec2 halfSize=a_size/2.0*u_scale;if(u_unit_px){halfSize*=u_zoom_units;offset*=u_zoom_units;}vec3 current=transformCoord(a_pos,halfSize,a_corner);current.z+=u_zIndex;gl_Position=u_matrix*vec4(current.x+offset[0],current.y-offset[1],current.z,1.0);}else{vec4 position=u_matrix*vec4(a_pos,1.0);vec3 screen=position.xyz/position.w;vec2 halfSize=a_size/MAPV_resolution*devicePixelRatio*u_scale;vec2 offset=a_offset*2./MAPV_resolution*devicePixelRatio;if(!u_unit_px){halfSize/=u_zoom_units;offset/=u_zoom_units;}vec3 current=transformCoord(screen,halfSize,a_corner);current.xy=current.xy-offset;current.z+=u_zIndex;gl_Position=vec4(current,1.0);}}",fragmentShader:`precision highp float;varying vec2 v_texture_coord;uniform sampler2D u_icon;uniform float u_opacity;uniform vec4 uSelectedColor;void main(){vec4 textureColor=texture2D(u_icon,vec2(v_texture_coord.x,1.0-v_texture_coord.y));if(textureColor.a==0.0&&uIsPickRender==false){discard;}textureColor.a*=u_opacity;gl_FragColor=textureColor;
#if defined(PICK)
if(mapvIsPicked()){gl_FragColor=vec4(uSelectedColor.rgb,gl_FragColor.a);}
#endif
}`,defines:a.enablePicked?["PICK"]:[]},this),this.vertexBuffer=new qe({gl:o,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.uvBuffer=new qe({gl:o,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.indexBuffer=new qe({gl:o,target:"ELEMENT_ARRAY_BUFFER",usage:"STATIC_DRAW"}),a=[{name:"a_pos",buffer:this.vertexBuffer,size:3,stride:36,type:"FLOAT",offset:0},{name:"a_corner",buffer:this.vertexBuffer,size:1,stride:36,type:"FLOAT",offset:12},{name:"a_size",buffer:this.vertexBuffer,size:2,stride:36,type:"FLOAT",offset:16},{name:"a_offset",buffer:this.vertexBuffer,size:2,stride:36,type:"FLOAT",offset:24},{name:"a_rotation",buffer:this.vertexBuffer,size:1,stride:36,type:"FLOAT",offset:32},{name:"a_texture_coord",buffer:this.uvBuffer,size:2,stride:8,type:"FLOAT",offset:0}],a=a.concat(this.getCommonAttributes()),this.vertexArray=new bi({gl:o,program:this.program,attributes:a})}},{key:"onDestroy",value:function(){}},{key:"onChanged",value:function(o,a){this.gl&&this.processCache(o,a,2<arguments.length&&arguments[2]!==void 0?arguments[2]:{})}},{key:"processCache",value:function(o,a,y){var g=this;this.cachedData=[];for(var x=o.icon,v=o.width,M=o.height,D=o.offset,U=o.angle,C=0;C<a.length;C++){var L=this.normizedPoint(a[C].geometry.coordinates),B=this.getProperty("icon",x,a[C]),O=this.getProperty("width",v,a[C]),k=this.getProperty("height",M,a[C]),j=this.getProperty("offset",D,a[C]),V=this.getProperty("angle",U,a[C]);L&&B&&(this.cachedData.push({point:L,icon:B,width:O,height:k,offset:j,angle:V,index:C}),this.iconHash.get(B)||this.iconHash.set(B,B))}a=eo(this.iconHash.entries()).filter(function(Y){return typeof Y[1]=="string"}).map(function(Y){var Q=Ri(Y,2)[0];return new ga(function(nt,ut){g.url2canvas(Q,function(ct){g.iconHash.set(Q,ct),nt()})})}),ga.all(a).then(function(Y){g.buildSprite(o),y.autoRender!==!1&&g.webglLayer&&g.webglLayer.render()})}},{key:"buildSprite",value:function(o){var a=o.padding,y=this.canvas,g=this.ctx,x=[],v=new tu,M=!0,D=!1,U=void 0;try{for(var C=Bu(this.iconHash),L;!(M=(L=C.next()).done);M=!0){var B=Ri(L.value,2),O=B[1];if(typeof O!="string"){var k=O.width,j=O.height;x.push({w:k+a[0],h:j+a[0],width:k,height:j,key:B[0],icon:O})}}}catch(V){D=!0,U=V}finally{try{!M&&C.return&&C.return()}finally{if(D)throw U}}for(D=Iu(x),M=0;M<x.length;M++)U=x[M],v.get(U.key)||v.set(U.key,U);for(M=Me(D.w),D=Me(D.h),y.width=M||1,y.height=D||1,g.save(),y=0;y<x.length;y++)U=x[y],g.drawImage(U.icon,U.x+a[0],U.y+a[1],U.width,U.height);g.restore(),this.loadTexture(),this.buildVertex(o,v,M,D)}},{key:"buildVertex",value:function(o,a,y,g){o=o.enablePicked;for(var x=[],v=[],M=[],D=[],U=0;U<this.cachedData.length;U++){var C=this.cachedData[U],L=C.point,B=C.width,O=C.height,k=C.offset,j=C.angle,V=C.index;if(C=a.get(C.icon)){B=B||C.icon.width,O=O||C.icon.height;var Y=Ri(L,3);L=Y[0];var Q=Y[1];Y=Y[2];for(var nt=0;4>nt;nt++)x.push(L,Q,Y),x.push(nt),x.push(B,O),x.push.apply(x,Wr(k)),x.push(j*Math.PI/180);B=C.x/y,O=(C.x+C.w)/y,k=(C.y+C.h)/g,C=C.y/g,v.push(B,k,B,C,O,C,O,k),C=4*U,M.push(C,C+2,C+1,C,C+3,C+2),o&&(V=this.indexToRgb(V),D.push(V[0]/255,V[1]/255,V[2]/255),D.push(V[0]/255,V[1]/255,V[2]/255),D.push(V[0]/255,V[1]/255,V[2]/255),D.push(V[0]/255,V[1]/255,V[2]/255))}}this.index=M,this.vertexBuffer.updateData(new Float32Array(x)),this.uvBuffer.updateData(new Float32Array(v)),this.indexBuffer.updateData(new Uint32Array(M)),o&&this.pickBuffer.updateData(new Float32Array(D))}},{key:"render",value:function(o){if(this.cachedData&&this.cachedData.length&&this.iconHash&&this.texture){var a=o.gl,y=o.matrix,g=this.getOptions(),x=this.program;x.use(a),this.setGLState({blend:!0,blendFunc:$s(a,g.blend),polygonOffset:g.polygonOffset,depthTest:g.depthTest,depthMask:g.depthWrite}),x.setUniforms(Vr(this.getCommonUniforms(o),{u_icon:this.texture,u_matrix:y,u_flat:g.flat,u_unit_px:g.unit==="px",u_zoom_units:this.map.getZoomUnits(),u_scale:g.scale,u_opacity:g.opacity,u_zIndex:g.zIndex,devicePixelRatio:window.devicePixelRatio})),0<this.index.length&&(this.indexBuffer.bind(),this.vertexArray.bind(),a.drawElements(a.TRIANGLES,this.index.length,a.UNSIGNED_INT,0))}}},{key:"url2canvas",value:function(o,a){if((typeof o=="undefined"?"undefined":kn(o))==="object")a(o);else{var y=new Image;y.crossOrigin="anonymous",y.onload=function(){var g=y.width,x=y.height,v=document.createElement("canvas");v.width=g,v.height=x,v.getContext("2d").drawImage(y,0,0,g,x),a(v)},y.onerror=function(){var g=document.createElement("canvas");g.width=20,g.height=40;var x=g.getContext("2d");x.fillStyle="red",x.beginPath(),x.lineTo(0,0),x.lineTo(20,0),x.lineTo(10,40),x.closePath(),x.fill(),a(g)},y.src=o}}},{key:"loadTexture",value:function(){var o=this;this.canvas?xn(this.gl,this.canvas,function(a){o.texture=a}):this.texture=null}}]),h}(Ci),HA=function(l){function h(o){Xe(this,h),o=_r(this,(h.__proto__||ur(h)).call(this,o)),o.pointLayer=new rp(o.options),o.options.textOptions=Vr({depthTest:!1},o.options.textOptions),o.textLayer=new Yl(o.options.textOptions);var a=Vr({},o.options,o.options.iconOptions);return o.iconLayer=new gy(a),o.children=[o.pointLayer,o.textLayer,o.iconLayer],o}return yr(h,l),Ue(h,[{key:"getDefaultOptions",value:function(){return{minSize:25,maxSize:40,clusterRadius:200,minPoints:2,extent:400,showText:!0,maxZoom:19,minZoom:4,gradient:{0:"rgb(50, 50, 256)","0.1":"rgb(50, 250, 56)","0.5":"rgb(250, 250, 56)",1:"rgb(250, 50, 56)"},textOptions:{fontSize:12,color:"white"},iconOptions:{}}}},{key:"onOptionsChanged",value:function(o){this.textLayer.setOptions(o.textOptions)}},{key:"setOptions",value:function(){var o=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{},a=this.options.textOptions;o.textOptions&&Vr(a,o.textOptions);var y=o.minZoom,g=o.maxZoom,x=o.clusterRadius;y=g&&g!==this.options.maxZoom||y&&y!==this.options.minZoom||x&&x!==this.options.clusterRadius,Vr(this.options,o,{textOptions:a}),y?this.onChanged(this.options,this.data):this.refreshCluster(),this.onOptionsChanged(this.getOptions())}},{key:"onChanged",value:function(o,a){var y=this;a&&a.length?(a.forEach(function(g){var x=Ri(g.geometry.coordinates,2),v=x[0];x=x[1],-180<=v&&180>=v&&-90<=x&&90>=x||(v=y.map.mercatorToLnglat(v,x),g.geometry.coordinates[0]=v[0],g.geometry.coordinates[1]=v[1])}),this.supercluster=new ep({maxZoom:o.maxZoom,minZoom:o.minZoom,radius:o.clusterRadius,minPoints:o.minPoints,extent:o.extent}),this.supercluster.load(a),this.supercluster.trees.forEach(function(g){var x=0,v=1/0;g.points.forEach(function(M){x=Math.max(M.numPoints||0,x),v=Math.min(M.numPoints||1/0,v)}),g.max=x,g.min=v}),this.refreshCluster()):(this.supercluster=null,this.pointLayer.setData([]),this.iconLayer.setData([]),this.textLayer.setData([]))}},{key:"refreshCluster",value:function(){var o=this,a=0<arguments.length&&arguments[0]!==void 0?arguments[0]:this.options;if(this.supercluster){var y=this.getClusterData(a);if(y&&y.length)if(typeof a.beforeRender=="function"&&a.beforeRender(y)===!1)this.pointLayer.setData([]),this.iconLayer.setData([]),this.textLayer.setData([]);else{var g=[],x=[],v=[];y.forEach(function(M){M.properties.cluster?(g.push(M),v.push({geometry:M.geometry,properties:{text:M.properties.text}})):M.properties.icon||o.options.iconOptions.icon?x.push(M):g.push(M)}),this.pointLayer.setData(g),this.iconLayer.setData(x),this.textLayer.setData(a.showText?v:[]),a.enablePicked&&a.autoSelect&&this.pick(-1,-1)}}}},{key:"getClusterData",value:function(){var o=0<arguments.length&&arguments[0]!==void 0?arguments[0]:this.options,a=this.map.getBounds(),y=this.ne=a.getNorthEast();a=this.sw=a.getSouthWest();var g=y,x=g.lng;return g=g.lat,-180<=x&&180>=x&&-90<=g&&90>=g?a=[a.lng,a.lat,y.lng,y.lat]:(y=this.map.mercatorToLnglat(this.ne.lng,this.ne.lat),a=this.map.mercatorToLnglat(this.sw.lng,this.sw.lat),a=a.concat(y)),y=Math.floor(this.map.getZoom()),a=this.supercluster.getClusters(a,y),this.zoom!==y&&0<a.length&&(this.zoom=y,g=this.supercluster.trees,x=g[y]&&g[y].max||this.max,y=g[y]&&g[y].min||this.min,x!==y&&(this.max=x,this.min=y)),this.processData(a,o)}},{key:"processData",value:function(o,a){var y=a.defaultColor,g=a.defaultSize,x=a.gradient,v=a.minSize,M=a.textOptions,D=new Li({max:this.max,min:~~this.min||1,minSize:v||8,maxSize:a.maxSize||30,gradient:x});y=y||x[0]||"black",g=g||.5*v||5;var U=M&&M.format;return U=typeof U=="function"?U:null,o.map(function(C){var L=g,B=y,O="";return C.properties&&C.properties.point_count&&(O=C.properties.point_count,L=D.getSize(O)||L,B=D.getColor(O),O=U?U(O):O),L=Vr({},C.properties,{text:O,size:L,color:B}),Vr({},C,{properties:L,children:C.id})})}},{key:"pick",value:function(o,a){var y=this.pointLayer.pick(o,a);return 0>y.dataIndex&&(y=this.iconLayer.pick(o,a)),(o=y.dataItem)&&typeof o.children=="number"&&(o.children=this.getClusterPoints(o.children)),y}},{key:"getClusterPoints",value:function(o){var a=this;return o?this.supercluster.getChildren(o).map(function(y){return y.type==="Feature"?a.getClusterPoints(y.id):y}).flat():[]}},{key:"shouldUpdate",value:function(){if(!this.data||!this.supercluster)return!1;if(this.zoom!==Math.floor(this.map.getZoom()))return!0;var o=this.map.getBounds(),a=o.getNorthEast();if(o=o.getSouthWest(),this.ne.lng!==a.lng||this.ne.lat!==a.lat||this.sw.lng!==o.lng||this.sw.lat!==o.lat)return!0}},{key:"render",value:function(o){this.shouldUpdate()?this.refreshCluster():fa(h.prototype.__proto__||ur(h.prototype),"render",this).call(this,o)}}]),h}(da),vv=function(l){function h(o,a){return Xe(this,h),_r(this,(h.__proto__||ur(h)).call(this,o,a))}return yr(h,l),Ue(h,[{key:"getDefaultOptions",value:function(){return Vr(fa(h.prototype.__proto__||ur(h.prototype),"getDefaultOptions",this).call(this),{style:"grid",gridSize:500,gradient:{0:"rgb(50, 50, 256)","0.1":"rgb(50, 250, 56)","0.5":"rgb(250, 250, 56)",1:"rgb(250, 50, 56)"}})}},{key:"onChanged",value:function(o,a){this.gl&&(a=this.processData(a,o),fa(h.prototype.__proto__||ur(h.prototype),"onChanged",this).call(this,o,a))}},{key:"generateGrid",value:function(o,a){var y=a.gridSize,g=[],x={};a=o.length;for(var v=this.getPointOffset(),M=0;M<a;M++){var D=this.normizedPoint(o[M].geometry.coordinates),U=D[2];D=~~((D[0]+v[0])/y)+"_"+~~((D[1]+v[1])/y),x[D]===void 0&&(x[D]={count:0,num:0,z:0});var C=~~o[M].count||1;"properties"in o[M]&&"count"in o[M].properties&&(C=~~o[M].properties.count),x[D].count+=C,x[D].num+=1,x[D].z+=U}return bn(x).forEach(function(L){var B=L.split("_");g.push([B[0]*y+y/2,B[1]*y+y/2,x[L].z/x[L].num,x[L].count])}),g}},{key:"processData",value:function(o,a){var y=[];if(a.style==="normal")for(var g=this.getPointOffset(),x=0;x<o.length;x++){var v=this.normizedPoint(o[x].geometry.coordinates),M=v[0]+g[0],D=v[1]+g[1];v=v[2];var U=~~o[x].count||1;"properties"in o[x]&&"count"in o[x].properties&&(U=~~o[x].properties.count),y.push([M,D,v,U])}else y=this.generateGrid(o,a);if(g=o=0,a.max!==void 0&&a.min!==void 0)o=a.max,g=a.min;else{for(y[0]&&(o=y[0][3],g=y[0][3]),x=y.length,M=0;M<x;M++)D=y[M],o=Math.max(D[3],o),g=Math.min(D[3],g);o/=2}for(a=new Li({max:~~o,min:g,gradient:a.gradient}),o=[],g=0;g<y.length;g++)x=y[g],x[0]=x[0],x[1]=x[1],M=a.getImageData(x[3]),o.push({geometry:{type:"Point",coordinates:[x[0],x[1],x[2]]},color:[M[0]/255,M[1]/255,M[2]/255,M[3]/255]});return o}}]),h}(rp),GA=function(l){function h(o,a){return Xe(this,h),o=_r(this,(h.__proto__||ur(h)).call(this,o,a)),o.bufferData=[],o}return yr(h,l),Ue(h,[{key:"getDefaultOptions",value:function(){return{color:[1,.05,.05,1]}}},{key:"onChanged",value:function(o,a){var y=this;if(o=this.gl){this.buffer=o.createBuffer(),o.bindBuffer(o.ARRAY_BUFFER,this.buffer);for(var g=[],x=function(M){var D=5*M;for(M=0;M<a.length;M++)a[M].geometry.coordinates.forEach(function(U){for(var C=0;C<U.length-1;C++){var L=y.normizedPoint(U[C]);g.push(L[0]),g.push(L[1]),g.push(Number(D)),L=y.normizedPoint(U[C+1]),g.push(L[0]),g.push(L[1]),g.push(Number(D))}})},v=0;20>v;v++)x(v);o.bufferData(o.ARRAY_BUFFER,new Float32Array(g),o.STATIC_DRAW),this.bufferData=g,o.bindBuffer(o.ARRAY_BUFFER,null)}}},{key:"initialize",value:function(o){this.gl=o,this.program=new jr(o,{vertexShader:"uniform mat4 uMatrix;attribute vec3 aPos;void main(){gl_PointSize=10.0;gl_Position=uMatrix*vec4(aPos,1.0);}",fragmentShader:"precision mediump float;uniform vec4 uFragColor;void main(){gl_FragColor=uFragColor;}"}),this.buffer=o.createBuffer(),o.bindBuffer(o.ARRAY_BUFFER,this.buffer)}},{key:"render",value:function(o){var a=o.gl;o=o.matrix;var y=this.program;a.useProgram(y.program);var g=this.normizedColor(this.options.color);a.uniform4f(y.uniforms.uFragColor,g[0],g[1],g[2],g[3]),a.uniformMatrix4fv(y.uniforms.uMatrix,!1,o),a.bindBuffer(a.ARRAY_BUFFER,this.buffer),a.enableVertexAttribArray(y.attributes.aPos),a.vertexAttribPointer(y.attributes.aPos,3,a.FLOAT,!1,0,0),this.setGLState({blend:!0,blendEquation:a.FUNC_ADD,blendFunc:[a.ONE,a.ONE]}),a.drawArrays(a.LINES,0,this.bufferData.length/3)}}]),h}(Ci),vy={circle:1,square:2},eu=function(l){function h(o,a){return Xe(this,h),o=_r(this,(h.__proto__||ur(h)).call(this,o,a)),o.bufferData=[],o.startTime=o.options.startTime||0,o.endTime=o.options.endTime,o.time=o.startTime,o.autoUpdate=!0,o}return yr(h,l),Ue(h,[{key:"initialize",value:function(o){this.gl=o,this.program=new jr(this.gl,{vertexShader:"attribute vec4 aPos;attribute vec4 aColor;attribute float aSize;uniform mat4 u_matrix;varying vec4 vColor;uniform float currentTime;uniform float trailLength;varying float vTime;void main(void){if(aColor.w>=0.0&&aColor.w<=1.0){vColor=aColor;}else{vColor=vec4(aColor.xyz,1.0);}gl_Position=u_matrix*vec4(aPos.xyz,1.0);gl_PointSize=aSize;vTime=1.0-((currentTime-aPos.w)/trailLength);}",fragmentShader:"precision highp float;varying vec4 vColor;uniform int uShape;varying float vTime;void main(void){if(vTime>1.0||vTime<0.0){discard;}if(uShape==1){float d=distance(gl_PointCoord,vec2(0.5,0.5));if(d<0.5){gl_FragColor=vColor;}else{discard;}}else{gl_FragColor=vec4(vColor.rgb,vColor.a*vTime);}}"}),this.f32BufferData=new Float32Array,this.buffer=o.createBuffer(),o.bindBuffer(o.ARRAY_BUFFER,this.buffer)}},{key:"onChanged",value:function(o,a){var y=this.gl;if(y){this.buffer=y.createBuffer(),y.bindBuffer(y.ARRAY_BUFFER,this.buffer);for(var g=[],x=o.color||[.1,.1,.9,1],v=o.size||5,M=0;M<a.length;M++){var D=a[M].geometry.coordinates,U=x;Object.prototype.toString.call(U)==="[object Function]"?U=U(a[M]):(U=a[M].color||x,"properties"in a[M]&&"color"in a[M].properties&&(U=a[M].properties.color)),U=this.normizedColor(U);var C=this.normizedPoint(D),L=v;L=Object.prototype.toString.call(L)==="[object Function]"?L(a[M]):Number(L);var B=a[M].time||M;"properties"in a[M]&&"time"in a[M].properties&&(B=a[M].properties.time),g.push(C[0],C[1],Number(D[2]||0),B),g.push(U[0],U[1],U[2],U[3]),g.push(L*window.devicePixelRatio)}o.endTime===void 0&&(this.endTime=a.length),this.bufferData=g,this.f32BufferData=new Float32Array(g),y.bufferData(y.ARRAY_BUFFER,this.f32BufferData,y.STATIC_DRAW)}}},{key:"render",value:function(o){var a=o.gl,y=o.matrix;0>=this.bufferData.length||(o=this.program,a.useProgram(o.program),a.uniformMatrix4fv(o.uniforms.u_matrix,!1,y),a.bindBuffer(a.ARRAY_BUFFER,this.buffer),y=this.f32BufferData.BYTES_PER_ELEMENT,a.enableVertexAttribArray(o.attributes.aPos),a.vertexAttribPointer(o.attributes.aPos,4,a.FLOAT,!1,9*y,0),a.enableVertexAttribArray(o.attributes.aColor),a.vertexAttribPointer(o.attributes.aColor,4,a.FLOAT,!1,9*y,4*y),a.enableVertexAttribArray(o.attributes.aSize),a.vertexAttribPointer(o.attributes.aSize,1,a.FLOAT,!1,9*y,8*y),a.uniform1f(o.uniforms.currentTime,this.time),a.uniform1f(o.uniforms.trailLength,this.options.trailLength||3),y=1,this.options.shape&&vy[this.options.shape]&&(y=vy[this.options.shape]),a.uniform1i(o.uniforms.uShape,y),this.setGLState({blend:!0,blendEquation:a.FUNC_ADD,blendFunc:this.options.blend==="lighter"?[a.SRC_ALPHA,a.ONE]:[a.SRC_ALPHA,a.ONE_MINUS_SRC_ALPHA]}),a.drawArrays(a.POINTS,0,this.bufferData.length/9),this.time+=this.options.step||.1,this.time>this.endTime&&(this.time=this.startTime))}}]),h}(Ci),On=function(l){function h(o,a){return Xe(this,h),o=_r(this,(h.__proto__||ur(h)).call(this,o,a)),o.bufferData=[],o.startTime=o.options.startTime||0,o.endTime=o.options.endTime,o.time=o.startTime,o.autoUpdate=!0,o}return yr(h,l),Ue(h,[{key:"getDefaultOptions",value:function(){return{color:[1,.05,.05,1],trailLength:3,step:.1,polygonOffset:[0,0]}}},{key:"initialize",value:function(o){this.gl=o,this.program=new jr(this.gl,{vertexShader:"precision highp float;attribute vec4 aPos;attribute vec4 aColor;uniform mat4 u_matrix;uniform float currentTime;uniform float trailLength;varying float vTime;varying vec4 vColor;void main(){gl_Position=u_matrix*vec4(aPos.xyz,1.0);vColor=aColor;vTime=1.0-((currentTime-aPos.w)/trailLength);}",fragmentShader:"precision highp float;uniform vec3 uFragColor;varying vec4 vColor;varying float vTime;void main(){if(vTime>1.0||vTime<0.0){discard;}gl_FragColor=vec4(vColor.rgb,1.0*vTime);}"},this),this.buffer=o.createBuffer(),o.bindBuffer(o.ARRAY_BUFFER,this.buffer)}},{key:"setTime",value:function(o){this.time=o}},{key:"onChanged",value:function(o,a){var y=this.gl;if(y){this.buffer=y.createBuffer(),y.bindBuffer(y.ARRAY_BUFFER,this.buffer);for(var g=[],x=0,v=this.options.color,M=0;M<a.length;M++){var D=a[M].geometry.coordinates;a[M].color&&(v=a[M].color),"properties"in a[M]&&"color"in a[M].properties&&(v=a[M].properties.color),Object.prototype.toString.call(v)==="[object Function]"&&(v=v(a[M])),v=this.normizedColor(v),D.length>x&&(x=D.length);for(var U=0;U<D.length-1;U++){var C=this.normizedPoint(D[U]);g.push(C[0]),g.push(C[1]),g.push(C[2]),D[U][3]===void 0?g.push(U):g.push(Number(D[U][3])),g.push(v[0]),g.push(v[1]),g.push(v[2]),g.push(v[3]),C=this.normizedPoint(D[U+1]),g.push(C[0]),g.push(C[1]),g.push(C[2]),D[U+1][3]===void 0?g.push(U+1):g.push(Number(D[U+1][3])),g.push(v[0]),g.push(v[1]),g.push(v[2]),g.push(v[3])}}o.endTime===void 0&&(this.endTime=x),this.bufferData=g,this.f32BufferData=new Float32Array(g),y.bufferData(y.ARRAY_BUFFER,this.f32BufferData,y.STATIC_DRAW)}}},{key:"render",value:function(o){var a=o.gl,y=o.matrix;o=this.getOptions();var g=this.program;g.use(a),a.uniformMatrix4fv(g.uniforms.u_matrix,!1,y),a.bindBuffer(a.ARRAY_BUFFER,this.buffer),y=this.f32BufferData.BYTES_PER_ELEMENT,a.enableVertexAttribArray(g.attributes.aPos),a.vertexAttribPointer(g.attributes.aPos,4,a.FLOAT,!1,8*y,0),a.enableVertexAttribArray(g.attributes.aColor),a.vertexAttribPointer(g.attributes.aColor,4,a.FLOAT,!1,8*y,4*y),y=this.normizedColor(o.color),a.uniform3f(g.uniforms.uFragColor,y[0],y[1],y[2]),a.uniform1f(g.uniforms.currentTime,this.time),a.uniform1f(g.uniforms.trailLength,o.trailLength),this.setGLState({blend:!0,blendEquation:a.FUNC_ADD,blendFunc:o.blend==="lighter"?[a.ONE,a.ONE]:[a.SRC_ALPHA,a.ONE],polygonOffset:o.polygonOffset,depthMask:!1}),a.drawArrays(a.LINES,0,this.bufferData.length/8),this.time+=o.step,this.time>this.endTime&&(this.time=this.startTime)}}]),h}(Ci),VA=function(l){function h(o,a){return Xe(this,h),o=_r(this,(h.__proto__||ur(h)).call(this,o,a)),o.name="IconCollidesLayer",o.index=[],a=o.canvas=document.createElement("canvas"),o.ctx=a.getContext("2d"),o.iconHash=new tu,o.boxHash=new tu,o}return yr(h,l),Ue(h,[{key:"getDefaultOptions",value:function(){return{flat:!1,unit:"px",scale:1,angle:0,offset:[0,0],padding:[0,0]}}},{key:"initialize",value:function(o){this.gl=o;var a=this.getOptions();this.texture=null,this.lastUpdateTime=0,this.program=new jr(this.gl,{vertexShader:"precision highp float;attribute vec3 a_pos;attribute float a_corner;attribute float a_rotation;attribute vec2 a_size;attribute vec2 a_offset;attribute vec2 a_texture_coord;uniform mat4 u_matrix;uniform vec2 u_size;uniform float devicePixelRatio;uniform float u_zoom_units;uniform float u_zIndex;uniform float u_scale;uniform bool u_unit_px;uniform bool u_flat;varying vec2 v_texture_coord;/***\u70B9A(x,y)\uFF0C\u7ED5\u539F\u70B9\u987A\u65F6\u9488\u65CB\u8F6C\u89D2\u5EA6a\u65B0\u5750\u6807\u7684\u8BA1\u7B97\u516C\u5F0F*x1=x*cos(a)+y*sin(a)*y1=y*cos(a)-x*sin(a)*/vec3 transformCoord(vec3 coord,vec2 size,float corner){float x=coord.x;float y=coord.y;if(corner==1.0){x+=-size.x*cos(a_rotation)+size.y*sin(a_rotation);y+=size.y*cos(a_rotation)+size.x*sin(a_rotation);}else if(corner==2.0){x+=size.x*cos(a_rotation)+size.y*sin(a_rotation);y+=size.y*cos(a_rotation)-size.x*sin(a_rotation);}else if(corner==3.0){x+=size.x*cos(a_rotation)-size.y*sin(a_rotation);y+=-size.y*cos(a_rotation)-size.x*sin(a_rotation);}else{x+=-size.x*cos(a_rotation)-size.y*sin(a_rotation);y+=-size.y*cos(a_rotation)+size.x*sin(a_rotation);}return vec3(x,y,coord.z);}void main(){v_texture_coord=a_texture_coord;if(u_flat){vec2 offset=a_offset;vec2 halfSize=a_size/2.0*u_scale;if(u_unit_px){halfSize*=u_zoom_units;offset*=u_zoom_units;}vec3 current=transformCoord(a_pos,halfSize,a_corner);current.z+=u_zIndex;gl_Position=u_matrix*vec4(current.x+offset[0],current.y-offset[1],current.z,1.0);}else{vec4 position=u_matrix*vec4(a_pos,1.0);vec3 screen=position.xyz/position.w;vec2 halfSize=a_size/MAPV_resolution*devicePixelRatio*u_scale;vec2 offset=a_offset*2./MAPV_resolution*devicePixelRatio;if(!u_unit_px){halfSize/=u_zoom_units;offset/=u_zoom_units;}vec3 current=transformCoord(screen,halfSize,a_corner);current.xy=current.xy-offset;current.z+=u_zIndex;gl_Position=vec4(current,1.0);}}",fragmentShader:`precision highp float;varying vec2 v_texture_coord;uniform sampler2D u_icon;uniform vec4 uSelectedColor;void main(){vec4 textureColor=texture2D(u_icon,vec2(v_texture_coord.x,1.0-v_texture_coord.y));if(textureColor.a==0.0&&uIsPickRender==false){discard;}gl_FragColor=textureColor;
#if defined(PICK)
if(mapvIsPicked()){gl_FragColor=vec4(uSelectedColor.rgb,gl_FragColor.a);}
#endif
}`,defines:a.enablePicked?["PICK"]:[]},this),this.vertexBuffer=new qe({gl:o,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.uvBuffer=new qe({gl:o,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.indexBuffer=new qe({gl:o,target:"ELEMENT_ARRAY_BUFFER",usage:"STATIC_DRAW"}),a=[{name:"a_pos",buffer:this.vertexBuffer,size:3,stride:36,type:"FLOAT",offset:0},{name:"a_corner",buffer:this.vertexBuffer,size:1,stride:36,type:"FLOAT",offset:12},{name:"a_size",buffer:this.vertexBuffer,size:2,stride:36,type:"FLOAT",offset:16},{name:"a_offset",buffer:this.vertexBuffer,size:2,stride:36,type:"FLOAT",offset:24},{name:"a_rotation",buffer:this.vertexBuffer,size:1,stride:36,type:"FLOAT",offset:32},{name:"a_texture_coord",buffer:this.uvBuffer,size:2,stride:8,type:"FLOAT",offset:0}],a=a.concat(this.getCommonAttributes()),this.vertexArray=new bi({gl:o,program:this.program,attributes:a})}},{key:"onDestroy",value:function(){}},{key:"onChanged",value:function(o,a){var y=2<arguments.length&&arguments[2]!==void 0?arguments[2]:{};this.gl&&(this.cachedData=[],this.boxHash.clear(),this.processCache(o,a,y))}},{key:"processCache",value:function(o,a,y){for(var g=this,x=o.icon,v=o.width,M=o.height,D=o.offset,U=o.angle,C=0;C<a.length;C++){var L=this.normizedPoint(a[C].geometry.coordinates),B=this.getProperty("icon",x,a[C]),O=this.getProperty("width",v,a[C]),k=this.getProperty("height",M,a[C]),j=this.getProperty("offset",D,a[C]),V=this.getProperty("angle",U,a[C]);L&&B&&(this.cachedData.push({point:L,icon:B,width:O,height:k,offset:j,angle:V,dataIndex:C}),this.iconHash.get(B)||this.iconHash.set(B,B))}a=eo(this.iconHash.entries()).filter(function(Y){return typeof Y[1]=="string"}).map(function(Y){var Q=Ri(Y,2)[0];return new ga(function(nt,ut){g.url2canvas(Q,function(ct){g.iconHash.set(Q,ct),nt()})})}),ga.all(a).then(function(Y){g.buildSprite(o),y.autoRender!==!1&&g.webglLayer&&g.webglLayer.render()})}},{key:"buildSprite",value:function(o){o=o.padding;var a=this.canvas,y=this.ctx,g=[],x=!0,v=!1,M=void 0;try{for(var D=Bu(this.iconHash),U;!(x=(U=D.next()).done);x=!0){var C=Ri(U.value,2),L=C[1];if(typeof L!="string"){var B=L.width,O=L.height;g.push({w:B+o[0],h:O+o[0],width:B,height:O,key:C[0],icon:L})}}}catch(k){v=!0,M=k}finally{try{!x&&D.return&&D.return()}finally{if(v)throw M}}for(D=Iu(g),U=0;U<g.length;U++)C=g[U],this.boxHash.get(C.key)||this.boxHash.set(C.key,C);for(U=Me(D.w)||1,D=Me(D.h)||1,a.width=U,a.height=D,y.save(),a=0;a<g.length;a++)D=g[a],y.drawImage(D.icon,D.x+o[0],D.y+o[1],D.width,D.height);y.restore(),this.loadTexture()}},{key:"render",value:function(o){if(this.cachedData&&this.cachedData.length&&this.texture){var a=o.gl,y=o.matrix,g=this.getOptions(),x=this.program;x.use(a),this.throttleUpdate(o),this.setGLState({blend:!0,blendFunc:[a.SRC_ALPHA,a.ONE_MINUS_SRC_ALPHA]}),x.setUniforms(Vr(this.getCommonUniforms(o),{u_icon:this.texture,u_matrix:y,u_flat:g.flat,u_unit_px:g.unit==="px",u_zoom_units:this.map.getZoomUnits(),u_scale:g.scale,u_zIndex:g.zIndex,devicePixelRatio:window.devicePixelRatio})),0<this.index.length&&(this.indexBuffer.bind(),this.vertexArray.bind(),a.drawElements(a.TRIANGLES,this.index.length,a.UNSIGNED_INT,0))}}},{key:"throttleUpdate",value:function(o){this.updateIcon(o)}},{key:"updateIcon",value:function(o){if(this.iconHash.size&&this.boxHash.size){var a=this.getOptions(),y=o.gl;o=o.matrix,a=a.enablePicked;var g=[],x=[],v=[],M=[],D=this.canvas.width,U=this.canvas.height,C=y.canvas.width/window.devicePixelRatio;y=y.canvas.height/window.devicePixelRatio;for(var L=new Wu,B=0,O=0;O<this.cachedData.length;O++){var k=this.cachedData[O],j=k.point,V=k.width,Y=k.height,Q=k.offset,nt=k.angle,ut=k.dataIndex;if(k=this.boxHash.get(k.icon)){V=V||k.icon.width,Y=Y||k.icon.height;var ct=Ri(j,3);j=ct[0];var Tt=ct[1];ct=ct[2];var Lt=on.clone([j,Tt,ct,1]);on.transformMat4(Lt,Lt,o),on.scale(Lt,Lt,1/Lt[3]);var Dt=(Lt[0]+1)/2*C-V/2;Lt=(-Lt[1]+1)/2*y-Y/2;var ae=Dt+V,ne=Lt+Y;if(!(0>ae||0>ne||Dt>C||Lt>y||(Dt={minX:Dt,maxX:ae,minY:Lt,maxY:ne},L.collides(Dt)))){for(L.insert(Dt),Dt=0;4>Dt;Dt++)g.push(j,Tt,ct),g.push(Dt),g.push(V,Y),g.push.apply(g,Wr(Q)),g.push(nt*Math.PI/180);V=k.x/D,Y=(k.x+k.w)/D,Q=(k.y+k.h)/U,k=k.y/U,x.push(V,Q,V,k,Y,k,Y,Q),k=4*B,v.push(k,k+2,k+1,k,k+3,k+2),a&&(ut=this.indexToRgb(ut),M.push(ut[0]/255,ut[1]/255,ut[2]/255),M.push(ut[0]/255,ut[1]/255,ut[2]/255),M.push(ut[0]/255,ut[1]/255,ut[2]/255),M.push(ut[0]/255,ut[1]/255,ut[2]/255)),B+=1}}}this.index=v,this.vertexBuffer.updateData(new Float32Array(g)),this.uvBuffer.updateData(new Float32Array(x)),this.indexBuffer.updateData(new Uint32Array(v)),a&&this.pickBuffer.updateData(new Float32Array(M))}}},{key:"url2canvas",value:function(o,a){if((typeof o=="undefined"?"undefined":kn(o))==="object")a(o);else{var y=new Image;y.crossOrigin="anonymous",y.onload=function(){var g=y.width,x=y.height,v=document.createElement("canvas");v.width=g,v.height=x,v.getContext("2d").drawImage(y,0,0,g,x),a(v)},y.onerror=function(){var g=document.createElement("canvas");g.width=20,g.height=40;var x=g.getContext("2d");x.fillStyle="red",x.beginPath(),x.lineTo(0,0),x.lineTo(20,0),x.lineTo(10,40),x.closePath(),x.fill(),a(g)},y.src=o}}},{key:"loadTexture",value:function(){var o=this;this.canvas?xn(this.gl,this.canvas,function(a){o.texture=a}):this.texture=null}}]),h}(Ci),Si=function(l){function h(o,a){return Xe(this,h),o=_r(this,(h.__proto__||ur(h)).call(this,o,a)),o.name="LineFlowLayer",o.initData(),o.date=new Date,o.autoUpdate=!0,o}return yr(h,l),Ue(h,[{key:"getDefaultOptions",value:function(){return{color:"rgba(25, 25, 250, 1)",blend:"normal",width:2,antialias:!1,interval:.1,duration:2,trailLength:.5,minZoom:2,maxZoom:25,polygonOffset:[0,0]}}},{key:"initData",value:function(){this.dataMgr={position:[],prev:[],next:[],direction:[],color:[],index:[],counter:[]}}},{key:"initialize",value:function(o){this.gl=o;var a=this.getOptions();this.program=new jr(this.gl,{vertexShader:`uniform mat4 u_matrix;uniform float thickness;uniform vec4 uSelectedColor;attribute vec3 position;attribute vec3 next;attribute vec3 previous;attribute float direction;attribute vec4 aColor;attribute float aCounter;attribute vec2 uv;varying vec4 vColor;varying vec2 vNormal;varying float vCounter;vec2 project(vec4 coord){vec3 screen=coord.xyz/coord.w;vec2 clip=(screen.xy+1.0)/2.0;return clip*MAPV_resolution;}vec4 unproject(vec2 projected,float z,float w){vec2 clip=projected/MAPV_resolution;vec2 screen=clip*2.0-1.0;return vec4(screen*w,z,w);}void main(){vColor=aColor;vCounter=aCounter;
#if defined(PICK)
if(mapvIsPicked()){vColor=uSelectedColor;}
#endif
vec4 previousProjected=u_matrix*vec4(previous,1.0);vec4 currentProjected=u_matrix*vec4(position,1.0);vec4 nextProjected=u_matrix*vec4(next,1.0);vec2 currentScreen=project(currentProjected);vec2 previousScreen=project(previousProjected);vec2 nextScreen=project(nextProjected);float len=thickness;float orientation=direction;vec2 dir=vec2(0.0);if(currentScreen==previousScreen){dir=normalize(nextScreen-currentScreen);}else if(currentScreen==nextScreen){dir=normalize(currentScreen-previousScreen);}else{vec2 dirA=normalize((currentScreen-previousScreen));vec2 dirB=normalize((nextScreen-currentScreen));vec2 tangent=normalize(dirA+dirB);vec2 perp=vec2(-dirA.y,dirA.x);vec2 miter=vec2(-tangent.y,tangent.x);dir=tangent;float angle=40.0;if(dot(dirA,dirB)>cos(radians(angle))){len=thickness/dot(miter,perp);}}vec2 normal=vec2(-dir.y,dir.x);vNormal=normal*orientation;normal*=len/2.0;vec2 pos=currentScreen+normal*orientation;vec4 finalPos=unproject(pos,currentProjected.z,currentProjected.w);gl_Position=finalPos;}`,fragmentShader:"precision highp float;uniform bool uAntialias;uniform bool uAnimate;uniform float uTime;uniform float duration;uniform float interval;uniform float trailLength;varying vec4 vColor;varying vec2 vNormal;varying float vCounter;void main(){vec4 color=vColor;if(uAntialias){float blur=1.0;blur=1.0-smoothstep(0.98,1.0,length(vNormal));color.a*=blur;}if(uAnimate){float alpha=1.0-fract(mod(1.0-vCounter,interval)*(1.0/interval)+uTime/duration);alpha=(alpha+trailLength-1.0)/trailLength;color.a*=alpha;}gl_FragColor=color;}",defines:a.enablePicked?["PICK"]:[]},this),this.prevBuffer=new qe({gl:o,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.currentBuffer=new qe({gl:o,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.nextBuffer=new qe({gl:o,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.directionBuffer=new qe({gl:o,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.colorBuffer=new qe({gl:o,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.counterBuffer=new qe({gl:o,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.indexBuffer=new qe({gl:o,target:"ELEMENT_ARRAY_BUFFER",usage:"STATIC_DRAW"}),a=[{stride:12,name:"previous",buffer:this.prevBuffer,size:3,type:"FLOAT",offset:0},{stride:12,name:"position",buffer:this.currentBuffer,size:3,type:"FLOAT",offset:0},{stride:12,name:"next",buffer:this.nextBuffer,size:3,type:"FLOAT",offset:0},{stride:4,name:"direction",buffer:this.directionBuffer,size:1,type:"FLOAT",offset:0},{stride:16,name:"aColor",buffer:this.colorBuffer,size:4,type:"FLOAT",offset:0},{stride:4,name:"aCounter",buffer:this.counterBuffer,size:1,type:"FLOAT",offset:0}],a=a.concat(this.getCommonAttributes()),this.vertexArray=new bi({gl:o,program:this.program,attributes:a})}},{key:"onDestroy",value:function(){}},{key:"onChanged",value:function(o,a){var y=this;if(this.gl){this.initData();for(var g=1,x=[],v=0;v<a.length;v++){var M=[],D=a[v].geometry.coordinates;D&&0<D.length&&(M=a[v].geometry.type==="Polygon"?D[0].map(function(O){return y.normizedPoint(O)}):D.map(function(O){return y.normizedPoint(O)})),M=Fa(M),D=M.total,x[v]=M.arr,g=Math.max(D,g)}for(v=[],M=o.color,D=0;D<a.length;D++){var U=[],C=a[D].geometry.coordinates;C&&0<C.length&&(U=a[D].geometry.type==="Polygon"?C[0].map(function(O){return y.normizedPoint(O)}):C.map(function(O){return y.normizedPoint(O)})),C=M,Object.prototype.toString.call(C)==="[object Function]"?C=C(a[D]):(C=a[D].color||M,"properties"in a[D]&&"color"in a[D].properties&&(C=a[D].properties.color)),C=this.normizedColor(C);for(var L=this.addMultipleCoords(U),B=0;B<L.length;B++)this.processData(this.dataMgr,L[B],x[D],g,C);if(o.enablePicked)for(C=this.indexToRgb(D),L=0;L<U.length;L++)v.push(C[0]/255,C[1]/255,C[2]/255),v.push(C[0]/255,C[1]/255,C[2]/255),o.repeat&&(v.push(C[0]/255,C[1]/255,C[2]/255),v.push(C[0]/255,C[1]/255,C[2]/255),v.push(C[0]/255,C[1]/255,C[2]/255),v.push(C[0]/255,C[1]/255,C[2]/255))}this.counterBuffer.updateData(new Float32Array(this.dataMgr.counter)),this.currentBuffer.updateData(new Float32Array(this.dataMgr.position)),this.prevBuffer.updateData(new Float32Array(this.dataMgr.prev)),this.nextBuffer.updateData(new Float32Array(this.dataMgr.next)),this.directionBuffer.updateData(new Float32Array(this.dataMgr.direction)),this.colorBuffer.updateData(new Float32Array(this.dataMgr.color)),this.indexBuffer.updateData(new Uint32Array(this.dataMgr.index)),o.enablePicked&&this.pickBuffer.updateData(new Float32Array(v))}}},{key:"processData",value:function(o,a,y,g,x){var v,M,D,U,C,L,B,O=a.length,k=o.position.length/6;y=as(y.map(function(nt){return nt/g}));var j=as(a.map(function(nt){return-1}),!0),V=as(a),Y=as(a.map(qp(-1))),Q=as(a.map(qp(1)));a=as(a.map(function(nt){return x})),O=n1(O,k),(v=o.counter).push.apply(v,Wr(y)),(M=o.position).push.apply(M,Wr(ta(V))),(D=o.prev).push.apply(D,Wr(ta(Y))),(U=o.next).push.apply(U,Wr(ta(Q))),(C=o.direction).push.apply(C,Wr(j)),(L=o.color).push.apply(L,Wr(ta(a))),(B=o.index).push.apply(B,Wr(O))}},{key:"render",value:function(o){var a=o.gl,y=o.matrix,g=this.dataMgr;if(g&&!(0>=g.index.length)){var x=this.getOptions(),v=this.program;if(v.use(a),this.map){var M=this.map.getZoom();M=!!(M>=x.minZoom&&M<=x.maxZoom&&this.autoUpdate)}else M=!0;v.setUniforms(Vr(this.getCommonUniforms(o),{u_matrix:y,thickness:x.width,uAntialias:x.antialias,uTime:(new Date-this.date)/1e3,uAnimate:M,duration:x.duration,interval:x.interval,trailLength:x.trailLength})),this.setGLState({blend:!0,blendEquation:a.FUNC_ADD,blendFunc:x.blend==="lighter"?[a.SRC_ALPHA,a.ONE]:[a.SRC_ALPHA,a.ONE_MINUS_SRC_ALPHA],polygonOffset:x.polygonOffset}),this.indexBuffer.bind(),this.vertexArray.bind(),a.drawElements(a.TRIANGLES,g.index.length,a.UNSIGNED_INT,0)}}}]),h}(Ci),yv=function(l){function h(o,a){return Xe(this,h),_r(this,(h.__proto__||ur(h)).call(this,o,a))}return yr(h,l),Ue(h,[{key:"getDefaultOptions",value:function(){return{}}},{key:"initialize",value:function(o){this.gl=o;var a=this.getOptions();this.texture=null,this.program=new jr(this.gl,{vertexShader:`precision highp float;attribute vec3 a_pos;attribute vec2 a_texture_coord;uniform sampler2D uTerrain;uniform mat4 u_proj_matrix;uniform mat4 u_mv_matrix;varying vec2 v_texture_coord;void main(){v_texture_coord=a_texture_coord;vec3 pos=a_pos.xyz;
#if defined(TERRAIN)
vec4 terrainColor=texture2D(uTerrain,vec2(v_texture_coord.s,v_texture_coord.t));vec3 rgb=terrainColor.rgb*256.0;pos.z=-10000.0+((rgb.r*256.0*256.0+rgb.g*256.0+rgb.b)*0.1);pos.z=pos.z-60.0;
#endif
vec4 position=u_proj_matrix*u_mv_matrix*vec4(pos,1.0);gl_Position=position;}`,fragmentShader:"precision highp float;varying vec2 v_texture_coord;uniform sampler2D uTile;uniform bool uUseFilter;uniform vec4 uFilterColor;void main(){vec4 textureColor=texture2D(uTile,vec2(v_texture_coord.s,v_texture_coord.t));if(uUseFilter){textureColor=textureColor*uFilterColor;}gl_FragColor=textureColor;}",defines:a.terrain?["TERRAIN"]:""},this),this.vertexBuffer=new qe({gl:o,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.indexBuffer=new qe({gl:o,target:"ELEMENT_ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.vertexArray=new bi({gl:o,program:this.program,attributes:[{name:"a_pos",buffer:this.vertexBuffer,stride:20,size:3,type:"FLOAT",offset:0},{name:"a_texture_coord",buffer:this.vertexBuffer,size:2,stride:20,type:"FLOAT",offset:12}]})}},{key:"onChanged",value:function(o,a){var y=this;this.gl&&(this.loadTextureTime&&clearTimeout(this.loadTextureTime),this.loadTextureTime=setTimeout(function(){y.loadTexture(function(){y.parseData(a),y.dataTime=new Date,y.webglLayer.render()})},0))}},{key:"render",value:function(o){var a=o.gl,y=o.projectionMatrix;o=o.viewMatrix;var g=this.getOptions(),x=this.program,v=x.uniforms;x.use(a),this.texture&&(a.activeTexture(a.TEXTURE0),a.uniform1i(v.uTile,0),a.bindTexture(a.TEXTURE_2D,this.texture),a.activeTexture(a.TEXTURE1),a.uniform1i(v.uTerrain,1),a.bindTexture(a.TEXTURE_2D,this.terrainSampler),this.setGLState({cullFace:!1}),x.setUniforms({u_proj_matrix:y,uUseFilter:!!g.filterColor,uFilterColor:this.normizedColor(g.filterColor||"rgba(0, 0, 100, 1.0)"),u_mv_matrix:o}),0<this.index.length&&(this.indexBuffer.bind(),this.vertexArray.bind(),a.drawElements(a.TRIANGLES,this.index.length,a.UNSIGNED_INT,0)))}},{key:"loadTexture",value:function(o){var a=this,y=this.getOptions();y.tile?y.terrain?xn(this.gl,y.terrain,function(g,x){a.terrainSampler=g,xn(a.gl,y.tile,function(v,M){a.texture=v,o&&o(),a.webglLayer.render()})},{TEXTURE_WRAP_S:"MIRRORED_REPEAT",TEXTURE_WRAP_T:"MIRRORED_REPEAT"}):xn(this.gl,y.tile,function(g,x){a.texture=g,o&&o(),a.webglLayer.render()}):(this.texture=null,o&&o())}},{key:"parseData",value:function(o){var a=this,y=[],g=[];if(o&&o[0]){var x=o[0].geometry.coordinates[0];x=x.map(function(O){return a.normizedPoint(O)}),o=x[0][0];var v=x[0][1],M=x[0][2],D=(x[2][0]-o)/16;x=(x[2][1]-v)/16;for(var U=0;16>=U;U++)for(var C=0;16>=C;C++)if(y.push(o+D*C,v+x*U,M),y.push(C/16,U/16),16>C&&16>U){var L=17*U+C,B=17*(U+1)+C;g.push(L,B+1,L+1),g.push(L,B,B+1)}}this.index=g,this.vertexBuffer.updateData(new Float32Array(y)),this.indexBuffer.updateData(new Uint32Array(g))}}]),h}(Ci),WA=function(l){function h(o,a){return Xe(this,h),o=_r(this,(h.__proto__||ur(h)).call(this,o,a)),o.name="BoardLayer",o.index=[],a=o.canvas=document.createElement("canvas"),o.ctx=a.getContext("2d"),o.iconHash=new tu,o}return yr(h,l),Ue(h,[{key:"getDefaultOptions",value:function(){return{unit:"px",scale:1,angle:0,offsetZ:0,padding:[0,0],polygonOffset:[0,0],enableColorMix:!1,mixColor:"#fff",mixAmount:.5}}},{key:"initialize",value:function(o){this.gl=o;var a=this.getOptions();this.texture=null,this.vertexBuffer=new qe({gl:o,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.uvBuffer=new qe({gl:o,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.indexBuffer=new qe({gl:o,target:"ELEMENT_ARRAY_BUFFER",usage:"STATIC_DRAW"});var y=[{name:"a_pos",buffer:this.vertexBuffer,size:3,stride:32,type:"FLOAT",offset:0},{name:"a_corner",buffer:this.vertexBuffer,size:1,stride:32,type:"FLOAT",offset:12},{name:"a_size",buffer:this.vertexBuffer,size:2,stride:32,type:"FLOAT",offset:16},{name:"a_offsetZ",buffer:this.vertexBuffer,size:1,stride:32,type:"FLOAT",offset:24},{name:"a_rotation",buffer:this.vertexBuffer,size:1,stride:32,type:"FLOAT",offset:28},{name:"a_texture_coord",buffer:this.uvBuffer,size:2,stride:8,type:"FLOAT",offset:0}];y=y.concat(this.getCommonAttributes());var g=[];a.enablePicked&&g.push("PICK"),this.options.enableColorMix&&(this.colorBuffer=new qe({gl:o,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),y.push({stride:16,name:"a_color",buffer:this.colorBuffer,size:4,type:"FLOAT",offset:0}),g.push("USE_COLOR_MIX")),this.program=new jr(this.gl,{vertexShader:`precision highp float;attribute vec3 a_pos;attribute float a_corner;attribute float a_rotation;attribute float a_offsetZ;attribute vec2 a_size;attribute vec2 a_texture_coord;
#if defined(USE_COLOR_MIX)
attribute vec4 a_color;
#endif
uniform mat4 u_matrix;uniform vec2 u_size;uniform float u_zoom_units;uniform float u_scale;uniform bool u_unit_px;varying vec2 v_texture_coord;varying vec4 v_color;/***\u4E09\u7EF4\u7A7A\u95F4\u5185\uFF0C\u7ED5Z\u8F74\u65CB\u8F6C\u7684\u77E9\u9635\uFF0C\u53F3\u624B\u5750\u6807\u7CFB\u4E0B*[x'][cos0-sin0  0  0]*[y']=[sin0 cos0   0  0]*[z'][0     0     1  0]*[1][0     0     0  1]*/mat3 rotateZ(float angle){float cos0=cos(angle);float sin0=sin(angle);return mat3(cos0,sin0,0.,-sin0,cos0,0.,0.,0.,1.);}vec3 transformCoord(vec3 coord,vec2 size,float corner){float x=coord.x;float y=coord.y;float z=coord.z;mat3 mat=rotateZ(a_rotation);vec3 rotated=vec3(size[0],0.0,size[1]);if(corner==1.0){rotated=mat*vec3(-size[0],0.0,size[1]);}else if(corner==2.0){rotated=mat*vec3(size[0],0.0,size[1]);}else if(corner==3.0){rotated=mat*vec3(size[0],0.0,-size[1]);}else{rotated=mat*vec3(-size[0],0.0,-size[1]);}x+=rotated.x;y+=rotated.y;z+=rotated.z;return vec3(x,y,z);}void main(){
#if defined(USE_COLOR_MIX)
v_color=a_color;
#endif
v_texture_coord=a_texture_coord;vec2 halfSize=a_size/2.0*u_scale;if(u_unit_px){halfSize*=u_zoom_units;}vec3 current=transformCoord(a_pos,halfSize,a_corner);current.z+=a_offsetZ;gl_Position=u_matrix*vec4(current,1.0);}`,fragmentShader:`precision highp float;varying vec2 v_texture_coord;varying vec4 v_color;uniform sampler2D u_icon;uniform vec4 uSelectedColor;
#if defined(USE_COLOR_MIX)
uniform float u_mix_amount;
#endif
void main(){vec4 textureColor=texture2D(u_icon,vec2(v_texture_coord.x,1.0-v_texture_coord.y));if(textureColor.a==0.0&&uIsPickRender==false){discard;}gl_FragColor=textureColor;
#if defined(USE_COLOR_MIX)
gl_FragColor=mix(gl_FragColor,v_color,u_mix_amount);
#endif
#if defined(PICK)
if(mapvIsPicked()){gl_FragColor=vec4(uSelectedColor.rgb,gl_FragColor.a);}
#endif
}`,defines:g},this),this.vertexArray=new bi({gl:o,program:this.program,attributes:y})}},{key:"onDestroy",value:function(){}},{key:"onChanged",value:function(o,a){this.gl&&this.processCache(o,a)}},{key:"forceUpdate",value:function(){this.gl&&this.processCache(this.options,this.data)}},{key:"processCache",value:function(o,a){var y=this;this.cachedData=[];for(var g=o.icon,x=o.width,v=o.height,M=o.offsetZ,D=o.angle,U=o.mixColor,C=0;C<a.length;C++){var L=this.normizedPoint(a[C].geometry.coordinates),B=this.getProperty("icon",g,a[C]),O=this.getProperty("width",x,a[C]),k=this.getProperty("height",v,a[C]),j=this.getProperty("angle",D,a[C]),V=this.getProperty("offsetZ",M,a[C]),Y=this.normizedColor(this.getProperty("mixColor",U,a[C]));L&&B&&(this.cachedData.push({point:L,icon:B,width:O,height:k,offsetZ:V,angle:j,mixColor:Y,index:C}),this.iconHash.get(B)||this.iconHash.set(B,B))}a=eo(this.iconHash.entries()).filter(function(Q){return typeof Q[1]=="string"}).map(function(Q){var nt=Ri(Q,2)[0];return new ga(function(ut,ct){y.url2canvas(nt,function(Tt){y.iconHash.set(nt,Tt),ut()})})}),ga.all(a).then(function(Q){y.buildSprite(o),y.webglLayer.render()})}},{key:"buildSprite",value:function(o){var a=o.padding,y=this.canvas,g=this.ctx,x=[],v=new tu,M=!0,D=!1,U=void 0;try{for(var C=Bu(this.iconHash),L;!(M=(L=C.next()).done);M=!0){var B=Ri(L.value,2),O=B[1];if(typeof O!="string"){var k=O.width,j=O.height;x.push({w:k+a[0],h:j+a[0],width:k,height:j,key:B[0],icon:O})}}}catch(V){D=!0,U=V}finally{try{!M&&C.return&&C.return()}finally{if(D)throw U}}for(D=Iu(x),M=0;M<x.length;M++)U=x[M],v.get(U.key)||v.set(U.key,U);for(M=Me(D.w),D=Me(D.h),y.width=M||1,y.height=D||1,g.save(),y=0;y<x.length;y++)U=x[y],g.drawImage(U.icon,U.x+a[0],U.y+a[1],U.width,U.height);g.restore(),this.loadTexture(),this.buildVertex(o,v,M,D)}},{key:"buildVertex",value:function(o,a,y,g){var x=o.enablePicked;o=o.enableColorMix;for(var v=[],M=[],D=[],U=[],C=[],L=0;L<this.cachedData.length;L++){var B=this.cachedData[L],O=B.point,k=B.width,j=B.height,V=B.offsetZ,Y=B.angle,Q=B.mixColor,nt=B.index;if(B=a.get(B.icon)){k=k||B.icon.width,j=j||B.icon.height;var ut=Ri(O,3);O=ut[0];var ct=ut[1];ut=ut[2];for(var Tt=0;4>Tt;Tt++)v.push(O,ct,ut),v.push(Tt),v.push(k,j),v.push(V),v.push(Y*Math.PI/180);k=B.x/y,j=(B.x+B.w)/y,V=(B.y+B.h)/g,B=B.y/g,M.push(k,V,k,B,j,B,j,V),B=4*L,D.push(B,B+2,B+1,B,B+3,B+2),x&&(nt=this.indexToRgb(nt),U.push(nt[0]/255,nt[1]/255,nt[2]/255),U.push(nt[0]/255,nt[1]/255,nt[2]/255),U.push(nt[0]/255,nt[1]/255,nt[2]/255),U.push(nt[0]/255,nt[1]/255,nt[2]/255)),o&&(C.push.apply(C,Wr(Q)),C.push.apply(C,Wr(Q)),C.push.apply(C,Wr(Q)),C.push.apply(C,Wr(Q)))}}this.index=D,this.vertexBuffer.updateData(new Float32Array(v)),this.uvBuffer.updateData(new Float32Array(M)),this.indexBuffer.updateData(new Uint32Array(D)),x&&this.pickBuffer.updateData(new Float32Array(U)),o&&this.colorBuffer.updateData(new Float32Array(C))}},{key:"render",value:function(o){if(this.cachedData&&this.cachedData.length&&this.iconHash&&this.texture){var a=o.gl,y=o.matrix,g=this.getOptions(),x=this.program;x.use(a),this.setGLState({blend:!0,blendFunc:$s(a,g.blend),polygonOffset:g.polygonOffset}),o=Vr(this.getCommonUniforms(o),{u_icon:this.texture,u_matrix:y,u_unit_px:g.unit==="px",u_zoom_units:this.map.getZoomUnits(),u_scale:g.scale}),g.enableColorMix&&(o=Vr(o,{u_mix_amount:g.mixAmount})),x.setUniforms(o),0<this.index.length&&(this.indexBuffer.bind(),this.vertexArray.bind(),a.drawElements(a.TRIANGLES,this.index.length,a.UNSIGNED_INT,0))}}},{key:"url2canvas",value:function(o,a){if((typeof o=="undefined"?"undefined":kn(o))==="object")a(o);else{var y=new Image;y.crossOrigin="anonymous",y.onload=function(){var g=y.width,x=y.height,v=document.createElement("canvas");v.width=g,v.height=x,v.getContext("2d").drawImage(y,0,0,g,x),a(v)},y.onerror=function(){var g=document.createElement("canvas");g.width=20,g.height=40;var x=g.getContext("2d");x.fillStyle="red",x.beginPath(),x.lineTo(0,0),x.lineTo(20,0),x.lineTo(10,40),x.closePath(),x.fill(),a(g)},y.src=o}}},{key:"loadTexture",value:function(){var o=this;this.canvas?xn(this.gl,this.canvas,function(a){o.texture=a}):this.texture=null}}]),h}(Ci),jA=function(l){function h(o){Xe(this,h);var a=_r(this,(h.__proto__||ur(h)).call(this,o));return o=a.getOptions(),a.shapeLayer=new Uf({enablePicked:o.enablePicked}),a.lineLayer=new Dd,a.children=[a.shapeLayer,a.lineLayer],a}return yr(h,l),Ue(h,[{key:"pick",value:function(o,a){return this.shapeLayer.pick(o,a)}},{key:"onOptionsChanged",value:function(o){this.shapeLayer.setOptions({onClick:function(a){o.onClick&&o.onClick(a)},selectedIndex:o.selectedIndex,selectedColor:o.selectedColor,height:0,polygonOffset:[2,2],depthTest:o.depthTest,autoSelect:o.autoSelect,color:o.fillColor,opacity:o.fillOpacity,topColor:o.fillColor,useLight:!1}),this.lineLayer.setOptions({depthTest:o.depthTest,dashArray:o.dashArray,color:o.lineColor,width:o.lineWidth,lineJoin:o.lineJoin})}},{key:"onDataChanged",value:function(o){this.shapeLayer.setData(o),this.lineLayer.setData(o,{closePath:!0})}},{key:"getDefaultOptions",value:function(){return{enablePicked:!1,selectedIndex:-1,selectedColor:"#ff0000",autoSelect:!0,dashArray:[0,0],lineColor:"rgba(250, 250, 25, 1)",depthTest:!0,lineWidth:2,lineJoin:"miter",fillColor:"rgba(25, 25, 250, 1)",fillOpacity:1}}}]),h}(da),sn=sn||{},ip=0,xs=null,xv=sn.Scene=function(l,h){this.name=h.name!==void 0?h.name:null,this.nodes=Array(h.nodes.length);for(var o=0,a=h.nodes.length;o<a;o++)this.nodes[o]=l.nodes[h.nodes[o]];this.extensions=h.extensions!==void 0?h.extensions:null,this.extras=h.extras!==void 0?h.extras:null,this.boundingBox=null},As=sn.BoundingBox=function(l,h,o){l=l||dr.fromValues(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),h=h||dr.fromValues(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY),o===void 0||o===!0?(this.min=dr.clone(l),this.max=dr.clone(h)):(this.min=l,this.max=h),this.transform=Ke.create()};As.prototype.updateBoundingBox=function(l){dr.min(this.min,this.min,l.min),dr.max(this.max,this.max,l.max)},As.prototype.calculateTransform=function(){this.transform[0]=this.max[0]-this.min[0],this.transform[5]=this.max[1]-this.min[1],this.transform[10]=this.max[2]-this.min[2],this.transform[12]=this.min[0],this.transform[13]=this.min[1],this.transform[14]=this.min[2]},As.getAABBFromOBB=function(){var l=dr.create(),h=dr.create(),o=dr.create(),a=dr.create(),y=dr.create();return function(g,x){dr.set(l,x[0],x[1],x[2]),dr.set(h,x[4],x[5],x[6]),dr.set(o,x[8],x[9],x[10]),x=dr.fromValues(x[12],x[13],x[14]);var v=dr.clone(x);return dr.scale(a,l,g.min[0]),dr.scale(y,l,g.max[0]),dr.min(l,a,y),dr.add(x,x,l),dr.max(l,a,y),dr.add(v,v,l),dr.scale(a,h,g.min[1]),dr.scale(y,h,g.max[1]),dr.min(h,a,y),dr.add(x,x,h),dr.max(h,a,y),dr.add(v,v,h),dr.scale(a,o,g.min[2]),dr.scale(y,o,g.max[2]),dr.min(o,a,y),dr.add(x,x,o),dr.max(o,a,y),dr.add(v,v,o),g=new As(x,v,!1),g.calculateTransform(),g}}();var yy=sn.Accessor=function(l,h){this.bufferView=h,this.componentType=l.componentType,this.byteOffset=l.byteOffset!==void 0?l.byteOffset:0,this.byteStride=h.byteStride,this.normalized=l.normalized!==void 0?l.normalized:!1,this.count=l.count,this.type=l.type,this.size=wv[this.type],this.min=l.min,this.max=l.max,this.extensions=l.extensions!==void 0?l.extensions:null,this.extras=l.extras!==void 0?l.extras:null};yy.prototype.prepareVertexAttrib=function(l,h){h.vertexAttribPointer(l,this.size,this.componentType,this.normalized,this.byteStride,this.byteOffset),h.enableVertexAttribArray(l)};var Av=sn.BufferView=function(l,h){this.byteLength=l.byteLength,this.byteOffset=l.byteOffset!==void 0?l.byteOffset:0,this.byteStride=l.byteStride!==void 0?l.byteStride:0,this.target=l.target!==void 0?l.target:null,this.data=h.slice(this.byteOffset,this.byteOffset+this.byteLength),this.extensions=l.extensions!==void 0?l.extensions:null,this.extras=l.extras!==void 0?l.extras:null,this.buffer=null};Av.prototype.createBuffer=function(l){this.buffer=l.createBuffer()},Av.prototype.bindData=function(l){return this.target?(l.bindBuffer(this.target,this.buffer),l.bufferData(this.target,this.data,l.STATIC_DRAW),l.bindBuffer(this.target,null),!0):!1};var ki=sn.Camera=function(l){this.name=l.name!==void 0?l.name:null,this.type=l.type,this.othographic=l.othographic===void 0?null:l.othographic,this.perspective=l.perspective===void 0?null:{yfov:l.perspective.yfov,znear:l.perspective.znear,zfar:l.perspective.zfar!==void 0?l.perspective.zfar:null,aspectRatio:l.perspective.aspectRatio!==void 0?l.perspective.aspectRatio:null},this.extensions=l.extensions!==void 0?l.extensions:null,this.extras=l.extras!==void 0?l.extras:null},lc=sn.Node=function(l,h){if(this.name=l.name!==void 0?l.name:null,this.nodeID=h,this.camera=l.camera!==void 0?l.camera:null,this.matrix=Ke.create(),l.hasOwnProperty("matrix")){for(h=0;16>h;++h)this.matrix[h]=l.matrix[h];this.translation=dr.create(),Ke.getTranslation(this.translation,this.matrix),this.rotation=Nf.create(),Ke.getRotation(this.rotation,this.matrix),this.scale=dr.create(),Ke.getScaling(this.scale,this.matrix)}else this.getTransformMatrixFromTRS(l.translation,l.rotation,l.scale);this.children=l.children||[],this.mesh=l.mesh!==void 0?xs.glTF.meshes[l.mesh]:null,this.skin=l.skin!==void 0?l.skin:null,l.extensions!==void 0&&l.extensions.gl_avatar!==void 0&&xs.enableGLAvatar===!0&&(this.skin=new qA(xs.glTF,xs.skeletonGltf.skins[xs.skeletonGltf.json.extensions.gl_avatar.skins[l.extensions.gl_avatar.skin.name]],l.extensions.gl_avatar.skin.inverseBindMatrices)),this.weights=l.weights!==void 0?l.weights:null,this.extensions=l.extensions!==void 0?l.extensions:null,this.extras=l.extras!==void 0?l.extras:null,this.aabb=null,this.bvh=new As};lc.prototype.traverse=function(l,h){h(this,l),l=0;for(var o=this.children.length;l<o;l++)this.children[l].traverse(this,h)},lc.prototype.traversePostOrder=function(l,h){for(var o=0,a=this.children.length;o<a;o++)this.children[o].traversePostOrder(this,h);h(this,l)},lc.prototype.traverseTwoExecFun=function(l,h,o){h(this,l);for(var a=0,y=this.children.length;a<y;a++)this.children[a].traverseTwoExecFun(this,h,o);o(this,l)};var xy=Ke.create();lc.prototype.getTransformMatrixFromTRS=function(l,h,o){this.translation=l!==void 0?dr.fromValues(l[0],l[1],l[2]):dr.fromValues(0,0,0),this.rotation=h!==void 0?on.fromValues(h[0],h[1],h[2],h[3]):on.fromValues(0,0,0,1),this.scale=o!==void 0?dr.fromValues(o[0],o[1],o[2]):dr.fromValues(1,1,1),this.updateMatrixFromTRS()},lc.prototype.updateMatrixFromTRS=function(){Ke.fromRotationTranslation(xy,this.rotation,this.translation),Ke.scale(this.matrix,xy,this.scale)};var Wn=sn.Mesh=function(l,h){this.meshID=h,this.name=l.name!==void 0?l.name:null,this.primitives=[],this.boundingBox=null,h=0;for(var o=l.primitives.length;h<o;++h){var a=l.primitives[h];a=new XA(xs.glTF,a),this.primitives.push(a),a.boundingBox&&(this.boundingBox||(this.boundingBox=new As),this.boundingBox.updateBoundingBox(a.boundingBox))}this.boundingBox&&this.boundingBox.calculateTransform(),this.weights=l.weights!==void 0?l.weights:null,this.extensions=l.extensions!==void 0?l.extensions:null,this.extras=l.extras!==void 0?l.extras:null},XA=sn.Primitive=function(l,h){this.attributes=h.attributes,this.indices=h.indices!==void 0?h.indices:null;var o;if(h.extensions!==void 0&&h.extensions.gl_avatar!==void 0&&xs.enableGLAvatar===!0&&h.extensions.gl_avatar.attributes)for(o in h.extensions.gl_avatar.attributes)this.attributes[o]=h.extensions.gl_avatar.attributes[o];this.indices!==null?(this.indicesComponentType=l.json.accessors[this.indices].componentType,this.indicesLength=l.json.accessors[this.indices].count,this.indicesOffset=l.json.accessors[this.indices].byteOffset||0):(this.drawArraysCount=l.json.accessors[this.attributes.POSITION].count,this.drawArraysOffset=l.json.accessors[this.attributes.POSITION].byteOffset||0);for(o in this.attributes)this.attributes[o]=l.accessors[this.attributes[o]];this.material=h.material!==void 0?l.materials[h.material]:null,this.mode=h.mode!==void 0?h.mode:4,this.targets=h.targets,this.extensions=h.extensions!==void 0?h.extensions:null,this.extras=h.extras!==void 0?h.extras:null,this.boundingBox=this.shader=this.indexBuffer=this.vertexBuffer=this.vertexArray=null,this.attributes.POSITION!==void 0&&(l=this.attributes.POSITION,l.max&&l.type==="VEC3"&&(this.boundingBox=new As(dr.fromValues(l.min[0],l.min[1],l.min[2]),dr.fromValues(l.max[0],l.max[1],l.max[2]),!1),this.boundingBox.calculateTransform()))},Ai=sn.Texture=function(l){this.name=l.name!==void 0?l.name:null,this.sampler=l.sampler!==void 0?xs.glTF.samplers[l.sampler]:null,this.source=l.source!==void 0?xs.glTF.images[l.source]:null,this.extensions=l.extensions!==void 0?l.extensions:null,this.extras=l.extras!==void 0?l.extras:null,this.texture=null};Ai.prototype.createTexture=function(l){this.texture=l.createTexture(),l.bindTexture(l.TEXTURE_2D,this.texture),l.texImage2D(l.TEXTURE_2D,0,l.RGBA,l.RGBA,l.UNSIGNED_BYTE,this.source),l.generateMipmap(l.TEXTURE_2D),l.bindTexture(l.TEXTURE_2D,null)};var Ay=sn.Sampler=function(l){this.name=l.name!==void 0?l.name:null,this.magFilter=l.magFilter!==void 0?l.magFilter:null,this.minFilter=l.minFilter!==void 0?l.minFilter:null,this.wrapS=l.wrapS!==void 0?l.wrapS:10497,this.wrapT=l.wrapT!==void 0?l.wrapT:10497,this.extensions=l.extensions!==void 0?l.extensions:null,this.extras=l.extras!==void 0?l.extras:null,this.sampler=null};Ay.prototype.createSampler=function(l){this.sampler=l.createSampler(),this.minFilter?l.samplerParameteri(this.sampler,l.TEXTURE_MIN_FILTER,this.minFilter):l.samplerParameteri(this.sampler,l.TEXTURE_MIN_FILTER,l.NEAREST_MIPMAP_LINEAR),this.magFilter?l.samplerParameteri(this.sampler,l.TEXTURE_MAG_FILTER,this.magFilter):l.samplerParameteri(this.sampler,l.TEXTURE_MAG_FILTER,l.LINEAR),l.samplerParameteri(this.sampler,l.TEXTURE_WRAP_S,this.wrapS),l.samplerParameteri(this.sampler,l.TEXTURE_WRAP_T,this.wrapT)};var Tn=sn.TextureInfo=function(l){this.index=l.index,this.texCoord=l.texCoord!==void 0?l.texCoord:0,this.extensions=l.extensions!==void 0?l.extensions:null,this.extras=l.extras!==void 0?l.extras:null},_y=sn.PbrMetallicRoughness=function(l){this.baseColorFactor=l.baseColorFactor!==void 0?l.baseColorFactor:[1,1,1,1],this.baseColorTexture=l.baseColorTexture!==void 0?new Tn(l.baseColorTexture):null,this.metallicFactor=l.metallicFactor!==void 0?l.metallicFactor:1,this.roughnessFactor=l.roughnessFactor!==void 0?l.roughnessFactor:1,this.metallicRoughnessTexture=l.metallicRoughnessTexture!==void 0?new Tn(l.metallicRoughnessTexture):null,this.extensions=l.extensions!==void 0?l.extensions:null,this.extras=l.extras!==void 0?l.extras:null},YA=sn.NormalTextureInfo=function(l){this.index=l.index,this.texCoord=l.texCoord!==void 0?l.texCoord:0,this.scale=l.scale!==void 0?l.scale:1,this.extensions=l.extensions!==void 0?l.extensions:null,this.extras=l.extras!==void 0?l.extras:null},wy=sn.OcclusionTextureInfo=function(l){this.index=l.index,this.texCoord=l.texCoord!==void 0?l.texCoord:0,this.strength=l.strength!==void 0?l.strength:1,this.extensions=l.extensions!==void 0?l.extensions:null,this.extras=l.extras!==void 0?l.extras:null},ZA=sn.Material=function(l){this.name=l.name!==void 0?l.name:null,this.pbrMetallicRoughness=l.pbrMetallicRoughness!==void 0?new _y(l.pbrMetallicRoughness):new _y({baseColorFactor:[1,1,1,1],metallicFactor:1,metallicRoughnessTexture:1}),this.normalTexture=l.normalTexture!==void 0?new YA(l.normalTexture):null,this.occlusionTexture=l.occlusionTexture!==void 0?new wy(l.occlusionTexture):null,this.emissiveTexture=l.emissiveTexture!==void 0?new Tn(l.emissiveTexture):null,this.emissiveFactor=l.emissiveFactor!==void 0?l.emissiveFactor:[0,0,0],this.alphaMode=l.alphaMode!==void 0?l.alphaMode:"OPAQUE",this.alphaCutoff=l.alphaCutoff!==void 0?l.alphaCutoff:.5,this.doubleSided=l.doubleSided||!1,this.extensions=l.extensions!==void 0?l.extensions:null,this.extras=l.extras!==void 0?l.extras:null},jn=sn.Skin=function(l,h,o){this.name=h.name!==void 0?h.name:null,this.skinID=o,this.joints=Array(h.joints.length);var a;for(o=0,a=this.joints.length;o<a;o++)this.joints[o]=l.nodes[h.joints[o]];if(this.skeleton=h.skeleton!==void 0?l.nodes[h.skeleton]:null,this.inverseBindMatrices=h.inverseBindMatrices!==void 0?l.accessors[h.inverseBindMatrices]:null,this.extensions=h.extensions!==void 0?h.extensions:null,this.extras=h.extras!==void 0?h.extras:null,this.uniformBlockID=ip++,this.inverseBindMatrices)for(this.inverseBindMatricesData=Jp(this.inverseBindMatrices),this.inverseBindMatrix=[],this.jointMatrixUniformBuffer=null,this.jointMatrixUnidormBufferData=new Float32Array(1040),o=0,a=this.inverseBindMatricesData.length;o<a;o+=16)this.inverseBindMatrix.push(Ke.fromValues(this.inverseBindMatricesData[o],this.inverseBindMatricesData[o+1],this.inverseBindMatricesData[o+2],this.inverseBindMatricesData[o+3],this.inverseBindMatricesData[o+4],this.inverseBindMatricesData[o+5],this.inverseBindMatricesData[o+6],this.inverseBindMatricesData[o+7],this.inverseBindMatricesData[o+8],this.inverseBindMatricesData[o+9],this.inverseBindMatricesData[o+10],this.inverseBindMatricesData[o+11],this.inverseBindMatricesData[o+12],this.inverseBindMatricesData[o+13],this.inverseBindMatricesData[o+14],this.inverseBindMatricesData[o+15]))},qA=sn.SkinLink=function(l,h,o){if(this.isLink=!0,l.skins||(l.skins=[]),l.skins.push(this),this.name=h.name,this.skinID=l.skins.length-1,this.joints=h.joints,this.skeleton=h.skeleton,this.inverseBindMatrices=o!==void 0?l.accessors[o]:null,this.uniformBlockID=ip++,this.inverseBindMatrices)for(this.inverseBindMatricesData=Jp(this.inverseBindMatrices),this.inverseBindMatrix=[],this.jointMatrixUniformBuffer=null,this.jointMatrixUnidormBufferData=new Float32Array(1040),l=0,h=this.inverseBindMatricesData.length;l<h;l+=16)this.inverseBindMatrix.push(Ke.fromValues(this.inverseBindMatricesData[l],this.inverseBindMatricesData[l+1],this.inverseBindMatricesData[l+2],this.inverseBindMatricesData[l+3],this.inverseBindMatricesData[l+4],this.inverseBindMatricesData[l+5],this.inverseBindMatricesData[l+6],this.inverseBindMatricesData[l+7],this.inverseBindMatricesData[l+8],this.inverseBindMatricesData[l+9],this.inverseBindMatricesData[l+10],this.inverseBindMatricesData[l+11],this.inverseBindMatricesData[l+12],this.inverseBindMatricesData[l+13],this.inverseBindMatricesData[l+14],this.inverseBindMatricesData[l+15]))},JA=sn.Target=function(l){this.nodeID=l.node!==void 0?l.node:null,this.path=l.path,this.extensions=l.extensions!==void 0?l.extensions:null,this.extras=l.extras!==void 0?l.extras:null},Ti=sn.Channel=function(l,h){this.sampler=h.samplers[l.sampler],this.target=new JA(l.target),this.extensions=l.extensions!==void 0?l.extensions:null,this.extras=l.extras!==void 0?l.extras:null},_v=sn.AnimationSampler=function(l,h){this.input=l.accessors[h.input],this.output=l.accessors[h.output],this.inputTypedArray=Jp(this.input),this.outputTypedArray=Jp(this.output),this.interpolation=h.interpolation!==void 0?h.interpolation:"LINEAR",this.extensions=h.extensions!==void 0?h.extensions:null,this.extras=h.extras!==void 0?h.extras:null,this.curIdx=0,this.curValue=on.create(),this.endT=this.inputTypedArray[this.inputTypedArray.length-1],this.inputMax=this.endT-this.inputTypedArray[0]},My=on.create(),Cy=on.create();_v.prototype.getValue=function(l){l>this.endT&&(l-=this.inputMax*Math.ceil((l-this.endT)/this.inputMax),this.curIdx=0);for(var h=this.inputTypedArray.length;this.curIdx<=h-2&&l>=this.inputTypedArray[this.curIdx+1];)this.curIdx++;this.curIdx>=h-1&&(l-=this.inputMax,this.curIdx=0),h=wv[this.output.type];var o=h===4?Nf.slerp:on.lerp,a=this.curIdx,y=a*h,g=y+h;for(l=Math.max(0,l-this.inputTypedArray[a])/(this.inputTypedArray[a+1]-this.inputTypedArray[a]),a=0;a<h;a++)My[a]=this.outputTypedArray[y+a],Cy[a]=this.outputTypedArray[g+a];switch(this.interpolation){case"LINEAR":o(this.curValue,My,Cy,l)}};var Hs=sn.Animation=function(l,h){this.name=h.name!==void 0?h.name:null;var o;this.samplers=[];var a=0;for(o=h.samplers.length;a<o;a++)this.samplers[a]=new _v(l,h.samplers[a]);for(this.channels=[],a=0,o=h.channels.length;a<o;a++)this.channels[a]=new Ti(h.channels[a],this);this.extensions=h.extensions!==void 0?h.extensions:null,this.extras=h.extras!==void 0?h.extras:null},QA=sn.glTFModel=function(l){this.json=l,this.defaultScene=l.scene!==void 0?l.scene:0,this.version=Number(l.asset.version),l.accessors&&(this.accessors=Array(l.accessors.length)),l.bufferViews&&(this.bufferViews=Array(l.bufferViews.length)),l.scenes&&(this.scenes=Array(l.scenes.length)),l.nodes&&(this.nodes=Array(l.nodes.length)),l.meshes&&(this.meshes=Array(l.meshes.length)),l.materials&&(this.materials=Array(l.materials.length)),l.textures&&(this.textures=Array(l.textures.length)),l.samplers&&(this.samplers=Array(l.samplers.length)),l.images&&(this.images=Array(l.images.length)),l.skins&&(this.skins=Array(l.skins.length)),l.animations&&(this.animations=Array(l.animations.length)),l.cameras&&(this.cameras=Array(l.cameras.length)),this.extensions=l.extensions!==void 0?l.extensions:null,this.extras=l.extras!==void 0?l.extras:null},hc=sn.glTFLoader=function(l){this._init(),this.glTF=null,this.enableGLAvatar=!1,this.linkSkeletonGltf=null};hc.prototype._init=function(){this._loadDone=!1,this._bufferLoaded=this._bufferRequested=0,this._buffers=[],this._bufferTasks={},this._finishedPendingTasks=this._pendingTasks=this._imageLoaded=this._imageRequested=this._shaderLoaded=this._shaderRequested=0,this.onload=null,xs=this},hc.prototype._checkComplete=function(){this._bufferRequested==this._bufferLoaded&&this._imageRequested==this._imageLoaded&&(this._loadDone=!0),this._loadDone&&this._pendingTasks==this._finishedPendingTasks&&(this._postprocess(),this.onload(this.glTF))},hc.prototype.loadGLTF_GL_Avatar_Skin=function(l,h,o){this.enableGLAvatar=!0,this.skeletonGltf=h,this.loadGLTF(l,o)},hc.prototype.loadGLTF=function(l,h){this._init(),this.onload=h||function(a){},this.baseUri=rA(l);var o=this;iA(l,function(a){a=JSON.parse(a),o.glTF=new QA(a);var y,g=function(M){if(o._buffers[y]=M,o._bufferLoaded++,o._bufferTasks[y]){var D,U=0;for(D=o._bufferTasks[y].length;U<D;++U)o._bufferTasks[y][U](M)}o._checkComplete()};if(a.buffers)for(y in a.buffers){o._bufferRequested++;var x=a.buffers[y].uri;x.indexOf("base64")===-1&&(x=o.baseUri+x),nA(x,g)}g=function(M,D){o._imageLoaded++,o.glTF.images[D]=M,o._checkComplete()};var v;if(a.images)for(v in a.images)o._imageRequested++,oA(o.baseUri+a.images[v].uri,v,g);o._checkComplete()})},hc.prototype._postprocess=function(){function l(U,C){var L=M[U.nodeID];C!==null?Ke.mul(L,M[C.nodeID],U.matrix):Ke.copy(L,U.matrix)}function h(U,C){var L=M[U.nodeID];C=C!==null?C.bvh:D.boundingBox,U.mesh&&(y=U.mesh,y.boundingBox&&(U.aabb=As.getAABBFromOBB(y.boundingBox,L),U.children.length===0&&(dr.copy(U.bvh.min,U.aabb.min),dr.copy(U.bvh.max,U.aabb.max)))),dr.min(C.min,C.min,U.bvh.min),dr.max(C.max,C.max,U.bvh.max)}xs=this;var o,a,y;if(this.glTF.cameras){var g=0;for(o=this.glTF.cameras.length;g<o;g++)this.glTF.cameras[g]=new ki(this.glTF.json.cameras[g])}if(this.glTF.bufferViews)for(g=0,o=this.glTF.bufferViews.length;g<o;g++)this.glTF.bufferViews[g]=new Av(this.glTF.json.bufferViews[g],this._buffers[this.glTF.json.bufferViews[g].buffer]);if(this.glTF.accessors)for(g=0,o=this.glTF.accessors.length;g<o;g++)this.glTF.accessors[g]=new yy(this.glTF.json.accessors[g],this.glTF.bufferViews[this.glTF.json.accessors[g].bufferView]);if(this.glTF.materials)for(g=0,o=this.glTF.materials.length;g<o;g++)this.glTF.materials[g]=new ZA(this.glTF.json.materials[g]);if(this.glTF.samplers)for(g=0,o=this.glTF.samplers.length;g<o;g++)this.glTF.samplers[g]=new Ay(this.glTF.json.samplers[g]);if(this.glTF.textures)for(g=0,o=this.glTF.textures.length;g<o;g++)this.glTF.textures[g]=new Ai(this.glTF.json.textures[g]);for(g=0,o=this.glTF.meshes.length;g<o;g++)this.glTF.meshes[g]=new Wn(this.glTF.json.meshes[g],g);for(g=0,o=this.glTF.nodes.length;g<o;g++)this.glTF.nodes[g]=new lc(this.glTF.json.nodes[g],g);for(g=0,o=this.glTF.nodes.length;g<o;g++){var x=this.glTF.nodes[g],v=0;for(a=x.children.length;v<a;v++)x.children[v]=this.glTF.nodes[x.children[v]]}var M=Array(this.glTF.nodes.length);for(g=0,o=M.length;g<o;g++)M[g]=Ke.create();for(g=0,o=this.glTF.scenes.length;g<o;g++){var D=this.glTF.scenes[g]=new xv(this.glTF,this.glTF.json.scenes[g]);for(D.boundingBox=new As,v=0,a=D.nodes.length;v<a;v++)x=D.nodes[v],x.traverseTwoExecFun(null,l,h);D.boundingBox.calculateTransform()}for(v=0,a=this.glTF.nodes.length;v<a;v++)x=this.glTF.nodes[v],x.bvh!==null&&x.bvh.calculateTransform();if(this.glTF.animations)for(g=0,o=this.glTF.animations.length;g<o;g++)this.glTF.animations[g]=new Hs(this.glTF,this.glTF.json.animations[g]);if(this.glTF.json.skins)for(g=0,o=this.glTF.skins.length;g<o;g++)for(this.glTF.skins[g]=new jn(this.glTF,this.glTF.json.skins[g],g),x=this.glTF.skins[g].joints,v=0,a=x.length;v<a;v++)x[v].jointID=v;for(g=0,o=this.glTF.nodes.length;g<o;g++)x=this.glTF.nodes[g],x.skin!==null&&typeof x.skin=="number"&&(x.skin=this.glTF.skins[x.skin])};var wv={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Or=function(l){function h(o,a){return Xe(this,h),_r(this,(h.__proto__||ur(h)).call(this,o,a))}return yr(h,l),Ue(h,[{key:"getDefaultOptions",value:function(){return{scale:1}}},{key:"initialize",value:function(o){var a=this;this.gl=o;var y=this.getOptions();this.gltfObj=sA({gl:o,options:y}),new hc().loadGLTF(y.url,function(g){a.gltfObj.setupScene(g),a.webglLayer.render()})}},{key:"onChanged",value:function(o,a){}},{key:"render",value:function(o){var a=o.gl;o=o.matrix;var y=this.getData(),g=this.getOptions(),x=g.scale,v=[x,x,x];for(g.unit==="px"&&this.map&&(v=this.map.getZoomUnits(),v=[x*v,x*v,x*v]),x=0;x<y.length;x++){var M=y[x].geometry.coordinates;g=Ke.create();var D=Ke.create();M=this.normizedPoint(M),Ke.identity(g),Ke.translate(g,g,[M[0],M[1],M[2]]),Ke.rotateX(g,g,Math.PI/2),Ke.rotateY(g,g,(y[x].angle||0)*Math.PI/180),Ke.scale(g,g,v),Ke.mul(D,o,g),this.gltfObj.render({gl:a,matrix:D})}}}]),h}(Ci),cc=cc||{};(function(){function l(o,a,y){return y=o.createShader(y),o.shaderSource(y,a),o.compileShader(y),y}cc.getShaderSource=function(o){return document.getElementById(o).textContent.replace(/^\s+|\s+$/g,"")},cc.createProgram=function(o,a,y){var g=o.createProgram();return a=l(o,a,o.VERTEX_SHADER),y=l(o,y,o.FRAGMENT_SHADER),o.attachShader(g,a),o.deleteShader(a),o.attachShader(g,y),o.deleteShader(y),o.linkProgram(g),o.getProgramInfoLog(g),o.getShaderInfoLog(a),o.getShaderInfoLog(y),g};var h=cc.loadImage=function(o,a){var y=new Image;return y.crossOrigin="Anonymous",y.src=o,y.onload=a,y};cc.loadImages=function(o,a){function y(){0>=--x&&a(g)}for(var g=[],x=o.length,v=0;v<x;++v)g.push(h(o[v],y))}})();var KA=function(l){function h(o){Xe(this,h);var a=_r(this,(h.__proto__||ur(h)).call(this,o));return o=a.getOptions(),a.gltfLayer=new Or({url:o.url,scale:o.scale}),a.children=[a.gltfLayer],a.autoUpdate=!0,a.index=[],a.newData=[],a.isStarted=o.autoPlay!==!1,a}return yr(h,l),Ue(h,[{key:"getDefaultOptions",value:function(){return{url:"https://mapv-website.bj.bcebos.com/gl/examples/model/car.gltf",scale:1,step:1,defaultAngle:90}}},{key:"onOptionsChanged",value:function(o){this.gltfLayer.setOptions({})}},{key:"onDataChanged",value:function(o){var a=this;this.index=[],this.newData=[];for(var y=0;y<o.length;y++){this.index.push(0);var g=o[y].geometry.coordinates;o[y].geometry.type==="LineString"?this.newData.push(this._addPath(g)):g.forEach(function(x){a.newData.push(a._addPath(x))})}this.updatePoints()}},{key:"lnglatToMercator",value:function(o,a){return a=a*Math.PI/180,a=31890685e-1*Math.log((1+Math.sin(a))/(1-Math.sin(a))),[parseFloat((o*Math.PI/180*6378137).toFixed(2)),parseFloat(a.toFixed(2))]}},{key:"getDeg",value:function(o,a){-180<o[0]&&180>o[0]&&(o=this.lnglatToMercator(o[0],o[1]),a=this.lnglatToMercator(a[0],a[1]));var y=180*Math.atan((a[1]-o[1])/(a[0]-o[0]))/Math.PI;return a[0]>o[0]&&(y-=180),y}},{key:"getPoint",value:function(o,a,y){return[o[0]+(a[0]-o[0])*y,o[1]+(a[1]-o[1])*y,o[2]&&a[2]?o[2]+(a[2]-o[2])*y:0]}},{key:"updatePoints",value:function(){for(var o=this.getOptions(),a=this.newData,y=[],g=0;g<a.length;g++){for(var x=a[g],v=Math.floor(this.index[g]),M=v+1;x[M]&&x[M][0]===x[v][0]&&x[M][1]===x[v][1];)M++;M>=x.length-1&&(M=--v),M=this.getDeg(x[v],x[M]),y.push({geometry:{type:"Point",coordinates:this.getPoint(x[v],x[v+1],this.index[g]%1)},angle:M-o.defaultAngle})}this.pointData=y,this.gltfLayer.setData(y,{autoRender:!1})}},{key:"getCurrentPoint",value:function(){return this.pointData}},{key:"getDistance",value:function(o,a){var y=o[1]*Math.PI/180,g=a[1]*Math.PI/180;return o=2*Math.asin(Math.sqrt(Math.pow(Math.sin((y-g)/2),2)+Math.cos(y)*Math.cos(g)*Math.pow(Math.sin((o[0]*Math.PI/180-a[0]*Math.PI/180)/2),2))),o=Math.round(6378137e4*o)/1e4}},{key:"_addPath",value:function(o){for(var a=o.length,y=0,g=[],x=[],v=1;v<a;v++){var M=this.getDistance(o[v-1],o[v]);g.push(M),y+=M}for(M=[0],v=1;v<a;v++){var D=(g[v-1]/y).toFixed(2);M[v]=M[v-1]+parseFloat(D,10),x=x.concat(this._getPath(o[v-1],o[v],1e3*D))}return this._pathPercents=M,x}},{key:"_getPath",value:function(o,a,y){if(y===0)return[o];for(var g=[],x=0;x<=y;x++)g.push([(a[0]-o[0])/y*x+o[0],(a[1]-o[1])/y*x+o[1],a[2]&&o[2]?(a[2]-o[2])/y*x+o[2]:0]);return g}},{key:"start",value:function(){this.isStarted=!0}},{key:"stop",value:function(){this.isStarted=!1}},{key:"render",value:function(o){if(fa(h.prototype.__proto__||ur(h.prototype),"render",this).call(this,o),o=this.getOptions(),this.isStarted)for(var a=this.newData,y=0;y<this.index.length;y++)this.index[y]+=o.step,this.index[y]>a[y].length-2&&(this.index[y]=0);this.updatePoints()}}]),h}(da),Qu=function(l){function h(o,a){return Xe(this,h),o=_r(this,(h.__proto__||ur(h)).call(this,o,a)),o.name="BoardTextLayer",a=o.canvas=document.createElement("canvas"),a=o.ctx=a.getContext("2d"),a.textAlign="start",a.textBaseline="top",o}return yr(h,l),Ue(h,[{key:"getDefaultOptions",value:function(){return{depthWrite:!1,depthTest:!0,color:"#fff",fontFamily:"Microsoft Yahei",fontSize:14,collides:!0,unit:"px",angle:0,translateX:0,offset:[0,0],padding:[2,2],margin:[0,0],polygonOffset:[0,0],shadow:{},maxHeightLine:20,lineBreak:`
`}}},{key:"initialize",value:function(o){this.gl=o;var a=this.getOptions();this.texture=null,this.lastUpdateTime=0,this.program=new jr(this.gl,{vertexShader:"precision highp float;uniform mat4 matrix;uniform bool uUnitPx;uniform float zoomUnits;uniform float zIndex;uniform vec2 offset;attribute vec3 position;attribute float corner;attribute float scale;attribute float rotation;attribute vec2 size;attribute vec2 aTextCoord;varying vec2 vTextCoord;/***\u70B9A(x,y)\uFF0C\u7ED5\u539F\u70B9\u987A\u65F6\u9488\u65CB\u8F6C\u89D2\u5EA6a\u65B0\u5750\u6807\u7684\u8BA1\u7B97\u516C\u5F0F*x1=x*cos(a)+y*sin(a)*y1=y*cos(a)-x*sin(a)*/mat3 rotateZ(float angle){float cos0=cos(angle);float sin0=sin(angle);return mat3(cos0,sin0,0.,-sin0,cos0,0.,0.,0.,1.);}vec3 transformCoord(vec3 coord,vec2 size,float corner){float x=coord.x;float y=coord.y;float z=coord.z;mat3 mat=rotateZ(rotation);vec3 rotated=vec3(size[0],0.0,size[1]);if(corner==1.0){rotated=mat*vec3(-size[0],0.0,size[1]);}else if(corner==2.0){rotated=mat*vec3(size[0],0.0,size[1]);}else if(corner==3.0){rotated=mat*vec3(size[0],0.0,-size[1]);}else{rotated=mat*vec3(-size[0],0.0,-size[1]);}x+=rotated.x;y+=rotated.y;z+=rotated.z;return vec3(x,y,z);}void main(){vTextCoord=aTextCoord;vec2 pixelOffset=offset;vec2 halfSize=size/2.0*scale;if(uUnitPx){halfSize*=zoomUnits;pixelOffset*=zoomUnits;}vec3 current=transformCoord(position,halfSize,corner);current.z+=zIndex;gl_Position=matrix*vec4(current.x+pixelOffset[0],current.y-pixelOffset[1],current.z,1.0);}",fragmentShader:`precision highp float;uniform sampler2D textureImage;uniform vec4 uSelectedColor;varying vec2 vTextCoord;void main(){vec4 textureColor=texture2D(textureImage,vec2(vTextCoord.x,1.0-vTextCoord.y));if(textureColor.a<=0.1&&uIsPickRender==false){discard;}gl_FragColor=textureColor;
#if defined(PICK)
if(mapvIsPicked()){gl_FragColor=vec4(uSelectedColor.rgb,gl_FragColor.a);}
#endif
}`,defines:a.enablePicked?["PICK"]:[]},this),this.vertexBuffer=new qe({gl:o,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.uvBuffer=new qe({gl:o,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.indexBuffer=new qe({gl:o,target:"ELEMENT_ARRAY_BUFFER",usage:"STATIC_DRAW"}),a=[{name:"position",buffer:this.vertexBuffer,size:3,stride:32,type:"FLOAT",offset:0},{name:"corner",buffer:this.vertexBuffer,size:1,stride:32,type:"FLOAT",offset:12},{name:"size",buffer:this.vertexBuffer,size:2,stride:32,type:"FLOAT",offset:16},{name:"scale",buffer:this.vertexBuffer,size:1,stride:32,type:"FLOAT",offset:24},{name:"rotation",buffer:this.vertexBuffer,size:1,stride:32,type:"FLOAT",offset:28},{name:"aTextCoord",buffer:this.uvBuffer,size:2,stride:8,type:"FLOAT",offset:0}],a=a.concat(this.getCommonAttributes()),this.vertexArray=new bi({gl:o,program:this.program,attributes:a})}},{key:"onDestroy",value:function(){}},{key:"onChanged",value:function(o,a){this.gl&&this.processCache(o,a)}},{key:"processCache",value:function(o,a){this.cachedData=[];for(var y=0;y<a.length;y++){var g=this.normizedPoint(a[y].geometry.coordinates),x=a[y].text;"properties"in a[y]&&"text"in a[y].properties&&(x=a[y].properties.text);var v=this.getProperty("angle",o.angle,a[y]),M=this.getProperty("color",o.color,a[y]),D=this.getProperty("maxHeightLine",o.maxHeightLine,a[y]);g&&x!==void 0&&this.cachedData.push({point:g,text:x,angle:v,color:M,maxHeightLine:D,index:y})}}},{key:"render",value:function(o){if(this.cachedData&&this.cachedData.length&&this.map){var a=o.gl,y=o.matrix,g=this.getOptions(),x=this.program;x.use(a),this.throttleUpdate(o),this.setGLState({blend:!0,blendEquation:a.FUNC_ADD,blendFunc:$s(a,g.blend),polygonOffset:g.polygonOffset,depthTest:g.depthTest,depthMask:g.depthWrite});var v=this.map.getZoomUnits();x.setUniforms(Vr(this.getCommonUniforms(o),{matrix:y,textureImage:this.texture,offset:g.offset,zoomUnits:v,zIndex:g.zIndex,uUnitPx:g.unit==="px"})),0<this.index.length&&(this.indexBuffer.bind(),this.vertexArray.bind(),a.drawElements(a.TRIANGLES,this.index.length,a.UNSIGNED_INT,0))}}},{key:"throttleUpdate",value:function(o){this.updateText(o)}},{key:"updateText",value:function(o){var a=o.gl,y=o.matrix,g=this.getOptions();o=g.fontSize;var x=g.fontFamily,v=g.translateX,M=g.padding,D=g.margin,U=g.collides,C=g.enablePicked,L=g.shadow;g=g.lineBreak;var B=a.canvas.width/window.devicePixelRatio,O=a.canvas.height/window.devicePixelRatio,k=this.canvas,j=this.ctx;j.save(),j.scale(window.devicePixelRatio,window.devicePixelRatio),j.textBaseline="top",j.font="normal bold 20px "+x;var V=new Wu;a=[];for(var Y=0;Y<this.cachedData.length;Y++){var Q=this.cachedData[Y],nt=Q.point,ut=Q.text,ct=Q.angle,Tt=Q.index,Lt=Q.color;Q=Q.maxHeightLine;var Dt=Ri(nt,3),ae=on.clone([Dt[0],Dt[1],Dt[2],1]);on.transformMat4(ae,ae,y),on.scale(ae,ae,1/ae[3]),Dt=(ae[0]+1)/2*B,ae=(-ae[1]+1)/2*O;var ne=j.measureText(ut),we=ut.split(g),xe=we.map(function(ee){return j.measureText(ee).width});xe=Math.max.apply(Math,Wr(xe));for(var Ye=20,mr=0;mr<we.length-1;mr++)Ye+=Q;if(we=Ye,ne=Math.min(ne.width,xe)+1,ne+=2*M[0]+v,we+=2*M[1],Ye=ne+D[0],xe=we+D[1],Dt-=Ye/2,ae-=xe/2,Ye=Dt+Ye,xe=ae+xe,!(0>Ye||0>xe||Dt>B||ae>O)){if(U){if(Dt={minX:Dt,maxX:Ye,minY:ae,maxY:xe},V.collides(Dt))continue;V.insert(Dt)}a.push({w:ne,h:we,point:nt,text:ut,color:Lt,angle:ct,maxHeightLine:Q,dataIndex:Tt})}}for(j.restore(),y=[],D=[],U=[],B=[],V=Iu(a),O=V.w,V=V.h,0>=O&&(O=1),0>=V&&(V=1),k.width=O*window.devicePixelRatio,k.height=V*window.devicePixelRatio,j.save(),j.scale(window.devicePixelRatio,window.devicePixelRatio),j.textBaseline="top",j.font="normal bold 20px "+x,j.shadowColor=L&&L.color,j.shadowOffsetX=L&&L.offsetX,j.shadowOffsetY=L&&L.offsetY,j.shadowBlur=L&&L.blur,x=0,L=a.length;x<L;++x){for(k=a[x],j.fillStyle=k.color,aA(j,k.text,k.x+M[0]+v,k.y+M[1],k.maxHeightLine,g),ut=Ri(k.point,3),Y=ut[0],nt=ut[1],ut=ut[2],ct=0;4>ct;ct++)y.push(Y,nt,ut),y.push(ct),y.push(k.w,k.h),y.push(o/20,k.angle*Math.PI/180);Y=k.x/O,nt=(k.x+k.w)/O,ut=(k.y+k.h)/V,ct=k.y/V,D.push(Y,ut,Y,ct,nt,ct,nt,ut),Y=4*x,U.push(Y,Y+2,Y+1,Y,Y+3,Y+2),C&&(k=this.indexToRgb(k.dataIndex),B.push(k[0]/255,k[1]/255,k[2]/255),B.push(k[0]/255,k[1]/255,k[2]/255),B.push(k[0]/255,k[1]/255,k[2]/255),B.push(k[0]/255,k[1]/255,k[2]/255))}j.restore(),this.loadTexture(),this.index=U,this.vertexBuffer.updateData(new Float32Array(y)),this.uvBuffer.updateData(new Float32Array(D)),this.indexBuffer.updateData(new Uint32Array(U)),C&&this.pickBuffer.updateData(new Float32Array(B))}},{key:"loadTexture",value:function(){var o=this;this.canvas?xn(this.gl,this.canvas,function(a){o.texture=a},{TEXTURE_WRAP_S:"CLAMP_TO_EDGE",TEXTURE_WRAP_T:"CLAMP_TO_EDGE"}):this.texture=null}}]),h}(Ci),$A=function(l){function h(o){Xe(this,h),o=_r(this,(h.__proto__||ur(h)).call(this,o)),o.name="LabelLayer";var a=o.canvas=document.createElement("canvas");return o.ctx=a.getContext("2d"),o.arrowHeight=8,o}return yr(h,l),Ue(h,[{key:"getDefaultOptions",value:function(){return{depthWrite:!1,depthTest:!0,textColor:"#0f0",borderColor:"#f00",backgroundColor:"#fff",fontFamily:"Microsoft Yahei",fontSize:14,lineHeight:20,textAlign:"left",collides:!1,offset:[0,0],padding:[2,2],polygonOffset:[0,0],borderRadius:5}}},{key:"initialize",value:function(o){this.gl=o;var a=this.getOptions();this.texture=null,this.lastUpdateTime=0,this.program=new jr(this.gl,{vertexShader:"precision highp float;uniform mat4 matrix;uniform float zoomUnits;uniform float devicePixelRatio;uniform float zIndex;uniform vec2 offset;attribute vec3 position;attribute float corner;attribute vec2 size;attribute vec2 aTextCoord;varying vec2 vTextCoord;/***\u70B9A(x,y)\uFF0C\u7ED5\u539F\u70B9\u987A\u65F6\u9488\u65CB\u8F6C\u89D2\u5EA6a\u65B0\u5750\u6807\u7684\u8BA1\u7B97\u516C\u5F0F*x1=x*cos(a)+y*sin(a)*y1=y*cos(a)-x*sin(a)*/vec3 transformCoord(vec3 coord,vec2 size,float corner){float x=coord.x;float y=coord.y;if(corner==1.0){x+=-size.x;y+=size.y;}else if(corner==2.0){x+=size.x;y+=size.y;}else if(corner==3.0){x+=size.x;y+=-size.y;}else{x+=-size.x;y+=-size.y;}return vec3(x,y+size.y,coord.z);}void main(){vTextCoord=aTextCoord;vec2 pixelOffset=offset*zoomUnits;vec4 projection=matrix*vec4(position.x+pixelOffset[0],position.y-pixelOffset[1],position.z+zIndex,1.0);vec3 screen=projection.xyz/projection.w;vec2 halfSize=size/MAPV_resolution*devicePixelRatio;vec3 current=transformCoord(screen,halfSize,corner);gl_Position=vec4(current,1.0);}",fragmentShader:`precision highp float;uniform sampler2D textureImage;uniform vec4 uSelectedColor;varying vec2 vTextCoord;void main(){gl_FragColor=texture2D(textureImage,vec2(vTextCoord.x,1.0-vTextCoord.y));
#if defined(PICK)
if(mapvIsPicked()){gl_FragColor=vec4(uSelectedColor.rgb,gl_FragColor.a);}
#endif
}`,defines:a.enablePicked?["PICK"]:[]},this),this.vertexBuffer=new qe({gl:o,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.uvBuffer=new qe({gl:o,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.indexBuffer=new qe({gl:o,target:"ELEMENT_ARRAY_BUFFER",usage:"STATIC_DRAW"}),a=[{name:"position",buffer:this.vertexBuffer,size:3,stride:24,type:"FLOAT",offset:0},{name:"corner",buffer:this.vertexBuffer,size:1,stride:24,type:"FLOAT",offset:12},{name:"size",buffer:this.vertexBuffer,size:2,stride:24,type:"FLOAT",offset:16},{name:"aTextCoord",buffer:this.uvBuffer,size:2,stride:8,type:"FLOAT",offset:0}],a=a.concat(this.getCommonAttributes()),this.vertexArray=new bi({gl:o,program:this.program,attributes:a})}},{key:"onDestroy",value:function(){}},{key:"onChanged",value:function(o,a){this.gl&&this.processCache(o,a)}},{key:"processCache",value:function(o,a){for(this.cachedData=[],o=0;o<a.length;o++){var y=a[o],g=this.normizedPoint(y.geometry.coordinates);g&&this.cachedData.push({point:g,item:y,index:o})}}},{key:"render",value:function(o){if(this.cachedData&&this.cachedData.length&&this.map){var a=o.gl,y=o.matrix,g=this.getOptions(),x=this.program;x.use(a),this.updateText(o),this.setGLState({blend:!0,blendEquation:a.FUNC_ADD,blendFunc:[a.SRC_ALPHA,a.ONE_MINUS_SRC_ALPHA],polygonOffset:g.polygonOffset,depthTest:g.depthTest,depthMask:g.depthWrite});var v=this.map.getZoomUnits();x.setUniforms(Vr(this.getCommonUniforms(o),{matrix:y,devicePixelRatio:window.devicePixelRatio,textureImage:this.texture,offset:g.offset,zoomUnits:v,zIndex:g.zIndex})),0<this.index.length&&(this.indexBuffer.bind(),this.vertexArray.bind(),a.drawElements(a.TRIANGLES,this.index.length,a.UNSIGNED_INT,0))}}},{key:"updateText",value:function(o){var a=this,y=o.gl,g=o.matrix,x=this.getOptions().enablePicked;o=this.canvas;var v=this.ctx;y=this.createMapbox(v,y,g),g=Iu(y);var M=g.w,D=g.h;0>=M&&(M=1),0>=D&&(D=1),o.width=M*window.devicePixelRatio,o.height=D*window.devicePixelRatio;var U=[],C=[],L=[],B=[];y.forEach(function(O,k){a.drawItem(v,O);var j=Ri(O.point,3),V=j[0],Y=j[1];j=j[2];for(var Q=0;4>Q;Q++)U.push(V,Y,j),U.push(Q),U.push(O.w,O.h);V=O.x/M,Y=(O.x+O.w)/M,j=(O.y+O.h)/D,Q=O.y/D,C.push(V,j,V,Q,Y,Q,Y,j),k*=4,L.push(k,k+2,k+1,k,k+3,k+2),x&&(O=a.indexToRgb(O.dataIndex),B.push(O[0]/255,O[1]/255,O[2]/255),B.push(O[0]/255,O[1]/255,O[2]/255),B.push(O[0]/255,O[1]/255,O[2]/255),B.push(O[0]/255,O[1]/255,O[2]/255))}),this.loadTexture(),this.index=L,this.vertexBuffer.updateData(new Float32Array(U)),this.uvBuffer.updateData(new Float32Array(C)),this.indexBuffer.updateData(new Uint32Array(L)),x&&this.pickBuffer.updateData(new Float32Array(B))}},{key:"createMapbox",value:function(o,a,y){var g=this,x=this.getOptions(),v=x.padding,M=x.collides,D=x.fontSize,U=a.canvas.width/window.devicePixelRatio,C=a.canvas.height/window.devicePixelRatio,L=new Wu,B=[];return this.cachedData.forEach(function(O){var k=O.point,j=O.item;O=O.index;var V=Ri(k,3);V=on.clone([V[0],V[1],V[2],1]),on.transformMat4(V,V,y),on.scale(V,V,1/V[3]);var Y=(V[0]+1)/2*U,Q=(-V[1]+1)/2*C;V=g.computeTextWH(j,o,v,D);var nt=Ri(V,2);V=nt[0],nt=nt[1],Y-=V/2,Q-=nt/2;var ut=Y+V,ct=Q+nt;if(!(0>ut||0>ct||Y>U||Q>C)){if(M){if(Y={minX:Y,maxX:ut,minY:Q,maxY:ct},L.collides(Y))return;L.insert(Y)}B.push({w:V,h:nt+g.arrowHeight,point:k,item:j,dataIndex:O})}}),B}},{key:"computeTextWH",value:function(o,a){var y=this.getOptions(),g=y.padding,x=y.fontSize,v=y.borderRadius,M=y.fontFamily;return y=y.lineHeight,a.save(),a.scale(window.devicePixelRatio,window.devicePixelRatio),a.font=x+"px "+M,o=o.properties.text.split(`
`),x=o.reduce(function(D,U){return D.length<U.length?U:D},""),x=a.measureText(x),a.restore(),[x.width+2*(g[1]+v),2*(g[0]+v)+y*o.length]}},{key:"drawItem",value:function(o,a){var y=this.getOptions(),g=y.padding,x=y.backgroundColor,v=y.textColor,M=y.fontSize,D=y.borderColor,U=y.borderRadius,C=y.fontFamily,L=y.lineHeight;y=y.textAlign;var B=U-1,O=a.x,k=a.y,j=a.w,V=a.h;a=a.item;var Y="";kn(a.properties)==="object"&&(Y=a.properties.text||"",v=a.properties.textColor||v,D=a.properties.borderColor||D,x=a.properties.backgroundColor||x),a=Y.split(`
`),V-=this.arrowHeight,o.save(),o.scale(window.devicePixelRatio,window.devicePixelRatio),o.textBaseline="top",o.font=M+"px "+C,o.translate(O,k),o.fillStyle=x,o.strokeStyle=D,o.beginPath(),o.arc(U,U,B,Math.PI,1.5*Math.PI),o.lineTo(j-U,1),o.arc(j-U,U,B,1.5*Math.PI,0),o.lineTo(j-1,V-U),o.arc(j-U,V-U,B,0*Math.PI,.5*Math.PI),o.lineTo(U,V-1),o.arc(U,V-U,B,.5*Math.PI,1*Math.PI),o.lineTo(1,U),o.closePath(),o.fill(),o.stroke(),o.beginPath(),x=this.arrowHeight,C=j/2,B=x/2,o.moveTo(C-B,V-1),o.lineTo(C+B,V-1),o.lineTo(C,V+.8*x),o.fillStyle=D,o.fill(),o.fillStyle=v;var Q=y==="center"?C:y==="right"?j-U-g[1]:U+g[1];o.textAlign=y,a.forEach(function(nt,ut){o.fillText(nt,Q,U+g[0]+(ut+.5)*L-.5*M)}),o.restore()}},{key:"loadTexture",value:function(){var o=this;this.canvas?xn(this.gl,this.canvas,function(a){o.texture=a},{TEXTURE_WRAP_S:"CLAMP_TO_EDGE",TEXTURE_WRAP_T:"CLAMP_TO_EDGE"}):this.texture=null}}]),h}(Ci);An.prototype.parseColors=function(l){this.arrFeatureStyles=[[2,l[0]||"rgba(79,210,125,1)",2,2,0,[],0,0],[2,l[0]||"rgba(79,210,125,1)",3,2,0,[],0,0],[2,l[0]||"rgba(79,210,125,1)",3,2,0,[],0,0],[2,l[0]||"rgba(79,210,125,1)",5,2,0,[],0,0],[2,l[0]||"rgba(79,210,125,1)",6,2,0,[],0,0],[2,l[2]||"rgba(255,208,69,1)",2,2,0,[],0,0],[2,l[2]||"rgba(255,208,69,1)",3,2,0,[],0,0],[2,l[2]||"rgba(255,208,69,1)",3,2,0,[],0,0],[2,l[2]||"rgba(255,208,69,1)",5,2,0,[],0,0],[2,l[2]||"rgba(255,208,69,1)",6,2,0,[],0,0],[2,l[1]||"rgba(232,14,14,1)",2,2,0,[],0,0],[2,l[1]||"rgba(232,14,14,1)",3,2,0,[],0,0],[2,l[1]||"rgba(232,14,14,1)",3,2,0,[],0,0],[2,l[1]||"rgba(232,14,14,1)",5,2,0,[],0,0],[2,l[1]||"rgba(232,14,14,1)",6,2,0,[],0,0],[2,l[3]||"rgba(181,0,0,1)",2,2,0,[],0,0],[2,l[3]||"rgba(181,0,0,1)",3,2,0,[],0,0],[2,l[3]||"rgba(181,0,0,1)",3,2,0,[],0,0],[2,l[3]||"rgba(181,0,0,1)",5,2,0,[],0,0],[2,l[3]||"rgba(181,0,0,1)",6,2,0,[],0,0],[2,"rgba(255,255,255,1)",4,0,0,[],0,0],[2,"rgba(255,255,255,1)",5.5,0,0,[],0,0],[2,"rgba(255,255,255,1)",7,0,0,[],0,0],[2,"rgba(255,255,255,1)",8.5,0,0,[],0,0],[2,"rgba(255,255,255,1)",10,0,0,[],0,0]]},An.prototype.setColors=function(l){this.parseColors(l)},An.prototype.initialize=function(l){this._initialize||(this._initialize=!0)},An.prototype.clearCache=function(l){this.cache={}},An.prototype.setMap=function(l){l?(this.map=l,this._initialize?this.canvaslayer.show():this.initialize(l)):this.canvaslayer.hide()},An.prototype.draw=function(l){l=l||{},l.clearCache&&this.clearCache(),this.canvaslayer.draw()},An.prototype.clear=function(){},An.prototype.update=function(){var l=this.map,h=this.getDataZoom(),o=Math.pow(2,18-h),a=256*o,y=Mr.convertLL2MC(l.getCenter()),g=Math.ceil(y.lng/a),x=Math.ceil(y.lat/a),v=this.tileSize,M=h-Math.round(l.getZoom());for(0<M&&(v/=Math.pow(2,M)),a=[g,x,(y.lng-g*a)/a*v,(y.lat-x*a)/a*v],g=l.getBounds(),y=g.getNorthEast(),g=g.getSouthWest(),l.getSize(),l.getSize(),l=(y.lng-g.lng)/o,o=(y.lat-g.lat)/o,y=a[1]-Math.ceil((o/2-a[3])/v),g=a[0]+Math.ceil((l/2+a[2])/v),x=a[1]+Math.ceil((o/2+a[3])/v),o=[],v=a[0]-Math.ceil((l/2-a[2])/v);v<g;v++)for(a=y;a<x;a++)o.push([v,a,h]);for(this.tilesOrder=o,this._loadCount={},v=0;v<o.length;v++)a=o[v][0],l=o[v][1],this._loadCount[a+"_"+l+"_"+o[v][2]]=!1;for(v=0;v<o.length;v++)a=o[v][0],l=o[v][1],this.showTile(a,l,h)},An.prototype.showTile=function(l,h,o){this._parseDataAndDraw(l,h,o)},An.prototype.drawCurrentData=function(){this.clear();for(var l=[],h=0;h<this.tilesOrder.length;h++){var o=this.tilesOrder[h][0],a=this.tilesOrder[h][1],y=this.tilesOrder[h][2],g=this.cache[this.getCacheKey(o,a,y)];if(g)for(o=this._drawFeatures(g,o,a,y),a=0;a<o.length;a++)l.push(o[a])}this.lineLayer.setData(l)},An.prototype.isAllLoaded=function(){var l=!0,h;for(h in this._loadCount)if(!this._loadCount[h]){l=!1;break}return l},An.prototype.getCacheKey=function(l,h,o){return l+"_"+h+"_"+o},An.prototype.getDataZoom=function(){var l=Math.round(this.map.getZoom());return 19<l&&(l=19),l},An.prototype._parseDataAndDraw=function(l,h,o){var a=this,y=a.map,g=y.getCenter(),x=Math.round(y.getZoom()),v=this.getCacheKey(l,h,o),M="_cbk"+(1e5*Math.random()).toFixed(0),D=this.getTileUrl(l,h,o,"BMapGL."+M);BMapGL[M]=function(U){a._loadCount[l+"_"+h+"_"+o]=!0;var C=y.getCenter(),L=Math.round(y.getZoom());C.equals(g)&&L===x?(C=U.content&&U.content.tf,U.data&&(C=U.data),a.cache[v]=C?{traffic:C,precision:U.precision}:null,a.drawTogether&&a.isAllLoaded()&&a.drawCurrentData()):L!==x&&a.clear(),delete BMapGL[M]},a.cache[v]!==void 0?(a._loadCount[l+"_"+h+"_"+o]=!0,a.drawTogether&&a.isAllLoaded()&&a.drawCurrentData()):this.request(D)},An.prototype.getTileUrl=function(l,h,o,a){return"https://sp3.baidu.com/7_AZsjOpB1gCo2Kml5_Y_DAcsMJiwa/traffic/?qt=vtraffic&x="+l+"&y="+h+"&z="+o+"&fn="+a+"&t="+new Date().getTime()},An.prototype._drawFeatures=function(l,h,o,a){var y=10;a=Math.pow(2,18-a),this.map.getCenter();var g=this.tileSize;if(h=[h*g*a,(o+1)*g*a],o=[],l&&l.traffic){y*=l.precision,l=l.traffic,g=0;for(var x=l.length;g<x;g++){var v=l[g],M=v[1];v=this.arrFeatureStyles[v[3]];var D=M[0]/y,U=-M[1]/y,C=[];C.push([h[0]+D*a,h[1]+U*a,1]);for(var L=2,B=M.length;L<B;L+=2)D+=M[L]/y,U-=M[L+1]/y,C.push([h[0]+D*a,h[1]+U*a,1]);o.push({color:v[1],geometry:{type:"LineString",coordinates:C}})}}return o},An.prototype.request=function(l,h){if(h){var o=(1e5*Math.random()).toFixed(0);BMapGL._rd["_cbk"+o]=function(y){h&&h(y),delete BMapGL._rd["_cbk"+o]},l+="&callback=BMapGL._rd._cbk"+o}var a=document.createElement("script");a.type="text/javascript",a.charset="utf-8",a.src=l,a.addEventListener?a.addEventListener("load",function(y){y=y.target,y.parentNode.removeChild(y)},!1):a.attachEvent&&a.attachEvent("onreadystatechange",function(y){y=window.event.srcElement,!y||y.readyState!=="loaded"&&y.readyState!=="complete"||y.parentNode.removeChild(y)}),setTimeout(function(){document.getElementsByTagName("head")[0].appendChild(a),a=null},1)},An.prototype.getRGBA=function(l){return l>>>=0,"rgba("+(l>>24&255)+","+(l>>16&255)+","+(l>>8&255)+","+(l&255)/256+")"},An.prototype.getLineCap=function(l){return["butt","square","round"][l]},An.prototype.getLineJoin=function(l){return["miter","bevel","round"][l]};var t_=function(l){function h(o){Xe(this,h),o=_r(this,(h.__proto__||ur(h)).call(this,o)),o.autoUpdate=!0,o.getOptions();var a=new Si({color:"rgba(257, 254, 47, 0.9)",minZoom:18,duration:.8,interval:.2,trailLength:.4});return o.lineLayer=a,o.children=[a],o}return yr(h,l),Ue(h,[{key:"initialize",value:function(o){fa(h.prototype.__proto__||ur(h.prototype),"initialize",this).call(this,o),o=this.map.map;var a=new An({});a.lineLayer=this.lineLayer,this.trafficTileManager=a,a.setMap(o),a.update(),o.addEventListener("moveend",function(){a.update()}),o.addEventListener("zoomend",function(){a.update()}),o.addEventListener("ondraw",function(){})}},{key:"onOptionsChanged",value:function(o){}},{key:"onDataChanged",value:function(o){}},{key:"getDefaultOptions",value:function(){return{}}}]),h}(da),e_=function(l){function h(o,a){return Xe(this,h),o=_r(this,(h.__proto__||ur(h)).call(this,o,a)),o.name="HeatmapLayer",o.bufferData=[],o}return yr(h,l),Ue(h,[{key:"getDefaultOptions",value:function(){return{size:13,unit:"px",height:0,max:100,min:0,opacity:1}}},{key:"initialize",value:function(o){var a=this;this.gl=o;var y=this.getOptions();this.inverseMatrix=Ke.create(Float64Array),this.frameBuffer=new Zn(o),this.webglLayer.map.onResize(function(){a.frameBuffer=new Zn(o)}),this.circle=uA(64),this.circleTexture=Ge(o,this.circle,{TEXTURE_MAG_FILTER:"LINEAR",TEXTURE_MIN_FILTER:"LINEAR",TEXTURE_WRAP_S:"CLAMP_TO_EDGE",TEXTURE_WRAP_T:"CLAMP_TO_EDGE"}).texture,this.intensity=new Li({gradient:y.gradient}),this.paletteTexture=Ge(o,this.intensity.paletteCtx.canvas,{TEXTURE_MAG_FILTER:"LINEAR",TEXTURE_MIN_FILTER:"LINEAR",TEXTURE_WRAP_S:"CLAMP_TO_EDGE",TEXTURE_WRAP_T:"CLAMP_TO_EDGE"}).texture,this.offlineProgram=new jr(this.gl,{vertexShader:"uniform mat4 u_matrix;uniform mat4 pointToPixelMatrix;uniform mat4 pixelToViewMatrix;uniform mat4 projectionMatrix;uniform int unit;uniform float size;uniform float max;uniform float min;attribute vec3 aPos;attribute vec2 aOffset;attribute float aCount;varying vec2 vOffset;varying float vCount;varying vec3 vPosition;void main(){vOffset=aOffset;vCount=(aCount-min)/(max-min);if(unit==1){vec2 pos=(pointToPixelMatrix*vec4(aPos.xy,0.0,1.0)).xy+aOffset.xy*size/2.0;gl_Position=projectionMatrix*pixelToViewMatrix*vec4(pos,0.0,1.0);}else{vec2 pos=aPos.xy+aOffset.xy*size;gl_Position=u_matrix*vec4(pos,0.0,1.0);}vPosition=vec3(gl_Position.z/gl_Position.w);}",fragmentShader:"varying vec2 vOffset;varying float vCount;varying vec3 vPosition;uniform sampler2D uCircle;void main(){vec4 circle=texture2D(uCircle,(vOffset+1.0)/2.0);float intensity=circle.a*vCount;if(intensity<=0.0){discard;}gl_FragColor=vec4(vPosition,intensity);}"},this),this.offlineBuffer=new qe({gl:o,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.offlineIndexBuffer=new qe({gl:o,target:"ELEMENT_ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.offlineVertexArray=new bi({gl:o,program:this.offlineProgram,attributes:[{stride:24,name:"aPos",buffer:this.offlineBuffer,size:3,type:"FLOAT",offset:0},{stride:24,name:"aOffset",buffer:this.offlineBuffer,size:2,type:"FLOAT",offset:12},{stride:24,name:"aCount",buffer:this.offlineBuffer,size:1,type:"FLOAT",offset:20}]}),this.indexBuffer=new qe({gl:o,target:"ELEMENT_ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.program=new jr(this.gl,{vertexShader:"attribute vec2 aPos;varying vec2 vPos;uniform float uHeight;uniform mat4 pixelToViewMatrix;uniform mat4 projectionMatrix;uniform sampler2D u_sampler;uniform mat4 inverseMatrix;void main(){vPos=aPos;if(uHeight<=0.0){gl_Position=vec4(aPos,0.0,1.0);}else{vec4 gray=texture2D(u_sampler,(aPos+1.0)/2.0);vec4 m0=inverseMatrix*vec4(aPos.xy,0.0,1.0);vec4 m1=inverseMatrix*vec4(aPos.xy,1.0,1.0);m0/=m0.w;m1/=m1.w;vec4 pixel=m0+(-m0.z/(m1.z-m0.z))*(m1-m0);pixel.z=uHeight*gray.a;gl_Position=projectionMatrix*pixelToViewMatrix*vec4(pixel.xyz,1.0);}}",fragmentShader:"uniform sampler2D u_sampler;uniform sampler2D u_samplerPalette;uniform float uHeight;uniform float opacity;varying vec2 vPos;void main(){vec4 gray=texture2D(u_sampler,(vPos+1.0)/2.0);float grayAlpha=gray.a;if(grayAlpha<=0.0){discard;}gl_FragColor=texture2D(u_samplerPalette,vec2(grayAlpha,1.0));float addAlpha=1.0;if(gray.a<0.3){addAlpha=gray.a*3.3;}gl_FragColor.a*=addAlpha;gl_FragColor.a*=opacity;}"},this),this.buffer=new qe({gl:o,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.vertexArray=new bi({gl:o,program:this.program,attributes:[{stride:8,name:"aPos",buffer:this.buffer,size:2,type:"FLOAT",offset:0}]}),y=[];for(var g=[],x=Math.floor(o.canvas.width/4),v=Math.floor(o.canvas.height/4),M=x+1,D=0;D<=v;D++)for(var U=0;U<=x;U++)if(y.push(2*U/x-1,2*D/v-1),U<x&&D<v){var C=M*D+U,L=M*(D+1)+U;g.push(C,C+1,L+1),g.push(C,L+1,L)}this.bufferData=y,this.buffer.updateData(new Float32Array(y)),this.indexData=g,this.indexBuffer.updateData(new Uint32Array(g))}},{key:"onDestroy",value:function(){this.bufferData=[]}},{key:"onOptionsChanged",value:function(o,a){var y=this.gl;y&&o.gradient!==a.gradient&&(this.intensity=new Li({gradient:o.gradient}),this.paletteTexture=Ge(y,this.intensity.paletteCtx.canvas,{TEXTURE_MAG_FILTER:"LINEAR",TEXTURE_MIN_FILTER:"LINEAR",TEXTURE_WRAP_S:"CLAMP_TO_EDGE",TEXTURE_WRAP_T:"CLAMP_TO_EDGE"}).texture)}},{key:"onDataChanged",value:function(o){if(this.gl){var a=[],y=[];this.getOptions();for(var g=0;g<o.length;g++){var x=o[g],v=this.normizedPoint(o[g].geometry.coordinates),M=x.count===void 0?1:x.count;"properties"in x&&"count"in x.properties&&(M=x.properties.count),a.push(v[0],v[1],v[2]),a.push(-1,-1),a.push(M),a.push(v[0],v[1],v[2]),a.push(-1,1),a.push(M),a.push(v[0],v[1],v[2]),a.push(1,1),a.push(M),a.push(v[0],v[1],v[2]),a.push(1,-1),a.push(M),x=4*g,y.push(x+0,x+2,x+1),y.push(x+0,x+3,x+2)}this.offlineBufferData=a,this.offlineIndexData=y,this.offlineBuffer.updateData(new Float32Array(a)),this.offlineIndexBuffer.updateData(new Uint32Array(y))}}},{key:"render",value:function(o){var a=o.gl,y=o.matrix,g=o.pointToPixelMatrix,x=o.pixelToViewMatrix;if(o=o.projectionMatrix,this.offlineBufferData&&!(0>=this.offlineBufferData.length)){var v=this.getOptions();this.setGLState({blend:!0,blendFunc:[a.ONE,a.ONE],depthTest:!1}),a.bindFramebuffer(a.FRAMEBUFFER,this.frameBuffer.framebuffer),a.clearColor(0,0,0,0),a.clear(a.COLOR_BUFFER_BIT),this.offlineProgram.use(a),this.offlineProgram.setUniforms({u_matrix:y,uCircle:this.circleTexture,pointToPixelMatrix:g,pixelToViewMatrix:x,projectionMatrix:o,unit:v.unit==="px"?1:0,size:v.size,max:v.max,min:v.min}),this.offlineVertexArray.bind(),this.offlineIndexBuffer.bind(),a.drawElements(a.TRIANGLES,this.offlineIndexData.length,a.UNSIGNED_INT,0),a.bindFramebuffer(a.FRAMEBUFFER,null),this.program.use(a),this.vertexArray.bind(),y=this.inverseMatrix,Ke.identity(y),Ke.multiply(y,o,x),Ke.invert(y,y),this.setGLState({blend:!0,blendFunc:[a.SRC_ALPHA,a.ONE],depthTest:!!v.height}),this.program.setUniforms({u_sampler:this.frameBuffer.framebuffer.texture,u_samplerPalette:this.paletteTexture,uHeight:v.height,opacity:v.opacity,pixelToViewMatrix:x,inverseMatrix:y,projectionMatrix:o}),this.indexBuffer.bind(),a.drawElements(a.TRIANGLES,this.indexData.length,a.UNSIGNED_INT,0)}}}]),h}(Ci),fc=function(l){function h(o,a){return Xe(this,h),o=_r(this,(h.__proto__||ur(h)).call(this,o,a)),o.name="BarLayer",o.selectedColor=[-1,-1,-1],o.textureCache={},o}return yr(h,l),Ue(h,[{key:"getDefaultOptions",value:function(){return{color:"rgba(0, 180, 0, 1.0)",edgeCount:4,unit:"m",height:1e5,type:"normal",size:5e4}}},{key:"initialize",value:function(o){this.gl=o;var a=this.getOptions(),y={normal:[`attribute vec3 aPos;attribute vec4 aColor;attribute float aSize;attribute float aEdgeIndex;attribute float aPointIndex;attribute float aEdgeCount;varying vec4 vColor;varying vec4 vPosition;varying vec4 vFragPosition;varying float vSize;varying float vEdgeIndex;varying float vPointIndex;varying float vEdgeCount;uniform mat4 uMatrix;uniform float uZoomUnits;uniform vec4 uSelectedColor;void main(){vColor=aColor;vEdgeIndex=aEdgeIndex;vEdgeCount=aEdgeCount;vPointIndex=aPointIndex;float z=aPos.z*uZoomUnits;float x=aPos.x;float y=aPos.y;vSize=aSize*uZoomUnits;float a=radians(360.0/aEdgeCount);float b=a/2.0;float r=vSize/cos(b);if(aEdgeIndex<0.0){float index=aPointIndex;float angle=0.0;if(mod(index,2.0)==0.0){angle=a*(index/2.0)-b;}else{angle=-a*((index-1.0)/2.0)-b;}y=y+r*sin(angle);x=x+r*cos(angle);}else{float i=aEdgeIndex-1.0;float j=aPointIndex;float angle=a*i+b;y=y+r*sin(angle);x=x+r*cos(angle);}vPosition=vec4(aPos,1.0);vFragPosition=vec4(x,y,z,1.0);gl_Position=uMatrix*vFragPosition;if(aEdgeIndex==1.0&&aPointIndex==1.0){gl_PointSize=20.0;}else{gl_PointSize=10.0;}
#if defined(PICK)
if(mapvIsPicked()){vColor=uSelectedColor;}
#endif
}`,"varying vec4 vColor;varying float vEdgeIndex;varying float vPointIndex;varying float vEdgeCount;varying vec4 vPosition;varying vec4 vFragPosition;uniform mat4 uMatrix;void main(){vec4 color=vColor;if(vEdgeIndex<0.0){color.r+=0.2;color.g+=0.2;color.b+=0.2;}else{float i=ceil(vEdgeIndex);;float d=i/vEdgeCount*0.5;if(i<=vEdgeCount/2.0){d=0.2*(i/vEdgeCount*0.5)-0.1;}else{d=0.2*(vEdgeCount-i)/vEdgeCount*0.5-0.1;}color.r+=d;color.g+=d;color.b+=d;}gl_FragColor=color;}"],light:[`attribute vec3 aPos;attribute vec4 aColor;attribute float aSize;attribute float aEdgeIndex;attribute float aPointIndex;attribute float aEdgeCount;varying vec4 vColor;varying vec4 vPosition;varying vec4 vFragPosition;varying float vSize;varying float vEdgeIndex;varying float vPointIndex;varying float vEdgeCount;uniform mat4 uMatrix;uniform float uZoomUnits;uniform vec4 uSelectedColor;void main(){vColor=aColor;vEdgeIndex=aEdgeIndex;vEdgeCount=aEdgeCount;vPointIndex=aPointIndex;float z=aPos.z*uZoomUnits;float x=aPos.x;float y=aPos.y;vSize=aSize*uZoomUnits;float a=radians(360.0/aEdgeCount);float b=a/2.0;float i=aEdgeIndex;float j=aPointIndex;float angle=a*(i-1.0)+b;float r=vSize/cos(b);y=y+r*sin(angle);x=x+r*cos(angle);if(j==1.0){z=0.0;}vPosition=vec4(aPos.xyz,1.0);vFragPosition=vec4(x,y,z,1.0);gl_Position=uMatrix*vFragPosition;
#if defined(PICK)
if(mapvIsPicked()){vColor=uSelectedColor;}
#endif
}`,"varying vec4 vColor;varying float vEdgeIndex;varying float vPointIndex;varying float vEdgeCount;varying vec4 vPosition;varying vec4 vFragPosition;uniform mat4 uMatrix;void main(){vec4 color=vColor;color.a=1.0-vFragPosition.z/vPosition.z;gl_FragColor=color;}"]};y=y[a.type]||y.normal,this.program=new jr(this.gl,{vertexShader:y[0],fragmentShader:y[1],defines:a.enablePicked?["PICK"]:[]},this),this.buffer=new qe({gl:o,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.indexBuffer=new qe({gl:o,target:"ELEMENT_ARRAY_BUFFER",usage:"STATIC_DRAW"}),a=[{stride:44,name:"aPos",buffer:this.buffer,size:3,type:"FLOAT",offset:0},{stride:44,name:"aSize",buffer:this.buffer,size:1,type:"FLOAT",offset:12},{stride:44,name:"aEdgeIndex",buffer:this.buffer,size:1,type:"FLOAT",offset:16},{stride:44,name:"aPointIndex",buffer:this.buffer,size:1,type:"FLOAT",offset:20},{stride:44,name:"aEdgeCount",buffer:this.buffer,size:1,type:"FLOAT",offset:24},{stride:44,name:"aColor",buffer:this.buffer,size:4,type:"FLOAT",offset:28}],a=a.concat(this.getCommonAttributes()),this.vertexArray=new bi({gl:o,program:this.program,attributes:a})}},{key:"onChanged",value:function(o,a){this.gl&&a&&(this.uniforms={},this.data=a,this.options=o,this.processData(),o.enablePicked&&this.parsePickData(a))}},{key:"processData",value:function(){var o=[],a=[];this.options.type==="light"?this.createLightBuffer(this.data,o,a):this.createNormalBuffer(this.data,o,a),this.bufferData=o,this.indexData=a,this.buffer.updateData(new Float32Array(o)),this.indexBuffer.updateData(new Uint32Array(a))}},{key:"createNormalBuffer",value:function(o,a,y){var g=this,x=parseInt(this.options.edgeCount,10)||4;o.forEach(function(v,M){var D=v.color||g.options.color,U=v.size||g.options.size,C=Array.isArray(v.value)?v.value:typeof v.value=="number"?[v.value]:[1],L=g.normizedPoint(v.geometry.coordinates),B=v.height||g.options.height,O=C.reduce(function(V,Y){return Number(V)+Number(Y)}),k=0,j="blue";for(C.forEach(function(V,Y){j=g.normizedColor(typeof D=="function"?D(V,Y,C):Array.isArray(D)?D[Y]:D),V=typeof B=="function"?B(V,Y,C):Array.isArray(B)?B[Y]:B/O*V;var Q=y[y.length-1],nt=a.length/11;for(0<nt&&(x%2===1&&Y===0?y.push(Q,Q,nt):y.push(Q,nt)),Y=1;Y<=2*x;Y++)Y%2===0?a.push.apply(a,[L[0],L[1],k,U,Y/2,2,x].concat(Wr(j))):a.push.apply(a,[L[0],L[1],k+V,U,(Y+1)/2,1,x].concat(Wr(j))),y.push(nt+Y-1),Y===2*x&&(a.push.apply(a,[L[0],L[1],k+V,U,Y/2+1,1,x].concat(Wr(j))),a.push.apply(a,[L[0],L[1],k,U,Y/2+1,2,x].concat(Wr(j))),y.push(nt+Y,nt+Y+1));k+=V}),M=y[y.length-1],v=a.length/11,0<v&&y.push(M,v),M=1;M<=x;M++)a.push.apply(a,[L[0],L[1],k,U,-1,M,x].concat(Wr(j))),y.push(v+M-1)})}},{key:"createLightBuffer",value:function(o,a,y){var g=this,x=parseInt(this.options.edgeCount,10)||4;o.forEach(function(v,M){M=v.color||g.options.color,M=g.normizedColor(typeof M=="function"?M(v.value):typeof M=="string"?M:"blue");var D=v.size||g.options.size,U=g.normizedPoint(v.geometry.coordinates),C=v.height||g.options.height;for(C=typeof C=="function"?C(v.value):C,v=1;v<=x;v++){var L=y[y.length-1],B=a.length/11;for(0<B&&y.push(L,B),L=1;L<=2*x;L++)L%2===0?a.push.apply(a,[U[0],U[1],C,D,L/2,1,x].concat(Wr(M))):a.push.apply(a,[U[0],U[1],C,D,(L+1)/2,2,x].concat(Wr(M))),y.push(B+L-1),L===2*x&&y.push(B,B+1)}})}},{key:"render",value:function(o){var a=this.program,y=o.gl,g=o.matrix;this.setGLState({cullFace:this.options.type==="normal"}),a.use(y),this.vertexArray.bind(),this.indexBuffer.bind();var x=this.map.getZoomUnits();Vr(this.uniforms,this.getCommonUniforms(o),{uZoomUnits:this.options.unit==="px"?x:1,uMatrix:g}),a.setUniforms(this.uniforms),y.drawElements(y.TRIANGLE_STRIP,this.indexData.length,y.UNSIGNED_INT,0)}}]),h}(Ci),r_=function(l){function h(o){Xe(this,h);var a=_r(this,(h.__proto__||ur(h)).call(this,o));return o=a.getOptions(),a.fillPoint=new rp({enablePicked:o.enablePicked,autoSelect:o.autoSelect}),a.shadowPoint=new rp,a.textPoint=new Yl,a.children=[a.shadowPoint,a.fillPoint,a.textPoint],a}return yr(h,l),Ue(h,[{key:"pick",value:function(o,a){return this.fillPoint.pick(o,a)}},{key:"onOptionsChanged",value:function(o){this.shadowPoint.setOptions({depthTest:!1,polygonOffset:[1,1],color:o.shadowColor,size:o.shadowSize,borderWidth:o.shadowBorderWidth,borderColor:o.shadowBorderColor}),this.fillPoint.setOptions({onClick:function(a){o.onClick&&o.onClick(a)},selectedIndex:o.selectedIndex,selectedColor:o.selectedColor,depthTest:!1,color:o.fillColor,size:o.fillSize,borderWidth:o.fillBorderWidth,borderColor:o.fillBorderColor}),this.textPoint.setOptions({collides:!1,polygonOffset:[-1,-1],color:o.fontColor,fontFamily:o.fontFamily,fontSize:o.fontSize})}},{key:"onDataChanged",value:function(o){var a=this,y=this.getOptions(),g=JSON.parse(bl(o)).map(function(v){return v.properties.size=a.getProperty("shadowSize",y.shadowSize,v),v.properties.color=a.getProperty("shadowColor",y.shadowColor,v),v.properties.borderColor=a.getProperty("shadowBorderColor",y.shadowBorderColor,v),v.properties.borderWidth=a.getProperty("shadowBorderWidth",y.shadowBorderWidth,v),v}),x=JSON.parse(bl(o)).map(function(v){return v.properties.size=a.getProperty("fillSize",y.fillSize,v),v.properties.color=a.getProperty("fillColor",y.fillColor,v),v.properties.borderColor=a.getProperty("fillBorderColor",y.fillBorderColor,v),v.properties.borderWidth=a.getProperty("fillBorderWidth",y.fillBorderWidth,v),v});this.shadowPoint.setData(g),this.fillPoint.setData(x),this.textPoint.setData(o)}},{key:"getProperty",value:function(o,a,y){return Object.prototype.toString.call(a)==="[object Function]"?a(y):(a=y[o]||a,"properties"in y&&o in y.properties&&(a=y.properties[o]),a)}},{key:"getDefaultOptions",value:function(){return{enablePicked:!1,selectedIndex:-1,selectedColor:"#ffff00",autoSelect:!0,fillColor:"rgba(255, 50, 10, 1)",fillSize:20,fillBorderColor:"#ffffff",fillBorderWidth:1.2,shadowColor:"rgba(255, 80, 110, 0.7)",shadowSize:40,shadowBorderColor:"rgba(255, 80, 110, 1)",shadowBorderWidth:1.2,fontSize:12,fontFamily:"Microsoft Yahei",fontColor:"#ffffff"}}}]),h}(da),i_=function(l){function h(o,a){return Xe(this,h),o=_r(this,(h.__proto__||ur(h)).call(this,o,a)),o.name="MaskLayer",o.bufferData=[],o.indices=[],o}return yr(h,l),Ue(h,[{key:"getDefaultOptions",value:function(){return{blend:"deeper",color:"rgba(100, 100, 100, 0.6)",height:0,polygonOffset:[0,0],depthTest:!1,depthWrite:!1}}},{key:"initialize",value:function(o){this.gl=o,this.program=new jr(this.gl,{vertexShader:"precision highp float;attribute vec2 a_position;uniform mat4 u_matrix;uniform float u_height;void main(){vec4 position=u_matrix*vec4(a_position.xy,u_height,1.0);gl_Position=position;}",fragmentShader:"precision highp float;uniform vec4 u_color;void main(){gl_FragColor=u_color;}",defines:[]},this),this.vertexBuffer=new qe({gl:o,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.indexBuffer=new qe({gl:o,target:"ELEMENT_ARRAY_BUFFER",usage:"STATIC_DRAW"});var a=[{stride:8,name:"a_position",buffer:this.vertexBuffer,size:2,type:"FLOAT",offset:0}];a=a.concat(this.getCommonAttributes()),this.vertexArray=new bi({gl:o,program:this.program,attributes:a})}},{key:"onDestroy",value:function(){this.bufferData=[],this.index=[]}},{key:"onChanged",value:function(o,a){var y=this;if(this.gl){o=[];for(var g=[],x=0;x<a.length;x++)if(a[x].geometry.coordinates){var v=[[this.normizedPoint([-180,-90]),this.normizedPoint([180,-90]),this.normizedPoint([180,90]),this.normizedPoint([-180,90])]],M=[];if(a[x].geometry.type==="LineString"&&(M=[a[x].geometry.coordinates.map(function(C){return y.normizedPoint(C)})]),a[x].geometry.type==="MultiPolygon")for(var D=a[x].geometry.coordinates,U=0;U<D.length;U++)M=M.concat(D[U].map(function(C){return C.map(function(L){return y.normizedPoint(L)})}));else for(D=0;D<a[x].geometry.coordinates.length;D++)M.push(a[x].geometry.coordinates[D].map(function(C){return y.normizedPoint(C)}));for(M=ke.flatten(v.concat(M)),v=M.vertices,M=M.holes,D=[],U=0;U<v.length;U+=3)D.push(v[U+0],v[U+1]);this.parseBufferData(o,g,D,M)}this.bufferData=o,this.index=g,this.vertexBuffer.updateData(new Float32Array(o)),this.indexBuffer.updateData(new Uint32Array(g))}}},{key:"parseBufferData",value:function(o,a,y,g){var x=o.length/2;for(g=g&&g.length?ke(y,g,2):ke(y),o.push.apply(o,Wr(y)),o=0;o<g.length;o++)a.push(g[o]+x)}},{key:"render",value:function(o){if(this.index&&this.index.length){var a=o.gl,y=o.matrix,g=this.getOptions(),x=this.program;x.use(a),o=Vr(this.getCommonUniforms(o),{u_matrix:y,u_height:g.height,u_color:this.normizedColor(g.color)}),x.setUniforms(o),this.setGLState({blend:!0,blendFunc:$s(a,g.blend),polygonOffset:g.polygonOffset,depthTest:g.depthTest,depthMask:g.depthWrite}),this.indexBuffer.bind(),this.vertexArray.bind(),a.drawElements(a.TRIANGLES,this.index.length,a.UNSIGNED_INT,0)}}}]),h}(Ci),an=function(l){function h(){return Xe(this,h),_r(this,(h.__proto__||ur(h)).apply(this,arguments))}return yr(h,l),Ue(h,[{key:"toBBox",value:function(o){var a=Ri(o.item.geometry.coordinates,2);return o=a[0],a=a[1],{minX:o,minY:a,maxX:o,maxY:a}}},{key:"compareMinX",value:function(o,a){return o.item.geometry.coordinates[0]-a.item.geometry.coordinates[0]}},{key:"compareMinY",value:function(o,a){return o.item.geometry.coordinates[1]-a.item.geometry.coordinates[1]}}]),h}(Wu),ao=function(l){function h(o,a){return Xe(this,h),o=_r(this,(h.__proto__||ur(h)).call(this,o,a)),o.name="PointCanvasCustomLayer",a=o.canvas=document.createElement("canvas"),o.ctx=a.getContext("2d"),o.geoRBush=new an,o}return yr(h,l),Ue(h,[{key:"getDefaultOptions",value:function(){return{depthWrite:!1,depthTest:!0,color:"#fff",fontFamily:"Microsoft Yahei",fontSize:14,flat:!1,collides:!0,unit:"px",angle:0,offset:[0,0],padding:[2,2],margin:[0,0],polygonOffset:[0,0],itemDimension:[20,20],renderItem:this.defaultOptionRenderItem}}},{key:"defaultOptionRenderItem",value:function(o,a,y){y.fillStyle="red",y.fillRect(a.x,a.y,a.w,a.h)}},{key:"initialize",value:function(o){this.gl=o;var a=this.getOptions();this.texture=null,this.lastUpdateTime=0,this.program=new jr(this.gl,{vertexShader:"precision highp float;uniform mat4 matrix;uniform bool uFlat;uniform bool uUnitPx;uniform float zoomUnits;uniform float devicePixelRatio;uniform float zIndex;uniform vec2 offset;attribute vec3 position;attribute float corner;attribute float scale;attribute float rotation;attribute vec2 size;attribute vec2 aTextCoord;varying vec2 vTextCoord;/***\u70B9A(x,y)\uFF0C\u7ED5\u539F\u70B9\u987A\u65F6\u9488\u65CB\u8F6C\u89D2\u5EA6a\u65B0\u5750\u6807\u7684\u8BA1\u7B97\u516C\u5F0F*x1=x*cos(a)+y*sin(a)*y1=y*cos(a)-x*sin(a)*/vec3 transformCoord(vec3 coord,vec2 size,float corner){float x=coord.x;float y=coord.y;if(corner==1.0){x+=-size.x*cos(rotation)+size.y*sin(rotation);y+=size.y*cos(rotation)+size.x*sin(rotation);}else if(corner==2.0){x+=size.x*cos(rotation)+size.y*sin(rotation);y+=size.y*cos(rotation)-size.x*sin(rotation);}else if(corner==3.0){x+=size.x*cos(rotation)-size.y*sin(rotation);y+=-size.y*cos(rotation)-size.x*sin(rotation);}else{x+=-size.x*cos(rotation)-size.y*sin(rotation);y+=-size.y*cos(rotation)+size.x*sin(rotation);}return vec3(x,y,coord.z);}void main(){vTextCoord=aTextCoord;if(uFlat){vec2 pixelOffset=offset;vec2 halfSize=size/2.0*scale;if(uUnitPx){halfSize*=zoomUnits;pixelOffset*=zoomUnits;}vec3 current=transformCoord(position,halfSize,corner);current.z+=zIndex;gl_Position=matrix*vec4(current.x+pixelOffset[0],current.y-pixelOffset[1],current.z,1.0);}else{vec2 pixelOffset=offset*zoomUnits;vec4 projection=matrix*vec4(position.x+pixelOffset[0],position.y-pixelOffset[1],position.z,1.0);vec3 screen=projection.xyz/projection.w;vec2 halfSize=size/MAPV_resolution*devicePixelRatio*scale;vec3 current=transformCoord(screen,halfSize,corner);current.z+=zIndex;gl_Position=vec4(current,1.0);}}",fragmentShader:`precision highp float;uniform sampler2D textureImage;uniform vec4 uSelectedColor;varying vec2 vTextCoord;void main(){gl_FragColor=texture2D(textureImage,vec2(vTextCoord.x,1.0-vTextCoord.y));
#if defined(PICK)
if(mapvIsPicked()){gl_FragColor=vec4(uSelectedColor.rgb,gl_FragColor.a);}
#endif
}`,defines:a.enablePicked?["PICK"]:[]},this),this.vertexBuffer=new qe({gl:o,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.uvBuffer=new qe({gl:o,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.indexBuffer=new qe({gl:o,target:"ELEMENT_ARRAY_BUFFER",usage:"STATIC_DRAW"}),a=[{name:"position",buffer:this.vertexBuffer,size:3,stride:32,type:"FLOAT",offset:0},{name:"corner",buffer:this.vertexBuffer,size:1,stride:32,type:"FLOAT",offset:12},{name:"size",buffer:this.vertexBuffer,size:2,stride:32,type:"FLOAT",offset:16},{name:"scale",buffer:this.vertexBuffer,size:1,stride:32,type:"FLOAT",offset:24},{name:"rotation",buffer:this.vertexBuffer,size:1,stride:32,type:"FLOAT",offset:28},{name:"aTextCoord",buffer:this.uvBuffer,size:2,stride:8,type:"FLOAT",offset:0}],a=a.concat(this.getCommonAttributes()),this.vertexArray=new bi({gl:o,program:this.program,attributes:a})}},{key:"onDestroy",value:function(){}},{key:"onChanged",value:function(o,a){this.gl&&this.processCache(o,a)}},{key:"processCache",value:function(o,a){for(this.cachedData=[],this.geoRBush.clear(),o=0;o<a.length;o++){var y=a[o],g=this.normizedPoint(y.geometry.coordinates);g&&this.cachedData.push({point:g,item:y,extra:{},index:o})}this.geoRBush.load(this.cachedData)}},{key:"render",value:function(o){if(this.cachedData&&this.cachedData.length&&this.map){var a=o.gl,y=o.matrix,g=this.getOptions(),x=this.program;x.use(a),this.throttleUpdate(o),this.setGLState({blend:!0,blendEquation:a.FUNC_ADD,blendFunc:[a.SRC_ALPHA,a.ONE_MINUS_SRC_ALPHA],polygonOffset:g.polygonOffset,depthTest:g.depthTest,depthMask:g.depthWrite});var v=this.map.getZoomUnits();x.setUniforms(Vr(this.getCommonUniforms(o),{matrix:y,devicePixelRatio:window.devicePixelRatio,textureImage:this.texture,uFlat:g.flat,offset:g.offset,zoomUnits:v,zIndex:g.zIndex,uUnitPx:g.unit==="px"})),0<this.index.length&&(this.indexBuffer.bind(),this.vertexArray.bind(),a.drawElements(a.TRIANGLES,this.index.length,a.UNSIGNED_INT,0))}}},{key:"throttleUpdate",value:function(o){this.updateText(o)}},{key:"updateText",value:function(o){var a=o.gl,y=o.matrix,g=this.getOptions(),x=g.padding,v=g.margin,M=g.collides;o=g.enablePicked;var D=g.itemDimension,U=g.beforeRenderAll,C=g.beforeComputeDimension;g=g.renderItem;var L=this.map.getBounds(),B=a.canvas.width/window.devicePixelRatio,O=a.canvas.height/window.devicePixelRatio,k=this.canvas;a=this.ctx,a.save(),a.scale(window.devicePixelRatio,window.devicePixelRatio),C&&C(a),L=this.geoRBush.search({minX:L.sw.lng,minY:L.sw.lat,maxX:L.ne.lng,maxY:L.ne.lat});var j=new Wu;C=[];for(var V=0;V<L.length;V++){var Y=L[V],Q=Y.point,nt=Y.item,ut=Y.extra;Y=Y.index;var ct=Ri(Q,3);ct=on.clone([ct[0],ct[1],ct[2],1]),on.transformMat4(ct,ct,y),on.scale(ct,ct,1/ct[3]);var Tt=(ct[0]+1)/2*B,Lt=(-ct[1]+1)/2*O,Dt=Array.isArray(D)?D:D(nt,a,ut);ct=Dt[0]+2*x[0],Dt=Dt[1]+2*x[1];var ae=ct+v[0],ne=Dt+v[1];if(Tt-=ae/2,Lt-=ne/2,ae=Tt+ae,ne=Lt+ne,!(0>ae||0>ne||Tt>B||Lt>O)){if(M){if(ne={minX:Tt,maxX:ae,minY:Lt,maxY:ne},j.collides(ne))continue;j.insert(ne)}C.push({w:ct,h:Dt,point:Q,item:nt,extra:ut,dataIndex:Y})}}for(a.restore(),x=Iu(C),y=x.w,x=x.h,0>=y&&(y=1),0>=x&&(x=1),k.width=y*window.devicePixelRatio,k.height=x*window.devicePixelRatio,a.save(),a.scale(window.devicePixelRatio,window.devicePixelRatio),U&&U(a),U=[],k=[],v=[],M=[],D=0,B=C.length;D<B;++D){for(O=C[D],g(O.item,O,a,O.extra),V=Ri(O.point,3),L=V[0],j=V[1],V=V[2],Q=0;4>Q;Q++)U.push(L,j,V),U.push(Q),U.push(O.w,O.h),U.push(1,0);L=O.x/y,j=(O.x+O.w)/y,V=(O.y+O.h)/x,Q=O.y/x,k.push(L,V,L,Q,j,Q,j,V),L=4*D,v.push(L,L+2,L+1,L,L+3,L+2),o&&(O=this.indexToRgb(O.dataIndex),M.push(O[0]/255,O[1]/255,O[2]/255),M.push(O[0]/255,O[1]/255,O[2]/255),M.push(O[0]/255,O[1]/255,O[2]/255),M.push(O[0]/255,O[1]/255,O[2]/255))}a.restore(),this.loadTexture(),this.index=v,this.vertexBuffer.updateData(new Float32Array(U)),this.uvBuffer.updateData(new Float32Array(k)),this.indexBuffer.updateData(new Uint32Array(v)),o&&this.pickBuffer.updateData(new Float32Array(M))}},{key:"loadTexture",value:function(){var o=this;this.canvas?xn(this.gl,this.canvas,function(a){o.texture=a},{TEXTURE_WRAP_S:"CLAMP_TO_EDGE",TEXTURE_WRAP_T:"CLAMP_TO_EDGE"}):this.texture=null}}]),h}(Ci),np=function(){function l(h,o){Xe(this,l),this.name="Mask",this.webglLayer=h,this.options=o||{},this.bufferData=[],this.indices=[]}return Ue(l,[{key:"initialize",value:function(h){return this.gl=h,this.program=new jr(this.gl,{vertexShader:"precision highp float;attribute vec2 a_position;uniform mat4 u_matrix;uniform float u_height;void main(){vec4 position=u_matrix*vec4(a_position.xy,u_height,1.0);gl_Position=position;}",fragmentShader:"precision highp float;uniform vec4 u_color;void main(){gl_FragColor=u_color;}",defines:[]},this),this.vertexBuffer=new qe({gl:h,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.indexBuffer=new qe({gl:h,target:"ELEMENT_ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.vertexArray=new bi({gl:h,program:this.program,attributes:[{stride:8,name:"a_position",buffer:this.vertexBuffer,size:2,type:"FLOAT",offset:0}]}),this}},{key:"onDestroy",value:function(){this.bufferData=[],this.index=[]}},{key:"setData",value:function(h){var o=this;if(this.gl){for(var a=[],y=[],g=0;g<h.length;g++)if(h[g].geometry.coordinates){var x=[];if(h[g].geometry.type==="LineString"&&(x=[h[g].geometry.coordinates.map(function(U){return o.normizedPoint(U)})]),h[g].geometry.type==="MultiPolygon")for(var v=h[g].geometry.coordinates,M=0;M<v.length;M++)x=x.concat(v[M].map(function(U){return U.map(function(C){return o.normizedPoint(C)})}));else for(v=0;v<h[g].geometry.coordinates.length;v++)x.push(h[g].geometry.coordinates[v].map(function(U){return o.normizedPoint(U)}));v=ke.flatten(x),x=v.vertices,v=v.holes,M=[];for(var D=0;D<x.length;D+=3)M.push(x[D+0],x[D+1]);this.parseBufferData(a,y,M,v)}return this.bufferData=a,this.index=y,this.vertexBuffer.updateData(new Float32Array(a)),this.indexBuffer.updateData(new Uint32Array(y)),this}}},{key:"parseBufferData",value:function(h,o,a,y){var g=h.length/2;for(y=y&&y.length?ke(a,y,2):ke(a),h.push.apply(h,Wr(a)),h=0;h<y.length;h++)o.push(y[h]+g)}},{key:"render",value:function(h){if(this.index&&this.index.length){var o=h.gl,a=h.matrix,y=this.options;h=this.program,h.use(o),a={u_matrix:a,u_height:y.height||0,u_color:this.normizedColor(y.color)},h.setUniforms(a),this.indexBuffer.bind(),this.vertexArray.bind(),o.drawElements(o.TRIANGLES,this.index.length,o.UNSIGNED_INT,0)}}},{key:"normizedColor",value:function(h){var o=h;return h instanceof Array||(o=Jt(h).unitArray()),o[3]===void 0&&(o[3]=1),o}},{key:"normizedPoint",value:function(h){var o=this.getPointOffset();if(!h||!h[0]||!h[1])return[o[0],o[1],0];var a=Number(h[0]),y=Number(h[1]);-180<=a&&180>=a&&-90<=y&&90>=y&&(y=this.webglLayer.map.lnglatToMercator(a,y),a=y[0],y=y[1]);var g=Number(h[2])||0;return this.webglLayer&&this.webglLayer.options.mapType==="cesium"&&window.Cesium?(a=this.convertLngLat([a,y]),g=window.Cesium.Cartesian3.fromDegrees(a[0],a[1],g),a=g.x,y=g.y,g=g.z):this.webglLayer&&this.webglLayer.options.mapType==="bmapgl"&&this.webglLayer.map.map.mapType==="B_EARTH_MAP"&&(a=this.convertLngLat([a,y]),g=this.webglLayer.map.map.getEarth().scene.fromLatLngToXYZ({lng:a[0],lat:a[1]}),a=g.x,y=g.y,g=g.z),3<h.length?[a-o[0],y-o[1],g].concat(Wr(h.slice(3))):[a-o[0],y-o[1],g]}},{key:"convertLngLat",value:function(h){return[h[0]/2003750834e-2*180,180/Math.PI*(2*Math.atan(Math.exp(h[1]/2003750834e-2*180*Math.PI/180))-Math.PI/2)]}},{key:"getPointOffset",value:function(){var h=[0,0],o=this.options;return this.webglLayer&&this.webglLayer.options.pointOffset?h=this.webglLayer.options.pointOffset:o.pointOffset&&(h=o.pointOffset),h}}]),l}(),ti=function(l){function h(o,a){return Xe(this,h),_r(this,(h.__proto__||ur(h)).call(this,o,a))}return yr(h,l),Ue(h,[{key:"getDefaultOptions",value:function(){return{}}},{key:"initialize",value:function(o){var a=this.getOptions();if(a.source&&a.source.image&&a.domain&&(typeof a.source.image=="string"||a.source.width&&a.source.height)){var y=a.refColors,g=a.refImage;if((y||g)&&(!y||y.colors&&y.positions)&&(!g||typeof g.url=="string")){this.gl=o;var x=[];y?this.imageData=ag(y.colors,y.positions,y.clamp,y.color,y.height):(this.imageData={data:g.url},x.push("USE_IMAGE_TEXTURE"),this.imageTexture=!0),a.isTerrain&&(this.isTerrain=a.isTerrain,x.push("USE_TERRAIN"),this.gridRowMax=1600,a.gridRowMax&&(this.gridRowMax=a.gridRowMax),this.gridColMax=1600,a.gridColMax&&(this.gridColMax=a.gridColMax)),this.texture=null,y=`
        float generateValue(vec4 rgba){
            return rgba.r;
        }`,a.fomularC&&(y=a.fomularC),a=`precision highp float;attribute vec3 a_pos;attribute vec2 a_texture_coord;uniform mat4 u_proj_matrix;uniform mat4 u_mv_matrix;uniform sampler2D uTile;uniform float u_baseLine;uniform float u_elevationScale;varying vec2 v_texture_coord;void main(){v_texture_coord=a_texture_coord;vec3 pos=a_pos.xyz;
#if defined(USE_TERRAIN)
vec4 terrainColor=texture2D(uTile,vec2(a_texture_coord.s,a_texture_coord.t));float value=generateValue(terrainColor);float h=(value-u_baseLine)*u_elevationScale;pos.z=max(0.,h);
#endif
vec4 position=u_proj_matrix*u_mv_matrix*vec4(pos,1.0);gl_Position=position;}`.replace("void main()",y+`
void main()`),y=`precision highp float;varying vec2 v_texture_coord;uniform sampler2D uTile;uniform sampler2D uColorRamp;uniform bool uUseFilter;uniform vec4 uFilterColor;uniform float u_opacity;uniform float u_noData;uniform vec3 u_noTextureData;uniform vec2 u_clamp;uniform vec2 u_domain;uniform vec3 u_linearOpacity;uniform bool u_isOneBand;uniform float u_brightness;uniform float u_contrast;uniform float u_exposure;uniform float u_saturation;vec4 indexToRgba(float value){float index=value;float b=floor(index/65536.);index-=b*65536.;float g=floor(index/256.);index-=g*256.;float r=index;return vec4(r,g,b,255.);}vec3 adjustBrightness(vec3 color,float value){return color+value;}vec3 adjustContrast(vec3 color,float value){return 0.5+(1.0+value)*(color-0.5);}vec3 adjustExposure(vec3 color,float value){return color*(1.0+value);}vec3 adjustSaturation(vec3 color,float value){const vec3 luminosityFactor=vec3(0.2126,0.7152,0.0722);vec3 grayscale=vec3(dot(color,luminosityFactor));return mix(grayscale,color,1.0+value);}void main(){vec4 data=texture2D(uTile,vec2(v_texture_coord.s,v_texture_coord.t));float value=generateValue(data);vec4 textureColor=vec4(0,0,0,0);if(value>=u_clamp.s&&value<=u_clamp.t){float normalisedValue=(value-u_domain.s)/(u_domain.t-u_domain.s);
#if defined(USE_IMAGE_TEXTURE)
vec4 color=texture2D(uColorRamp,vec2(v_texture_coord.s,v_texture_coord.t));if(vec3(color.rgb)==u_noTextureData){color=vec4(0,0,0,0);}
#else
vec4 color=texture2D(uColorRamp,vec2(normalisedValue,0));
#endif
color.a=smoothstep(u_linearOpacity.s,u_linearOpacity.t,color.a*normalisedValue)+u_linearOpacity.p;textureColor=color;textureColor.a=textureColor.a*u_opacity;vec3 mixColor=adjustBrightness(textureColor.rgb,u_brightness);mixColor=adjustContrast(mixColor,u_contrast);mixColor=adjustExposure(mixColor,u_exposure);mixColor=adjustSaturation(mixColor,u_saturation);textureColor=vec4(mixColor,textureColor.a);if(uIsPickRender&&u_isOneBand){textureColor=indexToRgba(value)/255.;}if(uIsPickRender&&!u_isOneBand){textureColor=data;}}if(value==u_noData){textureColor=vec4(0,0,0,0);}if(uUseFilter){textureColor=textureColor*uFilterColor;}gl_FragColor=textureColor;}`.replace("void main()",y+`
void main()`),this.program=new jr(this.gl,{vertexShader:a,fragmentShader:y,defines:x},this),this.vertexBuffer=new qe({gl:o,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.indexBuffer=new qe({gl:o,target:"ELEMENT_ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.vertexArray=new bi({gl:o,program:this.program,attributes:[{name:"a_pos",buffer:this.vertexBuffer,stride:20,size:3,type:"FLOAT",offset:0},{name:"a_texture_coord",buffer:this.vertexBuffer,size:2,stride:20,type:"FLOAT",offset:12}]})}}}},{key:"onChanged",value:function(o,a){var y=this;this.gl&&(this.loadDataTexture&&clearTimeout(this.loadDataTexture),this.loadDataTexture=setTimeout(function(){y.loadTexture(function(){y.parseData(a),y.webglLayer.render()})},0))}},{key:"drawMask",value:function(o){var a=o.gl,y=o.matrix,g=o.projectionMatrix,x=o.viewMatrix;if(o=o.polygons){var v=new np(this.webglLayer,{color:"rgba(19, 14, 7, 0.8)"});this.setGLState({stencilTest:!0,depthTest:!1,depthMask:!1}),a.clear(a.STENCIL_BUFFER_BIT),a.stencilFunc(a.ALWAYS,1,255),a.stencilOp(a.KEEP,a.KEEP,a.REPLACE),a.colorMask(!1,!1,!1,!1),v.initialize(a).setData(o).render({gl:a,matrix:y,projectionMatrix:g,viewMatrix:x})}}},{key:"onOptionsChanged",value:function(o,a){this.gl&&(this.initialize(this.gl),this.loadTexture(),this.webglLayer.render())}},{key:"render",value:function(o){var a=o.gl,y=o.matrix,g=o.projectionMatrix,x=o.viewMatrix,v=o.isPickRender;o=this.getOptions();var M=this.program;(M||this.texture)&&(o.stencilData&&this.drawMask({gl:a,matrix:y,projectionMatrix:g,viewMatrix:x,polygons:o.stencilData}),this.setGLState({blend:!0,blendEquation:a.FUNC_ADD,blendFunc:[a.SRC_ALPHA,a.ONE_MINUS_SRC_ALPHA],stencilTest:!!o.stencilData,depthTest:o.depthTest,depthMask:o.depthMask}),M.use(a),o.stencilData&&(a.stencilFunc(a.EQUAL,1,1),a.stencilOp(a.KEEP,a.KEEP,a.KEEP),a.colorMask(!0,!0,!0,!0)),this.colorRamp&&this.texture&&(y=[0,0,0],o.linearOpacity&&this.formaLinear(o.linearOpacity,y),g={uColorRamp:this.colorRamp,uTile:this.texture,u_proj_matrix:g,uUseFilter:!!o.filterColor,uFilterColor:this.normizedColor(o.filterColor||"rgba(0, 0, 100, 1.0)"),u_mv_matrix:x,uIsPickRender:!!v,u_noData:o.noData||-99999,u_domain:o.domain,u_clamp:o.clamp?o.clamp:o.domain,u_linearOpacity:y,u_opacity:o.opacity||1,u_isOneBand:!!this.isOneBand,u_brightness:o.brightness||0,u_contrast:o.contrast||0,u_exposure:o.exposure||0,u_saturation:o.saturation||0},this.isTerrain&&(g.u_baseLine=o.baseLine||0,g.u_elevationScale=o.elevationScale||1),this.imageTexture&&(g.u_noTextureData=o.baseLine||0),M.setUniforms(g),this.index&&0<this.index.length&&(this.indexBuffer.bind(),this.vertexArray.bind(),a.drawElements(a.TRIANGLES,this.index.length,a.UNSIGNED_INT,0)),o.stencilData&&!o.stencilAfter&&(a.clear(a.STENCIL_BUFFER_BIT),a.stencilMask(255),a.stencilFunc(a.ALWAYS,1,255))))}},{key:"onDestroy",value:function(){this.texturePixels=this.texture=this.colorRamp=this.indexBuffer=this.vertexBuffer=this.index=this.program=null}},{key:"pickAfter",value:function(o,a){var y,g;return this.isOneBand?(a=y=g=a,o=1):(a=o[0],y=o[1],g=o[2],o=o[3]),this.getOptions().fomularJS?this.getOptions().fomularJS({r:a,g:y,b:g,a:o}):a}},{key:"formaLinear",value:function(o,a){o.start&&(a[0]=o.start||0),o.end&&(a[1]=o.end||0),o.base&&(a[2]=o.base||0)}},{key:"loadTexture",value:function(o){var a=this,y=this.getOptions();y.source.image&&this.imageData?xn(this.gl,this.imageData.data,function(g,x){a.colorRamp=g,kn(y.source.image)==="object"?(a.isOneBand=!0,xn(a.gl,y.source.image,function(v,M,D){a.texture=v,a.texturePixels=D,a.textureWidth=D.width,a.textureHeight=D.height,o&&o(),a.webglLayer.render()},{TEXTURE_MIN_FILTER:"NEAREST",TEXTURE_MAG_FILTER:"NEAREST",TEXTURE_WRAP_S:"CLAMP_TO_EDGE",TEXTURE_WRAP_T:"CLAMP_TO_EDGE"},{width:y.source.width,height:y.source.height,format:"LUMINANCE",type:"FLOAT"})):(a.isOneBand=!1,xn(a.gl,y.source.image,function(v,M,D){a.texture=v,a.texturePixels=D,a.textureWidth=D.width,a.textureHeight=D.height,o&&o(),a.webglLayer.render()},{TEXTURE_WRAP_S:"CLAMP_TO_EDGE",TEXTURE_WRAP_T:"CLAMP_TO_EDGE"}))},{TEXTURE_WRAP_S:"CLAMP_TO_EDGE",TEXTURE_WRAP_T:"CLAMP_TO_EDGE"},{width:this.imageData.width,height:this.imageData.height,flipY:!0,format:"RGBA",type:"UNSIGNED_BYTE"}):(this.texture=null,o&&o())}},{key:"parseData",value:function(o){var a=this;if(this.vertexBuffer){var y=[],g=[];if(o&&o[0]){var x=o[0].geometry.coordinates[0];x=x.map(function(j){return a.normizedPoint(j)}),o=x[0][0];var v=x[0][1],M=x[2][0],D=x[2][1];this.bound=[o,v,M,D],this.gridRowMax>this.textureHeight&&(this.gridRowMax=this.textureHeight),this.gridColMax>this.textureWidth&&(this.gridColMax=this.textureWidth),x=this.isTerrain?this.gridColMax:1;var U=this.isTerrain?this.gridRowMax:1,C=x+1;M=(M-o)/x,D=(D-v)/U;for(var L=0;L<=U;L++)for(var B=0;B<=x;B++)if(y.push(o+M*B,v+D*L,0),y.push(B/x,L/U),B<x&&L<U){var O=C*L+B,k=C*(L+1)+B;g.push(O,k+1,O+1),g.push(O,k,k+1)}}this.index=g,this.vertexBuffer.updateData(new Float32Array(y)),this.indexBuffer.updateData(new Uint32Array(g))}}},{key:"getValue",value:function(o,a){return this.isTerrain&&o&&this.bound&&(o=this.normizedPoint(o),this.containsPoint(o,this.bound)&&(o=this.uvPoint(o,this.bound),a=this.pixelByUV(o,a,this.getOptions().fomularJS),a.result))?a:0}},{key:"containsPoint",value:function(o,a){if(o)return o[0]>=a[0]&&o[0]<=a[2]&&o[1]>=a[1]&&o[1]<=a[3]}},{key:"uvPoint",value:function(o,a){if(o)return[(o[0]-a[0])/(a[2]-a[0]),(a[3]-o[1])/(a[3]-a[1])]}},{key:"pixelByUV",value:function(o,a,y){if(this.texturePixels){var g=this.texturePixels,x=g.width,v=g.height,M=g.data,D=Math.floor(o[0]*(x-1));o=Math.floor(o[1]*(v-1));var U=1;return g.type==="RGBA"&&(U=4),this._getPixelBound(D,o,a,x,v,M,U,y)}return null}},{key:"_getPixelBound",value:function(o,a,y,g,x,v,M,D){var U=o-y;0>U&&(U=0),o+=y,o>g-1&&(o=g-1);var C=a-y;0>C&&(C=0),a+=y,a>x-1&&(a=x-1),y=x=0;for(var L=[0,0,0,1],B=U;B<=o;B++)for(var O=C;O<=a;O++){var k=(O*g+B)*M,j=v[k],V=v[k+this.min(0,M-3)],Y=v[k+this.min(0,M-2)];k=M===4?v[k+3]:1;var Q=D?D({r:j,g:V,b:Y,a:k}):j;Q>x&&(x=Q,L=[j,V,Y,k]),y+=Q}return{result:y/((o-U+1)*(a-C+1)),pixel:L,max:x}}},{key:"min",value:function(o,a){return a<o?o:a}}]),h}(Ci);window._hmt=window._hmt||[],function(){var l=document.createElement("script");l.src="https://hm.baidu.com/hm.js?e8002ef3d9e0d8274b5b74cc4a027d08";var h=document.getElementsByTagName("script")[0];h.parentNode.insertBefore(l,h)}(),Z.View=Xl,Z.CanvasLayer=tt,Z.CircleLayer=function l(){var h=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return Xe(this,l),iv.includes(h.type)?new j1(h):new V1(h)},Z.GridLayer=bf,Z.HeatGridLayer=Z1,Z.ShapeLayer=Uf,Z.SimpleLineLayer=q1,Z.LineLayer3D=J1,Z.LineLayer=Dd,Z.LineRainbowLayer=FA,Z.WallSpriteLayer=kf,Z.LinePointLayer=Ju,Z.WallLayer=zd,Z.WallTripLayer=UA,Z.HeatLineLayer=bA,Z.HoneycombLayer=kA,Z.WebglLayer=ev,Z.PointLayer=rp,Z.GroundRippleLayer=py,Z.RippleLayer=dy,Z.SparkLayer=my,Z.ClusterLayer=HA,Z.HeatPointLayer=vv,Z.ShapeLineLayer=GA,Z.PointTripLayer=eu,Z.LineTripLayer=On,Z.IconCollidesLayer=VA,Z.LineFlowLayer=Si,Z.TileLayer=yv,Z.IconLayer=gy,Z.BoardLayer=WA,Z.PolygonLayer=jA,Z.CarLineLayer=KA,Z.Layer=Ci,Z.TextLayer=Yl,Z.BoardTextLayer=Qu,Z.LabelLayer=$A,Z.TrafficLayer=t_,Z.GltfLayer=Or,Z.HeatmapLayer=e_,Z.BarLayer=fc,Z.MarkerListLayer=r_,Z.MaskLayer=i_,Z.PointCanvasCustomLayer=ao,Z.PixelLayer=ti,Z.FXAA=DA,Z.SMAA=Qg,Z.BlurEffect=Kg,Z.BloomEffect=b1,Z.BrightEffect=k1,Z.DepthEffect=OA,Z.EffectManager=$h,Z.getContext=wh,Z.createTexture=Ge,Z.loadTextureImage=xn,Z.getBlend=$s,Z.FrameBufferObject=Zn,Z.Program=jr,Z.StateManager=Jg,Z.Buffer=qe,Z.VertexArray=bi,Z.CommonLayer=ca,Z.MercatorProjection=Mr,Z.Canvas=Ln,Z.Intensity=Li,Z.BezierCurve=li,Z.GeodesicCurve=yn,Z.OdCurve=Wa,Z.utilCity={getProvinceNameByCityName:function(l){for(var h=0;h<sa.length;h++)for(var o=sa[h].n,a=sa[h].cities,y=0;y<a.length;y++)if(a[y].n==l)return o;return null},getCenterByCityName:function(l){l=l.replace("\u5E02","");for(var h=0;h<Tf.length;h++)if(Tf[h].n==l)return Ks(Tf[h].g);for(h=0;h<Sf.length;h++)if(Sf[h].n==l)return Ks(Sf[h].g);for(h=0;h<sa.length;h++){if(sa[h].n==l)return Ks(sa[h].g);for(var o=sa[h].cities,a=0;a<o.length;a++)if(o[a].n==l)return Ks(o[a].g)}return null}},Z.isMobile=ja,Z.Encryptor={encode:function(l){l=zf.deflateRaw(l);for(var h=[],o=0;o<l.length;o++)h.push(l[o]^23);return new Uint8Array(h)},decode:function(l){l=new Uint8Array(l);for(var h=[],o=0;o<l.length;o++)h.push(l[o]^23);l=new Uint8Array(h);try{var a=window.flate.deflate_decode_raw(l);return new TextDecoder("utf-8").decode(a)}catch{return console.warn("inflate by pako!"),zf.inflateRaw(l,{to:"string"})}},download:function(l,h){var o=new Blob([l],{type:"application/octet-binary"});l=document.createElement("a"),o=window.URL.createObjectURL(o),l.href=o,l.download=h||"mapvgl_download",l.click()}},Z.createFusionView=function(l,h){var o=void 0,a=!1;l.addEventListener("glmoduleloaded",function(y){a||(a=!0,setTimeout(function(){o=new Xl({cameraNear:10,cameraFar:4e3,gl:l._webglPainter.gl,canvas:l._webglPainter.gl.canvas,autoUpdate:!1,map:l}),o.webglLayer.canvas.style.zIndex=1;var g=o.webglLayer.stateManager;l.insertRender=function(){g.setState({blend:!0,depthTest:!1}),o.render()},h&&h(o)},3e3))}),setTimeout(function(){if(!a&&l._webglMapScene&&l._webglPainter&&l._webglPainter.gl&&l._webglPainter.gl.canvas){a=!0,o=new Xl({cameraNear:10,cameraFar:4e3,gl:l._webglPainter.gl,canvas:l._webglPainter.gl.canvas,autoUpdate:!1,map:l}),o.webglLayer.canvas.style.zIndex=1;var y=o.webglLayer.stateManager;l.insertRender=function(){y.setState({blend:!0,depthTest:!1}),o.render()},h&&h(o)}},4e3)},Z.toRadian=ye,Z.toAngle=dt,Z.ceilPowerOfTwo=Me,Z.floorPowerOfTwo=vr,Z.approximatelyEqual=Tr,Z.isClosed=fe,Z.generateColorRamp=ag,Z.__moduleExports=vs,Z.vec4=on,Z.vec3=dr,Z.vec2=Zr,Z.quat2=RA,Z.quat=Nf,Z.mat4=Ke,Z.mat3=N1,Z.mat2d=Zg,Z.mat2=qg,Z.glMatrix=PA,Object.defineProperty(Z,"__esModule",{value:!0})})})(rg,rg.exports);(function(b){Object.defineProperty(b,"__esModule",{value:!0}),b.ViewContext=void 0;var G=Qi,Z=rg.exports,tt=G.__importStar(Nr.exports),ot=Wo,ht=Qs;b.ViewContext=tt.default.createContext({view:void 0});var bt=function(se){G.__extends(Ot,se);function Ot(Jt){return se.call(this,Jt)||this}return Ot.prototype.componentDidMount=function(){this.initialize(),this.forceUpdate()},Ot.prototype.componentWillUnmount=function(){this.view&&(this.view.destroy(),this.view=null)},Ot.prototype.componentDidUpdate=function(Jt){(!this.map||!this.view)&&this.initialize()},Ot.prototype.initialize=function(){var Jt=this.map=this.getMap();if(!(!Jt||this.view)&&!this.view){var le=[],jt=this.props.effects,pe=this.props.preserveDrawingBuffer;jt&&jt.length&&jt.forEach(function(He){He==="bloom"?le.push(new Z.BloomEffect):He==="bright"?le.push(new Z.BrightEffect):He==="blur"&&le.push(new Z.BlurEffect)}),this.view=new Z.View({effects:le,preserveDrawingBuffer:pe,map:Jt})}},Ot.prototype.renderChildren=function(Jt){var le=this;if(!(!Jt||!this.map||!this.view))return tt.default.Children.map(Jt,function(jt){if(!!jt)return typeof jt.type=="string"?jt:tt.default.cloneElement(jt,{map:le.map,view:le.view})})},Ot.prototype.render=function(){return tt.default.createElement(tt.Fragment,null,tt.default.createElement(b.ViewContext.Provider,{value:{map:this.map,view:this.view}},this.renderChildren(this.props.children)))},Ot.contextType=ht.MapContext,Ot}(ot.Component);b.default=bt})(vC);var yC={},RM={exports:{}};(function(b,G){(function(Z,tt){tt(G)})(Gc,function(Z){function tt(){throw Error("Dynamic requires are not currently supported by rollup-plugin-commonjs")}function ot(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function ht(t,r){return r={exports:{}},t(r,r.exports),r.exports}function bt(t){var r,i;this.promise=new t(function(s,f){if(r!==void 0||i!==void 0)throw TypeError("Bad Promise constructor");r=s,i=f}),this.resolve=zs(r),this.reject=zs(i)}function se(){}function Ot(t,r){this.x=t||0,this.y=r||0}function Jt(){this.elements=[1,0,0,0,1,0,0,0,1],0<arguments.length&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}function le(t,r,i,s,f,c,d,p,A,S){Object.defineProperty(this,"id",{value:o++}),this.uuid=ti.generateUUID(),this.name="",this.image=t!==void 0?t:le.DEFAULT_IMAGE,this.mipmaps=[],this.mapping=r!==void 0?r:le.DEFAULT_MAPPING,this.wrapS=i!==void 0?i:1001,this.wrapT=s!==void 0?s:1001,this.magFilter=f!==void 0?f:1006,this.minFilter=c!==void 0?c:1008,this.anisotropy=A!==void 0?A:1,this.format=d!==void 0?d:1023,this.internalFormat=null,this.type=p!==void 0?p:1009,this.offset=new Ot(0,0),this.repeat=new Ot(1,1),this.center=new Ot(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Jt,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=S!==void 0?S:3e3,this.version=0,this.onUpdate=null}function jt(t,r,i,s){this.x=t||0,this.y=r||0,this.z=i||0,this.w=s!==void 0?s:1}function pe(t,r,i){this.width=t,this.height=r,this.scissor=new jt(0,0,t,r),this.scissorTest=!1,this.viewport=new jt(0,0,t,r),i=i||{},this.texture=new le(void 0,i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.encoding),this.texture.image={},this.texture.image.width=t,this.texture.image.height=r,this.texture.generateMipmaps=i.generateMipmaps!==void 0?i.generateMipmaps:!1,this.texture.minFilter=i.minFilter!==void 0?i.minFilter:1006,this.depthBuffer=i.depthBuffer!==void 0?i.depthBuffer:!0,this.stencilBuffer=i.stencilBuffer!==void 0?i.stencilBuffer:!0,this.depthTexture=i.depthTexture!==void 0?i.depthTexture:null}function He(t,r,i){pe.call(this,t,r,i),this.samples=4}function ye(t,r,i,s){this._x=t||0,this._y=r||0,this._z=i||0,this._w=s!==void 0?s:1}function dt(t,r,i){this.x=t||0,this.y=r||0,this.z=i||0}function Me(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],0<arguments.length&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}function vr(t,r,i,s){this._x=t||0,this._y=r||0,this._z=i||0,this._order=s||vr.DefaultOrder}function Tr(){this.mask=1}function fe(){Object.defineProperty(this,"id",{value:O++}),this.uuid=ti.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=fe.DefaultUp.clone();var t=new dt,r=new vr,i=new ye,s=new dt(1,1,1);r._onChange(function(){i.setFromEuler(r,!1)}),i._onChange(function(){r.setFromQuaternion(i,void 0,!1)}),Or(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:r},quaternion:{configurable:!0,enumerable:!0,value:i},scale:{configurable:!0,enumerable:!0,value:s},modelViewMatrix:{value:new Me},normalMatrix:{value:new Jt}}),this.matrix=new Me,this.matrixWorld=new Me,this.matrixAutoUpdate=fe.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new Tr,this.visible=!0,this.receiveShadow=this.castShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}}function Mr(){fe.call(this),this.type="Scene",this.overrideMaterial=this.fog=this.environment=this.background=null,this.autoUpdate=!0,typeof __THREE_DEVTOOLS__!="undefined"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}function ui(t,r){this.min=t!==void 0?t:new dt(1/0,1/0,1/0),this.max=r!==void 0?r:new dt(-1/0,-1/0,-1/0)}function xi(t,r,i,s,f){var c,d=0;for(c=t.length-3;d<=c;d+=3){Ii.fromArray(t,d);var p=f.x*Math.abs(Ii.x)+f.y*Math.abs(Ii.y)+f.z*Math.abs(Ii.z),A=r.dot(Ii),S=i.dot(Ii),z=s.dot(Ii);if(Math.max(-Math.max(A,S,z),Math.min(A,S,z))>p)return!1}return!0}function fn(t,r){this.center=t!==void 0?t:new dt,this.radius=r!==void 0?r:-1}function Ln(t,r){this.origin=t!==void 0?t:new dt,this.direction=r!==void 0?r:new dt(0,0,-1)}function Li(t,r){this.normal=t!==void 0?t:new dt(1,0,0),this.constant=r!==void 0?r:0}function li(t,r,i){this.a=t!==void 0?t:new dt,this.b=r!==void 0?r:new dt,this.c=i!==void 0?i:new dt}function Oe(t,r,i){return r===void 0&&i===void 0?this.set(t):this.setRGB(t,r,i)}function yn(t,r,i){return 0>i&&(i+=1),1<i&&--i,i<1/6?t+6*(r-t)*i:.5>i?r:i<2/3?t+6*(r-t)*(2/3-i):t}function Is(t){return .04045>t?.0773993808*t:Math.pow(.9478672986*t+.0521327014,2.4)}function Ks(t){return .0031308>t?12.92*t:1.055*Math.pow(t,.41666)-.055}function Es(t,r,i,s,f,c){this.a=t,this.b=r,this.c=i,this.normal=s&&s.isVector3?s:new dt,this.vertexNormals=Array.isArray(s)?s:[],this.color=f&&f.isColor?f:new Oe,this.vertexColors=Array.isArray(f)?f:[],this.materialIndex=c!==void 0?c:0}function Rr(){Object.defineProperty(this,"id",{value:XI++}),this.uuid=ti.generateUUID(),this.name="",this.type="Material",this.fog=!0,this.blending=1,this.side=0,this.vertexColors=this.flatShading=!1,this.opacity=1,this.transparent=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=100,this.blendEquationAlpha=this.blendDstAlpha=this.blendSrcAlpha=null,this.depthFunc=3,this.depthWrite=this.depthTest=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilZPass=this.stencilZFail=this.stencilFail=7680,this.stencilWrite=!1,this.clippingPlanes=null,this.clipShadows=this.clipIntersection=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetUnits=this.polygonOffsetFactor=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.toneMapped=this.visible=!0,this.userData={},this.version=0}function Nn(t){Rr.call(this),this.type="MeshBasicMaterial",this.color=new Oe(16777215),this.lightMap=this.map=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.envMap=this.alphaMap=this.specularMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinejoin=this.wireframeLinecap="round",this.morphTargets=this.skinning=!1,this.setValues(t)}function wr(t,r,i){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=t,this.itemSize=r,this.count=t!==void 0?t.length/r:0,this.normalized=i===!0,this.usage=35044,this.updateRange={offset:0,count:-1},this.version=0}function og(t,r,i){wr.call(this,new Int8Array(t),r,i)}function vl(t,r,i){wr.call(this,new Uint8Array(t),r,i)}function Yc(t,r,i){wr.call(this,new Uint8ClampedArray(t),r,i)}function sg(t,r,i){wr.call(this,new Int16Array(t),r,i)}function Ra(t,r,i){wr.call(this,new Uint16Array(t),r,i)}function Zc(t,r,i){wr.call(this,new Int32Array(t),r,i)}function wh(t,r,i){wr.call(this,new Uint32Array(t),r,i)}function Ge(t,r,i){wr.call(this,new Float32Array(t),r,i)}function xn(t,r,i){wr.call(this,new Float64Array(t),r,i)}function $s(){this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingSphere=this.boundingBox=null,this.groupsNeedUpdate=this.uvsNeedUpdate=this.colorsNeedUpdate=this.normalsNeedUpdate=this.verticesNeedUpdate=!1}function ag(t){if(t.length===0)return-1/0;for(var r=t[0],i=1,s=t.length;i<s;++i)t[i]>r&&(r=t[i]);return r}function ke(){Object.defineProperty(this,"id",{value:YI+=2}),this.uuid=ti.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingSphere=this.boundingBox=null,this.drawRange={start:0,count:1/0},this.userData={}}function Zi(t,r){fe.call(this),this.type="Mesh",this.geometry=t!==void 0?t:new ke,this.material=r!==void 0?r:new Nn,this.updateMorphTargets()}function Pa(t,r,i,s,f,c,d,p){return(r.side===1?s.intersectTriangle(d,c,f,!0,p):s.intersectTriangle(f,c,d,r.side!==2,p))===null?null:(Ry.copy(p),Ry.applyMatrix4(t.matrixWorld),r=i.ray.origin.distanceTo(Ry),r<i.near||r>i.far?null:{distance:r,point:Ry.clone(),object:t})}function Cu(t,r,i,s,f,c,d,p,A,S,z,w){if(pc.fromBufferAttribute(f,S),dc.fromBufferAttribute(f,z),mc.fromBufferAttribute(f,w),f=t.morphTargetInfluences,r.morphTargets&&c&&f){Iy.set(0,0,0),Ey.set(0,0,0),Ly.set(0,0,0);for(var I=0,E=c.length;I<E;I++){var P=f[I],F=c[I];P!==0&&(p_.fromBufferAttribute(F,S),d_.fromBufferAttribute(F,z),m_.fromBufferAttribute(F,w),d?(Iy.addScaledVector(p_,P),Ey.addScaledVector(d_,P),Ly.addScaledVector(m_,P)):(Iy.addScaledVector(p_.sub(pc),P),Ey.addScaledVector(d_.sub(dc),P),Ly.addScaledVector(m_.sub(mc),P)))}pc.add(Iy),dc.add(Ey),mc.add(Ly)}return t.isSkinnedMesh&&(t.boneTransform(S,pc),t.boneTransform(z,dc),t.boneTransform(w,mc)),(t=Pa(t,r,i,s,pc,dc,mc,Tv))&&(p&&(Hd.fromBufferAttribute(p,S),Gd.fromBufferAttribute(p,z),Vd.fromBufferAttribute(p,w),t.uv=li.getUV(Tv,pc,dc,mc,Hd,Gd,Vd,new Ot)),A&&(Hd.fromBufferAttribute(A,S),Gd.fromBufferAttribute(A,z),Vd.fromBufferAttribute(A,w),t.uv2=li.getUV(Tv,pc,dc,mc,Hd,Gd,Vd,new Ot)),p=new Es(S,z,w),li.getNormal(pc,dc,mc,p.normal),t.face=p),t}function Gr(){Object.defineProperty(this,"id",{value:ZI+=2}),this.uuid=ti.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingSphere=this.boundingBox=null,this.groupsNeedUpdate=this.lineDistancesNeedUpdate=this.colorsNeedUpdate=this.normalsNeedUpdate=this.uvsNeedUpdate=this.verticesNeedUpdate=this.elementsNeedUpdate=!1}function Mh(t){var r={},i;for(i in t){r[i]={};for(var s in t[i]){var f=t[i][s];f&&(f.isColor||f.isMatrix3||f.isMatrix4||f.isVector2||f.isVector3||f.isVector4||f.isTexture)?r[i][s]=f.clone():Array.isArray(f)?r[i][s]=f.slice():r[i][s]=f}}return r}function uo(t){for(var r={},i=0;i<t.length;i++){var s=Mh(t[i]),f;for(f in s)r[f]=s[f]}return r}function Ki(t){Rr.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,this.fragmentShader=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.morphNormals=this.morphTargets=this.skinning=this.clipping=this.lights=this.fog=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,t!==void 0&&(t.attributes!==void 0&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(t))}function Da(){fe.call(this),this.type="Camera",this.matrixWorldInverse=new Me,this.projectionMatrix=new Me,this.projectionMatrixInverse=new Me}function en(t,r,i,s){Da.call(this),this.type="PerspectiveCamera",this.fov=t!==void 0?t:50,this.zoom=1,this.near=i!==void 0?i:.1,this.far=s!==void 0?s:2e3,this.focus=10,this.aspect=r!==void 0?r:1,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}function Vi(t,r,i){if(fe.call(this),this.type="CubeCamera",i.isWebGLCubeRenderTarget!==!0)console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter.");else{this.renderTarget=i;var s=new en(90,1,t,r);s.layers=this.layers,s.up.set(0,-1,0),s.lookAt(new dt(1,0,0)),this.add(s);var f=new en(90,1,t,r);f.layers=this.layers,f.up.set(0,-1,0),f.lookAt(new dt(-1,0,0)),this.add(f);var c=new en(90,1,t,r);c.layers=this.layers,c.up.set(0,0,1),c.lookAt(new dt(0,1,0)),this.add(c);var d=new en(90,1,t,r);d.layers=this.layers,d.up.set(0,0,-1),d.lookAt(new dt(0,-1,0)),this.add(d);var p=new en(90,1,t,r);p.layers=this.layers,p.up.set(0,-1,0),p.lookAt(new dt(0,0,1)),this.add(p);var A=new en(90,1,t,r);A.layers=this.layers,A.up.set(0,-1,0),A.lookAt(new dt(0,0,-1)),this.add(A),this.update=function(S,z){this.parent===null&&this.updateMatrixWorld();var w=S.xr.enabled,I=S.getRenderTarget();S.xr.enabled=!1;var E=i.texture.generateMipmaps;i.texture.generateMipmaps=!1,S.setRenderTarget(i,0),S.render(z,s),S.setRenderTarget(i,1),S.render(z,f),S.setRenderTarget(i,2),S.render(z,c),S.setRenderTarget(i,3),S.render(z,d),S.setRenderTarget(i,4),S.render(z,p),i.texture.generateMipmaps=E,S.setRenderTarget(i,5),S.render(z,A),S.setRenderTarget(I),S.xr.enabled=w},this.clear=function(S,z,w,I){for(var E=S.getRenderTarget(),P=0;6>P;P++)S.setRenderTarget(i,P),S.clear(z,w,I);S.setRenderTarget(E)}}}function Tu(t,r,i){fc(r)&&(console.warn("THREE.WebGLCubeRenderTarget: constructor signature is now WebGLCubeRenderTarget( size, options )"),r=i),pe.call(this,t,t,r)}function yl(t,r,i,s,f,c,d,p,A,S,z,w){le.call(this,null,c,d,p,A,S,s,f,z,w),this.image={data:t||null,width:r||1,height:i||1},this.magFilter=A!==void 0?A:1003,this.minFilter=S!==void 0?S:1003,this.flipY=this.generateMipmaps=!1,this.unpackAlignment=1,this.needsUpdate=!0}function Su(t,r,i,s,f,c){this.planes=[t!==void 0?t:new Li,r!==void 0?r:new Li,i!==void 0?i:new Li,s!==void 0?s:new Li,f!==void 0?f:new Li,c!==void 0?c:new Li]}function qc(){function t(f,c){i!==!1&&(s(f,c),r.requestAnimationFrame(t))}var r=null,i=!1,s=null;return{start:function(){i!==!0&&s!==null&&(r.requestAnimationFrame(t),i=!0)},stop:function(){i=!1},setAnimationLoop:function(f){s=f},setContext:function(f){r=f}}}function Jc(t,r){function i(c,d){var p=c.array,A=c.usage,S=t.createBuffer();return t.bindBuffer(d,S),t.bufferData(d,p,A),c.onUploadCallback(),d=5126,p instanceof Float32Array?d=5126:p instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):p instanceof Uint16Array?d=5123:p instanceof Int16Array?d=5122:p instanceof Uint32Array?d=5125:p instanceof Int32Array?d=5124:p instanceof Int8Array?d=5120:p instanceof Uint8Array&&(d=5121),{buffer:S,type:d,bytesPerElement:p.BYTES_PER_ELEMENT,version:c.version}}var s=r.isWebGL2,f=new ki;return{get:function(c){return c.isInterleavedBufferAttribute&&(c=c.data),f.get(c)},remove:function(c){c.isInterleavedBufferAttribute&&(c=c.data);var d=f.get(c);d&&(t.deleteBuffer(d.buffer),f.delete(c))},update:function(c,d){c.isInterleavedBufferAttribute&&(c=c.data);var p=f.get(c);if(p===void 0)f.set(c,i(c,d));else if(p.version<c.version){var A=c.array,S=c.updateRange;t.bindBuffer(d,p.buffer),S.count===-1?t.bufferSubData(d,0,A):(s?t.bufferSubData(d,S.offset*A.BYTES_PER_ELEMENT,A,S.offset,S.count):t.bufferSubData(d,S.offset*A.BYTES_PER_ELEMENT,A.subarray(S.offset,S.offset+S.count)),S.count=-1),p.version=c.version}}}}function Qc(t,r,i,s){Gr.call(this),this.type="PlaneGeometry",this.parameters={width:t,height:r,widthSegments:i,heightSegments:s},this.fromBufferGeometry(new Oa(t,r,i,s)),this.mergeVertices()}function Oa(t,r,i,s){ke.call(this),this.type="PlaneBufferGeometry",this.parameters={width:t,height:r,widthSegments:i,heightSegments:s},t=t||1,r=r||1;var f=t/2,c=r/2;i=Math.floor(i)||1,s=Math.floor(s)||1;var d=i+1,p=s+1,A=t/i,S=r/s,z=[],w=[],I=[],E=[];for(t=0;t<p;t++){var P=t*S-c;for(r=0;r<d;r++)w.push(r*A-f,-P,0),I.push(0,0,1),E.push(r/i),E.push(1-t/s)}for(t=0;t<s;t++)for(r=0;r<i;r++)f=r+d*(t+1),c=r+1+d*(t+1),p=r+1+d*t,z.push(r+d*t,f,p),z.push(f,c,p);this.setIndex(z),this.setAttribute("position",new Ge(w,3)),this.setAttribute("normal",new Ge(I,3)),this.setAttribute("uv",new Ge(E,2))}function Kc(t,r,i,s){function f(I,E){r.buffers.color.setClear(I.r,I.g,I.b,E,s)}var c=new Oe(0),d=0,p,A,S=null,z=0,w=null;return{getClearColor:function(){return c},setClearColor:function(I,E){c.set(I),d=E!==void 0?E:1,f(c,d)},getClearAlpha:function(){return d},setClearAlpha:function(I){d=I,f(c,d)},render:function(I,E,P,F){E=E.background,P=t.xr,(P=P.getSession&&P.getSession())&&P.environmentBlendMode==="additive"&&(E=null),E===null?f(c,d):E&&E.isColor&&(f(E,1),F=!0),(t.autoClear||F)&&t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil),E&&(E.isCubeTexture||E.isWebGLCubeRenderTarget||E.mapping===306)?(A===void 0&&(A=new Zi(new Dy(1,1,1),new Ki({type:"BackgroundCubeMaterial",uniforms:Mh(th.cube.uniforms),vertexShader:th.cube.vertexShader,fragmentShader:th.cube.fragmentShader,side:1,depthTest:!1,depthWrite:!1,fog:!1})),A.geometry.deleteAttribute("normal"),A.geometry.deleteAttribute("uv"),A.onBeforeRender=function(X,q,J){this.matrixWorld.copyPosition(J.matrixWorld)},Object.defineProperty(A.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),i.update(A)),F=E.isWebGLCubeRenderTarget?E.texture:E,A.material.uniforms.envMap.value=F,A.material.uniforms.flipEnvMap.value=F.isCubeTexture?-1:1,(S!==E||z!==F.version||w!==t.toneMapping)&&(A.material.needsUpdate=!0,S=E,z=F.version,w=t.toneMapping),I.unshift(A,A.geometry,A.material,0,0,null)):E&&E.isTexture&&(p===void 0&&(p=new Zi(new Oa(2,2),new Ki({type:"BackgroundMaterial",uniforms:Mh(th.background.uniforms),vertexShader:th.background.vertexShader,fragmentShader:th.background.fragmentShader,side:0,depthTest:!1,depthWrite:!1,fog:!1})),p.geometry.deleteAttribute("normal"),Object.defineProperty(p.material,"map",{get:function(){return this.uniforms.t2D.value}}),i.update(p)),p.material.uniforms.t2D.value=E,E.matrixAutoUpdate===!0&&E.updateMatrix(),p.material.uniforms.uvTransform.value.copy(E.matrix),(S!==E||z!==E.version||w!==t.toneMapping)&&(p.material.needsUpdate=!0,S=E,z=E.version,w=t.toneMapping),I.unshift(p,p.geometry,p.material,0,0,null))}}}function ug(t,r,i,s){var f=s.isWebGL2,c;this.setMode=function(d){c=d},this.render=function(d,p){t.drawArrays(c,d,p),i.update(p,c)},this.renderInstances=function(d,p,A,S){if(S!==0){if(f){d=t;var z="drawArraysInstanced"}else if(d=r.get("ANGLE_instanced_arrays"),z="drawArraysInstancedANGLE",d===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}d[z](c,p,A,S),i.update(A,c,S)}}}function lg(t,r,i){function s(it){if(it==="highp"){if(0<t.getShaderPrecisionFormat(35633,36338).precision&&0<t.getShaderPrecisionFormat(35632,36338).precision)return"highp";it="mediump"}return it==="mediump"&&0<t.getShaderPrecisionFormat(35633,36337).precision&&0<t.getShaderPrecisionFormat(35632,36337).precision?"mediump":"lowp"}var f,c=typeof WebGL2RenderingContext!="undefined"&&t instanceof WebGL2RenderingContext||typeof WebGL2ComputeRenderingContext!="undefined"&&t instanceof WebGL2ComputeRenderingContext,d=i.precision!==void 0?i.precision:"highp",p=s(d);p!==d&&(console.warn("THREE.WebGLRenderer:",d,"not supported, using",p,"instead."),d=p),i=i.logarithmicDepthBuffer===!0,p=t.getParameter(34930);var A=t.getParameter(35660),S=t.getParameter(3379),z=t.getParameter(34076),w=t.getParameter(34921),I=t.getParameter(36347),E=t.getParameter(36348),P=t.getParameter(36349),F=0<A,X=c||!!r.get("OES_texture_float"),q=F&&X,J=c?t.getParameter(36183):0;return{isWebGL2:c,getMaxAnisotropy:function(){if(f!==void 0)return f;var it=r.get("EXT_texture_filter_anisotropic");return f=it!==null?t.getParameter(it.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0},getMaxPrecision:s,precision:d,logarithmicDepthBuffer:i,maxTextures:p,maxVertexTextures:A,maxTextureSize:S,maxCubemapSize:z,maxAttributes:w,maxVertexUniforms:I,maxVaryings:E,maxFragmentUniforms:P,vertexTextures:F,floatFragmentTextures:X,floatVertexTextures:q,maxSamples:J}}function r1(){function t(){S.value!==s&&(S.value=s,S.needsUpdate=0<f),i.numPlanes=f,i.numIntersection=0}function r(z,w,I,E){var P=z!==null?z.length:0,F=null;if(P!==0){if(F=S.value,E!==!0||F===null)for(E=I+4*P,w=w.matrixWorldInverse,A.getNormalMatrix(w),(F===null||F.length<E)&&(F=new Float32Array(E)),E=0;E!==P;++E,I+=4)p.copy(z[E]).applyMatrix4(w,A),p.normal.toArray(F,I),F[I+3]=p.constant;S.value=F,S.needsUpdate=!0}return i.numPlanes=P,i.numIntersection=0,F}var i=this,s=null,f=0,c=!1,d=!1,p=new Li,A=new Jt,S={value:null,needsUpdate:!1};this.uniform=S,this.numIntersection=this.numPlanes=0,this.init=function(z,w,I){var E=z.length!==0||w||f!==0||c;return c=w,s=r(z,I,0),f=z.length,E},this.beginShadows=function(){d=!0,r(null)},this.endShadows=function(){d=!1,t()},this.setState=function(z,w,I,E,P,F){if(!c||z===null||z.length===0||d&&!I)d?r(null):t();else{I=d?0:f;var X=4*I,q=P.clippingState||null;for(S.value=q,q=r(z,E,X,F),z=0;z!==X;++z)q[z]=s[z];P.clippingState=q,this.numIntersection=w?this.numPlanes:0,this.numPlanes+=I}}}function xl(t){var r={};return{get:function(i){if(r[i]!==void 0)return r[i];switch(i){case"WEBGL_depth_texture":var s=t.getExtension("WEBGL_depth_texture")||t.getExtension("MOZ_WEBGL_depth_texture")||t.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":s=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":s=t.getExtension("WEBGL_compressed_texture_s3tc")||t.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":s=t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:s=t.getExtension(i)}return s===null&&console.warn("THREE.WebGLRenderer: "+i+" extension not supported."),r[i]=s}}}function i1(t,r,i){function s(p){var A=p.target;p=c.get(A),p.index!==null&&r.remove(p.index);for(var S in p.attributes)r.remove(p.attributes[S]);A.removeEventListener("dispose",s),c.delete(A),(S=d.get(p))&&(r.remove(S),d.delete(p)),i.memory.geometries--}function f(p){var A=[],S=p.index,z=p.attributes.position;if(S!==null){var w=S.array;S=S.version,z=0;for(var I=w.length;z<I;z+=3){var E=w[z+0],P=w[z+1],F=w[z+2];A.push(E,P,P,F,F,E)}}else for(w=z.array,S=z.version,z=0,I=w.length/3-1;z<I;z+=3)E=z+0,P=z+1,F=z+2,A.push(E,P,P,F,F,E);A=new(65535<ag(A)?wh:Ra)(A,1),A.version=S,r.update(A,34963),(w=d.get(p))&&r.remove(w),d.set(p,A)}var c=new ki,d=new ki;return{get:function(p,A){var S=c.get(A);return S||(A.addEventListener("dispose",s),A.isBufferGeometry?S=A:A.isGeometry&&(A._bufferGeometry===void 0&&(A._bufferGeometry=new ke().setFromObject(p)),S=A._bufferGeometry),c.set(A,S),i.memory.geometries++,S)},update:function(p){var A=p.index,S=p.attributes;A!==null&&r.update(A,34963);for(var z in S)r.update(S[z],34962);p=p.morphAttributes;for(z in p){A=p[z],S=0;for(var w=A.length;S<w;S++)r.update(A[S],34962)}},getWireframeAttribute:function(p){var A=d.get(p);if(A){var S=p.index;S!==null&&A.version<S.version&&f(p)}else f(p);return d.get(p)}}}function Iu(t,r,i,s){var f=s.isWebGL2,c,d,p;this.setMode=function(A){c=A},this.setIndex=function(A){d=A.type,p=A.bytesPerElement},this.render=function(A,S){t.drawElements(c,S,d,A*p),i.update(S,c)},this.renderInstances=function(A,S,z,w){if(w!==0){if(f){A=t;var I="drawElementsInstanced"}else if(A=r.get("ANGLE_instanced_arrays"),I="drawElementsInstancedANGLE",A===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}A[I](c,z,d,S*p,w),i.update(z,c,w)}}}function as(t){var r={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:r,programs:null,autoReset:!0,reset:function(){r.frame++,r.calls=0,r.triangles=0,r.points=0,r.lines=0},update:function(i,s,f){switch(f=f||1,r.calls++,s){case 4:r.triangles+=i/3*f;break;case 1:r.lines+=i/2*f;break;case 3:r.lines+=f*(i-1);break;case 2:r.lines+=f*i;break;case 0:r.points+=f*i;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",s)}}}}function n1(t,r){return Math.abs(r[1])-Math.abs(t[1])}function qp(t){var r={},i=new Float32Array(8);return{update:function(s,f,c,d){var p=s.morphTargetInfluences,A=p===void 0?0:p.length;if(s=r[f.id],s===void 0){s=[];for(var S=0;S<A;S++)s[S]=[S,0];r[f.id]=s}var z=c.morphTargets&&f.morphAttributes.position;for(c=c.morphNormals&&f.morphAttributes.normal,S=0;S<A;S++){var w=s[S];w[1]!==0&&(z&&f.deleteAttribute("morphTarget"+S),c&&f.deleteAttribute("morphNormal"+S))}for(S=0;S<A;S++)w=s[S],w[0]=S,w[1]=p[S];for(s.sort(n1),S=p=0;8>S;S++){if((w=s[S])&&(A=w[0],w=w[1])){z&&f.setAttribute("morphTarget"+S,z[A]),c&&f.setAttribute("morphNormal"+S,c[A]),i[S]=w,p+=w;continue}i[S]=0}f=f.morphTargetsRelative?1:1-p,d.getUniforms().setValue(t,"morphTargetBaseInfluence",f),d.getUniforms().setValue(t,"morphTargetInfluences",i)}}}function ta(t,r,i,s){var f=new ki;return{update:function(c){var d=s.render.frame,p=c.geometry,A=r.get(c,p);return f.get(A)!==d&&(p.isGeometry&&A.updateFromObject(c),r.update(A),f.set(A,d)),c.isInstancedMesh&&i.update(c.instanceMatrix,34962),A},dispose:function(){f=new ki}}}function Fa(t,r,i,s,f,c,d,p,A,S){t=t!==void 0?t:[],le.call(this,t,r!==void 0?r:301,i,s,f,c,d!==void 0?d:1022,p,A,S),this.flipY=!1}function Ch(t,r,i,s){le.call(this,null),this.image={data:t||null,width:r||1,height:i||1,depth:s||1},this.minFilter=this.magFilter=1003,this.wrapR=1001,this.flipY=this.generateMipmaps=!1,this.needsUpdate=!0}function Th(t,r,i,s){le.call(this,null),this.image={data:t||null,width:r||1,height:i||1,depth:s||1},this.minFilter=this.magFilter=1003,this.wrapR=1001,this.flipY=this.generateMipmaps=!1,this.needsUpdate=!0}function Ba(t,r,i){var s=t[0];if(0>=s||0<s)return t;var f=r*i,c=OC[f];if(c===void 0&&(c=new Float32Array(f),OC[f]=c),r!==0)for(s.toArray(c,0),s=1,f=0;s!==r;++s)f+=i,t[s].toArray(c,f);return c}function jo(t,r){if(t.length!==r.length)return!1;for(var i=0,s=t.length;i<s;i++)if(t[i]!==r[i])return!1;return!0}function Xo(t,r){for(var i=0,s=r.length;i<s;i++)t[i]=r[i]}function o1(t,r){var i=FC[r];i===void 0&&(i=new Int32Array(r),FC[r]=i);for(var s=0;s!==r;++s)i[s]=t.allocateTextureUnit();return i}function tA(t,r){var i=this.cache;i[0]!==r&&(t.uniform1f(this.addr,r),i[0]=r)}function eA(t,r){var i=this.cache;r.x!==void 0?(i[0]!==r.x||i[1]!==r.y)&&(t.uniform2f(this.addr,r.x,r.y),i[0]=r.x,i[1]=r.y):jo(i,r)||(t.uniform2fv(this.addr,r),Xo(i,r))}function Jp(t,r){var i=this.cache;r.x!==void 0?(i[0]!==r.x||i[1]!==r.y||i[2]!==r.z)&&(t.uniform3f(this.addr,r.x,r.y,r.z),i[0]=r.x,i[1]=r.y,i[2]=r.z):r.r!==void 0?(i[0]!==r.r||i[1]!==r.g||i[2]!==r.b)&&(t.uniform3f(this.addr,r.r,r.g,r.b),i[0]=r.r,i[1]=r.g,i[2]=r.b):jo(i,r)||(t.uniform3fv(this.addr,r),Xo(i,r))}function rA(t,r){var i=this.cache;r.x!==void 0?(i[0]!==r.x||i[1]!==r.y||i[2]!==r.z||i[3]!==r.w)&&(t.uniform4f(this.addr,r.x,r.y,r.z,r.w),i[0]=r.x,i[1]=r.y,i[2]=r.z,i[3]=r.w):jo(i,r)||(t.uniform4fv(this.addr,r),Xo(i,r))}function iA(t,r){var i=this.cache,s=r.elements;s===void 0?jo(i,r)||(t.uniformMatrix2fv(this.addr,!1,r),Xo(i,r)):jo(i,s)||(NC.set(s),t.uniformMatrix2fv(this.addr,!1,NC),Xo(i,s))}function nA(t,r){var i=this.cache,s=r.elements;s===void 0?jo(i,r)||(t.uniformMatrix3fv(this.addr,!1,r),Xo(i,r)):jo(i,s)||(zC.set(s),t.uniformMatrix3fv(this.addr,!1,zC),Xo(i,s))}function oA(t,r){var i=this.cache,s=r.elements;s===void 0?jo(i,r)||(t.uniformMatrix4fv(this.addr,!1,r),Xo(i,r)):jo(i,s)||(BC.set(s),t.uniformMatrix4fv(this.addr,!1,BC),Xo(i,s))}function sA(t,r,i){var s=this.cache,f=i.allocateTextureUnit();s[0]!==f&&(t.uniform1i(this.addr,f),s[0]=f),i.safeSetTexture2D(r||PC,f)}function aA(t,r,i){var s=this.cache,f=i.allocateTextureUnit();s[0]!==f&&(t.uniform1i(this.addr,f),s[0]=f),i.setTexture2DArray(r||JI,f)}function An(t,r,i){var s=this.cache,f=i.allocateTextureUnit();s[0]!==f&&(t.uniform1i(this.addr,f),s[0]=f),i.setTexture3D(r||QI,f)}function uA(t,r,i){var s=this.cache,f=i.allocateTextureUnit();s[0]!==f&&(t.uniform1i(this.addr,f),s[0]=f),i.safeSetTextureCube(r||DC,f)}function hg(t,r){var i=this.cache;i[0]!==r&&(t.uniform1i(this.addr,r),i[0]=r)}function s1(t,r){var i=this.cache;jo(i,r)||(t.uniform2iv(this.addr,r),Xo(i,r))}function lA(t,r){var i=this.cache;jo(i,r)||(t.uniform3iv(this.addr,r),Xo(i,r))}function Xe(t,r){var i=this.cache;jo(i,r)||(t.uniform4iv(this.addr,r),Xo(i,r))}function Eu(t,r){var i=this.cache;i[0]!==r&&(t.uniform1ui(this.addr,r),i[0]=r)}function hA(t){switch(t){case 5126:return tA;case 35664:return eA;case 35665:return Jp;case 35666:return rA;case 35674:return iA;case 35675:return nA;case 35676:return oA;case 5124:case 35670:return hg;case 35667:case 35671:return s1;case 35668:case 35672:return lA;case 35669:case 35673:return Xe;case 5125:return Eu;case 35678:case 36198:case 36298:case 36306:case 35682:return sA;case 35679:case 36299:case 36307:return An;case 35680:case 36300:case 36308:case 36293:return uA;case 36289:case 36303:case 36311:case 36292:return aA}}function Wi(t,r){t.uniform1fv(this.addr,r)}function cA(t,r){t.uniform1iv(this.addr,r)}function Al(t,r){t.uniform2iv(this.addr,r)}function cg(t,r){t.uniform3iv(this.addr,r)}function ea(t,r){t.uniform4iv(this.addr,r)}function fA(t,r){r=Ba(r,this.size,2),t.uniform2fv(this.addr,r)}function pA(t,r){r=Ba(r,this.size,3),t.uniform3fv(this.addr,r)}function fg(t,r){r=Ba(r,this.size,4),t.uniform4fv(this.addr,r)}function dA(t,r){r=Ba(r,this.size,4),t.uniformMatrix2fv(this.addr,!1,r)}function Qp(t,r){r=Ba(r,this.size,9),t.uniformMatrix3fv(this.addr,!1,r)}function mA(t,r){r=Ba(r,this.size,16),t.uniformMatrix4fv(this.addr,!1,r)}function gA(t,r,i){var s=r.length,f=o1(i,s);for(t.uniform1iv(this.addr,f),t=0;t!==s;++t)i.safeSetTexture2D(r[t]||PC,f[t])}function Ui(t,r,i){var s=r.length,f=o1(i,s);for(t.uniform1iv(this.addr,f),t=0;t!==s;++t)i.safeSetTextureCube(r[t]||DC,f[t])}function Qr(t){switch(t){case 5126:return Wi;case 35664:return fA;case 35665:return pA;case 35666:return fg;case 35674:return dA;case 35675:return Qp;case 35676:return mA;case 5124:case 35670:return cA;case 35667:case 35671:return Al;case 35668:case 35672:return cg;case 35669:case 35673:return ea;case 35678:case 36198:case 36298:case 36306:case 35682:return gA;case 35680:case 36300:case 36308:case 36293:return Ui}}function $c(t,r,i){this.id=t,this.addr=i,this.cache=[],this.setValue=hA(r.type)}function a1(t,r,i){this.id=t,this.addr=i,this.cache=[],this.size=r.size,this.setValue=Qr(r.type)}function u1(t){this.id=t,this.seq=[],this.map={}}function Ls(t,r){this.seq=[],this.map={};for(var i=t.getProgramParameter(r,35718),s=0;s<i;++s){var f=t.getActiveUniform(r,s),c=t.getUniformLocation(r,f.name),d=this,p=f.name,A=p.length;for(v_.lastIndex=0;;){var S=v_.exec(p),z=v_.lastIndex,w=S[1],I=S[3];if(S[2]==="]"&&(w|=0),I===void 0||I==="["&&z+2===A){p=d,f=I===void 0?new $c(w,f,c):new a1(w,f,c),p.seq.push(f),p.map[f.id]=f;break}else I=d.map[w],I===void 0&&(I=new u1(w),w=d,d=I,w.seq.push(d),w.map[d.id]=d),d=I}}}function pg(t,r,i){return r=t.createShader(r),t.shaderSource(r,i),t.compileShader(r),r}function Kp(t){switch(t){case 3e3:return["Linear","( value )"];case 3001:return["sRGB","( value )"];case 3002:return["RGBE","( value )"];case 3004:return["RGBM","( value, 7.0 )"];case 3005:return["RGBM","( value, 16.0 )"];case 3006:return["RGBD","( value, 256.0 )"];case 3007:return["Gamma","( value, float( GAMMA_FACTOR ) )"];case 3003:return["LogLuv","( value )"];default:throw Error("unsupported encoding: "+t)}}function l1(t,r,i){var s=t.getShaderParameter(r,35713),f=t.getShaderInfoLog(r).trim();if(s&&f==="")return"";for(t=t.getShaderSource(r).split(`
`),r=0;r<t.length;r++)t[r]=r+1+": "+t[r];return t=t.join(`
`),"THREE.WebGLShader: gl.getShaderInfoLog() "+i+`
`+f+t}function tf(t,r){return r=Kp(r),"vec4 "+t+"( vec4 value ) { return "+r[0]+"ToLinear"+r[1]+"; }"}function h1(t,r){return r=Kp(r),"vec4 "+t+"( vec4 value ) { return LinearTo"+r[0]+r[1]+"; }"}function $p(t,r){switch(r){case 1:r="Linear";break;case 2:r="Reinhard";break;case 3:r="Uncharted2";break;case 4:r="OptimizedCineon";break;case 5:r="ACESFilmic";break;default:throw Error("unsupported toneMapping: "+r)}return"vec3 "+t+"( vec3 color ) { return "+r+"ToneMapping( color ); }"}function Sh(t){var r=[],i;for(i in t){var s=t[i];s!==!1&&r.push("#define "+i+" "+s)}return r.join(`
`)}function Rs(t){return t!==""}function Un(t,r){return t.replace(/NUM_DIR_LIGHTS/g,r.numDirLights).replace(/NUM_SPOT_LIGHTS/g,r.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,r.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,r.numPointLights).replace(/NUM_HEMI_LIGHTS/g,r.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,r.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,r.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,r.numPointLightShadows)}function $n(t,r){return t.replace(/NUM_CLIPPING_PLANES/g,r.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,r.numClippingPlanes-r.numClipIntersection)}function to(t,r){if(t=gi[r],t===void 0)throw Error("Can not resolve #include <"+r+">");return t.replace(y_,to)}function za(t,r,i,s){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),Lo(t,r,i,s)}function Lo(t,r,i,s){for(t="",r=parseInt(r);r<parseInt(i);r++)t+=s.replace(/\[ i \]/g,"[ "+r+" ]").replace(/UNROLLED_LOOP_INDEX/g,r);return t}function _l(t){var r="precision "+t.precision+` float;
precision `+t.precision+" int;";return t.precision==="highp"?r+=`
#define HIGH_PRECISION`:t.precision==="mediump"?r+=`
#define MEDIUM_PRECISION`:t.precision==="lowp"&&(r+=`
#define LOW_PRECISION`),r}function td(t){var r="SHADOWMAP_TYPE_BASIC";return t.shadowMapType===1?r="SHADOWMAP_TYPE_PCF":t.shadowMapType===2?r="SHADOWMAP_TYPE_PCF_SOFT":t.shadowMapType===3&&(r="SHADOWMAP_TYPE_VSM"),r}function c1(t){var r="ENVMAP_TYPE_CUBE";if(t.envMap)switch(t.envMapMode){case 301:case 302:r="ENVMAP_TYPE_CUBE";break;case 306:case 307:r="ENVMAP_TYPE_CUBE_UV";break;case 303:case 304:r="ENVMAP_TYPE_EQUIREC";break;case 305:r="ENVMAP_TYPE_SPHERE"}return r}function ef(t){var r="ENVMAP_MODE_REFLECTION";if(t.envMap)switch(t.envMapMode){case 302:case 304:r="ENVMAP_MODE_REFRACTION"}return r}function vA(t){var r="ENVMAP_BLENDING_NONE";if(t.envMap)switch(t.combine){case 0:r="ENVMAP_BLENDING_MULTIPLY";break;case 1:r="ENVMAP_BLENDING_MIX";break;case 2:r="ENVMAP_BLENDING_ADD"}return r}function Yo(t,r,i){var s=t.getContext(),f=i.defines,c=i.vertexShader,d=i.fragmentShader,p=td(i),A=c1(i),S=ef(i),z=vA(i),w=0<t.gammaFactor?t.gammaFactor:1,I=i.isWebGL2?"":[i.extensionDerivatives||i.envMapCubeUV||i.bumpMap||i.tangentSpaceNormalMap||i.clearcoatNormalMap||i.flatShading||i.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(i.extensionFragDepth||i.logarithmicDepthBuffer)&&i.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",i.extensionDrawBuffers&&i.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(i.extensionShaderTextureLOD||i.envMap)&&i.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Rs).join(`
`),E=Sh(f),P=s.createProgram();i.isRawShaderMaterial?(f=[E].filter(Rs).join(`
`),0<f.length&&(f+=`
`),p=[I,E].filter(Rs).join(`
`),0<p.length&&(p+=`
`)):(f=[_l(i),"#define SHADER_NAME "+i.shaderName,E,i.instancing?"#define USE_INSTANCING":"",i.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+w,"#define MAX_BONES "+i.maxBones,i.useFog&&i.fog?"#define USE_FOG":"",i.useFog&&i.fogExp2?"#define FOG_EXP2":"",i.map?"#define USE_MAP":"",i.envMap?"#define USE_ENVMAP":"",i.envMap?"#define "+S:"",i.lightMap?"#define USE_LIGHTMAP":"",i.aoMap?"#define USE_AOMAP":"",i.emissiveMap?"#define USE_EMISSIVEMAP":"",i.bumpMap?"#define USE_BUMPMAP":"",i.normalMap?"#define USE_NORMALMAP":"",i.normalMap&&i.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",i.normalMap&&i.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",i.clearcoatMap?"#define USE_CLEARCOATMAP":"",i.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",i.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",i.displacementMap&&i.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",i.specularMap?"#define USE_SPECULARMAP":"",i.roughnessMap?"#define USE_ROUGHNESSMAP":"",i.metalnessMap?"#define USE_METALNESSMAP":"",i.alphaMap?"#define USE_ALPHAMAP":"",i.vertexTangents?"#define USE_TANGENT":"",i.vertexColors?"#define USE_COLOR":"",i.vertexUvs?"#define USE_UV":"",i.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",i.flatShading?"#define FLAT_SHADED":"",i.skinning?"#define USE_SKINNING":"",i.useVertexTexture?"#define BONE_TEXTURE":"",i.morphTargets?"#define USE_MORPHTARGETS":"",i.morphNormals&&i.flatShading===!1?"#define USE_MORPHNORMALS":"",i.doubleSided?"#define DOUBLE_SIDED":"",i.flipSided?"#define FLIP_SIDED":"",i.shadowMapEnabled?"#define USE_SHADOWMAP":"",i.shadowMapEnabled?"#define "+p:"",i.sizeAttenuation?"#define USE_SIZEATTENUATION":"",i.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",i.logarithmicDepthBuffer&&i.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING"," attribute mat4 instanceMatrix;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#ifdef USE_COLOR","	attribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(Rs).join(`
`),p=[I,_l(i),"#define SHADER_NAME "+i.shaderName,E,i.alphaTest?"#define ALPHATEST "+i.alphaTest+(i.alphaTest%1?"":".0"):"","#define GAMMA_FACTOR "+w,i.useFog&&i.fog?"#define USE_FOG":"",i.useFog&&i.fogExp2?"#define FOG_EXP2":"",i.map?"#define USE_MAP":"",i.matcap?"#define USE_MATCAP":"",i.envMap?"#define USE_ENVMAP":"",i.envMap?"#define "+A:"",i.envMap?"#define "+S:"",i.envMap?"#define "+z:"",i.lightMap?"#define USE_LIGHTMAP":"",i.aoMap?"#define USE_AOMAP":"",i.emissiveMap?"#define USE_EMISSIVEMAP":"",i.bumpMap?"#define USE_BUMPMAP":"",i.normalMap?"#define USE_NORMALMAP":"",i.normalMap&&i.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",i.normalMap&&i.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",i.clearcoatMap?"#define USE_CLEARCOATMAP":"",i.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",i.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",i.specularMap?"#define USE_SPECULARMAP":"",i.roughnessMap?"#define USE_ROUGHNESSMAP":"",i.metalnessMap?"#define USE_METALNESSMAP":"",i.alphaMap?"#define USE_ALPHAMAP":"",i.sheen?"#define USE_SHEEN":"",i.vertexTangents?"#define USE_TANGENT":"",i.vertexColors?"#define USE_COLOR":"",i.vertexUvs?"#define USE_UV":"",i.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",i.gradientMap?"#define USE_GRADIENTMAP":"",i.flatShading?"#define FLAT_SHADED":"",i.doubleSided?"#define DOUBLE_SIDED":"",i.flipSided?"#define FLIP_SIDED":"",i.shadowMapEnabled?"#define USE_SHADOWMAP":"",i.shadowMapEnabled?"#define "+p:"",i.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",i.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",i.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",i.logarithmicDepthBuffer&&i.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"",(i.extensionShaderTextureLOD||i.envMap)&&i.rendererExtensionShaderTextureLod?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",i.toneMapping!==0?"#define TONE_MAPPING":"",i.toneMapping!==0?gi.tonemapping_pars_fragment:"",i.toneMapping!==0?$p("toneMapping",i.toneMapping):"",i.dithering?"#define DITHERING":"",i.outputEncoding||i.mapEncoding||i.matcapEncoding||i.envMapEncoding||i.emissiveMapEncoding||i.lightMapEncoding?gi.encodings_pars_fragment:"",i.mapEncoding?tf("mapTexelToLinear",i.mapEncoding):"",i.matcapEncoding?tf("matcapTexelToLinear",i.matcapEncoding):"",i.envMapEncoding?tf("envMapTexelToLinear",i.envMapEncoding):"",i.emissiveMapEncoding?tf("emissiveMapTexelToLinear",i.emissiveMapEncoding):"",i.lightMapEncoding?tf("lightMapTexelToLinear",i.lightMapEncoding):"",i.outputEncoding?h1("linearToOutputTexel",i.outputEncoding):"",i.depthPacking?"#define DEPTH_PACKING "+i.depthPacking:"",`
`].filter(Rs).join(`
`)),c=c.replace(y_,to),c=Un(c,i),c=$n(c,i),d=d.replace(y_,to),d=Un(d,i),d=$n(d,i),c=c.replace(bC,Lo).replace(UC,za),d=d.replace(bC,Lo).replace(UC,za),i.isWebGL2&&!i.isRawShaderMaterial&&(A=!1,S=/^\s*#version\s+300\s+es\s*\n/,i.isShaderMaterial&&c.match(S)!==null&&d.match(S)!==null&&(A=!0,c=c.replace(S,""),d=d.replace(S,"")),f=`#version 300 es

#define attribute in
#define varying out
#define texture2D texture
`+f,p=[`#version 300 es

#define varying in`,A?"":"out highp vec4 pc_fragColor;",A?"":"#define gl_FragColor pc_fragColor",`#define gl_FragDepthEXT gl_FragDepth
#define texture2D texture
#define textureCube texture
#define texture2DProj textureProj
#define texture2DLodEXT textureLod
#define texture2DProjLodEXT textureProjLod
#define textureCubeLodEXT textureLod
#define texture2DGradEXT textureGrad
#define texture2DProjGradEXT textureProjGrad
#define textureCubeGradEXT textureGrad`].join(`
`)+`
`+p),d=p+d,c=pg(s,35633,f+c),d=pg(s,35632,d),s.attachShader(P,c),s.attachShader(P,d),i.index0AttributeName!==void 0?s.bindAttribLocation(P,0,i.index0AttributeName):i.morphTargets===!0&&s.bindAttribLocation(P,0,"position"),s.linkProgram(P),t.debug.checkShaderErrors&&(t=s.getProgramInfoLog(P).trim(),A=s.getShaderInfoLog(c).trim(),S=s.getShaderInfoLog(d).trim(),w=z=!0,s.getProgramParameter(P,35714)===!1?(z=!1,I=l1(s,c,"vertex"),E=l1(s,d,"fragment"),console.error("THREE.WebGLProgram: shader error: ",s.getError(),"35715",s.getProgramParameter(P,35715),"gl.getProgramInfoLog",t,I,E)):t!==""?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",t):(A===""||S==="")&&(w=!1),w&&(this.diagnostics={runnable:z,programLog:t,vertexShader:{log:A,prefix:f},fragmentShader:{log:S,prefix:p}})),s.deleteShader(c),s.deleteShader(d);var F;this.getUniforms=function(){return F===void 0&&(F=new Ls(s,P)),F};var X;return this.getAttributes=function(){if(X===void 0){for(var q={},J=s.getProgramParameter(P,35721),it=0;it<J;it++){var lt=s.getActiveAttrib(P,it).name;q[lt]=s.getAttribLocation(P,lt)}X=q}return X},this.destroy=function(){s.deleteProgram(P),this.program=void 0},this.name=i.shaderName,this.id=KI++,this.cacheKey=r,this.usedTimes=1,this.program=P,this.vertexShader=c,this.fragmentShader=d,this}function Lu(t,r,i){function s(E){if(E)E.isTexture?P=E.encoding:E.isWebGLRenderTarget&&(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),P=E.texture.encoding);else var P=3e3;return P}var f=[],c=i.isWebGL2,d=i.logarithmicDepthBuffer,p=i.floatVertexTextures,A=i.precision,S=i.maxVertexUniforms,z=i.vertexTextures,w={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},I="precision isWebGL2 supportsVertexTextures outputEncoding instancing map mapEncoding matcap matcapEncoding envMap envMapMode envMapEncoding envMapCubeUV lightMap lightMapEncoding aoMap emissiveMap emissiveMapEncoding bumpMap normalMap objectSpaceNormalMap tangentSpaceNormalMap clearcoatMap clearcoatRoughnessMap clearcoatNormalMap displacementMap specularMap roughnessMap metalnessMap gradientMap alphaMap combine vertexColors vertexTangents vertexUvs uvsVertexOnly fog useFog fogExp2 flatShading sizeAttenuation logarithmicDepthBuffer skinning maxBones useVertexTexture morphTargets morphNormals maxMorphTargets maxMorphNormals premultipliedAlpha numDirLights numPointLights numSpotLights numHemiLights numRectAreaLights numDirLightShadows numPointLightShadows numSpotLightShadows shadowMapEnabled shadowMapType toneMapping physicallyCorrectLights alphaTest doubleSided flipSided numClippingPlanes numClipIntersection depthPacking dithering sheen".split(" ");this.getParameters=function(E,P,F,X,q,J,it){var lt=X.fog;X=E.isMeshStandardMaterial?X.environment:null,X=E.envMap||X;var Mt=w[E.type];if(it.isSkinnedMesh){var Ct=it.skeleton.bones;if(p)Ct=1024;else{var wt=Math.min(Math.floor((S-20)/4),Ct.length);wt<Ct.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+Ct.length+" bones. This GPU supports "+wt+"."),Ct=0):Ct=wt}}else Ct=0;E.precision!==null&&(A=i.getMaxPrecision(E.precision),A!==E.precision&&console.warn("THREE.WebGLProgram.getParameters:",E.precision,"not supported, using",A,"instead.")),Mt?(wt=th[Mt],wt={name:E.type,uniforms:ap.clone(wt.uniforms),vertexShader:wt.vertexShader,fragmentShader:wt.fragmentShader}):wt={name:E.type,uniforms:E.uniforms,vertexShader:E.vertexShader,fragmentShader:E.fragmentShader},E.onBeforeCompile(wt,t);var zt=t.getRenderTarget();return{isWebGL2:c,shaderID:Mt,shaderName:wt.name,uniforms:wt.uniforms,vertexShader:wt.vertexShader,fragmentShader:wt.fragmentShader,defines:E.defines,isRawShaderMaterial:E.isRawShaderMaterial,isShaderMaterial:E.isShaderMaterial,precision:A,instancing:it.isInstancedMesh===!0,supportsVertexTextures:z,outputEncoding:zt!==null?s(zt.texture):t.outputEncoding,map:!!E.map,mapEncoding:s(E.map),matcap:!!E.matcap,matcapEncoding:s(E.matcap),envMap:!!X,envMapMode:X&&X.mapping,envMapEncoding:s(X),envMapCubeUV:!!X&&(X.mapping===306||X.mapping===307),lightMap:!!E.lightMap,lightMapEncoding:s(E.lightMap),aoMap:!!E.aoMap,emissiveMap:!!E.emissiveMap,emissiveMapEncoding:s(E.emissiveMap),bumpMap:!!E.bumpMap,normalMap:!!E.normalMap,objectSpaceNormalMap:E.normalMapType===1,tangentSpaceNormalMap:E.normalMapType===0,clearcoatMap:!!E.clearcoatMap,clearcoatRoughnessMap:!!E.clearcoatRoughnessMap,clearcoatNormalMap:!!E.clearcoatNormalMap,displacementMap:!!E.displacementMap,roughnessMap:!!E.roughnessMap,metalnessMap:!!E.metalnessMap,specularMap:!!E.specularMap,alphaMap:!!E.alphaMap,gradientMap:!!E.gradientMap,sheen:!!E.sheen,combine:E.combine,vertexTangents:E.normalMap&&E.vertexTangents,vertexColors:E.vertexColors,vertexUvs:!!E.map||!!E.bumpMap||!!E.normalMap||!!E.specularMap||!!E.alphaMap||!!E.emissiveMap||!!E.roughnessMap||!!E.metalnessMap||!!E.clearcoatMap||!!E.clearcoatRoughnessMap||!!E.clearcoatNormalMap||!!E.displacementMap,uvsVertexOnly:!(E.map||E.bumpMap||E.normalMap||E.specularMap||E.alphaMap||E.emissiveMap||E.roughnessMap||E.metalnessMap||E.clearcoatNormalMap)&&!!E.displacementMap,fog:!!lt,useFog:E.fog,fogExp2:lt&&lt.isFogExp2,flatShading:E.flatShading,sizeAttenuation:E.sizeAttenuation,logarithmicDepthBuffer:d,skinning:E.skinning&&0<Ct,maxBones:Ct,useVertexTexture:p,morphTargets:E.morphTargets,morphNormals:E.morphNormals,maxMorphTargets:t.maxMorphTargets,maxMorphNormals:t.maxMorphNormals,numDirLights:P.directional.length,numPointLights:P.point.length,numSpotLights:P.spot.length,numRectAreaLights:P.rectArea.length,numHemiLights:P.hemi.length,numDirLightShadows:P.directionalShadowMap.length,numPointLightShadows:P.pointShadowMap.length,numSpotLightShadows:P.spotShadowMap.length,numClippingPlanes:q,numClipIntersection:J,dithering:E.dithering,shadowMapEnabled:t.shadowMap.enabled&&0<F.length,shadowMapType:t.shadowMap.type,toneMapping:E.toneMapped?t.toneMapping:0,physicallyCorrectLights:t.physicallyCorrectLights,premultipliedAlpha:E.premultipliedAlpha,alphaTest:E.alphaTest,doubleSided:E.side===2,flipSided:E.side===1,depthPacking:E.depthPacking!==void 0?E.depthPacking:!1,index0AttributeName:E.index0AttributeName,extensionDerivatives:E.extensions&&E.extensions.derivatives,extensionFragDepth:E.extensions&&E.extensions.fragDepth,extensionDrawBuffers:E.extensions&&E.extensions.drawBuffers,extensionShaderTextureLOD:E.extensions&&E.extensions.shaderTextureLOD,rendererExtensionFragDepth:c||r.get("EXT_frag_depth")!==null,rendererExtensionDrawBuffers:c||r.get("WEBGL_draw_buffers")!==null,rendererExtensionShaderTextureLod:c||r.get("EXT_shader_texture_lod")!==null,onBeforeCompile:E.onBeforeCompile}},this.getProgramCacheKey=function(E){var P=[];if(E.shaderID?P.push(E.shaderID):(P.push(E.fragmentShader),P.push(E.vertexShader)),E.defines!==void 0)for(var F in E.defines)P.push(F),P.push(E.defines[F]);if(E.isRawShaderMaterial===void 0){for(F=0;F<I.length;F++)P.push(E[I[F]]);P.push(t.outputEncoding),P.push(t.gammaFactor)}return P.push(E.onBeforeCompile.toString()),P.join()},this.acquireProgram=function(E,P){for(var F,X=0,q=f.length;X<q;X++){var J=f[X];if(J.cacheKey===P){F=J,++F.usedTimes;break}}return F===void 0&&(F=new Yo(t,P,E),f.push(F)),F},this.releaseProgram=function(E){if(--E.usedTimes===0){var P=f.indexOf(E);f[P]=f[f.length-1],f.pop(),E.destroy()}},this.programs=f}function Na(){var t=new ki;return{get:function(r){var i=t.get(r);return i===void 0&&(i={},t.set(r,i)),i},remove:function(r){t.delete(r)},update:function(r,i,s){t.get(r)[i]=s},dispose:function(){t=new ki}}}function lo(t,r){return t.groupOrder!==r.groupOrder?t.groupOrder-r.groupOrder:t.renderOrder!==r.renderOrder?t.renderOrder-r.renderOrder:t.program!==r.program?t.program.id-r.program.id:t.material.id!==r.material.id?t.material.id-r.material.id:t.z!==r.z?t.z-r.z:t.id-r.id}function Ar(t,r){return t.groupOrder!==r.groupOrder?t.groupOrder-r.groupOrder:t.renderOrder!==r.renderOrder?t.renderOrder-r.renderOrder:t.z!==r.z?r.z-t.z:t.id-r.id}function rf(){function t(d,p,A,S,z,w){var I=r[i];return I===void 0?(I={id:d.id,object:d,geometry:p,material:A,program:A.program||c,groupOrder:S,renderOrder:d.renderOrder,z,group:w},r[i]=I):(I.id=d.id,I.object=d,I.geometry=p,I.material=A,I.program=A.program||c,I.groupOrder=S,I.renderOrder=d.renderOrder,I.z=z,I.group=w),i++,I}var r=[],i=0,s=[],f=[],c={id:-1};return{opaque:s,transparent:f,init:function(){i=0,s.length=0,f.length=0},push:function(d,p,A,S,z,w){d=t(d,p,A,S,z,w),(A.transparent===!0?f:s).push(d)},unshift:function(d,p,A,S,z,w){d=t(d,p,A,S,z,w),(A.transparent===!0?f:s).unshift(d)},finish:function(){for(var d=i,p=r.length;d<p;d++){var A=r[d];if(A.id===null)break;A.id=null,A.object=null,A.geometry=null,A.material=null,A.program=null,A.group=null}},sort:function(d,p){1<s.length&&s.sort(d||lo),1<f.length&&f.sort(p||Ar)}}}function yA(){function t(i){i=i.target,i.removeEventListener("dispose",t),r.delete(i)}var r=new ki;return{get:function(i,s){var f=r.get(i);if(f===void 0){var c=new rf;r.set(i,new ki),r.get(i).set(s,c),i.addEventListener("dispose",t)}else c=f.get(s),c===void 0&&(c=new rf,f.set(s,c));return c},dispose:function(){r=new ki}}}function xA(){var t={};return{get:function(r){if(t[r.id]!==void 0)return t[r.id];switch(r.type){case"DirectionalLight":var i={direction:new dt,color:new Oe};break;case"SpotLight":i={position:new dt,direction:new dt,color:new Oe,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":i={position:new dt,color:new Oe,distance:0,decay:0};break;case"HemisphereLight":i={direction:new dt,skyColor:new Oe,groundColor:new Oe};break;case"RectAreaLight":i={color:new Oe,position:new dt,halfWidth:new dt,halfHeight:new dt}}return t[r.id]=i}}}function bn(){var t={};return{get:function(r){if(t[r.id]!==void 0)return t[r.id];switch(r.type){case"DirectionalLight":var i={shadowBias:0,shadowRadius:1,shadowMapSize:new Ot};break;case"SpotLight":i={shadowBias:0,shadowRadius:1,shadowMapSize:new Ot};break;case"PointLight":i={shadowBias:0,shadowRadius:1,shadowMapSize:new Ot,shadowCameraNear:1,shadowCameraFar:1e3}}return t[r.id]=i}}}function dg(t,r){return(r.castShadow?1:0)-(t.castShadow?1:0)}function ed(){for(var t=new xA,r=bn(),i={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]},s=0;9>s;s++)i.probe.push(new dt);var f=new dt,c=new Me,d=new Me;return{setup:function(p,A,S){for(var z=0,w=0,I=0,E=0;9>E;E++)i.probe[E].set(0,0,0);var P=A=0,F=0,X=0,q=0,J=0,it=0,lt=0;S=S.matrixWorldInverse,p.sort(dg),E=0;for(var Mt=p.length;E<Mt;E++){var Ct=p[E],wt=Ct.color,zt=Ct.intensity,Ut=Ct.distance,Kt=Ct.shadow&&Ct.shadow.map?Ct.shadow.map.texture:null;if(Ct.isAmbientLight)z+=wt.r*zt,w+=wt.g*zt,I+=wt.b*zt;else if(Ct.isLightProbe)for(Kt=0;9>Kt;Kt++)i.probe[Kt].addScaledVector(Ct.sh.coefficients[Kt],zt);else if(Ct.isDirectionalLight){var Gt=t.get(Ct);Gt.color.copy(Ct.color).multiplyScalar(Ct.intensity),Gt.direction.setFromMatrixPosition(Ct.matrixWorld),f.setFromMatrixPosition(Ct.target.matrixWorld),Gt.direction.sub(f),Gt.direction.transformDirection(S),Ct.castShadow&&(zt=Ct.shadow,wt=r.get(Ct),wt.shadowBias=zt.bias,wt.shadowRadius=zt.radius,wt.shadowMapSize=zt.mapSize,i.directionalShadow[A]=wt,i.directionalShadowMap[A]=Kt,i.directionalShadowMatrix[A]=Ct.shadow.matrix,J++),i.directional[A]=Gt,A++}else Ct.isSpotLight?(Gt=t.get(Ct),Gt.position.setFromMatrixPosition(Ct.matrixWorld),Gt.position.applyMatrix4(S),Gt.color.copy(wt).multiplyScalar(zt),Gt.distance=Ut,Gt.direction.setFromMatrixPosition(Ct.matrixWorld),f.setFromMatrixPosition(Ct.target.matrixWorld),Gt.direction.sub(f),Gt.direction.transformDirection(S),Gt.coneCos=Math.cos(Ct.angle),Gt.penumbraCos=Math.cos(Ct.angle*(1-Ct.penumbra)),Gt.decay=Ct.decay,Ct.castShadow&&(zt=Ct.shadow,wt=r.get(Ct),wt.shadowBias=zt.bias,wt.shadowRadius=zt.radius,wt.shadowMapSize=zt.mapSize,i.spotShadow[F]=wt,i.spotShadowMap[F]=Kt,i.spotShadowMatrix[F]=Ct.shadow.matrix,lt++),i.spot[F]=Gt,F++):Ct.isRectAreaLight?(Gt=t.get(Ct),Gt.color.copy(wt).multiplyScalar(zt),Gt.position.setFromMatrixPosition(Ct.matrixWorld),Gt.position.applyMatrix4(S),d.identity(),c.copy(Ct.matrixWorld),c.premultiply(S),d.extractRotation(c),Gt.halfWidth.set(.5*Ct.width,0,0),Gt.halfHeight.set(0,.5*Ct.height,0),Gt.halfWidth.applyMatrix4(d),Gt.halfHeight.applyMatrix4(d),i.rectArea[X]=Gt,X++):Ct.isPointLight?(Gt=t.get(Ct),Gt.position.setFromMatrixPosition(Ct.matrixWorld),Gt.position.applyMatrix4(S),Gt.color.copy(Ct.color).multiplyScalar(Ct.intensity),Gt.distance=Ct.distance,Gt.decay=Ct.decay,Ct.castShadow&&(zt=Ct.shadow,wt=r.get(Ct),wt.shadowBias=zt.bias,wt.shadowRadius=zt.radius,wt.shadowMapSize=zt.mapSize,wt.shadowCameraNear=zt.camera.near,wt.shadowCameraFar=zt.camera.far,i.pointShadow[P]=wt,i.pointShadowMap[P]=Kt,i.pointShadowMatrix[P]=Ct.shadow.matrix,it++),i.point[P]=Gt,P++):Ct.isHemisphereLight&&(Gt=t.get(Ct),Gt.direction.setFromMatrixPosition(Ct.matrixWorld),Gt.direction.transformDirection(S),Gt.direction.normalize(),Gt.skyColor.copy(Ct.color).multiplyScalar(zt),Gt.groundColor.copy(Ct.groundColor).multiplyScalar(zt),i.hemi[q]=Gt,q++)}i.ambient[0]=z,i.ambient[1]=w,i.ambient[2]=I,p=i.hash,(p.directionalLength!==A||p.pointLength!==P||p.spotLength!==F||p.rectAreaLength!==X||p.hemiLength!==q||p.numDirectionalShadows!==J||p.numPointShadows!==it||p.numSpotShadows!==lt)&&(i.directional.length=A,i.spot.length=F,i.rectArea.length=X,i.point.length=P,i.hemi.length=q,i.directionalShadow.length=J,i.directionalShadowMap.length=J,i.pointShadow.length=it,i.pointShadowMap.length=it,i.spotShadow.length=lt,i.spotShadowMap.length=lt,i.directionalShadowMatrix.length=J,i.pointShadowMatrix.length=it,i.spotShadowMatrix.length=lt,p.directionalLength=A,p.pointLength=P,p.spotLength=F,p.rectAreaLength=X,p.hemiLength=q,p.numDirectionalShadows=J,p.numPointShadows=it,p.numSpotShadows=lt,i.version=$I++)},state:i}}function nf(){var t=new ed,r=[],i=[];return{init:function(){r.length=0,i.length=0},state:{lightsArray:r,shadowsArray:i,lights:t},setupLights:function(s){t.setup(r,i,s)},pushLight:function(s){r.push(s)},pushShadow:function(s){i.push(s)}}}function AA(){function t(i){i=i.target,i.removeEventListener("dispose",t),r.delete(i)}var r=new ki;return{get:function(i,s){if(r.has(i)===!1){var f=new nf;r.set(i,new ki),r.get(i).set(s,f),i.addEventListener("dispose",t)}else r.get(i).has(s)===!1?(f=new nf,r.get(i).set(s,f)):f=r.get(i).get(s);return f},dispose:function(){r=new ki}}}function wl(t){Rr.call(this),this.type="MeshDepthMaterial",this.depthPacking=3200,this.morphTargets=this.skinning=!1,this.displacementMap=this.alphaMap=this.map=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.setValues(t)}function Ml(t){Rr.call(this),this.type="MeshDistanceMaterial",this.referencePosition=new dt,this.nearDistance=1,this.farDistance=1e3,this.morphTargets=this.skinning=!1,this.displacementMap=this.alphaMap=this.map=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.setValues(t)}function Vr(t,r,i){function s(lt,Mt,Ct){Ct=lt<<0|Mt<<1|Ct<<2;var wt=w[Ct];return wt===void 0&&(wt=new wl({depthPacking:3201,morphTargets:lt,skinning:Mt}),w[Ct]=wt),wt}function f(lt,Mt,Ct){Ct=lt<<0|Mt<<1|Ct<<2;var wt=I[Ct];return wt===void 0&&(wt=new Ml({morphTargets:lt,skinning:Mt}),I[Ct]=wt),wt}function c(lt,Mt,Ct,wt,zt,Ut,Kt){var Gt=s,Qt=lt.customDepthMaterial;return wt.isPointLight===!0&&(Gt=f,Qt=lt.customDistanceMaterial),Qt===void 0?(Qt=!1,Ct.morphTargets===!0&&(Qt=Mt.morphAttributes&&Mt.morphAttributes.position&&0<Mt.morphAttributes.position.length),Mt=!1,lt.isSkinnedMesh===!0&&(Ct.skinning===!0?Mt=!0:console.warn("THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:",lt)),lt=Gt(Qt,Mt,lt.isInstancedMesh===!0)):lt=Qt,t.localClippingEnabled&&Ct.clipShadows===!0&&Ct.clippingPlanes.length!==0&&(Qt=lt.uuid,Gt=Ct.uuid,Mt=E[Qt],Mt===void 0&&(Mt={},E[Qt]=Mt),Qt=Mt[Gt],Qt===void 0&&(Qt=lt.clone(),Mt[Gt]=Qt),lt=Qt),lt.visible=Ct.visible,lt.wireframe=Ct.wireframe,lt.side=Kt===3?Ct.shadowSide!==null?Ct.shadowSide:Ct.side:Ct.shadowSide!==null?Ct.shadowSide:P[Ct.side],lt.clipShadows=Ct.clipShadows,lt.clippingPlanes=Ct.clippingPlanes,lt.clipIntersection=Ct.clipIntersection,lt.wireframeLinewidth=Ct.wireframeLinewidth,lt.linewidth=Ct.linewidth,wt.isPointLight===!0&&lt.isMeshDistanceMaterial===!0&&(lt.referencePosition.setFromMatrixPosition(wt.matrixWorld),lt.nearDistance=zt,lt.farDistance=Ut),lt}function d(lt,Mt,Ct,wt,zt){if(lt.visible!==!1){if(lt.layers.test(Mt.layers)&&(lt.isMesh||lt.isLine||lt.isPoints)&&(lt.castShadow||lt.receiveShadow&&zt===3)&&(!lt.frustumCulled||p.intersectsObject(lt))){lt.modelViewMatrix.multiplyMatrices(Ct.matrixWorldInverse,lt.matrixWorld);var Ut=r.update(lt),Kt=lt.material;if(Array.isArray(Kt))for(var Gt=Ut.groups,Qt=0,De=Gt.length;Qt<De;Qt++){var re=Gt[Qt],We=Kt[re.materialIndex];We&&We.visible&&(We=c(lt,Ut,We,wt,Ct.near,Ct.far,zt),t.renderBufferDirect(Ct,null,Ut,We,lt,re))}else Kt.visible&&(We=c(lt,Ut,Kt,wt,Ct.near,Ct.far,zt),t.renderBufferDirect(Ct,null,Ut,We,lt,null))}for(lt=lt.children,Ut=0,Kt=lt.length;Ut<Kt;Ut++)d(lt[Ut],Mt,Ct,wt,zt)}}var p=new Su,A=new Ot,S=new Ot,z=new jt,w=[],I=[],E={},P={0:1,1:0,2:2},F=new Ki({defines:{SAMPLE_RATE:.25,HALF_SAMPLE_RATE:.125},uniforms:{shadow_pass:{value:null},resolution:{value:new Ot},radius:{value:4}},vertexShader:`void main() {
	gl_Position = vec4( position, 1.0 );
}`,fragmentShader:`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
  float mean = 0.0;
  float squared_mean = 0.0;
	float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy  ) / resolution ) );
  for ( float i = -1.0; i < 1.0 ; i += SAMPLE_RATE) {
    #ifdef HORIZONAL_PASS
      vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( i, 0.0 ) * radius ) / resolution ) );
      mean += distribution.x;
      squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
    #else
      float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0,  i )  * radius ) / resolution ) );
      mean += depth;
      squared_mean += depth * depth;
    #endif
  }
  mean = mean * HALF_SAMPLE_RATE;
  squared_mean = squared_mean * HALF_SAMPLE_RATE;
  float std_dev = sqrt( squared_mean - mean * mean );
  gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`}),X=F.clone();X.defines.HORIZONAL_PASS=1;var q=new ke;q.setAttribute("position",new wr(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));var J=new Zi(q,F),it=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=1,this.render=function(lt,Mt,Ct){if(it.enabled!==!1&&(it.autoUpdate!==!1||it.needsUpdate!==!1)&&lt.length!==0){var wt=t.getRenderTarget(),zt=t.getActiveCubeFace(),Ut=t.getActiveMipmapLevel(),Kt=t.state;Kt.setBlending(0),Kt.buffers.color.setClear(1,1,1,1),Kt.buffers.depth.setTest(!0),Kt.setScissorTest(!1);for(var Gt=0,Qt=lt.length;Gt<Qt;Gt++){var De=lt[Gt],re=De.shadow;if(re===void 0)console.warn("THREE.WebGLShadowMap:",De,"has no shadow.");else{A.copy(re.mapSize);var We=re.getFrameExtents();A.multiply(We),S.copy(re.mapSize),(A.x>i||A.y>i)&&(A.x>i&&(S.x=Math.floor(i/We.x),A.x=S.x*We.x,re.mapSize.x=S.x),A.y>i&&(S.y=Math.floor(i/We.y),A.y=S.y*We.y,re.mapSize.y=S.y)),re.map!==null||re.isPointLightShadow||this.type!==3||(We={minFilter:1006,magFilter:1006,format:1023},re.map=new pe(A.x,A.y,We),re.map.texture.name=De.name+".shadowMap",re.mapPass=new pe(A.x,A.y,We),re.camera.updateProjectionMatrix()),re.map===null&&(We={minFilter:1003,magFilter:1003,format:1023},re.map=new pe(A.x,A.y,We),re.map.texture.name=De.name+".shadowMap",re.camera.updateProjectionMatrix()),t.setRenderTarget(re.map),t.clear(),We=re.getViewportCount();for(var hr=0;hr<We;hr++){var Je=re.getViewport(hr);z.set(S.x*Je.x,S.y*Je.y,S.x*Je.z,S.y*Je.w),Kt.viewport(z),re.updateMatrices(De,hr),p=re.getFrustum(),d(Mt,Ct,re.camera,De,this.type)}re.isPointLightShadow||this.type!==3||(De=re,re=Ct,We=r.update(J),F.uniforms.shadow_pass.value=De.map.texture,F.uniforms.resolution.value=De.mapSize,F.uniforms.radius.value=De.radius,t.setRenderTarget(De.mapPass),t.clear(),t.renderBufferDirect(re,null,We,F,J,null),X.uniforms.shadow_pass.value=De.mapPass.texture,X.uniforms.resolution.value=De.mapSize,X.uniforms.radius.value=De.radius,t.setRenderTarget(De.map),t.clear(),t.renderBufferDirect(re,null,We,X,J,null))}}it.needsUpdate=!1,t.setRenderTarget(wt,zt,Ut)}}}function f1(t,r,i){function s(yt,he,de){var ue=new Uint8Array(4),te=t.createTexture();for(t.bindTexture(yt,te),t.texParameteri(yt,10241,9728),t.texParameteri(yt,10240,9728),yt=0;yt<de;yt++)t.texImage2D(he+yt,0,6408,1,1,0,6408,5121,ue);return te}function f(yt,he){J[yt]=1,it[yt]===0&&(t.enableVertexAttribArray(yt),it[yt]=1),lt[yt]!==he&&((P?t:r.get("ANGLE_instanced_arrays"))[P?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](yt,he),lt[yt]=he)}function c(yt){Mt[yt]!==!0&&(t.enable(yt),Mt[yt]=!0)}function d(yt){Mt[yt]!==!1&&(t.disable(yt),Mt[yt]=!1)}function p(yt,he,de,ue,te,Ae,cr,Cr){if(yt===0)wt&&(d(3042),wt=!1);else if(wt||(c(3042),wt=!0),yt!==5){if(yt!==zt||Cr!==We){if((Ut!==100||Qt!==100)&&(t.blendEquation(32774),Qt=Ut=100),Cr)switch(yt){case 1:t.blendFuncSeparate(1,771,1,771);break;case 2:t.blendFunc(1,1);break;case 3:t.blendFuncSeparate(0,0,769,771);break;case 4:t.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",yt)}else switch(yt){case 1:t.blendFuncSeparate(770,771,1,771);break;case 2:t.blendFunc(770,1);break;case 3:t.blendFunc(0,769);break;case 4:t.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",yt)}re=De=Gt=Kt=null,zt=yt,We=Cr}}else te=te||he,Ae=Ae||de,cr=cr||ue,(he!==Ut||te!==Qt)&&(t.blendEquationSeparate(kt[he],kt[te]),Ut=he,Qt=te),(de!==Kt||ue!==Gt||Ae!==De||cr!==re)&&(t.blendFuncSeparate(Zt[de],Zt[ue],Zt[Ae],Zt[cr]),Kt=de,Gt=ue,De=Ae,re=cr),zt=yt,We=null}function A(yt){hr!==yt&&(yt?t.frontFace(2304):t.frontFace(2305),hr=yt)}function S(yt){yt!==0?(c(2884),yt!==Je&&(yt===1?t.cullFace(1029):yt===2?t.cullFace(1028):t.cullFace(1032))):d(2884),Je=yt}function z(yt,he,de){yt?(c(32823),(nr!==he||xt!==de)&&(t.polygonOffset(he,de),nr=he,xt=de)):d(32823)}function w(yt){yt===void 0&&(yt=33984+At-1),Rt!==yt&&(t.activeTexture(yt),Rt=yt)}var I,E,P=i.isWebGL2,F=new function(){var yt=!1,he=new jt,de=null,ue=new jt(0,0,0,0);return{setMask:function(te){de===te||yt||(t.colorMask(te,te,te,te),de=te)},setLocked:function(te){yt=te},setClear:function(te,Ae,cr,Cr,me){me===!0&&(te*=Cr,Ae*=Cr,cr*=Cr),he.set(te,Ae,cr,Cr),ue.equals(he)===!1&&(t.clearColor(te,Ae,cr,Cr),ue.copy(he))},reset:function(){yt=!1,de=null,ue.set(-1,0,0,0)}}},X=new function(){var yt=!1,he=null,de=null,ue=null;return{setTest:function(te){te?c(2929):d(2929)},setMask:function(te){he===te||yt||(t.depthMask(te),he=te)},setFunc:function(te){if(de!==te){if(te)switch(te){case 0:t.depthFunc(512);break;case 1:t.depthFunc(519);break;case 2:t.depthFunc(513);break;case 3:t.depthFunc(515);break;case 4:t.depthFunc(514);break;case 5:t.depthFunc(518);break;case 6:t.depthFunc(516);break;case 7:t.depthFunc(517);break;default:t.depthFunc(515)}else t.depthFunc(515);de=te}},setLocked:function(te){yt=te},setClear:function(te){ue!==te&&(t.clearDepth(te),ue=te)},reset:function(){yt=!1,ue=de=he=null}}},q=new function(){var yt=!1,he=null,de=null,ue=null,te=null,Ae=null,cr=null,Cr=null,me=null;return{setTest:function(Qe){yt||(Qe?c(2960):d(2960))},setMask:function(Qe){he===Qe||yt||(t.stencilMask(Qe),he=Qe)},setFunc:function(Qe,Fr,be){(de!==Qe||ue!==Fr||te!==be)&&(t.stencilFunc(Qe,Fr,be),de=Qe,ue=Fr,te=be)},setOp:function(Qe,Fr,be){(Ae!==Qe||cr!==Fr||Cr!==be)&&(t.stencilOp(Qe,Fr,be),Ae=Qe,cr=Fr,Cr=be)},setLocked:function(Qe){yt=Qe},setClear:function(Qe){me!==Qe&&(t.clearStencil(Qe),me=Qe)},reset:function(){yt=!1,me=Cr=cr=Ae=te=ue=de=he=null}}};i=t.getParameter(34921);var J=new Uint8Array(i),it=new Uint8Array(i),lt=new Uint8Array(i),Mt={},Ct=null,wt=null,zt=null,Ut=null,Kt=null,Gt=null,Qt=null,De=null,re=null,We=!1,hr=null,Je=null,qr=null,nr=null,xt=null,At=t.getParameter(35661),_t=!1;i=0,i=t.getParameter(7938),i.indexOf("WebGL")!==-1?(i=parseFloat(/^WebGL ([0-9])/.exec(i)[1]),_t=1<=i):i.indexOf("OpenGL ES")!==-1&&(i=parseFloat(/^OpenGL ES ([0-9])/.exec(i)[1]),_t=2<=i);var Rt=null,st={},gt=new jt,vt=new jt,Pt={};Pt[3553]=s(3553,3553,1),Pt[34067]=s(34067,34069,6),F.setClear(0,0,0,1),X.setClear(1),q.setClear(0),c(2929),X.setFunc(3),A(!1),S(1),c(2884),p(0);var kt=(I={},Si(I,100,32774),Si(I,101,32778),Si(I,102,32779),I);P?(kt[103]=32775,kt[104]=32776):(I=r.get("EXT_blend_minmax"),I!==null&&(kt[103]=I.MIN_EXT,kt[104]=I.MAX_EXT));var Zt=(E={},Si(E,200,0),Si(E,201,1),Si(E,202,768),Si(E,204,770),Si(E,210,776),Si(E,208,774),Si(E,206,772),Si(E,203,769),Si(E,205,771),Si(E,209,775),Si(E,207,773),E);return{buffers:{color:F,depth:X,stencil:q},initAttributes:function(){for(var yt=0,he=J.length;yt<he;yt++)J[yt]=0},enableAttribute:function(yt){f(yt,0)},enableAttributeAndDivisor:f,disableUnusedAttributes:function(){for(var yt=0,he=it.length;yt!==he;++yt)it[yt]!==J[yt]&&(t.disableVertexAttribArray(yt),it[yt]=0)},vertexAttribPointer:function(yt,he,de,ue,te,Ae){P!==!0||de!==5124&&de!==5125?t.vertexAttribPointer(yt,he,de,ue,te,Ae):t.vertexAttribIPointer(yt,he,de,ue,te,Ae)},enable:c,disable:d,useProgram:function(yt){return Ct!==yt?(t.useProgram(yt),Ct=yt,!0):!1},setBlending:p,setMaterial:function(yt,he){yt.side===2?d(2884):c(2884);var de=yt.side===1;he&&(de=!de),A(de),yt.blending===1&&yt.transparent===!1?p(0):p(yt.blending,yt.blendEquation,yt.blendSrc,yt.blendDst,yt.blendEquationAlpha,yt.blendSrcAlpha,yt.blendDstAlpha,yt.premultipliedAlpha),X.setFunc(yt.depthFunc),X.setTest(yt.depthTest),X.setMask(yt.depthWrite),F.setMask(yt.colorWrite),he=yt.stencilWrite,q.setTest(he),he&&(q.setMask(yt.stencilWriteMask),q.setFunc(yt.stencilFunc,yt.stencilRef,yt.stencilFuncMask),q.setOp(yt.stencilFail,yt.stencilZFail,yt.stencilZPass)),z(yt.polygonOffset,yt.polygonOffsetFactor,yt.polygonOffsetUnits)},setFlipSided:A,setCullFace:S,setLineWidth:function(yt){yt!==qr&&(_t&&t.lineWidth(yt),qr=yt)},setPolygonOffset:z,setScissorTest:function(yt){yt?c(3089):d(3089)},activeTexture:w,bindTexture:function(yt,he){Rt===null&&w();var de=st[Rt];de===void 0&&(de={type:void 0,texture:void 0},st[Rt]=de),(de.type!==yt||de.texture!==he)&&(t.bindTexture(yt,he||Pt[yt]),de.type=yt,de.texture=he)},unbindTexture:function(){var yt=st[Rt];yt!==void 0&&yt.type!==void 0&&(t.bindTexture(yt.type,null),yt.type=void 0,yt.texture=void 0)},compressedTexImage2D:function(){try{t.compressedTexImage2D.apply(t,arguments)}catch(yt){console.error("THREE.WebGLState:",yt)}},texImage2D:function(){try{t.texImage2D.apply(t,arguments)}catch(yt){console.error("THREE.WebGLState:",yt)}},texImage3D:function(){try{t.texImage3D.apply(t,arguments)}catch(yt){console.error("THREE.WebGLState:",yt)}},scissor:function(yt){gt.equals(yt)===!1&&(t.scissor(yt.x,yt.y,yt.z,yt.w),gt.copy(yt))},viewport:function(yt){vt.equals(yt)===!1&&(t.viewport(yt.x,yt.y,yt.z,yt.w),vt.copy(yt))},reset:function(){for(var yt=0;yt<it.length;yt++)it[yt]===1&&(t.disableVertexAttribArray(yt),it[yt]=0);Mt={},Rt=null,st={},Je=hr=zt=Ct=null,F.reset(),X.reset(),q.reset()}}}function _A(t,r,i,s,f,c,d){function p(st,gt){return qr?new OffscreenCanvas(st,gt):document.createElementNS("http://www.w3.org/1999/xhtml","canvas")}function A(st,gt,vt,Pt){var kt=1;if((st.width>Pt||st.height>Pt)&&(kt=Pt/Math.max(st.width,st.height)),1>kt||gt===!0){if(typeof HTMLImageElement!="undefined"&&st instanceof HTMLImageElement||typeof HTMLCanvasElement!="undefined"&&st instanceof HTMLCanvasElement||typeof ImageBitmap!="undefined"&&st instanceof ImageBitmap)return Pt=gt?ti.floorPowerOfTwo:Math.floor,gt=Pt(kt*st.width),kt=Pt(kt*st.height),Je===void 0&&(Je=p(gt,kt)),vt=vt?p(gt,kt):Je,vt.width=gt,vt.height=kt,vt.getContext("2d").drawImage(st,0,0,gt,kt),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+st.width+"x"+st.height+") to ("+gt+"x"+kt+")."),vt;"data"in st&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+st.width+"x"+st.height+").")}return st}function S(st){return ti.isPowerOfTwo(st.width)&&ti.isPowerOfTwo(st.height)}function z(st,gt){return st.generateMipmaps&&gt&&st.minFilter!==1003&&st.minFilter!==1006}function w(st,gt,vt,Pt){t.generateMipmap(st),s.get(gt).__maxMipLevel=Math.log(Math.max(vt,Pt))*Math.LOG2E}function I(st,gt,vt){if(Gt===!1)return gt;if(st!==null){if(t[st]!==void 0)return t[st];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+st+"'")}return st=gt,gt===6403&&(vt===5126&&(st=33326),vt===5131&&(st=33325),vt===5121&&(st=33321)),gt===6407&&(vt===5126&&(st=34837),vt===5131&&(st=34843),vt===5121&&(st=32849)),gt===6408&&(vt===5126&&(st=34836),vt===5131&&(st=34842),vt===5121&&(st=32856)),st!==33325&&st!==33326&&st!==34842&&st!==34836||r.get("EXT_color_buffer_float"),st}function E(st){return st===1003||st===1004||st===1005?9728:9729}function P(st){st=st.target,st.removeEventListener("dispose",P);var gt=s.get(st);gt.__webglInit!==void 0&&(t.deleteTexture(gt.__webglTexture),s.remove(st)),st.isVideoTexture&&hr.delete(st),d.memory.textures--}function F(st){st=st.target,st.removeEventListener("dispose",F);var gt=s.get(st),vt=s.get(st.texture);if(st){if(vt.__webglTexture!==void 0&&t.deleteTexture(vt.__webglTexture),st.depthTexture&&st.depthTexture.dispose(),st.isWebGLCubeRenderTarget)for(vt=0;6>vt;vt++)t.deleteFramebuffer(gt.__webglFramebuffer[vt]),gt.__webglDepthbuffer&&t.deleteRenderbuffer(gt.__webglDepthbuffer[vt]);else t.deleteFramebuffer(gt.__webglFramebuffer),gt.__webglDepthbuffer&&t.deleteRenderbuffer(gt.__webglDepthbuffer),gt.__webglMultisampledFramebuffer&&t.deleteFramebuffer(gt.__webglMultisampledFramebuffer),gt.__webglColorRenderbuffer&&t.deleteRenderbuffer(gt.__webglColorRenderbuffer),gt.__webglDepthRenderbuffer&&t.deleteRenderbuffer(gt.__webglDepthRenderbuffer);s.remove(st.texture),s.remove(st)}d.memory.textures--}function X(st,gt){var vt=s.get(st);if(st.isVideoTexture){var Pt=d.render.frame;hr.get(st)!==Pt&&(hr.set(st,Pt),st.update())}if(0<st.version&&vt.__version!==st.version)if(Pt=st.image,Pt===void 0)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else if(Pt.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{Mt(vt,st,gt);return}i.activeTexture(33984+gt),i.bindTexture(3553,vt.__webglTexture)}function q(st,gt){if(st.image.length===6){var vt=s.get(st);if(0<st.version&&vt.__version!==st.version){lt(vt,st),i.activeTexture(33984+gt),i.bindTexture(34067,vt.__webglTexture),t.pixelStorei(37440,st.flipY);var Pt=st&&(st.isCompressedTexture||st.image[0].isCompressedTexture);gt=st.image[0]&&st.image[0].isDataTexture;for(var kt=[],Zt=0;6>Zt;Zt++)kt[Zt]=Pt||gt?gt?st.image[Zt].image:st.image[Zt]:A(st.image[Zt],!1,!0,De);var yt=kt[0],he=S(yt)||Gt,de=c.convert(st.format),ue=c.convert(st.type),te=I(st.internalFormat,de,ue);if(it(34067,st,he),Pt){for(Zt=0;6>Zt;Zt++){var Ae=kt[Zt].mipmaps;for(Pt=0;Pt<Ae.length;Pt++){var cr=Ae[Pt];st.format!==1023&&st.format!==1022?de!==null?i.compressedTexImage2D(34069+Zt,Pt,te,cr.width,cr.height,0,cr.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):i.texImage2D(34069+Zt,Pt,te,cr.width,cr.height,0,de,ue,cr.data)}}vt.__maxMipLevel=Ae.length-1}else{for(Ae=st.mipmaps,Zt=0;6>Zt;Zt++)if(gt)for(i.texImage2D(34069+Zt,0,te,kt[Zt].width,kt[Zt].height,0,de,ue,kt[Zt].data),Pt=0;Pt<Ae.length;Pt++)cr=Ae[Pt],cr=cr.image[Zt].image,i.texImage2D(34069+Zt,Pt+1,te,cr.width,cr.height,0,de,ue,cr.data);else for(i.texImage2D(34069+Zt,0,te,de,ue,kt[Zt]),Pt=0;Pt<Ae.length;Pt++)cr=Ae[Pt],i.texImage2D(34069+Zt,Pt+1,te,de,ue,cr.image[Zt]);vt.__maxMipLevel=Ae.length}z(st,he)&&w(34067,st,yt.width,yt.height),vt.__version=st.version,st.onUpdate&&st.onUpdate(st)}else i.activeTexture(33984+gt),i.bindTexture(34067,vt.__webglTexture)}}function J(st,gt){i.activeTexture(33984+gt),i.bindTexture(34067,s.get(st).__webglTexture)}function it(st,gt,vt){vt?(t.texParameteri(st,10242,xt[gt.wrapS]),t.texParameteri(st,10243,xt[gt.wrapT]),st!==32879&&st!==35866||t.texParameteri(st,32882,xt[gt.wrapR]),t.texParameteri(st,10240,At[gt.magFilter]),t.texParameteri(st,10241,At[gt.minFilter])):(t.texParameteri(st,10242,33071),t.texParameteri(st,10243,33071),st!==32879&&st!==35866||t.texParameteri(st,32882,33071),gt.wrapS===1001&&gt.wrapT===1001||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),t.texParameteri(st,10240,E(gt.magFilter)),t.texParameteri(st,10241,E(gt.minFilter)),gt.minFilter!==1003&&gt.minFilter!==1006&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),!(vt=r.get("EXT_texture_filter_anisotropic"))||gt.type===1015&&r.get("OES_texture_float_linear")===null||gt.type===1016&&(Gt||r.get("OES_texture_half_float_linear"))===null||!(1<gt.anisotropy||s.get(gt).__currentAnisotropy)||(t.texParameterf(st,vt.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(gt.anisotropy,f.getMaxAnisotropy())),s.get(gt).__currentAnisotropy=gt.anisotropy)}function lt(st,gt){st.__webglInit===void 0&&(st.__webglInit=!0,gt.addEventListener("dispose",P),st.__webglTexture=t.createTexture(),d.memory.textures++)}function Mt(st,gt,vt){var Pt=3553;gt.isDataTexture2DArray&&(Pt=35866),gt.isDataTexture3D&&(Pt=32879),lt(st,gt),i.activeTexture(33984+vt),i.bindTexture(Pt,st.__webglTexture),t.pixelStorei(37440,gt.flipY),t.pixelStorei(37441,gt.premultiplyAlpha),t.pixelStorei(3317,gt.unpackAlignment),vt=Gt?!1:gt.wrapS!==1001||gt.wrapT!==1001||gt.minFilter!==1003&&gt.minFilter!==1006,vt=vt&&S(gt.image)===!1,vt=A(gt.image,vt,!1,re);var kt=S(vt)||Gt,Zt=c.convert(gt.format),yt=c.convert(gt.type),he=I(gt.internalFormat,Zt,yt);it(Pt,gt,kt);var de=gt.mipmaps;if(gt.isDepthTexture)he=6402,Gt?he=gt.type===1015?36012:gt.type===1014?33190:gt.type===1020?35056:33189:gt.type===1015&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),gt.format===1026&&he===6402&&gt.type!==1012&&gt.type!==1014&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),gt.type=1012,yt=c.convert(gt.type)),gt.format===1027&&he===6402&&(he=34041,gt.type!==1020&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),gt.type=1020,yt=c.convert(gt.type))),i.texImage2D(3553,0,he,vt.width,vt.height,0,Zt,yt,null);else if(gt.isDataTexture)if(0<de.length&&kt){for(var ue=0,te=de.length;ue<te;ue++){var Ae=de[ue];i.texImage2D(3553,ue,he,Ae.width,Ae.height,0,Zt,yt,Ae.data)}gt.generateMipmaps=!1,st.__maxMipLevel=de.length-1}else i.texImage2D(3553,0,he,vt.width,vt.height,0,Zt,yt,vt.data),st.__maxMipLevel=0;else if(gt.isCompressedTexture){for(ue=0,te=de.length;ue<te;ue++)Ae=de[ue],gt.format!==1023&&gt.format!==1022?Zt!==null?i.compressedTexImage2D(3553,ue,he,Ae.width,Ae.height,0,Ae.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):i.texImage2D(3553,ue,he,Ae.width,Ae.height,0,Zt,yt,Ae.data);st.__maxMipLevel=de.length-1}else if(gt.isDataTexture2DArray)i.texImage3D(35866,0,he,vt.width,vt.height,vt.depth,0,Zt,yt,vt.data),st.__maxMipLevel=0;else if(gt.isDataTexture3D)i.texImage3D(32879,0,he,vt.width,vt.height,vt.depth,0,Zt,yt,vt.data),st.__maxMipLevel=0;else if(0<de.length&&kt){for(ue=0,te=de.length;ue<te;ue++)Ae=de[ue],i.texImage2D(3553,ue,he,Zt,yt,Ae);gt.generateMipmaps=!1,st.__maxMipLevel=de.length-1}else i.texImage2D(3553,0,he,Zt,yt,vt),st.__maxMipLevel=0;z(gt,kt)&&w(Pt,gt,vt.width,vt.height),st.__version=gt.version,gt.onUpdate&&gt.onUpdate(gt)}function Ct(st,gt,vt,Pt){var kt=c.convert(gt.texture.format),Zt=c.convert(gt.texture.type),yt=I(gt.texture.internalFormat,kt,Zt);i.texImage2D(Pt,0,yt,gt.width,gt.height,0,kt,Zt,null),t.bindFramebuffer(36160,st),t.framebufferTexture2D(36160,vt,Pt,s.get(gt.texture).__webglTexture,0),t.bindFramebuffer(36160,null)}function wt(st,gt,vt){if(t.bindRenderbuffer(36161,st),gt.depthBuffer&&!gt.stencilBuffer){var Pt=33189;vt?((vt=gt.depthTexture)&&vt.isDepthTexture&&(vt.type===1015?Pt=36012:vt.type===1014&&(Pt=33190)),vt=zt(gt),t.renderbufferStorageMultisample(36161,vt,Pt,gt.width,gt.height)):t.renderbufferStorage(36161,Pt,gt.width,gt.height),t.framebufferRenderbuffer(36160,36096,36161,st)}else gt.depthBuffer&&gt.stencilBuffer?(vt?(vt=zt(gt),t.renderbufferStorageMultisample(36161,vt,35056,gt.width,gt.height)):t.renderbufferStorage(36161,34041,gt.width,gt.height),t.framebufferRenderbuffer(36160,33306,36161,st)):(st=c.convert(gt.texture.format),Pt=c.convert(gt.texture.type),Pt=I(gt.texture.internalFormat,st,Pt),vt?(vt=zt(gt),t.renderbufferStorageMultisample(36161,vt,Pt,gt.width,gt.height)):t.renderbufferStorage(36161,Pt,gt.width,gt.height));t.bindRenderbuffer(36161,null)}function zt(st){return Gt&&st.isWebGLMultisampleRenderTarget?Math.min(We,st.samples):0}var Ut,Kt,Gt=f.isWebGL2,Qt=f.maxTextures,De=f.maxCubemapSize,re=f.maxTextureSize,We=f.maxSamples,hr=new ki,Je,qr=!1;try{qr=typeof OffscreenCanvas!="undefined"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}var nr=0,xt=(Ut={},Si(Ut,1e3,10497),Si(Ut,1001,33071),Si(Ut,1002,33648),Ut),At=(Kt={},Si(Kt,1003,9728),Si(Kt,1004,9984),Si(Kt,1005,9986),Si(Kt,1006,9729),Si(Kt,1007,9985),Si(Kt,1008,9987),Kt),_t=!1,Rt=!1;this.allocateTextureUnit=function(){var st=nr;return st>=Qt&&console.warn("THREE.WebGLTextures: Trying to use "+st+" texture units while this GPU supports only "+Qt),nr+=1,st},this.resetTextureUnits=function(){nr=0},this.setTexture2D=X,this.setTexture2DArray=function(st,gt){var vt=s.get(st);0<st.version&&vt.__version!==st.version?Mt(vt,st,gt):(i.activeTexture(33984+gt),i.bindTexture(35866,vt.__webglTexture))},this.setTexture3D=function(st,gt){var vt=s.get(st);0<st.version&&vt.__version!==st.version?Mt(vt,st,gt):(i.activeTexture(33984+gt),i.bindTexture(32879,vt.__webglTexture))},this.setTextureCube=q,this.setTextureCubeDynamic=J,this.setupRenderTarget=function(st){var gt=s.get(st),vt=s.get(st.texture);st.addEventListener("dispose",F),vt.__webglTexture=t.createTexture(),d.memory.textures++;var Pt=st.isWebGLCubeRenderTarget===!0,kt=st.isWebGLMultisampleRenderTarget===!0,Zt=S(st)||Gt;if(!Gt||st.texture.format!==1022||st.texture.type!==1015&&st.texture.type!==1016||(st.texture.format=1023,console.warn("THREE.WebGLRenderer: Rendering to textures with RGB format is not supported. Using RGBA format instead.")),Pt)for(gt.__webglFramebuffer=[],kt=0;6>kt;kt++)gt.__webglFramebuffer[kt]=t.createFramebuffer();else if(gt.__webglFramebuffer=t.createFramebuffer(),kt)if(Gt){gt.__webglMultisampledFramebuffer=t.createFramebuffer(),gt.__webglColorRenderbuffer=t.createRenderbuffer(),t.bindRenderbuffer(36161,gt.__webglColorRenderbuffer),kt=c.convert(st.texture.format);var yt=c.convert(st.texture.type);kt=I(st.texture.internalFormat,kt,yt),yt=zt(st),t.renderbufferStorageMultisample(36161,yt,kt,st.width,st.height),t.bindFramebuffer(36160,gt.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(36160,36064,36161,gt.__webglColorRenderbuffer),t.bindRenderbuffer(36161,null),st.depthBuffer&&(gt.__webglDepthRenderbuffer=t.createRenderbuffer(),wt(gt.__webglDepthRenderbuffer,st,!0)),t.bindFramebuffer(36160,null)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.");if(Pt){for(i.bindTexture(34067,vt.__webglTexture),it(34067,st.texture,Zt),kt=0;6>kt;kt++)Ct(gt.__webglFramebuffer[kt],st,36064,34069+kt);z(st.texture,Zt)&&w(34067,st.texture,st.width,st.height),i.bindTexture(34067,null)}else i.bindTexture(3553,vt.__webglTexture),it(3553,st.texture,Zt),Ct(gt.__webglFramebuffer,st,36064,3553),z(st.texture,Zt)&&w(3553,st.texture,st.width,st.height),i.bindTexture(3553,null);if(st.depthBuffer){if(gt=s.get(st),vt=st.isWebGLCubeRenderTarget===!0,st.depthTexture){if(vt)throw Error("target.depthTexture not supported in Cube render targets");if(st&&st.isWebGLCubeRenderTarget)throw Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(36160,gt.__webglFramebuffer),!st.depthTexture||!st.depthTexture.isDepthTexture)throw Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");if(s.get(st.depthTexture).__webglTexture&&st.depthTexture.image.width===st.width&&st.depthTexture.image.height===st.height||(st.depthTexture.image.width=st.width,st.depthTexture.image.height=st.height,st.depthTexture.needsUpdate=!0),X(st.depthTexture,0),gt=s.get(st.depthTexture).__webglTexture,st.depthTexture.format===1026)t.framebufferTexture2D(36160,36096,3553,gt,0);else if(st.depthTexture.format===1027)t.framebufferTexture2D(36160,33306,3553,gt,0);else throw Error("Unknown depthTexture format")}else if(vt)for(gt.__webglDepthbuffer=[],vt=0;6>vt;vt++)t.bindFramebuffer(36160,gt.__webglFramebuffer[vt]),gt.__webglDepthbuffer[vt]=t.createRenderbuffer(),wt(gt.__webglDepthbuffer[vt],st,!1);else t.bindFramebuffer(36160,gt.__webglFramebuffer),gt.__webglDepthbuffer=t.createRenderbuffer(),wt(gt.__webglDepthbuffer,st,!1);t.bindFramebuffer(36160,null)}},this.updateRenderTargetMipmap=function(st){var gt=st.texture,vt=S(st)||Gt;if(z(gt,vt)){vt=st.isWebGLCubeRenderTarget?34067:3553;var Pt=s.get(gt).__webglTexture;i.bindTexture(vt,Pt),w(vt,gt,st.width,st.height),i.bindTexture(vt,null)}},this.updateMultisampleRenderTarget=function(st){if(st.isWebGLMultisampleRenderTarget)if(Gt){var gt=s.get(st);t.bindFramebuffer(36008,gt.__webglMultisampledFramebuffer),t.bindFramebuffer(36009,gt.__webglFramebuffer);var vt=st.width,Pt=st.height,kt=16384;st.depthBuffer&&(kt|=256),st.stencilBuffer&&(kt|=1024),t.blitFramebuffer(0,0,vt,Pt,0,0,vt,Pt,kt,9728),t.bindFramebuffer(36160,gt.__webglMultisampledFramebuffer)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")},this.safeSetTexture2D=function(st,gt){st&&st.isWebGLRenderTarget&&(_t===!1&&(console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),_t=!0),st=st.texture),X(st,gt)},this.safeSetTextureCube=function(st,gt){st&&st.isWebGLCubeRenderTarget&&(Rt===!1&&(console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),Rt=!0),st=st.texture),st&&st.isCubeTexture||Array.isArray(st.image)&&st.image.length===6?q(st,gt):J(st,gt)}}function p1(t,r,i){var s=i.isWebGL2;return{convert:function(f){if(f===1009)return 5121;if(f===1017)return 32819;if(f===1018)return 32820;if(f===1019)return 33635;if(f===1010)return 5120;if(f===1011)return 5122;if(f===1012)return 5123;if(f===1013)return 5124;if(f===1014)return 5125;if(f===1015)return 5126;if(f===1016){if(s)return 5131;var c=r.get("OES_texture_half_float");return c!==null?c.HALF_FLOAT_OES:null}if(f===1021)return 6406;if(f===1022)return 6407;if(f===1023)return 6408;if(f===1024)return 6409;if(f===1025)return 6410;if(f===1026)return 6402;if(f===1027)return 34041;if(f===1028)return 6403;if(f===1029)return 36244;if(f===1030)return 33319;if(f===1031)return 33320;if(f===1032)return 36248;if(f===1033)return 36249;if(f===33776||f===33777||f===33778||f===33779)if(c=r.get("WEBGL_compressed_texture_s3tc"),c!==null){if(f===33776)return c.COMPRESSED_RGB_S3TC_DXT1_EXT;if(f===33777)return c.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(f===33778)return c.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(f===33779)return c.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(f===35840||f===35841||f===35842||f===35843)if(c=r.get("WEBGL_compressed_texture_pvrtc"),c!==null){if(f===35840)return c.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(f===35841)return c.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(f===35842)return c.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(f===35843)return c.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(f===36196)return c=r.get("WEBGL_compressed_texture_etc1"),c!==null?c.COMPRESSED_RGB_ETC1_WEBGL:null;if((f===37492||f===37496)&&(c=r.get("WEBGL_compressed_texture_etc"),c!==null)){if(f===37492)return c.COMPRESSED_RGB8_ETC2;if(f===37496)return c.COMPRESSED_RGBA8_ETC2_EAC}if(f===37808||f===37809||f===37810||f===37811||f===37812||f===37813||f===37814||f===37815||f===37816||f===37817||f===37818||f===37819||f===37820||f===37821||f===37840||f===37841||f===37842||f===37843||f===37844||f===37845||f===37846||f===37847||f===37848||f===37849||f===37850||f===37851||f===37852||f===37853)return c=r.get("WEBGL_compressed_texture_astc"),c!==null?f:null;if(f===36492)return c=r.get("EXT_texture_compression_bptc"),c!==null?f:null;if(f===1020)return s?34042:(c=r.get("WEBGL_depth_texture"),c!==null?c.UNSIGNED_INT_24_8_WEBGL:null)}}}function mg(t){en.call(this),this.cameras=t||[]}function Zo(){fe.call(this),this.type="Group"}function ur(){this._grip=this._targetRay=null}function d1(t,r){function i(Ut){var Kt=P.get(Ut.inputSource);Kt&&Kt.dispatchEvent({type:Ut.type})}function s(){P.forEach(function(Ut,Kt){Ut.disconnect(Kt)}),P.clear(),t.setFramebuffer(null),t.setRenderTarget(t.getRenderTarget()),zt.stop(),p.isPresenting=!1,p.dispatchEvent({type:"sessionend"})}function f(Ut){z=Ut,zt.setContext(A),zt.start(),p.isPresenting=!0,p.dispatchEvent({type:"sessionstart"})}function c(Ut){for(var Kt=A.inputSources,Gt=0;Gt<E.length;Gt++)P.set(Kt[Gt],E[Gt]);for(Gt=0;Gt<Ut.removed.length;Gt++){Kt=Ut.removed[Gt];var Qt=P.get(Kt);Qt&&(Qt.dispatchEvent({type:"disconnected",data:Kt}),P.delete(Kt))}for(Gt=0;Gt<Ut.added.length;Gt++)Kt=Ut.added[Gt],(Qt=P.get(Kt))&&Qt.dispatchEvent({type:"connected",data:Kt})}function d(Ut,Kt){Kt===null?Ut.matrixWorld.copy(Ut.matrix):Ut.matrixWorld.multiplyMatrices(Kt.matrixWorld,Ut.matrix),Ut.matrixWorldInverse.getInverse(Ut.matrixWorld)}var p=this,A=null,S=1,z=null,w="local-floor",I=null,E=[],P=new vv,F=new en;F.layers.enable(1),F.viewport=new jt;var X=new en;X.layers.enable(2),X.viewport=new jt;var q=[F,X],J=new mg;J.layers.enable(1),J.layers.enable(2);var it=null,lt=null;this.isPresenting=this.enabled=!1,this.getController=function(Ut){var Kt=E[Ut];return Kt===void 0&&(Kt=new ur,E[Ut]=Kt),Kt.getTargetRaySpace()},this.getControllerGrip=function(Ut){var Kt=E[Ut];return Kt===void 0&&(Kt=new ur,E[Ut]=Kt),Kt.getGripSpace()},this.setFramebufferScaleFactor=function(Ut){S=Ut,p.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(Ut){w=Ut,p.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return z},this.getSession=function(){return A},this.setSession=function(Ut){A=Ut,A!==null&&(A.addEventListener("select",i),A.addEventListener("selectstart",i),A.addEventListener("selectend",i),A.addEventListener("squeeze",i),A.addEventListener("squeezestart",i),A.addEventListener("squeezeend",i),A.addEventListener("end",s),Ut=r.getContextAttributes(),Ut.xrCompatible!==!0&&r.makeXRCompatible(),Ut=new XRWebGLLayer(A,r,{antialias:Ut.antialias,alpha:Ut.alpha,depth:Ut.depth,stencil:Ut.stencil,framebufferScaleFactor:S}),A.updateRenderState({baseLayer:Ut}),A.requestReferenceSpace(w).then(f),A.addEventListener("inputsourceschange",c))};var Mt=new dt,Ct=new dt;this.getCamera=function(Ut){J.near=X.near=F.near=Ut.near,J.far=X.far=F.far=Ut.far,(it!==J.near||lt!==J.far)&&(A.updateRenderState({depthNear:J.near,depthFar:J.far}),it=J.near,lt=J.far);var Kt=Ut.parent,Gt=J.cameras;d(J,Kt);for(var Qt=0;Qt<Gt.length;Qt++)d(Gt[Qt],Kt);for(Ut.matrixWorld.copy(J.matrixWorld),Ut=Ut.children,Qt=0,Kt=Ut.length;Qt<Kt;Qt++)Ut[Qt].updateMatrixWorld(!0);if(Gt.length===2){Mt.setFromMatrixPosition(F.matrixWorld),Ct.setFromMatrixPosition(X.matrixWorld),Gt=Mt.distanceTo(Ct);var De=F.projectionMatrix.elements,re=X.projectionMatrix.elements,We=De[14]/(De[10]-1);Qt=De[14]/(De[10]+1),Ut=(De[9]+1)/De[5],Kt=(De[9]-1)/De[5];var hr=(De[8]-1)/De[0],Je=(re[8]+1)/re[0];re=We*hr,De=We*Je,Je=Gt/(-hr+Je),hr=Je*-hr,F.matrixWorld.decompose(J.position,J.quaternion,J.scale),J.translateX(hr),J.translateZ(Je),J.matrixWorld.compose(J.position,J.quaternion,J.scale),J.matrixWorldInverse.getInverse(J.matrixWorld),We+=Je,Je=Qt+Je,J.projectionMatrix.makePerspective(re-hr,De+(Gt-hr),Ut*Qt/Je*We,Kt*Qt/Je*We,We,Je)}else J.projectionMatrix.copy(F.projectionMatrix);return J};var wt=null,zt=new qc;zt.setAnimationLoop(function(Ut,Kt){if(I=Kt.getViewerPose(z),I!==null){var Gt=I.views,Qt=A.renderState.baseLayer;t.setFramebuffer(Qt.framebuffer);var De=!1;Gt.length!==J.cameras.length&&(J.cameras.length=0,De=!0);for(var re=0;re<Gt.length;re++){var We=Gt[re],hr=Qt.getViewport(We),Je=q[re];Je.matrix.fromArray(We.transform.matrix),Je.projectionMatrix.fromArray(We.projectionMatrix),Je.viewport.set(hr.x,hr.y,hr.width,hr.height),re===0&&J.matrix.copy(Je.matrix),De===!0&&J.cameras.push(Je)}}for(Gt=A.inputSources,re=0;re<E.length;re++)E[re].update(Gt[re],Kt,z);wt&&wt(Ut,Kt)}),this.setAnimationLoop=function(Ut){wt=Ut},this.dispose=function(){}}function wA(t){function r(s,f,c){if(s.opacity.value=f.opacity,f.color&&s.diffuse.value.copy(f.color),f.emissive&&s.emissive.value.copy(f.emissive).multiplyScalar(f.emissiveIntensity),f.map&&(s.map.value=f.map),f.alphaMap&&(s.alphaMap.value=f.alphaMap),f.specularMap&&(s.specularMap.value=f.specularMap),(c=f.envMap||c)&&(s.envMap.value=c,s.flipEnvMap.value=c.isCubeTexture?-1:1,s.reflectivity.value=f.reflectivity,s.refractionRatio.value=f.refractionRatio,s.maxMipLevel.value=t.get(c).__maxMipLevel),f.lightMap&&(s.lightMap.value=f.lightMap,s.lightMapIntensity.value=f.lightMapIntensity),f.aoMap&&(s.aoMap.value=f.aoMap,s.aoMapIntensity.value=f.aoMapIntensity),f.map)var d=f.map;else f.specularMap?d=f.specularMap:f.displacementMap?d=f.displacementMap:f.normalMap?d=f.normalMap:f.bumpMap?d=f.bumpMap:f.roughnessMap?d=f.roughnessMap:f.metalnessMap?d=f.metalnessMap:f.alphaMap?d=f.alphaMap:f.emissiveMap&&(d=f.emissiveMap);if(d!==void 0&&(d.isWebGLRenderTarget&&(d=d.texture),d.matrixAutoUpdate===!0&&d.updateMatrix(),s.uvTransform.value.copy(d.matrix)),f.aoMap)var p=f.aoMap;else f.lightMap&&(p=f.lightMap);p!==void 0&&(p.isWebGLRenderTarget&&(p=p.texture),p.matrixAutoUpdate===!0&&p.updateMatrix(),s.uv2Transform.value.copy(p.matrix))}function i(s,f,c){s.roughness.value=f.roughness,s.metalness.value=f.metalness,f.roughnessMap&&(s.roughnessMap.value=f.roughnessMap),f.metalnessMap&&(s.metalnessMap.value=f.metalnessMap),f.emissiveMap&&(s.emissiveMap.value=f.emissiveMap),f.bumpMap&&(s.bumpMap.value=f.bumpMap,s.bumpScale.value=f.bumpScale,f.side===1&&(s.bumpScale.value*=-1)),f.normalMap&&(s.normalMap.value=f.normalMap,s.normalScale.value.copy(f.normalScale),f.side===1&&s.normalScale.value.negate()),f.displacementMap&&(s.displacementMap.value=f.displacementMap,s.displacementScale.value=f.displacementScale,s.displacementBias.value=f.displacementBias),(f.envMap||c)&&(s.envMapIntensity.value=f.envMapIntensity)}return{refreshFogUniforms:function(s,f){s.fogColor.value.copy(f.color),f.isFog?(s.fogNear.value=f.near,s.fogFar.value=f.far):f.isFogExp2&&(s.fogDensity.value=f.density)},refreshMaterialUniforms:function(s,f,c,d,p){if(f.isMeshBasicMaterial)r(s,f);else if(f.isMeshLambertMaterial)r(s,f),f.emissiveMap&&(s.emissiveMap.value=f.emissiveMap);else if(f.isMeshToonMaterial)r(s,f),s.specular.value.copy(f.specular),s.shininess.value=Math.max(f.shininess,1e-4),f.gradientMap&&(s.gradientMap.value=f.gradientMap),f.emissiveMap&&(s.emissiveMap.value=f.emissiveMap),f.bumpMap&&(s.bumpMap.value=f.bumpMap,s.bumpScale.value=f.bumpScale,f.side===1&&(s.bumpScale.value*=-1)),f.normalMap&&(s.normalMap.value=f.normalMap,s.normalScale.value.copy(f.normalScale),f.side===1&&s.normalScale.value.negate()),f.displacementMap&&(s.displacementMap.value=f.displacementMap,s.displacementScale.value=f.displacementScale,s.displacementBias.value=f.displacementBias);else if(f.isMeshPhongMaterial)r(s,f),s.specular.value.copy(f.specular),s.shininess.value=Math.max(f.shininess,1e-4),f.emissiveMap&&(s.emissiveMap.value=f.emissiveMap),f.bumpMap&&(s.bumpMap.value=f.bumpMap,s.bumpScale.value=f.bumpScale,f.side===1&&(s.bumpScale.value*=-1)),f.normalMap&&(s.normalMap.value=f.normalMap,s.normalScale.value.copy(f.normalScale),f.side===1&&s.normalScale.value.negate()),f.displacementMap&&(s.displacementMap.value=f.displacementMap,s.displacementScale.value=f.displacementScale,s.displacementBias.value=f.displacementBias);else if(f.isMeshStandardMaterial)r(s,f,c),f.isMeshPhysicalMaterial?(i(s,f,c),s.reflectivity.value=f.reflectivity,s.clearcoat.value=f.clearcoat,s.clearcoatRoughness.value=f.clearcoatRoughness,f.sheen&&s.sheen.value.copy(f.sheen),f.clearcoatMap&&(s.clearcoatMap.value=f.clearcoatMap),f.clearcoatRoughnessMap&&(s.clearcoatRoughnessMap.value=f.clearcoatRoughnessMap),f.clearcoatNormalMap&&(s.clearcoatNormalScale.value.copy(f.clearcoatNormalScale),s.clearcoatNormalMap.value=f.clearcoatNormalMap,f.side===1&&s.clearcoatNormalScale.value.negate()),s.transparency.value=f.transparency):i(s,f,c);else if(f.isMeshMatcapMaterial)r(s,f),f.matcap&&(s.matcap.value=f.matcap),f.bumpMap&&(s.bumpMap.value=f.bumpMap,s.bumpScale.value=f.bumpScale,f.side===1&&(s.bumpScale.value*=-1)),f.normalMap&&(s.normalMap.value=f.normalMap,s.normalScale.value.copy(f.normalScale),f.side===1&&s.normalScale.value.negate()),f.displacementMap&&(s.displacementMap.value=f.displacementMap,s.displacementScale.value=f.displacementScale,s.displacementBias.value=f.displacementBias);else if(f.isMeshDepthMaterial)r(s,f),f.displacementMap&&(s.displacementMap.value=f.displacementMap,s.displacementScale.value=f.displacementScale,s.displacementBias.value=f.displacementBias);else if(f.isMeshDistanceMaterial)r(s,f),f.displacementMap&&(s.displacementMap.value=f.displacementMap,s.displacementScale.value=f.displacementScale,s.displacementBias.value=f.displacementBias),s.referencePosition.value.copy(f.referencePosition),s.nearDistance.value=f.nearDistance,s.farDistance.value=f.farDistance;else if(f.isMeshNormalMaterial)r(s,f),f.bumpMap&&(s.bumpMap.value=f.bumpMap,s.bumpScale.value=f.bumpScale,f.side===1&&(s.bumpScale.value*=-1)),f.normalMap&&(s.normalMap.value=f.normalMap,s.normalScale.value.copy(f.normalScale),f.side===1&&s.normalScale.value.negate()),f.displacementMap&&(s.displacementMap.value=f.displacementMap,s.displacementScale.value=f.displacementScale,s.displacementBias.value=f.displacementBias);else if(f.isLineBasicMaterial)s.diffuse.value.copy(f.color),s.opacity.value=f.opacity,f.isLineDashedMaterial&&(s.dashSize.value=f.dashSize,s.totalSize.value=f.dashSize+f.gapSize,s.scale.value=f.scale);else if(f.isPointsMaterial){if(s.diffuse.value.copy(f.color),s.opacity.value=f.opacity,s.size.value=f.size*d,s.scale.value=.5*p,f.map&&(s.map.value=f.map),f.alphaMap&&(s.alphaMap.value=f.alphaMap),f.map)var A=f.map;else f.alphaMap&&(A=f.alphaMap);A!==void 0&&(A.matrixAutoUpdate===!0&&A.updateMatrix(),s.uvTransform.value.copy(A.matrix))}else if(f.isSpriteMaterial){if(s.diffuse.value.copy(f.color),s.opacity.value=f.opacity,s.rotation.value=f.rotation,f.map&&(s.map.value=f.map),f.alphaMap&&(s.alphaMap.value=f.alphaMap),f.map)var S=f.map;else f.alphaMap&&(S=f.alphaMap);S!==void 0&&(S.matrixAutoUpdate===!0&&S.updateMatrix(),s.uvTransform.value.copy(S.matrix))}else f.isShadowMaterial?(s.color.value.copy(f.color),s.opacity.value=f.opacity):f.isShaderMaterial&&(f.uniformsNeedUpdate=!1)}}}function ra(t){var r;function i(){Qe=new xl(me),Fr=new lg(me,Qe,t),Fr.isWebGL2===!1&&(Qe.get("WEBGL_depth_texture"),Qe.get("OES_texture_float"),Qe.get("OES_texture_half_float"),Qe.get("OES_texture_half_float_linear"),Qe.get("OES_standard_derivatives"),Qe.get("OES_element_index_uint"),Qe.get("ANGLE_instanced_arrays")),Qe.get("OES_texture_float_linear"),ko=new p1(me,Qe,Fr),be=new f1(me,Qe,Fr),be.scissor(_t.copy(yt).multiplyScalar(vt).floor()),be.viewport(At.copy(Zt).multiplyScalar(vt).floor()),mn=new as,hi=new Na,Co=new _A(me,Qe,be,hi,Fr,ko,mn),_a=new Jc(me,Fr),rh=new i1(me,_a,mn),ws=new ta(me,rh,_a,mn),ix=new qp(me),tl=new Lu(Ut,Qe,Fr),el=new wA(hi),ns=new yA,au=new AA,go=new Kc(Ut,be,ws,it),nx=new ug(me,Qe,mn,Fr),wa=new Iu(me,Qe,mn,Fr),mn.programs=tl.programs,Ut.capabilities=Fr,Ut.extensions=Qe,Ut.properties=hi,Ut.renderLists=ns,Ut.state=be,Ut.info=mn}function s(It){It.preventDefault(),Kt=!0}function f(){Kt=!1,i()}function c(It){It=It.target,It.removeEventListener("dispose",c),d(It),hi.remove(It)}function d(It){var ge=hi.get(It).program;It.program=void 0,ge!==void 0&&tl.releaseProgram(ge)}function p(It,ge){It.render(function(Xt){Ut.renderBufferImmediate(Xt,ge)})}function A(It,ge,Xt,Te){if(It.visible!==!1){if(It.layers.test(ge.layers)){if(It.isGroup)Xt=It.renderOrder;else if(It.isLOD)It.autoUpdate===!0&&It.update(ge);else if(It.isLight)zt.pushLight(It),It.castShadow&&zt.pushShadow(It);else if(It.isSprite){if(!It.frustumCulled||de.intersectsSprite(It)){Te&&Cr.setFromMatrixPosition(It.matrixWorld).applyMatrix4(cr);var Ve=ws.update(It),Kr=It.material;Kr.visible&&wt.push(It,Ve,Kr,Xt,Cr.z,null)}}else if(It.isImmediateRenderObject)Te&&Cr.setFromMatrixPosition(It.matrixWorld).applyMatrix4(cr),wt.push(It,null,It.material,Xt,Cr.z,null);else if((It.isMesh||It.isLine||It.isPoints)&&(It.isSkinnedMesh&&It.skeleton.frame!==mn.render.frame&&(It.skeleton.update(),It.skeleton.frame=mn.render.frame),!It.frustumCulled||de.intersectsObject(It)))if(Te&&Cr.setFromMatrixPosition(It.matrixWorld).applyMatrix4(cr),Ve=ws.update(It),Kr=It.material,Array.isArray(Kr))for(var rr=Ve.groups,Er=0,Jr=rr.length;Er<Jr;Er++){var _i=rr[Er],ci=Kr[_i.materialIndex];ci&&ci.visible&&wt.push(It,Ve,ci,Xt,Cr.z,_i)}else Kr.visible&&wt.push(It,Ve,Kr,Xt,Cr.z,null)}for(It=It.children,Er=0,Jr=It.length;Er<Jr;Er++)A(It[Er],ge,Xt,Te)}}function S(It,ge,Xt,Te){for(var Ve=0,Kr=It.length;Ve<Kr;Ve++){var rr=It[Ve],Er=rr.object,Jr=rr.geometry,_i=Te===void 0?rr.material:Te;if(rr=rr.group,Xt.isArrayCamera){xt=Xt;for(var ci=Xt.cameras,Ma=0,tn=ci.length;Ma<tn;Ma++){var Bn=ci[Ma];Er.layers.test(Bn.layers)&&(be.viewport(At.copy(Bn.viewport)),zt.setupLights(Bn),z(Er,ge,Bn,Jr,_i,rr))}}else xt=null,z(Er,ge,Xt,Jr,_i,rr)}}function z(It,ge,Xt,Te,Ve,Kr){if(It.onBeforeRender(Ut,ge,Xt,Te,Ve,Kr),zt=au.get(ge,xt||Xt),It.modelViewMatrix.multiplyMatrices(Xt.matrixWorldInverse,It.matrixWorld),It.normalMatrix.getNormalMatrix(It.modelViewMatrix),It.isImmediateRenderObject){var rr=I(Xt,ge,Ve,It);be.setMaterial(Ve),Je=r=null,qr=!1,p(It,rr)}else Ut.renderBufferDirect(Xt,ge,Te,Ve,It,Kr);It.onAfterRender(Ut,ge,Xt,Te,Ve,Kr),zt=au.get(ge,xt||Xt)}function w(It,ge,Xt){var Te=hi.get(It),Ve=zt.state.lights,Kr=Ve.state.version;Xt=tl.getParameters(It,Ve.state,zt.state.shadowsArray,ge,ue.numPlanes,ue.numIntersection,Xt);var rr=tl.getProgramCacheKey(Xt),Er=Te.program,Jr=!0;if(Er===void 0)It.addEventListener("dispose",c);else if(Er.cacheKey!==rr)d(It);else{if(Te.lightsStateVersion!==Kr)Te.lightsStateVersion=Kr;else if(Xt.shaderID!==void 0)return;Jr=!1}if(Jr&&(Er=tl.acquireProgram(Xt,rr),Te.program=Er,Te.uniforms=Xt.uniforms,Te.outputEncoding=Xt.outputEncoding,It.program=Er),Xt=Er.getAttributes(),It.morphTargets)for(rr=It.numSupportedMorphTargets=0;rr<Ut.maxMorphTargets;rr++)0<=Xt["morphTarget"+rr]&&It.numSupportedMorphTargets++;if(It.morphNormals)for(rr=It.numSupportedMorphNormals=0;rr<Ut.maxMorphNormals;rr++)0<=Xt["morphNormal"+rr]&&It.numSupportedMorphNormals++;Xt=Te.uniforms,(!It.isShaderMaterial&&!It.isRawShaderMaterial||It.clipping===!0)&&(Te.numClippingPlanes=ue.numPlanes,Te.numIntersection=ue.numIntersection,Xt.clippingPlanes=ue.uniform),Te.environment=It.isMeshStandardMaterial?ge.environment:null,Te.fog=ge.fog,Te.needsLights=It.isMeshLambertMaterial||It.isMeshToonMaterial||It.isMeshPhongMaterial||It.isMeshStandardMaterial||It.isShadowMaterial||It.isShaderMaterial&&It.lights===!0,Te.lightsStateVersion=Kr,Te.needsLights&&(Xt.ambientLightColor.value=Ve.state.ambient,Xt.lightProbe.value=Ve.state.probe,Xt.directionalLights.value=Ve.state.directional,Xt.directionalLightShadows.value=Ve.state.directionalShadow,Xt.spotLights.value=Ve.state.spot,Xt.spotLightShadows.value=Ve.state.spotShadow,Xt.rectAreaLights.value=Ve.state.rectArea,Xt.pointLights.value=Ve.state.point,Xt.pointLightShadows.value=Ve.state.pointShadow,Xt.hemisphereLights.value=Ve.state.hemi,Xt.directionalShadowMap.value=Ve.state.directionalShadowMap,Xt.directionalShadowMatrix.value=Ve.state.directionalShadowMatrix,Xt.spotShadowMap.value=Ve.state.spotShadowMap,Xt.spotShadowMatrix.value=Ve.state.spotShadowMatrix,Xt.pointShadowMap.value=Ve.state.pointShadowMap,Xt.pointShadowMatrix.value=Ve.state.pointShadowMatrix),It=Te.program.getUniforms(),It=Ls.seqWithValue(It.seq,Xt),Te.uniformsList=It}function I(It,ge,Xt,Te){Co.resetTextureUnits();var Ve=ge.fog,Kr=Xt.isMeshStandardMaterial?ge.environment:null,rr=re===null?Ut.outputEncoding:re.texture.encoding,Er=hi.get(Xt),Jr=zt.state.lights;te&&(Ae||It!==nr)&&ue.setState(Xt.clippingPlanes,Xt.clipIntersection,Xt.clipShadows,It,Er,It===nr&&Xt.id===hr),Xt.version===Er.__version?Er.program===void 0||Xt.fog&&Er.fog!==Ve||Er.environment!==Kr||Er.needsLights&&Er.lightsStateVersion!==Jr.state.version?w(Xt,ge,Te):Er.numClippingPlanes===void 0||Er.numClippingPlanes===ue.numPlanes&&Er.numIntersection===ue.numIntersection?Er.outputEncoding!==rr&&w(Xt,ge,Te):w(Xt,ge,Te):(w(Xt,ge,Te),Er.__version=Xt.version);var _i=!1,ci=!1,Ma=!1;if(ge=Er.program,rr=ge.getUniforms(),Jr=Er.uniforms,be.useProgram(ge.program)&&(Ma=ci=_i=!0),Xt.id!==hr&&(hr=Xt.id,ci=!0),(_i||nr!==It)&&(rr.setValue(me,"projectionMatrix",It.projectionMatrix),Fr.logarithmicDepthBuffer&&rr.setValue(me,"logDepthBufFC",2/(Math.log(It.far+1)/Math.LN2)),nr!==It&&(nr=It,Ma=ci=!0),(Xt.isShaderMaterial||Xt.isMeshPhongMaterial||Xt.isMeshToonMaterial||Xt.isMeshStandardMaterial||Xt.envMap)&&(_i=rr.map.cameraPosition,_i!==void 0&&_i.setValue(me,Cr.setFromMatrixPosition(It.matrixWorld))),(Xt.isMeshPhongMaterial||Xt.isMeshToonMaterial||Xt.isMeshLambertMaterial||Xt.isMeshBasicMaterial||Xt.isMeshStandardMaterial||Xt.isShaderMaterial)&&rr.setValue(me,"isOrthographic",It.isOrthographicCamera===!0),(Xt.isMeshPhongMaterial||Xt.isMeshToonMaterial||Xt.isMeshLambertMaterial||Xt.isMeshBasicMaterial||Xt.isMeshStandardMaterial||Xt.isShaderMaterial||Xt.skinning)&&rr.setValue(me,"viewMatrix",It.matrixWorldInverse)),Xt.skinning&&(rr.setOptional(me,Te,"bindMatrix"),rr.setOptional(me,Te,"bindMatrixInverse"),It=Te.skeleton))if(_i=It.bones,Fr.floatVertexTextures){if(It.boneTexture===void 0){_i=Math.sqrt(4*_i.length),_i=ti.ceilPowerOfTwo(_i),_i=Math.max(_i,4);var tn=new Float32Array(_i*_i*4);tn.set(It.boneMatrices);var Bn=new yl(tn,_i,_i,1023,1015);It.boneMatrices=tn,It.boneTexture=Bn,It.boneTextureSize=_i}rr.setValue(me,"boneTexture",It.boneTexture,Co),rr.setValue(me,"boneTextureSize",It.boneTextureSize)}else rr.setOptional(me,It,"boneMatrices");return(ci||Er.receiveShadow!==Te.receiveShadow)&&(Er.receiveShadow=Te.receiveShadow,rr.setValue(me,"receiveShadow",Te.receiveShadow)),ci&&(rr.setValue(me,"toneMappingExposure",Ut.toneMappingExposure),rr.setValue(me,"toneMappingWhitePoint",Ut.toneMappingWhitePoint),Er.needsLights&&(ci=Ma,Jr.ambientLightColor.needsUpdate=ci,Jr.lightProbe.needsUpdate=ci,Jr.directionalLights.needsUpdate=ci,Jr.directionalLightShadows.needsUpdate=ci,Jr.pointLights.needsUpdate=ci,Jr.pointLightShadows.needsUpdate=ci,Jr.spotLights.needsUpdate=ci,Jr.spotLightShadows.needsUpdate=ci,Jr.rectAreaLights.needsUpdate=ci,Jr.hemisphereLights.needsUpdate=ci),Ve&&Xt.fog&&el.refreshFogUniforms(Jr,Ve),el.refreshMaterialUniforms(Jr,Xt,Kr,vt,gt),Jr.ltc_1!==void 0&&(Jr.ltc_1.value=sr.LTC_1),Jr.ltc_2!==void 0&&(Jr.ltc_2.value=sr.LTC_2),Ls.upload(me,Er.uniformsList,Jr,Co)),Xt.isShaderMaterial&&Xt.uniformsNeedUpdate===!0&&(Ls.upload(me,Er.uniformsList,Jr,Co),Xt.uniformsNeedUpdate=!1),Xt.isSpriteMaterial&&rr.setValue(me,"center",Te.center),rr.setValue(me,"modelViewMatrix",Te.modelViewMatrix),rr.setValue(me,"normalMatrix",Te.normalMatrix),rr.setValue(me,"modelMatrix",Te.matrixWorld),ge}t=t||{};var E=t.canvas!==void 0?t.canvas:document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),P=t.context!==void 0?t.context:null,F=t.alpha!==void 0?t.alpha:!1,X=t.depth!==void 0?t.depth:!0,q=t.stencil!==void 0?t.stencil:!0,J=t.antialias!==void 0?t.antialias:!1,it=t.premultipliedAlpha!==void 0?t.premultipliedAlpha:!0,lt=t.preserveDrawingBuffer!==void 0?t.preserveDrawingBuffer:!1,Mt=t.powerPreference!==void 0?t.powerPreference:"default",Ct=t.failIfMajorPerformanceCaveat!==void 0?t.failIfMajorPerformanceCaveat:!1,wt=null,zt=null;this.domElement=E,this.debug={checkShaderErrors:!0},this.sortObjects=this.autoClearStencil=this.autoClearDepth=this.autoClearColor=this.autoClear=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.outputEncoding=3e3,this.physicallyCorrectLights=!1,this.toneMapping=0,this.toneMappingWhitePoint=this.toneMappingExposure=1,this.maxMorphTargets=8,this.maxMorphNormals=4;var Ut=this,Kt=!1,Gt=null,Qt=0,De=0,re=null,We=null,hr=-1,Je=r=null,qr=!1,nr=null,xt=null,At=new jt,_t=new jt,Rt=null,st=E.width,gt=E.height,vt=1,Pt=null,kt=null,Zt=new jt(0,0,st,gt),yt=new jt(0,0,st,gt),he=!1,de=new Su,ue=new r1,te=!1,Ae=!1,cr=new Me,Cr=new dt;try{F={alpha:F,depth:X,stencil:q,antialias:J,premultipliedAlpha:it,preserveDrawingBuffer:lt,powerPreference:Mt,failIfMajorPerformanceCaveat:Ct},E.addEventListener("webglcontextlost",s,!1),E.addEventListener("webglcontextrestored",f,!1);var me=P||E.getContext("webgl",F)||E.getContext("experimental-webgl",F);if(me===null)throw E.getContext("webgl")!==null?Error("Error creating WebGL context with your selected attributes."):Error("Error creating WebGL context.");me.getShaderPrecisionFormat===void 0&&(me.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(It){throw console.error("THREE.WebGLRenderer: "+It.message),It}var Qe,Fr,be,mn,hi,Co,_a,rh,ws,tl,el,ns,au,go,ix,nx,wa,ko;i();var os=new d1(Ut,me);this.xr=os;var ih=new Vr(Ut,ws,Fr.maxTextureSize);this.shadowMap=ih,this.getContext=function(){return me},this.getContextAttributes=function(){return me.getContextAttributes()},this.forceContextLoss=function(){var It=Qe.get("WEBGL_lose_context");It&&It.loseContext()},this.forceContextRestore=function(){var It=Qe.get("WEBGL_lose_context");It&&It.restoreContext()},this.getPixelRatio=function(){return vt},this.setPixelRatio=function(It){It!==void 0&&(vt=It,this.setSize(st,gt,!1))},this.getSize=function(It){return It===void 0&&(console.warn("WebGLRenderer: .getsize() now requires a Vector2 as an argument"),It=new Ot),It.set(st,gt)},this.setSize=function(It,ge,Xt){os.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(st=It,gt=ge,E.width=Math.floor(It*vt),E.height=Math.floor(ge*vt),Xt!==!1&&(E.style.width=It+"px",E.style.height=ge+"px"),this.setViewport(0,0,It,ge))},this.getDrawingBufferSize=function(It){return It===void 0&&(console.warn("WebGLRenderer: .getdrawingBufferSize() now requires a Vector2 as an argument"),It=new Ot),It.set(st*vt,gt*vt).floor()},this.setDrawingBufferSize=function(It,ge,Xt){st=It,gt=ge,vt=Xt,E.width=Math.floor(It*Xt),E.height=Math.floor(ge*Xt),this.setViewport(0,0,It,ge)},this.getCurrentViewport=function(It){return It===void 0&&(console.warn("WebGLRenderer: .getCurrentViewport() now requires a Vector4 as an argument"),It=new jt),It.copy(At)},this.getViewport=function(It){return It.copy(Zt)},this.setViewport=function(It,ge,Xt,Te){It.isVector4?Zt.set(It.x,It.y,It.z,It.w):Zt.set(It,ge,Xt,Te),be.viewport(At.copy(Zt).multiplyScalar(vt).floor())},this.getScissor=function(It){return It.copy(yt)},this.setScissor=function(It,ge,Xt,Te){It.isVector4?yt.set(It.x,It.y,It.z,It.w):yt.set(It,ge,Xt,Te),be.scissor(_t.copy(yt).multiplyScalar(vt).floor())},this.getScissorTest=function(){return he},this.setScissorTest=function(It){be.setScissorTest(he=It)},this.setOpaqueSort=function(It){Pt=It},this.setTransparentSort=function(It){kt=It},this.getClearColor=function(){return go.getClearColor()},this.setClearColor=function(){go.setClearColor.apply(go,arguments)},this.getClearAlpha=function(){return go.getClearAlpha()},this.setClearAlpha=function(){go.setClearAlpha.apply(go,arguments)},this.clear=function(It,ge,Xt){var Te=0;(It===void 0||It)&&(Te|=16384),(ge===void 0||ge)&&(Te|=256),(Xt===void 0||Xt)&&(Te|=1024),me.clear(Te)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){E.removeEventListener("webglcontextlost",s,!1),E.removeEventListener("webglcontextrestored",f,!1),ns.dispose(),au.dispose(),hi.dispose(),ws.dispose(),os.dispose(),gp.stop()},this.renderBufferImmediate=function(It,ge){be.initAttributes();var Xt=hi.get(It);It.hasPositions&&!Xt.position&&(Xt.position=me.createBuffer()),It.hasNormals&&!Xt.normal&&(Xt.normal=me.createBuffer()),It.hasUvs&&!Xt.uv&&(Xt.uv=me.createBuffer()),It.hasColors&&!Xt.color&&(Xt.color=me.createBuffer()),ge=ge.getAttributes(),It.hasPositions&&(me.bindBuffer(34962,Xt.position),me.bufferData(34962,It.positionArray,35048),be.enableAttribute(ge.position),me.vertexAttribPointer(ge.position,3,5126,!1,0,0)),It.hasNormals&&(me.bindBuffer(34962,Xt.normal),me.bufferData(34962,It.normalArray,35048),be.enableAttribute(ge.normal),me.vertexAttribPointer(ge.normal,3,5126,!1,0,0)),It.hasUvs&&(me.bindBuffer(34962,Xt.uv),me.bufferData(34962,It.uvArray,35048),be.enableAttribute(ge.uv),me.vertexAttribPointer(ge.uv,2,5126,!1,0,0)),It.hasColors&&(me.bindBuffer(34962,Xt.color),me.bufferData(34962,It.colorArray,35048),be.enableAttribute(ge.color),me.vertexAttribPointer(ge.color,3,5126,!1,0,0)),be.disableUnusedAttributes(),me.drawArrays(4,0,It.count),It.count=0};var Ms=new Mr;this.renderBufferDirect=function(It,ge,Xt,Te,Ve,Kr){ge===null&&(ge=Ms);var rr=Ve.isMesh&&0>Ve.matrixWorld.determinant(),Er=I(It,ge,Te,Ve);be.setMaterial(Te,rr);var Jr=!1;if((r!==Xt.id||Je!==Er.id||qr!==(Te.wireframe===!0))&&(r=Xt.id,Je=Er.id,qr=Te.wireframe===!0,Jr=!0),(Te.morphTargets||Te.morphNormals)&&(ix.update(Ve,Xt,Te,Er),Jr=!0),Ve.isInstancedMesh===!0&&(Jr=!0),It=Xt.index,ge=Xt.attributes.position,It===null){if(ge===void 0||ge.count===0)return}else if(It.count===0)return;var _i=1;if(Te.wireframe===!0&&(It=rh.getWireframeAttribute(Xt),_i=2),rr=nx,It!==null){var ci=_a.get(It);rr=wa,rr.setIndex(ci)}if(Jr){if(Fr.isWebGL2!==!1||!Ve.isInstancedMesh&&!Xt.isInstancedBufferGeometry||Qe.get("ANGLE_instanced_arrays")!==null){be.initAttributes(),Jr=Xt.attributes,Er=Er.getAttributes();var Ma=Te.defaultAttributeValues;for(oh in Er){var tn=Er[oh];if(0<=tn){var Bn=Jr[oh];if(Bn!==void 0){var uu=Bn.normalized,ox=Bn.itemSize,Ws=_a.get(Bn);if(Ws!==void 0){var $d=Ws.buffer,nh=Ws.type;if(Ws=Ws.bytesPerElement,Bn.isInterleavedBufferAttribute){var wc=Bn.data,k_=wc.stride;Bn=Bn.offset,wc&&wc.isInstancedInterleavedBuffer?(be.enableAttributeAndDivisor(tn,wc.meshPerAttribute),Xt._maxInstanceCount===void 0&&(Xt._maxInstanceCount=wc.meshPerAttribute*wc.count)):be.enableAttribute(tn),me.bindBuffer(34962,$d),be.vertexAttribPointer(tn,ox,nh,uu,k_*Ws,Bn*Ws)}else Bn.isInstancedBufferAttribute?(be.enableAttributeAndDivisor(tn,Bn.meshPerAttribute),Xt._maxInstanceCount===void 0&&(Xt._maxInstanceCount=Bn.meshPerAttribute*Bn.count)):be.enableAttribute(tn),me.bindBuffer(34962,$d),be.vertexAttribPointer(tn,ox,nh,uu,0,0)}}else if(oh==="instanceMatrix")Ws=_a.get(Ve.instanceMatrix),Ws!==void 0&&($d=Ws.buffer,nh=Ws.type,be.enableAttributeAndDivisor(tn+0,1),be.enableAttributeAndDivisor(tn+1,1),be.enableAttributeAndDivisor(tn+2,1),be.enableAttributeAndDivisor(tn+3,1),me.bindBuffer(34962,$d),me.vertexAttribPointer(tn+0,4,nh,!1,64,0),me.vertexAttribPointer(tn+1,4,nh,!1,64,16),me.vertexAttribPointer(tn+2,4,nh,!1,64,32),me.vertexAttribPointer(tn+3,4,nh,!1,64,48));else if(Ma!==void 0&&(uu=Ma[oh],uu!==void 0))switch(uu.length){case 2:me.vertexAttrib2fv(tn,uu);break;case 3:me.vertexAttrib3fv(tn,uu);break;case 4:me.vertexAttrib4fv(tn,uu);break;default:me.vertexAttrib1fv(tn,uu)}}}be.disableUnusedAttributes()}It!==null&&me.bindBuffer(34963,ci.buffer)}var oh=Xt.drawRange.start*_i;Jr=Kr!==null?Kr.start*_i:0,ci=Math.max(oh,Jr),Kr=Math.max(0,Math.min(It!==null?It.count:ge.count,oh+Xt.drawRange.count*_i,Jr+(Kr!==null?Kr.count*_i:1/0))-1-ci+1),Kr!==0&&(Ve.isMesh?Te.wireframe===!0?(be.setLineWidth(Te.wireframeLinewidth*(re===null?vt:1)),rr.setMode(1)):rr.setMode(4):Ve.isLine?(Te=Te.linewidth,Te===void 0&&(Te=1),be.setLineWidth(Te*(re===null?vt:1)),Ve.isLineSegments?rr.setMode(1):Ve.isLineLoop?rr.setMode(2):rr.setMode(3)):Ve.isPoints?rr.setMode(0):Ve.isSprite&&rr.setMode(4),Ve.isInstancedMesh?rr.renderInstances(Xt,ci,Kr,Ve.count):Xt.isInstancedBufferGeometry?rr.renderInstances(Xt,ci,Kr,Math.min(Xt.instanceCount,Xt._maxInstanceCount)):rr.render(ci,Kr))},this.compile=function(It,ge){zt=au.get(It,ge),zt.init(),It.traverse(function(Te){Te.isLight&&(zt.pushLight(Te),Te.castShadow&&zt.pushShadow(Te))}),zt.setupLights(ge);var Xt={};It.traverse(function(Te){var Ve=Te.material;if(Ve)if(Array.isArray(Ve))for(var Kr=0;Kr<Ve.length;Kr++){var rr=Ve[Kr];!(rr.uuid in Xt)&&(w(rr,It,Te),Xt[rr.uuid]=!0)}else!(Ve.uuid in Xt)&&(w(Ve,It,Te),Xt[Ve.uuid]=!0)})};var To=null,gp=new qc;gp.setAnimationLoop(function(It){os.isPresenting||To&&To(It)}),typeof window!="undefined"&&gp.setContext(window),this.setAnimationLoop=function(It){To=It,os.setAnimationLoop(It),gp.start()},this.render=function(It,ge,Xt,Te){if(Xt!==void 0){console.warn("THREE.WebGLRenderer.render(): the renderTarget argument has been removed. Use .setRenderTarget() instead.");var Ve=Xt}if(Te!==void 0){console.warn("THREE.WebGLRenderer.render(): the forceClear argument has been removed. Use .clear() instead.");var Kr=Te}ge&&ge.isCamera?Kt||(Je=r=null,qr=!1,hr=-1,nr=null,It.autoUpdate===!0&&It.updateMatrixWorld(),ge.parent===null&&ge.updateMatrixWorld(),os.enabled&&os.isPresenting&&(ge=os.getCamera(ge)),It.onBeforeRender(Ut,It,ge,Ve||re),zt=au.get(It,ge),zt.init(),cr.multiplyMatrices(ge.projectionMatrix,ge.matrixWorldInverse),de.setFromProjectionMatrix(cr),Ae=this.localClippingEnabled,te=ue.init(this.clippingPlanes,Ae,ge),wt=ns.get(It,ge),wt.init(),A(It,ge,0,Ut.sortObjects),wt.finish(),Ut.sortObjects===!0&&wt.sort(Pt,kt),te&&ue.beginShadows(),ih.render(zt.state.shadowsArray,It,ge),zt.setupLights(ge),te&&ue.endShadows(),this.info.autoReset&&this.info.reset(),Ve!==void 0&&this.setRenderTarget(Ve),go.render(wt,It,ge,Kr),Xt=wt.opaque,Te=wt.transparent,It.overrideMaterial?(Ve=It.overrideMaterial,Xt.length&&S(Xt,It,ge,Ve),Te.length&&S(Te,It,ge,Ve)):(Xt.length&&S(Xt,It,ge),Te.length&&S(Te,It,ge)),It.onAfterRender(Ut,It,ge),re!==null&&(Co.updateRenderTargetMipmap(re),Co.updateMultisampleRenderTarget(re)),be.buffers.depth.setTest(!0),be.buffers.depth.setMask(!0),be.buffers.color.setMask(!0),be.setPolygonOffset(!1),zt=wt=null):console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.setFramebuffer=function(It){Gt!==It&&re===null&&me.bindFramebuffer(36160,It),Gt=It},this.getActiveCubeFace=function(){return Qt},this.getActiveMipmapLevel=function(){return De},this.getRenderTarget=function(){return re},this.setRenderTarget=function(It,ge,Xt){re=It,Qt=ge,De=Xt,It&&hi.get(It).__webglFramebuffer===void 0&&Co.setupRenderTarget(It);var Te=Gt,Ve=!1;It?(Te=hi.get(It).__webglFramebuffer,It.isWebGLCubeRenderTarget?(Te=Te[ge||0],Ve=!0):Te=It.isWebGLMultisampleRenderTarget?hi.get(It).__webglMultisampledFramebuffer:Te,At.copy(It.viewport),_t.copy(It.scissor),Rt=It.scissorTest):(At.copy(Zt).multiplyScalar(vt).floor(),_t.copy(yt).multiplyScalar(vt).floor(),Rt=he),We!==Te&&(me.bindFramebuffer(36160,Te),We=Te),be.viewport(At),be.scissor(_t),be.setScissorTest(Rt),Ve&&(It=hi.get(It.texture),me.framebufferTexture2D(36160,36064,34069+(ge||0),It.__webglTexture,Xt||0))},this.readRenderTargetPixels=function(It,ge,Xt,Te,Ve,Kr,rr){if(It&&It.isWebGLRenderTarget){var Er=hi.get(It).__webglFramebuffer;if(It.isWebGLCubeRenderTarget&&rr!==void 0&&(Er=Er[rr]),Er){rr=!1,Er!==We&&(me.bindFramebuffer(36160,Er),rr=!0);try{var Jr=It.texture,_i=Jr.format,ci=Jr.type;_i!==1023&&ko.convert(_i)!==me.getParameter(35739)?console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format."):ci===1009||ko.convert(ci)===me.getParameter(35738)||ci===1015&&(Fr.isWebGL2||Qe.get("OES_texture_float")||Qe.get("WEBGL_color_buffer_float"))||ci===1016&&(Fr.isWebGL2?Qe.get("EXT_color_buffer_float"):Qe.get("EXT_color_buffer_half_float"))?me.checkFramebufferStatus(36160)===36053?0<=ge&&ge<=It.width-Te&&0<=Xt&&Xt<=It.height-Ve&&me.readPixels(ge,Xt,Te,Ve,ko.convert(_i),ko.convert(ci),Kr):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete."):console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.")}finally{rr&&me.bindFramebuffer(36160,We)}}}else console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.")},this.copyFramebufferToTexture=function(It,ge,Xt){Xt===void 0&&(Xt=0);var Te=Math.pow(2,-Xt),Ve=Math.floor(ge.image.width*Te);Te=Math.floor(ge.image.height*Te);var Kr=ko.convert(ge.format);Co.setTexture2D(ge,0),me.copyTexImage2D(3553,Xt,Kr,It.x,It.y,Ve,Te,0),be.unbindTexture()},this.copyTextureToTexture=function(It,ge,Xt,Te){Te===void 0&&(Te=0);var Ve=ge.image.width,Kr=ge.image.height,rr=ko.convert(Xt.format),Er=ko.convert(Xt.type);Co.setTexture2D(Xt,0),ge.isDataTexture?me.texSubImage2D(3553,Te,It.x,It.y,Ve,Kr,rr,Er,ge.image.data):ge.isCompressedTexture?me.compressedTexSubImage2D(3553,Te,It.x,It.y,ge.mipmaps[0].width,ge.mipmaps[0].height,rr,ge.mipmaps[0].data):me.texSubImage2D(3553,Te,It.x,It.y,rr,Er,ge.image),Te===0&&Xt.generateMipmaps&&me.generateMipmap(3553),be.unbindTexture()},this.initTexture=function(It){Co.setTexture2D(It,0),be.unbindTexture()},typeof __THREE_DEVTOOLS__!="undefined"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}function pn(t,r){this.name="",this.color=new Oe(t),this.density=r!==void 0?r:25e-5}function gg(t,r,i){this.name="",this.color=new Oe(t),this.near=r!==void 0?r:1,this.far=i!==void 0?i:1e3}function Ue(t,r){this.array=t,this.stride=r,this.count=t!==void 0?t.length/r:0,this.usage=35044,this.updateRange={offset:0,count:-1},this.version=0}function Ro(t,r,i,s){this.name="",this.data=t,this.itemSize=r,this.offset=i,this.normalized=s===!0}function Cl(t){Rr.call(this),this.type="SpriteMaterial",this.color=new Oe(16777215),this.alphaMap=this.map=null,this.rotation=0,this.transparent=this.sizeAttenuation=!0,this.setValues(t)}function rd(t){if(fe.call(this),this.type="Sprite",jd===void 0){jd=new ke;var r=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]);r=new Ue(r,5),jd.setIndex([0,1,2,0,2,3]),jd.setAttribute("position",new Ro(r,3,0,!1)),jd.setAttribute("uv",new Ro(r,2,3,!1))}this.geometry=jd,this.material=t!==void 0?t:new Cl,this.center=new Ot(.5,.5)}function Ih(t,r,i,s,f,c){Zd.subVectors(t,i).addScalar(.5).multiply(s),f!==void 0?(Iv.x=c*Zd.x-f*Zd.y,Iv.y=f*Zd.x+c*Zd.y):Iv.copy(Zd),t.copy(r),t.x+=Iv.x,t.y+=Iv.y,t.applyMatrix4(kC)}function id(){fe.call(this),this._currentLevel=0,this.type="LOD",Or(this,{levels:{enumerable:!0,value:[]}}),this.autoUpdate=!0}function Eh(t,r){t&&t.isGeometry&&console.error("THREE.SkinnedMesh no longer supports THREE.Geometry. Use THREE.BufferGeometry instead."),Zi.call(this,t,r),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new Me,this.bindMatrixInverse=new Me}function Tl(t,r){if(t=t||[],this.bones=t.slice(0),this.boneMatrices=new Float32Array(16*this.bones.length),this.frame=-1,r===void 0)this.calculateInverses();else if(this.bones.length===r.length)this.boneInverses=r.slice(0);else for(console.warn("THREE.Skeleton boneInverses is the wrong length."),this.boneInverses=[],t=0,r=this.bones.length;t<r;t++)this.boneInverses.push(new Me)}function ia(){fe.call(this),this.type="Bone"}function _n(t,r,i){Zi.call(this,t,r),this.instanceMatrix=new wr(new Float32Array(16*i),16),this.count=i,this.frustumCulled=!1}function $i(t){Rr.call(this),this.type="LineBasicMaterial",this.color=new Oe(16777215),this.linewidth=1,this.linejoin=this.linecap="round",this.morphTargets=!1,this.setValues(t)}function Po(t,r,i){i===1&&console.error("THREE.Line: parameter THREE.LinePieces no longer supported. Use THREE.LineSegments instead."),fe.call(this),this.type="Line",this.geometry=t!==void 0?t:new ke,this.material=r!==void 0?r:new $i,this.updateMorphTargets()}function Fi(t,r){Po.call(this,t,r),this.type="LineSegments"}function of(t,r){Po.call(this,t,r),this.type="LineLoop"}function Ps(t){Rr.call(this),this.type="PointsMaterial",this.color=new Oe(16777215),this.alphaMap=this.map=null,this.size=1,this.sizeAttenuation=!0,this.morphTargets=!1,this.setValues(t)}function Ru(t,r){fe.call(this),this.type="Points",this.geometry=t!==void 0?t:new ke,this.material=r!==void 0?r:new Ps,this.updateMorphTargets()}function sf(t,r,i,s,f,c,d){var p=A_.distanceSqToPoint(t);p<i&&(i=new dt,A_.closestPointToPoint(t,i),i.applyMatrix4(s),t=f.ray.origin.distanceTo(i),t<f.near||t>f.far||c.push({distance:t,distanceToRay:Math.sqrt(p),point:i,index:r,face:null,object:d}))}function m1(t,r,i,s,f,c,d,p,A){le.call(this,t,r,i,s,f,c,d,p,A),this.format=d!==void 0?d:1022,this.minFilter=c!==void 0?c:1006,this.magFilter=f!==void 0?f:1006,this.generateMipmaps=!1}function Sl(t,r,i,s,f,c,d,p,A,S,z,w){le.call(this,null,c,d,p,A,S,s,f,z,w),this.image={width:r,height:i},this.mipmaps=t,this.generateMipmaps=this.flipY=!1}function nd(t,r,i,s,f,c,d,p,A){le.call(this,t,r,i,s,f,c,d,p,A),this.needsUpdate=!0}function Ds(t,r,i,s,f,c,d,p,A,S){if(S=S!==void 0?S:1026,S!==1026&&S!==1027)throw Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");i===void 0&&S===1026&&(i=1012),i===void 0&&S===1027&&(i=1020),le.call(this,null,s,f,c,d,p,S,i,A),this.image={width:t,height:r},this.magFilter=d!==void 0?d:1003,this.minFilter=p!==void 0?p:1003,this.generateMipmaps=this.flipY=!1}function af(t){ke.call(this),this.type="WireframeGeometry";var r=[],i,s,f,c=[0,0],d={},p=["a","b","c"];if(t&&t.isGeometry){var A=t.faces,S=0;for(s=A.length;S<s;S++){var z=A[S];for(i=0;3>i;i++){var w=z[p[i]],I=z[p[(i+1)%3]];c[0]=Math.min(w,I),c[1]=Math.max(w,I),w=c[0]+","+c[1],d[w]===void 0&&(d[w]={index1:c[0],index2:c[1]})}}for(w in d)S=d[w],p=t.vertices[S.index1],r.push(p.x,p.y,p.z),p=t.vertices[S.index2],r.push(p.x,p.y,p.z)}else if(t&&t.isBufferGeometry)if(p=new dt,t.index!==null){A=t.attributes.position,z=t.index;var E=t.groups;for(E.length===0&&(E=[{start:0,count:z.count,materialIndex:0}]),t=0,f=E.length;t<f;++t)for(S=E[t],i=S.start,s=S.count,S=i,s=i+s;S<s;S+=3)for(i=0;3>i;i++)w=z.getX(S+i),I=z.getX(S+(i+1)%3),c[0]=Math.min(w,I),c[1]=Math.max(w,I),w=c[0]+","+c[1],d[w]===void 0&&(d[w]={index1:c[0],index2:c[1]});for(w in d)S=d[w],p.fromBufferAttribute(A,S.index1),r.push(p.x,p.y,p.z),p.fromBufferAttribute(A,S.index2),r.push(p.x,p.y,p.z)}else for(A=t.attributes.position,S=0,s=A.count/3;S<s;S++)for(i=0;3>i;i++)d=3*S+i,p.fromBufferAttribute(A,d),r.push(p.x,p.y,p.z),d=3*S+(i+1)%3,p.fromBufferAttribute(A,d),r.push(p.x,p.y,p.z);this.setAttribute("position",new Ge(r,3))}function uf(t,r,i){Gr.call(this),this.type="ParametricGeometry",this.parameters={func:t,slices:r,stacks:i},this.fromBufferGeometry(new Il(t,r,i)),this.mergeVertices()}function Il(t,r,i){ke.call(this),this.type="ParametricBufferGeometry",this.parameters={func:t,slices:r,stacks:i};var s=[],f=[],c=[],d=[],p=new dt,A=new dt,S=new dt,z=new dt,w=new dt,I,E;3>t.length&&console.error("THREE.ParametricGeometry: Function must now modify a Vector3 as third parameter.");var P=r+1;for(I=0;I<=i;I++){var F=I/i;for(E=0;E<=r;E++){var X=E/r;t(X,F,A),f.push(A.x,A.y,A.z),0<=X-1e-5?(t(X-1e-5,F,S),z.subVectors(A,S)):(t(X+1e-5,F,S),z.subVectors(S,A)),0<=F-1e-5?(t(X,F-1e-5,S),w.subVectors(A,S)):(t(X,F+1e-5,S),w.subVectors(S,A)),p.crossVectors(z,w).normalize(),c.push(p.x,p.y,p.z),d.push(X,F)}}for(I=0;I<i;I++)for(E=0;E<r;E++)t=I*P+E+1,p=(I+1)*P+E+1,A=(I+1)*P+E,s.push(I*P+E,t,A),s.push(t,p,A);this.setIndex(s),this.setAttribute("position",new Ge(f,3)),this.setAttribute("normal",new Ge(c,3)),this.setAttribute("uv",new Ge(d,2))}function Lh(t,r,i,s){Gr.call(this),this.type="PolyhedronGeometry",this.parameters={vertices:t,indices:r,radius:i,detail:s},this.fromBufferGeometry(new Do(t,r,i,s)),this.mergeVertices()}function Do(t,r,i,s){function f(S){p.push(S.x,S.y,S.z)}function c(S,z){S*=3,z.x=t[S+0],z.y=t[S+1],z.z=t[S+2]}function d(S,z,w,I){0>I&&S.x===1&&(A[z]=S.x-1),w.x===0&&w.z===0&&(A[z]=I/2/Math.PI+.5)}ke.call(this),this.type="PolyhedronBufferGeometry",this.parameters={vertices:t,indices:r,radius:i,detail:s},i=i||1,s=s||0;var p=[],A=[];(function(S){for(var z=new dt,w=new dt,I=new dt,E=0;E<r.length;E+=3){c(r[E+0],z),c(r[E+1],w),c(r[E+2],I);var P,F,X=z,q=w,J=I,it=Math.pow(2,S),lt=[];for(F=0;F<=it;F++){lt[F]=[];var Mt=X.clone().lerp(J,F/it),Ct=q.clone().lerp(J,F/it),wt=it-F;for(P=0;P<=wt;P++)lt[F][P]=P===0&&F===it?Mt:Mt.clone().lerp(Ct,P/wt)}for(F=0;F<it;F++)for(P=0;P<2*(it-F)-1;P++)X=Math.floor(P/2),P%2===0?(f(lt[F][X+1]),f(lt[F+1][X]),f(lt[F][X])):(f(lt[F][X+1]),f(lt[F+1][X+1]),f(lt[F+1][X]))}})(s),function(S){for(var z=new dt,w=0;w<p.length;w+=3)z.x=p[w+0],z.y=p[w+1],z.z=p[w+2],z.normalize().multiplyScalar(S),p[w+0]=z.x,p[w+1]=z.y,p[w+2]=z.z}(i),function(){for(var S=new dt,z=0;z<p.length;z+=3)S.x=p[z+0],S.y=p[z+1],S.z=p[z+2],A.push(Math.atan2(S.z,-S.x)/2/Math.PI+.5,1-(Math.atan2(-S.y,Math.sqrt(S.x*S.x+S.z*S.z))/Math.PI+.5));S=new dt,z=new dt;for(var w=new dt,I=new dt,E=new Ot,P=new Ot,F=new Ot,X=0,q=0;X<p.length;X+=9,q+=6){S.set(p[X+0],p[X+1],p[X+2]),z.set(p[X+3],p[X+4],p[X+5]),w.set(p[X+6],p[X+7],p[X+8]),E.set(A[q+0],A[q+1]),P.set(A[q+2],A[q+3]),F.set(A[q+4],A[q+5]),I.copy(S).add(z).add(w).divideScalar(3);var J=Math.atan2(I.z,-I.x);d(E,q+0,S,J),d(P,q+2,z,J),d(F,q+4,w,J)}for(S=0;S<A.length;S+=6)z=A[S+0],w=A[S+2],I=A[S+4],E=Math.min(z,w,I),.9<Math.max(z,w,I)&&.1>E&&(.2>z&&(A[S+0]+=1),.2>w&&(A[S+2]+=1),.2>I&&(A[S+4]+=1))}(),this.setAttribute("position",new Ge(p,3)),this.setAttribute("normal",new Ge(p.slice(),3)),this.setAttribute("uv",new Ge(A,2)),s===0?this.computeVertexNormals():this.normalizeNormals()}function Rh(t,r){Gr.call(this),this.type="TetrahedronGeometry",this.parameters={radius:t,detail:r},this.fromBufferGeometry(new Pu(t,r)),this.mergeVertices()}function Pu(t,r){Do.call(this,[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],t,r),this.type="TetrahedronBufferGeometry",this.parameters={radius:t,detail:r}}function od(t,r){Gr.call(this),this.type="OctahedronGeometry",this.parameters={radius:t,detail:r},this.fromBufferGeometry(new na(t,r)),this.mergeVertices()}function na(t,r){Do.call(this,[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],t,r),this.type="OctahedronBufferGeometry",this.parameters={radius:t,detail:r}}function El(t,r){Gr.call(this),this.type="IcosahedronGeometry",this.parameters={radius:t,detail:r},this.fromBufferGeometry(new lf(t,r)),this.mergeVertices()}function lf(t,r){var i=(1+Math.sqrt(5))/2;Do.call(this,[-1,i,0,1,i,0,-1,-i,0,1,-i,0,0,-1,i,0,1,i,0,-1,-i,0,1,-i,i,0,-1,i,0,1,-i,0,-1,-i,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],t,r),this.type="IcosahedronBufferGeometry",this.parameters={radius:t,detail:r}}function Ph(t,r){Gr.call(this),this.type="DodecahedronGeometry",this.parameters={radius:t,detail:r},this.fromBufferGeometry(new Ll(t,r)),this.mergeVertices()}function Ll(t,r){var i=(1+Math.sqrt(5))/2,s=1/i;Do.call(this,[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-s,-i,0,-s,i,0,s,-i,0,s,i,-s,-i,0,-s,i,0,s,-i,0,s,i,0,-i,0,-s,i,0,-s,-i,0,s,i,0,s],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],t,r),this.type="DodecahedronBufferGeometry",this.parameters={radius:t,detail:r}}function sd(t,r,i,s,f,c){Gr.call(this),this.type="TubeGeometry",this.parameters={path:t,tubularSegments:r,radius:i,radialSegments:s,closed:f},c!==void 0&&console.warn("THREE.TubeGeometry: taper has been removed."),t=new Rl(t,r,i,s,f),this.tangents=t.tangents,this.normals=t.normals,this.binormals=t.binormals,this.fromBufferGeometry(t),this.mergeVertices()}function Rl(t,r,i,s,f){function c(q){z=t.getPointAt(q/r,z);var J=d.normals[q];for(q=d.binormals[q],I=0;I<=s;I++){var it=I/s*Math.PI*2,lt=Math.sin(it);it=-Math.cos(it),A.x=it*J.x+lt*q.x,A.y=it*J.y+lt*q.y,A.z=it*J.z+lt*q.z,A.normalize(),P.push(A.x,A.y,A.z),p.x=z.x+i*A.x,p.y=z.y+i*A.y,p.z=z.z+i*A.z,E.push(p.x,p.y,p.z)}}ke.call(this),this.type="TubeBufferGeometry",this.parameters={path:t,tubularSegments:r,radius:i,radialSegments:s,closed:f},r=r||64,i=i||1,s=s||8,f=f||!1;var d=t.computeFrenetFrames(r,f);this.tangents=d.tangents,this.normals=d.normals,this.binormals=d.binormals;var p=new dt,A=new dt,S=new Ot,z=new dt,w,I,E=[],P=[],F=[],X=[];for(w=0;w<r;w++)c(w);for(c(f===!1?r:0),w=0;w<=r;w++)for(I=0;I<=s;I++)S.x=w/r,S.y=I/s,F.push(S.x,S.y);(function(){for(I=1;I<=r;I++)for(w=1;w<=s;w++){var q=(s+1)*I+(w-1),J=(s+1)*I+w,it=(s+1)*(I-1)+w;X.push((s+1)*(I-1)+(w-1),q,it),X.push(q,J,it)}})(),this.setIndex(X),this.setAttribute("position",new Ge(E,3)),this.setAttribute("normal",new Ge(P,3)),this.setAttribute("uv",new Ge(F,2))}function hf(t,r,i,s,f,c,d){Gr.call(this),this.type="TorusKnotGeometry",this.parameters={radius:t,tube:r,tubularSegments:i,radialSegments:s,p:f,q:c},d!==void 0&&console.warn("THREE.TorusKnotGeometry: heightScale has been deprecated. Use .scale( x, y, z ) instead."),this.fromBufferGeometry(new cf(t,r,i,s,f,c)),this.mergeVertices()}function cf(t,r,i,s,f,c){function d(Ct,wt,zt,Ut,Kt){var Gt=Math.sin(Ct);wt=zt/wt*Ct,zt=Math.cos(wt),Kt.x=Ut*(2+zt)*.5*Math.cos(Ct),Kt.y=Ut*(2+zt)*Gt*.5,Kt.z=Ut*Math.sin(wt)*.5}ke.call(this),this.type="TorusKnotBufferGeometry",this.parameters={radius:t,tube:r,tubularSegments:i,radialSegments:s,p:f,q:c},t=t||1,r=r||.4,i=Math.floor(i)||64,s=Math.floor(s)||8,f=f||2,c=c||3;var p=[],A=[],S=[],z=[],w,I=new dt,E=new dt,P=new dt,F=new dt,X=new dt,q=new dt,J=new dt;for(w=0;w<=i;++w){var it=w/i*f*Math.PI*2;for(d(it,f,c,t,P),d(it+.01,f,c,t,F),q.subVectors(F,P),J.addVectors(F,P),X.crossVectors(q,J),J.crossVectors(X,q),X.normalize(),J.normalize(),it=0;it<=s;++it){var lt=it/s*Math.PI*2,Mt=-r*Math.cos(lt);lt=r*Math.sin(lt),I.x=P.x+(Mt*J.x+lt*X.x),I.y=P.y+(Mt*J.y+lt*X.y),I.z=P.z+(Mt*J.z+lt*X.z),A.push(I.x,I.y,I.z),E.subVectors(I,P).normalize(),S.push(E.x,E.y,E.z),z.push(w/i),z.push(it/s)}}for(it=1;it<=i;it++)for(w=1;w<=s;w++)t=(s+1)*it+(w-1),r=(s+1)*it+w,f=(s+1)*(it-1)+w,p.push((s+1)*(it-1)+(w-1),t,f),p.push(t,r,f);this.setIndex(p),this.setAttribute("position",new Ge(A,3)),this.setAttribute("normal",new Ge(S,3)),this.setAttribute("uv",new Ge(z,2))}function ff(t,r,i,s,f){Gr.call(this),this.type="TorusGeometry",this.parameters={radius:t,tube:r,radialSegments:i,tubularSegments:s,arc:f},this.fromBufferGeometry(new Dh(t,r,i,s,f)),this.mergeVertices()}function Dh(t,r,i,s,f){ke.call(this),this.type="TorusBufferGeometry",this.parameters={radius:t,tube:r,radialSegments:i,tubularSegments:s,arc:f},t=t||1,r=r||.4,i=Math.floor(i)||8,s=Math.floor(s)||6,f=f||2*Math.PI;var c=[],d=[],p=[],A=[],S=new dt,z=new dt,w=new dt,I,E;for(I=0;I<=i;I++)for(E=0;E<=s;E++){var P=E/s*f,F=I/i*Math.PI*2;z.x=(t+r*Math.cos(F))*Math.cos(P),z.y=(t+r*Math.cos(F))*Math.sin(P),z.z=r*Math.sin(F),d.push(z.x,z.y,z.z),S.x=t*Math.cos(P),S.y=t*Math.sin(P),w.subVectors(z,S).normalize(),p.push(w.x,w.y,w.z),A.push(E/s),A.push(I/i)}for(I=1;I<=i;I++)for(E=1;E<=s;E++)t=(s+1)*(I-1)+E-1,r=(s+1)*(I-1)+E,f=(s+1)*I+E,c.push((s+1)*I+E-1,t,f),c.push(t,r,f);this.setIndex(c),this.setAttribute("position",new Ge(d,3)),this.setAttribute("normal",new Ge(p,3)),this.setAttribute("uv",new Ge(A,2))}function vg(t,r,i,s,f){for(var c,d=0,p=r,A=i-s;p<i;p+=s)d+=(t[A]-t[p])*(t[p+1]+t[A+1]),A=p;if(f===0<d)for(f=r;f<i;f+=s)c=Dl(f,t[f],t[f+1],c);else for(f=i-s;f>=r;f-=s)c=Dl(f,t[f],t[f+1],c);return c&&df(c,c.next)&&(Ol(c),c=c.next),c}function Os(t,r){if(!t)return t;r||(r=t);do{var i=!1;if(t.steiner||!df(t,t.next)&&pi(t.prev,t,t.next)!==0)t=t.next;else{if(Ol(t),t=r=t.prev,t===t.next)break;i=!0}}while(i||t!==r);return r}function pf(t,r,i,s,f,c,d){if(t){if(!d&&c){var p=t,A=p;do A.z===null&&(A.z=ho(A.x,A.y,s,f,c)),A.prevZ=A.prev,A=A.nextZ=A.next;while(A!==p);A.prevZ.nextZ=null,A.prevZ=null,p=A;var S,z,w,I,E=1;do{A=p;var P=p=null;for(z=0;A;){z++;var F=A;for(S=w=0;S<E&&(w++,F=F.nextZ,F);S++);for(I=E;0<w||0<I&&F;)w!==0&&(I===0||!F||A.z<=F.z)?(S=A,A=A.nextZ,w--):(S=F,F=F.nextZ,I--),P?P.nextZ=S:p=S,S.prevZ=P,P=S;A=F}P.nextZ=null,E*=2}while(1<z)}for(p=t;t.prev!==t.next;){if(A=t.prev,F=t.next,c)P=g1(t,s,f,c);else t:if(P=t,z=P.prev,w=P,E=P.next,0<=pi(z,w,E))P=!1;else{for(S=P.next.next;S!==P.prev;){if(Ua(z.x,z.y,w.x,w.y,E.x,E.y,S.x,S.y)&&0<=pi(S.prev,S,S.next)){P=!1;break t}S=S.next}P=!0}if(P)r.push(A.i/i),r.push(t.i/i),r.push(F.i/i),Ol(t),p=t=F.next;else if(t=F,t===p){if(!d)pf(Os(t),r,i,s,f,c,1);else if(d===1){t=Os(t),d=r,p=i,A=t;do F=A.prev,P=A.next.next,!df(F,P)&&y1(F,A,A.next,P)&&ba(F,P)&&ba(P,F)&&(d.push(F.i/p),d.push(A.i/p),d.push(P.i/p),Ol(A),Ol(A.next),A=t=P),A=A.next;while(A!==t);t=Os(A),pf(t,r,i,s,f,c,2)}else if(d===2)t:{d=t;do{for(p=d.next.next;p!==d.prev;){if(A=d.i!==p.i){if(A=d,F=p,P=A.next.i!==F.i&&A.prev.i!==F.i){e:{P=A;do{if(P.i!==A.i&&P.next.i!==A.i&&P.i!==F.i&&P.next.i!==F.i&&y1(P,P.next,A,F)){P=!0;break e}P=P.next}while(P!==A);P=!1}P=!P}if(P){if(P=ba(A,F)&&ba(F,A)){P=A,z=!1,w=(A.x+F.x)/2,E=(A.y+F.y)/2;do P.y>E!=P.next.y>E&&P.next.y!==P.y&&w<(P.next.x-P.x)*(E-P.y)/(P.next.y-P.y)+P.x&&(z=!z),P=P.next;while(P!==A);P=z}P=P&&(pi(A.prev,A,F.prev)||pi(A,F.prev,F))||df(A,F)&&0<pi(A.prev,A,A.next)&&0<pi(F.prev,F,F.next)}A=P}if(A){t=ls(d,p),d=Os(d,d.next),t=Os(t,t.next),pf(d,r,i,s,f,c),pf(t,r,i,s,f,c);break t}p=p.next}d=d.next}while(d!==t)}break}}}}function g1(t,r,i,s){var f=t.prev,c=t.next;if(0<=pi(f,t,c))return!1;var d=f.x>t.x?f.x>c.x?f.x:c.x:t.x>c.x?t.x:c.x,p=f.y>t.y?f.y>c.y?f.y:c.y:t.y>c.y?t.y:c.y,A=ho(f.x<t.x?f.x<c.x?f.x:c.x:t.x<c.x?t.x:c.x,f.y<t.y?f.y<c.y?f.y:c.y:t.y<c.y?t.y:c.y,r,i,s);for(r=ho(d,p,r,i,s),i=t.prevZ,s=t.nextZ;i&&i.z>=A&&s&&s.z<=r;){if(i!==t.prev&&i!==t.next&&Ua(f.x,f.y,t.x,t.y,c.x,c.y,i.x,i.y)&&0<=pi(i.prev,i,i.next)||(i=i.prevZ,s!==t.prev&&s!==t.next&&Ua(f.x,f.y,t.x,t.y,c.x,c.y,s.x,s.y)&&0<=pi(s.prev,s,s.next)))return!1;s=s.nextZ}for(;i&&i.z>=A;){if(i!==t.prev&&i!==t.next&&Ua(f.x,f.y,t.x,t.y,c.x,c.y,i.x,i.y)&&0<=pi(i.prev,i,i.next))return!1;i=i.prevZ}for(;s&&s.z<=r;){if(s!==t.prev&&s!==t.next&&Ua(f.x,f.y,t.x,t.y,c.x,c.y,s.x,s.y)&&0<=pi(s.prev,s,s.next))return!1;s=s.nextZ}return!0}function Pl(t,r){return t.x-r.x}function v1(t,r){var i=r,s=t.x,f=t.y,c=-1/0;do{if(f<=i.y&&f>=i.next.y&&i.next.y!==i.y){var d=i.x+(f-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(d<=s&&d>c){if(c=d,d===s){if(f===i.y)return i;if(f===i.next.y)return i.next}var p=i.x<i.next.x?i:i.next}}i=i.next}while(i!==r);if(!p)return null;if(s===c)return p;r=p,d=p.x;var A=p.y,S=1/0;i=p;do{if(s>=i.x&&i.x>=d&&s!==i.x&&Ua(f<A?s:c,f,d,A,f<A?c:s,f,i.x,i.y)){var z=Math.abs(f-i.y)/(s-i.x),w;if((w=ba(i,t))&&!(w=z<S)&&(w=z===S)&&!(w=i.x>p.x)&&(w=i.x===p.x)){w=p;var I=i;w=0>pi(w.prev,w,I.prev)&&0>pi(I.next,w,w.next)}w&&(p=i,S=z)}i=i.next}while(i!==r);return p}function ho(t,r,i,s,f){return t=32767*(t-i)*f,r=32767*(r-s)*f,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,r=(r|r<<8)&16711935,r=(r|r<<4)&252645135,r=(r|r<<2)&858993459,(t|t<<1)&1431655765|((r|r<<1)&1431655765)<<1}function ad(t){var r=t,i=t;do(r.x<i.x||r.x===i.x&&r.y<i.y)&&(i=r),r=r.next;while(r!==t);return i}function Ua(t,r,i,s,f,c,d,p){return 0<=(f-d)*(r-p)-(t-d)*(c-p)&&0<=(t-d)*(s-p)-(i-d)*(r-p)&&0<=(i-d)*(c-p)-(f-d)*(s-p)}function pi(t,r,i){return(r.y-t.y)*(i.x-r.x)-(r.x-t.x)*(i.y-r.y)}function df(t,r){return t.x===r.x&&t.y===r.y}function y1(t,r,i,s){var f=us(pi(t,r,i)),c=us(pi(t,r,s)),d=us(pi(i,s,t)),p=us(pi(i,s,r));return!!(f!==c&&d!==p||f===0&&Du(t,i,r)||c===0&&Du(t,s,r)||d===0&&Du(i,t,s)||p===0&&Du(i,r,s))}function Du(t,r,i){return r.x<=Math.max(t.x,i.x)&&r.x>=Math.min(t.x,i.x)&&r.y<=Math.max(t.y,i.y)&&r.y>=Math.min(t.y,i.y)}function us(t){return 0<t?1:0>t?-1:0}function ba(t,r){return 0>pi(t.prev,t,t.next)?0<=pi(t,r,t.next)&&0<=pi(t,t.prev,r):0>pi(t,r,t.prev)||0>pi(t,t.next,r)}function ls(t,r){var i=new mf(t.i,t.x,t.y),s=new mf(r.i,r.x,r.y),f=t.next,c=r.prev;return t.next=r,r.prev=t,i.next=f,f.prev=i,s.next=i,i.prev=s,c.next=s,s.prev=c,s}function Dl(t,r,i,s){return t=new mf(t,r,i),s?(t.next=s.next,t.prev=s,s.next.prev=t,s.next=t):(t.prev=t,t.next=t),t}function Ol(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function mf(t,r,i){this.i=t,this.x=r,this.y=i,this.nextZ=this.prevZ=this.z=this.next=this.prev=null,this.steiner=!1}function ud(t){var r=t.length;2<r&&t[r-1].equals(t[0])&&t.pop()}function yg(t,r){for(var i=0;i<r.length;i++)t.push(r[i].x),t.push(r[i].y)}function Ou(t,r){Gr.call(this),this.type="ExtrudeGeometry",this.parameters={shapes:t,options:r},this.fromBufferGeometry(new hs(t,r)),this.mergeVertices()}function hs(t,r){function i(A){function S(te,Ae,cr){return Ae||console.error("THREE.ExtrudeGeometry: vec does not exist"),Ae.clone().multiplyScalar(cr).add(te)}function z(te,Ae,cr){var Cr=te.x-Ae.x,me=te.y-Ae.y,Qe=cr.x-te.x,Fr=cr.y-te.y,be=Cr*Cr+me*me;if(Math.abs(Cr*Fr-me*Qe)>an){var mn=Math.sqrt(be),hi=Math.sqrt(Qe*Qe+Fr*Fr);if(be=Ae.x-me/mn,Ae=Ae.y+Cr/mn,Fr=((cr.x-Fr/hi-be)*Fr-(cr.y+Qe/hi-Ae)*Qe)/(Cr*Fr-me*Qe),Qe=be+Cr*Fr-te.x,Cr=Ae+me*Fr-te.y,me=Qe*Qe+Cr*Cr,2>=me)return new Ot(Qe,Cr);me=Math.sqrt(me/2)}else te=!1,Cr>an?Qe>an&&(te=!0):Cr<-an?Qe<-an&&(te=!0):Qu(me)===Qu(Fr)&&(te=!0),te?(Qe=-me,me=Math.sqrt(be)):(Qe=Cr,Cr=me,me=Math.sqrt(be/2));return new Ot(Qe/me,Cr/me)}function w(te,Ae){for(Pt=te.length;0<=--Pt;){var cr=Pt,Cr=Pt-1;0>Cr&&(Cr=te.length-1);var me,Qe=J+2*zt;for(me=0;me<Qe;me++){var Fr=st*me,be=st*(me+1),mn=Ae+Cr+Fr,hi=Ae+Cr+be;be=Ae+cr+be,P(Ae+cr+Fr),P(mn),P(be),P(mn),P(hi),P(be),Fr=f.length/3,Fr=Kt.generateSideWallUV(s,f,Fr-6,Fr-3,Fr-2,Fr-1),F(Fr[0]),F(Fr[1]),F(Fr[3]),F(Fr[1]),F(Fr[2]),F(Fr[3])}}}function I(te,Ae,cr){X.push(te),X.push(Ae),X.push(cr)}function E(te,Ae,cr){P(te),P(Ae),P(cr),te=f.length/3,te=Kt.generateTopUV(s,f,te-3,te-2,te-1),F(te[0]),F(te[1]),F(te[2])}function P(te){f.push(X[3*te]),f.push(X[3*te+1]),f.push(X[3*te+2])}function F(te){c.push(te.x),c.push(te.y)}var X=[],q=r.curveSegments!==void 0?r.curveSegments:12,J=r.steps!==void 0?r.steps:1,it=r.depth!==void 0?r.depth:100,lt=r.bevelEnabled!==void 0?r.bevelEnabled:!0,Mt=r.bevelThickness!==void 0?r.bevelThickness:6,Ct=r.bevelSize!==void 0?r.bevelSize:Mt-2,wt=r.bevelOffset!==void 0?r.bevelOffset:0,zt=r.bevelSegments!==void 0?r.bevelSegments:3,Ut=r.extrudePath,Kt=r.UVGenerator!==void 0?r.UVGenerator:rE;r.amount!==void 0&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),it=r.amount);var Gt=!1;if(Ut){var Qt=Ut.getSpacedPoints(J);Gt=!0,lt=!1;var De=Ut.computeFrenetFrames(J,!1),re=new dt,We=new dt,hr=new dt}lt||(wt=Ct=Mt=zt=0);var Je;q=A.extractPoints(q),A=q.shape;var qr=q.holes;if(!gc.isClockWise(A)){A=A.reverse();var nr=0;for(Je=qr.length;nr<Je;nr++){var xt=qr[nr];gc.isClockWise(xt)&&(qr[nr]=xt.reverse())}}var At=gc.triangulateShape(A,qr),_t=A;for(nr=0,Je=qr.length;nr<Je;nr++)xt=qr[nr],A=A.concat(xt);var Rt,st=A.length,gt,vt=At.length;q=[];var Pt=0,kt=_t.length,Zt=kt-1;for(Rt=Pt+1;Pt<kt;Pt++,Zt++,Rt++)Zt===kt&&(Zt=0),Rt===kt&&(Rt=0),q[Pt]=z(_t[Pt],_t[Zt],_t[Rt]);Ut=[];var yt=q.concat();for(nr=0,Je=qr.length;nr<Je;nr++){xt=qr[nr];var he=[];for(Pt=0,kt=xt.length,Zt=kt-1,Rt=Pt+1;Pt<kt;Pt++,Zt++,Rt++)Zt===kt&&(Zt=0),Rt===kt&&(Rt=0),he[Pt]=z(xt[Pt],xt[Zt],xt[Rt]);Ut.push(he),yt=yt.concat(he)}for(Zt=0;Zt<zt;Zt++){kt=Zt/zt;var de=Mt*Math.cos(kt*Math.PI/2);for(Rt=Ct*Math.sin(kt*Math.PI/2)+wt,Pt=0,kt=_t.length;Pt<kt;Pt++){var ue=S(_t[Pt],q[Pt],Rt);I(ue.x,ue.y,-de)}for(nr=0,Je=qr.length;nr<Je;nr++)for(xt=qr[nr],he=Ut[nr],Pt=0,kt=xt.length;Pt<kt;Pt++)ue=S(xt[Pt],he[Pt],Rt),I(ue.x,ue.y,-de)}for(Rt=Ct+wt,Pt=0;Pt<st;Pt++)ue=lt?S(A[Pt],yt[Pt],Rt):A[Pt],Gt?(We.copy(De.normals[0]).multiplyScalar(ue.x),re.copy(De.binormals[0]).multiplyScalar(ue.y),hr.copy(Qt[0]).add(We).add(re),I(hr.x,hr.y,hr.z)):I(ue.x,ue.y,0);for(kt=1;kt<=J;kt++)for(Pt=0;Pt<st;Pt++)ue=lt?S(A[Pt],yt[Pt],Rt):A[Pt],Gt?(We.copy(De.normals[kt]).multiplyScalar(ue.x),re.copy(De.binormals[kt]).multiplyScalar(ue.y),hr.copy(Qt[kt]).add(We).add(re),I(hr.x,hr.y,hr.z)):I(ue.x,ue.y,it/J*kt);for(Zt=zt-1;0<=Zt;Zt--){for(kt=Zt/zt,de=Mt*Math.cos(kt*Math.PI/2),Rt=Ct*Math.sin(kt*Math.PI/2)+wt,Pt=0,kt=_t.length;Pt<kt;Pt++)ue=S(_t[Pt],q[Pt],Rt),I(ue.x,ue.y,it+de);for(nr=0,Je=qr.length;nr<Je;nr++)for(xt=qr[nr],he=Ut[nr],Pt=0,kt=xt.length;Pt<kt;Pt++)ue=S(xt[Pt],he[Pt],Rt),Gt?I(ue.x,ue.y+Qt[J-1].y,Qt[J-1].x+de):I(ue.x,ue.y,it+de)}(function(){var te=f.length/3;if(lt){var Ae=0*st;for(Pt=0;Pt<vt;Pt++)gt=At[Pt],E(gt[2]+Ae,gt[1]+Ae,gt[0]+Ae);for(Ae=st*(J+2*zt),Pt=0;Pt<vt;Pt++)gt=At[Pt],E(gt[0]+Ae,gt[1]+Ae,gt[2]+Ae)}else{for(Pt=0;Pt<vt;Pt++)gt=At[Pt],E(gt[2],gt[1],gt[0]);for(Pt=0;Pt<vt;Pt++)gt=At[Pt],E(gt[0]+st*J,gt[1]+st*J,gt[2]+st*J)}s.addGroup(te,f.length/3-te,0)})(),function(){var te=f.length/3,Ae=0;for(w(_t,Ae),Ae+=_t.length,nr=0,Je=qr.length;nr<Je;nr++)xt=qr[nr],w(xt,Ae),Ae+=xt.length;s.addGroup(te,f.length/3-te,1)}()}ke.call(this),this.type="ExtrudeBufferGeometry",this.parameters={shapes:t,options:r},t=Array.isArray(t)?t:[t];for(var s=this,f=[],c=[],d=0,p=t.length;d<p;d++)i(t[d]);this.setAttribute("position",new Ge(f,3)),this.setAttribute("uv",new Ge(c,2)),this.computeVertexNormals()}function xg(t,r,i){if(i.shapes=[],Array.isArray(t))for(var s=0,f=t.length;s<f;s++)i.shapes.push(t[s].uuid);else i.shapes.push(t.uuid);return r.extrudePath!==void 0&&(i.options.extrudePath=r.extrudePath.toJSON()),i}function ld(t,r){Gr.call(this),this.type="TextGeometry",this.parameters={text:t,parameters:r},this.fromBufferGeometry(new Oh(t,r)),this.mergeVertices()}function Oh(t,r){r=r||{};var i=r.font;if(!i||!i.isFont)return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),new Gr;t=i.generateShapes(t,r.size),r.depth=r.height!==void 0?r.height:50,r.bevelThickness===void 0&&(r.bevelThickness=10),r.bevelSize===void 0&&(r.bevelSize=8),r.bevelEnabled===void 0&&(r.bevelEnabled=!1),hs.call(this,t,r),this.type="TextBufferGeometry"}function gf(t,r,i,s,f,c,d){Gr.call(this),this.type="SphereGeometry",this.parameters={radius:t,widthSegments:r,heightSegments:i,phiStart:s,phiLength:f,thetaStart:c,thetaLength:d},this.fromBufferGeometry(new Fl(t,r,i,s,f,c,d)),this.mergeVertices()}function Fl(t,r,i,s,f,c,d){ke.call(this),this.type="SphereBufferGeometry",this.parameters={radius:t,widthSegments:r,heightSegments:i,phiStart:s,phiLength:f,thetaStart:c,thetaLength:d},t=t||1,r=Math.max(3,Math.floor(r)||8),i=Math.max(2,Math.floor(i)||6),s=s!==void 0?s:0,f=f!==void 0?f:2*Math.PI,c=c!==void 0?c:0,d=d!==void 0?d:Math.PI;var p=Math.min(c+d,Math.PI),A,S,z=0,w=[],I=new dt,E=new dt,P=[],F=[],X=[],q=[];for(S=0;S<=i;S++){var J=[],it=S/i,lt=0;for(S==0&&c==0?lt=.5/r:S==i&&p==Math.PI&&(lt=-.5/r),A=0;A<=r;A++){var Mt=A/r;I.x=-t*Math.cos(s+Mt*f)*Math.sin(c+it*d),I.y=t*Math.cos(c+it*d),I.z=t*Math.sin(s+Mt*f)*Math.sin(c+it*d),F.push(I.x,I.y,I.z),E.copy(I).normalize(),X.push(E.x,E.y,E.z),q.push(Mt+lt,1-it),J.push(z++)}w.push(J)}for(S=0;S<i;S++)for(A=0;A<r;A++)t=w[S][A+1],s=w[S][A],f=w[S+1][A],d=w[S+1][A+1],(S!==0||0<c)&&P.push(t,s,d),(S!==i-1||p<Math.PI)&&P.push(s,f,d);this.setIndex(P),this.setAttribute("position",new Ge(F,3)),this.setAttribute("normal",new Ge(X,3)),this.setAttribute("uv",new Ge(q,2))}function vf(t,r,i,s,f,c){Gr.call(this),this.type="RingGeometry",this.parameters={innerRadius:t,outerRadius:r,thetaSegments:i,phiSegments:s,thetaStart:f,thetaLength:c},this.fromBufferGeometry(new Fh(t,r,i,s,f,c)),this.mergeVertices()}function Fh(t,r,i,s,f,c){ke.call(this),this.type="RingBufferGeometry",this.parameters={innerRadius:t,outerRadius:r,thetaSegments:i,phiSegments:s,thetaStart:f,thetaLength:c},t=t||.5,r=r||1,f=f!==void 0?f:0,c=c!==void 0?c:2*Math.PI,i=i!==void 0?Math.max(3,i):8,s=s!==void 0?Math.max(1,s):1;var d=[],p=[],A=[],S=[],z=t,w=(r-t)/s,I=new dt,E=new Ot,P,F;for(P=0;P<=s;P++){for(F=0;F<=i;F++)t=f+F/i*c,I.x=z*Math.cos(t),I.y=z*Math.sin(t),p.push(I.x,I.y,I.z),A.push(0,0,1),E.x=(I.x/r+1)/2,E.y=(I.y/r+1)/2,S.push(E.x,E.y);z+=w}for(P=0;P<s;P++)for(r=P*(i+1),F=0;F<i;F++)t=F+r,f=t+i+1,c=t+i+2,z=t+1,d.push(t,f,z),d.push(f,c,z);this.setIndex(d),this.setAttribute("position",new Ge(p,3)),this.setAttribute("normal",new Ge(A,3)),this.setAttribute("uv",new Ge(S,2))}function yf(t,r,i,s){Gr.call(this),this.type="LatheGeometry",this.parameters={points:t,segments:r,phiStart:i,phiLength:s},this.fromBufferGeometry(new Bh(t,r,i,s)),this.mergeVertices()}function Bh(t,r,i,s){ke.call(this),this.type="LatheBufferGeometry",this.parameters={points:t,segments:r,phiStart:i,phiLength:s},r=Math.floor(r)||12,i=i||0,s=s||2*Math.PI,s=ti.clamp(s,0,2*Math.PI);var f=[],c=[],d=[],p=1/r,A=new dt,S=new Ot,z;for(z=0;z<=r;z++){var w=i+z*p*s,I=Math.sin(w),E=Math.cos(w);for(w=0;w<=t.length-1;w++)A.x=t[w].x*I,A.y=t[w].y,A.z=t[w].x*E,c.push(A.x,A.y,A.z),S.x=z/r,S.y=w/(t.length-1),d.push(S.x,S.y)}for(z=0;z<r;z++)for(w=0;w<t.length-1;w++)i=w+z*t.length,p=i+t.length,A=i+t.length+1,S=i+1,f.push(i,p,S),f.push(p,A,S);if(this.setIndex(f),this.setAttribute("position",new Ge(c,3)),this.setAttribute("uv",new Ge(d,2)),this.computeVertexNormals(),s===2*Math.PI)for(s=this.attributes.normal.array,f=new dt,c=new dt,d=new dt,i=r*t.length*3,w=z=0;z<t.length;z++,w+=3)f.x=s[w+0],f.y=s[w+1],f.z=s[w+2],c.x=s[i+w+0],c.y=s[i+w+1],c.z=s[i+w+2],d.addVectors(f,c).normalize(),s[w+0]=s[i+w+0]=d.x,s[w+1]=s[i+w+1]=d.y,s[w+2]=s[i+w+2]=d.z}function zh(t,r){Gr.call(this),this.type="ShapeGeometry",(typeof r=="undefined"?"undefined":ts(r))==="object"&&(console.warn("THREE.ShapeGeometry: Options parameter has been removed."),r=r.curveSegments),this.parameters={shapes:t,curveSegments:r},this.fromBufferGeometry(new oa(t,r)),this.mergeVertices()}function oa(t,r){function i(z){var w,I=f.length/3;z=z.extractPoints(r);var E=z.shape,P=z.holes;for(gc.isClockWise(E)===!1&&(E=E.reverse()),z=0,w=P.length;z<w;z++){var F=P[z];gc.isClockWise(F)===!0&&(P[z]=F.reverse())}var X=gc.triangulateShape(E,P);for(z=0,w=P.length;z<w;z++)F=P[z],E=E.concat(F);for(z=0,w=E.length;z<w;z++)F=E[z],f.push(F.x,F.y,0),c.push(0,0,1),d.push(F.x,F.y);for(z=0,w=X.length;z<w;z++)E=X[z],s.push(E[0]+I,E[1]+I,E[2]+I),A+=3}ke.call(this),this.type="ShapeBufferGeometry",this.parameters={shapes:t,curveSegments:r},r=r||12;var s=[],f=[],c=[],d=[],p=0,A=0;if(Array.isArray(t)===!1)i(t);else for(var S=0;S<t.length;S++)i(t[S]),this.addGroup(p,A,S),p+=A,A=0;this.setIndex(s),this.setAttribute("position",new Ge(f,3)),this.setAttribute("normal",new Ge(c,3)),this.setAttribute("uv",new Ge(d,2))}function Ag(t,r){if(r.shapes=[],Array.isArray(t))for(var i=0,s=t.length;i<s;i++)r.shapes.push(t[i].uuid);else r.shapes.push(t.uuid);return r}function ka(t,r){ke.call(this),this.type="EdgesGeometry",this.parameters={thresholdAngle:r};var i=[];r=Math.cos(ti.DEG2RAD*(r!==void 0?r:1));var s=[0,0],f={},c=["a","b","c"];if(t.isBufferGeometry){var d=new Gr;d.fromBufferGeometry(t)}else d=t.clone();d.mergeVertices(),d.computeFaceNormals(),t=d.vertices,d=d.faces;for(var p=0,A=d.length;p<A;p++)for(var S=d[p],z=0;3>z;z++){var w=S[c[z]],I=S[c[(z+1)%3]];s[0]=Math.min(w,I),s[1]=Math.max(w,I),w=s[0]+","+s[1],f[w]===void 0?f[w]={index1:s[0],index2:s[1],face1:p,face2:void 0}:f[w].face2=p}for(w in f)s=f[w],(s.face2===void 0||d[s.face1].normal.dot(d[s.face2].normal)<=r)&&(c=t[s.index1],i.push(c.x,c.y,c.z),c=t[s.index2],i.push(c.x,c.y,c.z));this.setAttribute("position",new Ge(i,3))}function kn(t,r,i,s,f,c,d,p){Gr.call(this),this.type="CylinderGeometry",this.parameters={radiusTop:t,radiusBottom:r,height:i,radialSegments:s,heightSegments:f,openEnded:c,thetaStart:d,thetaLength:p},this.fromBufferGeometry(new Fu(t,r,i,s,f,c,d,p)),this.mergeVertices()}function Fu(t,r,i,s,f,c,d,p){function A(J){var it,lt=new Ot,Mt=new dt,Ct=0,wt=J===!0?t:r,zt=J===!0?1:-1,Ut=P;for(it=1;it<=s;it++)w.push(0,X*zt,0),I.push(0,zt,0),E.push(.5,.5),P++;var Kt=P;for(it=0;it<=s;it++){var Gt=it/s*p+d,Qt=Math.cos(Gt);Gt=Math.sin(Gt),Mt.x=wt*Gt,Mt.y=X*zt,Mt.z=wt*Qt,w.push(Mt.x,Mt.y,Mt.z),I.push(0,zt,0),lt.x=.5*Qt+.5,lt.y=.5*Gt*zt+.5,E.push(lt.x,lt.y),P++}for(it=0;it<s;it++)lt=Ut+it,Mt=Kt+it,J===!0?z.push(Mt,Mt+1,lt):z.push(Mt+1,Mt,lt),Ct+=3;S.addGroup(q,Ct,J===!0?1:2),q+=Ct}ke.call(this),this.type="CylinderBufferGeometry",this.parameters={radiusTop:t,radiusBottom:r,height:i,radialSegments:s,heightSegments:f,openEnded:c,thetaStart:d,thetaLength:p};var S=this;t=t!==void 0?t:1,r=r!==void 0?r:1,i=i||1,s=Math.floor(s)||8,f=Math.floor(f)||1,c=c!==void 0?c:!1,d=d!==void 0?d:0,p=p!==void 0?p:2*Math.PI;var z=[],w=[],I=[],E=[],P=0,F=[],X=i/2,q=0;(function(){var J,it,lt=new dt,Mt=new dt,Ct=0,wt=(r-t)/i;for(it=0;it<=f;it++){var zt=[],Ut=it/f,Kt=Ut*(r-t)+t;for(J=0;J<=s;J++){var Gt=J/s,Qt=Gt*p+d,De=Math.sin(Qt);Qt=Math.cos(Qt),Mt.x=Kt*De,Mt.y=-Ut*i+X,Mt.z=Kt*Qt,w.push(Mt.x,Mt.y,Mt.z),lt.set(De,wt,Qt).normalize(),I.push(lt.x,lt.y,lt.z),E.push(Gt,1-Ut),zt.push(P++)}F.push(zt)}for(J=0;J<s;J++)for(it=0;it<f;it++)lt=F[it+1][J],Mt=F[it+1][J+1],wt=F[it][J+1],z.push(F[it][J],lt,wt),z.push(lt,Mt,wt),Ct+=6;S.addGroup(q,Ct,0),q+=Ct})(),c===!1&&(0<t&&A(!0),0<r&&A(!1)),this.setIndex(z),this.setAttribute("position",new Ge(w,3)),this.setAttribute("normal",new Ge(I,3)),this.setAttribute("uv",new Ge(E,2))}function _r(t,r,i,s,f,c,d){kn.call(this,0,t,r,i,s,f,c,d),this.type="ConeGeometry",this.parameters={radius:t,height:r,radialSegments:i,heightSegments:s,openEnded:f,thetaStart:c,thetaLength:d}}function hd(t,r,i,s,f,c,d){Fu.call(this,0,t,r,i,s,f,c,d),this.type="ConeBufferGeometry",this.parameters={radius:t,height:r,radialSegments:i,heightSegments:s,openEnded:f,thetaStart:c,thetaLength:d}}function cd(t,r,i,s){Gr.call(this),this.type="CircleGeometry",this.parameters={radius:t,segments:r,thetaStart:i,thetaLength:s},this.fromBufferGeometry(new Nh(t,r,i,s)),this.mergeVertices()}function Nh(t,r,i,s){ke.call(this),this.type="CircleBufferGeometry",this.parameters={radius:t,segments:r,thetaStart:i,thetaLength:s},t=t||1,r=r!==void 0?Math.max(3,r):8,i=i!==void 0?i:0,s=s!==void 0?s:2*Math.PI;var f=[],c=[],d=[],p=[],A,S=new dt,z=new Ot;c.push(0,0,0),d.push(0,0,1),p.push(.5,.5);var w=0;for(A=3;w<=r;w++,A+=3){var I=i+w/r*s;S.x=t*Math.cos(I),S.y=t*Math.sin(I),c.push(S.x,S.y,S.z),d.push(0,0,1),z.x=(c[A]/t+1)/2,z.y=(c[A+1]/t+1)/2,p.push(z.x,z.y)}for(A=1;A<=r;A++)f.push(A,A+1,0);this.setIndex(f),this.setAttribute("position",new Ge(c,3)),this.setAttribute("normal",new Ge(d,3)),this.setAttribute("uv",new Ge(p,2))}function Uh(t){Rr.call(this),this.type="ShadowMaterial",this.color=new Oe(0),this.transparent=!0,this.setValues(t)}function xf(t){Ki.call(this,t),this.type="RawShaderMaterial"}function yo(t){Rr.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Oe(16777215),this.roughness=1,this.metalness=0,this.lightMap=this.map=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Oe(0),this.emissiveIntensity=1,this.bumpMap=this.emissiveMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Ot(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.envMap=this.alphaMap=this.metalnessMap=this.roughnessMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinejoin=this.wireframeLinecap="round",this.vertexTangents=this.morphNormals=this.morphTargets=this.skinning=!1,this.setValues(t)}function Bl(t){yo.call(this),this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoat=0,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Ot(1,1),this.clearcoatNormalMap=null,this.reflectivity=.5,this.sheen=null,this.transparency=0,this.setValues(t)}function Ha(t){Rr.call(this),this.type="MeshPhongMaterial",this.color=new Oe(16777215),this.specular=new Oe(1118481),this.shininess=30,this.lightMap=this.map=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Oe(0),this.emissiveIntensity=1,this.bumpMap=this.emissiveMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Ot(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.envMap=this.alphaMap=this.specularMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinejoin=this.wireframeLinecap="round",this.morphNormals=this.morphTargets=this.skinning=!1,this.setValues(t)}function yr(t){Rr.call(this),this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new Oe(16777215),this.specular=new Oe(1118481),this.shininess=30,this.lightMap=this.gradientMap=this.map=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Oe(0),this.emissiveIntensity=1,this.bumpMap=this.emissiveMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Ot(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=this.specularMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinejoin=this.wireframeLinecap="round",this.morphNormals=this.morphTargets=this.skinning=!1,this.setValues(t)}function bh(t){Rr.call(this),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Ot(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.morphNormals=this.morphTargets=this.skinning=this.fog=!1,this.setValues(t)}function kh(t){Rr.call(this),this.type="MeshLambertMaterial",this.color=new Oe(16777215),this.lightMap=this.map=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Oe(0),this.emissiveIntensity=1,this.envMap=this.alphaMap=this.specularMap=this.emissiveMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinejoin=this.wireframeLinecap="round",this.morphNormals=this.morphTargets=this.skinning=!1,this.setValues(t)}function Ga(t){Rr.call(this),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new Oe(16777215),this.bumpMap=this.map=this.matcap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Ot(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.morphNormals=this.morphTargets=this.skinning=!1,this.setValues(t)}function Hh(t){$i.call(this),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(t)}function Oo(t,r,i,s){this.parameterPositions=t,this._cachedIndex=0,this.resultBuffer=s!==void 0?s:new r.constructor(i),this.sampleValues=r,this.valueSize=i}function zl(t,r,i,s){Oo.call(this,t,r,i,s),this._offsetNext=this._weightNext=this._offsetPrev=this._weightPrev=-0}function fd(t,r,i,s){Oo.call(this,t,r,i,s)}function Af(t,r,i,s){Oo.call(this,t,r,i,s)}function co(t,r,i,s){if(t===void 0)throw Error("THREE.KeyframeTrack: track name is undefined");if(r===void 0||r.length===0)throw Error("THREE.KeyframeTrack: no keyframes in track named "+t);this.name=t,this.times=Sn.convertArray(r,this.TimeBufferType),this.values=Sn.convertArray(i,this.ValueBufferType),this.setInterpolation(s||this.DefaultInterpolation)}function Nl(t,r,i){co.call(this,t,r,i)}function Bu(t,r,i,s){co.call(this,t,r,i,s)}function Gh(t,r,i,s){co.call(this,t,r,i,s)}function Ri(t,r,i,s){Oo.call(this,t,r,i,s)}function Vh(t,r,i,s){co.call(this,t,r,i,s)}function pd(t,r,i,s){co.call(this,t,r,i,s)}function Ul(t,r,i,s){co.call(this,t,r,i,s)}function Fo(t,r,i,s){this.name=t,this.tracks=i,this.duration=r!==void 0?r:-1,this.blendMode=s!==void 0?s:2500,this.uuid=ti.generateUUID(),0>this.duration&&this.resetDuration()}function x1(t){switch(t.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Gh;case"vector":case"vector2":case"vector3":case"vector4":return Ul;case"color":return Bu;case"quaternion":return Vh;case"bool":case"boolean":return Nl;case"string":return pd}throw Error("THREE.KeyframeTrack: Unsupported typeName: "+t)}function A1(t){if(t.type===void 0)throw Error("THREE.KeyframeTrack: track type undefined, can not parse");var r=x1(t.type);if(t.times===void 0){var i=[],s=[];Sn.flattenJSON(t.keys,i,s,"value"),t.times=i,t.values=s}return r.parse!==void 0?r.parse(t):new r(t.name,t.times,t.values,t.interpolation)}function _1(t,r,i){var s=this,f=!1,c=0,d=0,p=void 0,A=[];this.onStart=void 0,this.onLoad=t,this.onProgress=r,this.onError=i,this.itemStart=function(S){d++,f===!1&&s.onStart!==void 0&&s.onStart(S,c,d),f=!0},this.itemEnd=function(S){c++,s.onProgress!==void 0&&s.onProgress(S,c,d),c===d&&(f=!1,s.onLoad!==void 0)&&s.onLoad()},this.itemError=function(S){s.onError!==void 0&&s.onError(S)},this.resolveURL=function(S){return p?p(S):S},this.setURLModifier=function(S){return p=S,this},this.addHandler=function(S,z){return A.push(S,z),this},this.removeHandler=function(S){return S=A.indexOf(S),S!==-1&&A.splice(S,2),this},this.getHandler=function(S){for(var z=0,w=A.length;z<w;z+=2){var I=A[z],E=A[z+1];if(I.global&&(I.lastIndex=0),I.test(S))return E}return null}}function ai(t){this.manager=t!==void 0?t:QC,this.crossOrigin="anonymous",this.resourcePath=this.path="",this.requestHeader={}}function eo(t){ai.call(this,t)}function w1(t){ai.call(this,t)}function Wr(t){ai.call(this,t)}function M1(t){ai.call(this,t)}function _f(t){ai.call(this,t)}function _g(t){ai.call(this,t)}function Wh(t){ai.call(this,t)}function Ir(){this.type="Curve",this.arcLengthDivisions=200}function cs(t,r,i,s,f,c,d,p){Ir.call(this),this.type="EllipseCurve",this.aX=t||0,this.aY=r||0,this.xRadius=i||1,this.yRadius=s||1,this.aStartAngle=f||0,this.aEndAngle=c||2*Math.PI,this.aClockwise=d||!1,this.aRotation=p||0}function wf(t,r,i,s,f,c){cs.call(this,t,r,i,i,s,f,c),this.type="ArcCurve"}function bl(){var t=0,r=0,i=0,s=0;return{initCatmullRom:function(f,c,d,p,A){f=A*(d-f),p=A*(p-c),t=c,r=f,i=-3*c+3*d-2*f-p,s=2*c-2*d+f+p},initNonuniformCatmullRom:function(f,c,d,p,A,S,z){f=((c-f)/A-(d-f)/(A+S)+(d-c)/S)*S,p=((d-c)/S-(p-c)/(S+z)+(p-d)/z)*S,t=c,r=f,i=-3*c+3*d-2*f-p,s=2*c-2*d+f+p},calc:function(f){var c=f*f;return t+r*f+i*c+s*c*f}}}function ln(t,r,i,s){Ir.call(this),this.type="CatmullRomCurve3",this.points=t||[],this.closed=r||!1,this.curveType=i||"centripetal",this.tension=s||.5}function C1(t,r,i,s,f){r=.5*(s-r),f=.5*(f-i);var c=t*t;return(2*i-2*s+r+f)*t*c+(-3*i+3*s-2*r-f)*c+r*t+i}function Mf(t,r,i,s){var f=1-t;return f*f*r+2*(1-t)*t*i+t*t*s}function Cf(t,r,i,s,f){var c=1-t,d=1-t;return c*c*c*r+3*d*d*t*i+3*(1-t)*t*t*s+t*t*t*f}function Bo(t,r,i,s){Ir.call(this),this.type="CubicBezierCurve",this.v0=t||new Ot,this.v1=r||new Ot,this.v2=i||new Ot,this.v3=s||new Ot}function Bi(t,r,i,s){Ir.call(this),this.type="CubicBezierCurve3",this.v0=t||new dt,this.v1=r||new dt,this.v2=i||new dt,this.v3=s||new dt}function ro(t,r){Ir.call(this),this.type="LineCurve",this.v1=t||new Ot,this.v2=r||new Ot}function zo(t,r){Ir.call(this),this.type="LineCurve3",this.v1=t||new dt,this.v2=r||new dt}function fo(t,r,i){Ir.call(this),this.type="QuadraticBezierCurve",this.v0=t||new Ot,this.v1=r||new Ot,this.v2=i||new Ot}function Va(t,r,i){Ir.call(this),this.type="QuadraticBezierCurve3",this.v0=t||new dt,this.v1=r||new dt,this.v2=i||new dt}function xo(t){Ir.call(this),this.type="SplineCurve",this.points=t||[]}function Rn(){Ir.call(this),this.type="CurvePath",this.curves=[],this.autoClose=!1}function fs(t){Rn.call(this),this.type="Path",this.currentPoint=new Ot,t&&this.setFromPoints(t)}function zu(t){fs.call(this,t),this.uuid=ti.generateUUID(),this.type="Shape",this.holes=[]}function ji(t,r){fe.call(this),this.type="Light",this.color=new Oe(t),this.intensity=r!==void 0?r:1,this.receiveShadow=void 0}function jh(t,r,i){ji.call(this,t,i),this.type="HemisphereLight",this.castShadow=void 0,this.position.copy(fe.DefaultUp),this.updateMatrix(),this.groundColor=new Oe(r)}function Wa(t){this.camera=t,this.bias=0,this.radius=1,this.mapSize=new Ot(512,512),this.mapPass=this.map=null,this.matrix=new Me,this._frustum=new Su,this._frameExtents=new Ot(1,1),this._viewportCount=1,this._viewports=[new jt(0,0,1,1)]}function Tf(){Wa.call(this,new en(50,1,.5,500))}function sa(t,r,i,s,f,c){ji.call(this,t,r),this.type="SpotLight",this.position.copy(fe.DefaultUp),this.updateMatrix(),this.target=new fe,Object.defineProperty(this,"power",{get:function(){return this.intensity*Math.PI},set:function(d){this.intensity=d/Math.PI}}),this.distance=i!==void 0?i:0,this.angle=s!==void 0?s:Math.PI/3,this.penumbra=f!==void 0?f:0,this.decay=c!==void 0?c:1,this.shadow=new Tf}function Sf(){Wa.call(this,new en(90,1,.5,500)),this._frameExtents=new Ot(4,2),this._viewportCount=6,this._viewports=[new jt(2,1,1,1),new jt(0,1,1,1),new jt(3,1,1,1),new jt(1,1,1,1),new jt(3,0,1,1),new jt(1,0,1,1)],this._cubeDirections=[new dt(1,0,0),new dt(-1,0,0),new dt(0,0,1),new dt(0,0,-1),new dt(0,1,0),new dt(0,-1,0)],this._cubeUps=[new dt(0,1,0),new dt(0,1,0),new dt(0,1,0),new dt(0,1,0),new dt(0,0,1),new dt(0,0,-1)]}function Nu(t,r,i,s){ji.call(this,t,r),this.type="PointLight",Object.defineProperty(this,"power",{get:function(){return 4*this.intensity*Math.PI},set:function(f){this.intensity=f/(4*Math.PI)}}),this.distance=i!==void 0?i:0,this.decay=s!==void 0?s:1,this.shadow=new Sf}function ja(t,r,i,s,f,c){Da.call(this),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=t!==void 0?t:-1,this.right=r!==void 0?r:1,this.top=i!==void 0?i:1,this.bottom=s!==void 0?s:-1,this.near=f!==void 0?f:.1,this.far=c!==void 0?c:2e3,this.updateProjectionMatrix()}function If(){Wa.call(this,new ja(-5,5,5,-5,.5,500))}function kl(t,r){ji.call(this,t,r),this.type="DirectionalLight",this.position.copy(fe.DefaultUp),this.updateMatrix(),this.target=new fe,this.shadow=new If}function wg(t,r){ji.call(this,t,r),this.type="AmbientLight",this.castShadow=void 0}function dd(t,r,i,s){ji.call(this,t,r),this.type="RectAreaLight",this.width=i!==void 0?i:10,this.height=s!==void 0?s:10}function Fs(){this.coefficients=[];for(var t=0;9>t;t++)this.coefficients.push(new dt)}function Ao(t,r){ji.call(this,void 0,r),this.type="LightProbe",this.sh=t!==void 0?t:new Fs}function Xa(t){ai.call(this,t),this.textures={}}function Uu(){ke.call(this),this.type="InstancedBufferGeometry",this.instanceCount=1/0}function Ef(t,r,i,s){typeof i=="number"&&(s=i,i=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),wr.call(this,t,r,i),this.meshPerAttribute=s||1}function Xh(t){ai.call(this,t)}function md(t){ai.call(this,t)}function Mg(t){typeof createImageBitmap=="undefined"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch=="undefined"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),ai.call(this,t),this.options=void 0}function Cg(){this.type="ShapePath",this.color=new Oe,this.subPaths=[],this.currentPath=null}function Yh(t){this.type="Font",this.data=t}function _o(t){ai.call(this,t)}function ps(t){ai.call(this,t)}function Tg(t,r,i){Ao.call(this,void 0,i),t=new Oe().set(t),i=new Oe().set(r),r=new dt(t.r,t.g,t.b),t=new dt(i.r,i.g,i.b),i=Math.sqrt(Math.PI);var s=i*Math.sqrt(.75);this.sh.coefficients[0].copy(r).add(t).multiplyScalar(i),this.sh.coefficients[1].copy(r).sub(t).multiplyScalar(s)}function Sg(t,r){Ao.call(this,void 0,r),t=new Oe().set(t),this.sh.coefficients[0].set(t.r,t.g,t.b).multiplyScalar(2*Math.sqrt(Math.PI))}function gd(t){this.autoStart=t!==void 0?t:!0,this.elapsedTime=this.oldTime=this.startTime=0,this.running=!1}function Ig(){fe.call(this),this.type="AudioListener",this.context=t3.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new gd}function Zh(t){fe.call(this),this.type="Audio",this.listener=t,this.context=t.context,this.gain=this.context.createGain(),this.gain.connect(t.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.offset=this.loopEnd=this.loopStart=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.sourceType="empty",this._progress=this._startedAt=0,this.filters=[]}function vd(t){Zh.call(this,t),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}function Eg(t,r){this.analyser=t.context.createAnalyser(),this.analyser.fftSize=r!==void 0?r:2048,this.data=new Uint8Array(this.analyser.frequencyBinCount),t.getOutput().connect(this.analyser)}function yd(t,r,i){switch(this.binding=t,this.valueSize=i,r){case"quaternion":t=this._slerp,r=this._slerpAdditive;var s=this._setAdditiveIdentityQuaternion;this.buffer=new Float64Array(6*i),this._workIndex=5;break;case"string":case"bool":r=t=this._select,s=this._setAdditiveIdentityOther,this.buffer=Array(5*i);break;default:t=this._lerp,r=this._lerpAdditive,s=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*i)}this._mixBufferRegion=t,this._mixBufferRegionAdditive=r,this._setIdentity=s,this._origIndex=3,this._addIndex=4,this.referenceCount=this.useCount=this.cumulativeWeightAdditive=this.cumulativeWeight=0}function Lg(t,r,i){i=i||io.parseTrackName(r),this._targetGroup=t,this._bindings=t.subscribe_(r,i)}function io(t,r,i){this.path=r,this.parsedPath=i||io.parseTrackName(r),this.node=io.findNode(t,this.parsedPath.nodeName)||t,this.rootNode=t}function T1(t,r,i,s){this._mixer=t,this._clip=r,this._localRoot=i||null,this.blendMode=s||r.blendMode,t=r.tracks,r=t.length,i=Array(r),s={endingStart:2400,endingEnd:2400};for(var f=0;f!==r;++f){var c=t[f].createInterpolant(null);i[f]=c,c.settings=s}this._interpolantSettings=s,this._interpolants=i,this._propertyBindings=Array(r),this._weightInterpolant=this._timeScaleInterpolant=this._byClipCacheIndex=this._cacheIndex=null,this.loop=2201,this._loopCount=-1,this._startTime=null,this.time=0,this._effectiveWeight=this.weight=this._effectiveTimeScale=this.timeScale=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtEnd=this.zeroSlopeAtStart=!0}function Rg(t){this._root=t,this._initMemoryManager(),this.time=this._accuIndex=0,this.timeScale=1}function xd(t,r){typeof t=="string"&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),t=r),this.value=t}function qh(t,r,i){Ue.call(this,t,r),this.meshPerAttribute=i||1}function S1(t,r,i,s){this.ray=new Ln(t,r),this.near=i||0,this.far=s||1/0,this.camera=null,this.layers=new Tr,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}},Or(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})}function Hn(t,r){return t.distance-r.distance}function Ya(t,r,i,s){if(t.layers.test(r.layers)&&t.raycast(r,i),s===!0){t=t.children,s=0;for(var f=t.length;s<f;s++)Ya(t[s],r,i,!0)}}function br(t,r){this.min=t!==void 0?t:new Ot(1/0,1/0),this.max=r!==void 0?r:new Ot(-1/0,-1/0)}function Za(t,r){this.start=t!==void 0?t:new dt,this.end=r!==void 0?r:new dt}function aa(t){fe.call(this),this.material=t,this.render=function(){},this.hasUvs=this.hasColors=this.hasNormals=this.hasPositions=!1,this.uvArray=this.colorArray=this.normalArray=this.positionArray=null,this.count=0}function Lf(t,r){fe.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=r,t=new ke,r=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(var i=0,s=1;32>i;i++,s++){var f=i/32*Math.PI*2,c=s/32*Math.PI*2;r.push(Math.cos(f),Math.sin(f),1,Math.cos(c),Math.sin(c),1)}t.setAttribute("position",new Ge(r,3)),r=new $i({fog:!1,toneMapped:!1}),this.cone=new Fi(t,r),this.add(this.cone),this.update()}function I1(t){var r=[];t&&t.isBone&&r.push(t);for(var i=0;i<t.children.length;i++)r.push.apply(r,I1(t.children[i]));return r}function qo(t){for(var r=I1(t),i=new ke,s=[],f=[],c=new Oe(0,0,1),d=new Oe(0,1,0),p=0;p<r.length;p++){var A=r[p];A.parent&&A.parent.isBone&&(s.push(0,0,0),s.push(0,0,0),f.push(c.r,c.g,c.b),f.push(d.r,d.g,d.b))}i.setAttribute("position",new Ge(s,3)),i.setAttribute("color",new Ge(f,3)),s=new $i({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0}),Fi.call(this,i,s),this.type="SkeletonHelper",this.root=t,this.bones=r,this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1}function Jh(t,r,i){this.light=t,this.light.updateMatrixWorld(),this.color=i,t=new Fl(r,4,2),r=new Nn({wireframe:!0,fog:!1,toneMapped:!1}),Zi.call(this,t,r),this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}function No(t,r,i){fe.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=i,t=new na(r),t.rotateY(.5*Math.PI),this.material=new Nn({wireframe:!0,fog:!1,toneMapped:!1}),this.color===void 0&&(this.material.vertexColors=!0),r=t.getAttribute("position"),r=new Float32Array(3*r.count),t.setAttribute("color",new wr(r,3)),this.add(new Zi(t,this.material)),this.update()}function Ad(t,r,i,s){t=t||10,r=r||10,i=new Oe(i!==void 0?i:4473924),s=new Oe(s!==void 0?s:8947848);var f=r/2,c=t/r,d=t/2;t=[];for(var p=[],A=0,S=0,z=-d;A<=r;A++,z+=c){t.push(-d,0,z,d,0,z),t.push(z,0,-d,z,0,d);var w=A===f?i:s;w.toArray(p,S),S+=3,w.toArray(p,S),S+=3,w.toArray(p,S),S+=3,w.toArray(p,S),S+=3}r=new ke,r.setAttribute("position",new Ge(t,3)),r.setAttribute("color",new Ge(p,3)),i=new $i({vertexColors:!0,toneMapped:!1}),Fi.call(this,r,i),this.type="GridHelper"}function Jo(t,r,i,s,f,c){t=t||10,r=r||16,i=i||8,s=s||64,f=new Oe(f!==void 0?f:4473924),c=new Oe(c!==void 0?c:8947848);var d=[],p=[],A;for(A=0;A<=r;A++){var S=A/r*2*Math.PI,z=Math.sin(S)*t;S=Math.cos(S)*t,d.push(0,0,0),d.push(z,0,S);var w=A&1?f:c;p.push(w.r,w.g,w.b),p.push(w.r,w.g,w.b)}for(A=0;A<=i;A++){w=A&1?f:c;var I=t-t/i*A;for(r=0;r<s;r++)S=r/s*2*Math.PI,z=Math.sin(S)*I,S=Math.cos(S)*I,d.push(z,0,S),p.push(w.r,w.g,w.b),S=(r+1)/s*2*Math.PI,z=Math.sin(S)*I,S=Math.cos(S)*I,d.push(z,0,S),p.push(w.r,w.g,w.b)}t=new ke,t.setAttribute("position",new Ge(d,3)),t.setAttribute("color",new Ge(p,3)),d=new $i({vertexColors:!0,toneMapped:!1}),Fi.call(this,t,d),this.type="PolarGridHelper"}function Rf(t,r,i){fe.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=i,r===void 0&&(r=1),t=new ke,t.setAttribute("position",new Ge([-r,r,0,r,r,0,r,-r,0,-r,-r,0,-r,r,0],3)),r=new $i({fog:!1,toneMapped:!1}),this.lightPlane=new Po(t,r),this.add(this.lightPlane),t=new ke,t.setAttribute("position",new Ge([0,0,0,0,0,1],3)),this.targetLine=new Po(t,r),this.add(this.targetLine),this.update()}function Qh(t){function r(E,P,F){i(E,F),i(P,F)}function i(E,P){c.push(0,0,0),d.push(P.r,P.g,P.b),p[E]===void 0&&(p[E]=[]),p[E].push(c.length/3-1)}var s=new ke,f=new $i({color:16777215,vertexColors:!0,toneMapped:!1}),c=[],d=[],p={},A=new Oe(16755200),S=new Oe(16711680),z=new Oe(43775),w=new Oe(16777215),I=new Oe(3355443);r("n1","n2",A),r("n2","n4",A),r("n4","n3",A),r("n3","n1",A),r("f1","f2",A),r("f2","f4",A),r("f4","f3",A),r("f3","f1",A),r("n1","f1",A),r("n2","f2",A),r("n3","f3",A),r("n4","f4",A),r("p","n1",S),r("p","n2",S),r("p","n3",S),r("p","n4",S),r("u1","u2",z),r("u2","u3",z),r("u3","u1",z),r("c","t",w),r("p","c",I),r("cn1","cn2",I),r("cn3","cn4",I),r("cf1","cf2",I),r("cf3","cf4",I),s.setAttribute("position",new Ge(c,3)),s.setAttribute("color",new Ge(d,3)),Fi.call(this,s,f),this.type="CameraHelper",this.camera=t,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=p,this.update()}function wn(t,r,i,s,f,c,d){if(qy.set(f,c,d).unproject(s),t=r[t],t!==void 0)for(i=i.getAttribute("position"),r=0,s=t.length;r<s;r++)i.setXYZ(t[r],qy.x,qy.y,qy.z)}function Hl(t,r){this.object=t,r===void 0&&(r=16776960),t=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]);var i=new Float32Array(24),s=new ke;s.setIndex(new wr(t,1)),s.setAttribute("position",new wr(i,3)),Fi.call(this,s,new $i({color:r,toneMapped:!1})),this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}function Gl(t,r){this.type="Box3Helper",this.box=t,r=r||16776960,t=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]);var i=new ke;i.setIndex(new wr(t,1)),i.setAttribute("position",new Ge([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),Fi.call(this,i,new $i({color:r,toneMapped:!1})),this.type="Box3Helper",this.geometry.computeBoundingSphere()}function _d(t,r,i){this.plane=t,this.size=r===void 0?1:r,t=i!==void 0?i:16776960,r=new ke,r.setAttribute("position",new Ge([1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],3)),r.computeBoundingSphere(),Po.call(this,r,new $i({color:t,toneMapped:!1})),this.type="PlaneHelper",r=new ke,r.setAttribute("position",new Ge([1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],3)),r.computeBoundingSphere(),this.add(new Zi(r,new Nn({color:t,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}function bu(t,r,i,s,f,c){fe.call(this),this.type="ArrowHelper",t===void 0&&(t=new dt(0,0,1)),r===void 0&&(r=new dt(0,0,0)),i===void 0&&(i=1),s===void 0&&(s=16776960),f===void 0&&(f=.2*i),c===void 0&&(c=.2*f),Qy===void 0&&(Qy=new ke,Qy.setAttribute("position",new Ge([0,0,0,0,1,0],3)),I_=new Fu(0,.5,1,5,1),I_.translate(0,-.5,0)),this.position.copy(r),this.line=new Po(Qy,new $i({color:s,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new Zi(I_,new Nn({color:s,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(t),this.setLength(i,f,c)}function Pg(t){t=t||1;var r=[0,0,0,t,0,0,0,0,0,0,t,0,0,0,0,0,0,t];t=new ke,t.setAttribute("position",new Ge(r,3)),t.setAttribute("color",new Ge([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3)),r=new $i({vertexColors:!0,toneMapped:!1}),Fi.call(this,t,r),this.type="AxesHelper"}function E1(t){console.warn("THREE.Spline has been removed. Use THREE.CatmullRomCurve3 instead."),ln.call(this,t),this.type="catmullrom"}function Bs(){}function ua(t,r){for(var i in r)t[i]=r[i]}function Gn(t,r){this.lng=t,this.lat=r}function qa(t,r){this.x=t,this.y=r}function Qo(t){for(var r=t.length;0<=--r;)t[r]=0}function no(t,r){return function(i){return r(t(i))}}function Mi(t){var r=function(i){return i==null?i:(1<arguments.length&&(i=Array.prototype.slice.call(arguments)),t(i))};return"conversion"in t&&(r.conversion=t.conversion),r}function Pf(t){var r=function(i){if(i==null)return i;1<arguments.length&&(i=Array.prototype.slice.call(arguments));var s=t(i);if((typeof s=="undefined"?"undefined":ts(s))==="object")for(var f=s.length,c=0;c<f;c++)s[c]=Math.round(s[c]);return s};return"conversion"in t&&(r.conversion=t.conversion),r}function Vn(t,r){if(!(this instanceof Vn))return new Vn(t,r);if(r&&r in m3&&(r=null),r&&!(r in Vs))throw Error("Unknown model: "+r);if(typeof t=="undefined")this.model="rgb",this.color=[0,0,0],this.valpha=1;else if(t instanceof Vn)this.model=t.model,this.color=t.color.slice(),this.valpha=t.valpha;else if(typeof t=="string"){if(r=Dv.get(t),r===null)throw Error("Unable to parse color from string: "+t);this.model=r.model;var i=Vs[this.model].channels;this.color=r.value.slice(0,i),this.valpha=typeof r.value[i]=="number"?r.value[i]:1}else if(t.length)this.model=r||"rgb",i=Vs[this.model].channels,r=L_.call(t,0,i),this.color=Dg(r,i),this.valpha=typeof t[i]=="number"?t[i]:1;else if(typeof t=="number")t&=16777215,this.model="rgb",this.color=[t>>16&255,t>>8&255,t&255],this.valpha=1;else{if(this.valpha=1,r=Ti(t),"alpha"in t&&(r.splice(r.indexOf("alpha"),1),this.valpha=typeof t.alpha=="number"?t.alpha:0),r=r.sort().join(""),!(r in R_))throw Error("Unable to parse color from object: "+Hs(t));this.model=R_[r],i=Vs[this.model].labels;var s=[];for(r=0;r<i.length;r++)s.push(t[i[r]]);this.color=Dg(s)}if(Ky[this.model])for(i=Vs[this.model].channels,r=0;r<i;r++)(t=Ky[this.model][r])&&(this.color[r]=t(this.color[r]));this.valpha=Math.max(0,Math.min(1,this.valpha)),$a&&$a(this)}function Vl(t){return function(r){return Number(r.toFixed(t))}}function rn(t,r,i){return t=Array.isArray(t)?t:[t],t.forEach(function(s){(Ky[s]||(Ky[s]=[]))[r]=i}),t=t[0],function(s){if(arguments.length){i&&(s=i(s));var f=this[t]();return f.color[r]=s,f}return f=this[t]().color[r],i&&(f=i(f)),f}}function nn(t){return function(r){return Math.max(0,Math.min(t,r))}}function Dg(t,r){for(var i=0;i<r;i++)typeof t[i]!="number"&&(t[i]=0);return t}function MA(t,r){for(var i=["webgl2","experimental-webgl2","webgl","experimental-webgl"],s=void 0,f=0;f<i.length;f++)try{if(s=t.getContext(i[f],{stencil:!0,alpha:!0,premultipliedAlpha:!1,antialias:r.antialias||!0,preserveDrawingBuffer:r.preserveDrawingBuffer||!1}))break}catch{}return s}function Mn(){this.needsSwap=this.enabled=!0,this.renderToScreen=this.clear=!1}var Og=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof Gc!="undefined"?Gc:typeof self!="undefined"?self:{},Yr=ht(function(t){t=t.exports=typeof window!="undefined"&&Math==Math?window:typeof self!="undefined"&&self.Math==Math?self:Function("return this")(),typeof __g=="number"&&(__g=t)}),yi=ht(function(t){t=t.exports={version:"2.6.5"},typeof __e=="number"&&(__e=t)}),zs=function(t){if(typeof t!="function")throw TypeError(t+" is not a function!");return t},Cn=function(t,r,i){if(zs(t),r===void 0)return t;switch(i){case 1:return function(s){return t.call(r,s)};case 2:return function(s,f){return t.call(r,s,f)};case 3:return function(s,f,c){return t.call(r,s,f,c)}}return function(){return t.apply(r,arguments)}},dn=function(t){return typeof t=="object"?t!==null:typeof t=="function"},Pn=function(t){if(!dn(t))throw TypeError(t+" is not an object!");return t},wo=function(t){try{return!!t()}catch{return!0}},oo=!wo(function(){return Object.defineProperty({},"a",{get:function(){return 7}}).a!=7}),Wl=Yr.document,Df=dn(Wl)&&dn(Wl.createElement),L1=!oo&&!wo(function(){return Object.defineProperty(Df?Wl.createElement("div"):{},"a",{get:function(){return 7}}).a!=7}),Of=function(t,r){if(!dn(t))return t;var i,s;if(r&&typeof(i=t.toString)=="function"&&!dn(s=i.call(t))||typeof(i=t.valueOf)=="function"&&!dn(s=i.call(t))||!r&&typeof(i=t.toString)=="function"&&!dn(s=i.call(t)))return s;throw TypeError("Can't convert object to primitive value")},CA=Object.defineProperty,Ko={f:oo?Object.defineProperty:function(t,r,i){if(Pn(t),r=Of(r,!0),Pn(i),L1)try{return CA(t,r,i)}catch{}if("get"in i||"set"in i)throw TypeError("Accessors not supported!");return"value"in i&&(t[r]=i.value),t}},Ns=function(t,r){return{enumerable:!(t&1),configurable:!(t&2),writable:!(t&4),value:r}},la=oo?function(t,r,i){return Ko.f(t,r,Ns(1,i))}:function(t,r,i){return t[r]=i,t},TA={}.hasOwnProperty,zi=function(t,r){return TA.call(t,r)},po=function(t,r,i){var s=t&po.F,f=t&po.G,c=t&po.S,d=t&po.P,p=t&po.B,A=t&po.W,S=f?yi:yi[r]||(yi[r]={}),z=S.prototype;c=f?Yr:c?Yr[r]:(Yr[r]||{}).prototype;var w;f&&(i=r);for(w in i)if(r=!s&&c&&c[w]!==void 0,!r||!zi(S,w)){var I=r?c[w]:i[w];S[w]=f&&typeof c[w]!="function"?i[w]:p&&r?Cn(I,Yr):A&&c[w]==I?function(E){var P=function(F,X,q){if(this instanceof E){switch(arguments.length){case 0:return new E;case 1:return new E(F);case 2:return new E(F,X)}return new E(F,X,q)}return E.apply(this,arguments)};return P.prototype=E.prototype,P}(I):d&&typeof I=="function"?Cn(Function.call,I):I,d&&((S.virtual||(S.virtual={}))[w]=I,t&po.R&&z&&!z[w]&&la(z,w,I))}};po.F=1,po.G=2,po.S=4,po.P=8,po.B=16,po.W=32,po.U=64,po.R=128;var er=po,SA={}.toString,jl=function(t){return SA.call(t).slice(8,-1)},Fg=Object("z").propertyIsEnumerable(0)?Object:function(t){return jl(t)=="String"?t.split(""):Object(t)},ds=function(t){if(t==null)throw TypeError("Can't call method on  "+t);return t},Us=function(t){return Fg(ds(t))},IA=Math.ceil,wd=Math.floor,Ja=function(t){return isNaN(t=+t)?0:(0<t?wd:IA)(t)},EA=Math.min,Md=function(t){return 0<t?EA(Ja(t),9007199254740991):0},ms=Math.max,R1=Math.min,Ff=ht(function(t){var r=Yr["__core-js_shared__"]||(Yr["__core-js_shared__"]={});(t.exports=function(i,s){return r[i]||(r[i]=s!==void 0?s:{})})("versions",[]).push({version:yi.version,mode:"pure",copyright:"\xA9 2019 Denis Pushkarev (zloirock.ru)"})}),LA=0,P1=Math.random(),Bf=function(t){return"Symbol(".concat(t===void 0?"":t,")_",(++LA+P1).toString(36))},Bg=Ff("keys"),Cd=function(t){return Bg[t]||(Bg[t]=Bf(t))},D1=function(t){return function(r,i,s){r=Us(r);var f=Md(r.length);if(s=Ja(s),s=0>s?ms(s+f,0):R1(s,f),t&&i!=i){for(;f>s;)if(i=r[s++],i!=i)return!0}else for(;f>s;s++)if((t||s in r)&&r[s]===i)return t||s||0;return!t&&-1}}(!1),O1=Cd("IE_PROTO"),zg=function(t,r){t=Us(t);var i=0,s=[],f;for(f in t)f!=O1&&zi(t,f)&&s.push(f);for(;r.length>i;)zi(t,f=r[i++])&&(~D1(s,f)||s.push(f));return s},Kh="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" "),ku=Object.keys||function(t){return zg(t,Kh)},Ng=oo?Object.defineProperties:function(t,r){Pn(t);for(var i=ku(r),s=i.length,f=0,c;s>f;)Ko.f(t,c=i[f++],r[c]);return t},ha=Yr.document,Ug=ha&&ha.documentElement,F1=Cd("IE_PROTO"),bg=function(){},Td=function(){var t=Df?Wl.createElement("iframe"):{},r=Kh.length;for(t.style.display="none",Ug.appendChild(t),t.src="javascript:",t=t.contentWindow.document,t.open(),t.write("<script>document.F=Object<\/script>"),t.close(),Td=t.F;r--;)delete Td.prototype[Kh[r]];return Td()},gs=Object.create||function(t,r){if(t!==null){bg.prototype=Pn(t);var i=new bg;bg.prototype=null,i[F1]=t}else i=Td();return r===void 0?i:Ng(i,r)};er(er.S,"Object",{create:gs});var kg=yi.Object,Hg=function(t,r){return kg.create(t,r)},B1=ht(function(t){t.exports={default:Hg,__esModule:!0}}),ft=ot(B1),Gg=Object.getOwnPropertySymbols,zf={}.propertyIsEnumerable,Uo=Object.assign,Vg=!Uo||wo(function(){var t={},r={},i=Symbol();return t[i]=7,"abcdefghijklmnopqrst".split("").forEach(function(s){r[s]=s}),Uo({},t)[i]!=7||Object.keys(Uo({},r)).join("")!="abcdefghijklmnopqrst"})?function(t,r){for(var i=Object(ds(t)),s=arguments.length,f=1,c=Gg,d=zf;s>f;)for(var p=Fg(arguments[f++]),A=c?ku(p).concat(c(p)):ku(p),S=A.length,z=0,w;S>z;)d.call(p,w=A[z++])&&(i[w]=p[w]);return i}:Uo;er(er.S+er.F,"Object",{assign:Vg});var z1=yi.Object.assign,Wg=ht(function(t){t.exports={default:z1,__esModule:!0}}),pt=ot(Wg);er(er.S,"Math",{log2:function(t){return Math.log(t)/Math.LN2}});var jg=yi.Math.log2,Xg=ht(function(t){t.exports={default:jg,__esModule:!0}}),Yg=ot(Xg),bs={},Dn=ht(function(t){var r=Ff("wks"),i=Yr.Symbol,s=typeof i=="function";(t.exports=function(f){return r[f]||(r[f]=s&&i[f]||(s?i:Bf)("Symbol."+f))}).store=r}),vs=Ko.f,on=Dn("toStringTag"),dr=function(t,r,i){t&&!zi(t=i?t:t.prototype,on)&&vs(t,on,{configurable:!0,value:r})},Zr={};la(Zr,Dn("iterator"),function(){return this});var RA=function(t,r,i){t.prototype=gs(Zr,{next:Ns(1,i)}),dr(t,r+" Iterator")},Nf=Cd("IE_PROTO"),Ke=Object.prototype,N1=Object.getPrototypeOf||function(t){return t=Object(ds(t)),zi(t,Nf)?t[Nf]:typeof t.constructor=="function"&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?Ke:null},Zg=Dn("iterator"),qg=!([].keys&&"next"in[].keys()),PA=function(){return this},jr=function(t,r,i,s,f,c,d){RA(i,r,s),s=function(q){return!qg&&q in z?z[q]:function(){return new i(this,q)}};var p=r+" Iterator",A=f=="values",S=!1,z=t.prototype,w=z[Zg]||z["@@iterator"]||f&&z[f],I=w||s(f),E=f?A?s("entries"):I:void 0,P=r=="Array"&&z.entries||w,F;if(P&&(t=N1(P.call(new t)),t!==Object.prototype&&t.next&&dr(t,p,!0)),A&&w&&w.name!=="values"&&(S=!0,I=function(){return w.call(this)}),d&&(qg||S||!z[Zg])&&la(z,Zg,I),bs[r]=I,bs[p]=PA,f){var X={values:A?I:s("values"),keys:c?I:s("keys"),entries:E};if(d)for(F in X)F in z||la(z,F,X[F]);else er(er.P+er.F*(qg||S),r,X)}return X},Qa=function(t){return function(r,i){r=String(ds(r)),i=Ja(i);var s=r.length,f;if(0>i||i>=s)return t?"":void 0;var c=r.charCodeAt(i);return 55296>c||56319<c||i+1===s||56320>(f=r.charCodeAt(i+1))||57343<f?t?r.charAt(i):c:t?r.slice(i,i+2):(c-55296<<10)+(f-56320)+65536}}(!0);jr(String,"String",function(t){this._t=String(t),this._i=0},function(){var t=this._t,r=this._i;return r>=t.length?{value:void 0,done:!0}:(t=Qa(t,r),this._i+=t.length,{value:t,done:!1})});var Jg=function(t,r,i,s){try{return s?r(Pn(i)[0],i[1]):r(i)}catch(f){throw r=t.return,r!==void 0&&Pn(r.call(t)),f}},qe=Dn("iterator"),U1=Array.prototype,bi=Dn("toStringTag"),Zn=jl(function(){return arguments}())=="Arguments",Ka=function(t){var r;if(t===void 0)var i="Undefined";else{if(t===null)var s="Null";else{t:{var f=t=Object(t);try{s=f[bi];break t}catch{}s=void 0}s=typeof(i=s)=="string"?i:Zn?jl(t):(r=jl(t))=="Object"&&typeof t.callee=="function"?"Arguments":r}i=s}return i},DA=Dn("iterator"),Qg=yi.getIteratorMethod=function(t){if(t!=null)return t[DA]||t["@@iterator"]||bs[Ka(t)]},Kg=Dn("iterator"),b1=!1;try{[7][Kg]().return=function(){b1=!0}}catch{}var k1=function(t,r){if(!r&&!b1)return!1;var i=!1;try{r=[7];var s=r[Kg]();s.next=function(){return{done:i=!0}},r[Kg]=function(){return s},t(r)}catch{}return i};er(er.S+er.F*!k1(function(t){}),"Array",{from:function(t){var r=Object(ds(t)),i=typeof this=="function"?this:Array,s=arguments.length,f=1<s?arguments[1]:void 0,c=f!==void 0,d=0,p=Qg(r),A;if(c&&(f=Cn(f,2<s?arguments[2]:void 0,2)),p!=null&&(i!=Array||p===void 0||bs.Array!==p&&U1[qe]!==p))for(r=p.call(r),i=new i;!(A=r.next()).done;d++)s=i,p=d,A=c?Jg(r,f,[A.value,d],!0):A.value,p in s?Ko.f(s,p,Ns(0,A)):s[p]=A;else for(s=Md(r.length),i=new i(s);s>d;d++){p=i,A=d;var S=c?f(r[d],d):r[d];A in p?Ko.f(p,A,Ns(0,S)):p[A]=S}return i.length=d,i}});var OA=yi.Array.from,$h=ht(function(t){t.exports={default:OA,__esModule:!0}}),Hu=ot($h),Gu=function(t,r){return{value:r,done:!!t}};jr(Array,"Array",function(t,r){this._t=Us(t),this._i=0,this._k=r},function(){var t=this._t,r=this._k,i=this._i++;return!t||i>=t.length?(this._t=void 0,Gu(1)):r=="keys"?Gu(0,i):r=="values"?Gu(0,t[i]):Gu(0,[i,t[i]])},"values"),bs.Arguments=bs.Array;for(var H1=Dn("toStringTag"),G1="CSSRuleList CSSStyleDeclaration CSSValueList ClientRectList DOMRectList DOMStringList DOMTokenList DataTransferItemList FileList HTMLAllCollection HTMLCollection HTMLFormElement HTMLSelectElement MediaList MimeTypeArray NamedNodeMap NodeList PaintRequestList Plugin PluginArray SVGLengthList SVGNumberList SVGPathSegList SVGPointList SVGStringList SVGTransformList SourceBufferList StyleSheetList TextTrackCueList TextTrackList TouchList".split(" "),$g=0;$g<G1.length;$g++){var tv=G1[$g],ev=Yr[tv],rv=ev&&ev.prototype;rv&&!rv[H1]&&la(rv,H1,tv),bs[tv]=bs.Array}var Xl=function(t,r,i,s){if(!(t instanceof r)||s!==void 0&&s in t)throw TypeError(i+": incorrect invocation!");return t},ca=ht(function(t){var r={},i={};t=t.exports=function(s,f,c,d,p){p=p?function(){return s}:Qg(s),c=Cn(c,d,f?2:1),d=0;var A,S;if(typeof p!="function")throw TypeError(s+" is not iterable!");if(p===void 0||bs.Array!==p&&U1[qe]!==p){for(d=p.call(s);!(S=d.next()).done;)if(p=Jg(d,c,S.value,f),p===r||p===i)return p}else for(A=Md(s.length);A>d;d++)if(p=f?c(Pn(S=s[d])[0],S[1]):c(s[d]),p===r||p===i)return p},t.BREAK=r,t.RETURN=i}),Ci=Dn("species"),V1=function(t,r){t=Pn(t).constructor;var i;return t===void 0||(i=Pn(t)[Ci])==null?r:zs(i)},W1=function(t,r,i){var s=i===void 0;switch(r.length){case 0:return s?t():t.call(i);case 1:return s?t(r[0]):t.call(i,r[0]);case 2:return s?t(r[0],r[1]):t.call(i,r[0],r[1]);case 3:return s?t(r[0],r[1],r[2]):t.call(i,r[0],r[1],r[2]);case 4:return s?t(r[0],r[1],r[2],r[3]):t.call(i,r[0],r[1],r[2],r[3])}return t.apply(i,r)},j1=Yr.process,iv=Yr.setImmediate,X1=Yr.clearImmediate,fa=Yr.MessageChannel,Sd=Yr.Dispatch,nv=0,Vu={},pa=function(){var t=+this;if(Vu.hasOwnProperty(t)){var r=Vu[t];delete Vu[t],r()}},ov=function(t){pa.call(t.data)};if(!iv||!X1)if(iv=function(t){for(var r=[],i=1;arguments.length>i;)r.push(arguments[i++]);return Vu[++nv]=function(){W1(typeof t=="function"?t:Function(t),r)},tc(nv),nv},X1=function(t){delete Vu[t]},jl(j1)=="process")var tc=function(t){j1.nextTick(Cn(pa,t,1))};else if(Sd&&Sd.now)tc=function(t){Sd.now(Cn(pa,t,1))};else if(fa){var Id=new fa,Y1=Id.port2;Id.port1.onmessage=ov,tc=Cn(Y1.postMessage,Y1,1)}else Yr.addEventListener&&typeof postMessage=="function"&&!Yr.importScripts?(tc=function(t){Yr.postMessage(t+"","*")},Yr.addEventListener("message",ov,!1)):tc="onreadystatechange"in(Df?Wl.createElement("script"):{})?function(t){Ug.appendChild(Df?Wl.createElement("script"):{}).onreadystatechange=function(){Ug.removeChild(this),pa.call(t)}}:function(t){setTimeout(Cn(pa,t,1),0)};var Ed=iv,Uf=Yr.MutationObserver||Yr.WebKitMutationObserver,Wu=Yr.process,Yl=Yr.Promise,da=jl(Wu)=="process",Ld={f:function(t){return new bt(t)}},bf=function(t){try{return{e:!1,v:t()}}catch(r){return{e:!0,v:r}}},Z1=Yr.navigator,q1=Z1&&Z1.userAgent||"",sv=function(t,r){if(Pn(t),dn(r)&&r.constructor===t)return r;t=Ld.f(t);var i=t.resolve;return i(r),t.promise},Rd=function(t,r,i){for(var s in r)i&&t[s]?t[s]=r[s]:la(t,s,r[s]);return t},av=Dn("species"),Pd=function(t){t=typeof yi[t]=="function"?yi[t]:Yr[t],oo&&t&&!t[av]&&Ko.f(t,av,{configurable:!0,get:function(){return this}})},J1=function(){var t,r,i=function(){var p;for(da&&(p=Wu.domain)&&p.exit();t;){var A=t.fn;t=t.next;try{A()}catch(S){throw t?s():r=void 0,S}}r=void 0,p&&p.enter()};if(da)var s=function(){Wu.nextTick(i)};else if(!Uf||Yr.navigator&&Yr.navigator.standalone)if(Yl&&Yl.resolve){var f=Yl.resolve(void 0);s=function(){f.then(i)}}else s=function(){Ed.call(Yr,i)};else{var c=!0,d=document.createTextNode("");new Uf(i).observe(d,{characterData:!0}),s=function(){d.data=c=!c}}return function(p){p={fn:p,next:void 0},r&&(r.next=p),t||(t=p,s()),r=p}}(),Q1=Yr.TypeError,ju=Yr.process,Dd=ju&&ju.versions,FA=Dd&&Dd.v8||"",ma=Yr.Promise,kf=Ka(ju)=="process",Zl=function(){},Xu,Hf=Xu=Ld.f,Gf=!!function(){try{var t=ma.resolve(1),r=(t.constructor={})[Dn("species")]=function(i){i(Zl,Zl)};return(kf||typeof PromiseRejectionEvent=="function")&&t.then(Zl)instanceof r&&FA.indexOf("6.6")!==0&&q1.indexOf("Chrome/66")===-1}catch{}}(),K1=function(t){var r;return dn(t)&&typeof(r=t.then)=="function"?r:!1},Od=function(t,r){if(!t._n){t._n=!0;var i=t._c;J1(function(){for(var s=t._v,f=t._s==1,c=0;i.length>c;){var d=void 0,p=void 0,A=void 0,S=i[c++],z=f?S.ok:S.fail,w=S.resolve,I=S.reject,E=S.domain;try{z?(f||(t._h==2&&$1(t),t._h=1),z===!0?A=s:(E&&E.enter(),A=z(s),E&&(E.exit(),d=!0)),A===S.promise?I(Q1("Promise-chain cycle")):(p=K1(A))?p.call(A,w,I):w(A)):I(s)}catch(P){E&&!d&&E.exit(),I(P)}}t._c=[],t._n=!1,r&&!t._h&&uv(t)})}},uv=function(t){Ed.call(Yr,function(){var r=t._v,i=t._h!==1&&(t._a||t._c).length===0,s,f;if(i){var c=bf(function(){kf?ju.emit("unhandledRejection",r,t):(s=Yr.onunhandledrejection)?s({promise:t,reason:r}):(f=Yr.console)&&f.error&&f.error("Unhandled promise rejection",r)});t._h=kf||t._h!==1&&(t._a||t._c).length===0?2:1}if(t._a=void 0,i&&c.e)throw c.v})},$1=function(t){Ed.call(Yr,function(){var r;kf?ju.emit("rejectionHandled",t):(r=Yr.onrejectionhandled)&&r({promise:t,reason:t._v})})},ql=function(t){var r=this;r._d||(r._d=!0,r=r._w||r,r._v=t,r._s=2,r._a||(r._a=r._c.slice()),Od(r,!0))},Vf=function(t){var r=this,i;if(!r._d){r._d=!0,r=r._w||r;try{if(r===t)throw Q1("Promise can't be resolved itself");(i=K1(t))?J1(function(){var s={_w:r,_d:!1};try{i.call(t,Cn(Vf,s,1),Cn(ql,s,1))}catch(f){ql.call(s,f)}}):(r._v=t,r._s=1,Od(r,!1))}catch(s){ql.call({_w:r,_d:!1},s)}}};if(!Gf){ma=function(t){Xl(this,ma,"Promise","_h"),zs(t),Wf.call(this);try{t(Cn(Vf,this,1),Cn(ql,this,1))}catch(r){ql.call(this,r)}};var Wf=function(t){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1};Wf.prototype=Rd(ma.prototype,{then:function(t,r){var i=Hf(V1(this,ma));return i.ok=typeof t=="function"?t:!0,i.fail=typeof r=="function"&&r,i.domain=kf?ju.domain:void 0,this._c.push(i),this._a&&this._a.push(i),this._s&&Od(this,!1),i.promise},catch:function(t){return this.then(void 0,t)}});var jf=function(){var t=new Wf;this.promise=t,this.resolve=Cn(Vf,t,1),this.reject=Cn(ql,t,1)};Ld.f=Hf=function(t){return t===ma||t===ec?new jf(t):Xu(t)}}er(er.G+er.W+er.F*!Gf,{Promise:ma}),dr(ma,"Promise"),Pd("Promise");var ec=yi.Promise;er(er.S+er.F*!Gf,"Promise",{reject:function(t){var r=Hf(this),i=r.reject;return i(t),r.promise}}),er(er.S+1*er.F,"Promise",{resolve:function(t){return sv(this===ec?ma:this,t)}}),er(er.S+er.F*!(Gf&&k1(function(t){ma.all(t).catch(Zl)})),"Promise",{all:function(t){var r=this,i=Hf(r),s=i.resolve,f=i.reject,c=bf(function(){var d=[],p=0,A=1;ca(t,!1,function(S){var z=p++,w=!1;d.push(void 0),A++,r.resolve(S).then(function(I){w||(w=!0,d[z]=I,--A||s(d))},f)}),--A||s(d)});return c.e&&f(c.v),i.promise},race:function(t){var r=this,i=Hf(r),s=i.reject,f=bf(function(){ca(t,!1,function(c){r.resolve(c).then(i.resolve,s)})});return f.e&&s(f.v),i.promise}}),er(er.P+er.R,"Promise",{finally:function(t){var r=V1(this,yi.Promise||Yr.Promise),i=typeof t=="function";return this.then(i?function(s){return sv(r,t()).then(function(){return s})}:t,i?function(s){return sv(r,t()).then(function(){throw s})}:t)}}),er(er.S,"Promise",{try:function(t){var r=Ld.f(this);return t=bf(t),(t.e?r.reject:r.resolve)(t.v),r.promise}});var ty=yi.Promise,Xf=ht(function(t){t.exports={default:ty,__esModule:!0}}),di=ot(Xf),Yu=ht(function(t){var r=Bf("meta"),i=Ko.f,s=0,f=Object.isExtensible||function(){return!0},c=!wo(function(){return f(Object.preventExtensions({}))}),d=function(A){i(A,r,{value:{i:"O"+ ++s,w:{}}})},p=t.exports={KEY:r,NEED:!1,fastKey:function(A,S){if(!dn(A))return typeof A=="symbol"?A:(typeof A=="string"?"S":"P")+A;if(!zi(A,r)){if(!f(A))return"F";if(!S)return"E";d(A)}return A[r].i},getWeak:function(A,S){if(!zi(A,r)){if(!f(A))return!0;if(!S)return!1;d(A)}return A[r].w},onFreeze:function(A){return c&&p.NEED&&f(A)&&!zi(A,r)&&d(A),A}}}),rc=function(t,r){var i=(yi.Object||{})[t]||Object[t],s={};s[t]=r(i),er(er.S+er.F*wo(function(){i(1)}),"Object",s)},ey=Yu.onFreeze;rc("freeze",function(t){return function(r){return t&&dn(r)?t(ey(r)):r}});var lv=yi.Object.freeze,hv=ht(function(t){t.exports={default:lv,__esModule:!0}}),$a=ot(hv),ic={f:Dn},Fd=ic.f("iterator"),nc=ht(function(t){t.exports={default:Fd,__esModule:!0}});ot(nc);var BA=Ko.f,Yf=function(t){var r=yi.Symbol||(yi.Symbol={});t.charAt(0)=="_"||t in r||BA(r,t,{value:ic.f(t)})},Zf=Array.isArray||function(t){return jl(t)=="Array"},ry=Kh.concat("length","prototype"),cv=Object.getOwnPropertyNames||function(t){return zg(t,ry)},fv=cv,iy={}.toString,Jl=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],pv=function(t){if(Jl&&iy.call(t)=="[object Window]")try{var r=fv(t)}catch{r=Jl.slice()}else r=fv(Us(t));return r},ny=Object.getOwnPropertyDescriptor,$o={f:oo?ny:function(t,r){if(t=Us(t),r=Of(r,!0),L1)try{return ny(t,r)}catch{}if(zi(t,r))return Ns(!zf.call(t,r),t[r])}},qf=Yu.KEY,Jf=$o.f,Zu=Ko.f,oc=pv,so=Yr.Symbol,Qf=Yr.JSON,sc=Qf&&Qf.stringify,bo=Dn("_hidden"),oy=Dn("toPrimitive"),ac={}.propertyIsEnumerable,Ql=Ff("symbol-registry"),ks=Ff("symbols"),Kf=Ff("op-symbols"),ys=Object.prototype,uc=typeof so=="function",dv=Yr.QObject,ga=!dv||!dv.prototype||!dv.prototype.findChild,va=oo&&wo(function(){return gs(Zu({},"a",{get:function(){return Zu(this,"a",{value:7}).a}})).a!=7})?function(t,r,i){var s=Jf(ys,r);s&&delete ys[r],Zu(t,r,i),s&&t!==ys&&Zu(ys,r,s)}:Zu,sy=function(t){var r=ks[t]=gs(so.prototype);return r._k=t,r},Bd=uc&&typeof so.iterator=="symbol"?function(t){return typeof t=="symbol"}:function(t){return t instanceof so},qu=function(t,r,i){return t===ys&&qu(Kf,r,i),Pn(t),r=Of(r,!0),Pn(i),zi(ks,r)?(i.enumerable?(zi(t,bo)&&t[bo][r]&&(t[bo][r]=!1),i=gs(i,{enumerable:Ns(0,!1)})):(zi(t,bo)||Zu(t,bo,Ns(1,{})),t[bo][r]=!0),va(t,r,i)):Zu(t,r,i)},$f=function(t,r){Pn(t);var i=r=Us(r),s=ku(i),f=Gg;if(f){f=f(i);for(var c=zf,d=0,p;f.length>d;)c.call(i,p=f[d++])&&s.push(p)}i=0,p=s.length;for(var A;p>i;)qu(t,A=s[i++],r[A]);return t},mv=function(t){var r=ac.call(this,t=Of(t,!0));return this===ys&&zi(ks,t)&&!zi(Kf,t)?!1:r||!zi(this,t)||!zi(ks,t)||zi(this,bo)&&this[bo][t]?r:!0},ay=function(t,r){if(t=Us(t),r=Of(r,!0),t!==ys||!zi(ks,r)||zi(Kf,r)){var i=Jf(t,r);return!i||!zi(ks,r)||zi(t,bo)&&t[bo][r]||(i.enumerable=!0),i}},uy=function(t){t=oc(Us(t));for(var r=[],i=0,s;t.length>i;)zi(ks,s=t[i++])||s==bo||s==qf||r.push(s);return r},ly=function(t){var r=t===ys;t=oc(r?Kf:Us(t));for(var i=[],s=0,f;t.length>s;)zi(ks,f=t[s++])&&(r?zi(ys,f):1)&&i.push(ks[f]);return i};uc||(so=function(){if(this instanceof so)throw TypeError("Symbol is not a constructor!");var t=Bf(0<arguments.length?arguments[0]:void 0),r=function(i){this===ys&&r.call(Kf,i),zi(this,bo)&&zi(this[bo],t)&&(this[bo][t]=!1),va(this,t,Ns(1,i))};return oo&&ga&&va(ys,t,{configurable:!0,set:r}),sy(t)},la(so.prototype,"toString",function(){return this._k}),$o.f=ay,Ko.f=qu,cv=pv=uy,zf=mv,Gg=ly,ic.f=function(t){return sy(Dn(t))}),er(er.G+er.W+er.F*!uc,{Symbol:so});for(var hy="hasInstance isConcatSpreadable iterator match replace search species split toPrimitive toStringTag unscopables".split(" "),cy=0;hy.length>cy;)Dn(hy[cy++]);for(var fy=ku(Dn.store),tu=0;fy.length>tu;)Yf(fy[tu++]);er(er.S+er.F*!uc,"Symbol",{for:function(t){return zi(Ql,t+="")?Ql[t]:Ql[t]=so(t)},keyFor:function(t){if(!Bd(t))throw TypeError(t+" is not a symbol!");for(var r in Ql)if(Ql[r]===t)return r},useSetter:function(){ga=!0},useSimple:function(){ga=!1}}),er(er.S+er.F*!uc,"Object",{create:function(t,r){return r===void 0?gs(t):$f(gs(t),r)},defineProperty:qu,defineProperties:$f,getOwnPropertyDescriptor:ay,getOwnPropertyNames:uy,getOwnPropertySymbols:ly}),Qf&&er(er.S+er.F*(!uc||wo(function(){var t=so();return sc([t])!="[null]"||sc({a:t})!="{}"||sc(Object(t))!="{}"})),"JSON",{stringify:function(t){for(var r=[t],i=1,s;arguments.length>i;)r.push(arguments[i++]);if(s=i=r[1],(dn(i)||t!==void 0)&&!Bd(t))return Zf(i)||(i=function(f,c){if(typeof s=="function"&&(c=s.call(this,f,c)),!Bd(c))return c}),r[1]=i,sc.apply(Qf,r)}}),so.prototype[oy]||la(so.prototype,oy,so.prototype.valueOf),dr(so,"Symbol"),dr(Math,"Math",!0),dr(Yr.JSON,"JSON",!0),Yf("asyncIterator"),Yf("observable");var zA=yi.Symbol,ya=ht(function(t){t.exports={default:zA,__esModule:!0}});ot(ya);var xa=ht(function(t,r){r.__esModule=!0,t=nc&&nc.__esModule?nc:{default:nc};var i=ya&&ya.__esModule?ya:{default:ya},s=typeof i.default=="function"&&typeof t.default=="symbol"?function(f){return typeof f}:function(f){return f&&typeof i.default=="function"&&f.constructor===i.default&&f!==i.default.prototype?"symbol":typeof f};r.default=typeof i.default=="function"&&s(t.default)==="symbol"?function(f){return typeof f=="undefined"?"undefined":s(f)}:function(f){return f&&typeof i.default=="function"&&f.constructor===i.default&&f!==i.default.prototype?"symbol":typeof f=="undefined"?"undefined":s(f)}}),ts=ot(xa),es=function(t,r){if(!dn(t)||t._t!==r)throw TypeError("Incompatible receiver, "+r+" required!");return t},NA=Ko.f,Ju=Yu.fastKey,tp=oo?"_s":"size",zd=function(t,r){var i=Ju(r);if(i!=="F")return t._i[i];for(t=t._f;t;t=t.n)if(t.k==r)return t},gv={getConstructor:function(t,r,i,s){var f=t(function(c,d){Xl(c,f,r,"_i"),c._t=r,c._i=gs(null),c._f=void 0,c._l=void 0,c[tp]=0,d!=null&&ca(d,i,c[s],c)});return Rd(f.prototype,{clear:function(){for(var c=es(this,r),d=c._i,p=c._f;p;p=p.n)p.r=!0,p.p&&(p.p=p.p.n=void 0),delete d[p.i];c._f=c._l=void 0,c[tp]=0},delete:function(c){var d=es(this,r);if(c=zd(d,c)){var p=c.n,A=c.p;delete d._i[c.i],c.r=!0,A&&(A.n=p),p&&(p.p=A),d._f==c&&(d._f=p),d._l==c&&(d._l=A),d[tp]--}return!!c},forEach:function(c){es(this,r);for(var d=Cn(c,1<arguments.length?arguments[1]:void 0,3),p;p=p?p.n:this._f;)for(d(p.v,p.k,this);p&&p.r;)p=p.p},has:function(c){return!!zd(es(this,r),c)}}),oo&&NA(f.prototype,"size",{get:function(){return es(this,r)[tp]}}),f},def:function(t,r,i){var s=zd(t,r),f;return s?s.v=i:(t._l=s={i:f=Ju(r,!0),k:r,v:i,p:r=t._l,n:void 0,r:!1},t._f||(t._f=s),r&&(r.n=s),t[tp]++,f!=="F"&&(t._i[f]=s)),t},getEntry:zd,setStrong:function(t,r,i){jr(t,r,function(s,f){this._t=es(s,r),this._k=f,this._l=void 0},function(){for(var s=this._k,f=this._l;f&&f.r;)f=f.p;return this._t&&(this._l=f=f?f.n:this._t._f)?s=="keys"?Gu(0,f.k):s=="values"?Gu(0,f.v):Gu(0,[f.k,f.v]):(this._t=void 0,Gu(1))},i?"entries":"values",!i,!0),Pd(r)}},UA=Dn("species"),bA=function(t,r){if(Zf(t)){var i=t.constructor;typeof i!="function"||i!==Array&&!Zf(i.prototype)||(i=void 0),dn(i)&&(i=i[UA],i===null&&(i=void 0))}return new(i===void 0?Array:i)(r)},ep=function(t,r){var i=t==1,s=t==2,f=t==3,c=t==4,d=t==6,p=t==5||d,A=r||bA;return function(S,z,w){var I=Object(ds(S)),E=Fg(I);z=Cn(z,w,3),w=Md(E.length);var P=0;S=i?A(S,w):s?A(S,0):void 0;for(var F,X;w>P;P++)if((p||P in E)&&(F=E[P],X=z(F,P,I),t)){if(i)S[P]=X;else if(X)switch(t){case 3:return!0;case 5:return F;case 6:return P;case 2:S.push(F)}else if(c)return!1}return d?-1:f||c?c:S}},kA=Ko.f,rp=ep(0),py=function(t,r,i,s,f,c){var d=Yr[t],p=d,A=f?"set":"add",S=p&&p.prototype,z={};return oo&&typeof p=="function"&&(c||S.forEach&&!wo(function(){new p().entries().next()}))?(p=r(function(w,I){Xl(w,p,t,"_c"),w._c=new d,I!=null&&ca(I,f,w[A],w)}),rp("add clear delete forEach get has set keys values entries toJSON".split(" "),function(w){var I=w=="add"||w=="set";w in S&&(!c||w!="clear")&&la(p.prototype,w,function(E,P){return Xl(this,p,w),!I&&c&&!dn(E)?w=="get"?void 0:!1:(E=this._c[w](E===0?0:E,P),I?this:E)})}),c||kA(p.prototype,"size",{get:function(){return this._c.size}})):(p=s.getConstructor(r,t,f,A),Rd(p.prototype,i),Yu.NEED=!0),dr(p,t),z[t]=p,er(er.G+er.W+er.F,z),c||s.setStrong(p,t,f),p};py("Map",function(t){return function(){return t(this,0<arguments.length?arguments[0]:void 0)}},{get:function(t){return(t=gv.getEntry(es(this,"Map"),t))&&t.v},set:function(t,r){return gv.def(es(this,"Map"),t===0?0:t,r)}},gv,!0),er(er.P+er.R,"Map",{toJSON:function(t){return function(){if(Ka(this)!=t)throw TypeError(t+"#toJSON isn't generic");var r=[];return ca(this,!1,r.push,r,void 0),r}}("Map")});var dy=function(t){er(er.S,t,{of:function(){for(var r=arguments.length,i=Array(r);r--;)i[r]=arguments[r];return new this(i)}})};dy("Map");var my=function(t){er(er.S,t,{from:function(r,i,s){var f;if(zs(this),(f=i!==void 0)&&zs(i),r==null)return new this;var c=[];if(f){var d=0,p=Cn(i,s,2);ca(r,!1,function(A){c.push(p(A,d++))})}else ca(r,!1,c.push,c);return new this(c)}})};my("Map");var gy=yi.Map,HA=ht(function(t){t.exports={default:gy,__esModule:!0}}),vv=ot(HA);er(er.S+er.F*!oo,"Object",{defineProperty:Ko.f});var GA=yi.Object,vy=function(t,r,i){return GA.defineProperty(t,r,i)},eu=ht(function(t){t.exports={default:vy,__esModule:!0}}),On=ot(eu),VA=ht(function(t,r){r.__esModule=!0;var i=eu&&eu.__esModule?eu:{default:eu};r.default=function(s,f,c){return f in s?(0,i.default)(s,f,{value:c,enumerable:!0,configurable:!0,writable:!0}):s[f]=c,s}}),Si=ot(VA),yv=Yu.getWeak,WA=ep(5),jA=ep(6),sn=0,ip=function(t){return t._l||(t._l=new xs)},xs=function(){this.a=[]},xv=function(t,r){return WA(t.a,function(i){return i[0]===r})};xs.prototype={get:function(t){if(t=xv(this,t))return t[1]},has:function(t){return!!xv(this,t)},set:function(t,r){var i=xv(this,t);i?i[1]=r:this.a.push([t,r])},delete:function(t){var r=jA(this.a,function(i){return i[0]===t});return~r&&this.a.splice(r,1),!!~r}};var As={getConstructor:function(t,r,i,s){var f=t(function(c,d){Xl(c,f,r,"_i"),c._t=r,c._i=sn++,c._l=void 0,d!=null&&ca(d,i,c[s],c)});return Rd(f.prototype,{delete:function(c){if(!dn(c))return!1;var d=yv(c);return d===!0?ip(es(this,r)).delete(c):d&&zi(d,this._i)&&delete d[this._i]},has:function(c){if(!dn(c))return!1;var d=yv(c);return d===!0?ip(es(this,r)).has(c):d&&zi(d,this._i)}}),f},def:function(t,r,i){var s=yv(Pn(r),!0);return s===!0?ip(t).set(r,i):s[t._i]=i,t},ufstore:ip};ht(function(t){var r=ep(0),i=!Yr.ActiveXObject&&"ActiveXObject"in Yr,s=Yu.getWeak,f=Object.isExtensible,c=As.ufstore,d=function(z){return function(){return z(this,0<arguments.length?arguments[0]:void 0)}},p={get:function(z){if(dn(z)){var w=s(z);return w===!0?c(es(this,"WeakMap")).get(z):w?w[this._i]:void 0}},set:function(z,w){return As.def(es(this,"WeakMap"),z,w)}},A=t.exports=py("WeakMap",d,p,As,!0,!0);if(es&&i){var S=As.getConstructor(d,"WeakMap");Vg(S.prototype,p),Yu.NEED=!0,r(["delete","has","get","set"],function(z){var w=A.prototype,I=w[z];la(w,z,function(E,P){return dn(E)&&!f(E)?(this._f||(this._f=new S),E=this._f[z](E,P),z=="set"?this:E):I.call(this,E,P)})})}}),dy("WeakMap"),my("WeakMap");var yy=yi.WeakMap,Av=ht(function(t){t.exports={default:yy,__esModule:!0}}),ki=ot(Av);rc("getPrototypeOf",function(){return function(t){return N1(Object(ds(t)))}});var lc=yi.Object.getPrototypeOf,xy=ht(function(t){t.exports={default:lc,__esModule:!0}}),Wn=ot(xy),XA=ht(function(t,r){r.__esModule=!0,r.default=function(i,s){if(!(i instanceof s))throw new TypeError("Cannot call a class as a function")}}),Ai=ot(XA),Ay=ht(function(t,r){r.__esModule=!0;var i=xa&&xa.__esModule?xa:{default:xa};r.default=function(s,f){if(!s)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!f||(typeof f=="undefined"?"undefined":(0,i.default)(f))!=="object"&&typeof f!="function"?s:f}}),Tn=ot(Ay),_y=Object.setPrototypeOf||("__proto__"in{}?function(t,r,i){try{i=Cn(Function.call,$o.f(Object.prototype,"__proto__").set,2),i(t,[]),r=!(t instanceof Array)}catch{r=!0}return function(s,f){if(Pn(s),!dn(f)&&f!==null)throw TypeError(f+": can't set as prototype!");return r?s.__proto__=f:i(s,f),s}}({},!1):void 0);er(er.S,"Object",{setPrototypeOf:_y});var YA=yi.Object.setPrototypeOf,wy=ht(function(t){t.exports={default:YA,__esModule:!0}});ot(wy);var ZA=ht(function(t,r){function i(d){return d&&d.__esModule?d:{default:d}}r.__esModule=!0;var s=i(wy),f=i(B1),c=i(xa);r.default=function(d,p){if(typeof p!="function"&&p!==null)throw new TypeError("Super expression must either be null or a function, not "+(typeof p=="undefined"?"undefined":(0,c.default)(p)));d.prototype=(0,f.default)(p&&p.prototype,{constructor:{value:d,enumerable:!1,writable:!0,configurable:!0}}),p&&(s.default?(0,s.default)(d,p):d.__proto__=p)}}),jn=ot(ZA);rc("keys",function(){return function(t){return ku(Object(ds(t)))}});var qA=yi.Object.keys,JA=ht(function(t){t.exports={default:qA,__esModule:!0}}),Ti=ot(JA),_v=yi.JSON||(yi.JSON={stringify:JSON.stringify}),My=function(t){return _v.stringify.apply(_v,arguments)},Cy=ht(function(t){t.exports={default:My,__esModule:!0}}),Hs=ot(Cy);er(er.S+er.F*!oo,"Object",{defineProperties:Ng});var QA=yi.Object,hc=function(t,r){return QA.defineProperties(t,r)},wv=ht(function(t){t.exports={default:hc,__esModule:!0}}),Or=ot(wv);er(er.S,"Math",{sign:Math.sign||function(t){return(t=+t)==0||t!=t?t:0>t?-1:1}});var cc=yi.Math.sign,KA=ht(function(t){t.exports={default:cc,__esModule:!0}}),Qu=ot(KA),$A=Math.floor;er(er.S,"Number",{isInteger:function(t){return!dn(t)&&isFinite(t)&&$A(t)===t}});var t_=yi.Number.isInteger,e_=ht(function(t){t.exports={default:t_,__esModule:!0}}),fc=ot(e_);er(er.S,"Number",{EPSILON:Math.pow(2,-52)});var r_=Math.pow(2,-52),i_=ht(function(t){t.exports={default:r_,__esModule:!0}}),an=ot(i_);an===void 0&&(Number.EPSILON=Math.pow(2,-52)),fc===void 0&&(Number.isInteger=function(t){return typeof t=="number"&&isFinite(t)&&Math.floor(t)===t}),Qu===void 0&&(Math.sign=function(t){return 0>t?-1:0<t?1:+t}),!("name"in Function.prototype)&&Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*([^\(\s]*)/)[1]}}),pt===void 0&&(Object.assign=function(t){if(t==null)throw new TypeError("Cannot convert undefined or null to object");for(var r=Object(t),i=1;i<arguments.length;i++){var s=arguments[i];if(s!=null)for(var f in s)Object.prototype.hasOwnProperty.call(s,f)&&(r[f]=s[f])}return r}),pt(se.prototype,{addEventListener:function(t,r){this._listeners===void 0&&(this._listeners={});var i=this._listeners;i[t]===void 0&&(i[t]=[]),i[t].indexOf(r)===-1&&i[t].push(r)},hasEventListener:function(t,r){if(this._listeners===void 0)return!1;var i=this._listeners;return i[t]!==void 0&&i[t].indexOf(r)!==-1},removeEventListener:function(t,r){this._listeners!==void 0&&(t=this._listeners[t],t!==void 0&&(r=t.indexOf(r),r!==-1&&t.splice(r,1)))},dispatchEvent:function(t){if(this._listeners!==void 0){var r=this._listeners[t.type];if(r!==void 0){t.target=this,r=r.slice(0);for(var i=0,s=r.length;i<s;i++)r[i].call(this,t)}}}});for(var ao=[],np=0;256>np;np++)ao[np]=(16>np?"0":"")+np.toString(16);var ti={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){var t=4294967295*Math.random()|0,r=4294967295*Math.random()|0,i=4294967295*Math.random()|0,s=4294967295*Math.random()|0;return(ao[t&255]+ao[t>>8&255]+ao[t>>16&255]+ao[t>>24&255]+"-"+ao[r&255]+ao[r>>8&255]+"-"+ao[r>>16&15|64]+ao[r>>24&255]+"-"+ao[i&63|128]+ao[i>>8&255]+"-"+ao[i>>16&255]+ao[i>>24&255]+ao[s&255]+ao[s>>8&255]+ao[s>>16&255]+ao[s>>24&255]).toUpperCase()},clamp:function(t,r,i){return Math.max(r,Math.min(i,t))},euclideanModulo:function(t,r){return(t%r+r)%r},mapLinear:function(t,r,i,s,f){return s+(t-r)*(f-s)/(i-r)},lerp:function(t,r,i){return(1-i)*t+i*r},smoothstep:function(t,r,i){return t<=r?0:t>=i?1:(t=(t-r)/(i-r),t*t*(3-2*t))},smootherstep:function(t,r,i){return t<=r?0:t>=i?1:(t=(t-r)/(i-r),t*t*t*(t*(6*t-15)+10))},randInt:function(t,r){return t+Math.floor(Math.random()*(r-t+1))},randFloat:function(t,r){return t+Math.random()*(r-t)},randFloatSpread:function(t){return t*(.5-Math.random())},degToRad:function(t){return t*ti.DEG2RAD},radToDeg:function(t){return t*ti.RAD2DEG},isPowerOfTwo:function(t){return(t&t-1)===0&&t!==0},ceilPowerOfTwo:function(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))},floorPowerOfTwo:function(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))},setQuaternionFromProperEuler:function(t,r,i,s,f){var c=Math.cos,d=Math.sin,p=c(i/2);i=d(i/2);var A=c((r+s)/2),S=d((r+s)/2),z=c((r-s)/2),w=d((r-s)/2);switch(c=c((s-r)/2),r=d((s-r)/2),f){case"XYX":t.set(p*S,i*z,i*w,p*A);break;case"YZY":t.set(i*w,p*S,i*z,p*A);break;case"ZXZ":t.set(i*z,i*w,p*S,p*A);break;case"XZX":t.set(p*S,i*r,i*c,p*A);break;case"YXY":t.set(i*c,p*S,i*r,p*A);break;case"ZYZ":t.set(i*r,i*c,p*S,p*A);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+f)}}};Or(Ot.prototype,{width:{get:function(){return this.x},set:function(t){this.x=t}},height:{get:function(){return this.y},set:function(t){this.y=t}}}),pt(Ot.prototype,{isVector2:!0,set:function(t,r){return this.x=t,this.y=r,this},setScalar:function(t){return this.y=this.x=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setComponent:function(t,r){switch(t){case 0:this.x=r;break;case 1:this.y=r;break;default:throw Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(t){return this.x=t.x,this.y=t.y,this},add:function(t,r){return r!==void 0?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,r)):(this.x+=t.x,this.y+=t.y,this)},addScalar:function(t){return this.x+=t,this.y+=t,this},addVectors:function(t,r){return this.x=t.x+r.x,this.y=t.y+r.y,this},addScaledVector:function(t,r){return this.x+=t.x*r,this.y+=t.y*r,this},sub:function(t,r){return r!==void 0?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,r)):(this.x-=t.x,this.y-=t.y,this)},subScalar:function(t){return this.x-=t,this.y-=t,this},subVectors:function(t,r){return this.x=t.x-r.x,this.y=t.y-r.y,this},multiply:function(t){return this.x*=t.x,this.y*=t.y,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this},divide:function(t){return this.x/=t.x,this.y/=t.y,this},divideScalar:function(t){return this.multiplyScalar(1/t)},applyMatrix3:function(t){var r=this.x,i=this.y;return t=t.elements,this.x=t[0]*r+t[3]*i+t[6],this.y=t[1]*r+t[4]*i+t[7],this},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this},clamp:function(t,r){return this.x=Math.max(t.x,Math.min(r.x,this.x)),this.y=Math.max(t.y,Math.min(r.y,this.y)),this},clampScalar:function(t,r){return this.x=Math.max(t,Math.min(r,this.x)),this.y=Math.max(t,Math.min(r,this.y)),this},clampLength:function(t,r){var i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(t,Math.min(r,i)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x),this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(t){return this.x*t.x+this.y*t.y},cross:function(t){return this.x*t.y-this.y*t.x},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length()||1)},angle:function(){return Math.atan2(-this.y,-this.x)+Math.PI},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var r=this.x-t.x;return t=this.y-t.y,r*r+t*t},manhattanDistanceTo:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,r){return this.x+=(t.x-this.x)*r,this.y+=(t.y-this.y)*r,this},lerpVectors:function(t,r,i){return this.x=t.x+(r.x-t.x)*i,this.y=t.y+(r.y-t.y)*i,this},equals:function(t){return t.x===this.x&&t.y===this.y},fromArray:function(t,r){return r===void 0&&(r=0),this.x=t[r],this.y=t[r+1],this},toArray:function(t,r){return t===void 0&&(t=[]),r===void 0&&(r=0),t[r]=this.x,t[r+1]=this.y,t},fromBufferAttribute:function(t,r,i){return i!==void 0&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(r),this.y=t.getY(r),this},rotateAround:function(t,r){var i=Math.cos(r);r=Math.sin(r);var s=this.x-t.x,f=this.y-t.y;return this.x=s*i-f*r+t.x,this.y=s*r+f*i+t.y,this},random:function(){return this.x=Math.random(),this.y=Math.random(),this}}),pt(Jt.prototype,{isMatrix3:!0,set:function(t,r,i,s,f,c,d,p,A){var S=this.elements;return S[0]=t,S[1]=s,S[2]=d,S[3]=r,S[4]=f,S[5]=p,S[6]=i,S[7]=c,S[8]=A,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return new this.constructor().fromArray(this.elements)},copy:function(t){var r=this.elements;return t=t.elements,r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r[4]=t[4],r[5]=t[5],r[6]=t[6],r[7]=t[7],r[8]=t[8],this},extractBasis:function(t,r,i){return t.setFromMatrix3Column(this,0),r.setFromMatrix3Column(this,1),i.setFromMatrix3Column(this,2),this},setFromMatrix4:function(t){return t=t.elements,this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this},multiply:function(t){return this.multiplyMatrices(this,t)},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,r){var i=t.elements,s=r.elements;r=this.elements,t=i[0];var f=i[3],c=i[6],d=i[1],p=i[4],A=i[7],S=i[2],z=i[5];i=i[8];var w=s[0],I=s[3],E=s[6],P=s[1],F=s[4],X=s[7],q=s[2],J=s[5];return s=s[8],r[0]=t*w+f*P+c*q,r[3]=t*I+f*F+c*J,r[6]=t*E+f*X+c*s,r[1]=d*w+p*P+A*q,r[4]=d*I+p*F+A*J,r[7]=d*E+p*X+A*s,r[2]=S*w+z*P+i*q,r[5]=S*I+z*F+i*J,r[8]=S*E+z*X+i*s,this},multiplyScalar:function(t){var r=this.elements;return r[0]*=t,r[3]*=t,r[6]*=t,r[1]*=t,r[4]*=t,r[7]*=t,r[2]*=t,r[5]*=t,r[8]*=t,this},determinant:function(){var t=this.elements,r=t[0],i=t[1],s=t[2],f=t[3],c=t[4],d=t[5],p=t[6],A=t[7];return t=t[8],r*c*t-r*d*A-i*f*t+i*d*p+s*f*A-s*c*p},getInverse:function(t,r){r!==void 0&&console.warn("THREE.Matrix3: .getInverse() can no longer be configured to throw on degenerate.");var i=t.elements;t=this.elements,r=i[0];var s=i[1],f=i[2],c=i[3],d=i[4],p=i[5],A=i[6],S=i[7];i=i[8];var z=i*d-p*S,w=p*A-i*c,I=S*c-d*A,E=r*z+s*w+f*I;return E===0?this.set(0,0,0,0,0,0,0,0,0):(E=1/E,t[0]=z*E,t[1]=(f*S-i*s)*E,t[2]=(p*s-f*d)*E,t[3]=w*E,t[4]=(i*r-f*A)*E,t[5]=(f*c-p*r)*E,t[6]=I*E,t[7]=(s*A-S*r)*E,t[8]=(d*r-s*c)*E,this)},transpose:function(){var t=this.elements,r=t[1];return t[1]=t[3],t[3]=r,r=t[2],t[2]=t[6],t[6]=r,r=t[5],t[5]=t[7],t[7]=r,this},getNormalMatrix:function(t){return this.setFromMatrix4(t).getInverse(this).transpose()},transposeIntoArray:function(t){var r=this.elements;return t[0]=r[0],t[1]=r[3],t[2]=r[6],t[3]=r[1],t[4]=r[4],t[5]=r[7],t[6]=r[2],t[7]=r[5],t[8]=r[8],this},setUvTransform:function(t,r,i,s,f,c,d){var p=Math.cos(f);f=Math.sin(f),this.set(i*p,i*f,-i*(p*c+f*d)+c+t,-s*f,s*p,-s*(-f*c+p*d)+d+r,0,0,1)},scale:function(t,r){var i=this.elements;return i[0]*=t,i[3]*=t,i[6]*=t,i[1]*=r,i[4]*=r,i[7]*=r,this},rotate:function(t){var r=Math.cos(t);t=Math.sin(t);var i=this.elements,s=i[0],f=i[3],c=i[6],d=i[1],p=i[4],A=i[7];return i[0]=r*s+t*d,i[3]=r*f+t*p,i[6]=r*c+t*A,i[1]=-t*s+r*d,i[4]=-t*f+r*p,i[7]=-t*c+r*A,this},translate:function(t,r){var i=this.elements;return i[0]+=t*i[2],i[3]+=t*i[5],i[6]+=t*i[8],i[1]+=r*i[2],i[4]+=r*i[5],i[7]+=r*i[8],this},equals:function(t){var r=this.elements;t=t.elements;for(var i=0;9>i;i++)if(r[i]!==t[i])return!1;return!0},fromArray:function(t,r){r===void 0&&(r=0);for(var i=0;9>i;i++)this.elements[i]=t[i+r];return this},toArray:function(t,r){t===void 0&&(t=[]),r===void 0&&(r=0);var i=this.elements;return t[r]=i[0],t[r+1]=i[1],t[r+2]=i[2],t[r+3]=i[3],t[r+4]=i[4],t[r+5]=i[5],t[r+6]=i[6],t[r+7]=i[7],t[r+8]=i[8],t}});var l,h={getDataURL:function(t){if(typeof HTMLCanvasElement=="undefined")return t.src;if(!(t instanceof HTMLCanvasElement)){l===void 0&&(l=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")),l.width=t.width,l.height=t.height;var r=l.getContext("2d");t instanceof ImageData?r.putImageData(t,0,0):r.drawImage(t,0,0,t.width,t.height),t=l}return 2048<t.width||2048<t.height?t.toDataURL("image/jpeg",.6):t.toDataURL("image/png")}},o=0;le.DEFAULT_IMAGE=void 0,le.DEFAULT_MAPPING=300,le.prototype=pt(ft(se.prototype),{constructor:le,isTexture:!0,updateMatrix:function(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)},clone:function(){return new this.constructor().copy(this)},copy:function(t){return this.name=t.name,this.image=t.image,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.encoding=t.encoding,this},toJSON:function(t){var r=t===void 0||typeof t=="string";if(!r&&t.textures[this.uuid]!==void 0)return t.textures[this.uuid];var i={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(this.image!==void 0){var s=this.image;if(s.uuid===void 0&&(s.uuid=ti.generateUUID()),!r&&t.images[s.uuid]===void 0){if(Array.isArray(s))for(var f=[],c=0,d=s.length;c<d;c++)f.push(h.getDataURL(s[c]));else f=h.getDataURL(s);t.images[s.uuid]={uuid:s.uuid,url:f}}i.image=s.uuid}return r||(t.textures[this.uuid]=i),i},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(t){if(this.mapping!==300)return t;if(t.applyMatrix3(this.matrix),0>t.x||1<t.x)switch(this.wrapS){case 1e3:t.x-=Math.floor(t.x);break;case 1001:t.x=0>t.x?0:1;break;case 1002:t.x=Math.abs(Math.floor(t.x)%2)===1?Math.ceil(t.x)-t.x:t.x-Math.floor(t.x)}if(0>t.y||1<t.y)switch(this.wrapT){case 1e3:t.y-=Math.floor(t.y);break;case 1001:t.y=0>t.y?0:1;break;case 1002:t.y=Math.abs(Math.floor(t.y)%2)===1?Math.ceil(t.y)-t.y:t.y-Math.floor(t.y)}return this.flipY&&(t.y=1-t.y),t}}),Object.defineProperty(le.prototype,"needsUpdate",{set:function(t){t===!0&&this.version++}}),Or(jt.prototype,{width:{get:function(){return this.z},set:function(t){this.z=t}},height:{get:function(){return this.w},set:function(t){this.w=t}}}),pt(jt.prototype,{isVector4:!0,set:function(t,r,i,s){return this.x=t,this.y=r,this.z=i,this.w=s,this},setScalar:function(t){return this.w=this.z=this.y=this.x=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setW:function(t){return this.w=t,this},setComponent:function(t,r){switch(t){case 0:this.x=r;break;case 1:this.y=r;break;case 2:this.z=r;break;case 3:this.w=r;break;default:throw Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w!==void 0?t.w:1,this},add:function(t,r){return r!==void 0?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,r)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this},addVectors:function(t,r){return this.x=t.x+r.x,this.y=t.y+r.y,this.z=t.z+r.z,this.w=t.w+r.w,this},addScaledVector:function(t,r){return this.x+=t.x*r,this.y+=t.y*r,this.z+=t.z*r,this.w+=t.w*r,this},sub:function(t,r){return r!==void 0?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,r)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this},subVectors:function(t,r){return this.x=t.x-r.x,this.y=t.y-r.y,this.z=t.z-r.z,this.w=t.w-r.w,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this},applyMatrix4:function(t){var r=this.x,i=this.y,s=this.z,f=this.w;return t=t.elements,this.x=t[0]*r+t[4]*i+t[8]*s+t[12]*f,this.y=t[1]*r+t[5]*i+t[9]*s+t[13]*f,this.z=t[2]*r+t[6]*i+t[10]*s+t[14]*f,this.w=t[3]*r+t[7]*i+t[11]*s+t[15]*f,this},divideScalar:function(t){return this.multiplyScalar(1/t)},setAxisAngleFromQuaternion:function(t){this.w=2*Math.acos(t.w);var r=Math.sqrt(1-t.w*t.w);return 1e-4>r?(this.x=1,this.z=this.y=0):(this.x=t.x/r,this.y=t.y/r,this.z=t.z/r),this},setAxisAngleFromRotationMatrix:function(t){t=t.elements;var r=t[0],i=t[4],s=t[8],f=t[1],c=t[5],d=t[9],p=t[2],A=t[6],S=t[10];return .01>Math.abs(i-f)&&.01>Math.abs(s-p)&&.01>Math.abs(d-A)?.1>Math.abs(i+f)&&.1>Math.abs(s+p)&&.1>Math.abs(d+A)&&.1>Math.abs(r+c+S-3)?(this.set(1,0,0,0),this):(t=Math.PI,r=(r+1)/2,c=(c+1)/2,S=(S+1)/2,i=(i+f)/4,s=(s+p)/4,d=(d+A)/4,r>c&&r>S?.01>r?(A=0,i=p=.707106781):(A=Math.sqrt(r),p=i/A,i=s/A):c>S?.01>c?(A=.707106781,p=0,i=.707106781):(p=Math.sqrt(c),A=i/p,i=d/p):.01>S?(p=A=.707106781,i=0):(i=Math.sqrt(S),A=s/i,p=d/i),this.set(A,p,i,t),this):(t=Math.sqrt((A-d)*(A-d)+(s-p)*(s-p)+(f-i)*(f-i)),.001>Math.abs(t)&&(t=1),this.x=(A-d)/t,this.y=(s-p)/t,this.z=(f-i)/t,this.w=Math.acos((r+c+S-1)/2),this)},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this},clamp:function(t,r){return this.x=Math.max(t.x,Math.min(r.x,this.x)),this.y=Math.max(t.y,Math.min(r.y,this.y)),this.z=Math.max(t.z,Math.min(r.z,this.z)),this.w=Math.max(t.w,Math.min(r.w,this.w)),this},clampScalar:function(t,r){return this.x=Math.max(t,Math.min(r,this.x)),this.y=Math.max(t,Math.min(r,this.y)),this.z=Math.max(t,Math.min(r,this.z)),this.w=Math.max(t,Math.min(r,this.w)),this},clampLength:function(t,r){var i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(t,Math.min(r,i)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x),this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y),this.z=0>this.z?Math.ceil(this.z):Math.floor(this.z),this.w=0>this.w?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,r){return this.x+=(t.x-this.x)*r,this.y+=(t.y-this.y)*r,this.z+=(t.z-this.z)*r,this.w+=(t.w-this.w)*r,this},lerpVectors:function(t,r,i){return this.x=t.x+(r.x-t.x)*i,this.y=t.y+(r.y-t.y)*i,this.z=t.z+(r.z-t.z)*i,this.w=t.w+(r.w-t.w)*i,this},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w},fromArray:function(t,r){return r===void 0&&(r=0),this.x=t[r],this.y=t[r+1],this.z=t[r+2],this.w=t[r+3],this},toArray:function(t,r){return t===void 0&&(t=[]),r===void 0&&(r=0),t[r]=this.x,t[r+1]=this.y,t[r+2]=this.z,t[r+3]=this.w,t},fromBufferAttribute:function(t,r,i){return i!==void 0&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(r),this.y=t.getY(r),this.z=t.getZ(r),this.w=t.getW(r),this},random:function(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}}),pe.prototype=pt(ft(se.prototype),{constructor:pe,isWebGLRenderTarget:!0,setSize:function(t,r){(this.width!==t||this.height!==r)&&(this.width=t,this.height=r,this.texture.image.width=t,this.texture.image.height=r,this.dispose()),this.viewport.set(0,0,t,r),this.scissor.set(0,0,t,r)},clone:function(){return new this.constructor().copy(this)},copy:function(t){return this.width=t.width,this.height=t.height,this.viewport.copy(t.viewport),this.texture=t.texture.clone(),this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,this.depthTexture=t.depthTexture,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),He.prototype=pt(ft(pe.prototype),{constructor:He,isWebGLMultisampleRenderTarget:!0,copy:function(t){return pe.prototype.copy.call(this,t),this.samples=t.samples,this}}),pt(ye,{slerp:function(t,r,i,s){return i.copy(t).slerp(r,s)},slerpFlat:function(t,r,i,s,f,c,d){var p=i[s+0],A=i[s+1],S=i[s+2];i=i[s+3],s=f[c+0];var z=f[c+1],w=f[c+2];if(f=f[c+3],i!==f||p!==s||A!==z||S!==w){c=1-d;var I=p*s+A*z+S*w+i*f,E=0<=I?1:-1,P=1-I*I;P>an&&(P=Math.sqrt(P),I=Math.atan2(P,I*E),c=Math.sin(c*I)/P,d=Math.sin(d*I)/P),E*=d,p=p*c+s*E,A=A*c+z*E,S=S*c+w*E,i=i*c+f*E,c===1-d&&(d=1/Math.sqrt(p*p+A*A+S*S+i*i),p*=d,A*=d,S*=d,i*=d)}t[r]=p,t[r+1]=A,t[r+2]=S,t[r+3]=i},multiplyQuaternionsFlat:function(t,r,i,s,f,c){var d=i[s],p=i[s+1],A=i[s+2];i=i[s+3],s=f[c];var S=f[c+1],z=f[c+2];return f=f[c+3],t[r]=d*f+i*s+p*z-A*S,t[r+1]=p*f+i*S+A*s-d*z,t[r+2]=A*f+i*z+d*S-p*s,t[r+3]=i*f-d*s-p*S-A*z,t}}),Or(ye.prototype,{x:{get:function(){return this._x},set:function(t){this._x=t,this._onChangeCallback()}},y:{get:function(){return this._y},set:function(t){this._y=t,this._onChangeCallback()}},z:{get:function(){return this._z},set:function(t){this._z=t,this._onChangeCallback()}},w:{get:function(){return this._w},set:function(t){this._w=t,this._onChangeCallback()}}}),pt(ye.prototype,{isQuaternion:!0,set:function(t,r,i,s){return this._x=t,this._y=r,this._z=i,this._w=s,this._onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this._onChangeCallback(),this},setFromEuler:function(t,r){if(!t||!t.isEuler)throw Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var i=t._x,s=t._y,f=t._z;t=t.order;var c=Math.cos,d=Math.sin,p=c(i/2),A=c(s/2);switch(c=c(f/2),i=d(i/2),s=d(s/2),f=d(f/2),t){case"XYZ":this._x=i*A*c+p*s*f,this._y=p*s*c-i*A*f,this._z=p*A*f+i*s*c,this._w=p*A*c-i*s*f;break;case"YXZ":this._x=i*A*c+p*s*f,this._y=p*s*c-i*A*f,this._z=p*A*f-i*s*c,this._w=p*A*c+i*s*f;break;case"ZXY":this._x=i*A*c-p*s*f,this._y=p*s*c+i*A*f,this._z=p*A*f+i*s*c,this._w=p*A*c-i*s*f;break;case"ZYX":this._x=i*A*c-p*s*f,this._y=p*s*c+i*A*f,this._z=p*A*f-i*s*c,this._w=p*A*c+i*s*f;break;case"YZX":this._x=i*A*c+p*s*f,this._y=p*s*c+i*A*f,this._z=p*A*f-i*s*c,this._w=p*A*c-i*s*f;break;case"XZY":this._x=i*A*c-p*s*f,this._y=p*s*c-i*A*f,this._z=p*A*f+i*s*c,this._w=p*A*c+i*s*f;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+t)}return r!==!1&&this._onChangeCallback(),this},setFromAxisAngle:function(t,r){r/=2;var i=Math.sin(r);return this._x=t.x*i,this._y=t.y*i,this._z=t.z*i,this._w=Math.cos(r),this._onChangeCallback(),this},setFromRotationMatrix:function(t){var r=t.elements,i=r[0];t=r[4];var s=r[8],f=r[1],c=r[5],d=r[9],p=r[2],A=r[6];r=r[10];var S=i+c+r;return 0<S?(i=.5/Math.sqrt(S+1),this._w=.25/i,this._x=(A-d)*i,this._y=(s-p)*i,this._z=(f-t)*i):i>c&&i>r?(i=2*Math.sqrt(1+i-c-r),this._w=(A-d)/i,this._x=.25*i,this._y=(t+f)/i,this._z=(s+p)/i):c>r?(i=2*Math.sqrt(1+c-i-r),this._w=(s-p)/i,this._x=(t+f)/i,this._y=.25*i,this._z=(d+A)/i):(i=2*Math.sqrt(1+r-i-c),this._w=(f-t)/i,this._x=(s+p)/i,this._y=(d+A)/i,this._z=.25*i),this._onChangeCallback(),this},setFromUnitVectors:function(t,r){var i=t.dot(r)+1;return 1e-6>i?(i=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0):(this._x=0,this._y=-t.z,this._z=t.y)):(this._x=t.y*r.z-t.z*r.y,this._y=t.z*r.x-t.x*r.z,this._z=t.x*r.y-t.y*r.x),this._w=i,this.normalize()},angleTo:function(t){return 2*Math.acos(Math.abs(ti.clamp(this.dot(t),-1,1)))},rotateTowards:function(t,r){var i=this.angleTo(t);return i===0?this:(this.slerp(t,Math.min(1,r/i)),this)},inverse:function(){return this.conjugate()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this},dot:function(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var t=this.length();return t===0?(this._z=this._y=this._x=0,this._w=1):(t=1/t,this._x*=t,this._y*=t,this._z*=t,this._w*=t),this._onChangeCallback(),this},multiply:function(t,r){return r!==void 0?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(t,r)):this.multiplyQuaternions(this,t)},premultiply:function(t){return this.multiplyQuaternions(t,this)},multiplyQuaternions:function(t,r){var i=t._x,s=t._y,f=t._z;t=t._w;var c=r._x,d=r._y,p=r._z;return r=r._w,this._x=i*r+t*c+s*p-f*d,this._y=s*r+t*d+f*c-i*p,this._z=f*r+t*p+i*d-s*c,this._w=t*r-i*c-s*d-f*p,this._onChangeCallback(),this},slerp:function(t,r){if(r===0)return this;if(r===1)return this.copy(t);var i=this._x,s=this._y,f=this._z,c=this._w,d=c*t._w+i*t._x+s*t._y+f*t._z;if(0>d?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,d=-d):this.copy(t),1<=d)return this._w=c,this._x=i,this._y=s,this._z=f,this;if(t=1-d*d,t<=an)return d=1-r,this._w=d*c+r*this._w,this._x=d*i+r*this._x,this._y=d*s+r*this._y,this._z=d*f+r*this._z,this.normalize(),this._onChangeCallback(),this;t=Math.sqrt(t);var p=Math.atan2(t,d);return d=Math.sin((1-r)*p)/t,r=Math.sin(r*p)/t,this._w=c*d+this._w*r,this._x=i*d+this._x*r,this._y=s*d+this._y*r,this._z=f*d+this._z*r,this._onChangeCallback(),this},equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w},fromArray:function(t,r){return r===void 0&&(r=0),this._x=t[r],this._y=t[r+1],this._z=t[r+2],this._w=t[r+3],this._onChangeCallback(),this},toArray:function(t,r){return t===void 0&&(t=[]),r===void 0&&(r=0),t[r]=this._x,t[r+1]=this._y,t[r+2]=this._z,t[r+3]=this._w,t},fromBufferAttribute:function(t,r){return this._x=t.getX(r),this._y=t.getY(r),this._z=t.getZ(r),this._w=t.getW(r),this},_onChange:function(t){return this._onChangeCallback=t,this},_onChangeCallback:function(){}});var a=new dt,y=new ye;pt(dt.prototype,{isVector3:!0,set:function(t,r,i){return this.x=t,this.y=r,this.z=i,this},setScalar:function(t){return this.z=this.y=this.x=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setComponent:function(t,r){switch(t){case 0:this.x=r;break;case 1:this.y=r;break;case 2:this.z=r;break;default:throw Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},add:function(t,r){return r!==void 0?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,r)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this},addVectors:function(t,r){return this.x=t.x+r.x,this.y=t.y+r.y,this.z=t.z+r.z,this},addScaledVector:function(t,r){return this.x+=t.x*r,this.y+=t.y*r,this.z+=t.z*r,this},sub:function(t,r){return r!==void 0?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,r)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this},subVectors:function(t,r){return this.x=t.x-r.x,this.y=t.y-r.y,this.z=t.z-r.z,this},multiply:function(t,r){return r!==void 0?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(t,r)):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this},multiplyVectors:function(t,r){return this.x=t.x*r.x,this.y=t.y*r.y,this.z=t.z*r.z,this},applyEuler:function(t){return t&&t.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(y.setFromEuler(t))},applyAxisAngle:function(t,r){return this.applyQuaternion(y.setFromAxisAngle(t,r))},applyMatrix3:function(t){var r=this.x,i=this.y,s=this.z;return t=t.elements,this.x=t[0]*r+t[3]*i+t[6]*s,this.y=t[1]*r+t[4]*i+t[7]*s,this.z=t[2]*r+t[5]*i+t[8]*s,this},applyNormalMatrix:function(t){return this.applyMatrix3(t).normalize()},applyMatrix4:function(t){var r=this.x,i=this.y,s=this.z;t=t.elements;var f=1/(t[3]*r+t[7]*i+t[11]*s+t[15]);return this.x=(t[0]*r+t[4]*i+t[8]*s+t[12])*f,this.y=(t[1]*r+t[5]*i+t[9]*s+t[13])*f,this.z=(t[2]*r+t[6]*i+t[10]*s+t[14])*f,this},applyQuaternion:function(t){var r=this.x,i=this.y,s=this.z,f=t.x,c=t.y,d=t.z;t=t.w;var p=t*r+c*s-d*i,A=t*i+d*r-f*s,S=t*s+f*i-c*r;return r=-f*r-c*i-d*s,this.x=p*t+r*-f+A*-d-S*-c,this.y=A*t+r*-c+S*-f-p*-d,this.z=S*t+r*-d+p*-c-A*-f,this},project:function(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)},unproject:function(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)},transformDirection:function(t){var r=this.x,i=this.y,s=this.z;return t=t.elements,this.x=t[0]*r+t[4]*i+t[8]*s,this.y=t[1]*r+t[5]*i+t[9]*s,this.z=t[2]*r+t[6]*i+t[10]*s,this.normalize()},divide:function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this},divideScalar:function(t){return this.multiplyScalar(1/t)},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this},clamp:function(t,r){return this.x=Math.max(t.x,Math.min(r.x,this.x)),this.y=Math.max(t.y,Math.min(r.y,this.y)),this.z=Math.max(t.z,Math.min(r.z,this.z)),this},clampScalar:function(t,r){return this.x=Math.max(t,Math.min(r,this.x)),this.y=Math.max(t,Math.min(r,this.y)),this.z=Math.max(t,Math.min(r,this.z)),this},clampLength:function(t,r){var i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(t,Math.min(r,i)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x),this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y),this.z=0>this.z?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,r){return this.x+=(t.x-this.x)*r,this.y+=(t.y-this.y)*r,this.z+=(t.z-this.z)*r,this},lerpVectors:function(t,r,i){return this.x=t.x+(r.x-t.x)*i,this.y=t.y+(r.y-t.y)*i,this.z=t.z+(r.z-t.z)*i,this},cross:function(t,r){return r!==void 0?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(t,r)):this.crossVectors(this,t)},crossVectors:function(t,r){var i=t.x,s=t.y;t=t.z;var f=r.x,c=r.y;return r=r.z,this.x=s*r-t*c,this.y=t*f-i*r,this.z=i*c-s*f,this},projectOnVector:function(t){var r=t.lengthSq();return r===0?this.set(0,0,0):(r=t.dot(this)/r,this.copy(t).multiplyScalar(r))},projectOnPlane:function(t){return a.copy(this).projectOnVector(t),this.sub(a)},reflect:function(t){return this.sub(a.copy(t).multiplyScalar(2*this.dot(t)))},angleTo:function(t){var r=Math.sqrt(this.lengthSq()*t.lengthSq());return r===0?Math.PI/2:(t=this.dot(t)/r,Math.acos(ti.clamp(t,-1,1)))},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var r=this.x-t.x,i=this.y-t.y;return t=this.z-t.z,r*r+i*i+t*t},manhattanDistanceTo:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)},setFromSpherical:function(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)},setFromSphericalCoords:function(t,r,i){var s=Math.sin(r)*t;return this.x=s*Math.sin(i),this.y=Math.cos(r)*t,this.z=s*Math.cos(i),this},setFromCylindrical:function(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)},setFromCylindricalCoords:function(t,r,i){return this.x=t*Math.sin(r),this.y=i,this.z=t*Math.cos(r),this},setFromMatrixPosition:function(t){return t=t.elements,this.x=t[12],this.y=t[13],this.z=t[14],this},setFromMatrixScale:function(t){var r=this.setFromMatrixColumn(t,0).length(),i=this.setFromMatrixColumn(t,1).length();return t=this.setFromMatrixColumn(t,2).length(),this.x=r,this.y=i,this.z=t,this},setFromMatrixColumn:function(t,r){return this.fromArray(t.elements,4*r)},setFromMatrix3Column:function(t,r){return this.fromArray(t.elements,3*r)},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z},fromArray:function(t,r){return r===void 0&&(r=0),this.x=t[r],this.y=t[r+1],this.z=t[r+2],this},toArray:function(t,r){return t===void 0&&(t=[]),r===void 0&&(r=0),t[r]=this.x,t[r+1]=this.y,t[r+2]=this.z,t},fromBufferAttribute:function(t,r,i){return i!==void 0&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(r),this.y=t.getY(r),this.z=t.getZ(r),this},random:function(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}});var g=new dt,x=new Me,v=new dt(0,0,0),M=new dt(1,1,1),D=new dt,U=new dt,C=new dt;pt(Me.prototype,{isMatrix4:!0,set:function(t,r,i,s,f,c,d,p,A,S,z,w,I,E,P,F){var X=this.elements;return X[0]=t,X[4]=r,X[8]=i,X[12]=s,X[1]=f,X[5]=c,X[9]=d,X[13]=p,X[2]=A,X[6]=S,X[10]=z,X[14]=w,X[3]=I,X[7]=E,X[11]=P,X[15]=F,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return new Me().fromArray(this.elements)},copy:function(t){var r=this.elements;return t=t.elements,r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r[4]=t[4],r[5]=t[5],r[6]=t[6],r[7]=t[7],r[8]=t[8],r[9]=t[9],r[10]=t[10],r[11]=t[11],r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15],this},copyPosition:function(t){var r=this.elements;return t=t.elements,r[12]=t[12],r[13]=t[13],r[14]=t[14],this},extractBasis:function(t,r,i){return t.setFromMatrixColumn(this,0),r.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this},makeBasis:function(t,r,i){return this.set(t.x,r.x,i.x,0,t.y,r.y,i.y,0,t.z,r.z,i.z,0,0,0,0,1),this},extractRotation:function(t){var r=this.elements,i=t.elements,s=1/g.setFromMatrixColumn(t,0).length(),f=1/g.setFromMatrixColumn(t,1).length();return t=1/g.setFromMatrixColumn(t,2).length(),r[0]=i[0]*s,r[1]=i[1]*s,r[2]=i[2]*s,r[3]=0,r[4]=i[4]*f,r[5]=i[5]*f,r[6]=i[6]*f,r[7]=0,r[8]=i[8]*t,r[9]=i[9]*t,r[10]=i[10]*t,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,this},makeRotationFromEuler:function(t){t&&t.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var r=this.elements,i=t.x,s=t.y,f=t.z,c=Math.cos(i);i=Math.sin(i);var d=Math.cos(s);s=Math.sin(s);var p=Math.cos(f);if(f=Math.sin(f),t.order==="XYZ"){t=c*p;var A=c*f,S=i*p,z=i*f;r[0]=d*p,r[4]=-d*f,r[8]=s,r[1]=A+S*s,r[5]=t-z*s,r[9]=-i*d,r[2]=z-t*s,r[6]=S+A*s,r[10]=c*d}else t.order==="YXZ"?(t=d*p,A=d*f,S=s*p,z=s*f,r[0]=t+z*i,r[4]=S*i-A,r[8]=c*s,r[1]=c*f,r[5]=c*p,r[9]=-i,r[2]=A*i-S,r[6]=z+t*i,r[10]=c*d):t.order==="ZXY"?(t=d*p,A=d*f,S=s*p,z=s*f,r[0]=t-z*i,r[4]=-c*f,r[8]=S+A*i,r[1]=A+S*i,r[5]=c*p,r[9]=z-t*i,r[2]=-c*s,r[6]=i,r[10]=c*d):t.order==="ZYX"?(t=c*p,A=c*f,S=i*p,z=i*f,r[0]=d*p,r[4]=S*s-A,r[8]=t*s+z,r[1]=d*f,r[5]=z*s+t,r[9]=A*s-S,r[2]=-s,r[6]=i*d,r[10]=c*d):t.order==="YZX"?(t=c*d,A=c*s,S=i*d,z=i*s,r[0]=d*p,r[4]=z-t*f,r[8]=S*f+A,r[1]=f,r[5]=c*p,r[9]=-i*p,r[2]=-s*p,r[6]=A*f+S,r[10]=t-z*f):t.order==="XZY"&&(t=c*d,A=c*s,S=i*d,z=i*s,r[0]=d*p,r[4]=-f,r[8]=s*p,r[1]=t*f+z,r[5]=c*p,r[9]=A*f-S,r[2]=S*f-A,r[6]=i*p,r[10]=z*f+t);return r[3]=0,r[7]=0,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,this},makeRotationFromQuaternion:function(t){return this.compose(v,t,M)},lookAt:function(t,r,i){var s=this.elements;return C.subVectors(t,r),C.lengthSq()===0&&(C.z=1),C.normalize(),D.crossVectors(i,C),D.lengthSq()===0&&(Math.abs(i.z)===1?C.x+=1e-4:C.z+=1e-4,C.normalize(),D.crossVectors(i,C)),D.normalize(),U.crossVectors(C,D),s[0]=D.x,s[4]=U.x,s[8]=C.x,s[1]=D.y,s[5]=U.y,s[9]=C.y,s[2]=D.z,s[6]=U.z,s[10]=C.z,this},multiply:function(t,r){return r!==void 0?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(t,r)):this.multiplyMatrices(this,t)},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,r){var i=t.elements,s=r.elements;r=this.elements,t=i[0];var f=i[4],c=i[8],d=i[12],p=i[1],A=i[5],S=i[9],z=i[13],w=i[2],I=i[6],E=i[10],P=i[14],F=i[3],X=i[7],q=i[11];i=i[15];var J=s[0],it=s[4],lt=s[8],Mt=s[12],Ct=s[1],wt=s[5],zt=s[9],Ut=s[13],Kt=s[2],Gt=s[6],Qt=s[10],De=s[14],re=s[3],We=s[7],hr=s[11];return s=s[15],r[0]=t*J+f*Ct+c*Kt+d*re,r[4]=t*it+f*wt+c*Gt+d*We,r[8]=t*lt+f*zt+c*Qt+d*hr,r[12]=t*Mt+f*Ut+c*De+d*s,r[1]=p*J+A*Ct+S*Kt+z*re,r[5]=p*it+A*wt+S*Gt+z*We,r[9]=p*lt+A*zt+S*Qt+z*hr,r[13]=p*Mt+A*Ut+S*De+z*s,r[2]=w*J+I*Ct+E*Kt+P*re,r[6]=w*it+I*wt+E*Gt+P*We,r[10]=w*lt+I*zt+E*Qt+P*hr,r[14]=w*Mt+I*Ut+E*De+P*s,r[3]=F*J+X*Ct+q*Kt+i*re,r[7]=F*it+X*wt+q*Gt+i*We,r[11]=F*lt+X*zt+q*Qt+i*hr,r[15]=F*Mt+X*Ut+q*De+i*s,this},multiplyScalar:function(t){var r=this.elements;return r[0]*=t,r[4]*=t,r[8]*=t,r[12]*=t,r[1]*=t,r[5]*=t,r[9]*=t,r[13]*=t,r[2]*=t,r[6]*=t,r[10]*=t,r[14]*=t,r[3]*=t,r[7]*=t,r[11]*=t,r[15]*=t,this},determinant:function(){var t=this.elements,r=t[0],i=t[4],s=t[8],f=t[12],c=t[1],d=t[5],p=t[9],A=t[13],S=t[2],z=t[6],w=t[10],I=t[14];return t[3]*(+f*p*z-s*A*z-f*d*w+i*A*w+s*d*I-i*p*I)+t[7]*(+r*p*I-r*A*w+f*c*w-s*c*I+s*A*S-f*p*S)+t[11]*(+r*A*z-r*d*I-f*c*z+i*c*I+f*d*S-i*A*S)+t[15]*(-s*d*S-r*p*z+r*d*w+s*c*z-i*c*w+i*p*S)},transpose:function(){var t=this.elements,r=t[1];return t[1]=t[4],t[4]=r,r=t[2],t[2]=t[8],t[8]=r,r=t[6],t[6]=t[9],t[9]=r,r=t[3],t[3]=t[12],t[12]=r,r=t[7],t[7]=t[13],t[13]=r,r=t[11],t[11]=t[14],t[14]=r,this},setPosition:function(t,r,i){var s=this.elements;return t.isVector3?(s[12]=t.x,s[13]=t.y,s[14]=t.z):(s[12]=t,s[13]=r,s[14]=i),this},getInverse:function(t,r){r!==void 0&&console.warn("THREE.Matrix4: .getInverse() can no longer be configured to throw on degenerate."),r=this.elements;var i=t.elements;t=i[0];var s=i[1],f=i[2],c=i[3],d=i[4],p=i[5],A=i[6],S=i[7],z=i[8],w=i[9],I=i[10],E=i[11],P=i[12],F=i[13],X=i[14];i=i[15];var q=w*X*S-F*I*S+F*A*E-p*X*E-w*A*i+p*I*i,J=P*I*S-z*X*S-P*A*E+d*X*E+z*A*i-d*I*i,it=z*F*S-P*w*S+P*p*E-d*F*E-z*p*i+d*w*i,lt=P*w*A-z*F*A-P*p*I+d*F*I+z*p*X-d*w*X,Mt=t*q+s*J+f*it+c*lt;return Mt===0?this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0):(Mt=1/Mt,r[0]=q*Mt,r[1]=(F*I*c-w*X*c-F*f*E+s*X*E+w*f*i-s*I*i)*Mt,r[2]=(p*X*c-F*A*c+F*f*S-s*X*S-p*f*i+s*A*i)*Mt,r[3]=(w*A*c-p*I*c-w*f*S+s*I*S+p*f*E-s*A*E)*Mt,r[4]=J*Mt,r[5]=(z*X*c-P*I*c+P*f*E-t*X*E-z*f*i+t*I*i)*Mt,r[6]=(P*A*c-d*X*c-P*f*S+t*X*S+d*f*i-t*A*i)*Mt,r[7]=(d*I*c-z*A*c+z*f*S-t*I*S-d*f*E+t*A*E)*Mt,r[8]=it*Mt,r[9]=(P*w*c-z*F*c-P*s*E+t*F*E+z*s*i-t*w*i)*Mt,r[10]=(d*F*c-P*p*c+P*s*S-t*F*S-d*s*i+t*p*i)*Mt,r[11]=(z*p*c-d*w*c-z*s*S+t*w*S+d*s*E-t*p*E)*Mt,r[12]=lt*Mt,r[13]=(z*F*f-P*w*f+P*s*I-t*F*I-z*s*X+t*w*X)*Mt,r[14]=(P*p*f-d*F*f-P*s*A+t*F*A+d*s*X-t*p*X)*Mt,r[15]=(d*w*f-z*p*f+z*s*A-t*w*A-d*s*I+t*p*I)*Mt,this)},scale:function(t){var r=this.elements,i=t.x,s=t.y;return t=t.z,r[0]*=i,r[4]*=s,r[8]*=t,r[1]*=i,r[5]*=s,r[9]*=t,r[2]*=i,r[6]*=s,r[10]*=t,r[3]*=i,r[7]*=s,r[11]*=t,this},getMaxScaleOnAxis:function(){var t=this.elements;return Math.sqrt(Math.max(t[0]*t[0]+t[1]*t[1]+t[2]*t[2],t[4]*t[4]+t[5]*t[5]+t[6]*t[6],t[8]*t[8]+t[9]*t[9]+t[10]*t[10]))},makeTranslation:function(t,r,i){return this.set(1,0,0,t,0,1,0,r,0,0,1,i,0,0,0,1),this},makeRotationX:function(t){var r=Math.cos(t);return t=Math.sin(t),this.set(1,0,0,0,0,r,-t,0,0,t,r,0,0,0,0,1),this},makeRotationY:function(t){var r=Math.cos(t);return t=Math.sin(t),this.set(r,0,t,0,0,1,0,0,-t,0,r,0,0,0,0,1),this},makeRotationZ:function(t){var r=Math.cos(t);return t=Math.sin(t),this.set(r,-t,0,0,t,r,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(t,r){var i=Math.cos(r);r=Math.sin(r);var s=1-i,f=t.x,c=t.y;t=t.z;var d=s*f,p=s*c;return this.set(d*f+i,d*c-r*t,d*t+r*c,0,d*c+r*t,p*c+i,p*t-r*f,0,d*t-r*c,p*t+r*f,s*t*t+i,0,0,0,0,1),this},makeScale:function(t,r,i){return this.set(t,0,0,0,0,r,0,0,0,0,i,0,0,0,0,1),this},makeShear:function(t,r,i){return this.set(1,r,i,0,t,1,i,0,t,r,1,0,0,0,0,1),this},compose:function(t,r,i){var s=this.elements,f=r._x,c=r._y,d=r._z,p=r._w,A=f+f,S=c+c,z=d+d;r=f*A;var w=f*S;f*=z;var I=c*S;c*=z,d*=z,A*=p,S*=p,p*=z,z=i.x;var E=i.y;return i=i.z,s[0]=(1-(I+d))*z,s[1]=(w+p)*z,s[2]=(f-S)*z,s[3]=0,s[4]=(w-p)*E,s[5]=(1-(r+d))*E,s[6]=(c+A)*E,s[7]=0,s[8]=(f+S)*i,s[9]=(c-A)*i,s[10]=(1-(r+I))*i,s[11]=0,s[12]=t.x,s[13]=t.y,s[14]=t.z,s[15]=1,this},decompose:function(t,r,i){var s=this.elements,f=g.set(s[0],s[1],s[2]).length(),c=g.set(s[4],s[5],s[6]).length(),d=g.set(s[8],s[9],s[10]).length();0>this.determinant()&&(f=-f),t.x=s[12],t.y=s[13],t.z=s[14],x.copy(this),t=1/f,s=1/c;var p=1/d;return x.elements[0]*=t,x.elements[1]*=t,x.elements[2]*=t,x.elements[4]*=s,x.elements[5]*=s,x.elements[6]*=s,x.elements[8]*=p,x.elements[9]*=p,x.elements[10]*=p,r.setFromRotationMatrix(x),i.x=f,i.y=c,i.z=d,this},makePerspective:function(t,r,i,s,f,c){c===void 0&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");var d=this.elements;return d[0]=2*f/(r-t),d[4]=0,d[8]=(r+t)/(r-t),d[12]=0,d[1]=0,d[5]=2*f/(i-s),d[9]=(i+s)/(i-s),d[13]=0,d[2]=0,d[6]=0,d[10]=-(c+f)/(c-f),d[14]=-2*c*f/(c-f),d[3]=0,d[7]=0,d[11]=-1,d[15]=0,this},makeOrthographic:function(t,r,i,s,f,c){var d=this.elements,p=1/(r-t),A=1/(i-s),S=1/(c-f);return d[0]=2*p,d[4]=0,d[8]=0,d[12]=-((r+t)*p),d[1]=0,d[5]=2*A,d[9]=0,d[13]=-((i+s)*A),d[2]=0,d[6]=0,d[10]=-2*S,d[14]=-((c+f)*S),d[3]=0,d[7]=0,d[11]=0,d[15]=1,this},equals:function(t){var r=this.elements;t=t.elements;for(var i=0;16>i;i++)if(r[i]!==t[i])return!1;return!0},fromArray:function(t,r){r===void 0&&(r=0);for(var i=0;16>i;i++)this.elements[i]=t[i+r];return this},toArray:function(t,r){t===void 0&&(t=[]),r===void 0&&(r=0);var i=this.elements;return t[r]=i[0],t[r+1]=i[1],t[r+2]=i[2],t[r+3]=i[3],t[r+4]=i[4],t[r+5]=i[5],t[r+6]=i[6],t[r+7]=i[7],t[r+8]=i[8],t[r+9]=i[9],t[r+10]=i[10],t[r+11]=i[11],t[r+12]=i[12],t[r+13]=i[13],t[r+14]=i[14],t[r+15]=i[15],t}});var L=new Me,B=new ye;vr.RotationOrders="XYZ YZX ZXY XZY YXZ ZYX".split(" "),vr.DefaultOrder="XYZ",Or(vr.prototype,{x:{get:function(){return this._x},set:function(t){this._x=t,this._onChangeCallback()}},y:{get:function(){return this._y},set:function(t){this._y=t,this._onChangeCallback()}},z:{get:function(){return this._z},set:function(t){this._z=t,this._onChangeCallback()}},order:{get:function(){return this._order},set:function(t){this._order=t,this._onChangeCallback()}}}),pt(vr.prototype,{isEuler:!0,set:function(t,r,i,s){return this._x=t,this._y=r,this._z=i,this._order=s||this._order,this._onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this},setFromRotationMatrix:function(t,r,i){var s=ti.clamp,f=t.elements;t=f[0];var c=f[4],d=f[8],p=f[1],A=f[5],S=f[9],z=f[2],w=f[6];switch(f=f[10],r=r||this._order,r){case"XYZ":this._y=Math.asin(s(d,-1,1)),.9999999>Math.abs(d)?(this._x=Math.atan2(-S,f),this._z=Math.atan2(-c,t)):(this._x=Math.atan2(w,A),this._z=0);break;case"YXZ":this._x=Math.asin(-s(S,-1,1)),.9999999>Math.abs(S)?(this._y=Math.atan2(d,f),this._z=Math.atan2(p,A)):(this._y=Math.atan2(-z,t),this._z=0);break;case"ZXY":this._x=Math.asin(s(w,-1,1)),.9999999>Math.abs(w)?(this._y=Math.atan2(-z,f),this._z=Math.atan2(-c,A)):(this._y=0,this._z=Math.atan2(p,t));break;case"ZYX":this._y=Math.asin(-s(z,-1,1)),.9999999>Math.abs(z)?(this._x=Math.atan2(w,f),this._z=Math.atan2(p,t)):(this._x=0,this._z=Math.atan2(-c,A));break;case"YZX":this._z=Math.asin(s(p,-1,1)),.9999999>Math.abs(p)?(this._x=Math.atan2(-S,A),this._y=Math.atan2(-z,t)):(this._x=0,this._y=Math.atan2(d,f));break;case"XZY":this._z=Math.asin(-s(c,-1,1)),.9999999>Math.abs(c)?(this._x=Math.atan2(w,A),this._y=Math.atan2(d,t)):(this._x=Math.atan2(-S,f),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+r)}return this._order=r,i!==!1&&this._onChangeCallback(),this},setFromQuaternion:function(t,r,i){return L.makeRotationFromQuaternion(t),this.setFromRotationMatrix(L,r,i)},setFromVector3:function(t,r){return this.set(t.x,t.y,t.z,r||this._order)},reorder:function(t){return B.setFromEuler(this),this.setFromQuaternion(B,t)},equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order},fromArray:function(t){return this._x=t[0],this._y=t[1],this._z=t[2],t[3]!==void 0&&(this._order=t[3]),this._onChangeCallback(),this},toArray:function(t,r){return t===void 0&&(t=[]),r===void 0&&(r=0),t[r]=this._x,t[r+1]=this._y,t[r+2]=this._z,t[r+3]=this._order,t},toVector3:function(t){return t?t.set(this._x,this._y,this._z):new dt(this._x,this._y,this._z)},_onChange:function(t){return this._onChangeCallback=t,this},_onChangeCallback:function(){}}),pt(Tr.prototype,{set:function(t){this.mask=1<<t|0},enable:function(t){this.mask=this.mask|1<<t|0},enableAll:function(){this.mask=-1},toggle:function(t){this.mask^=1<<t|0},disable:function(t){this.mask&=~(1<<t|0)},disableAll:function(){this.mask=0},test:function(t){return(this.mask&t.mask)!==0}});var O=0,k=new dt,j=new ye,V=new Me,Y=new dt,Q=new dt,nt=new dt,ut=new ye,ct=new dt(1,0,0),Tt=new dt(0,1,0),Lt=new dt(0,0,1),Dt={type:"added"},ae={type:"removed"};fe.DefaultUp=new dt(0,1,0),fe.DefaultMatrixAutoUpdate=!0,fe.prototype=pt(ft(se.prototype),{constructor:fe,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix4:function(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(t){return this.quaternion.premultiply(t),this},setRotationFromAxisAngle:function(t,r){this.quaternion.setFromAxisAngle(t,r)},setRotationFromEuler:function(t){this.quaternion.setFromEuler(t,!0)},setRotationFromMatrix:function(t){this.quaternion.setFromRotationMatrix(t)},setRotationFromQuaternion:function(t){this.quaternion.copy(t)},rotateOnAxis:function(t,r){return j.setFromAxisAngle(t,r),this.quaternion.multiply(j),this},rotateOnWorldAxis:function(t,r){return j.setFromAxisAngle(t,r),this.quaternion.premultiply(j),this},rotateX:function(t){return this.rotateOnAxis(ct,t)},rotateY:function(t){return this.rotateOnAxis(Tt,t)},rotateZ:function(t){return this.rotateOnAxis(Lt,t)},translateOnAxis:function(t,r){return k.copy(t).applyQuaternion(this.quaternion),this.position.add(k.multiplyScalar(r)),this},translateX:function(t){return this.translateOnAxis(ct,t)},translateY:function(t){return this.translateOnAxis(Tt,t)},translateZ:function(t){return this.translateOnAxis(Lt,t)},localToWorld:function(t){return t.applyMatrix4(this.matrixWorld)},worldToLocal:function(t){return t.applyMatrix4(V.getInverse(this.matrixWorld))},lookAt:function(t,r,i){t.isVector3?Y.copy(t):Y.set(t,r,i),t=this.parent,this.updateWorldMatrix(!0,!1),Q.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?V.lookAt(Q,Y,this.up):V.lookAt(Y,Q,this.up),this.quaternion.setFromRotationMatrix(V),t&&(V.extractRotation(t.matrixWorld),j.setFromRotationMatrix(V),this.quaternion.premultiply(j.inverse()))},add:function(t){if(1<arguments.length){for(var r=0;r<arguments.length;r++)this.add(arguments[r]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(t.parent!==null&&t.parent.remove(t),t.parent=this,this.children.push(t),t.dispatchEvent(Dt)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)},remove:function(t){if(1<arguments.length){for(var r=0;r<arguments.length;r++)this.remove(arguments[r]);return this}return r=this.children.indexOf(t),r!==-1&&(t.parent=null,this.children.splice(r,1),t.dispatchEvent(ae)),this},attach:function(t){return this.updateWorldMatrix(!0,!1),V.getInverse(this.matrixWorld),t.parent!==null&&(t.parent.updateWorldMatrix(!0,!1),V.multiply(t.parent.matrixWorld)),t.applyMatrix4(V),t.updateWorldMatrix(!1,!1),this.add(t),this},getObjectById:function(t){return this.getObjectByProperty("id",t)},getObjectByName:function(t){return this.getObjectByProperty("name",t)},getObjectByProperty:function(t,r){if(this[t]===r)return this;for(var i=0,s=this.children.length;i<s;i++){var f=this.children[i].getObjectByProperty(t,r);if(f!==void 0)return f}},getWorldPosition:function(t){return t===void 0&&(console.warn("THREE.Object3D: .getWorldPosition() target is now required"),t=new dt),this.updateMatrixWorld(!0),t.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(t){return t===void 0&&(console.warn("THREE.Object3D: .getWorldQuaternion() target is now required"),t=new ye),this.updateMatrixWorld(!0),this.matrixWorld.decompose(Q,t,nt),t},getWorldScale:function(t){return t===void 0&&(console.warn("THREE.Object3D: .getWorldScale() target is now required"),t=new dt),this.updateMatrixWorld(!0),this.matrixWorld.decompose(Q,ut,t),t},getWorldDirection:function(t){t===void 0&&(console.warn("THREE.Object3D: .getWorldDirection() target is now required"),t=new dt),this.updateMatrixWorld(!0);var r=this.matrixWorld.elements;return t.set(r[8],r[9],r[10]).normalize()},raycast:function(){},traverse:function(t){t(this);for(var r=this.children,i=0,s=r.length;i<s;i++)r[i].traverse(t)},traverseVisible:function(t){if(this.visible!==!1){t(this);for(var r=this.children,i=0,s=r.length;i<s;i++)r[i].traverseVisible(t)}},traverseAncestors:function(t){var r=this.parent;r!==null&&(t(r),r.traverseAncestors(t))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);for(var r=this.children,i=0,s=r.length;i<s;i++)r[i].updateMatrixWorld(t)},updateWorldMatrix:function(t,r){var i=this.parent;if(t===!0&&i!==null&&i.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),r===!0)for(t=this.children,r=0,i=t.length;r<i;r++)t[r].updateWorldMatrix(!1,!0)},toJSON:function(t){function r(z,w){return z[w.uuid]===void 0&&(z[w.uuid]=w.toJSON(t)),w.uuid}function i(z){var w=[],I;for(I in z){var E=z[I];delete E.metadata,w.push(E)}return w}var s=t===void 0||typeof t=="string",f={};s&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{}},f.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});var c={};if(c.uuid=this.uuid,c.type=this.type,this.name!==""&&(c.name=this.name),this.castShadow===!0&&(c.castShadow=!0),this.receiveShadow===!0&&(c.receiveShadow=!0),this.visible===!1&&(c.visible=!1),this.frustumCulled===!1&&(c.frustumCulled=!1),this.renderOrder!==0&&(c.renderOrder=this.renderOrder),Hs(this.userData)!=="{}"&&(c.userData=this.userData),c.layers=this.layers.mask,c.matrix=this.matrix.toArray(),this.matrixAutoUpdate===!1&&(c.matrixAutoUpdate=!1),this.isInstancedMesh&&(c.type="InstancedMesh",c.count=this.count,c.instanceMatrix=this.instanceMatrix.toJSON()),this.isMesh||this.isLine||this.isPoints){c.geometry=r(t.geometries,this.geometry);var d=this.geometry.parameters;if(d!==void 0&&d.shapes!==void 0)if(d=d.shapes,Array.isArray(d))for(var p=0,A=d.length;p<A;p++)r(t.shapes,d[p]);else r(t.shapes,d)}if(this.material!==void 0)if(Array.isArray(this.material)){for(d=[],p=0,A=this.material.length;p<A;p++)d.push(r(t.materials,this.material[p]));c.material=d}else c.material=r(t.materials,this.material);if(0<this.children.length)for(c.children=[],p=0;p<this.children.length;p++)c.children.push(this.children[p].toJSON(t).object);if(s){s=i(t.geometries),p=i(t.materials),A=i(t.textures);var S=i(t.images);d=i(t.shapes),0<s.length&&(f.geometries=s),0<p.length&&(f.materials=p),0<A.length&&(f.textures=A),0<S.length&&(f.images=S),0<d.length&&(f.shapes=d)}return f.object=c,f},clone:function(t){return new this.constructor().copy(this,t)},copy:function(t,r){if(r===void 0&&(r=!0),this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.userData=JSON.parse(Hs(t.userData)),r===!0)for(r=0;r<t.children.length;r++)this.add(t.children[r].clone());return this}}),Mr.prototype=pt(ft(fe.prototype),{constructor:Mr,isScene:!0,copy:function(t,r){return fe.prototype.copy.call(this,t,r),t.background!==null&&(this.background=t.background.clone()),t.environment!==null&&(this.environment=t.environment.clone()),t.fog!==null&&(this.fog=t.fog.clone()),t.overrideMaterial!==null&&(this.overrideMaterial=t.overrideMaterial.clone()),this.autoUpdate=t.autoUpdate,this.matrixAutoUpdate=t.matrixAutoUpdate,this},toJSON:function(t){var r=fe.prototype.toJSON.call(this,t);return this.background!==null&&(r.object.background=this.background.toJSON(t)),this.environment!==null&&(r.object.environment=this.environment.toJSON(t)),this.fog!==null&&(r.object.fog=this.fog.toJSON()),r},dispose:function(){this.dispatchEvent({type:"dispose"})}});var ne=[new dt,new dt,new dt,new dt,new dt,new dt,new dt,new dt],we=new dt,xe=new ui,Ye=new dt,mr=new dt,ee=new dt,Re=new dt,xr=new dt,gr=new dt,Be=new dt,Mo=new dt,Ni=new dt,Ii=new dt;pt(ui.prototype,{isBox3:!0,set:function(t,r){return this.min.copy(t),this.max.copy(r),this},setFromArray:function(t){for(var r=1/0,i=1/0,s=1/0,f=-1/0,c=-1/0,d=-1/0,p=0,A=t.length;p<A;p+=3){var S=t[p],z=t[p+1],w=t[p+2];S<r&&(r=S),z<i&&(i=z),w<s&&(s=w),S>f&&(f=S),z>c&&(c=z),w>d&&(d=w)}return this.min.set(r,i,s),this.max.set(f,c,d),this},setFromBufferAttribute:function(t){for(var r=1/0,i=1/0,s=1/0,f=-1/0,c=-1/0,d=-1/0,p=0,A=t.count;p<A;p++){var S=t.getX(p),z=t.getY(p),w=t.getZ(p);S<r&&(r=S),z<i&&(i=z),w<s&&(s=w),S>f&&(f=S),z>c&&(c=z),w>d&&(d=w)}return this.min.set(r,i,s),this.max.set(f,c,d),this},setFromPoints:function(t){this.makeEmpty();for(var r=0,i=t.length;r<i;r++)this.expandByPoint(t[r]);return this},setFromCenterAndSize:function(t,r){return r=we.copy(r).multiplyScalar(.5),this.min.copy(t).sub(r),this.max.copy(t).add(r),this},setFromObject:function(t){return this.makeEmpty(),this.expandByObject(t)},clone:function(){return new this.constructor().copy(this)},copy:function(t){return this.min.copy(t.min),this.max.copy(t.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},getCenter:function(t){return t===void 0&&(console.warn("THREE.Box3: .getCenter() target is now required"),t=new dt),this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(t){return t===void 0&&(console.warn("THREE.Box3: .getSize() target is now required"),t=new dt),this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)},expandByPoint:function(t){return this.min.min(t),this.max.max(t),this},expandByVector:function(t){return this.min.sub(t),this.max.add(t),this},expandByScalar:function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},expandByObject:function(t){t.updateWorldMatrix(!1,!1);var r=t.geometry;r!==void 0&&(r.boundingBox===null&&r.computeBoundingBox(),xe.copy(r.boundingBox),xe.applyMatrix4(t.matrixWorld),this.union(xe)),t=t.children,r=0;for(var i=t.length;r<i;r++)this.expandByObject(t[r]);return this},containsPoint:function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z)},containsBox:function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z},getParameter:function(t,r){return r===void 0&&(console.warn("THREE.Box3: .getParameter() target is now required"),r=new dt),r.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))},intersectsBox:function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z)},intersectsSphere:function(t){return this.clampPoint(t.center,we),we.distanceToSquared(t.center)<=t.radius*t.radius},intersectsPlane:function(t){if(0<t.normal.x)var r=t.normal.x*this.min.x,i=t.normal.x*this.max.x;else r=t.normal.x*this.max.x,i=t.normal.x*this.min.x;return 0<t.normal.y?(r+=t.normal.y*this.min.y,i+=t.normal.y*this.max.y):(r+=t.normal.y*this.max.y,i+=t.normal.y*this.min.y),0<t.normal.z?(r+=t.normal.z*this.min.z,i+=t.normal.z*this.max.z):(r+=t.normal.z*this.max.z,i+=t.normal.z*this.min.z),r<=-t.constant&&i>=-t.constant},intersectsTriangle:function(t){return this.isEmpty()||(this.getCenter(Be),Mo.subVectors(this.max,Be),Ye.subVectors(t.a,Be),mr.subVectors(t.b,Be),ee.subVectors(t.c,Be),Re.subVectors(mr,Ye),xr.subVectors(ee,mr),gr.subVectors(Ye,ee),t=[0,-Re.z,Re.y,0,-xr.z,xr.y,0,-gr.z,gr.y,Re.z,0,-Re.x,xr.z,0,-xr.x,gr.z,0,-gr.x,-Re.y,Re.x,0,-xr.y,xr.x,0,-gr.y,gr.x,0],!xi(t,Ye,mr,ee,Mo))||(t=[1,0,0,0,1,0,0,0,1],!xi(t,Ye,mr,ee,Mo))?!1:(Ni.crossVectors(Re,xr),t=[Ni.x,Ni.y,Ni.z],xi(t,Ye,mr,ee,Mo))},clampPoint:function(t,r){return r===void 0&&(console.warn("THREE.Box3: .clampPoint() target is now required"),r=new dt),r.copy(t).clamp(this.min,this.max)},distanceToPoint:function(t){return we.copy(t).clamp(this.min,this.max).sub(t).length()},getBoundingSphere:function(t){return t===void 0&&console.error("THREE.Box3: .getBoundingSphere() target is now required"),this.getCenter(t.center),t.radius=.5*this.getSize(we).length(),t},intersect:function(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this},union:function(t){return this.min.min(t.min),this.max.max(t.max),this},applyMatrix4:function(t){return this.isEmpty()?this:(ne[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),ne[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),ne[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),ne[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),ne[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),ne[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),ne[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),ne[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.setFromPoints(ne),this)},translate:function(t){return this.min.add(t),this.max.add(t),this},equals:function(t){return t.min.equals(this.min)&&t.max.equals(this.max)}});var Mv=new ui;pt(fn.prototype,{set:function(t,r){return this.center.copy(t),this.radius=r,this},setFromPoints:function(t,r){var i=this.center;r!==void 0?i.copy(r):Mv.setFromPoints(t).getCenter(i);for(var s=r=0,f=t.length;s<f;s++)r=Math.max(r,i.distanceToSquared(t[s]));return this.radius=Math.sqrt(r),this},clone:function(){return new this.constructor().copy(this)},copy:function(t){return this.center.copy(t.center),this.radius=t.radius,this},isEmpty:function(){return 0>this.radius},makeEmpty:function(){return this.center.set(0,0,0),this.radius=-1,this},containsPoint:function(t){return t.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(t){return t.distanceTo(this.center)-this.radius},intersectsSphere:function(t){var r=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=r*r},intersectsBox:function(t){return t.intersectsSphere(this)},intersectsPlane:function(t){return Math.abs(t.distanceToPoint(this.center))<=this.radius},clampPoint:function(t,r){var i=this.center.distanceToSquared(t);return r===void 0&&(console.warn("THREE.Sphere: .clampPoint() target is now required"),r=new dt),r.copy(t),i>this.radius*this.radius&&(r.sub(this.center).normalize(),r.multiplyScalar(this.radius).add(this.center)),r},getBoundingBox:function(t){return t===void 0&&(console.warn("THREE.Sphere: .getBoundingBox() target is now required"),t=new ui),this.isEmpty()?(t.makeEmpty(),t):(t.set(this.center,this.center),t.expandByScalar(this.radius),t)},applyMatrix4:function(t){return this.center.applyMatrix4(t),this.radius*=t.getMaxScaleOnAxis(),this},translate:function(t){return this.center.add(t),this},equals:function(t){return t.center.equals(this.center)&&t.radius===this.radius}});var Hi=new dt,op=new dt,Nd=new dt,_s=new dt,n_=new dt,Ty=new dt,o_=new dt;pt(Ln.prototype,{set:function(t,r){return this.origin.copy(t),this.direction.copy(r),this},clone:function(){return new this.constructor().copy(this)},copy:function(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this},at:function(t,r){return r===void 0&&(console.warn("THREE.Ray: .at() target is now required"),r=new dt),r.copy(this.direction).multiplyScalar(t).add(this.origin)},lookAt:function(t){return this.direction.copy(t).sub(this.origin).normalize(),this},recast:function(t){return this.origin.copy(this.at(t,Hi)),this},closestPointToPoint:function(t,r){return r===void 0&&(console.warn("THREE.Ray: .closestPointToPoint() target is now required"),r=new dt),r.subVectors(t,this.origin),t=r.dot(this.direction),0>t?r.copy(this.origin):r.copy(this.direction).multiplyScalar(t).add(this.origin)},distanceToPoint:function(t){return Math.sqrt(this.distanceSqToPoint(t))},distanceSqToPoint:function(t){var r=Hi.subVectors(t,this.origin).dot(this.direction);return 0>r?this.origin.distanceToSquared(t):(Hi.copy(this.direction).multiplyScalar(r).add(this.origin),Hi.distanceToSquared(t))},distanceSqToSegment:function(t,r,i,s){op.copy(t).add(r).multiplyScalar(.5),Nd.copy(r).sub(t).normalize(),_s.copy(this.origin).sub(op);var f=.5*t.distanceTo(r),c=-this.direction.dot(Nd),d=_s.dot(this.direction),p=-_s.dot(Nd),A=_s.lengthSq(),S=Math.abs(1-c*c);if(0<S){t=c*p-d,r=c*d-p;var z=f*S;0<=t?r>=-z?r<=z?(f=1/S,t*=f,r*=f,c=t*(t+c*r+2*d)+r*(c*t+r+2*p)+A):(r=f,t=Math.max(0,-(c*r+d)),c=-t*t+r*(r+2*p)+A):(r=-f,t=Math.max(0,-(c*r+d)),c=-t*t+r*(r+2*p)+A):r<=-z?(t=Math.max(0,-(-c*f+d)),r=0<t?-f:Math.min(Math.max(-f,-p),f),c=-t*t+r*(r+2*p)+A):r<=z?(t=0,r=Math.min(Math.max(-f,-p),f),c=r*(r+2*p)+A):(t=Math.max(0,-(c*f+d)),r=0<t?f:Math.min(Math.max(-f,-p),f),c=-t*t+r*(r+2*p)+A)}else r=0<c?-f:f,t=Math.max(0,-(c*r+d)),c=-t*t+r*(r+2*p)+A;return i&&i.copy(this.direction).multiplyScalar(t).add(this.origin),s&&s.copy(Nd).multiplyScalar(r).add(op),c},intersectSphere:function(t,r){Hi.subVectors(t.center,this.origin);var i=Hi.dot(this.direction),s=Hi.dot(Hi)-i*i;return t=t.radius*t.radius,s>t?null:(t=Math.sqrt(t-s),s=i-t,i+=t,0>s&&0>i?null:0>s?this.at(i,r):this.at(s,r))},intersectsSphere:function(t){return this.distanceSqToPoint(t.center)<=t.radius*t.radius},distanceToPlane:function(t){var r=t.normal.dot(this.direction);return r===0?t.distanceToPoint(this.origin)===0?0:null:(t=-(this.origin.dot(t.normal)+t.constant)/r,0<=t?t:null)},intersectPlane:function(t,r){return t=this.distanceToPlane(t),t===null?null:this.at(t,r)},intersectsPlane:function(t){var r=t.distanceToPoint(this.origin);return r===0||0>t.normal.dot(this.direction)*r},intersectBox:function(t,r){var i=1/this.direction.x,s=1/this.direction.y,f=1/this.direction.z,c=this.origin;if(0<=i){var d=(t.min.x-c.x)*i;i*=t.max.x-c.x}else d=(t.max.x-c.x)*i,i*=t.min.x-c.x;if(0<=s){var p=(t.min.y-c.y)*s;s*=t.max.y-c.y}else p=(t.max.y-c.y)*s,s*=t.min.y-c.y;return d>s||p>i||((p>d||d!==d)&&(d=p),(s<i||i!==i)&&(i=s),0<=f?(p=(t.min.z-c.z)*f,t=(t.max.z-c.z)*f):(p=(t.max.z-c.z)*f,t=(t.min.z-c.z)*f),d>t||p>i)?null:((p>d||d!==d)&&(d=p),(t<i||i!==i)&&(i=t),0>i?null:this.at(0<=d?d:i,r))},intersectsBox:function(t){return this.intersectBox(t,Hi)!==null},intersectTriangle:function(t,r,i,s,f){if(n_.subVectors(r,t),Ty.subVectors(i,t),o_.crossVectors(n_,Ty),r=this.direction.dot(o_),0<r){if(s)return null;s=1}else if(0>r)s=-1,r=-r;else return null;return _s.subVectors(this.origin,t),t=s*this.direction.dot(Ty.crossVectors(_s,Ty)),0>t||(i=s*this.direction.dot(n_.cross(_s)),0>i||t+i>r)?null:(t=-s*_s.dot(o_),0>t?null:this.at(t/r,f))},applyMatrix4:function(t){return this.origin.applyMatrix4(t),this.direction.transformDirection(t),this},equals:function(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)}});var s_=new dt,WI=new dt,jI=new Jt;pt(Li.prototype,{isPlane:!0,set:function(t,r){return this.normal.copy(t),this.constant=r,this},setComponents:function(t,r,i,s){return this.normal.set(t,r,i),this.constant=s,this},setFromNormalAndCoplanarPoint:function(t,r){return this.normal.copy(t),this.constant=-r.dot(this.normal),this},setFromCoplanarPoints:function(t,r,i){return r=s_.subVectors(i,r).cross(WI.subVectors(t,r)).normalize(),this.setFromNormalAndCoplanarPoint(r,t),this},clone:function(){return new this.constructor().copy(this)},copy:function(t){return this.normal.copy(t.normal),this.constant=t.constant,this},normalize:function(){var t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(t){return this.normal.dot(t)+this.constant},distanceToSphere:function(t){return this.distanceToPoint(t.center)-t.radius},projectPoint:function(t,r){return r===void 0&&(console.warn("THREE.Plane: .projectPoint() target is now required"),r=new dt),r.copy(this.normal).multiplyScalar(-this.distanceToPoint(t)).add(t)},intersectLine:function(t,r){r===void 0&&(console.warn("THREE.Plane: .intersectLine() target is now required"),r=new dt);var i=t.delta(s_),s=this.normal.dot(i);if(s===0){if(this.distanceToPoint(t.start)===0)return r.copy(t.start)}else if(s=-(t.start.dot(this.normal)+this.constant)/s,!(0>s||1<s))return r.copy(i).multiplyScalar(s).add(t.start)},intersectsLine:function(t){var r=this.distanceToPoint(t.start);return t=this.distanceToPoint(t.end),0>r&&0<t||0>t&&0<r},intersectsBox:function(t){return t.intersectsPlane(this)},intersectsSphere:function(t){return t.intersectsPlane(this)},coplanarPoint:function(t){return t===void 0&&(console.warn("THREE.Plane: .coplanarPoint() target is now required"),t=new dt),t.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(t,r){return r=r||jI.getNormalMatrix(t),t=this.coplanarPoint(s_).applyMatrix4(t),r=this.normal.applyMatrix3(r).normalize(),this.constant=-t.dot(r),this},translate:function(t){return this.constant-=t.dot(this.normal),this},equals:function(t){return t.normal.equals(this.normal)&&t.constant===this.constant}});var ru=new dt,Kl=new dt,a_=new dt,$l=new dt,Ud=new dt,bd=new dt,EC=new dt,u_=new dt,l_=new dt,h_=new dt;pt(li,{getNormal:function(t,r,i,s){return s===void 0&&(console.warn("THREE.Triangle: .getNormal() target is now required"),s=new dt),s.subVectors(i,r),ru.subVectors(t,r),s.cross(ru),t=s.lengthSq(),0<t?s.multiplyScalar(1/Math.sqrt(t)):s.set(0,0,0)},getBarycoord:function(t,r,i,s,f){ru.subVectors(s,r),Kl.subVectors(i,r),a_.subVectors(t,r),t=ru.dot(ru),r=ru.dot(Kl),i=ru.dot(a_);var c=Kl.dot(Kl);s=Kl.dot(a_);var d=t*c-r*r;return f===void 0&&(console.warn("THREE.Triangle: .getBarycoord() target is now required"),f=new dt),d===0?f.set(-2,-1,-1):(d=1/d,c=(c*i-r*s)*d,t=(t*s-r*i)*d,f.set(1-c-t,t,c))},containsPoint:function(t,r,i,s){return li.getBarycoord(t,r,i,s,$l),0<=$l.x&&0<=$l.y&&1>=$l.x+$l.y},getUV:function(t,r,i,s,f,c,d,p){return this.getBarycoord(t,r,i,s,$l),p.set(0,0),p.addScaledVector(f,$l.x),p.addScaledVector(c,$l.y),p.addScaledVector(d,$l.z),p},isFrontFacing:function(t,r,i,s){return ru.subVectors(i,r),Kl.subVectors(t,r),0>ru.cross(Kl).dot(s)}}),pt(li.prototype,{set:function(t,r,i){return this.a.copy(t),this.b.copy(r),this.c.copy(i),this},setFromPointsAndIndices:function(t,r,i,s){return this.a.copy(t[r]),this.b.copy(t[i]),this.c.copy(t[s]),this},clone:function(){return new this.constructor().copy(this)},copy:function(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this},getArea:function(){return ru.subVectors(this.c,this.b),Kl.subVectors(this.a,this.b),.5*ru.cross(Kl).length()},getMidpoint:function(t){return t===void 0&&(console.warn("THREE.Triangle: .getMidpoint() target is now required"),t=new dt),t.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},getNormal:function(t){return li.getNormal(this.a,this.b,this.c,t)},getPlane:function(t){return t===void 0&&(console.warn("THREE.Triangle: .getPlane() target is now required"),t=new Li),t.setFromCoplanarPoints(this.a,this.b,this.c)},getBarycoord:function(t,r){return li.getBarycoord(t,this.a,this.b,this.c,r)},getUV:function(t,r,i,s,f){return li.getUV(t,this.a,this.b,this.c,r,i,s,f)},containsPoint:function(t){return li.containsPoint(t,this.a,this.b,this.c)},isFrontFacing:function(t){return li.isFrontFacing(this.a,this.b,this.c,t)},intersectsBox:function(t){return t.intersectsTriangle(this)},closestPointToPoint:function(t,r){r===void 0&&(console.warn("THREE.Triangle: .closestPointToPoint() target is now required"),r=new dt);var i=this.a,s=this.b,f=this.c;Ud.subVectors(s,i),bd.subVectors(f,i),u_.subVectors(t,i);var c=Ud.dot(u_),d=bd.dot(u_);if(0>=c&&0>=d)return r.copy(i);l_.subVectors(t,s);var p=Ud.dot(l_),A=bd.dot(l_);if(0<=p&&A<=p)return r.copy(s);var S=c*A-p*d;if(0>=S&&0<=c&&0>=p)return s=c/(c-p),r.copy(i).addScaledVector(Ud,s);h_.subVectors(t,f),t=Ud.dot(h_);var z=bd.dot(h_);return 0<=z&&t<=z?r.copy(f):(c=t*d-c*z,0>=c&&0<=d&&0>=z?(S=d/(d-z),r.copy(i).addScaledVector(bd,S)):(d=p*z-t*A,0>=d&&0<=A-p&&0<=t-z?(EC.subVectors(f,s),S=(A-p)/(A-p+(t-z)),r.copy(s).addScaledVector(EC,S)):(f=1/(d+c+S),s=c*f,S*=f,r.copy(i).addScaledVector(Ud,s).addScaledVector(bd,S))))},equals:function(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)}});var LC={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},iu={h:0,s:0,l:0},Sy={h:0,s:0,l:0};pt(Oe.prototype,{isColor:!0,r:1,g:1,b:1,set:function(t){return t&&t.isColor?this.copy(t):typeof t=="number"?this.setHex(t):typeof t=="string"&&this.setStyle(t),this},setScalar:function(t){return this.b=this.g=this.r=t,this},setHex:function(t){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(t&255)/255,this},setRGB:function(t,r,i){return this.r=t,this.g=r,this.b=i,this},setHSL:function(t,r,i){return t=ti.euclideanModulo(t,1),r=ti.clamp(r,0,1),i=ti.clamp(i,0,1),r===0?this.r=this.g=this.b=i:(r=.5>=i?i*(1+r):i+r-i*r,i=2*i-r,this.r=yn(i,r,t+1/3),this.g=yn(i,r,t),this.b=yn(i,r,t-1/3)),this},setStyle:function(t){function r(d){d!==void 0&&1>parseFloat(d)&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}var i;if(i=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(t)){var s=i[2];switch(i[1]){case"rgb":case"rgba":if(i=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(s))return this.r=Math.min(255,parseInt(i[1],10))/255,this.g=Math.min(255,parseInt(i[2],10))/255,this.b=Math.min(255,parseInt(i[3],10))/255,r(i[5]),this;if(i=/^(\d+)%\s*,\s*(\d+)%\s*,\s*(\d+)%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(s))return this.r=Math.min(100,parseInt(i[1],10))/100,this.g=Math.min(100,parseInt(i[2],10))/100,this.b=Math.min(100,parseInt(i[3],10))/100,r(i[5]),this;break;case"hsl":case"hsla":if(i=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)%\s*,\s*(\d+)%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(s)){s=parseFloat(i[1])/360;var f=parseInt(i[2],10)/100,c=parseInt(i[3],10)/100;return r(i[5]),this.setHSL(s,f,c)}}}else if(i=/^#([A-Fa-f0-9]+)$/.exec(t)){if(i=i[1],s=i.length,s===3)return this.r=parseInt(i.charAt(0)+i.charAt(0),16)/255,this.g=parseInt(i.charAt(1)+i.charAt(1),16)/255,this.b=parseInt(i.charAt(2)+i.charAt(2),16)/255,this;if(s===6)return this.r=parseInt(i.charAt(0)+i.charAt(1),16)/255,this.g=parseInt(i.charAt(2)+i.charAt(3),16)/255,this.b=parseInt(i.charAt(4)+i.charAt(5),16)/255,this}return t&&0<t.length?this.setColorName(t):this},setColorName:function(t){var r=LC[t];return r!==void 0?this.setHex(r):console.warn("THREE.Color: Unknown color "+t),this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(t){return this.r=t.r,this.g=t.g,this.b=t.b,this},copyGammaToLinear:function(t,r){return r===void 0&&(r=2),this.r=Math.pow(t.r,r),this.g=Math.pow(t.g,r),this.b=Math.pow(t.b,r),this},copyLinearToGamma:function(t,r){return r===void 0&&(r=2),r=0<r?1/r:1,this.r=Math.pow(t.r,r),this.g=Math.pow(t.g,r),this.b=Math.pow(t.b,r),this},convertGammaToLinear:function(t){return this.copyGammaToLinear(this,t),this},convertLinearToGamma:function(t){return this.copyLinearToGamma(this,t),this},copySRGBToLinear:function(t){return this.r=Is(t.r),this.g=Is(t.g),this.b=Is(t.b),this},copyLinearToSRGB:function(t){return this.r=Ks(t.r),this.g=Ks(t.g),this.b=Ks(t.b),this},convertSRGBToLinear:function(){return this.copySRGBToLinear(this),this},convertLinearToSRGB:function(){return this.copyLinearToSRGB(this),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(t){t===void 0&&(console.warn("THREE.Color: .getHSL() target is now required"),t={h:0,s:0,l:0});var r=this.r,i=this.g,s=this.b,f=Math.max(r,i,s),c=Math.min(r,i,s),d,p=(c+f)/2;if(c===f)c=d=0;else{var A=f-c;switch(c=.5>=p?A/(f+c):A/(2-f-c),f){case r:d=(i-s)/A+(i<s?6:0);break;case i:d=(s-r)/A+2;break;case s:d=(r-i)/A+4}d/=6}return t.h=d,t.s=c,t.l=p,t},getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function(t,r,i){return this.getHSL(iu),iu.h+=t,iu.s+=r,iu.l+=i,this.setHSL(iu.h,iu.s,iu.l),this},add:function(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this},addColors:function(t,r){return this.r=t.r+r.r,this.g=t.g+r.g,this.b=t.b+r.b,this},addScalar:function(t){return this.r+=t,this.g+=t,this.b+=t,this},sub:function(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this},multiply:function(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this},multiplyScalar:function(t){return this.r*=t,this.g*=t,this.b*=t,this},lerp:function(t,r){return this.r+=(t.r-this.r)*r,this.g+=(t.g-this.g)*r,this.b+=(t.b-this.b)*r,this},lerpHSL:function(t,r){this.getHSL(iu),t.getHSL(Sy),t=ti.lerp(iu.h,Sy.h,r);var i=ti.lerp(iu.s,Sy.s,r);return r=ti.lerp(iu.l,Sy.l,r),this.setHSL(t,i,r),this},equals:function(t){return t.r===this.r&&t.g===this.g&&t.b===this.b},fromArray:function(t,r){return r===void 0&&(r=0),this.r=t[r],this.g=t[r+1],this.b=t[r+2],this},toArray:function(t,r){return t===void 0&&(t=[]),r===void 0&&(r=0),t[r]=this.r,t[r+1]=this.g,t[r+2]=this.b,t},toJSON:function(){return this.getHex()}}),Oe.NAMES=LC,pt(Es.prototype,{clone:function(){return new this.constructor().copy(this)},copy:function(t){this.a=t.a,this.b=t.b,this.c=t.c,this.normal.copy(t.normal),this.color.copy(t.color),this.materialIndex=t.materialIndex;for(var r=0,i=t.vertexNormals.length;r<i;r++)this.vertexNormals[r]=t.vertexNormals[r].clone();for(r=0,i=t.vertexColors.length;r<i;r++)this.vertexColors[r]=t.vertexColors[r].clone();return this}});var XI=0;Rr.prototype=pt(ft(se.prototype),{constructor:Rr,isMaterial:!0,onBeforeCompile:function(){},setValues:function(t){if(t!==void 0)for(var r in t){var i=t[r];if(i===void 0)console.warn("THREE.Material: '"+r+"' parameter is undefined.");else if(r==="shading")console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=i===1;else{var s=this[r];s===void 0?console.warn("THREE."+this.type+": '"+r+"' is not a property of this material."):s&&s.isColor?s.set(i):s&&s.isVector3&&i&&i.isVector3?s.copy(i):this[r]=i}}},toJSON:function(t){function r(f){var c=[],d;for(d in f){var p=f[d];delete p.metadata,c.push(p)}return c}var i=t===void 0||typeof t=="string";i&&(t={textures:{},images:{}});var s={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};return s.uuid=this.uuid,s.type=this.type,this.name!==""&&(s.name=this.name),this.color&&this.color.isColor&&(s.color=this.color.getHex()),this.roughness!==void 0&&(s.roughness=this.roughness),this.metalness!==void 0&&(s.metalness=this.metalness),this.sheen&&this.sheen.isColor&&(s.sheen=this.sheen.getHex()),this.emissive&&this.emissive.isColor&&(s.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(s.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(s.specular=this.specular.getHex()),this.shininess!==void 0&&(s.shininess=this.shininess),this.clearcoat!==void 0&&(s.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(s.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(s.clearcoatMap=this.clearcoatMap.toJSON(t).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(s.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(t).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(s.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(t).uuid,s.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(s.map=this.map.toJSON(t).uuid),this.matcap&&this.matcap.isTexture&&(s.matcap=this.matcap.toJSON(t).uuid),this.alphaMap&&this.alphaMap.isTexture&&(s.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap&&this.lightMap.isTexture&&(s.lightMap=this.lightMap.toJSON(t).uuid),this.aoMap&&this.aoMap.isTexture&&(s.aoMap=this.aoMap.toJSON(t).uuid,s.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(s.bumpMap=this.bumpMap.toJSON(t).uuid,s.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(s.normalMap=this.normalMap.toJSON(t).uuid,s.normalMapType=this.normalMapType,s.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(s.displacementMap=this.displacementMap.toJSON(t).uuid,s.displacementScale=this.displacementScale,s.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(s.roughnessMap=this.roughnessMap.toJSON(t).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(s.metalnessMap=this.metalnessMap.toJSON(t).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(s.emissiveMap=this.emissiveMap.toJSON(t).uuid),this.specularMap&&this.specularMap.isTexture&&(s.specularMap=this.specularMap.toJSON(t).uuid),this.envMap&&this.envMap.isTexture&&(s.envMap=this.envMap.toJSON(t).uuid,s.reflectivity=this.reflectivity,s.refractionRatio=this.refractionRatio,this.combine!==void 0&&(s.combine=this.combine),this.envMapIntensity!==void 0&&(s.envMapIntensity=this.envMapIntensity)),this.gradientMap&&this.gradientMap.isTexture&&(s.gradientMap=this.gradientMap.toJSON(t).uuid),this.size!==void 0&&(s.size=this.size),this.sizeAttenuation!==void 0&&(s.sizeAttenuation=this.sizeAttenuation),this.blending!==1&&(s.blending=this.blending),this.flatShading===!0&&(s.flatShading=this.flatShading),this.side!==0&&(s.side=this.side),this.vertexColors&&(s.vertexColors=!0),1>this.opacity&&(s.opacity=this.opacity),this.transparent===!0&&(s.transparent=this.transparent),s.depthFunc=this.depthFunc,s.depthTest=this.depthTest,s.depthWrite=this.depthWrite,s.stencilWrite=this.stencilWrite,s.stencilWriteMask=this.stencilWriteMask,s.stencilFunc=this.stencilFunc,s.stencilRef=this.stencilRef,s.stencilFuncMask=this.stencilFuncMask,s.stencilFail=this.stencilFail,s.stencilZFail=this.stencilZFail,s.stencilZPass=this.stencilZPass,this.rotation&&this.rotation!==0&&(s.rotation=this.rotation),this.polygonOffset===!0&&(s.polygonOffset=!0),this.polygonOffsetFactor!==0&&(s.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(s.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth&&this.linewidth!==1&&(s.linewidth=this.linewidth),this.dashSize!==void 0&&(s.dashSize=this.dashSize),this.gapSize!==void 0&&(s.gapSize=this.gapSize),this.scale!==void 0&&(s.scale=this.scale),this.dithering===!0&&(s.dithering=!0),0<this.alphaTest&&(s.alphaTest=this.alphaTest),this.premultipliedAlpha===!0&&(s.premultipliedAlpha=this.premultipliedAlpha),this.wireframe===!0&&(s.wireframe=this.wireframe),1<this.wireframeLinewidth&&(s.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(s.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(s.wireframeLinejoin=this.wireframeLinejoin),this.morphTargets===!0&&(s.morphTargets=!0),this.morphNormals===!0&&(s.morphNormals=!0),this.skinning===!0&&(s.skinning=!0),this.visible===!1&&(s.visible=!1),this.toneMapped===!1&&(s.toneMapped=!1),Hs(this.userData)!=="{}"&&(s.userData=this.userData),i&&(i=r(t.textures),t=r(t.images),0<i.length&&(s.textures=i),0<t.length&&(s.images=t)),s},clone:function(){return new this.constructor().copy(this)},copy:function(t){this.name=t.name,this.fog=t.fog,this.blending=t.blending,this.side=t.side,this.flatShading=t.flatShading,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.stencilWriteMask=t.stencilWriteMask,this.stencilFunc=t.stencilFunc,this.stencilRef=t.stencilRef,this.stencilFuncMask=t.stencilFuncMask,this.stencilFail=t.stencilFail,this.stencilZFail=t.stencilZFail,this.stencilZPass=t.stencilZPass,this.stencilWrite=t.stencilWrite;var r=t.clippingPlanes,i=null;if(r!==null){var s=r.length;i=Array(s);for(var f=0;f!==s;++f)i[f]=r[f].clone()}return this.clippingPlanes=i,this.clipIntersection=t.clipIntersection,this.clipShadows=t.clipShadows,this.shadowSide=t.shadowSide,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.dithering=t.dithering,this.alphaTest=t.alphaTest,this.premultipliedAlpha=t.premultipliedAlpha,this.visible=t.visible,this.toneMapped=t.toneMapped,this.userData=JSON.parse(Hs(t.userData)),this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Object.defineProperty(Rr.prototype,"needsUpdate",{set:function(t){t===!0&&this.version++}}),Nn.prototype=ft(Rr.prototype),Nn.prototype.constructor=Nn,Nn.prototype.isMeshBasicMaterial=!0,Nn.prototype.copy=function(t){return Rr.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this};var qi=new dt;Object.defineProperty(wr.prototype,"needsUpdate",{set:function(t){t===!0&&this.version++}}),pt(wr.prototype,{isBufferAttribute:!0,onUploadCallback:function(){},setUsage:function(t){return this.usage=t,this},copy:function(t){return this.name=t.name,this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.usage=t.usage,this},copyAt:function(t,r,i){t*=this.itemSize,i*=r.itemSize;for(var s=0,f=this.itemSize;s<f;s++)this.array[t+s]=r.array[i+s];return this},copyArray:function(t){return this.array.set(t),this},copyColorsArray:function(t){for(var r=this.array,i=0,s=0,f=t.length;s<f;s++){var c=t[s];c===void 0&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",s),c=new Oe),r[i++]=c.r,r[i++]=c.g,r[i++]=c.b}return this},copyVector2sArray:function(t){for(var r=this.array,i=0,s=0,f=t.length;s<f;s++){var c=t[s];c===void 0&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",s),c=new Ot),r[i++]=c.x,r[i++]=c.y}return this},copyVector3sArray:function(t){for(var r=this.array,i=0,s=0,f=t.length;s<f;s++){var c=t[s];c===void 0&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",s),c=new dt),r[i++]=c.x,r[i++]=c.y,r[i++]=c.z}return this},copyVector4sArray:function(t){for(var r=this.array,i=0,s=0,f=t.length;s<f;s++){var c=t[s];c===void 0&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",s),c=new jt),r[i++]=c.x,r[i++]=c.y,r[i++]=c.z,r[i++]=c.w}return this},applyMatrix3:function(t){for(var r=0,i=this.count;r<i;r++)qi.x=this.getX(r),qi.y=this.getY(r),qi.z=this.getZ(r),qi.applyMatrix3(t),this.setXYZ(r,qi.x,qi.y,qi.z);return this},applyMatrix4:function(t){for(var r=0,i=this.count;r<i;r++)qi.x=this.getX(r),qi.y=this.getY(r),qi.z=this.getZ(r),qi.applyMatrix4(t),this.setXYZ(r,qi.x,qi.y,qi.z);return this},applyNormalMatrix:function(t){for(var r=0,i=this.count;r<i;r++)qi.x=this.getX(r),qi.y=this.getY(r),qi.z=this.getZ(r),qi.applyNormalMatrix(t),this.setXYZ(r,qi.x,qi.y,qi.z);return this},transformDirection:function(t){for(var r=0,i=this.count;r<i;r++)qi.x=this.getX(r),qi.y=this.getY(r),qi.z=this.getZ(r),qi.transformDirection(t),this.setXYZ(r,qi.x,qi.y,qi.z);return this},set:function(t,r){return r===void 0&&(r=0),this.array.set(t,r),this},getX:function(t){return this.array[t*this.itemSize]},setX:function(t,r){return this.array[t*this.itemSize]=r,this},getY:function(t){return this.array[t*this.itemSize+1]},setY:function(t,r){return this.array[t*this.itemSize+1]=r,this},getZ:function(t){return this.array[t*this.itemSize+2]},setZ:function(t,r){return this.array[t*this.itemSize+2]=r,this},getW:function(t){return this.array[t*this.itemSize+3]},setW:function(t,r){return this.array[t*this.itemSize+3]=r,this},setXY:function(t,r,i){return t*=this.itemSize,this.array[t+0]=r,this.array[t+1]=i,this},setXYZ:function(t,r,i,s){return t*=this.itemSize,this.array[t+0]=r,this.array[t+1]=i,this.array[t+2]=s,this},setXYZW:function(t,r,i,s,f){return t*=this.itemSize,this.array[t+0]=r,this.array[t+1]=i,this.array[t+2]=s,this.array[t+3]=f,this},onUpload:function(t){return this.onUploadCallback=t,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)},toJSON:function(){return{itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized}}}),og.prototype=ft(wr.prototype),og.prototype.constructor=og,vl.prototype=ft(wr.prototype),vl.prototype.constructor=vl,Yc.prototype=ft(wr.prototype),Yc.prototype.constructor=Yc,sg.prototype=ft(wr.prototype),sg.prototype.constructor=sg,Ra.prototype=ft(wr.prototype),Ra.prototype.constructor=Ra,Zc.prototype=ft(wr.prototype),Zc.prototype.constructor=Zc,wh.prototype=ft(wr.prototype),wh.prototype.constructor=wh,Ge.prototype=ft(wr.prototype),Ge.prototype.constructor=Ge,xn.prototype=ft(wr.prototype),xn.prototype.constructor=xn,pt($s.prototype,{computeGroups:function(t){var r=[],i=void 0;t=t.faces;for(var s=0;s<t.length;s++){var f=t[s];if(f.materialIndex!==i){i=f.materialIndex,c!==void 0&&(c.count=3*s-c.start,r.push(c));var c={start:3*s,materialIndex:i}}}c!==void 0&&(c.count=3*s-c.start,r.push(c)),this.groups=r},fromGeometry:function(t){var r=t.faces,i=t.vertices,s=t.faceVertexUvs,f=s[0]&&0<s[0].length,c=s[1]&&0<s[1].length,d=t.morphTargets,p=d.length;if(0<p){for(var A=[],S=0;S<p;S++)A[S]={name:d[S].name,data:[]};this.morphTargets.position=A}var z=t.morphNormals,w=z.length;if(0<w){var I=[];for(S=0;S<w;S++)I[S]={name:z[S].name,data:[]};this.morphTargets.normal=I}var E=t.skinIndices,P=t.skinWeights,F=E.length===i.length,X=P.length===i.length;for(0<i.length&&r.length===0&&console.error("THREE.DirectGeometry: Faceless geometries are not supported."),S=0;S<r.length;S++){var q=r[S];this.vertices.push(i[q.a],i[q.b],i[q.c]);var J=q.vertexNormals;for(J.length===3?this.normals.push(J[0],J[1],J[2]):(J=q.normal,this.normals.push(J,J,J)),J=q.vertexColors,J.length===3?this.colors.push(J[0],J[1],J[2]):(J=q.color,this.colors.push(J,J,J)),f===!0&&(J=s[0][S],J!==void 0?this.uvs.push(J[0],J[1],J[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",S),this.uvs.push(new Ot,new Ot,new Ot))),c===!0&&(J=s[1][S],J!==void 0?this.uvs2.push(J[0],J[1],J[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",S),this.uvs2.push(new Ot,new Ot,new Ot))),J=0;J<p;J++){var it=d[J].vertices;A[J].data.push(it[q.a],it[q.b],it[q.c])}for(J=0;J<w;J++)it=z[J].vertexNormals[S],I[J].data.push(it.a,it.b,it.c);F&&this.skinIndices.push(E[q.a],E[q.b],E[q.c]),X&&this.skinWeights.push(P[q.a],P[q.b],P[q.c])}return this.computeGroups(t),this.verticesNeedUpdate=t.verticesNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,t.boundingSphere!==null&&(this.boundingSphere=t.boundingSphere.clone()),t.boundingBox!==null&&(this.boundingBox=t.boundingBox.clone()),this}});var YI=1,Ku=new Me,c_=new fe,kd=new dt,Gs=new ui,Cv=new ui,qn=new dt;ke.prototype=pt(ft(se.prototype),{constructor:ke,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(t){Array.isArray(t)?this.index=new(65535<ag(t)?wh:Ra)(t,1):this.index=t},getAttribute:function(t){return this.attributes[t]},setAttribute:function(t,r){return this.attributes[t]=r,this},deleteAttribute:function(t){return delete this.attributes[t],this},addGroup:function(t,r,i){this.groups.push({start:t,count:r,materialIndex:i!==void 0?i:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(t,r){this.drawRange.start=t,this.drawRange.count=r},applyMatrix4:function(t){var r=this.attributes.position;if(r!==void 0&&(r.applyMatrix4(t),r.needsUpdate=!0),r=this.attributes.normal,r!==void 0){var i=new Jt().getNormalMatrix(t);r.applyNormalMatrix(i),r.needsUpdate=!0}return r=this.attributes.tangent,r!==void 0&&(r.transformDirection(t),r.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this},rotateX:function(t){return Ku.makeRotationX(t),this.applyMatrix4(Ku),this},rotateY:function(t){return Ku.makeRotationY(t),this.applyMatrix4(Ku),this},rotateZ:function(t){return Ku.makeRotationZ(t),this.applyMatrix4(Ku),this},translate:function(t,r,i){return Ku.makeTranslation(t,r,i),this.applyMatrix4(Ku),this},scale:function(t,r,i){return Ku.makeScale(t,r,i),this.applyMatrix4(Ku),this},lookAt:function(t){return c_.lookAt(t),c_.updateMatrix(),this.applyMatrix4(c_.matrix),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(kd).negate(),this.translate(kd.x,kd.y,kd.z),this},setFromObject:function(t){var r=t.geometry;if(t.isPoints||t.isLine){t=new Ge(3*r.vertices.length,3);var i=new Ge(3*r.colors.length,3);this.setAttribute("position",t.copyVector3sArray(r.vertices)),this.setAttribute("color",i.copyColorsArray(r.colors)),r.lineDistances&&r.lineDistances.length===r.vertices.length&&(t=new Ge(r.lineDistances.length,1),this.setAttribute("lineDistance",t.copyArray(r.lineDistances))),r.boundingSphere!==null&&(this.boundingSphere=r.boundingSphere.clone()),r.boundingBox!==null&&(this.boundingBox=r.boundingBox.clone())}else t.isMesh&&r&&r.isGeometry&&this.fromGeometry(r);return this},setFromPoints:function(t){for(var r=[],i=0,s=t.length;i<s;i++){var f=t[i];r.push(f.x,f.y,f.z||0)}return this.setAttribute("position",new Ge(r,3)),this},updateFromObject:function(t){var r=t.geometry;if(t.isMesh){var i=r.__directGeometry;if(r.elementsNeedUpdate===!0&&(i=void 0,r.elementsNeedUpdate=!1),i===void 0)return this.fromGeometry(r);i.verticesNeedUpdate=r.verticesNeedUpdate,i.normalsNeedUpdate=r.normalsNeedUpdate,i.colorsNeedUpdate=r.colorsNeedUpdate,i.uvsNeedUpdate=r.uvsNeedUpdate,i.groupsNeedUpdate=r.groupsNeedUpdate,r.verticesNeedUpdate=!1,r.normalsNeedUpdate=!1,r.colorsNeedUpdate=!1,r.uvsNeedUpdate=!1,r.groupsNeedUpdate=!1,r=i}return r.verticesNeedUpdate===!0&&(i=this.attributes.position,i!==void 0&&(i.copyVector3sArray(r.vertices),i.needsUpdate=!0),r.verticesNeedUpdate=!1),r.normalsNeedUpdate===!0&&(i=this.attributes.normal,i!==void 0&&(i.copyVector3sArray(r.normals),i.needsUpdate=!0),r.normalsNeedUpdate=!1),r.colorsNeedUpdate===!0&&(i=this.attributes.color,i!==void 0&&(i.copyColorsArray(r.colors),i.needsUpdate=!0),r.colorsNeedUpdate=!1),r.uvsNeedUpdate&&(i=this.attributes.uv,i!==void 0&&(i.copyVector2sArray(r.uvs),i.needsUpdate=!0),r.uvsNeedUpdate=!1),r.lineDistancesNeedUpdate&&(i=this.attributes.lineDistance,i!==void 0&&(i.copyArray(r.lineDistances),i.needsUpdate=!0),r.lineDistancesNeedUpdate=!1),r.groupsNeedUpdate&&(r.computeGroups(t.geometry),this.groups=r.groups,r.groupsNeedUpdate=!1),this},fromGeometry:function(t){return t.__directGeometry=new $s().fromGeometry(t),this.fromDirectGeometry(t.__directGeometry)},fromDirectGeometry:function(t){var r=new Float32Array(3*t.vertices.length);this.setAttribute("position",new wr(r,3).copyVector3sArray(t.vertices)),0<t.normals.length&&(r=new Float32Array(3*t.normals.length),this.setAttribute("normal",new wr(r,3).copyVector3sArray(t.normals))),0<t.colors.length&&(r=new Float32Array(3*t.colors.length),this.setAttribute("color",new wr(r,3).copyColorsArray(t.colors))),0<t.uvs.length&&(r=new Float32Array(2*t.uvs.length),this.setAttribute("uv",new wr(r,2).copyVector2sArray(t.uvs))),0<t.uvs2.length&&(r=new Float32Array(2*t.uvs2.length),this.setAttribute("uv2",new wr(r,2).copyVector2sArray(t.uvs2))),this.groups=t.groups;for(var i in t.morphTargets){r=[];for(var s=t.morphTargets[i],f=0,c=s.length;f<c;f++){var d=s[f],p=new Ge(3*d.data.length,3);p.name=d.name,r.push(p.copyVector3sArray(d.data))}this.morphAttributes[i]=r}return 0<t.skinIndices.length&&(i=new Ge(4*t.skinIndices.length,4),this.setAttribute("skinIndex",i.copyVector4sArray(t.skinIndices))),0<t.skinWeights.length&&(i=new Ge(4*t.skinWeights.length,4),this.setAttribute("skinWeight",i.copyVector4sArray(t.skinWeights))),t.boundingSphere!==null&&(this.boundingSphere=t.boundingSphere.clone()),t.boundingBox!==null&&(this.boundingBox=t.boundingBox.clone()),this},computeBoundingBox:function(){this.boundingBox===null&&(this.boundingBox=new ui);var t=this.attributes.position,r=this.morphAttributes.position;if(t!==void 0){if(this.boundingBox.setFromBufferAttribute(t),r){t=0;for(var i=r.length;t<i;t++)Gs.setFromBufferAttribute(r[t]),this.morphTargetsRelative?(qn.addVectors(this.boundingBox.min,Gs.min),this.boundingBox.expandByPoint(qn),qn.addVectors(this.boundingBox.max,Gs.max),this.boundingBox.expandByPoint(qn)):(this.boundingBox.expandByPoint(Gs.min),this.boundingBox.expandByPoint(Gs.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:function(){this.boundingSphere===null&&(this.boundingSphere=new fn);var t=this.attributes.position,r=this.morphAttributes.position;if(t){var i=this.boundingSphere.center;if(Gs.setFromBufferAttribute(t),r)for(var s=0,f=r.length;s<f;s++){var c=r[s];Cv.setFromBufferAttribute(c),this.morphTargetsRelative?(qn.addVectors(Gs.min,Cv.min),Gs.expandByPoint(qn),qn.addVectors(Gs.max,Cv.max),Gs.expandByPoint(qn)):(Gs.expandByPoint(Cv.min),Gs.expandByPoint(Cv.max))}Gs.getCenter(i);var d=0;for(s=0,f=t.count;s<f;s++)qn.fromBufferAttribute(t,s),d=Math.max(d,i.distanceToSquared(qn));if(r)for(s=0,f=r.length;s<f;s++){c=r[s];for(var p=this.morphTargetsRelative,A=0,S=c.count;A<S;A++)qn.fromBufferAttribute(c,A),p&&(kd.fromBufferAttribute(t,A),qn.add(kd)),d=Math.max(d,i.distanceToSquared(qn))}this.boundingSphere.radius=Math.sqrt(d),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}},computeFaceNormals:function(){},computeVertexNormals:function(){var t=this.index,r=this.attributes;if(r.position){var i=r.position.array;if(r.normal===void 0)this.setAttribute("normal",new wr(new Float32Array(i.length),3));else for(var s=r.normal.array,f=0,c=s.length;f<c;f++)s[f]=0;s=r.normal.array;var d=new dt,p=new dt,A=new dt,S=new dt,z=new dt;if(t){var w=t.array;for(f=0,c=t.count;f<c;f+=3){t=3*w[f+0];var I=3*w[f+1],E=3*w[f+2];d.fromArray(i,t),p.fromArray(i,I),A.fromArray(i,E),S.subVectors(A,p),z.subVectors(d,p),S.cross(z),s[t]+=S.x,s[t+1]+=S.y,s[t+2]+=S.z,s[I]+=S.x,s[I+1]+=S.y,s[I+2]+=S.z,s[E]+=S.x,s[E+1]+=S.y,s[E+2]+=S.z}}else for(f=0,c=i.length;f<c;f+=9)d.fromArray(i,f),p.fromArray(i,f+3),A.fromArray(i,f+6),S.subVectors(A,p),z.subVectors(d,p),S.cross(z),s[f]=S.x,s[f+1]=S.y,s[f+2]=S.z,s[f+3]=S.x,s[f+4]=S.y,s[f+5]=S.z,s[f+6]=S.x,s[f+7]=S.y,s[f+8]=S.z;this.normalizeNormals(),r.normal.needsUpdate=!0}},merge:function(t,r){if(t&&t.isBufferGeometry){r===void 0&&(r=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));var i=this.attributes,s;for(s in i)if(t.attributes[s]!==void 0){var f=i[s].array,c=t.attributes[s],d=c.array,p=c.itemSize*r;c=Math.min(d.length,f.length-p);for(var A=0;A<c;A++,p++)f[p]=d[A]}return this}console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",t)},normalizeNormals:function(){for(var t=this.attributes.normal,r=0,i=t.count;r<i;r++)qn.x=t.getX(r),qn.y=t.getY(r),qn.z=t.getZ(r),qn.normalize(),t.setXYZ(r,qn.x,qn.y,qn.z)},toNonIndexed:function(){function t(z,w){var I=z.array,E=z.itemSize;z=z.normalized;for(var P=new I.constructor(w.length*E),F,X=0,q=0,J=w.length;q<J;q++){F=w[q]*E;for(var it=0;it<E;it++)P[X++]=I[F++]}return new wr(P,E,z)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed."),this;var r=new ke,i=this.index.array,s=this.attributes,f;for(f in s){var c=s[f];c=t(c,i),r.setAttribute(f,c)}var d=this.morphAttributes;for(f in d){var p=[],A=d[f];s=0;for(var S=A.length;s<S;s++)c=A[s],c=t(c,i),p.push(c);r.morphAttributes[f]=p}for(r.morphTargetsRelative=this.morphTargetsRelative,i=this.groups,s=0,f=i.length;s<f;s++)c=i[s],r.addGroup(c.start,c.count,c.materialIndex);return r},toJSON:function(){var t={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,this.name!==""&&(t.name=this.name),0<Ti(this.userData).length&&(t.userData=this.userData),this.parameters!==void 0){var r=this.parameters;for(S in r)r[S]!==void 0&&(t[S]=r[S]);return t}t.data={attributes:{}},r=this.index,r!==null&&(t.data.index={type:r.array.constructor.name,array:Array.prototype.slice.call(r.array)});var i=this.attributes;for(S in i){r=i[S];var s=r.toJSON();r.name!==""&&(s.name=r.name),t.data.attributes[S]=s}i={};var f=!1;for(S in this.morphAttributes){for(var c=this.morphAttributes[S],d=[],p=0,A=c.length;p<A;p++)r=c[p],s=r.toJSON(),r.name!==""&&(s.name=r.name),d.push(s);0<d.length&&(i[S]=d,f=!0)}f&&(t.data.morphAttributes=i,t.data.morphTargetsRelative=this.morphTargetsRelative);var S=this.groups;return 0<S.length&&(t.data.groups=JSON.parse(Hs(S))),S=this.boundingSphere,S!==null&&(t.data.boundingSphere={center:S.center.toArray(),radius:S.radius}),t},clone:function(){return new ke().copy(this)},copy:function(t){var r;this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingSphere=this.boundingBox=null,this.name=t.name;var i=t.index;i!==null&&this.setIndex(i.clone()),i=t.attributes;for(d in i)this.setAttribute(d,i[d].clone());var s=t.morphAttributes;for(d in s){var f=[],c=s[d];for(i=0,r=c.length;i<r;i++)f.push(c[i].clone());this.morphAttributes[d]=f}this.morphTargetsRelative=t.morphTargetsRelative;var d=t.groups;for(i=0,r=d.length;i<r;i++)s=d[i],this.addGroup(s.start,s.count,s.materialIndex);return d=t.boundingBox,d!==null&&(this.boundingBox=d.clone()),d=t.boundingSphere,d!==null&&(this.boundingSphere=d.clone()),this.drawRange.start=t.drawRange.start,this.drawRange.count=t.drawRange.count,this.userData=t.userData,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});var RC=new Me,sp=new Ln,f_=new fn,pc=new dt,dc=new dt,mc=new dt,p_=new dt,d_=new dt,m_=new dt,Iy=new dt,Ey=new dt,Ly=new dt,Hd=new Ot,Gd=new Ot,Vd=new Ot,Tv=new dt,Ry=new dt;Zi.prototype=pt(ft(fe.prototype),{constructor:Zi,isMesh:!0,copy:function(t){return fe.prototype.copy.call(this,t),t.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=t.morphTargetInfluences.slice()),t.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=pt({},t.morphTargetDictionary)),this},updateMorphTargets:function(){var t=this.geometry;if(t.isBufferGeometry){t=t.morphAttributes;var r=Ti(t);if(0<r.length){var i=t[r[0]];if(i!==void 0)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},t=0,r=i.length;t<r;t++){var s=i[t].name||String(t);this.morphTargetInfluences.push(0),this.morphTargetDictionary[s]=t}}}else t=t.morphTargets,t!==void 0&&0<t.length&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")},raycast:function(t,r){var i=this.geometry,s=this.material,f=this.matrixWorld;if(s!==void 0&&(i.boundingSphere===null&&i.computeBoundingSphere(),f_.copy(i.boundingSphere),f_.applyMatrix4(f),t.ray.intersectsSphere(f_)!==!1&&(RC.getInverse(f),sp.copy(t.ray).applyMatrix4(RC),i.boundingBox===null||sp.intersectsBox(i.boundingBox)!==!1))){if(i.isBufferGeometry){var c=i.index;f=i.attributes.position;var d=i.morphAttributes.position,p=i.morphTargetsRelative,A=i.attributes.uv,S=i.attributes.uv2,z=i.groups,w=i.drawRange,I,E;if(c!==null)if(Array.isArray(s)){var P=0;for(I=z.length;P<I;P++){var F=z[P],X=s[F.materialIndex],q=Math.max(F.start,w.start);for(E=i=Math.min(F.start+F.count,w.start+w.count);q<E;q+=3){i=c.getX(q);var J=c.getX(q+1),it=c.getX(q+2);(i=Cu(this,X,t,sp,f,d,p,A,S,i,J,it))&&(i.faceIndex=Math.floor(q/3),i.face.materialIndex=F.materialIndex,r.push(i))}}}else for(q=Math.max(0,w.start),i=Math.min(c.count,w.start+w.count),P=q,I=i;P<I;P+=3)i=c.getX(P),J=c.getX(P+1),it=c.getX(P+2),(i=Cu(this,s,t,sp,f,d,p,A,S,i,J,it))&&(i.faceIndex=Math.floor(P/3),r.push(i));else if(f!==void 0)if(Array.isArray(s))for(P=0,I=z.length;P<I;P++)for(F=z[P],X=s[F.materialIndex],q=Math.max(F.start,w.start),E=i=Math.min(F.start+F.count,w.start+w.count);q<E;q+=3)i=q,J=q+1,it=q+2,(i=Cu(this,X,t,sp,f,d,p,A,S,i,J,it))&&(i.faceIndex=Math.floor(q/3),i.face.materialIndex=F.materialIndex,r.push(i));else for(q=Math.max(0,w.start),i=Math.min(f.count,w.start+w.count),P=q,I=i;P<I;P+=3)i=P,J=P+1,it=P+2,(i=Cu(this,s,t,sp,f,d,p,A,S,i,J,it))&&(i.faceIndex=Math.floor(P/3),r.push(i))}else if(i.isGeometry)for(f=Array.isArray(s),d=i.vertices,p=i.faces,i=i.faceVertexUvs[0],0<i.length&&(c=i),w=0,P=p.length;w<P;w++)I=p[w],i=f?s[I.materialIndex]:s,i!==void 0&&(A=d[I.a],S=d[I.b],z=d[I.c],i=Pa(this,i,t,sp,A,S,z,Tv))&&(c&&c[w]&&(F=c[w],Hd.copy(F[0]),Gd.copy(F[1]),Vd.copy(F[2]),i.uv=li.getUV(Tv,A,S,z,Hd,Gd,Vd,new Ot)),i.face=I,i.faceIndex=w,r.push(i))}},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});var ZI=0,$u=new Me,g_=new fe,Py=new dt;Gr.prototype=pt(ft(se.prototype),{constructor:Gr,isGeometry:!0,applyMatrix4:function(t){for(var r=new Jt().getNormalMatrix(t),i=0,s=this.vertices.length;i<s;i++)this.vertices[i].applyMatrix4(t);for(i=0,s=this.faces.length;i<s;i++){t=this.faces[i],t.normal.applyMatrix3(r).normalize();for(var f=0,c=t.vertexNormals.length;f<c;f++)t.vertexNormals[f].applyMatrix3(r).normalize()}return this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this.normalsNeedUpdate=this.verticesNeedUpdate=!0,this},rotateX:function(t){return $u.makeRotationX(t),this.applyMatrix4($u),this},rotateY:function(t){return $u.makeRotationY(t),this.applyMatrix4($u),this},rotateZ:function(t){return $u.makeRotationZ(t),this.applyMatrix4($u),this},translate:function(t,r,i){return $u.makeTranslation(t,r,i),this.applyMatrix4($u),this},scale:function(t,r,i){return $u.makeScale(t,r,i),this.applyMatrix4($u),this},lookAt:function(t){return g_.lookAt(t),g_.updateMatrix(),this.applyMatrix4(g_.matrix),this},fromBufferGeometry:function(t){function r(E,P,F,X){var q=p===void 0?[]:[i.colors[E].clone(),i.colors[P].clone(),i.colors[F].clone()],J=d===void 0?[]:[new dt().fromArray(d,3*E),new dt().fromArray(d,3*P),new dt().fromArray(d,3*F)];X=new Es(E,P,F,J,q,X),i.faces.push(X),A!==void 0&&i.faceVertexUvs[0].push([new Ot().fromArray(A,2*E),new Ot().fromArray(A,2*P),new Ot().fromArray(A,2*F)]),S!==void 0&&i.faceVertexUvs[1].push([new Ot().fromArray(S,2*E),new Ot().fromArray(S,2*P),new Ot().fromArray(S,2*F)])}var i=this,s=t.index!==null?t.index.array:void 0,f=t.attributes;if(f.position===void 0)return console.error("THREE.Geometry.fromBufferGeometry(): Position attribute required for conversion."),this;var c=f.position.array,d=f.normal!==void 0?f.normal.array:void 0,p=f.color!==void 0?f.color.array:void 0,A=f.uv!==void 0?f.uv.array:void 0,S=f.uv2!==void 0?f.uv2.array:void 0;for(S!==void 0&&(this.faceVertexUvs[1]=[]),f=0;f<c.length;f+=3)i.vertices.push(new dt().fromArray(c,f)),p!==void 0&&i.colors.push(new Oe().fromArray(p,f));var z=t.groups;if(0<z.length)for(f=0;f<z.length;f++){c=z[f];var w=c.start,I=w;for(w+=c.count;I<w;I+=3)s!==void 0?r(s[I],s[I+1],s[I+2],c.materialIndex):r(I,I+1,I+2,c.materialIndex)}else if(s!==void 0)for(f=0;f<s.length;f+=3)r(s[f],s[f+1],s[f+2]);else for(f=0;f<c.length/3;f+=3)r(f,f+1,f+2);return this.computeFaceNormals(),t.boundingBox!==null&&(this.boundingBox=t.boundingBox.clone()),t.boundingSphere!==null&&(this.boundingSphere=t.boundingSphere.clone()),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(Py).negate(),this.translate(Py.x,Py.y,Py.z),this},normalize:function(){this.computeBoundingSphere();var t=this.boundingSphere.center,r=this.boundingSphere.radius;r=r===0?1:1/r;var i=new Me;return i.set(r,0,0,-r*t.x,0,r,0,-r*t.y,0,0,r,-r*t.z,0,0,0,1),this.applyMatrix4(i),this},computeFaceNormals:function(){for(var t=new dt,r=new dt,i=0,s=this.faces.length;i<s;i++){var f=this.faces[i],c=this.vertices[f.a],d=this.vertices[f.b];t.subVectors(this.vertices[f.c],d),r.subVectors(c,d),t.cross(r),t.normalize(),f.normal.copy(t)}},computeVertexNormals:function(t){t===void 0&&(t=!0);var r,i=Array(this.vertices.length),s=0;for(r=this.vertices.length;s<r;s++)i[s]=new dt;if(t){var f=new dt,c=new dt;for(t=0,s=this.faces.length;t<s;t++){r=this.faces[t];var d=this.vertices[r.a],p=this.vertices[r.b],A=this.vertices[r.c];f.subVectors(A,p),c.subVectors(d,p),f.cross(c),i[r.a].add(f),i[r.b].add(f),i[r.c].add(f)}}else for(this.computeFaceNormals(),t=0,s=this.faces.length;t<s;t++)r=this.faces[t],i[r.a].add(r.normal),i[r.b].add(r.normal),i[r.c].add(r.normal);for(s=0,r=this.vertices.length;s<r;s++)i[s].normalize();for(t=0,s=this.faces.length;t<s;t++)r=this.faces[t],d=r.vertexNormals,d.length===3?(d[0].copy(i[r.a]),d[1].copy(i[r.b]),d[2].copy(i[r.c])):(d[0]=i[r.a].clone(),d[1]=i[r.b].clone(),d[2]=i[r.c].clone());0<this.faces.length&&(this.normalsNeedUpdate=!0)},computeFlatVertexNormals:function(){var t;this.computeFaceNormals();var r=0;for(t=this.faces.length;r<t;r++){var i=this.faces[r],s=i.vertexNormals;s.length===3?(s[0].copy(i.normal),s[1].copy(i.normal),s[2].copy(i.normal)):(s[0]=i.normal.clone(),s[1]=i.normal.clone(),s[2]=i.normal.clone())}0<this.faces.length&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function(){var t,r,i=0;for(r=this.faces.length;i<r;i++){var s=this.faces[i];s.__originalFaceNormal?s.__originalFaceNormal.copy(s.normal):s.__originalFaceNormal=s.normal.clone(),s.__originalVertexNormals||(s.__originalVertexNormals=[]);var f=0;for(t=s.vertexNormals.length;f<t;f++)s.__originalVertexNormals[f]?s.__originalVertexNormals[f].copy(s.vertexNormals[f]):s.__originalVertexNormals[f]=s.vertexNormals[f].clone()}var c=new Gr;for(c.faces=this.faces,f=0,t=this.morphTargets.length;f<t;f++){if(!this.morphNormals[f]){this.morphNormals[f]={},this.morphNormals[f].faceNormals=[],this.morphNormals[f].vertexNormals=[],s=this.morphNormals[f].faceNormals;var d=this.morphNormals[f].vertexNormals;for(i=0,r=this.faces.length;i<r;i++){var p=new dt,A={a:new dt,b:new dt,c:new dt};s.push(p),d.push(A)}}for(d=this.morphNormals[f],c.vertices=this.morphTargets[f].vertices,c.computeFaceNormals(),c.computeVertexNormals(),i=0,r=this.faces.length;i<r;i++)s=this.faces[i],p=d.faceNormals[i],A=d.vertexNormals[i],p.copy(s.normal),A.a.copy(s.vertexNormals[0]),A.b.copy(s.vertexNormals[1]),A.c.copy(s.vertexNormals[2])}for(i=0,r=this.faces.length;i<r;i++)s=this.faces[i],s.normal=s.__originalFaceNormal,s.vertexNormals=s.__originalVertexNormals},computeBoundingBox:function(){this.boundingBox===null&&(this.boundingBox=new ui),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){this.boundingSphere===null&&(this.boundingSphere=new fn),this.boundingSphere.setFromPoints(this.vertices)},merge:function(t,r,i){if(t&&t.isGeometry){var s,f=this.vertices.length,c=this.vertices,d=t.vertices,p=this.faces,A=t.faces,S=this.colors,z=t.colors;i===void 0&&(i=0),r!==void 0&&(s=new Jt().getNormalMatrix(r));for(var w=0,I=d.length;w<I;w++){var E=d[w].clone();r!==void 0&&E.applyMatrix4(r),c.push(E)}for(w=0,I=z.length;w<I;w++)S.push(z[w].clone());for(w=0,I=A.length;w<I;w++){d=A[w];var P=d.vertexNormals;for(z=d.vertexColors,S=new Es(d.a+f,d.b+f,d.c+f),S.normal.copy(d.normal),s!==void 0&&S.normal.applyMatrix3(s).normalize(),r=0,c=P.length;r<c;r++)E=P[r].clone(),s!==void 0&&E.applyMatrix3(s).normalize(),S.vertexNormals.push(E);for(S.color.copy(d.color),r=0,c=z.length;r<c;r++)E=z[r],S.vertexColors.push(E.clone());S.materialIndex=d.materialIndex+i,p.push(S)}for(w=0,I=t.faceVertexUvs.length;w<I;w++)for(i=t.faceVertexUvs[w],this.faceVertexUvs[w]===void 0&&(this.faceVertexUvs[w]=[]),r=0,c=i.length;r<c;r++){for(s=i[r],f=[],p=0,A=s.length;p<A;p++)f.push(s[p].clone());this.faceVertexUvs[w].push(f)}}else console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",t)},mergeMesh:function(t){t&&t.isMesh?(t.matrixAutoUpdate&&t.updateMatrix(),this.merge(t.geometry,t.matrix)):console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",t)},mergeVertices:function(){var t={},r=[],i=[],s=Math.pow(10,4),f,c=0;for(f=this.vertices.length;c<f;c++){var d=this.vertices[c];d=Math.round(d.x*s)+"_"+Math.round(d.y*s)+"_"+Math.round(d.z*s),t[d]===void 0?(t[d]=c,r.push(this.vertices[c]),i[c]=r.length-1):i[c]=i[t[d]]}for(t=[],c=0,f=this.faces.length;c<f;c++)for(s=this.faces[c],s.a=i[s.a],s.b=i[s.b],s.c=i[s.c],s=[s.a,s.b,s.c],d=0;3>d;d++)if(s[d]===s[(d+1)%3]){t.push(c);break}for(c=t.length-1;0<=c;c--)for(s=t[c],this.faces.splice(s,1),i=0,f=this.faceVertexUvs.length;i<f;i++)this.faceVertexUvs[i].splice(s,1);return c=this.vertices.length-r.length,this.vertices=r,c},setFromPoints:function(t){this.vertices=[];for(var r=0,i=t.length;r<i;r++){var s=t[r];this.vertices.push(new dt(s.x,s.y,s.z||0))}return this},sortFacesByMaterialIndex:function(){for(var t=this.faces,r=t.length,i=0;i<r;i++)t[i]._id=i;t.sort(function(A,S){return A.materialIndex-S.materialIndex});var s=this.faceVertexUvs[0],f=this.faceVertexUvs[1],c,d;for(s&&s.length===r&&(c=[]),f&&f.length===r&&(d=[]),i=0;i<r;i++){var p=t[i]._id;c&&c.push(s[p]),d&&d.push(f[p])}c&&(this.faceVertexUvs[0]=c),d&&(this.faceVertexUvs[1]=d)},toJSON:function(){function t(Mt,Ct,wt){return wt?Mt|1<<Ct:Mt&~(1<<Ct)}function r(Mt){var Ct=Mt.x.toString()+Mt.y.toString()+Mt.z.toString();return S[Ct]!==void 0||(S[Ct]=A.length/3,A.push(Mt.x,Mt.y,Mt.z)),S[Ct]}function i(Mt){var Ct=Mt.r.toString()+Mt.g.toString()+Mt.b.toString();return w[Ct]!==void 0||(w[Ct]=z.length,z.push(Mt.getHex())),w[Ct]}function s(Mt){var Ct=Mt.x.toString()+Mt.y.toString();return E[Ct]!==void 0||(E[Ct]=I.length/2,I.push(Mt.x,Mt.y)),E[Ct]}var f={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(f.uuid=this.uuid,f.type=this.type,this.name!==""&&(f.name=this.name),this.parameters!==void 0){var c=this.parameters,d;for(d in c)c[d]!==void 0&&(f[d]=c[d]);return f}for(c=[],d=0;d<this.vertices.length;d++){var p=this.vertices[d];c.push(p.x,p.y,p.z)}p=[];var A=[],S={},z=[],w={},I=[],E={};for(d=0;d<this.faces.length;d++){var P=this.faces[d],F=this.faceVertexUvs[0][d]!==void 0,X=0<P.normal.length(),q=0<P.vertexNormals.length,J=P.color.r!==1||P.color.g!==1||P.color.b!==1,it=0<P.vertexColors.length,lt=0;lt=t(lt,0,0),lt=t(lt,1,!0),lt=t(lt,2,!1),lt=t(lt,3,F),lt=t(lt,4,X),lt=t(lt,5,q),lt=t(lt,6,J),lt=t(lt,7,it),p.push(lt),p.push(P.a,P.b,P.c),p.push(P.materialIndex),F&&(F=this.faceVertexUvs[0][d],p.push(s(F[0]),s(F[1]),s(F[2]))),X&&p.push(r(P.normal)),q&&(X=P.vertexNormals,p.push(r(X[0]),r(X[1]),r(X[2]))),J&&p.push(i(P.color)),it&&(P=P.vertexColors,p.push(i(P[0]),i(P[1]),i(P[2])))}return f.data={},f.data.vertices=c,f.data.normals=A,0<z.length&&(f.data.colors=z),0<I.length&&(f.data.uvs=[I]),f.data.faces=p,f},clone:function(){return new Gr().copy(this)},copy:function(t){var r,i,s;this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingSphere=this.boundingBox=null,this.name=t.name;var f=t.vertices,c=0;for(r=f.length;c<r;c++)this.vertices.push(f[c].clone());for(f=t.colors,c=0,r=f.length;c<r;c++)this.colors.push(f[c].clone());for(f=t.faces,c=0,r=f.length;c<r;c++)this.faces.push(f[c].clone());for(c=0,r=t.faceVertexUvs.length;c<r;c++){var d=t.faceVertexUvs[c];for(this.faceVertexUvs[c]===void 0&&(this.faceVertexUvs[c]=[]),f=0,i=d.length;f<i;f++){var p=d[f],A=[],S=0;for(s=p.length;S<s;S++)A.push(p[S].clone());this.faceVertexUvs[c].push(A)}}for(S=t.morphTargets,c=0,r=S.length;c<r;c++){if(s={},s.name=S[c].name,S[c].vertices!==void 0)for(s.vertices=[],f=0,i=S[c].vertices.length;f<i;f++)s.vertices.push(S[c].vertices[f].clone());if(S[c].normals!==void 0)for(s.normals=[],f=0,i=S[c].normals.length;f<i;f++)s.normals.push(S[c].normals[f].clone());this.morphTargets.push(s)}for(S=t.morphNormals,c=0,r=S.length;c<r;c++){if(s={},S[c].vertexNormals!==void 0)for(s.vertexNormals=[],f=0,i=S[c].vertexNormals.length;f<i;f++)d=S[c].vertexNormals[f],p={},p.a=d.a.clone(),p.b=d.b.clone(),p.c=d.c.clone(),s.vertexNormals.push(p);if(S[c].faceNormals!==void 0)for(s.faceNormals=[],f=0,i=S[c].faceNormals.length;f<i;f++)s.faceNormals.push(S[c].faceNormals[f].clone());this.morphNormals.push(s)}for(f=t.skinWeights,c=0,r=f.length;c<r;c++)this.skinWeights.push(f[c].clone());for(f=t.skinIndices,c=0,r=f.length;c<r;c++)this.skinIndices.push(f[c].clone());for(f=t.lineDistances,c=0,r=f.length;c<r;c++)this.lineDistances.push(f[c]);return c=t.boundingBox,c!==null&&(this.boundingBox=c.clone()),c=t.boundingSphere,c!==null&&(this.boundingSphere=c.clone()),this.elementsNeedUpdate=t.elementsNeedUpdate,this.verticesNeedUpdate=t.verticesNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.lineDistancesNeedUpdate=t.lineDistancesNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});var qI=function(t){function r(i,s,f,c,d,p){Ai(this,r);var A=Tn(this,(r.__proto__||Wn(r)).call(this));return A.type="BoxGeometry",A.parameters={width:i,height:s,depth:f,widthSegments:c,heightSegments:d,depthSegments:p},A.fromBufferGeometry(new Dy(i,s,f,c,d,p)),A.mergeVertices(),A}return jn(r,t),r}(Gr),Dy=function(t){function r(i,s,f,c,d,p){function A(q,J,it,lt,Mt,Ct,wt,zt,Ut,Kt,Gt){var Qt=Ct/Ut,De=wt/Kt,re=Ct/2,We=wt/2,hr=zt/2;wt=Ut+1;for(var Je=Kt+1,qr=Ct=0,nr=new dt,xt=0;xt<Je;xt++)for(var At=xt*De-We,_t=0;_t<wt;_t++)nr[q]=(_t*Qt-re)*lt,nr[J]=At*Mt,nr[it]=hr,I.push(nr.x,nr.y,nr.z),nr[q]=0,nr[J]=0,nr[it]=0<zt?1:-1,E.push(nr.x,nr.y,nr.z),P.push(_t/Ut),P.push(1-xt/Kt),Ct+=1;for(q=0;q<Kt;q++)for(J=0;J<Ut;J++)it=F+J+wt*(q+1),lt=F+(J+1)+wt*(q+1),Mt=F+(J+1)+wt*q,w.push(F+J+wt*q,it,Mt),w.push(it,lt,Mt),qr+=6;z.addGroup(X,qr,Gt),X+=qr,F+=Ct}Ai(this,r);var S=Tn(this,(r.__proto__||Wn(r)).call(this));S.type="BoxBufferGeometry",S.parameters={width:i,height:s,depth:f,widthSegments:c,heightSegments:d,depthSegments:p};var z=S;i=i||1,s=s||1,f=f||1,c=Math.floor(c)||1,d=Math.floor(d)||1,p=Math.floor(p)||1;var w=[],I=[],E=[],P=[],F=0,X=0;return A("z","y","x",-1,-1,f,s,i,p,d,0),A("z","y","x",1,-1,f,s,-i,p,d,1),A("x","z","y",1,1,i,f,s,c,p,2),A("x","z","y",1,-1,i,f,-s,c,p,3),A("x","y","z",1,-1,i,s,f,c,d,4),A("x","y","z",-1,-1,i,s,-f,c,d,5),S.setIndex(w),S.setAttribute("position",new Ge(I,3)),S.setAttribute("normal",new Ge(E,3)),S.setAttribute("uv",new Ge(P,2)),S}return jn(r,t),r}(ke),ap={clone:Mh,merge:uo};Ki.prototype=ft(Rr.prototype),Ki.prototype.constructor=Ki,Ki.prototype.isShaderMaterial=!0,Ki.prototype.copy=function(t){return Rr.prototype.copy.call(this,t),this.fragmentShader=t.fragmentShader,this.vertexShader=t.vertexShader,this.uniforms=Mh(t.uniforms),this.defines=pt({},t.defines),this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.lights=t.lights,this.clipping=t.clipping,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.extensions=pt({},t.extensions),this},Ki.prototype.toJSON=function(t){var r=Rr.prototype.toJSON.call(this,t);r.uniforms={};for(var i in this.uniforms){var s=this.uniforms[i].value;r.uniforms[i]=s&&s.isTexture?{type:"t",value:s.toJSON(t).uuid}:s&&s.isColor?{type:"c",value:s.getHex()}:s&&s.isVector2?{type:"v2",value:s.toArray()}:s&&s.isVector3?{type:"v3",value:s.toArray()}:s&&s.isVector4?{type:"v4",value:s.toArray()}:s&&s.isMatrix3?{type:"m3",value:s.toArray()}:s&&s.isMatrix4?{type:"m4",value:s.toArray()}:{value:s}}0<Ti(this.defines).length&&(r.defines=this.defines),r.vertexShader=this.vertexShader,r.fragmentShader=this.fragmentShader,t={};for(var f in this.extensions)this.extensions[f]===!0&&(t[f]=!0);return 0<Ti(t).length&&(r.extensions=t),r},Da.prototype=pt(ft(fe.prototype),{constructor:Da,isCamera:!0,copy:function(t,r){return fe.prototype.copy.call(this,t,r),this.matrixWorldInverse.copy(t.matrixWorldInverse),this.projectionMatrix.copy(t.projectionMatrix),this.projectionMatrixInverse.copy(t.projectionMatrixInverse),this},getWorldDirection:function(t){t===void 0&&(console.warn("THREE.Camera: .getWorldDirection() target is now required"),t=new dt),this.updateMatrixWorld(!0);var r=this.matrixWorld.elements;return t.set(-r[8],-r[9],-r[10]).normalize()},updateMatrixWorld:function(t){fe.prototype.updateMatrixWorld.call(this,t),this.matrixWorldInverse.getInverse(this.matrixWorld)},updateWorldMatrix:function(t,r){fe.prototype.updateWorldMatrix.call(this,t,r),this.matrixWorldInverse.getInverse(this.matrixWorld)},clone:function(){return new this.constructor().copy(this)}}),en.prototype=pt(ft(Da.prototype),{constructor:en,isPerspectiveCamera:!0,copy:function(t,r){return Da.prototype.copy.call(this,t,r),this.fov=t.fov,this.zoom=t.zoom,this.near=t.near,this.far=t.far,this.focus=t.focus,this.aspect=t.aspect,this.view=t.view===null?null:pt({},t.view),this.filmGauge=t.filmGauge,this.filmOffset=t.filmOffset,this},setFocalLength:function(t){t=.5*this.getFilmHeight()/t,this.fov=2*ti.RAD2DEG*Math.atan(t),this.updateProjectionMatrix()},getFocalLength:function(){var t=Math.tan(.5*ti.DEG2RAD*this.fov);return .5*this.getFilmHeight()/t},getEffectiveFOV:function(){return 2*ti.RAD2DEG*Math.atan(Math.tan(.5*ti.DEG2RAD*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(t,r,i,s,f,c){this.aspect=t/r,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=r,this.view.offsetX=i,this.view.offsetY=s,this.view.width=f,this.view.height=c,this.updateProjectionMatrix()},clearViewOffset:function(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var t=this.near,r=t*Math.tan(.5*ti.DEG2RAD*this.fov)/this.zoom,i=2*r,s=this.aspect*i,f=-.5*s,c=this.view;if(this.view!==null&&this.view.enabled){var d=c.fullWidth,p=c.fullHeight;f+=c.offsetX*s/d,r-=c.offsetY*i/p,s*=c.width/d,i*=c.height/p}c=this.filmOffset,c!==0&&(f+=t*c/this.getFilmWidth()),this.projectionMatrix.makePerspective(f,f+s,r,r-i,t,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(t){return t=fe.prototype.toJSON.call(this,t),t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=pt({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}),Vi.prototype=ft(fe.prototype),Vi.prototype.constructor=Vi,Tu.prototype=ft(pe.prototype),Tu.prototype.constructor=Tu,Tu.prototype.isWebGLCubeRenderTarget=!0,Tu.prototype.fromEquirectangularTexture=function(t,r){this.texture.type=r.type,this.texture.format=r.format,this.texture.encoding=r.encoding;var i=new Mr,s=new Ki({type:"CubemapFromEquirect",uniforms:Mh({tEquirect:{value:null}}),vertexShader:`varying vec3 vWorldDirection;
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,fragmentShader:`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
}`,side:1,blending:0});return s.uniforms.tEquirect.value=r,r=new Zi(new Dy(5,5,5),s),i.add(r),new Vi(1,10,this).update(t,i),r.geometry.dispose(),r.material.dispose(),this},yl.prototype=ft(le.prototype),yl.prototype.constructor=yl,yl.prototype.isDataTexture=!0;var Wd=new fn,Oy=new dt;pt(Su.prototype,{set:function(t,r,i,s,f,c){var d=this.planes;return d[0].copy(t),d[1].copy(r),d[2].copy(i),d[3].copy(s),d[4].copy(f),d[5].copy(c),this},clone:function(){return new this.constructor().copy(this)},copy:function(t){for(var r=this.planes,i=0;6>i;i++)r[i].copy(t.planes[i]);return this},setFromProjectionMatrix:function(t){var r=this.planes,i=t.elements;t=i[0];var s=i[1],f=i[2],c=i[3],d=i[4],p=i[5],A=i[6],S=i[7],z=i[8],w=i[9],I=i[10],E=i[11],P=i[12],F=i[13],X=i[14];return i=i[15],r[0].setComponents(c-t,S-d,E-z,i-P).normalize(),r[1].setComponents(c+t,S+d,E+z,i+P).normalize(),r[2].setComponents(c+s,S+p,E+w,i+F).normalize(),r[3].setComponents(c-s,S-p,E-w,i-F).normalize(),r[4].setComponents(c-f,S-A,E-I,i-X).normalize(),r[5].setComponents(c+f,S+A,E+I,i+X).normalize(),this},intersectsObject:function(t){var r=t.geometry;return r.boundingSphere===null&&r.computeBoundingSphere(),Wd.copy(r.boundingSphere).applyMatrix4(t.matrixWorld),this.intersectsSphere(Wd)},intersectsSprite:function(t){return Wd.center.set(0,0,0),Wd.radius=.7071067811865476,Wd.applyMatrix4(t.matrixWorld),this.intersectsSphere(Wd)},intersectsSphere:function(t){var r=this.planes,i=t.center;t=-t.radius;for(var s=0;6>s;s++)if(r[s].distanceToPoint(i)<t)return!1;return!0},intersectsBox:function(t){for(var r=this.planes,i=0;6>i;i++){var s=r[i];if(Oy.x=0<s.normal.x?t.max.x:t.min.x,Oy.y=0<s.normal.y?t.max.y:t.min.y,Oy.z=0<s.normal.z?t.max.z:t.min.z,0>s.distanceToPoint(Oy))return!1}return!0},containsPoint:function(t){for(var r=this.planes,i=0;6>i;i++)if(0>r[i].distanceToPoint(t))return!1;return!0}});var sr={common:{diffuse:{value:new Oe(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new Jt},uv2Transform:{value:new Jt},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new Ot(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Oe(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}}},points:{diffuse:{value:new Oe(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},uvTransform:{value:new Jt}},sprite:{diffuse:{value:new Oe(15658734)},opacity:{value:1},center:{value:new Ot(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},uvTransform:{value:new Jt}}};Qc.prototype=ft(Gr.prototype),Qc.prototype.constructor=Qc,Oa.prototype=ft(ke.prototype),Oa.prototype.constructor=Oa;var gi={alphamap_fragment:`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vUv ).g;
#endif`,alphamap_pars_fragment:`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,alphatest_fragment:`#ifdef ALPHATEST
	if ( diffuseColor.a < ALPHATEST ) discard;
#endif`,aomap_fragment:`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );
	#endif
#endif`,aomap_pars_fragment:`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,bsdfs:`vec2 integrateSpecularBRDF( const in float dotNV, const in float roughness ) {
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	return vec2( -1.04, 1.04 ) * a004 + r.zw;
}
float punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
#if defined ( PHYSICALLY_CORRECT_LIGHTS )
	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
	if( cutoffDistance > 0.0 ) {
		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
	}
	return distanceFalloff;
#else
	if( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
		return pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );
	}
	return 1.0;
#endif
}
vec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {
	float fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );
	return ( 1.0 - specularColor ) * fresnel + specularColor;
}
vec3 F_Schlick_RoughnessDependent( const in vec3 F0, const in float dotNV, const in float roughness ) {
	float fresnel = exp2( ( -5.55473 * dotNV - 6.98316 ) * dotNV );
	vec3 Fr = max( vec3( 1.0 - roughness ), F0 ) - F0;
	return Fr * fresnel + F0;
}
float G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	float gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	return 1.0 / ( gl * gv );
}
float G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
vec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( incidentLight.direction + viewDir );
	float dotNL = saturate( dot( normal, incidentLight.direction ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotLH = saturate( dot( incidentLight.direction, halfDir ) );
	vec3 F = F_Schlick( specularColor, dotLH );
	float G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );
	float D = D_GGX( alpha, dotNH );
	return F * ( G * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE  = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS  = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
vec3 BRDF_Specular_GGX_Environment( const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	vec2 brdf = integrateSpecularBRDF( dotNV, roughness );
	return specularColor * brdf.x + brdf.y;
}
void BRDF_Specular_Multiscattering_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
	float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
	vec3 F = F_Schlick_RoughnessDependent( specularColor, dotNV, roughness );
	vec2 brdf = integrateSpecularBRDF( dotNV, roughness );
	vec3 FssEss = F * brdf.x + brdf.y;
	float Ess = brdf.x + brdf.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );
	float dotNH = saturate( dot( geometry.normal, halfDir ) );
	float dotLH = saturate( dot( incidentLight.direction, halfDir ) );
	vec3 F = F_Schlick( specularColor, dotLH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
}
float GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {
	return ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );
}
float BlinnExponentToGGXRoughness( const in float blinnExponent ) {
	return sqrt( 2.0 / ( blinnExponent + 2.0 ) );
}
#if defined( USE_SHEEN )
float D_Charlie(float roughness, float NoH) {
	float invAlpha  = 1.0 / roughness;
	float cos2h = NoH * NoH;
	float sin2h = max(1.0 - cos2h, 0.0078125);	return (2.0 + invAlpha) * pow(sin2h, invAlpha * 0.5) / (2.0 * PI);
}
float V_Neubelt(float NoV, float NoL) {
	return saturate(1.0 / (4.0 * (NoL + NoV - NoL * NoV)));
}
vec3 BRDF_Specular_Sheen( const in float roughness, const in vec3 L, const in GeometricContext geometry, vec3 specularColor ) {
	vec3 N = geometry.normal;
	vec3 V = geometry.viewDir;
	vec3 H = normalize( V + L );
	float dotNH = saturate( dot( N, H ) );
	return specularColor * D_Charlie( roughness, dotNH ) * V_Neubelt( dot(N, V), dot(N, L) );
}
#endif`,bumpmap_pars_fragment:`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vUv );
		vec2 dSTdy = dFdy( vUv );
		float Hll = bumpScale * texture2D( bumpMap, vUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {
		vec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );
		vec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 );
		fDet *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,clipping_planes_fragment:`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
	}
	#pragma unroll_loop_end
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
		}
		#pragma unroll_loop_end
		if ( clipped ) discard;
	#endif
#endif`,clipping_planes_pars_fragment:`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,clipping_planes_pars_vertex:`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,clipping_planes_vertex:`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,color_fragment:`#ifdef USE_COLOR
	diffuseColor.rgb *= vColor;
#endif`,color_pars_fragment:`#ifdef USE_COLOR
	varying vec3 vColor;
#endif`,color_pars_vertex:`#ifdef USE_COLOR
	varying vec3 vColor;
#endif`,color_vertex:`#ifdef USE_COLOR
	vColor.xyz = color.xyz;
#endif`,common:`#define PI 3.14159265359
#define PI2 6.28318530718
#define PI_HALF 1.5707963267949
#define RECIPROCAL_PI 0.31830988618
#define RECIPROCAL_PI2 0.15915494
#define LOG2 1.442695
#define EPSILON 1e-6
#ifndef saturate
#define saturate(a) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement(a) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract(sin(sn) * c);
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float max3( vec3 v ) { return max( max( v.x, v.y ), v.z ); }
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
struct GeometricContext {
	vec3 position;
	vec3 normal;
	vec3 viewDir;
#ifdef CLEARCOAT
	vec3 clearcoatNormal;
#endif
};
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
vec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {
	float distance = dot( planeNormal, point - pointOnPlane );
	return - distance * planeNormal + point;
}
float sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {
	return sign( dot( point - pointOnPlane, planeNormal ) );
}
vec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {
	return lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float linearToRelativeLuminance( const in vec3 color ) {
	vec3 weights = vec3( 0.2126, 0.7152, 0.0722 );
	return dot( weights, color.rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
  return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}`,cube_uv_reflection_fragment:`#ifdef ENVMAP_TYPE_CUBE_UV
#define cubeUV_maxMipLevel 8.0
#define cubeUV_minMipLevel 4.0
#define cubeUV_maxTileSize 256.0
#define cubeUV_minTileSize 16.0
float getFace(vec3 direction) {
    vec3 absDirection = abs(direction);
    float face = -1.0;
    if (absDirection.x > absDirection.z) {
      if (absDirection.x > absDirection.y)
        face = direction.x > 0.0 ? 0.0 : 3.0;
      else
        face = direction.y > 0.0 ? 1.0 : 4.0;
    } else {
      if (absDirection.z > absDirection.y)
        face = direction.z > 0.0 ? 2.0 : 5.0;
      else
        face = direction.y > 0.0 ? 1.0 : 4.0;
    }
    return face;
}
vec2 getUV(vec3 direction, float face) {
    vec2 uv;
    if (face == 0.0) {
      uv = vec2(direction.z, direction.y) / abs(direction.x);    } else if (face == 1.0) {
      uv = vec2(-direction.x, -direction.z) / abs(direction.y);    } else if (face == 2.0) {
      uv = vec2(-direction.x, direction.y) / abs(direction.z);    } else if (face == 3.0) {
      uv = vec2(-direction.z, direction.y) / abs(direction.x);    } else if (face == 4.0) {
      uv = vec2(-direction.x, direction.z) / abs(direction.y);    } else {
      uv = vec2(direction.x, direction.y) / abs(direction.z);    }
    return 0.5 * (uv + 1.0);
}
vec3 bilinearCubeUV(sampler2D envMap, vec3 direction, float mipInt) {
  float face = getFace(direction);
  float filterInt = max(cubeUV_minMipLevel - mipInt, 0.0);
  mipInt = max(mipInt, cubeUV_minMipLevel);
  float faceSize = exp2(mipInt);
  float texelSize = 1.0 / (3.0 * cubeUV_maxTileSize);
  vec2 uv = getUV(direction, face) * (faceSize - 1.0);
  vec2 f = fract(uv);
  uv += 0.5 - f;
  if (face > 2.0) {
    uv.y += faceSize;
    face -= 3.0;
  }
  uv.x += face * faceSize;
  if(mipInt < cubeUV_maxMipLevel){
    uv.y += 2.0 * cubeUV_maxTileSize;
  }
  uv.y += filterInt * 2.0 * cubeUV_minTileSize;
  uv.x += 3.0 * max(0.0, cubeUV_maxTileSize - 2.0 * faceSize);
  uv *= texelSize;
  vec3 tl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;
  uv.x += texelSize;
  vec3 tr = envMapTexelToLinear(texture2D(envMap, uv)).rgb;
  uv.y += texelSize;
  vec3 br = envMapTexelToLinear(texture2D(envMap, uv)).rgb;
  uv.x -= texelSize;
  vec3 bl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;
  vec3 tm = mix(tl, tr, f.x);
  vec3 bm = mix(bl, br, f.x);
  return mix(tm, bm, f.y);
}
#define r0 1.0
#define v0 0.339
#define m0 -2.0
#define r1 0.8
#define v1 0.276
#define m1 -1.0
#define r4 0.4
#define v4 0.046
#define m4 2.0
#define r5 0.305
#define v5 0.016
#define m5 3.0
#define r6 0.21
#define v6 0.0038
#define m6 4.0
float roughnessToMip(float roughness) {
  float mip = 0.0;
  if (roughness >= r1) {
    mip = (r0 - roughness) * (m1 - m0) / (r0 - r1) + m0;
  } else if (roughness >= r4) {
    mip = (r1 - roughness) * (m4 - m1) / (r1 - r4) + m1;
  } else if (roughness >= r5) {
    mip = (r4 - roughness) * (m5 - m4) / (r4 - r5) + m4;
  } else if (roughness >= r6) {
    mip = (r5 - roughness) * (m6 - m5) / (r5 - r6) + m5;
  } else {
    mip = -2.0 * log2(1.16 * roughness);  }
  return mip;
}
vec4 textureCubeUV(sampler2D envMap, vec3 sampleDir, float roughness) {
  float mip = clamp(roughnessToMip(roughness), m0, cubeUV_maxMipLevel);
  float mipF = fract(mip);
  float mipInt = floor(mip);
  vec3 color0 = bilinearCubeUV(envMap, sampleDir, mipInt);
  if (mipF == 0.0) {
    return vec4(color0, 1.0);
  } else {
    vec3 color1 = bilinearCubeUV(envMap, sampleDir, mipInt + 1.0);
    return vec4(mix(color0, color1, mipF), 1.0);
  }
}
#endif`,defaultnormal_vertex:`vec3 transformedNormal = objectNormal;
#ifdef USE_INSTANCING
	mat3 m = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );
	transformedNormal = m * transformedNormal;
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	vec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,displacementmap_pars_vertex:`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,displacementmap_vertex:`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );
#endif`,emissivemap_fragment:`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vUv );
	emissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,emissivemap_pars_fragment:`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:`
vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 GammaToLinear( in vec4 value, in float gammaFactor ) {
	return vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );
}
vec4 LinearToGamma( in vec4 value, in float gammaFactor ) {
	return vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );
}
vec4 sRGBToLinear( in vec4 value ) {
	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );
}
vec4 LinearTosRGB( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}
vec4 RGBEToLinear( in vec4 value ) {
	return vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );
}
vec4 LinearToRGBE( in vec4 value ) {
	float maxComponent = max( max( value.r, value.g ), value.b );
	float fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );
	return vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );
}
vec4 RGBMToLinear( in vec4 value, in float maxRange ) {
	return vec4( value.rgb * value.a * maxRange, 1.0 );
}
vec4 LinearToRGBM( in vec4 value, in float maxRange ) {
	float maxRGB = max( value.r, max( value.g, value.b ) );
	float M = clamp( maxRGB / maxRange, 0.0, 1.0 );
	M = ceil( M * 255.0 ) / 255.0;
	return vec4( value.rgb / ( M * maxRange ), M );
}
vec4 RGBDToLinear( in vec4 value, in float maxRange ) {
	return vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );
}
vec4 LinearToRGBD( in vec4 value, in float maxRange ) {
	float maxRGB = max( value.r, max( value.g, value.b ) );
	float D = max( maxRange / maxRGB, 1.0 );
	D = clamp( floor( D ) / 255.0, 0.0, 1.0 );
	return vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );
}
const mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );
vec4 LinearToLogLuv( in vec4 value )  {
	vec3 Xp_Y_XYZp = cLogLuvM * value.rgb;
	Xp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );
	vec4 vResult;
	vResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;
	float Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;
	vResult.w = fract( Le );
	vResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;
	return vResult;
}
const mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );
vec4 LogLuvToLinear( in vec4 value ) {
	float Le = value.z * 255.0 + value.w;
	vec3 Xp_Y_XYZp;
	Xp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );
	Xp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;
	Xp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;
	vec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;
	return vec4( max( vRGB, 0.0 ), 1.0 );
}`,envmap_fragment:`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		}  else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );
	#elif defined( ENVMAP_TYPE_EQUIREC )
		reflectVec = normalize( reflectVec );
		vec2 sampleUV = equirectUv( reflectVec );
		vec4 envColor = texture2D( envMap, sampleUV );
	#elif defined( ENVMAP_TYPE_SPHERE )
		reflectVec = normalize( reflectVec );
		vec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) );
		vec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifndef ENVMAP_TYPE_CUBE_UV
		envColor = envMapTexelToLinear( envColor );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,envmap_common_pars_fragment:`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform int maxMipLevel;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,envmap_pars_fragment:`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,envmap_pars_vertex:`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,envmap_physical_pars_fragment:`#if defined( USE_ENVMAP )
	#ifdef ENVMAP_MODE_REFRACTION
		uniform float refractionRatio;
	#endif
	vec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {
		vec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );
		#ifdef ENVMAP_TYPE_CUBE
			vec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );
			#ifdef TEXTURE_LOD_EXT
				vec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );
			#else
				vec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );
			#endif
			envMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;
		#elif defined( ENVMAP_TYPE_CUBE_UV )
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
		#else
			vec4 envMapColor = vec4( 0.0 );
		#endif
		return PI * envMapColor.rgb * envMapIntensity;
	}
	float getSpecularMIPLevel( const in float roughness, const in int maxMIPLevel ) {
		float maxMIPLevelScalar = float( maxMIPLevel );
		float sigma = PI * roughness * roughness / ( 1.0 + roughness );
		float desiredMIPLevel = maxMIPLevelScalar + log2( sigma );
		return clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );
	}
	vec3 getLightProbeIndirectRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in int maxMIPLevel ) {
		#ifdef ENVMAP_MODE_REFLECTION
		  vec3 reflectVec = reflect( -viewDir, normal );
		  reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
		#else
		  vec3 reflectVec = refract( -viewDir, normal, refractionRatio );
		#endif
		reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
		float specularMIPLevel = getSpecularMIPLevel( roughness, maxMIPLevel );
		#ifdef ENVMAP_TYPE_CUBE
			vec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );
			#ifdef TEXTURE_LOD_EXT
				vec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );
			#else
				vec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );
			#endif
			envMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;
		#elif defined( ENVMAP_TYPE_CUBE_UV )
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
		#elif defined( ENVMAP_TYPE_EQUIREC )
			vec2 sampleUV = equirectUv( reflectVec );
			#ifdef TEXTURE_LOD_EXT
				vec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );
			#else
				vec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );
			#endif
			envMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;
		#elif defined( ENVMAP_TYPE_SPHERE )
			vec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0,0.0,1.0 ) );
			#ifdef TEXTURE_LOD_EXT
				vec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );
			#else
				vec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );
			#endif
			envMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;
		#endif
		return envMapColor.rgb * envMapIntensity;
	}
#endif`,envmap_vertex:`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) { 
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,fog_vertex:`#ifdef USE_FOG
	fogDepth = -mvPosition.z;
#endif`,fog_pars_vertex:`#ifdef USE_FOG
	varying float fogDepth;
#endif`,fog_fragment:`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * fogDepth * fogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, fogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,fog_pars_fragment:`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float fogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,gradientmap_pars_fragment:`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return texture2D( gradientMap, coord ).rgb;
	#else
		return ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );
	#endif
}`,lightmap_fragment:`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel= texture2D( lightMap, vUv2 );
	reflectedLight.indirectDiffuse += PI * lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;
#endif`,lightmap_pars_fragment:`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,lights_lambert_vertex:`vec3 diffuse = vec3( 1.0 );
GeometricContext geometry;
geometry.position = mvPosition.xyz;
geometry.normal = normalize( transformedNormal );
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );
GeometricContext backGeometry;
backGeometry.position = geometry.position;
backGeometry.normal = -geometry.normal;
backGeometry.viewDir = geometry.viewDir;
vLightFront = vec3( 0.0 );
vIndirectFront = vec3( 0.0 );
#ifdef DOUBLE_SIDED
	vLightBack = vec3( 0.0 );
	vIndirectBack = vec3( 0.0 );
#endif
IncidentLight directLight;
float dotNL;
vec3 directLightColor_Diffuse;
vIndirectFront += getAmbientLightIrradiance( ambientLightColor );
vIndirectFront += getLightProbeIrradiance( lightProbe, geometry );
#ifdef DOUBLE_SIDED
	vIndirectBack += getAmbientLightIrradiance( ambientLightColor );
	vIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry );
#endif
#if NUM_POINT_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		getPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = PI * directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_SPOT_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		getSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = PI * directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_DIR_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		getDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = PI * directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_HEMI_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
		vIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );
		#ifdef DOUBLE_SIDED
			vIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );
		#endif
	}
	#pragma unroll_loop_end
#endif`,lights_pars_begin:`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
uniform vec3 lightProbe[ 9 ];
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in GeometricContext geometry ) {
	vec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	return irradiance;
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	void getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {
		directLight.color = directionalLight.color;
		directLight.direction = directionalLight.direction;
		directLight.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
		struct PointLightShadow {
			float shadowBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	void getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {
		vec3 lVector = pointLight.position - geometry.position;
		directLight.direction = normalize( lVector );
		float lightDistance = length( lVector );
		directLight.color = pointLight.color;
		directLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );
		directLight.visible = ( directLight.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	void getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight  ) {
		vec3 lVector = spotLight.position - geometry.position;
		directLight.direction = normalize( lVector );
		float lightDistance = length( lVector );
		float angleCos = dot( directLight.direction, spotLight.direction );
		if ( angleCos > spotLight.coneCos ) {
			float spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );
			directLight.color = spotLight.color;
			directLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );
			directLight.visible = true;
		} else {
			directLight.color = vec3( 0.0 );
			directLight.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {
		float dotNL = dot( geometry.normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		#ifndef PHYSICALLY_CORRECT_LIGHTS
			irradiance *= PI;
		#endif
		return irradiance;
	}
#endif`,lights_toon_fragment:`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,lights_toon_pars_fragment:`varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
struct ToonMaterial {
	vec3	diffuseColor;
	vec3	specularColor;
	float	specularShininess;
	float	specularStrength;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	reflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon
#define Material_LightProbeLOD( material )	(0)`,lights_phong_fragment:`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,lights_phong_pars_fragment:`varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
struct BlinnPhongMaterial {
	vec3	diffuseColor;
	vec3	specularColor;
	float	specularShininess;
	float	specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	reflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong
#define Material_LightProbeLOD( material )	(0)`,lights_physical_fragment:`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.specularRoughness = max( roughnessFactor, 0.0525 );material.specularRoughness += geometryRoughness;
material.specularRoughness = min( material.specularRoughness, 1.0 );
#ifdef REFLECTIVITY
	material.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );
#endif
#ifdef CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheen;
#endif`,lights_physical_pars_fragment:`struct PhysicalMaterial {
	vec3	diffuseColor;
	float	specularRoughness;
	vec3	specularColor;
#ifdef CLEARCOAT
	float clearcoat;
	float clearcoatRoughness;
#endif
#ifdef USE_SHEEN
	vec3 sheenColor;
#endif
};
#define MAXIMUM_SPECULAR_COEFFICIENT 0.16
#define DEFAULT_SPECULAR_COEFFICIENT 0.04
float clearcoatDHRApprox( const in float roughness, const in float dotNL ) {
	return DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometry.normal;
		vec3 viewDir = geometry.viewDir;
		vec3 position = geometry.position;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.specularRoughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	#ifdef CLEARCOAT
		float ccDotNL = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = ccDotNL * directLight.color;
		#ifndef PHYSICALLY_CORRECT_LIGHTS
			ccIrradiance *= PI;
		#endif
		float clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );
		reflectedLight.directSpecular += ccIrradiance * material.clearcoat * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );
	#else
		float clearcoatDHR = 0.0;
	#endif
	#ifdef USE_SHEEN
		reflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_Sheen(
			material.specularRoughness,
			directLight.direction,
			geometry,
			material.sheenColor
		);
	#else
		reflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.normal, material.specularColor, material.specularRoughness);
	#endif
	reflectedLight.directDiffuse += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef CLEARCOAT
		float ccDotNV = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );
		reflectedLight.indirectSpecular += clearcoatRadiance * material.clearcoat * BRDF_Specular_GGX_Environment( geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );
		float ccDotNL = ccDotNV;
		float clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );
	#else
		float clearcoatDHR = 0.0;
	#endif
	float clearcoatInv = 1.0 - clearcoatDHR;
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	BRDF_Specular_Multiscattering_Environment( geometry, material.specularColor, material.specularRoughness, singleScattering, multiScattering );
	vec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );
	reflectedLight.indirectSpecular += clearcoatInv * radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,lights_fragment_begin:`
GeometricContext geometry;
geometry.position = - vViewPosition;
geometry.normal = normal;
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
#ifdef CLEARCOAT
	geometry.clearcoatNormal = clearcoatNormal;
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointDirectLightIrradiance( pointLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotDirectLightIrradiance( spotLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	irradiance += getLightProbeIrradiance( lightProbe, geometry );
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,lights_fragment_maps:`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel= texture2D( lightMap, vUv2 );
		vec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;
		#ifndef PHYSICALLY_CORRECT_LIGHTS
			lightMapIrradiance *= PI;
		#endif
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getLightProbeIndirectIrradiance( geometry, maxMipLevel );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	radiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.normal, material.specularRoughness, maxMipLevel );
	#ifdef CLEARCOAT
		clearcoatRadiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness, maxMipLevel );
	#endif
#endif`,lights_fragment_end:`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );
#endif`,logdepthbuf_fragment:`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,logdepthbuf_pars_fragment:`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,logdepthbuf_pars_vertex:`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,logdepthbuf_vertex:`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,map_fragment:`#ifdef USE_MAP
	vec4 texelColor = texture2D( map, vUv );
	texelColor = mapTexelToLinear( texelColor );
	diffuseColor *= texelColor;
#endif`,map_pars_fragment:`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,map_particle_fragment:`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
#endif
#ifdef USE_MAP
	vec4 mapTexel = texture2D( map, uv );
	diffuseColor *= mapTexelToLinear( mapTexel );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,map_particle_pars_fragment:`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	uniform mat3 uvTransform;
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,metalnessmap_fragment:`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vUv );
	metalnessFactor *= texelMetalness.b;
#endif`,metalnessmap_pars_fragment:`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,morphnormal_vertex:`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
	objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
	objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
	objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
#endif`,morphtarget_pars_vertex:`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifndef USE_MORPHNORMALS
	uniform float morphTargetInfluences[ 8 ];
	#else
	uniform float morphTargetInfluences[ 4 ];
	#endif
#endif`,morphtarget_vertex:`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	transformed += morphTarget0 * morphTargetInfluences[ 0 ];
	transformed += morphTarget1 * morphTargetInfluences[ 1 ];
	transformed += morphTarget2 * morphTargetInfluences[ 2 ];
	transformed += morphTarget3 * morphTargetInfluences[ 3 ];
	#ifndef USE_MORPHNORMALS
	transformed += morphTarget4 * morphTargetInfluences[ 4 ];
	transformed += morphTarget5 * morphTargetInfluences[ 5 ];
	transformed += morphTarget6 * morphTargetInfluences[ 6 ];
	transformed += morphTarget7 * morphTargetInfluences[ 7 ];
	#endif
#endif`,normal_fragment_begin:`#ifdef FLAT_SHADED
	vec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );
	vec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );
	#endif
	#ifdef USE_TANGENT
		vec3 tangent = normalize( vTangent );
		vec3 bitangent = normalize( vBitangent );
		#ifdef DOUBLE_SIDED
			tangent = tangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );
			bitangent = bitangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );
		#endif
		#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )
			mat3 vTBN = mat3( tangent, bitangent, normal );
		#endif
	#endif
#endif
vec3 geometryNormal = normal;`,normal_fragment_maps:`#ifdef OBJECTSPACE_NORMALMAP
	normal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( TANGENTSPACE_NORMALMAP )
	vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	#ifdef USE_TANGENT
		normal = normalize( vTBN * mapN );
	#else
		normal = perturbNormal2Arb( -vViewPosition, normal, mapN );
	#endif
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );
#endif`,normalmap_pars_fragment:`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef OBJECTSPACE_NORMALMAP
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )
	vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN ) {
		vec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );
		vec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );
		vec2 st0 = dFdx( vUv.st );
		vec2 st1 = dFdy( vUv.st );
		float scale = sign( st1.t * st0.s - st0.t * st1.s );
		vec3 S = normalize( ( q0 * st1.t - q1 * st0.t ) * scale );
		vec3 T = normalize( ( - q0 * st1.s + q1 * st0.s ) * scale );
		vec3 N = normalize( surf_norm );
		mat3 tsn = mat3( S, T, N );
		mapN.xy *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );
		return normalize( tsn * mapN );
	}
#endif`,clearcoat_normal_fragment_begin:`#ifdef CLEARCOAT
	vec3 clearcoatNormal = geometryNormal;
#endif`,clearcoat_normal_fragment_maps:`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	#ifdef USE_TANGENT
		clearcoatNormal = normalize( vTBN * clearcoatMapN );
	#else
		clearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN );
	#endif
#endif`,clearcoat_pars_fragment:`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif`,packing:`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ));
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w);
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {
	return linearClipZ * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return (( near + viewZ ) * far ) / (( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * invClipZ - far );
}`,premultiplied_alpha_fragment:`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,project_vertex:`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,dithering_fragment:`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,dithering_pars_fragment:`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,roughnessmap_fragment:`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vUv );
	roughnessFactor *= texelRoughness.g;
#endif`,roughnessmap_pars_fragment:`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,shadowmap_pars_fragment:`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );
		bool inFrustum = all( inFrustumVec );
		bvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );
		bool frustumTest = all( frustumTestVec );
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), 
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), 
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,shadowmap_pars_vertex:`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];
		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,shadowmap_vertex:`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * worldPosition;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		vSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * worldPosition;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * worldPosition;
	}
	#pragma unroll_loop_end
	#endif
#endif`,shadowmask_pars_fragment:`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,skinbase_vertex:`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,skinning_pars_vertex:`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	#ifdef BONE_TEXTURE
		uniform highp sampler2D boneTexture;
		uniform int boneTextureSize;
		mat4 getBoneMatrix( const in float i ) {
			float j = i * 4.0;
			float x = mod( j, float( boneTextureSize ) );
			float y = floor( j / float( boneTextureSize ) );
			float dx = 1.0 / float( boneTextureSize );
			float dy = 1.0 / float( boneTextureSize );
			y = dy * ( y + 0.5 );
			vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );
			vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );
			vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );
			vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );
			mat4 bone = mat4( v1, v2, v3, v4 );
			return bone;
		}
	#else
		uniform mat4 boneMatrices[ MAX_BONES ];
		mat4 getBoneMatrix( const in float i ) {
			mat4 bone = boneMatrices[ int(i) ];
			return bone;
		}
	#endif
#endif`,skinning_vertex:`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,skinnormal_vertex:`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,specularmap_fragment:`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,specularmap_pars_fragment:`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,tonemapping_fragment:`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,tonemapping_pars_fragment:`#ifndef saturate
#define saturate(a) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
uniform float toneMappingWhitePoint;
vec3 LinearToneMapping( vec3 color ) {
	return toneMappingExposure * color;
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
#define Uncharted2Helper( x ) max( ( ( x * ( 0.15 * x + 0.10 * 0.50 ) + 0.20 * 0.02 ) / ( x * ( 0.15 * x + 0.50 ) + 0.20 * 0.30 ) ) - 0.02 / 0.30, vec3( 0.0 ) )
vec3 Uncharted2ToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( Uncharted2Helper( color ) / Uncharted2Helper( vec3( toneMappingWhitePoint ) ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( ( color * ( 2.51 * color + 0.03 ) ) / ( color * ( 2.43 * color + 0.59 ) + 0.14 ) );
}`,uv_pars_fragment:`#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )
	varying vec2 vUv;
#endif`,uv_pars_vertex:`#ifdef USE_UV
	#ifdef UVS_VERTEX_ONLY
		vec2 vUv;
	#else
		varying vec2 vUv;
	#endif
	uniform mat3 uvTransform;
#endif`,uv_vertex:`#ifdef USE_UV
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
#endif`,uv2_pars_fragment:`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	varying vec2 vUv2;
#endif`,uv2_pars_vertex:`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	attribute vec2 uv2;
	varying vec2 vUv2;
	uniform mat3 uv2Transform;
#endif`,uv2_vertex:`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	vUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;
#endif`,worldpos_vertex:`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`,background_frag:`uniform sampler2D t2D;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	gl_FragColor = mapTexelToLinear( texColor );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,background_vert:`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,cube_frag:`#include <envmap_common_pars_fragment>
uniform float opacity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	vec3 vReflect = vWorldDirection;
	#include <envmap_fragment>
	gl_FragColor = envColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,cube_vert:`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,depth_frag:`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,depth_vert:`#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,distanceRGBA_frag:`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,distanceRGBA_vert:`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,equirect_frag:`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	vec4 texColor = texture2D( tEquirect, sampleUV );
	gl_FragColor = mapTexelToLinear( texColor );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,equirect_vert:`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,linedashed_frag:`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,linedashed_vert:`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <color_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,meshbasic_frag:`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
	
		vec4 lightMapTexel= texture2D( lightMap, vUv2 );
		reflectedLight.indirectDiffuse += lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshbasic_vert:`#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <skinbase_vertex>
	#ifdef USE_ENVMAP
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,meshlambert_frag:`uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
varying vec3 vLightFront;
varying vec3 vIndirectFront;
#ifdef DOUBLE_SIDED
	varying vec3 vLightBack;
	varying vec3 vIndirectBack;
#endif
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <fog_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <emissivemap_fragment>
	#ifdef DOUBLE_SIDED
		reflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;
	#else
		reflectedLight.indirectDiffuse += vIndirectFront;
	#endif
	#include <lightmap_fragment>
	reflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );
	#ifdef DOUBLE_SIDED
		reflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;
	#else
		reflectedLight.directDiffuse = vLightFront;
	#endif
	reflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshlambert_vert:`#define LAMBERT
varying vec3 vLightFront;
varying vec3 vIndirectFront;
#ifdef DOUBLE_SIDED
	varying vec3 vLightBack;
	varying vec3 vIndirectBack;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <bsdfs>
#include <lights_pars_begin>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <lights_lambert_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,meshmatcap_frag:`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <fog_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
		matcapColor = matcapTexelToLinear( matcapColor );
	#else
		vec4 matcapColor = vec4( 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshmatcap_vert:`#define MATCAP
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#ifndef FLAT_SHADED
		vNormal = normalize( transformedNormal );
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,meshtoon_frag:`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshtoon_vert:`#define TOON
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,meshphong_frag:`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshphong_vert:`#define PHONG
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,meshphysical_frag:`#define STANDARD
#ifdef PHYSICAL
	#define REFLECTIVITY
	#define CLEARCOAT
	#define TRANSPARENCY
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef TRANSPARENCY
	uniform float transparency;
#endif
#ifdef REFLECTIVITY
	uniform float reflectivity;
#endif
#ifdef CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheen;
#endif
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <bsdfs>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <lights_physical_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#ifdef TRANSPARENCY
		diffuseColor.a *= saturate( 1. - transparency + linearToRelativeLuminance( reflectedLight.directSpecular + reflectedLight.indirectSpecular ) );
	#endif
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshphysical_vert:`#define STANDARD
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,normal_frag:`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <packing>
#include <uv_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
}`,normal_vert:`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	vViewPosition = - mvPosition.xyz;
#endif
}`,points_frag:`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,points_vert:`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <color_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,shadow_frag:`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,shadow_vert:`#include <fog_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <begin_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,sprite_frag:`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,sprite_vert:`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`},th={basic:{uniforms:uo([sr.common,sr.specularmap,sr.envmap,sr.aomap,sr.lightmap,sr.fog]),vertexShader:gi.meshbasic_vert,fragmentShader:gi.meshbasic_frag},lambert:{uniforms:uo([sr.common,sr.specularmap,sr.envmap,sr.aomap,sr.lightmap,sr.emissivemap,sr.fog,sr.lights,{emissive:{value:new Oe(0)}}]),vertexShader:gi.meshlambert_vert,fragmentShader:gi.meshlambert_frag},phong:{uniforms:uo([sr.common,sr.specularmap,sr.envmap,sr.aomap,sr.lightmap,sr.emissivemap,sr.bumpmap,sr.normalmap,sr.displacementmap,sr.fog,sr.lights,{emissive:{value:new Oe(0)},specular:{value:new Oe(1118481)},shininess:{value:30}}]),vertexShader:gi.meshphong_vert,fragmentShader:gi.meshphong_frag},standard:{uniforms:uo([sr.common,sr.envmap,sr.aomap,sr.lightmap,sr.emissivemap,sr.bumpmap,sr.normalmap,sr.displacementmap,sr.roughnessmap,sr.metalnessmap,sr.fog,sr.lights,{emissive:{value:new Oe(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:gi.meshphysical_vert,fragmentShader:gi.meshphysical_frag},toon:{uniforms:uo([sr.common,sr.specularmap,sr.aomap,sr.lightmap,sr.emissivemap,sr.bumpmap,sr.normalmap,sr.displacementmap,sr.gradientmap,sr.fog,sr.lights,{emissive:{value:new Oe(0)},specular:{value:new Oe(1118481)},shininess:{value:30}}]),vertexShader:gi.meshtoon_vert,fragmentShader:gi.meshtoon_frag},matcap:{uniforms:uo([sr.common,sr.bumpmap,sr.normalmap,sr.displacementmap,sr.fog,{matcap:{value:null}}]),vertexShader:gi.meshmatcap_vert,fragmentShader:gi.meshmatcap_frag},points:{uniforms:uo([sr.points,sr.fog]),vertexShader:gi.points_vert,fragmentShader:gi.points_frag},dashed:{uniforms:uo([sr.common,sr.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:gi.linedashed_vert,fragmentShader:gi.linedashed_frag},depth:{uniforms:uo([sr.common,sr.displacementmap]),vertexShader:gi.depth_vert,fragmentShader:gi.depth_frag},normal:{uniforms:uo([sr.common,sr.bumpmap,sr.normalmap,sr.displacementmap,{opacity:{value:1}}]),vertexShader:gi.normal_vert,fragmentShader:gi.normal_frag},sprite:{uniforms:uo([sr.sprite,sr.fog]),vertexShader:gi.sprite_vert,fragmentShader:gi.sprite_frag},background:{uniforms:{uvTransform:{value:new Jt},t2D:{value:null}},vertexShader:gi.background_vert,fragmentShader:gi.background_frag},cube:{uniforms:uo([sr.envmap,{opacity:{value:1}}]),vertexShader:gi.cube_vert,fragmentShader:gi.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:gi.equirect_vert,fragmentShader:gi.equirect_frag},distanceRGBA:{uniforms:uo([sr.common,sr.displacementmap,{referencePosition:{value:new dt},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:gi.distanceRGBA_vert,fragmentShader:gi.distanceRGBA_frag},shadow:{uniforms:uo([sr.lights,sr.fog,{color:{value:new Oe(0)},opacity:{value:1}}]),vertexShader:gi.shadow_vert,fragmentShader:gi.shadow_frag}};th.physical={uniforms:uo([th.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new Ot(1,1)},clearcoatNormalMap:{value:null},sheen:{value:new Oe(0)},transparency:{value:0}}]),vertexShader:gi.meshphysical_vert,fragmentShader:gi.meshphysical_frag},Fa.prototype=ft(le.prototype),Fa.prototype.constructor=Fa,Fa.prototype.isCubeTexture=!0,Object.defineProperty(Fa.prototype,"images",{get:function(){return this.image},set:function(t){this.image=t}}),Ch.prototype=ft(le.prototype),Ch.prototype.constructor=Ch,Ch.prototype.isDataTexture2DArray=!0,Th.prototype=ft(le.prototype),Th.prototype.constructor=Th,Th.prototype.isDataTexture3D=!0;var PC=new le,JI=new Ch,QI=new Th,DC=new Fa,OC=[],FC=[],BC=new Float32Array(16),zC=new Float32Array(9),NC=new Float32Array(4);a1.prototype.updateCache=function(t){var r=this.cache;t instanceof Float32Array&&r.length!==t.length&&(this.cache=new Float32Array(t.length)),Xo(r,t)},u1.prototype.setValue=function(t,r,i){for(var s=this.seq,f=0,c=s.length;f!==c;++f){var d=s[f];d.setValue(t,r[d.id],i)}};var v_=/([\w\d_]+)(\])?(\[|\.)?/g;Ls.prototype.setValue=function(t,r,i,s){r=this.map[r],r!==void 0&&r.setValue(t,i,s)},Ls.prototype.setOptional=function(t,r,i){r=r[i],r!==void 0&&this.setValue(t,i,r)},Ls.upload=function(t,r,i,s){for(var f=0,c=r.length;f!==c;++f){var d=r[f],p=i[d.id];p.needsUpdate!==!1&&d.setValue(t,p.value,s)}},Ls.seqWithValue=function(t,r){for(var i=[],s=0,f=t.length;s!==f;++s){var c=t[s];c.id in r&&i.push(c)}return i};var KI=0,y_=/^[ \t]*#include +<([\w\d./]+)>/gm,UC=/#pragma unroll_loop[\s]+?for \( int i = (\d+); i < (\d+); i \+\+ \) \{([\s\S]+?)(?=\})\}/g,bC=/#pragma unroll_loop_start[\s]+?for \( int i = (\d+); i < (\d+); i \+\+ \) \{([\s\S]+?)(?=\})\}[\s]+?#pragma unroll_loop_end/g,$I=0;wl.prototype=ft(Rr.prototype),wl.prototype.constructor=wl,wl.prototype.isMeshDepthMaterial=!0,wl.prototype.copy=function(t){return Rr.prototype.copy.call(this,t),this.depthPacking=t.depthPacking,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this},Ml.prototype=ft(Rr.prototype),Ml.prototype.constructor=Ml,Ml.prototype.isMeshDistanceMaterial=!0,Ml.prototype.copy=function(t){return Rr.prototype.copy.call(this,t),this.referencePosition.copy(t.referencePosition),this.nearDistance=t.nearDistance,this.farDistance=t.farDistance,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this},mg.prototype=pt(ft(en.prototype),{constructor:mg,isArrayCamera:!0}),Zo.prototype=pt(ft(fe.prototype),{constructor:Zo,isGroup:!0}),pt(ur.prototype,{constructor:ur,getTargetRaySpace:function(){return this._targetRay===null&&(this._targetRay=new Zo,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1),this._targetRay},getGripSpace:function(){return this._grip===null&&(this._grip=new Zo,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1),this._grip},dispatchEvent:function(t){return this._targetRay!==null&&this._targetRay.dispatchEvent(t),this._grip!==null&&this._grip.dispatchEvent(t),this},disconnect:function(t){return this.dispatchEvent({type:"disconnected",data:t}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this},update:function(t,r,i){var s=null,f=null,c=this._targetRay,d=this._grip;return t&&(c!==null&&(s=r.getPose(t.targetRaySpace,i),s!==null&&(c.matrix.fromArray(s.transform.matrix),c.matrix.decompose(c.position,c.rotation,c.scale))),d!==null&&t.gripSpace&&(f=r.getPose(t.gripSpace,i),f!==null&&(d.matrix.fromArray(f.transform.matrix),d.matrix.decompose(d.position,d.rotation,d.scale)))),c!==null&&(c.visible=s!==null),d!==null&&(d.visible=f!==null),this}}),pt(d1.prototype,se.prototype),pt(pn.prototype,{isFogExp2:!0,clone:function(){return new pn(this.color,this.density)},toJSON:function(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}),pt(gg.prototype,{isFog:!0,clone:function(){return new gg(this.color,this.near,this.far)},toJSON:function(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}),Object.defineProperty(Ue.prototype,"needsUpdate",{set:function(t){t===!0&&this.version++}}),pt(Ue.prototype,{isInterleavedBuffer:!0,onUploadCallback:function(){},setUsage:function(t){return this.usage=t,this},copy:function(t){return this.array=new t.array.constructor(t.array),this.count=t.count,this.stride=t.stride,this.usage=t.usage,this},copyAt:function(t,r,i){t*=this.stride,i*=r.stride;for(var s=0,f=this.stride;s<f;s++)this.array[t+s]=r.array[i+s];return this},set:function(t,r){return r===void 0&&(r=0),this.array.set(t,r),this},clone:function(){return new this.constructor().copy(this)},onUpload:function(t){return this.onUploadCallback=t,this}});var up=new dt;Or(Ro.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}}}),pt(Ro.prototype,{isInterleavedBufferAttribute:!0,applyMatrix4:function(t){for(var r=0,i=this.data.count;r<i;r++)up.x=this.getX(r),up.y=this.getY(r),up.z=this.getZ(r),up.applyMatrix4(t),this.setXYZ(r,up.x,up.y,up.z);return this},setX:function(t,r){return this.data.array[t*this.data.stride+this.offset]=r,this},setY:function(t,r){return this.data.array[t*this.data.stride+this.offset+1]=r,this},setZ:function(t,r){return this.data.array[t*this.data.stride+this.offset+2]=r,this},setW:function(t,r){return this.data.array[t*this.data.stride+this.offset+3]=r,this},getX:function(t){return this.data.array[t*this.data.stride+this.offset]},getY:function(t){return this.data.array[t*this.data.stride+this.offset+1]},getZ:function(t){return this.data.array[t*this.data.stride+this.offset+2]},getW:function(t){return this.data.array[t*this.data.stride+this.offset+3]},setXY:function(t,r,i){return t=t*this.data.stride+this.offset,this.data.array[t+0]=r,this.data.array[t+1]=i,this},setXYZ:function(t,r,i,s){return t=t*this.data.stride+this.offset,this.data.array[t+0]=r,this.data.array[t+1]=i,this.data.array[t+2]=s,this},setXYZW:function(t,r,i,s,f){return t=t*this.data.stride+this.offset,this.data.array[t+0]=r,this.data.array[t+1]=i,this.data.array[t+2]=s,this.data.array[t+3]=f,this},clone:function(){for(var t=[],r=0;r<this.count;r++)for(var i=r*this.data.stride+this.offset,s=0;s<this.itemSize;s++)t.push(this.data.array[i+s]);return new wr(new this.array.constructor(t),this.itemSize,this.normalized)},toJSON:function(){for(var t=[],r=0;r<this.count;r++)for(var i=r*this.data.stride+this.offset,s=0;s<this.itemSize;s++)t.push(this.data.array[i+s]);return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}}),Cl.prototype=ft(Rr.prototype),Cl.prototype.constructor=Cl,Cl.prototype.isSpriteMaterial=!0,Cl.prototype.copy=function(t){return Rr.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.alphaMap=t.alphaMap,this.rotation=t.rotation,this.sizeAttenuation=t.sizeAttenuation,this};var jd,Sv=new dt,Xd=new dt,Yd=new dt,Zd=new Ot,Iv=new Ot,kC=new Me,Fy=new dt,Ev=new dt,By=new dt,HC=new Ot,x_=new Ot,GC=new Ot;rd.prototype=pt(ft(fe.prototype),{constructor:rd,isSprite:!0,raycast:function(t,r){t.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),Xd.setFromMatrixScale(this.matrixWorld),kC.copy(t.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(t.camera.matrixWorldInverse,this.matrixWorld),Yd.setFromMatrixPosition(this.modelViewMatrix),t.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&Xd.multiplyScalar(-Yd.z);var i=this.material.rotation;if(i!==0)var s=Math.cos(i),f=Math.sin(i);i=this.center,Ih(Fy.set(-.5,-.5,0),Yd,i,Xd,f,s),Ih(Ev.set(.5,-.5,0),Yd,i,Xd,f,s),Ih(By.set(.5,.5,0),Yd,i,Xd,f,s),HC.set(0,0),x_.set(1,0),GC.set(1,1);var c=t.ray.intersectTriangle(Fy,Ev,By,!1,Sv);c===null&&(Ih(Ev.set(-.5,.5,0),Yd,i,Xd,f,s),x_.set(0,1),c=t.ray.intersectTriangle(Fy,By,Ev,!1,Sv),c===null)||(f=t.ray.origin.distanceTo(Sv),f<t.near||f>t.far||r.push({distance:f,point:Sv.clone(),uv:li.getUV(Sv,Fy,Ev,By,HC,x_,GC,new Ot),face:null,object:this}))},clone:function(){return new this.constructor(this.material).copy(this)},copy:function(t){return fe.prototype.copy.call(this,t),t.center!==void 0&&this.center.copy(t.center),this}});var zy=new dt,VC=new dt;id.prototype=pt(ft(fe.prototype),{constructor:id,isLOD:!0,copy:function(t){fe.prototype.copy.call(this,t,!1);for(var r=t.levels,i=0,s=r.length;i<s;i++){var f=r[i];this.addLevel(f.object.clone(),f.distance)}return this.autoUpdate=t.autoUpdate,this},addLevel:function(t,r){r===void 0&&(r=0),r=Math.abs(r);for(var i=this.levels,s=0;s<i.length&&!(r<i[s].distance);s++);return i.splice(s,0,{distance:r,object:t}),this.add(t),this},getCurrentLevel:function(){return this._currentLevel},getObjectForDistance:function(t){var r=this.levels;if(0<r.length){for(var i=1,s=r.length;i<s&&!(t<r[i].distance);i++);return r[i-1].object}return null},raycast:function(t,r){if(0<this.levels.length){zy.setFromMatrixPosition(this.matrixWorld);var i=t.ray.origin.distanceTo(zy);this.getObjectForDistance(i).raycast(t,r)}},update:function(t){var r=this.levels;if(1<r.length){zy.setFromMatrixPosition(t.matrixWorld),VC.setFromMatrixPosition(this.matrixWorld),t=zy.distanceTo(VC)/t.zoom,r[0].object.visible=!0;for(var i=1,s=r.length;i<s&&t>=r[i].distance;i++)r[i-1].object.visible=!1,r[i].object.visible=!0;for(this._currentLevel=i-1;i<s;i++)r[i].object.visible=!1}},toJSON:function(t){t=fe.prototype.toJSON.call(this,t),this.autoUpdate===!1&&(t.object.autoUpdate=!1),t.object.levels=[];for(var r=this.levels,i=0,s=r.length;i<s;i++){var f=r[i];t.object.levels.push({object:f.object.uuid,distance:f.distance})}return t}}),Eh.prototype=pt(ft(Zi.prototype),{constructor:Eh,isSkinnedMesh:!0,bind:function(t,r){this.skeleton=t,r===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),r=this.matrixWorld),this.bindMatrix.copy(r),this.bindMatrixInverse.getInverse(r)},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){for(var t=new jt,r=this.geometry.attributes.skinWeight,i=0,s=r.count;i<s;i++){t.x=r.getX(i),t.y=r.getY(i),t.z=r.getZ(i),t.w=r.getW(i);var f=1/t.manhattanLength();f!==1/0?t.multiplyScalar(f):t.set(1,0,0,0),r.setXYZW(i,t.x,t.y,t.z,t.w)}},updateMatrixWorld:function(t){Zi.prototype.updateMatrixWorld.call(this,t),this.bindMode==="attached"?this.bindMatrixInverse.getInverse(this.matrixWorld):this.bindMode==="detached"?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)},boneTransform:function(){var t=new dt,r=new jt,i=new jt,s=new dt,f=new Me;return function(c,d){var p=this.skeleton,A=this.geometry;for(r.fromBufferAttribute(A.attributes.skinIndex,c),i.fromBufferAttribute(A.attributes.skinWeight,c),t.fromBufferAttribute(A.attributes.position,c).applyMatrix4(this.bindMatrix),d.set(0,0,0),c=0;4>c;c++)if(A=i.getComponent(c),A!==0){var S=r.getComponent(c);f.multiplyMatrices(p.bones[S].matrixWorld,p.boneInverses[S]),d.addScaledVector(s.copy(t).applyMatrix4(f),A)}return d.applyMatrix4(this.bindMatrixInverse)}}()});var WC=new Me,tE=new Me;pt(Tl.prototype,{calculateInverses:function(){this.boneInverses=[];for(var t=0,r=this.bones.length;t<r;t++){var i=new Me;this.bones[t]&&i.getInverse(this.bones[t].matrixWorld),this.boneInverses.push(i)}},pose:function(){var t,r,i=0;for(r=this.bones.length;i<r;i++)(t=this.bones[i])&&t.matrixWorld.getInverse(this.boneInverses[i]);for(i=0,r=this.bones.length;i<r;i++)(t=this.bones[i])&&(t.parent&&t.parent.isBone?(t.matrix.getInverse(t.parent.matrixWorld),t.matrix.multiply(t.matrixWorld)):t.matrix.copy(t.matrixWorld),t.matrix.decompose(t.position,t.quaternion,t.scale))},update:function(){for(var t=this.bones,r=this.boneInverses,i=this.boneMatrices,s=this.boneTexture,f=0,c=t.length;f<c;f++)WC.multiplyMatrices(t[f]?t[f].matrixWorld:tE,r[f]),WC.toArray(i,16*f);s!==void 0&&(s.needsUpdate=!0)},clone:function(){return new Tl(this.bones,this.boneInverses)},getBoneByName:function(t){for(var r=0,i=this.bones.length;r<i;r++){var s=this.bones[r];if(s.name===t)return s}},dispose:function(){this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=void 0)}}),ia.prototype=pt(ft(fe.prototype),{constructor:ia,isBone:!0});var jC=new Me,XC=new Me,Ny=[],Lv=new Zi;_n.prototype=pt(ft(Zi.prototype),{constructor:_n,isInstancedMesh:!0,getMatrixAt:function(t,r){r.fromArray(this.instanceMatrix.array,16*t)},raycast:function(t,r){var i=this.matrixWorld,s=this.count;if(Lv.geometry=this.geometry,Lv.material=this.material,Lv.material!==void 0)for(var f=0;f<s;f++){this.getMatrixAt(f,jC),XC.multiplyMatrices(i,jC),Lv.matrixWorld=XC,Lv.raycast(t,Ny);for(var c=0,d=Ny.length;c<d;c++){var p=Ny[c];p.instanceId=f,p.object=this,r.push(p)}Ny.length=0}},setMatrixAt:function(t,r){r.toArray(this.instanceMatrix.array,16*t)},updateMorphTargets:function(){}}),$i.prototype=ft(Rr.prototype),$i.prototype.constructor=$i,$i.prototype.isLineBasicMaterial=!0,$i.prototype.copy=function(t){return Rr.prototype.copy.call(this,t),this.color.copy(t.color),this.linewidth=t.linewidth,this.linecap=t.linecap,this.linejoin=t.linejoin,this.morphTargets=t.morphTargets,this};var YC=new dt,ZC=new dt,qC=new Me,Uy=new Ln,by=new fn;Po.prototype=pt(ft(fe.prototype),{constructor:Po,isLine:!0,computeLineDistances:function(){var t=this.geometry;if(t.isBufferGeometry)if(t.index===null){for(var r=t.attributes.position,i=[0],s=1,f=r.count;s<f;s++)YC.fromBufferAttribute(r,s-1),ZC.fromBufferAttribute(r,s),i[s]=i[s-1],i[s]+=YC.distanceTo(ZC);t.setAttribute("lineDistance",new Ge(i,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(t.isGeometry)for(r=t.vertices,i=t.lineDistances,i[0]=0,s=1,f=r.length;s<f;s++)i[s]=i[s-1],i[s]+=r[s-1].distanceTo(r[s]);return this},raycast:function(t,r){var i=this.geometry,s=this.matrixWorld,f=t.params.Line.threshold;if(i.boundingSphere===null&&i.computeBoundingSphere(),by.copy(i.boundingSphere),by.applyMatrix4(s),by.radius+=f,t.ray.intersectsSphere(by)!==!1){qC.getInverse(s),Uy.copy(t.ray).applyMatrix4(qC),s=f/((this.scale.x+this.scale.y+this.scale.z)/3),s*=s;var c=new dt,d=new dt;f=new dt;var p=new dt,A=this&&this.isLineSegments?2:1;if(i.isBufferGeometry){var S=i.index,z=i.attributes.position.array;if(S!==null){S=S.array,i=0;for(var w=S.length-1;i<w;i+=A){var I=S[i+1];c.fromArray(z,3*S[i]),d.fromArray(z,3*I),I=Uy.distanceSqToSegment(c,d,p,f),I>s||(p.applyMatrix4(this.matrixWorld),I=t.ray.origin.distanceTo(p),I<t.near||I>t.far||r.push({distance:I,point:f.clone().applyMatrix4(this.matrixWorld),index:i,face:null,faceIndex:null,object:this}))}}else for(i=0,w=z.length/3-1;i<w;i+=A)c.fromArray(z,3*i),d.fromArray(z,3*i+3),I=Uy.distanceSqToSegment(c,d,p,f),I>s||(p.applyMatrix4(this.matrixWorld),I=t.ray.origin.distanceTo(p),I<t.near||I>t.far||r.push({distance:I,point:f.clone().applyMatrix4(this.matrixWorld),index:i,face:null,faceIndex:null,object:this}))}else if(i.isGeometry)for(c=i.vertices,d=c.length,i=0;i<d-1;i+=A)I=Uy.distanceSqToSegment(c[i],c[i+1],p,f),I>s||(p.applyMatrix4(this.matrixWorld),I=t.ray.origin.distanceTo(p),I<t.near||I>t.far||r.push({distance:I,point:f.clone().applyMatrix4(this.matrixWorld),index:i,face:null,faceIndex:null,object:this}))}},updateMorphTargets:function(){var t=this.geometry;if(t.isBufferGeometry){t=t.morphAttributes;var r=Ti(t);if(0<r.length){var i=t[r[0]];if(i!==void 0)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},t=0,r=i.length;t<r;t++){var s=i[t].name||String(t);this.morphTargetInfluences.push(0),this.morphTargetDictionary[s]=t}}}else t=t.morphTargets,t!==void 0&&0<t.length&&console.error("THREE.Line.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});var ky=new dt,Hy=new dt;Fi.prototype=pt(ft(Po.prototype),{constructor:Fi,isLineSegments:!0,computeLineDistances:function(){var t=this.geometry;if(t.isBufferGeometry)if(t.index===null){for(var r=t.attributes.position,i=[],s=0,f=r.count;s<f;s+=2)ky.fromBufferAttribute(r,s),Hy.fromBufferAttribute(r,s+1),i[s]=s===0?0:i[s-1],i[s+1]=i[s]+ky.distanceTo(Hy);t.setAttribute("lineDistance",new Ge(i,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(t.isGeometry)for(r=t.vertices,i=t.lineDistances,s=0,f=r.length;s<f;s+=2)ky.copy(r[s]),Hy.copy(r[s+1]),i[s]=s===0?0:i[s-1],i[s+1]=i[s]+ky.distanceTo(Hy);return this}}),of.prototype=pt(ft(Po.prototype),{constructor:of,isLineLoop:!0}),Ps.prototype=ft(Rr.prototype),Ps.prototype.constructor=Ps,Ps.prototype.isPointsMaterial=!0,Ps.prototype.copy=function(t){return Rr.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.alphaMap=t.alphaMap,this.size=t.size,this.sizeAttenuation=t.sizeAttenuation,this.morphTargets=t.morphTargets,this};var JC=new Me,A_=new Ln,Gy=new fn,Vy=new dt;Ru.prototype=pt(ft(fe.prototype),{constructor:Ru,isPoints:!0,raycast:function(t,r){var i=this.geometry,s=this.matrixWorld,f=t.params.Points.threshold;if(i.boundingSphere===null&&i.computeBoundingSphere(),Gy.copy(i.boundingSphere),Gy.applyMatrix4(s),Gy.radius+=f,t.ray.intersectsSphere(Gy)!==!1)if(JC.getInverse(s),A_.copy(t.ray).applyMatrix4(JC),f/=(this.scale.x+this.scale.y+this.scale.z)/3,f*=f,i.isBufferGeometry){var c=i.index;if(i=i.attributes.position.array,c!==null){var d=c.array;c=0;for(var p=d.length;c<p;c++){var A=d[c];Vy.fromArray(i,3*A),sf(Vy,A,f,s,t,r,this)}}else for(c=0,d=i.length/3;c<d;c++)Vy.fromArray(i,3*c),sf(Vy,c,f,s,t,r,this)}else for(i=i.vertices,c=0,d=i.length;c<d;c++)sf(i[c],c,f,s,t,r,this)},updateMorphTargets:function(){var t=this.geometry;if(t.isBufferGeometry){t=t.morphAttributes;var r=Ti(t);if(0<r.length){var i=t[r[0]];if(i!==void 0)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},t=0,r=i.length;t<r;t++){var s=i[t].name||String(t);this.morphTargetInfluences.push(0),this.morphTargetDictionary[s]=t}}}else t=t.morphTargets,t!==void 0&&0<t.length&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),m1.prototype=pt(ft(le.prototype),{constructor:m1,isVideoTexture:!0,update:function(){var t=this.image;t.readyState>=t.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}),Sl.prototype=ft(le.prototype),Sl.prototype.constructor=Sl,Sl.prototype.isCompressedTexture=!0,nd.prototype=ft(le.prototype),nd.prototype.constructor=nd,nd.prototype.isCanvasTexture=!0,Ds.prototype=ft(le.prototype),Ds.prototype.constructor=Ds,Ds.prototype.isDepthTexture=!0,af.prototype=ft(ke.prototype),af.prototype.constructor=af,uf.prototype=ft(Gr.prototype),uf.prototype.constructor=uf,Il.prototype=ft(ke.prototype),Il.prototype.constructor=Il,Lh.prototype=ft(Gr.prototype),Lh.prototype.constructor=Lh,Do.prototype=ft(ke.prototype),Do.prototype.constructor=Do,Rh.prototype=ft(Gr.prototype),Rh.prototype.constructor=Rh,Pu.prototype=ft(Do.prototype),Pu.prototype.constructor=Pu,od.prototype=ft(Gr.prototype),od.prototype.constructor=od,na.prototype=ft(Do.prototype),na.prototype.constructor=na,El.prototype=ft(Gr.prototype),El.prototype.constructor=El,lf.prototype=ft(Do.prototype),lf.prototype.constructor=lf,Ph.prototype=ft(Gr.prototype),Ph.prototype.constructor=Ph,Ll.prototype=ft(Do.prototype),Ll.prototype.constructor=Ll,sd.prototype=ft(Gr.prototype),sd.prototype.constructor=sd,Rl.prototype=ft(ke.prototype),Rl.prototype.constructor=Rl,Rl.prototype.toJSON=function(){var t=ke.prototype.toJSON.call(this);return t.path=this.parameters.path.toJSON(),t},hf.prototype=ft(Gr.prototype),hf.prototype.constructor=hf,cf.prototype=ft(ke.prototype),cf.prototype.constructor=cf,ff.prototype=ft(Gr.prototype),ff.prototype.constructor=ff,Dh.prototype=ft(ke.prototype),Dh.prototype.constructor=Dh;var eE={triangulate:function(t,r,i){i=i||2;var s=r&&r.length,f=s?r[0]*i:t.length,c=vg(t,0,f,i,!0),d=[];if(!c||c.next===c.prev)return d;var p;if(s){var A=i;s=[];var S,z=0;for(S=r.length;z<S;z++){var w=r[z]*A,I=z<S-1?r[z+1]*A:t.length;w=vg(t,w,I,A,!1),w===w.next&&(w.steiner=!0),s.push(ad(w))}for(s.sort(Pl),z=0;z<s.length;z++)A=s[z],r=c,(r=v1(A,r))&&(A=ls(r,A),Os(r,r.next),Os(A,A.next)),c=Os(c,c.next)}if(t.length>80*i){var E=p=t[0],P=s=t[1];for(A=i;A<f;A+=i)z=t[A],r=t[A+1],z<E&&(E=z),r<P&&(P=r),z>p&&(p=z),r>s&&(s=r);p=Math.max(p-E,s-P),p=p!==0?1/p:0}return pf(c,d,i,E,P,p),d}},gc={area:function(t){for(var r=t.length,i=0,s=r-1,f=0;f<r;s=f++)i+=t[s].x*t[f].y-t[f].x*t[s].y;return .5*i},isClockWise:function(t){return 0>gc.area(t)},triangulateShape:function(t,r){var i=[],s=[],f=[];ud(t),yg(i,t);var c=t.length;for(r.forEach(ud),t=0;t<r.length;t++)s.push(c),c+=r[t].length,yg(i,r[t]);for(r=eE.triangulate(i,s),t=0;t<r.length;t+=3)f.push(r.slice(t,t+3));return f}};Ou.prototype=ft(Gr.prototype),Ou.prototype.constructor=Ou,Ou.prototype.toJSON=function(){var t=Gr.prototype.toJSON.call(this);return xg(this.parameters.shapes,this.parameters.options,t)},hs.prototype=ft(ke.prototype),hs.prototype.constructor=hs,hs.prototype.toJSON=function(){var t=ke.prototype.toJSON.call(this);return xg(this.parameters.shapes,this.parameters.options,t)};var rE={generateTopUV:function(t,r,i,s,f){t=r[3*s],s=r[3*s+1];var c=r[3*f];return f=r[3*f+1],[new Ot(r[3*i],r[3*i+1]),new Ot(t,s),new Ot(c,f)]},generateSideWallUV:function(t,r,i,s,f,c){t=r[3*i];var d=r[3*i+1];i=r[3*i+2];var p=r[3*s],A=r[3*s+1];s=r[3*s+2];var S=r[3*f],z=r[3*f+1];f=r[3*f+2];var w=r[3*c],I=r[3*c+1];return r=r[3*c+2],.01>Math.abs(d-A)?[new Ot(t,1-i),new Ot(p,1-s),new Ot(S,1-f),new Ot(w,1-r)]:[new Ot(d,1-i),new Ot(A,1-s),new Ot(z,1-f),new Ot(I,1-r)]}};ld.prototype=ft(Gr.prototype),ld.prototype.constructor=ld,Oh.prototype=ft(hs.prototype),Oh.prototype.constructor=Oh,gf.prototype=ft(Gr.prototype),gf.prototype.constructor=gf,Fl.prototype=ft(ke.prototype),Fl.prototype.constructor=Fl,vf.prototype=ft(Gr.prototype),vf.prototype.constructor=vf,Fh.prototype=ft(ke.prototype),Fh.prototype.constructor=Fh,yf.prototype=ft(Gr.prototype),yf.prototype.constructor=yf,Bh.prototype=ft(ke.prototype),Bh.prototype.constructor=Bh,zh.prototype=ft(Gr.prototype),zh.prototype.constructor=zh,zh.prototype.toJSON=function(){var t=Gr.prototype.toJSON.call(this);return Ag(this.parameters.shapes,t)},oa.prototype=ft(ke.prototype),oa.prototype.constructor=oa,oa.prototype.toJSON=function(){var t=ke.prototype.toJSON.call(this);return Ag(this.parameters.shapes,t)},ka.prototype=ft(ke.prototype),ka.prototype.constructor=ka,kn.prototype=ft(Gr.prototype),kn.prototype.constructor=kn,Fu.prototype=ft(ke.prototype),Fu.prototype.constructor=Fu,_r.prototype=ft(kn.prototype),_r.prototype.constructor=_r,hd.prototype=ft(Fu.prototype),hd.prototype.constructor=hd,cd.prototype=ft(Gr.prototype),cd.prototype.constructor=cd,Nh.prototype=ft(ke.prototype),Nh.prototype.constructor=Nh;var rs=$a({__proto__:null,WireframeGeometry:af,ParametricGeometry:uf,ParametricBufferGeometry:Il,TetrahedronGeometry:Rh,TetrahedronBufferGeometry:Pu,OctahedronGeometry:od,OctahedronBufferGeometry:na,IcosahedronGeometry:El,IcosahedronBufferGeometry:lf,DodecahedronGeometry:Ph,DodecahedronBufferGeometry:Ll,PolyhedronGeometry:Lh,PolyhedronBufferGeometry:Do,TubeGeometry:sd,TubeBufferGeometry:Rl,TorusKnotGeometry:hf,TorusKnotBufferGeometry:cf,TorusGeometry:ff,TorusBufferGeometry:Dh,TextGeometry:ld,TextBufferGeometry:Oh,SphereGeometry:gf,SphereBufferGeometry:Fl,RingGeometry:vf,RingBufferGeometry:Fh,PlaneGeometry:Qc,PlaneBufferGeometry:Oa,LatheGeometry:yf,LatheBufferGeometry:Bh,ShapeGeometry:zh,ShapeBufferGeometry:oa,ExtrudeGeometry:Ou,ExtrudeBufferGeometry:hs,EdgesGeometry:ka,ConeGeometry:_r,ConeBufferGeometry:hd,CylinderGeometry:kn,CylinderBufferGeometry:Fu,CircleGeometry:cd,CircleBufferGeometry:Nh,BoxGeometry:qI,BoxBufferGeometry:Dy});Uh.prototype=ft(Rr.prototype),Uh.prototype.constructor=Uh,Uh.prototype.isShadowMaterial=!0,Uh.prototype.copy=function(t){return Rr.prototype.copy.call(this,t),this.color.copy(t.color),this},xf.prototype=ft(Ki.prototype),xf.prototype.constructor=xf,xf.prototype.isRawShaderMaterial=!0,yo.prototype=ft(Rr.prototype),yo.prototype.constructor=yo,yo.prototype.isMeshStandardMaterial=!0,yo.prototype.copy=function(t){return Rr.prototype.copy.call(this,t),this.defines={STANDARD:""},this.color.copy(t.color),this.roughness=t.roughness,this.metalness=t.metalness,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.roughnessMap=t.roughnessMap,this.metalnessMap=t.metalnessMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.envMapIntensity=t.envMapIntensity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.vertexTangents=t.vertexTangents,this},Bl.prototype=ft(yo.prototype),Bl.prototype.constructor=Bl,Bl.prototype.isMeshPhysicalMaterial=!0,Bl.prototype.copy=function(t){return yo.prototype.copy.call(this,t),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=t.clearcoat,this.clearcoatMap=t.clearcoatMap,this.clearcoatRoughness=t.clearcoatRoughness,this.clearcoatRoughnessMap=t.clearcoatRoughnessMap,this.clearcoatNormalMap=t.clearcoatNormalMap,this.clearcoatNormalScale.copy(t.clearcoatNormalScale),this.reflectivity=t.reflectivity,this.sheen=t.sheen?(this.sheen||new Oe).copy(t.sheen):null,this.transparency=t.transparency,this},Ha.prototype=ft(Rr.prototype),Ha.prototype.constructor=Ha,Ha.prototype.isMeshPhongMaterial=!0,Ha.prototype.copy=function(t){return Rr.prototype.copy.call(this,t),this.color.copy(t.color),this.specular.copy(t.specular),this.shininess=t.shininess,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},yr.prototype=ft(Rr.prototype),yr.prototype.constructor=yr,yr.prototype.isMeshToonMaterial=!0,yr.prototype.copy=function(t){return Rr.prototype.copy.call(this,t),this.color.copy(t.color),this.specular.copy(t.specular),this.shininess=t.shininess,this.map=t.map,this.gradientMap=t.gradientMap,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},bh.prototype=ft(Rr.prototype),bh.prototype.constructor=bh,bh.prototype.isMeshNormalMaterial=!0,bh.prototype.copy=function(t){return Rr.prototype.copy.call(this,t),this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},kh.prototype=ft(Rr.prototype),kh.prototype.constructor=kh,kh.prototype.isMeshLambertMaterial=!0,kh.prototype.copy=function(t){return Rr.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},Ga.prototype=ft(Rr.prototype),Ga.prototype.constructor=Ga,Ga.prototype.isMeshMatcapMaterial=!0,Ga.prototype.copy=function(t){return Rr.prototype.copy.call(this,t),this.defines={MATCAP:""},this.color.copy(t.color),this.matcap=t.matcap,this.map=t.map,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.alphaMap=t.alphaMap,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},Hh.prototype=ft($i.prototype),Hh.prototype.constructor=Hh,Hh.prototype.isLineDashedMaterial=!0,Hh.prototype.copy=function(t){return $i.prototype.copy.call(this,t),this.scale=t.scale,this.dashSize=t.dashSize,this.gapSize=t.gapSize,this};var iE=$a({__proto__:null,ShadowMaterial:Uh,SpriteMaterial:Cl,RawShaderMaterial:xf,ShaderMaterial:Ki,PointsMaterial:Ps,MeshPhysicalMaterial:Bl,MeshStandardMaterial:yo,MeshPhongMaterial:Ha,MeshToonMaterial:yr,MeshNormalMaterial:bh,MeshLambertMaterial:kh,MeshDepthMaterial:wl,MeshDistanceMaterial:Ml,MeshBasicMaterial:Nn,MeshMatcapMaterial:Ga,LineDashedMaterial:Hh,LineBasicMaterial:$i,Material:Rr}),Sn={arraySlice:function(t,r,i){return Sn.isTypedArray(t)?new t.constructor(t.subarray(r,i!==void 0?i:t.length)):t.slice(r,i)},convertArray:function(t,r,i){return!t||!i&&t.constructor===r?t:typeof r.BYTES_PER_ELEMENT=="number"?new r(t):Array.prototype.slice.call(t)},isTypedArray:function(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)},getKeyframeOrder:function(t){for(var r=t.length,i=Array(r),s=0;s!==r;++s)i[s]=s;return i.sort(function(f,c){return t[f]-t[c]}),i},sortedArray:function(t,r,i){for(var s=t.length,f=new t.constructor(s),c=0,d=0;d!==s;++c)for(var p=i[c]*r,A=0;A!==r;++A)f[d++]=t[p+A];return f},flattenJSON:function(t,r,i,s){for(var f=1,c=t[0];c!==void 0&&c[s]===void 0;)c=t[f++];if(c!==void 0){var d=c[s];if(d!==void 0)if(Array.isArray(d))do d=c[s],d!==void 0&&(r.push(c.time),i.push.apply(i,d)),c=t[f++];while(c!==void 0);else if(d.toArray!==void 0)do d=c[s],d!==void 0&&(r.push(c.time),d.toArray(i,i.length)),c=t[f++];while(c!==void 0);else do d=c[s],d!==void 0&&(r.push(c.time),i.push(d)),c=t[f++];while(c!==void 0)}},subclip:function(t,r,i,s,f){f=f||30,t=t.clone(),t.name=r;var c=[];for(r=0;r<t.tracks.length;++r){for(var d=t.tracks[r],p=d.getValueSize(),A=[],S=[],z=0;z<d.times.length;++z){var w=d.times[z]*f;if(!(w<i||w>=s))for(A.push(d.times[z]),w=0;w<p;++w)S.push(d.values[z*p+w])}A.length!==0&&(d.times=Sn.convertArray(A,d.times.constructor),d.values=Sn.convertArray(S,d.values.constructor),c.push(d))}for(t.tracks=c,i=1/0,r=0;r<t.tracks.length;++r)i>t.tracks[r].times[0]&&(i=t.tracks[r].times[0]);for(r=0;r<t.tracks.length;++r)t.tracks[r].shift(-1*i);return t.resetDuration(),t},makeClipAdditive:function(t,r,i,s){r===void 0&&(r=0),i===void 0&&(i=t),(s===void 0||0>=s)&&(s=30);var f=t.tracks.length;for(r/=s,s=0;s<f;++s){var c=i.tracks[s],d=c.ValueTypeName;if(d!=="bool"&&d!=="string"){var p=t.tracks.find(function(P){return P.name===c.name&&P.ValueTypeName===d});if(p!==void 0){var A=c.getValueSize(),S=c.times.length-1;r<=c.times[0]?S=Sn.arraySlice(c.values,0,c.valueSize):r>=c.times[S]?S=Sn.arraySlice(c.values,S*A):(S=c.createInterpolant(),S.evaluate(r),S=S.resultBuffer),d==="quaternion"&&new ye(S[0],S[1],S[2],S[3]).normalize().conjugate().toArray(S);for(var z=p.times.length,w=0;w<z;++w){var I=w*A;if(d==="quaternion")ye.multiplyQuaternionsFlat(p.values,I,S,0,p.values,I);else for(var E=0;E<A;++E)p.values[I+E]-=S[E]}}}}return t.blendMode=2501,t}};pt(Oo.prototype,{evaluate:function(t){var r=this.parameterPositions,i=this._cachedIndex,s=r[i],f=r[i-1];t:{e:{r:{i:if(!(t<s)){for(var c=i+2;;){if(s===void 0){if(t<f)break i;return this._cachedIndex=i=r.length,this.afterEnd_(i-1,t,f)}if(i===c)break;if(f=s,s=r[++i],t<s)break e}s=r.length;break r}if(t>=f)break t;for(c=r[1],t<c&&(i=2,f=c),c=i-2;;){if(f===void 0)return this._cachedIndex=0,this.beforeStart_(0,t,s);if(i===c)break;if(s=f,f=r[--i-1],t>=f)break e}s=i,i=0}for(;i<s;)f=i+s>>>1,t<r[f]?s=f:i=f+1;if(s=r[i],f=r[i-1],f===void 0)return this._cachedIndex=0,this.beforeStart_(0,t,s);if(s===void 0)return this._cachedIndex=i=r.length,this.afterEnd_(i-1,f,t)}this._cachedIndex=i,this.intervalChanged_(i,f,s)}return this.interpolate_(i,f,t,s)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(t){var r=this.resultBuffer,i=this.sampleValues,s=this.valueSize;t*=s;for(var f=0;f!==s;++f)r[f]=i[t+f];return r},interpolate_:function(){throw Error("call to abstract method")},intervalChanged_:function(){}}),pt(Oo.prototype,{beforeStart_:Oo.prototype.copySampleValue_,afterEnd_:Oo.prototype.copySampleValue_}),zl.prototype=pt(ft(Oo.prototype),{constructor:zl,DefaultSettings_:{endingStart:2400,endingEnd:2400},intervalChanged_:function(t,r,i){var s=this.parameterPositions,f=t-2,c=t+1,d=s[f],p=s[c];if(d===void 0)switch(this.getSettings_().endingStart){case 2401:f=t,d=2*r-i;break;case 2402:f=s.length-2,d=r+s[f]-s[f+1];break;default:f=t,d=i}if(p===void 0)switch(this.getSettings_().endingEnd){case 2401:c=t,p=2*i-r;break;case 2402:c=1,p=i+s[1]-s[0];break;default:c=t-1,p=r}t=.5*(i-r),s=this.valueSize,this._weightPrev=t/(r-d),this._weightNext=t/(p-i),this._offsetPrev=f*s,this._offsetNext=c*s},interpolate_:function(t,r,i,s){var f=this.resultBuffer,c=this.sampleValues,d=this.valueSize;t*=d;var p=t-d,A=this._offsetPrev,S=this._offsetNext,z=this._weightPrev,w=this._weightNext,I=(i-r)/(s-r);for(i=I*I,s=i*I,r=-z*s+2*z*i-z*I,z=(1+z)*s+(-1.5-2*z)*i+(-.5+z)*I+1,I=(-1-w)*s+(1.5+w)*i+.5*I,w=w*s-w*i,i=0;i!==d;++i)f[i]=r*c[A+i]+z*c[p+i]+I*c[t+i]+w*c[S+i];return f}}),fd.prototype=pt(ft(Oo.prototype),{constructor:fd,interpolate_:function(t,r,i,s){var f=this.resultBuffer,c=this.sampleValues,d=this.valueSize;t*=d;var p=t-d;for(r=(i-r)/(s-r),i=1-r,s=0;s!==d;++s)f[s]=c[p+s]*i+c[t+s]*r;return f}}),Af.prototype=pt(ft(Oo.prototype),{constructor:Af,interpolate_:function(t){return this.copySampleValue_(t-1)}}),pt(co,{toJSON:function(t){var r=t.constructor;if(r.toJSON!==void 0)r=r.toJSON(t);else{r={name:t.name,times:Sn.convertArray(t.times,Array),values:Sn.convertArray(t.values,Array)};var i=t.getInterpolation();i!==t.DefaultInterpolation&&(r.interpolation=i)}return r.type=t.ValueTypeName,r}}),pt(co.prototype,{constructor:co,TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:2301,InterpolantFactoryMethodDiscrete:function(t){return new Af(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodLinear:function(t){return new fd(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodSmooth:function(t){return new zl(this.times,this.values,this.getValueSize(),t)},setInterpolation:function(t){switch(t){case 2300:var r=this.InterpolantFactoryMethodDiscrete;break;case 2301:r=this.InterpolantFactoryMethodLinear;break;case 2302:r=this.InterpolantFactoryMethodSmooth}if(r===void 0){if(r="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name,this.createInterpolant===void 0)if(t!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw Error(r);return console.warn("THREE.KeyframeTrack:",r),this}return this.createInterpolant=r,this},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return 2300;case this.InterpolantFactoryMethodLinear:return 2301;case this.InterpolantFactoryMethodSmooth:return 2302}},getValueSize:function(){return this.values.length/this.times.length},shift:function(t){if(t!==0)for(var r=this.times,i=0,s=r.length;i!==s;++i)r[i]+=t;return this},scale:function(t){if(t!==1)for(var r=this.times,i=0,s=r.length;i!==s;++i)r[i]*=t;return this},trim:function(t,r){for(var i=this.times,s=i.length,f=0,c=s-1;f!==s&&i[f]<t;)++f;for(;c!==-1&&i[c]>r;)--c;return++c,(f!==0||c!==s)&&(f>=c&&(c=Math.max(c,1),f=c-1),t=this.getValueSize(),this.times=Sn.arraySlice(i,f,c),this.values=Sn.arraySlice(this.values,f*t,c*t)),this},validate:function(){var t=!0,r=this.getValueSize();r-Math.floor(r)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),t=!1);var i=this.times;r=this.values;var s=i.length;s===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),t=!1);for(var f=null,c=0;c!==s;c++){var d=i[c];if(typeof d=="number"&&isNaN(d)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,c,d),t=!1;break}if(f!==null&&f>d){console.error("THREE.KeyframeTrack: Out of order keys.",this,c,d,f),t=!1;break}f=d}if(r!==void 0&&Sn.isTypedArray(r)){for(c=0,i=r.length;c!==i;++c)if(s=r[c],isNaN(s)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,c,s),t=!1;break}}return t},optimize:function(){for(var t=Sn.arraySlice(this.times),r=Sn.arraySlice(this.values),i=this.getValueSize(),s=this.getInterpolation()===2302,f=1,c=t.length-1,d=1;d<c;++d){var p=!1,A=t[d];if(A!==t[d+1]&&(d!==1||A!==A[0]))if(s)p=!0;else{var S=d*i,z=S-i,w=S+i;for(A=0;A!==i;++A){var I=r[S+A];if(I!==r[z+A]||I!==r[w+A]){p=!0;break}}}if(p){if(d!==f)for(t[f]=t[d],p=d*i,S=f*i,A=0;A!==i;++A)r[S+A]=r[p+A];++f}}if(0<c){for(t[f]=t[c],p=c*i,S=f*i,A=0;A!==i;++A)r[S+A]=r[p+A];++f}return f!==t.length?(this.times=Sn.arraySlice(t,0,f),this.values=Sn.arraySlice(r,0,f*i)):(this.times=t,this.values=r),this},clone:function(){var t=Sn.arraySlice(this.times,0),r=Sn.arraySlice(this.values,0);return t=new this.constructor(this.name,t,r),t.createInterpolant=this.createInterpolant,t}}),Nl.prototype=pt(ft(co.prototype),{constructor:Nl,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:2300,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),Bu.prototype=pt(ft(co.prototype),{constructor:Bu,ValueTypeName:"color"}),Gh.prototype=pt(ft(co.prototype),{constructor:Gh,ValueTypeName:"number"}),Ri.prototype=pt(ft(Oo.prototype),{constructor:Ri,interpolate_:function(t,r,i,s){var f=this.resultBuffer,c=this.sampleValues,d=this.valueSize;for(t*=d,r=(i-r)/(s-r),i=t+d;t!==i;t+=4)ye.slerpFlat(f,0,c,t-d,c,t,r);return f}}),Vh.prototype=pt(ft(co.prototype),{constructor:Vh,ValueTypeName:"quaternion",DefaultInterpolation:2301,InterpolantFactoryMethodLinear:function(t){return new Ri(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodSmooth:void 0}),pd.prototype=pt(ft(co.prototype),{constructor:pd,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:2300,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),Ul.prototype=pt(ft(co.prototype),{constructor:Ul,ValueTypeName:"vector"}),pt(Fo,{parse:function(t){for(var r=[],i=t.tracks,s=1/(t.fps||1),f=0,c=i.length;f!==c;++f)r.push(A1(i[f]).scale(s));return new Fo(t.name,t.duration,r,t.blendMode)},toJSON:function(t){var r=[],i=t.tracks;t={name:t.name,duration:t.duration,tracks:r,uuid:t.uuid,blendMode:t.blendMode};for(var s=0,f=i.length;s!==f;++s)r.push(co.toJSON(i[s]));return t},CreateFromMorphTargetSequence:function(t,r,i,s){for(var f=r.length,c=[],d=0;d<f;d++){var p=[],A=[];p.push((d+f-1)%f,d,(d+1)%f),A.push(0,1,0);var S=Sn.getKeyframeOrder(p);p=Sn.sortedArray(p,1,S),A=Sn.sortedArray(A,1,S),s||p[0]!==0||(p.push(f),A.push(A[0])),c.push(new Gh(".morphTargetInfluences["+r[d].name+"]",p,A).scale(1/i))}return new Fo(t,-1,c)},findByName:function(t,r){var i=t;for(Array.isArray(t)||(i=t.geometry&&t.geometry.animations||t.animations),t=0;t<i.length;t++)if(i[t].name===r)return i[t];return null},CreateClipsFromMorphTargetSequences:function(t,r,i){for(var s={},f=/^([\w-]*?)([\d]+)$/,c=0,d=t.length;c<d;c++){var p=t[c],A=p.name.match(f);if(A&&1<A.length){var S=A[1];(A=s[S])||(s[S]=A=[]),A.push(p)}}t=[];for(S in s)t.push(Fo.CreateFromMorphTargetSequence(S,s[S],r,i));return t},parseAnimation:function(t,r){if(!t)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;var i=function(X,q,J,it,lt){if(J.length!==0){var Mt=[],Ct=[];Sn.flattenJSON(J,Mt,Ct,it),Mt.length!==0&&lt.push(new X(q,Mt,Ct))}},s=[],f=t.name||"default",c=t.length||-1,d=t.fps||30,p=t.blendMode;t=t.hierarchy||[];for(var A=0;A<t.length;A++){var S=t[A].keys;if(S&&S.length!==0)if(S[0].morphTargets){c={};for(var z=0;z<S.length;z++)if(S[z].morphTargets)for(var w=0;w<S[z].morphTargets.length;w++)c[S[z].morphTargets[w]]=-1;for(var I in c){var E=[],P=[];for(w=0;w!==S[z].morphTargets.length;++w){var F=S[z];E.push(F.time),P.push(F.morphTarget===I?1:0)}s.push(new Gh(".morphTargetInfluence["+I+"]",E,P))}c=c.length*(d||1)}else z=".bones["+r[A].name+"]",i(Ul,z+".position",S,"pos",s),i(Vh,z+".quaternion",S,"rot",s),i(Ul,z+".scale",S,"scl",s)}return s.length===0?null:new Fo(f,c,s,p)}}),pt(Fo.prototype,{resetDuration:function(){for(var t=0,r=0,i=this.tracks.length;r!==i;++r){var s=this.tracks[r];t=Math.max(t,s.times[s.times.length-1])}return this.duration=t,this},trim:function(){for(var t=0;t<this.tracks.length;t++)this.tracks[t].trim(0,this.duration);return this},validate:function(){for(var t=!0,r=0;r<this.tracks.length;r++)t=t&&this.tracks[r].validate();return t},optimize:function(){for(var t=0;t<this.tracks.length;t++)this.tracks[t].optimize();return this},clone:function(){for(var t=[],r=0;r<this.tracks.length;r++)t.push(this.tracks[r].clone());return new Fo(this.name,this.duration,t,this.blendMode)}});var qd={enabled:!1,files:{},add:function(t,r){this.enabled!==!1&&(this.files[t]=r)},get:function(t){if(this.enabled!==!1)return this.files[t]},remove:function(t){delete this.files[t]},clear:function(){this.files={}}},QC=new _1;pt(ai.prototype,{load:function(){},loadAsync:function(t,r){var i=this;return new di(function(s,f){i.load(t,s,r,f)})},parse:function(){},setCrossOrigin:function(t){return this.crossOrigin=t,this},setPath:function(t){return this.path=t,this},setResourcePath:function(t){return this.resourcePath=t,this},setRequestHeader:function(t){return this.requestHeader=t,this}});var nu={};eo.prototype=pt(ft(ai.prototype),{constructor:eo,load:function(t,r,i,s){t===void 0&&(t=""),this.path!==void 0&&(t=this.path+t),t=this.manager.resolveURL(t);var f=this,c=qd.get(t);if(c!==void 0)return f.manager.itemStart(t),setTimeout(function(){r&&r(c),f.manager.itemEnd(t)},0),c;if(nu[t]!==void 0)nu[t].push({onLoad:r,onProgress:i,onError:s});else{var d=t.match(/^data:(.*?)(;base64)?,(.*)$/);if(d){i=d[1];var p=!!d[2];d=d[3],d=decodeURIComponent(d),p&&(d=atob(d));try{var A=(this.responseType||"").toLowerCase();switch(A){case"arraybuffer":case"blob":var S=new Uint8Array(d.length);for(p=0;p<d.length;p++)S[p]=d.charCodeAt(p);var z=A==="blob"?new Blob([S.buffer],{type:i}):S.buffer;break;case"document":z=new DOMParser().parseFromString(d,i);break;case"json":z=JSON.parse(d);break;default:z=d}setTimeout(function(){r&&r(z),f.manager.itemEnd(t)},0)}catch(I){setTimeout(function(){s&&s(I),f.manager.itemError(t),f.manager.itemEnd(t)},0)}}else{nu[t]=[],nu[t].push({onLoad:r,onProgress:i,onError:s});var w=new XMLHttpRequest;w.open("GET",t,!0),w.addEventListener("load",function(I){var E=this.response,P=nu[t];if(delete nu[t],this.status===200||this.status===0){this.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),qd.add(t,E);for(var F=0,X=P.length;F<X;F++){var q=P[F];q.onLoad&&q.onLoad(E)}}else{for(F=0,X=P.length;F<X;F++)q=P[F],q.onError&&q.onError(I);f.manager.itemError(t)}f.manager.itemEnd(t)},!1),w.addEventListener("progress",function(I){for(var E=nu[t],P=0,F=E.length;P<F;P++){var X=E[P];X.onProgress&&X.onProgress(I)}},!1),w.addEventListener("error",function(I){var E=nu[t];delete nu[t];for(var P=0,F=E.length;P<F;P++){var X=E[P];X.onError&&X.onError(I)}f.manager.itemError(t),f.manager.itemEnd(t)},!1),w.addEventListener("abort",function(I){var E=nu[t];delete nu[t];for(var P=0,F=E.length;P<F;P++){var X=E[P];X.onError&&X.onError(I)}f.manager.itemError(t),f.manager.itemEnd(t)},!1),this.responseType!==void 0&&(w.responseType=this.responseType),this.withCredentials!==void 0&&(w.withCredentials=this.withCredentials),w.overrideMimeType&&w.overrideMimeType(this.mimeType!==void 0?this.mimeType:"text/plain");for(p in this.requestHeader)w.setRequestHeader(p,this.requestHeader[p]);w.send(null)}return f.manager.itemStart(t),w}},setResponseType:function(t){return this.responseType=t,this},setWithCredentials:function(t){return this.withCredentials=t,this},setMimeType:function(t){return this.mimeType=t,this}}),w1.prototype=pt(ft(ai.prototype),{constructor:w1,load:function(t,r,i,s){var f=this,c=new eo(f.manager);c.setPath(f.path),c.load(t,function(d){try{r(f.parse(JSON.parse(d)))}catch(p){s?s(p):console.error(p),f.manager.itemError(t)}},i,s)},parse:function(t){for(var r=[],i=0;i<t.length;i++){var s=Fo.parse(t[i]);r.push(s)}return r}}),Wr.prototype=pt(ft(ai.prototype),{constructor:Wr,load:function(t,r,i,s){function f(I){A.load(t[I],function(E){E=c.parse(E,!0),d[I]={width:E.width,height:E.height,format:E.format,mipmaps:E.mipmaps},S+=1,S===6&&(E.mipmapCount===1&&(p.minFilter=1006),p.format=E.format,p.needsUpdate=!0,r&&r(p))},i,s)}var c=this,d=[],p=new Sl;p.image=d;var A=new eo(this.manager);if(A.setPath(this.path),A.setResponseType("arraybuffer"),Array.isArray(t))for(var S=0,z=0,w=t.length;z<w;++z)f(z);else A.load(t,function(I){if(I=c.parse(I,!0),I.isCubemap)for(var E=I.mipmaps.length/I.mipmapCount,P=0;P<E;P++){d[P]={mipmaps:[]};for(var F=0;F<I.mipmapCount;F++)d[P].mipmaps.push(I.mipmaps[P*I.mipmapCount+F]),d[P].format=I.format,d[P].width=I.width,d[P].height=I.height}else p.image.width=I.width,p.image.height=I.height,p.mipmaps=I.mipmaps;I.mipmapCount===1&&(p.minFilter=1006),p.format=I.format,p.needsUpdate=!0,r&&r(p)},i,s);return p}}),M1.prototype=pt(ft(ai.prototype),{constructor:M1,load:function(t,r,i,s){var f=this,c=new yl,d=new eo(this.manager);return d.setResponseType("arraybuffer"),d.setPath(this.path),d.load(t,function(p){(p=f.parse(p))&&(p.image!==void 0?c.image=p.image:p.data!==void 0&&(c.image.width=p.width,c.image.height=p.height,c.image.data=p.data),c.wrapS=p.wrapS!==void 0?p.wrapS:1001,c.wrapT=p.wrapT!==void 0?p.wrapT:1001,c.magFilter=p.magFilter!==void 0?p.magFilter:1006,c.minFilter=p.minFilter!==void 0?p.minFilter:1006,c.anisotropy=p.anisotropy!==void 0?p.anisotropy:1,p.format!==void 0&&(c.format=p.format),p.type!==void 0&&(c.type=p.type),p.mipmaps!==void 0&&(c.mipmaps=p.mipmaps,c.minFilter=1008),p.mipmapCount===1&&(c.minFilter=1006),c.needsUpdate=!0,r&&r(c,p))},i,s),c}}),_f.prototype=pt(ft(ai.prototype),{constructor:_f,load:function(t,r,i,s){function f(){A.removeEventListener("load",f,!1),A.removeEventListener("error",c,!1),qd.add(t,this),r&&r(this),d.manager.itemEnd(t)}function c(S){A.removeEventListener("load",f,!1),A.removeEventListener("error",c,!1),s&&s(S),d.manager.itemError(t),d.manager.itemEnd(t)}this.path!==void 0&&(t=this.path+t),t=this.manager.resolveURL(t);var d=this,p=qd.get(t);if(p!==void 0)return d.manager.itemStart(t),setTimeout(function(){r&&r(p),d.manager.itemEnd(t)},0),p;var A=document.createElementNS("http://www.w3.org/1999/xhtml","img");return A.addEventListener("load",f,!1),A.addEventListener("error",c,!1),t.substr(0,5)!=="data:"&&this.crossOrigin!==void 0&&(A.crossOrigin=this.crossOrigin),d.manager.itemStart(t),A.src=t,A}}),_g.prototype=pt(ft(ai.prototype),{constructor:_g,load:function(t,r,i,s){function f(A){d.load(t[A],function(S){c.images[A]=S,p++,p===6&&(c.needsUpdate=!0,r&&r(c))},void 0,s)}var c=new Fa,d=new _f(this.manager);d.setCrossOrigin(this.crossOrigin),d.setPath(this.path);var p=0;for(i=0;i<t.length;++i)f(i);return c}}),Wh.prototype=pt(ft(ai.prototype),{constructor:Wh,load:function(t,r,i,s){var f=new le,c=new _f(this.manager);return c.setCrossOrigin(this.crossOrigin),c.setPath(this.path),c.load(t,function(d){f.image=d,d=0<t.search(/\.jpe?g($|\?)/i)||t.search(/^data:image\/jpeg/)===0,f.format=d?1022:1023,f.needsUpdate=!0,r!==void 0&&r(f)},i,s),f}}),pt(Ir.prototype,{getPoint:function(){return console.warn("THREE.Curve: .getPoint() not implemented."),null},getPointAt:function(t,r){return t=this.getUtoTmapping(t),this.getPoint(t,r)},getPoints:function(t){t===void 0&&(t=5);for(var r=[],i=0;i<=t;i++)r.push(this.getPoint(i/t));return r},getSpacedPoints:function(t){t===void 0&&(t=5);for(var r=[],i=0;i<=t;i++)r.push(this.getPointAt(i/t));return r},getLength:function(){var t=this.getLengths();return t[t.length-1]},getLengths:function(t){if(t===void 0&&(t=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var r=[],i=this.getPoint(0),s,f=0;for(r.push(0),s=1;s<=t;s++){var c=this.getPoint(s/t);f+=c.distanceTo(i),r.push(f),i=c}return this.cacheArcLengths=r},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(t,r){var i=this.getLengths(),s=i.length;r=r||t*i[s-1];for(var f=0,c=s-1,d;f<=c;)if(t=Math.floor(f+(c-f)/2),d=i[t]-r,0>d)f=t+1;else if(0<d)c=t-1;else{c=t;break}return t=c,i[t]===r?t/(s-1):(f=i[t],(t+(r-f)/(i[t+1]-f))/(s-1))},getTangent:function(t,r){var i=t-1e-4;return t+=1e-4,0>i&&(i=0),1<t&&(t=1),i=this.getPoint(i),t=this.getPoint(t),r=r||(i.isVector2?new Ot:new dt),r.copy(t).sub(i).normalize(),r},getTangentAt:function(t,r){return t=this.getUtoTmapping(t),this.getTangent(t,r)},computeFrenetFrames:function(t,r){var i=new dt,s=[],f=[],c=[],d=new dt,p=new Me,A;for(A=0;A<=t;A++){var S=A/t;s[A]=this.getTangentAt(S,new dt),s[A].normalize()}f[0]=new dt,c[0]=new dt,A=Number.MAX_VALUE,S=Math.abs(s[0].x);var z=Math.abs(s[0].y),w=Math.abs(s[0].z);for(S<=A&&(A=S,i.set(1,0,0)),z<=A&&(A=z,i.set(0,1,0)),w<=A&&i.set(0,0,1),d.crossVectors(s[0],i).normalize(),f[0].crossVectors(s[0],d),c[0].crossVectors(s[0],f[0]),A=1;A<=t;A++)f[A]=f[A-1].clone(),c[A]=c[A-1].clone(),d.crossVectors(s[A-1],s[A]),d.length()>an&&(d.normalize(),i=Math.acos(ti.clamp(s[A-1].dot(s[A]),-1,1)),f[A].applyMatrix4(p.makeRotationAxis(d,i))),c[A].crossVectors(s[A],f[A]);if(r===!0)for(i=Math.acos(ti.clamp(f[0].dot(f[t]),-1,1)),i/=t,0<s[0].dot(d.crossVectors(f[0],f[t]))&&(i=-i),A=1;A<=t;A++)f[A].applyMatrix4(p.makeRotationAxis(s[A],i*A)),c[A].crossVectors(s[A],f[A]);return{tangents:s,normals:f,binormals:c}},clone:function(){return new this.constructor().copy(this)},copy:function(t){return this.arcLengthDivisions=t.arcLengthDivisions,this},toJSON:function(){var t={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return t.arcLengthDivisions=this.arcLengthDivisions,t.type=this.type,t},fromJSON:function(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}}),cs.prototype=ft(Ir.prototype),cs.prototype.constructor=cs,cs.prototype.isEllipseCurve=!0,cs.prototype.getPoint=function(t,r){r=r||new Ot;for(var i=2*Math.PI,s=this.aEndAngle-this.aStartAngle,f=Math.abs(s)<an;0>s;)s+=i;for(;s>i;)s-=i;s<an&&(s=f?0:i),this.aClockwise!==!0||f||(s=s===i?-i:s-i),i=this.aStartAngle+t*s,t=this.aX+this.xRadius*Math.cos(i);var c=this.aY+this.yRadius*Math.sin(i);return this.aRotation!==0&&(i=Math.cos(this.aRotation),s=Math.sin(this.aRotation),f=t-this.aX,c-=this.aY,t=f*i-c*s+this.aX,c=f*s+c*i+this.aY),r.set(t,c)},cs.prototype.copy=function(t){return Ir.prototype.copy.call(this,t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this},cs.prototype.toJSON=function(){var t=Ir.prototype.toJSON.call(this);return t.aX=this.aX,t.aY=this.aY,t.xRadius=this.xRadius,t.yRadius=this.yRadius,t.aStartAngle=this.aStartAngle,t.aEndAngle=this.aEndAngle,t.aClockwise=this.aClockwise,t.aRotation=this.aRotation,t},cs.prototype.fromJSON=function(t){return Ir.prototype.fromJSON.call(this,t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this},wf.prototype=ft(cs.prototype),wf.prototype.constructor=wf,wf.prototype.isArcCurve=!0;var Wy=new dt,__=new bl,w_=new bl,M_=new bl;ln.prototype=ft(Ir.prototype),ln.prototype.constructor=ln,ln.prototype.isCatmullRomCurve3=!0,ln.prototype.getPoint=function(t,r){r=r||new dt;var i=this.points,s=i.length;t*=s-(this.closed?0:1);var f=Math.floor(t);if(t-=f,this.closed?f+=0<f?0:(Math.floor(Math.abs(f)/s)+1)*s:t===0&&f===s-1&&(f=s-2,t=1),this.closed||0<f)var c=i[(f-1)%s];else Wy.subVectors(i[0],i[1]).add(i[0]),c=Wy;var d=i[f%s],p=i[(f+1)%s];if(this.closed||f+2<s?i=i[(f+2)%s]:(Wy.subVectors(i[s-1],i[s-2]).add(i[s-1]),i=Wy),this.curveType==="centripetal"||this.curveType==="chordal"){var A=this.curveType==="chordal"?.5:.25;s=Math.pow(c.distanceToSquared(d),A),f=Math.pow(d.distanceToSquared(p),A),A=Math.pow(p.distanceToSquared(i),A),1e-4>f&&(f=1),1e-4>s&&(s=f),1e-4>A&&(A=f),__.initNonuniformCatmullRom(c.x,d.x,p.x,i.x,s,f,A),w_.initNonuniformCatmullRom(c.y,d.y,p.y,i.y,s,f,A),M_.initNonuniformCatmullRom(c.z,d.z,p.z,i.z,s,f,A)}else this.curveType==="catmullrom"&&(__.initCatmullRom(c.x,d.x,p.x,i.x,this.tension),w_.initCatmullRom(c.y,d.y,p.y,i.y,this.tension),M_.initCatmullRom(c.z,d.z,p.z,i.z,this.tension));return r.set(__.calc(t),w_.calc(t),M_.calc(t)),r},ln.prototype.copy=function(t){Ir.prototype.copy.call(this,t),this.points=[];for(var r=0,i=t.points.length;r<i;r++)this.points.push(t.points[r].clone());return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this},ln.prototype.toJSON=function(){var t=Ir.prototype.toJSON.call(this);t.points=[];for(var r=0,i=this.points.length;r<i;r++)t.points.push(this.points[r].toArray());return t.closed=this.closed,t.curveType=this.curveType,t.tension=this.tension,t},ln.prototype.fromJSON=function(t){Ir.prototype.fromJSON.call(this,t),this.points=[];for(var r=0,i=t.points.length;r<i;r++){var s=t.points[r];this.points.push(new dt().fromArray(s))}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this},Bo.prototype=ft(Ir.prototype),Bo.prototype.constructor=Bo,Bo.prototype.isCubicBezierCurve=!0,Bo.prototype.getPoint=function(t,r){r=r||new Ot;var i=this.v0,s=this.v1,f=this.v2,c=this.v3;return r.set(Cf(t,i.x,s.x,f.x,c.x),Cf(t,i.y,s.y,f.y,c.y)),r},Bo.prototype.copy=function(t){return Ir.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this},Bo.prototype.toJSON=function(){var t=Ir.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t},Bo.prototype.fromJSON=function(t){return Ir.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this},Bi.prototype=ft(Ir.prototype),Bi.prototype.constructor=Bi,Bi.prototype.isCubicBezierCurve3=!0,Bi.prototype.getPoint=function(t,r){r=r||new dt;var i=this.v0,s=this.v1,f=this.v2,c=this.v3;return r.set(Cf(t,i.x,s.x,f.x,c.x),Cf(t,i.y,s.y,f.y,c.y),Cf(t,i.z,s.z,f.z,c.z)),r},Bi.prototype.copy=function(t){return Ir.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this},Bi.prototype.toJSON=function(){var t=Ir.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t},Bi.prototype.fromJSON=function(t){return Ir.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this},ro.prototype=ft(Ir.prototype),ro.prototype.constructor=ro,ro.prototype.isLineCurve=!0,ro.prototype.getPoint=function(t,r){return r=r||new Ot,t===1?r.copy(this.v2):(r.copy(this.v2).sub(this.v1),r.multiplyScalar(t).add(this.v1)),r},ro.prototype.getPointAt=function(t,r){return this.getPoint(t,r)},ro.prototype.getTangent=function(t,r){return t=r||new Ot,t=t.copy(this.v2).sub(this.v1).normalize()},ro.prototype.copy=function(t){return Ir.prototype.copy.call(this,t),this.v1.copy(t.v1),this.v2.copy(t.v2),this},ro.prototype.toJSON=function(){var t=Ir.prototype.toJSON.call(this);return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},ro.prototype.fromJSON=function(t){return Ir.prototype.fromJSON.call(this,t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},zo.prototype=ft(Ir.prototype),zo.prototype.constructor=zo,zo.prototype.isLineCurve3=!0,zo.prototype.getPoint=function(t,r){return r=r||new dt,t===1?r.copy(this.v2):(r.copy(this.v2).sub(this.v1),r.multiplyScalar(t).add(this.v1)),r},zo.prototype.getPointAt=function(t,r){return this.getPoint(t,r)},zo.prototype.copy=function(t){return Ir.prototype.copy.call(this,t),this.v1.copy(t.v1),this.v2.copy(t.v2),this},zo.prototype.toJSON=function(){var t=Ir.prototype.toJSON.call(this);return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},zo.prototype.fromJSON=function(t){return Ir.prototype.fromJSON.call(this,t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},fo.prototype=ft(Ir.prototype),fo.prototype.constructor=fo,fo.prototype.isQuadraticBezierCurve=!0,fo.prototype.getPoint=function(t,r){r=r||new Ot;var i=this.v0,s=this.v1,f=this.v2;return r.set(Mf(t,i.x,s.x,f.x),Mf(t,i.y,s.y,f.y)),r},fo.prototype.copy=function(t){return Ir.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this},fo.prototype.toJSON=function(){var t=Ir.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},fo.prototype.fromJSON=function(t){return Ir.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},Va.prototype=ft(Ir.prototype),Va.prototype.constructor=Va,Va.prototype.isQuadraticBezierCurve3=!0,Va.prototype.getPoint=function(t,r){r=r||new dt;var i=this.v0,s=this.v1,f=this.v2;return r.set(Mf(t,i.x,s.x,f.x),Mf(t,i.y,s.y,f.y),Mf(t,i.z,s.z,f.z)),r},Va.prototype.copy=function(t){return Ir.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this},Va.prototype.toJSON=function(){var t=Ir.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},Va.prototype.fromJSON=function(t){return Ir.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},xo.prototype=ft(Ir.prototype),xo.prototype.constructor=xo,xo.prototype.isSplineCurve=!0,xo.prototype.getPoint=function(t,r){r=r||new Ot;var i=this.points,s=(i.length-1)*t;t=Math.floor(s),s-=t;var f=i[t===0?t:t-1],c=i[t],d=i[t>i.length-2?i.length-1:t+1];return i=i[t>i.length-3?i.length-1:t+2],r.set(C1(s,f.x,c.x,d.x,i.x),C1(s,f.y,c.y,d.y,i.y)),r},xo.prototype.copy=function(t){Ir.prototype.copy.call(this,t),this.points=[];for(var r=0,i=t.points.length;r<i;r++)this.points.push(t.points[r].clone());return this},xo.prototype.toJSON=function(){var t=Ir.prototype.toJSON.call(this);t.points=[];for(var r=0,i=this.points.length;r<i;r++)t.points.push(this.points[r].toArray());return t},xo.prototype.fromJSON=function(t){Ir.prototype.fromJSON.call(this,t),this.points=[];for(var r=0,i=t.points.length;r<i;r++){var s=t.points[r];this.points.push(new Ot().fromArray(s))}return this};var C_=$a({__proto__:null,ArcCurve:wf,CatmullRomCurve3:ln,CubicBezierCurve:Bo,CubicBezierCurve3:Bi,EllipseCurve:cs,LineCurve:ro,LineCurve3:zo,QuadraticBezierCurve:fo,QuadraticBezierCurve3:Va,SplineCurve:xo});Rn.prototype=pt(ft(Ir.prototype),{constructor:Rn,add:function(t){this.curves.push(t)},closePath:function(){var t=this.curves[0].getPoint(0),r=this.curves[this.curves.length-1].getPoint(1);t.equals(r)||this.curves.push(new ro(r,t))},getPoint:function(t){var r=t*this.getLength(),i=this.getCurveLengths();for(t=0;t<i.length;){if(i[t]>=r)return r=i[t]-r,t=this.curves[t],i=t.getLength(),t.getPointAt(i===0?0:1-r/i);t++}return null},getLength:function(){var t=this.getCurveLengths();return t[t.length-1]},updateArcLengths:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var t=[],r=0,i=0,s=this.curves.length;i<s;i++)r+=this.curves[i].getLength(),t.push(r);return this.cacheLengths=t},getSpacedPoints:function(t){t===void 0&&(t=40);for(var r=[],i=0;i<=t;i++)r.push(this.getPoint(i/t));return this.autoClose&&r.push(r[0]),r},getPoints:function(t){t=t||12;for(var r=[],i,s=0,f=this.curves;s<f.length;s++){var c=f[s];c=c.getPoints(c&&c.isEllipseCurve?2*t:c&&(c.isLineCurve||c.isLineCurve3)?1:c&&c.isSplineCurve?t*c.points.length:t);for(var d=0;d<c.length;d++){var p=c[d];i&&i.equals(p)||(r.push(p),i=p)}}return this.autoClose&&1<r.length&&!r[r.length-1].equals(r[0])&&r.push(r[0]),r},copy:function(t){Ir.prototype.copy.call(this,t),this.curves=[];for(var r=0,i=t.curves.length;r<i;r++)this.curves.push(t.curves[r].clone());return this.autoClose=t.autoClose,this},toJSON:function(){var t=Ir.prototype.toJSON.call(this);t.autoClose=this.autoClose,t.curves=[];for(var r=0,i=this.curves.length;r<i;r++)t.curves.push(this.curves[r].toJSON());return t},fromJSON:function(t){Ir.prototype.fromJSON.call(this,t),this.autoClose=t.autoClose,this.curves=[];for(var r=0,i=t.curves.length;r<i;r++){var s=t.curves[r];this.curves.push(new C_[s.type]().fromJSON(s))}return this}}),fs.prototype=pt(ft(Rn.prototype),{constructor:fs,setFromPoints:function(t){this.moveTo(t[0].x,t[0].y);for(var r=1,i=t.length;r<i;r++)this.lineTo(t[r].x,t[r].y);return this},moveTo:function(t,r){return this.currentPoint.set(t,r),this},lineTo:function(t,r){var i=new ro(this.currentPoint.clone(),new Ot(t,r));return this.curves.push(i),this.currentPoint.set(t,r),this},quadraticCurveTo:function(t,r,i,s){return t=new fo(this.currentPoint.clone(),new Ot(t,r),new Ot(i,s)),this.curves.push(t),this.currentPoint.set(i,s),this},bezierCurveTo:function(t,r,i,s,f,c){return t=new Bo(this.currentPoint.clone(),new Ot(t,r),new Ot(i,s),new Ot(f,c)),this.curves.push(t),this.currentPoint.set(f,c),this},splineThru:function(t){var r=[this.currentPoint.clone()].concat(t);return r=new xo(r),this.curves.push(r),this.currentPoint.copy(t[t.length-1]),this},arc:function(t,r,i,s,f,c){return this.absarc(t+this.currentPoint.x,r+this.currentPoint.y,i,s,f,c),this},absarc:function(t,r,i,s,f,c){return this.absellipse(t,r,i,i,s,f,c),this},ellipse:function(t,r,i,s,f,c,d,p){return this.absellipse(t+this.currentPoint.x,r+this.currentPoint.y,i,s,f,c,d,p),this},absellipse:function(t,r,i,s,f,c,d,p){return t=new cs(t,r,i,s,f,c,d,p),0<this.curves.length&&(r=t.getPoint(0),r.equals(this.currentPoint)||this.lineTo(r.x,r.y)),this.curves.push(t),t=t.getPoint(1),this.currentPoint.copy(t),this},copy:function(t){return Rn.prototype.copy.call(this,t),this.currentPoint.copy(t.currentPoint),this},toJSON:function(){var t=Rn.prototype.toJSON.call(this);return t.currentPoint=this.currentPoint.toArray(),t},fromJSON:function(t){return Rn.prototype.fromJSON.call(this,t),this.currentPoint.fromArray(t.currentPoint),this}}),zu.prototype=pt(ft(fs.prototype),{constructor:zu,getPointsHoles:function(t){for(var r=[],i=0,s=this.holes.length;i<s;i++)r[i]=this.holes[i].getPoints(t);return r},extractPoints:function(t){return{shape:this.getPoints(t),holes:this.getPointsHoles(t)}},copy:function(t){fs.prototype.copy.call(this,t),this.holes=[];for(var r=0,i=t.holes.length;r<i;r++)this.holes.push(t.holes[r].clone());return this},toJSON:function(){var t=fs.prototype.toJSON.call(this);t.uuid=this.uuid,t.holes=[];for(var r=0,i=this.holes.length;r<i;r++)t.holes.push(this.holes[r].toJSON());return t},fromJSON:function(t){fs.prototype.fromJSON.call(this,t),this.uuid=t.uuid,this.holes=[];for(var r=0,i=t.holes.length;r<i;r++){var s=t.holes[r];this.holes.push(new fs().fromJSON(s))}return this}}),ji.prototype=pt(ft(fe.prototype),{constructor:ji,isLight:!0,copy:function(t){return fe.prototype.copy.call(this,t),this.color.copy(t.color),this.intensity=t.intensity,this},toJSON:function(t){return t=fe.prototype.toJSON.call(this,t),t.object.color=this.color.getHex(),t.object.intensity=this.intensity,this.groundColor!==void 0&&(t.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(t.object.distance=this.distance),this.angle!==void 0&&(t.object.angle=this.angle),this.decay!==void 0&&(t.object.decay=this.decay),this.penumbra!==void 0&&(t.object.penumbra=this.penumbra),this.shadow!==void 0&&(t.object.shadow=this.shadow.toJSON()),t}}),jh.prototype=pt(ft(ji.prototype),{constructor:jh,isHemisphereLight:!0,copy:function(t){return ji.prototype.copy.call(this,t),this.groundColor.copy(t.groundColor),this}}),pt(Wa.prototype,{_projScreenMatrix:new Me,_lightPositionWorld:new dt,_lookTarget:new dt,getViewportCount:function(){return this._viewportCount},getFrustum:function(){return this._frustum},updateMatrices:function(t){var r=this.camera,i=this.matrix,s=this._projScreenMatrix,f=this._lookTarget,c=this._lightPositionWorld;c.setFromMatrixPosition(t.matrixWorld),r.position.copy(c),f.setFromMatrixPosition(t.target.matrixWorld),r.lookAt(f),r.updateMatrixWorld(),s.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),this._frustum.setFromProjectionMatrix(s),i.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),i.multiply(r.projectionMatrix),i.multiply(r.matrixWorldInverse)},getViewport:function(t){return this._viewports[t]},getFrameExtents:function(){return this._frameExtents},copy:function(t){return this.camera=t.camera.clone(),this.bias=t.bias,this.radius=t.radius,this.mapSize.copy(t.mapSize),this},clone:function(){return new this.constructor().copy(this)},toJSON:function(){var t={};return this.bias!==0&&(t.bias=this.bias),this.radius!==1&&(t.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(t.mapSize=this.mapSize.toArray()),t.camera=this.camera.toJSON(!1).object,delete t.camera.matrix,t}}),Tf.prototype=pt(ft(Wa.prototype),{constructor:Tf,isSpotLightShadow:!0,updateMatrices:function(t){var r=this.camera,i=2*ti.RAD2DEG*t.angle,s=this.mapSize.width/this.mapSize.height,f=t.distance||r.far;(i!==r.fov||s!==r.aspect||f!==r.far)&&(r.fov=i,r.aspect=s,r.far=f,r.updateProjectionMatrix()),Wa.prototype.updateMatrices.call(this,t)}}),sa.prototype=pt(ft(ji.prototype),{constructor:sa,isSpotLight:!0,copy:function(t){return ji.prototype.copy.call(this,t),this.distance=t.distance,this.angle=t.angle,this.penumbra=t.penumbra,this.decay=t.decay,this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}),Sf.prototype=pt(ft(Wa.prototype),{constructor:Sf,isPointLightShadow:!0,updateMatrices:function(t,r){r===void 0&&(r=0);var i=this.camera,s=this.matrix,f=this._lightPositionWorld,c=this._lookTarget,d=this._projScreenMatrix;f.setFromMatrixPosition(t.matrixWorld),i.position.copy(f),c.copy(i.position),c.add(this._cubeDirections[r]),i.up.copy(this._cubeUps[r]),i.lookAt(c),i.updateMatrixWorld(),s.makeTranslation(-f.x,-f.y,-f.z),d.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),this._frustum.setFromProjectionMatrix(d)}}),Nu.prototype=pt(ft(ji.prototype),{constructor:Nu,isPointLight:!0,copy:function(t){return ji.prototype.copy.call(this,t),this.distance=t.distance,this.decay=t.decay,this.shadow=t.shadow.clone(),this}}),ja.prototype=pt(ft(Da.prototype),{constructor:ja,isOrthographicCamera:!0,copy:function(t,r){return Da.prototype.copy.call(this,t,r),this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.near=t.near,this.far=t.far,this.zoom=t.zoom,this.view=t.view===null?null:pt({},t.view),this},setViewOffset:function(t,r,i,s,f,c){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=r,this.view.offsetX=i,this.view.offsetY=s,this.view.width=f,this.view.height=c,this.updateProjectionMatrix()},clearViewOffset:function(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var t=(this.right-this.left)/(2*this.zoom),r=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,s=(this.top+this.bottom)/2,f=i-t;i+=t,t=s+r,r=s-r,this.view!==null&&this.view.enabled&&(s=(this.right-this.left)/this.view.fullWidth/this.zoom,r=(this.top-this.bottom)/this.view.fullHeight/this.zoom,f+=s*this.view.offsetX,i=f+s*this.view.width,t-=r*this.view.offsetY,r=t-r*this.view.height),this.projectionMatrix.makeOrthographic(f,i,t,r,this.near,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(t){return t=fe.prototype.toJSON.call(this,t),t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=pt({},this.view)),t}}),If.prototype=pt(ft(Wa.prototype),{constructor:If,isDirectionalLightShadow:!0,updateMatrices:function(t){Wa.prototype.updateMatrices.call(this,t)}}),kl.prototype=pt(ft(ji.prototype),{constructor:kl,isDirectionalLight:!0,copy:function(t){return ji.prototype.copy.call(this,t),this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}),wg.prototype=pt(ft(ji.prototype),{constructor:wg,isAmbientLight:!0}),dd.prototype=pt(ft(ji.prototype),{constructor:dd,isRectAreaLight:!0,copy:function(t){return ji.prototype.copy.call(this,t),this.width=t.width,this.height=t.height,this},toJSON:function(t){return t=ji.prototype.toJSON.call(this,t),t.object.width=this.width,t.object.height=this.height,t}}),pt(Fs.prototype,{isSphericalHarmonics3:!0,set:function(t){for(var r=0;9>r;r++)this.coefficients[r].copy(t[r]);return this},zero:function(){for(var t=0;9>t;t++)this.coefficients[t].set(0,0,0);return this},getAt:function(t,r){var i=t.x,s=t.y;t=t.z;var f=this.coefficients;return r.copy(f[0]).multiplyScalar(.282095),r.addScaledVector(f[1],.488603*s),r.addScaledVector(f[2],.488603*t),r.addScaledVector(f[3],.488603*i),r.addScaledVector(f[4],1.092548*i*s),r.addScaledVector(f[5],1.092548*s*t),r.addScaledVector(f[6],.315392*(3*t*t-1)),r.addScaledVector(f[7],1.092548*i*t),r.addScaledVector(f[8],.546274*(i*i-s*s)),r},getIrradianceAt:function(t,r){var i=t.x,s=t.y;t=t.z;var f=this.coefficients;return r.copy(f[0]).multiplyScalar(.886227),r.addScaledVector(f[1],1.023328*s),r.addScaledVector(f[2],1.023328*t),r.addScaledVector(f[3],1.023328*i),r.addScaledVector(f[4],.858086*i*s),r.addScaledVector(f[5],.858086*s*t),r.addScaledVector(f[6],.743125*t*t-.247708),r.addScaledVector(f[7],.858086*i*t),r.addScaledVector(f[8],.429043*(i*i-s*s)),r},add:function(t){for(var r=0;9>r;r++)this.coefficients[r].add(t.coefficients[r]);return this},addScaledSH:function(t,r){for(var i=0;9>i;i++)this.coefficients[i].addScaledVector(t.coefficients[i],r);return this},scale:function(t){for(var r=0;9>r;r++)this.coefficients[r].multiplyScalar(t);return this},lerp:function(t,r){for(var i=0;9>i;i++)this.coefficients[i].lerp(t.coefficients[i],r);return this},equals:function(t){for(var r=0;9>r;r++)if(!this.coefficients[r].equals(t.coefficients[r]))return!1;return!0},copy:function(t){return this.set(t.coefficients)},clone:function(){return new this.constructor().copy(this)},fromArray:function(t,r){r===void 0&&(r=0);for(var i=this.coefficients,s=0;9>s;s++)i[s].fromArray(t,r+3*s);return this},toArray:function(t,r){t===void 0&&(t=[]),r===void 0&&(r=0);for(var i=this.coefficients,s=0;9>s;s++)i[s].toArray(t,r+3*s);return t}}),pt(Fs,{getBasisAt:function(t,r){var i=t.x,s=t.y;t=t.z,r[0]=.282095,r[1]=.488603*s,r[2]=.488603*t,r[3]=.488603*i,r[4]=1.092548*i*s,r[5]=1.092548*s*t,r[6]=.315392*(3*t*t-1),r[7]=1.092548*i*t,r[8]=.546274*(i*i-s*s)}}),Ao.prototype=pt(ft(ji.prototype),{constructor:Ao,isLightProbe:!0,copy:function(t){return ji.prototype.copy.call(this,t),this.sh.copy(t.sh),this},fromJSON:function(t){return this.intensity=t.intensity,this.sh.fromArray(t.sh),this},toJSON:function(t){return t=ji.prototype.toJSON.call(this,t),t.object.sh=this.sh.toArray(),t}}),Xa.prototype=pt(ft(ai.prototype),{constructor:Xa,load:function(t,r,i,s){var f=this,c=new eo(f.manager);c.setPath(f.path),c.load(t,function(d){try{r(f.parse(JSON.parse(d)))}catch(p){s?s(p):console.error(p),f.manager.itemError(t)}},i,s)},parse:function(t){function r(p){return i[p]===void 0&&console.warn("THREE.MaterialLoader: Undefined texture",p),i[p]}var i=this.textures,s=new iE[t.type];if(t.uuid!==void 0&&(s.uuid=t.uuid),t.name!==void 0&&(s.name=t.name),t.color!==void 0&&s.color.setHex(t.color),t.roughness!==void 0&&(s.roughness=t.roughness),t.metalness!==void 0&&(s.metalness=t.metalness),t.sheen!==void 0&&(s.sheen=new Oe().setHex(t.sheen)),t.emissive!==void 0&&s.emissive.setHex(t.emissive),t.specular!==void 0&&s.specular.setHex(t.specular),t.shininess!==void 0&&(s.shininess=t.shininess),t.clearcoat!==void 0&&(s.clearcoat=t.clearcoat),t.clearcoatRoughness!==void 0&&(s.clearcoatRoughness=t.clearcoatRoughness),t.fog!==void 0&&(s.fog=t.fog),t.flatShading!==void 0&&(s.flatShading=t.flatShading),t.blending!==void 0&&(s.blending=t.blending),t.combine!==void 0&&(s.combine=t.combine),t.side!==void 0&&(s.side=t.side),t.opacity!==void 0&&(s.opacity=t.opacity),t.transparent!==void 0&&(s.transparent=t.transparent),t.alphaTest!==void 0&&(s.alphaTest=t.alphaTest),t.depthTest!==void 0&&(s.depthTest=t.depthTest),t.depthWrite!==void 0&&(s.depthWrite=t.depthWrite),t.colorWrite!==void 0&&(s.colorWrite=t.colorWrite),t.stencilWrite!==void 0&&(s.stencilWrite=t.stencilWrite),t.stencilWriteMask!==void 0&&(s.stencilWriteMask=t.stencilWriteMask),t.stencilFunc!==void 0&&(s.stencilFunc=t.stencilFunc),t.stencilRef!==void 0&&(s.stencilRef=t.stencilRef),t.stencilFuncMask!==void 0&&(s.stencilFuncMask=t.stencilFuncMask),t.stencilFail!==void 0&&(s.stencilFail=t.stencilFail),t.stencilZFail!==void 0&&(s.stencilZFail=t.stencilZFail),t.stencilZPass!==void 0&&(s.stencilZPass=t.stencilZPass),t.wireframe!==void 0&&(s.wireframe=t.wireframe),t.wireframeLinewidth!==void 0&&(s.wireframeLinewidth=t.wireframeLinewidth),t.wireframeLinecap!==void 0&&(s.wireframeLinecap=t.wireframeLinecap),t.wireframeLinejoin!==void 0&&(s.wireframeLinejoin=t.wireframeLinejoin),t.rotation!==void 0&&(s.rotation=t.rotation),t.linewidth!==1&&(s.linewidth=t.linewidth),t.dashSize!==void 0&&(s.dashSize=t.dashSize),t.gapSize!==void 0&&(s.gapSize=t.gapSize),t.scale!==void 0&&(s.scale=t.scale),t.polygonOffset!==void 0&&(s.polygonOffset=t.polygonOffset),t.polygonOffsetFactor!==void 0&&(s.polygonOffsetFactor=t.polygonOffsetFactor),t.polygonOffsetUnits!==void 0&&(s.polygonOffsetUnits=t.polygonOffsetUnits),t.skinning!==void 0&&(s.skinning=t.skinning),t.morphTargets!==void 0&&(s.morphTargets=t.morphTargets),t.morphNormals!==void 0&&(s.morphNormals=t.morphNormals),t.dithering!==void 0&&(s.dithering=t.dithering),t.vertexTangents!==void 0&&(s.vertexTangents=t.vertexTangents),t.visible!==void 0&&(s.visible=t.visible),t.toneMapped!==void 0&&(s.toneMapped=t.toneMapped),t.userData!==void 0&&(s.userData=t.userData),t.vertexColors!==void 0&&(s.vertexColors=typeof t.vertexColors=="number"?0<t.vertexColors:t.vertexColors),t.uniforms!==void 0)for(var f in t.uniforms){var c=t.uniforms[f];switch(s.uniforms[f]={},c.type){case"t":s.uniforms[f].value=r(c.value);break;case"c":s.uniforms[f].value=new Oe().setHex(c.value);break;case"v2":s.uniforms[f].value=new Ot().fromArray(c.value);break;case"v3":s.uniforms[f].value=new dt().fromArray(c.value);break;case"v4":s.uniforms[f].value=new jt().fromArray(c.value);break;case"m3":s.uniforms[f].value=new Jt().fromArray(c.value);case"m4":s.uniforms[f].value=new Me().fromArray(c.value);break;default:s.uniforms[f].value=c.value}}if(t.defines!==void 0&&(s.defines=t.defines),t.vertexShader!==void 0&&(s.vertexShader=t.vertexShader),t.fragmentShader!==void 0&&(s.fragmentShader=t.fragmentShader),t.extensions!==void 0)for(var d in t.extensions)s.extensions[d]=t.extensions[d];return t.shading!==void 0&&(s.flatShading=t.shading===1),t.size!==void 0&&(s.size=t.size),t.sizeAttenuation!==void 0&&(s.sizeAttenuation=t.sizeAttenuation),t.map!==void 0&&(s.map=r(t.map)),t.matcap!==void 0&&(s.matcap=r(t.matcap)),t.alphaMap!==void 0&&(s.alphaMap=r(t.alphaMap)),t.bumpMap!==void 0&&(s.bumpMap=r(t.bumpMap)),t.bumpScale!==void 0&&(s.bumpScale=t.bumpScale),t.normalMap!==void 0&&(s.normalMap=r(t.normalMap)),t.normalMapType!==void 0&&(s.normalMapType=t.normalMapType),t.normalScale!==void 0&&(f=t.normalScale,Array.isArray(f)===!1&&(f=[f,f]),s.normalScale=new Ot().fromArray(f)),t.displacementMap!==void 0&&(s.displacementMap=r(t.displacementMap)),t.displacementScale!==void 0&&(s.displacementScale=t.displacementScale),t.displacementBias!==void 0&&(s.displacementBias=t.displacementBias),t.roughnessMap!==void 0&&(s.roughnessMap=r(t.roughnessMap)),t.metalnessMap!==void 0&&(s.metalnessMap=r(t.metalnessMap)),t.emissiveMap!==void 0&&(s.emissiveMap=r(t.emissiveMap)),t.emissiveIntensity!==void 0&&(s.emissiveIntensity=t.emissiveIntensity),t.specularMap!==void 0&&(s.specularMap=r(t.specularMap)),t.envMap!==void 0&&(s.envMap=r(t.envMap)),t.envMapIntensity!==void 0&&(s.envMapIntensity=t.envMapIntensity),t.reflectivity!==void 0&&(s.reflectivity=t.reflectivity),t.refractionRatio!==void 0&&(s.refractionRatio=t.refractionRatio),t.lightMap!==void 0&&(s.lightMap=r(t.lightMap)),t.lightMapIntensity!==void 0&&(s.lightMapIntensity=t.lightMapIntensity),t.aoMap!==void 0&&(s.aoMap=r(t.aoMap)),t.aoMapIntensity!==void 0&&(s.aoMapIntensity=t.aoMapIntensity),t.gradientMap!==void 0&&(s.gradientMap=r(t.gradientMap)),t.clearcoatMap!==void 0&&(s.clearcoatMap=r(t.clearcoatMap)),t.clearcoatRoughnessMap!==void 0&&(s.clearcoatRoughnessMap=r(t.clearcoatRoughnessMap)),t.clearcoatNormalMap!==void 0&&(s.clearcoatNormalMap=r(t.clearcoatNormalMap)),t.clearcoatNormalScale!==void 0&&(s.clearcoatNormalScale=new Ot().fromArray(t.clearcoatNormalScale)),s},setTextures:function(t){return this.textures=t,this}});var vc={decodeText:function(t){if(typeof TextDecoder!="undefined")return new TextDecoder().decode(t);for(var r="",i=0,s=t.length;i<s;i++)r+=String.fromCharCode(t[i]);try{return decodeURIComponent(escape(r))}catch{return r}},extractUrlBase:function(t){var r=t.lastIndexOf("/");return r===-1?"./":t.substr(0,r+1)}};Uu.prototype=pt(ft(ke.prototype),{constructor:Uu,isInstancedBufferGeometry:!0,copy:function(t){return ke.prototype.copy.call(this,t),this.instanceCount=t.instanceCount,this},clone:function(){return new this.constructor().copy(this)},toJSON:function(){var t=ke.prototype.toJSON.call(this);return t.instanceCount=this.instanceCount,t.isInstancedBufferGeometry=!0,t}}),Ef.prototype=pt(ft(wr.prototype),{constructor:Ef,isInstancedBufferAttribute:!0,copy:function(t){return wr.prototype.copy.call(this,t),this.meshPerAttribute=t.meshPerAttribute,this},toJSON:function(){var t=wr.prototype.toJSON.call(this);return t.meshPerAttribute=this.meshPerAttribute,t.isInstancedBufferAttribute=!0,t}}),Xh.prototype=pt(ft(ai.prototype),{constructor:Xh,load:function(t,r,i,s){var f=this,c=new eo(f.manager);c.setPath(f.path),c.load(t,function(d){try{r(f.parse(JSON.parse(d)))}catch(p){s?s(p):console.error(p),f.manager.itemError(t)}},i,s)},parse:function(t){var r=t.isInstancedBufferGeometry?new Uu:new ke,i=t.data.index;if(i!==void 0){var s=new T_[i.type](i.array);r.setIndex(new wr(s,1))}i=t.data.attributes;for(var f in i){var c=i[f];s=new T_[c.type](c.array),s=new(c.isInstancedBufferAttribute?Ef:wr)(s,c.itemSize,c.normalized),c.name!==void 0&&(s.name=c.name),r.setAttribute(f,s)}var d=t.data.morphAttributes;if(d)for(f in d){var p=d[f],A=[];i=0;for(var S=p.length;i<S;i++)c=p[i],s=new T_[c.type](c.array),s=new wr(s,c.itemSize,c.normalized),c.name!==void 0&&(s.name=c.name),A.push(s);r.morphAttributes[f]=A}if(t.data.morphTargetsRelative&&(r.morphTargetsRelative=!0),f=t.data.groups||t.data.drawcalls||t.data.offsets,f!==void 0)for(i=0,c=f.length;i!==c;++i)s=f[i],r.addGroup(s.start,s.count,s.materialIndex);return i=t.data.boundingSphere,i!==void 0&&(f=new dt,i.center!==void 0&&f.fromArray(i.center),r.boundingSphere=new fn(f,i.radius)),t.name&&(r.name=t.name),t.userData&&(r.userData=t.userData),r}});var T_={Int8Array,Uint8Array,Uint8ClampedArray:typeof Uint8ClampedArray!="undefined"?Uint8ClampedArray:Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};md.prototype=pt(ft(ai.prototype),{constructor:md,load:function(t,r,i,s){var f=this,c=this.path===""?vc.extractUrlBase(t):this.path;this.resourcePath=this.resourcePath||c,c=new eo(f.manager),c.setPath(this.path),c.load(t,function(d){var p=null;try{p=JSON.parse(d)}catch(A){s!==void 0&&s(A),console.error("THREE:ObjectLoader: Can't parse "+t+".",A.message);return}d=p.metadata,d===void 0||d.type===void 0||d.type.toLowerCase()==="geometry"?console.error("THREE.ObjectLoader: Can't load "+t):f.parse(p,r)},i,s)},parse:function(t,r){var i=this.parseShape(t.shapes);i=this.parseGeometries(t.geometries,i);var s=this.parseImages(t.images,function(){r!==void 0&&r(f)});s=this.parseTextures(t.textures,s),s=this.parseMaterials(t.materials,s);var f=this.parseObject(t.object,i,s);return t.animations&&(f.animations=this.parseAnimations(t.animations)),t.images!==void 0&&t.images.length!==0||r===void 0||r(f),f},parseShape:function(t){var r={};if(t!==void 0)for(var i=0,s=t.length;i<s;i++){var f=new zu().fromJSON(t[i]);r[f.uuid]=f}return r},parseGeometries:function(t,r){var i={};if(t!==void 0)for(var s=new Xh,f=0,c=t.length;f<c;f++){var d=t[f];switch(d.type){case"PlaneGeometry":case"PlaneBufferGeometry":var p=new rs[d.type](d.width,d.height,d.widthSegments,d.heightSegments);break;case"BoxGeometry":case"BoxBufferGeometry":case"CubeGeometry":p=new rs[d.type](d.width,d.height,d.depth,d.widthSegments,d.heightSegments,d.depthSegments);break;case"CircleGeometry":case"CircleBufferGeometry":p=new rs[d.type](d.radius,d.segments,d.thetaStart,d.thetaLength);break;case"CylinderGeometry":case"CylinderBufferGeometry":p=new rs[d.type](d.radiusTop,d.radiusBottom,d.height,d.radialSegments,d.heightSegments,d.openEnded,d.thetaStart,d.thetaLength);break;case"ConeGeometry":case"ConeBufferGeometry":p=new rs[d.type](d.radius,d.height,d.radialSegments,d.heightSegments,d.openEnded,d.thetaStart,d.thetaLength);break;case"SphereGeometry":case"SphereBufferGeometry":p=new rs[d.type](d.radius,d.widthSegments,d.heightSegments,d.phiStart,d.phiLength,d.thetaStart,d.thetaLength);break;case"DodecahedronGeometry":case"DodecahedronBufferGeometry":case"IcosahedronGeometry":case"IcosahedronBufferGeometry":case"OctahedronGeometry":case"OctahedronBufferGeometry":case"TetrahedronGeometry":case"TetrahedronBufferGeometry":p=new rs[d.type](d.radius,d.detail);break;case"RingGeometry":case"RingBufferGeometry":p=new rs[d.type](d.innerRadius,d.outerRadius,d.thetaSegments,d.phiSegments,d.thetaStart,d.thetaLength);break;case"TorusGeometry":case"TorusBufferGeometry":p=new rs[d.type](d.radius,d.tube,d.radialSegments,d.tubularSegments,d.arc);break;case"TorusKnotGeometry":case"TorusKnotBufferGeometry":p=new rs[d.type](d.radius,d.tube,d.tubularSegments,d.radialSegments,d.p,d.q);break;case"TubeGeometry":case"TubeBufferGeometry":p=new rs[d.type](new C_[d.path.type]().fromJSON(d.path),d.tubularSegments,d.radius,d.radialSegments,d.closed);break;case"LatheGeometry":case"LatheBufferGeometry":p=new rs[d.type](d.points,d.segments,d.phiStart,d.phiLength);break;case"PolyhedronGeometry":case"PolyhedronBufferGeometry":p=new rs[d.type](d.vertices,d.indices,d.radius,d.details);break;case"ShapeGeometry":case"ShapeBufferGeometry":p=[];for(var A=0,S=d.shapes.length;A<S;A++){var z=r[d.shapes[A]];p.push(z)}p=new rs[d.type](p,d.curveSegments);break;case"ExtrudeGeometry":case"ExtrudeBufferGeometry":for(p=[],A=0,S=d.shapes.length;A<S;A++)z=r[d.shapes[A]],p.push(z);A=d.options.extrudePath,A!==void 0&&(d.options.extrudePath=new C_[A.type]().fromJSON(A)),p=new rs[d.type](p,d.options);break;case"BufferGeometry":case"InstancedBufferGeometry":p=s.parse(d);break;case"Geometry":console.error('THREE.ObjectLoader: Loading "Geometry" is not supported anymore.');break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+d.type+'"');continue}p.uuid=d.uuid,d.name!==void 0&&(p.name=d.name),p.isBufferGeometry===!0&&d.userData!==void 0&&(p.userData=d.userData),i[d.uuid]=p}return i},parseMaterials:function(t,r){var i={},s={};if(t!==void 0){var f=new Xa;f.setTextures(r),r=0;for(var c=t.length;r<c;r++){var d=t[r];if(d.type==="MultiMaterial"){for(var p=[],A=0;A<d.materials.length;A++){var S=d.materials[A];i[S.uuid]===void 0&&(i[S.uuid]=f.parse(S)),p.push(i[S.uuid])}s[d.uuid]=p}else i[d.uuid]===void 0&&(i[d.uuid]=f.parse(d)),s[d.uuid]=i[d.uuid]}}return s},parseAnimations:function(t){for(var r=[],i=0;i<t.length;i++){var s=t[i],f=Fo.parse(s);s.uuid!==void 0&&(f.uuid=s.uuid),r.push(f)}return r},parseImages:function(t,r){function i(I){return s.manager.itemStart(I),c.load(I,function(){s.manager.itemEnd(I)},void 0,function(){s.manager.itemError(I),s.manager.itemEnd(I)})}var s=this,f={};if(t!==void 0&&0<t.length){r=new _1(r);var c=new _f(r);c.setCrossOrigin(this.crossOrigin),r=0;for(var d=t.length;r<d;r++){var p=t[r],A=p.url;if(Array.isArray(A)){f[p.uuid]=[];for(var S=0,z=A.length;S<z;S++){var w=A[S];w=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(w)?w:s.resourcePath+w,f[p.uuid].push(i(w))}}else w=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(p.url)?p.url:s.resourcePath+p.url,f[p.uuid]=i(w)}}return f},parseTextures:function(t,r){function i(A,S){return typeof A=="number"?A:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",A),S[A])}var s={};if(t!==void 0)for(var f=0,c=t.length;f<c;f++){var d=t[f];d.image===void 0&&console.warn('THREE.ObjectLoader: No "image" specified for',d.uuid),r[d.image]===void 0&&console.warn("THREE.ObjectLoader: Undefined image",d.image);var p=Array.isArray(r[d.image])?new Fa(r[d.image]):new le(r[d.image]);p.needsUpdate=!0,p.uuid=d.uuid,d.name!==void 0&&(p.name=d.name),d.mapping!==void 0&&(p.mapping=i(d.mapping,nE)),d.offset!==void 0&&p.offset.fromArray(d.offset),d.repeat!==void 0&&p.repeat.fromArray(d.repeat),d.center!==void 0&&p.center.fromArray(d.center),d.rotation!==void 0&&(p.rotation=d.rotation),d.wrap!==void 0&&(p.wrapS=i(d.wrap[0],KC),p.wrapT=i(d.wrap[1],KC)),d.format!==void 0&&(p.format=d.format),d.type!==void 0&&(p.type=d.type),d.encoding!==void 0&&(p.encoding=d.encoding),d.minFilter!==void 0&&(p.minFilter=i(d.minFilter,$C)),d.magFilter!==void 0&&(p.magFilter=i(d.magFilter,$C)),d.anisotropy!==void 0&&(p.anisotropy=d.anisotropy),d.flipY!==void 0&&(p.flipY=d.flipY),d.premultiplyAlpha!==void 0&&(p.premultiplyAlpha=d.premultiplyAlpha),d.unpackAlignment!==void 0&&(p.unpackAlignment=d.unpackAlignment),s[d.uuid]=p}return s},parseObject:function(t,r,i){function s(S){return r[S]===void 0&&console.warn("THREE.ObjectLoader: Undefined geometry",S),r[S]}function f(S){if(S!==void 0){if(Array.isArray(S)){for(var z=[],w=0,I=S.length;w<I;w++){var E=S[w];i[E]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",E),z.push(i[E])}return z}return i[S]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",S),i[S]}}switch(t.type){case"Scene":var c=new Mr;t.background!==void 0&&fc(t.background)&&(c.background=new Oe(t.background)),t.fog!==void 0&&(t.fog.type==="Fog"?c.fog=new gg(t.fog.color,t.fog.near,t.fog.far):t.fog.type==="FogExp2"&&(c.fog=new pn(t.fog.color,t.fog.density)));break;case"PerspectiveCamera":c=new en(t.fov,t.aspect,t.near,t.far),t.focus!==void 0&&(c.focus=t.focus),t.zoom!==void 0&&(c.zoom=t.zoom),t.filmGauge!==void 0&&(c.filmGauge=t.filmGauge),t.filmOffset!==void 0&&(c.filmOffset=t.filmOffset),t.view!==void 0&&(c.view=pt({},t.view));break;case"OrthographicCamera":c=new ja(t.left,t.right,t.top,t.bottom,t.near,t.far),t.zoom!==void 0&&(c.zoom=t.zoom),t.view!==void 0&&(c.view=pt({},t.view));break;case"AmbientLight":c=new wg(t.color,t.intensity);break;case"DirectionalLight":c=new kl(t.color,t.intensity);break;case"PointLight":c=new Nu(t.color,t.intensity,t.distance,t.decay);break;case"RectAreaLight":c=new dd(t.color,t.intensity,t.width,t.height);break;case"SpotLight":c=new sa(t.color,t.intensity,t.distance,t.angle,t.penumbra,t.decay);break;case"HemisphereLight":c=new jh(t.color,t.groundColor,t.intensity);break;case"LightProbe":c=new Ao().fromJSON(t);break;case"SkinnedMesh":console.warn("THREE.ObjectLoader.parseObject() does not support SkinnedMesh yet.");case"Mesh":c=s(t.geometry);var d=f(t.material);c=new Zi(c,d);break;case"InstancedMesh":c=s(t.geometry),d=f(t.material);var p=t.instanceMatrix;c=new _n(c,d,t.count),c.instanceMatrix=new wr(new Float32Array(p.array),16);break;case"LOD":c=new id;break;case"Line":c=new Po(s(t.geometry),f(t.material),t.mode);break;case"LineLoop":c=new of(s(t.geometry),f(t.material));break;case"LineSegments":c=new Fi(s(t.geometry),f(t.material));break;case"PointCloud":case"Points":c=new Ru(s(t.geometry),f(t.material));break;case"Sprite":c=new rd(f(t.material));break;case"Group":c=new Zo;break;default:c=new fe}if(c.uuid=t.uuid,t.name!==void 0&&(c.name=t.name),t.matrix!==void 0?(c.matrix.fromArray(t.matrix),t.matrixAutoUpdate!==void 0&&(c.matrixAutoUpdate=t.matrixAutoUpdate),c.matrixAutoUpdate&&c.matrix.decompose(c.position,c.quaternion,c.scale)):(t.position!==void 0&&c.position.fromArray(t.position),t.rotation!==void 0&&c.rotation.fromArray(t.rotation),t.quaternion!==void 0&&c.quaternion.fromArray(t.quaternion),t.scale!==void 0&&c.scale.fromArray(t.scale)),t.castShadow!==void 0&&(c.castShadow=t.castShadow),t.receiveShadow!==void 0&&(c.receiveShadow=t.receiveShadow),t.shadow&&(t.shadow.bias!==void 0&&(c.shadow.bias=t.shadow.bias),t.shadow.radius!==void 0&&(c.shadow.radius=t.shadow.radius),t.shadow.mapSize!==void 0&&c.shadow.mapSize.fromArray(t.shadow.mapSize),t.shadow.camera!==void 0&&(c.shadow.camera=this.parseObject(t.shadow.camera))),t.visible!==void 0&&(c.visible=t.visible),t.frustumCulled!==void 0&&(c.frustumCulled=t.frustumCulled),t.renderOrder!==void 0&&(c.renderOrder=t.renderOrder),t.userData!==void 0&&(c.userData=t.userData),t.layers!==void 0&&(c.layers.mask=t.layers),t.children!==void 0)for(p=t.children,d=0;d<p.length;d++)c.add(this.parseObject(p[d],r,i));if(t.type==="LOD")for(t.autoUpdate!==void 0&&(c.autoUpdate=t.autoUpdate),t=t.levels,p=0;p<t.length;p++){d=t[p];var A=c.getObjectByProperty("uuid",d.object);A!==void 0&&c.addLevel(A,d.distance)}return c}});var nE={UVMapping:300,CubeReflectionMapping:301,CubeRefractionMapping:302,EquirectangularReflectionMapping:303,EquirectangularRefractionMapping:304,SphericalReflectionMapping:305,CubeUVReflectionMapping:306,CubeUVRefractionMapping:307},KC={RepeatWrapping:1e3,ClampToEdgeWrapping:1001,MirroredRepeatWrapping:1002},$C={NearestFilter:1003,NearestMipmapNearestFilter:1004,NearestMipmapLinearFilter:1005,LinearFilter:1006,LinearMipmapNearestFilter:1007,LinearMipmapLinearFilter:1008};Mg.prototype=pt(ft(ai.prototype),{constructor:Mg,setOptions:function(t){return this.options=t,this},load:function(t,r,i,s){t===void 0&&(t=""),this.path!==void 0&&(t=this.path+t),t=this.manager.resolveURL(t);var f=this,c=qd.get(t);if(c!==void 0)return f.manager.itemStart(t),setTimeout(function(){r&&r(c),f.manager.itemEnd(t)},0),c;fetch(t).then(function(d){return d.blob()}).then(function(d){return f.options===void 0?createImageBitmap(d):createImageBitmap(d,f.options)}).then(function(d){qd.add(t,d),r&&r(d),f.manager.itemEnd(t)}).catch(function(d){s&&s(d),f.manager.itemError(t),f.manager.itemEnd(t)}),f.manager.itemStart(t)}}),pt(Cg.prototype,{moveTo:function(t,r){return this.currentPath=new fs,this.subPaths.push(this.currentPath),this.currentPath.moveTo(t,r),this},lineTo:function(t,r){return this.currentPath.lineTo(t,r),this},quadraticCurveTo:function(t,r,i,s){return this.currentPath.quadraticCurveTo(t,r,i,s),this},bezierCurveTo:function(t,r,i,s,f,c){return this.currentPath.bezierCurveTo(t,r,i,s,f,c),this},splineThru:function(t){return this.currentPath.splineThru(t),this},toShapes:function(t,r){function i(X){for(var q=[],J=0,it=X.length;J<it;J++){var lt=X[J],Mt=new zu;Mt.curves=lt.curves,q.push(Mt)}return q}function s(X,q){for(var J=q.length,it=!1,lt=J-1,Mt=0;Mt<J;lt=Mt++){var Ct=q[lt],wt=q[Mt],zt=wt.x-Ct.x,Ut=wt.y-Ct.y;if(Math.abs(Ut)>an){if(0>Ut&&(Ct=q[Mt],zt=-zt,wt=q[lt],Ut=-Ut),!(X.y<Ct.y||X.y>wt.y))if(X.y===Ct.y){if(X.x===Ct.x)return!0}else{if(lt=Ut*(X.x-Ct.x)-zt*(X.y-Ct.y),lt===0)return!0;0>lt||(it=!it)}}else if(X.y===Ct.y&&(wt.x<=X.x&&X.x<=Ct.x||Ct.x<=X.x&&X.x<=wt.x))return!0}return it}var f=gc.isClockWise,c=this.subPaths;if(c.length===0)return[];if(r===!0)return i(c);if(r=[],c.length===1){var d=c[0],p=new zu;return p.curves=d.curves,r.push(p),r}var A=!f(c[0].getPoints());A=t?!A:A,p=[];var S=[],z=[],w=0;S[w]=void 0,z[w]=[];for(var I=0,E=c.length;I<E;I++){d=c[I];var P=d.getPoints(),F=f(P);(F=t?!F:F)?(!A&&S[w]&&w++,S[w]={s:new zu,p:P},S[w].s.curves=d.curves,A&&w++,z[w]=[]):z[w].push({h:d,p:P[0]})}if(!S[0])return i(c);if(1<S.length){for(I=!1,t=[],f=0,c=S.length;f<c;f++)p[f]=[];for(f=0,c=S.length;f<c;f++)for(d=z[f],F=0;F<d.length;F++){for(A=d[F],w=!0,P=0;P<S.length;P++)s(A.p,S[P].p)&&(f!==P&&t.push({froms:f,tos:P,hole:F}),w?(w=!1,p[P].push(A)):I=!0);w&&p[f].push(A)}0<t.length&&(I||(z=p))}for(I=0,f=S.length;I<f;I++)for(p=S[I].s,r.push(p),t=z[I],c=0,d=t.length;c<d;c++)p.holes.push(t[c].h);return r}}),pt(Yh.prototype,{isFont:!0,generateShapes:function(t,r){r===void 0&&(r=100);var i=[],s=r;r=this.data;var f=Hu?Hu(t):String(t).split("");s/=r.resolution;var c=(r.boundingBox.yMax-r.boundingBox.yMin+r.underlineThickness)*s;t=[];for(var d=0,p=0,A=0;A<f.length;A++){var S=f[A];if(S===`
`)d=0,p-=c;else{var z=S;S=s;var w=d,I=p,E=r,P=E.glyphs[z]||E.glyphs["?"];if(P){if(z=new Cg,P.o){E=P._cachedOutline||(P._cachedOutline=P.o.split(" "));for(var F=0,X=E.length;F<X;)switch(E[F++]){case"m":var q=E[F++]*S+w,J=E[F++]*S+I;z.moveTo(q,J);break;case"l":q=E[F++]*S+w,J=E[F++]*S+I,z.lineTo(q,J);break;case"q":var it=E[F++]*S+w,lt=E[F++]*S+I,Mt=E[F++]*S+w,Ct=E[F++]*S+I;z.quadraticCurveTo(Mt,Ct,it,lt);break;case"b":it=E[F++]*S+w,lt=E[F++]*S+I,Mt=E[F++]*S+w,Ct=E[F++]*S+I,q=E[F++]*S+w,J=E[F++]*S+I,z.bezierCurveTo(Mt,Ct,q,J,it,lt)}}S={offsetX:P.ha*S,path:z}}else console.error('THREE.Font: character "'+z+'" does not exists in font family '+E.familyName+"."),S=void 0;d+=S.offsetX,t.push(S.path)}}for(r=0,f=t.length;r<f;r++)Array.prototype.push.apply(i,t[r].toShapes());return i}}),_o.prototype=pt(ft(ai.prototype),{constructor:_o,load:function(t,r,i,s){var f=this,c=new eo(this.manager);c.setPath(this.path),c.load(t,function(d){try{var p=JSON.parse(d)}catch{console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),p=JSON.parse(d.substring(65,d.length-2))}d=f.parse(p),r&&r(d)},i,s)},parse:function(t){return new Yh(t)}});var jy,t3={getContext:function(){return jy===void 0&&(jy=new(window.AudioContext||window.webkitAudioContext)),jy},setContext:function(t){jy=t}};ps.prototype=pt(ft(ai.prototype),{constructor:ps,load:function(t,r,i,s){var f=this,c=new eo(f.manager);c.setResponseType("arraybuffer"),c.setPath(f.path),c.load(t,function(d){try{var p=d.slice(0);t3.getContext().decodeAudioData(p,function(A){r(A)})}catch(A){s?s(A):console.error(A),f.manager.itemError(t)}},i,s)}}),Tg.prototype=pt(ft(Ao.prototype),{constructor:Tg,isHemisphereLightProbe:!0,copy:function(t){return Ao.prototype.copy.call(this,t),this},toJSON:function(t){return Ao.prototype.toJSON.call(this,t)}}),Sg.prototype=pt(ft(Ao.prototype),{constructor:Sg,isAmbientLightProbe:!0,copy:function(t){return Ao.prototype.copy.call(this,t),this},toJSON:function(t){return Ao.prototype.toJSON.call(this,t)}});var e3=new Me,r3=new Me;pt(function(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new en,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new en,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}.prototype,{update:function(t){var r=this._cache;if(r.focus!==t.focus||r.fov!==t.fov||r.aspect!==t.aspect*this.aspect||r.near!==t.near||r.far!==t.far||r.zoom!==t.zoom||r.eyeSep!==this.eyeSep){r.focus=t.focus,r.fov=t.fov,r.aspect=t.aspect*this.aspect,r.near=t.near,r.far=t.far,r.zoom=t.zoom,r.eyeSep=this.eyeSep;var i=t.projectionMatrix.clone(),s=r.eyeSep/2,f=s*r.near/r.focus,c=r.near*Math.tan(ti.DEG2RAD*r.fov*.5)/r.zoom;r3.elements[12]=-s,e3.elements[12]=s,s=-c*r.aspect+f;var d=c*r.aspect+f;i.elements[0]=2*r.near/(d-s),i.elements[8]=(d+s)/(d-s),this.cameraL.projectionMatrix.copy(i),s=-c*r.aspect-f,d=c*r.aspect-f,i.elements[0]=2*r.near/(d-s),i.elements[8]=(d+s)/(d-s),this.cameraR.projectionMatrix.copy(i)}this.cameraL.matrixWorld.copy(t.matrixWorld).multiply(r3),this.cameraR.matrixWorld.copy(t.matrixWorld).multiply(e3)}}),pt(gd.prototype,{start:function(){this.oldTime=this.startTime=(typeof performance=="undefined"?Date:performance).now(),this.elapsedTime=0,this.running=!0},stop:function(){this.getElapsedTime(),this.autoStart=this.running=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){var t=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var r=(typeof performance=="undefined"?Date:performance).now();t=(r-this.oldTime)/1e3,this.oldTime=r,this.elapsedTime+=t}return t}});var lp=new dt,i3=new ye,oE=new dt,hp=new dt;Ig.prototype=pt(ft(fe.prototype),{constructor:Ig,getInput:function(){return this.gain},removeFilter:function(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this},getFilter:function(){return this.filter},setFilter:function(t){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=t,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this},getMasterVolume:function(){return this.gain.gain.value},setMasterVolume:function(t){return this.gain.gain.setTargetAtTime(t,this.context.currentTime,.01),this},updateMatrixWorld:function(t){fe.prototype.updateMatrixWorld.call(this,t),t=this.context.listener;var r=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(lp,i3,oE),hp.set(0,0,-1).applyQuaternion(i3),t.positionX){var i=this.context.currentTime+this.timeDelta;t.positionX.linearRampToValueAtTime(lp.x,i),t.positionY.linearRampToValueAtTime(lp.y,i),t.positionZ.linearRampToValueAtTime(lp.z,i),t.forwardX.linearRampToValueAtTime(hp.x,i),t.forwardY.linearRampToValueAtTime(hp.y,i),t.forwardZ.linearRampToValueAtTime(hp.z,i),t.upX.linearRampToValueAtTime(r.x,i),t.upY.linearRampToValueAtTime(r.y,i),t.upZ.linearRampToValueAtTime(r.z,i)}else t.setPosition(lp.x,lp.y,lp.z),t.setOrientation(hp.x,hp.y,hp.z,r.x,r.y,r.z)}}),Zh.prototype=pt(ft(fe.prototype),{constructor:Zh,getOutput:function(){return this.gain},setNodeSource:function(t){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=t,this.connect(),this},setMediaElementSource:function(t){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(t),this.connect(),this},setMediaStreamSource:function(t){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(t),this.connect(),this},setBuffer:function(t){return this.buffer=t,this.sourceType="buffer",this.autoplay&&this.play(),this},play:function(t){if(t===void 0&&(t=0),this.isPlaying===!0)console.warn("THREE.Audio: Audio is already playing.");else if(this.hasPlaybackControl===!1)console.warn("THREE.Audio: this Audio has no playback control.");else return this._startedAt=this.context.currentTime+t,t=this.context.createBufferSource(),t.buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()},pause:function(){if(this.hasPlaybackControl===!1)console.warn("THREE.Audio: this Audio has no playback control.");else return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress%=this.duration||this.buffer.duration),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this},stop:function(){if(this.hasPlaybackControl===!1)console.warn("THREE.Audio: this Audio has no playback control.");else return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this},connect:function(){if(0<this.filters.length){this.source.connect(this.filters[0]);for(var t=1,r=this.filters.length;t<r;t++)this.filters[t-1].connect(this.filters[t]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this},disconnect:function(){if(0<this.filters.length){this.source.disconnect(this.filters[0]);for(var t=1,r=this.filters.length;t<r;t++)this.filters[t-1].disconnect(this.filters[t]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this},getFilters:function(){return this.filters},setFilters:function(t){return t||(t=[]),this.isPlaying===!0?(this.disconnect(),this.filters=t,this.connect()):this.filters=t,this},setDetune:function(t){if(this.detune=t,this.source.detune!==void 0)return this.isPlaying===!0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this},getDetune:function(){return this.detune},getFilter:function(){return this.getFilters()[0]},setFilter:function(t){return this.setFilters(t?[t]:[])},setPlaybackRate:function(t){if(this.hasPlaybackControl===!1)console.warn("THREE.Audio: this Audio has no playback control.");else return this.playbackRate=t,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this},getPlaybackRate:function(){return this.playbackRate},onEnded:function(){this.isPlaying=!1},getLoop:function(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop},setLoop:function(t){if(this.hasPlaybackControl===!1)console.warn("THREE.Audio: this Audio has no playback control.");else return this.loop=t,this.isPlaying===!0&&(this.source.loop=this.loop),this},setLoopStart:function(t){return this.loopStart=t,this},setLoopEnd:function(t){return this.loopEnd=t,this},getVolume:function(){return this.gain.gain.value},setVolume:function(t){return this.gain.gain.setTargetAtTime(t,this.context.currentTime,.01),this}});var cp=new dt,n3=new ye,sE=new dt,fp=new dt;vd.prototype=pt(ft(Zh.prototype),{constructor:vd,getOutput:function(){return this.panner},getRefDistance:function(){return this.panner.refDistance},setRefDistance:function(t){return this.panner.refDistance=t,this},getRolloffFactor:function(){return this.panner.rolloffFactor},setRolloffFactor:function(t){return this.panner.rolloffFactor=t,this},getDistanceModel:function(){return this.panner.distanceModel},setDistanceModel:function(t){return this.panner.distanceModel=t,this},getMaxDistance:function(){return this.panner.maxDistance},setMaxDistance:function(t){return this.panner.maxDistance=t,this},setDirectionalCone:function(t,r,i){return this.panner.coneInnerAngle=t,this.panner.coneOuterAngle=r,this.panner.coneOuterGain=i,this},updateMatrixWorld:function(t){if(fe.prototype.updateMatrixWorld.call(this,t),this.hasPlaybackControl!==!0||this.isPlaying!==!1)if(this.matrixWorld.decompose(cp,n3,sE),fp.set(0,0,1).applyQuaternion(n3),t=this.panner,t.positionX){var r=this.context.currentTime+this.listener.timeDelta;t.positionX.linearRampToValueAtTime(cp.x,r),t.positionY.linearRampToValueAtTime(cp.y,r),t.positionZ.linearRampToValueAtTime(cp.z,r),t.orientationX.linearRampToValueAtTime(fp.x,r),t.orientationY.linearRampToValueAtTime(fp.y,r),t.orientationZ.linearRampToValueAtTime(fp.z,r)}else t.setPosition(cp.x,cp.y,cp.z),t.setOrientation(fp.x,fp.y,fp.z)}}),pt(Eg.prototype,{getFrequencyData:function(){return this.analyser.getByteFrequencyData(this.data),this.data},getAverageFrequency:function(){for(var t=0,r=this.getFrequencyData(),i=0;i<r.length;i++)t+=r[i];return t/r.length}}),pt(yd.prototype,{accumulate:function(t,r){var i=this.buffer,s=this.valueSize;t=t*s+s;var f=this.cumulativeWeight;if(f===0){for(f=0;f!==s;++f)i[t+f]=i[f];f=r}else f+=r,this._mixBufferRegion(i,t,0,r/f,s);this.cumulativeWeight=f},accumulateAdditive:function(t){var r=this.buffer,i=this.valueSize,s=i*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(r,s,0,t,i),this.cumulativeWeightAdditive+=t},apply:function(t){var r=this.valueSize,i=this.buffer;t=t*r+r;var s=this.cumulativeWeight,f=this.cumulativeWeightAdditive,c=this.binding;for(this.cumulativeWeightAdditive=this.cumulativeWeight=0,1>s&&this._mixBufferRegion(i,t,r*this._origIndex,1-s,r),0<f&&this._mixBufferRegionAdditive(i,t,this._addIndex*r,1,r),s=r,f=r+r;s!==f;++s)if(i[s]!==i[s+r]){c.setValue(i,t);break}},saveOriginalState:function(){var t=this.buffer,r=this.valueSize,i=r*this._origIndex;this.binding.getValue(t,i);for(var s=r;s!==i;++s)t[s]=t[i+s%r];this._setIdentity(),this.cumulativeWeightAdditive=this.cumulativeWeight=0},restoreOriginalState:function(){this.binding.setValue(this.buffer,3*this.valueSize)},_setAdditiveIdentityNumeric:function(){for(var t=this._addIndex*this.valueSize,r=t+this.valueSize;t<r;t++)this.buffer[t]=0},_setAdditiveIdentityQuaternion:function(){this._setAdditiveIdentityNumeric(),this.buffer[4*this._addIndex+3]=1},_setAdditiveIdentityOther:function(){for(var t=this._origIndex*this.valueSize,r=this._addIndex*this.valueSize,i=0;i<this.valueSize;i++)this.buffer[r+i]=this.buffer[t+i]},_select:function(t,r,i,s,f){if(.5<=s)for(s=0;s!==f;++s)t[r+s]=t[i+s]},_slerp:function(t,r,i,s){ye.slerpFlat(t,r,t,r,t,i,s)},_slerpAdditive:function(t,r,i,s,f){f*=this._workIndex,ye.multiplyQuaternionsFlat(t,f,t,r,t,i),ye.slerpFlat(t,r,t,r,t,f,s)},_lerp:function(t,r,i,s,f){for(var c=1-s,d=0;d!==f;++d){var p=r+d;t[p]=t[p]*c+t[i+d]*s}},_lerpAdditive:function(t,r,i,s,f){for(var c=0;c!==f;++c){var d=r+c;t[d]+=t[i+c]*s}}});var aE=/[\[\]\.:\/]/g,uE="[^"+"\\[\\]\\.:\\/".replace("\\.","")+"]",lE=/((?:WC+[\/:])*)/.source.replace("WC","[^\\[\\]\\.:\\/]"),hE=/(WCOD+)?/.source.replace("WCOD",uE),cE=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC","[^\\[\\]\\.:\\/]"),fE=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC","[^\\[\\]\\.:\\/]"),pE=new RegExp("^"+lE+hE+cE+fE+"$"),dE=["material","materials","bones"];pt(Lg.prototype,{getValue:function(t,r){this.bind();var i=this._bindings[this._targetGroup.nCachedObjects_];i!==void 0&&i.getValue(t,r)},setValue:function(t,r){for(var i=this._bindings,s=this._targetGroup.nCachedObjects_,f=i.length;s!==f;++s)i[s].setValue(t,r)},bind:function(){for(var t=this._bindings,r=this._targetGroup.nCachedObjects_,i=t.length;r!==i;++r)t[r].bind()},unbind:function(){for(var t=this._bindings,r=this._targetGroup.nCachedObjects_,i=t.length;r!==i;++r)t[r].unbind()}}),pt(io,{Composite:Lg,create:function(t,r,i){return t&&t.isAnimationObjectGroup?new io.Composite(t,r,i):new io(t,r,i)},sanitizeNodeName:function(t){return t.replace(/\s/g,"_").replace(aE,"")},parseTrackName:function(t){var r=pE.exec(t);if(!r)throw Error("PropertyBinding: Cannot parse trackName: "+t);r={nodeName:r[2],objectName:r[3],objectIndex:r[4],propertyName:r[5],propertyIndex:r[6]};var i=r.nodeName&&r.nodeName.lastIndexOf(".");if(i!==void 0&&i!==-1){var s=r.nodeName.substring(i+1);dE.indexOf(s)!==-1&&(r.nodeName=r.nodeName.substring(0,i),r.objectName=s)}if(r.propertyName===null||r.propertyName.length===0)throw Error("PropertyBinding: can not parse propertyName from trackName: "+t);return r},findNode:function(t,r){if(!r||r===""||r==="."||r===-1||r===t.name||r===t.uuid)return t;if(t.skeleton){var i=t.skeleton.getBoneByName(r);if(i!==void 0)return i}return t.children&&(t=function s(f){for(var c=0;c<f.length;c++){var d=f[c];if(d.name===r||d.uuid===r||(d=s(d.children)))return d}return null}(t.children))?t:null}}),pt(io.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(t,r){t[r]=this.node[this.propertyName]},function(t,r){for(var i=this.resolvedProperty,s=0,f=i.length;s!==f;++s)t[r++]=i[s]},function(t,r){t[r]=this.resolvedProperty[this.propertyIndex]},function(t,r){this.resolvedProperty.toArray(t,r)}],SetterByBindingTypeAndVersioning:[[function(t,r){this.targetObject[this.propertyName]=t[r]},function(t,r){this.targetObject[this.propertyName]=t[r],this.targetObject.needsUpdate=!0},function(t,r){this.targetObject[this.propertyName]=t[r],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,r){for(var i=this.resolvedProperty,s=0,f=i.length;s!==f;++s)i[s]=t[r++]},function(t,r){for(var i=this.resolvedProperty,s=0,f=i.length;s!==f;++s)i[s]=t[r++];this.targetObject.needsUpdate=!0},function(t,r){for(var i=this.resolvedProperty,s=0,f=i.length;s!==f;++s)i[s]=t[r++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,r){this.resolvedProperty[this.propertyIndex]=t[r]},function(t,r){this.resolvedProperty[this.propertyIndex]=t[r],this.targetObject.needsUpdate=!0},function(t,r){this.resolvedProperty[this.propertyIndex]=t[r],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,r){this.resolvedProperty.fromArray(t,r)},function(t,r){this.resolvedProperty.fromArray(t,r),this.targetObject.needsUpdate=!0},function(t,r){this.resolvedProperty.fromArray(t,r),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(t,r){this.bind(),this.getValue(t,r)},setValue:function(t,r){this.bind(),this.setValue(t,r)},bind:function(){var t=this.node,r=this.parsedPath,i=r.objectName,s=r.propertyName,f=r.propertyIndex;if(t||(this.node=t=io.findNode(this.rootNode,r.nodeName)||this.rootNode),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,t){if(i){var c=r.objectIndex;switch(i){case"materials":if(!t.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!t.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}t=t.material.materials;break;case"bones":if(!t.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}for(t=t.skeleton.bones,i=0;i<t.length;i++)if(t[i].name===c){c=i;break}break;default:if(t[i]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}t=t[i]}if(c!==void 0){if(t[c]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);return}t=t[c]}}if(c=t[s],c===void 0)console.error("THREE.PropertyBinding: Trying to update property for track: "+r.nodeName+"."+s+" but it wasn't found.",t);else{if(r=this.Versioning.None,this.targetObject=t,t.needsUpdate!==void 0?r=this.Versioning.NeedsUpdate:t.matrixWorldNeedsUpdate!==void 0&&(r=this.Versioning.MatrixWorldNeedsUpdate),i=this.BindingType.Direct,f!==void 0){if(s==="morphTargetInfluences"){if(!t.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(t.geometry.isBufferGeometry){if(!t.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}t.morphTargetDictionary[f]!==void 0&&(f=t.morphTargetDictionary[f])}else{console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences on THREE.Geometry. Use THREE.BufferGeometry instead.",this);return}}i=this.BindingType.ArrayElement,this.resolvedProperty=c,this.propertyIndex=f}else c.fromArray!==void 0&&c.toArray!==void 0?(i=this.BindingType.HasFromToArray,this.resolvedProperty=c):Array.isArray(c)?(i=this.BindingType.EntireArray,this.resolvedProperty=c):this.propertyName=s;this.getValue=this.GetterByBindingType[i],this.setValue=this.SetterByBindingTypeAndVersioning[i][r]}}else console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.")},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}),pt(io.prototype,{_getValue_unbound:io.prototype.getValue,_setValue_unbound:io.prototype.setValue}),pt(function(){this.uuid=ti.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;var t={};this._indicesByUUID=t;for(var r=0,i=arguments.length;r!==i;++r)t[arguments[r].uuid]=r;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};var s=this;this.stats={objects:{get total(){return s._objects.length},get inUse(){return this.total-s.nCachedObjects_}},get bindingsPerObject(){return s._bindings.length}}}.prototype,{isAnimationObjectGroup:!0,add:function(){for(var t=this._objects,r=t.length,i=this.nCachedObjects_,s=this._indicesByUUID,f=this._paths,c=this._parsedPaths,d=this._bindings,p=d.length,A=void 0,S=0,z=arguments.length;S!==z;++S){var w=arguments[S],I=w.uuid,E=s[I];if(E===void 0){E=r++,s[I]=E,t.push(w),I=0;for(var P=p;I!==P;++I)d[I].push(new io(w,f[I],c[I]))}else if(E<i){A=t[E];var F=--i;for(P=t[F],s[P.uuid]=E,t[E]=P,s[I]=F,t[F]=w,I=0,P=p;I!==P;++I){var X=d[I],q=X[E];X[E]=X[F],q===void 0&&(q=new io(w,f[I],c[I])),X[F]=q}}else t[E]!==A&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=i},remove:function(){for(var t=this._objects,r=this.nCachedObjects_,i=this._indicesByUUID,s=this._bindings,f=s.length,c=0,d=arguments.length;c!==d;++c){var p=arguments[c],A=p.uuid,S=i[A];if(S!==void 0&&S>=r){var z=r++,w=t[z];for(i[w.uuid]=S,t[S]=w,i[A]=z,t[z]=p,p=0,A=f;p!==A;++p){w=s[p];var I=w[S];w[S]=w[z],w[z]=I}}}this.nCachedObjects_=r},uncache:function(){for(var t=this._objects,r=t.length,i=this.nCachedObjects_,s=this._indicesByUUID,f=this._bindings,c=f.length,d=0,p=arguments.length;d!==p;++d){var A=arguments[d].uuid,S=s[A];if(S!==void 0)if(delete s[A],S<i){A=--i;var z=t[A],w=--r,I=t[w];for(s[z.uuid]=S,t[S]=z,s[I.uuid]=A,t[A]=I,t.pop(),z=0,I=c;z!==I;++z){var E=f[z],P=E[w];E[S]=E[A],E[A]=P,E.pop()}}else for(w=--r,I=t[w],s[I.uuid]=S,t[S]=I,t.pop(),z=0,I=c;z!==I;++z)E=f[z],E[S]=E[w],E.pop()}this.nCachedObjects_=i},subscribe_:function(t,r){var i=this._bindingsIndicesByPath,s=i[t],f=this._bindings;if(s!==void 0)return f[s];var c=this._paths,d=this._parsedPaths,p=this._objects,A=this.nCachedObjects_,S=Array(p.length);for(s=f.length,i[t]=s,c.push(t),d.push(r),f.push(S),i=A,s=p.length;i!==s;++i)S[i]=new io(p[i],t,r);return S},unsubscribe_:function(t){var r=this._bindingsIndicesByPath,i=r[t];if(i!==void 0){var s=this._paths,f=this._parsedPaths,c=this._bindings,d=c.length-1,p=c[d];r[t[d]]=i,c[i]=p,c.pop(),f[i]=f[d],f.pop(),s[i]=s[d],s.pop()}}}),pt(T1.prototype,{play:function(){return this._mixer._activateAction(this),this},stop:function(){return this._mixer._deactivateAction(this),this.reset()},reset:function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()},isRunning:function(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)},isScheduled:function(){return this._mixer._isActiveAction(this)},startAt:function(t){return this._startTime=t,this},setLoop:function(t,r){return this.loop=t,this.repetitions=r,this},setEffectiveWeight:function(t){return this.weight=t,this._effectiveWeight=this.enabled?t:0,this.stopFading()},getEffectiveWeight:function(){return this._effectiveWeight},fadeIn:function(t){return this._scheduleFading(t,0,1)},fadeOut:function(t){return this._scheduleFading(t,1,0)},crossFadeFrom:function(t,r,i){if(t.fadeOut(r),this.fadeIn(r),i){i=this._clip.duration;var s=t._clip.duration,f=i/s;t.warp(1,s/i,r),this.warp(f,1,r)}return this},crossFadeTo:function(t,r,i){return t.crossFadeFrom(this,r,i)},stopFading:function(){var t=this._weightInterpolant;return t!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this},setEffectiveTimeScale:function(t){return this.timeScale=t,this._effectiveTimeScale=this.paused?0:t,this.stopWarping()},getEffectiveTimeScale:function(){return this._effectiveTimeScale},setDuration:function(t){return this.timeScale=this._clip.duration/t,this.stopWarping()},syncWith:function(t){return this.time=t.time,this.timeScale=t.timeScale,this.stopWarping()},halt:function(t){return this.warp(this._effectiveTimeScale,0,t)},warp:function(t,r,i){var s=this._mixer,f=s.time,c=this._timeScaleInterpolant,d=this.timeScale;return c===null&&(this._timeScaleInterpolant=c=s._lendControlInterpolant()),s=c.parameterPositions,c=c.sampleValues,s[0]=f,s[1]=f+i,c[0]=t/d,c[1]=r/d,this},stopWarping:function(){var t=this._timeScaleInterpolant;return t!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this},getMixer:function(){return this._mixer},getClip:function(){return this._clip},getRoot:function(){return this._localRoot||this._mixer._root},_update:function(t,r,i,s){if(this.enabled){var f=this._startTime;if(f!==null){if(r=(t-f)*i,0>r||i===0)return;this._startTime=null,r*=i}if(r*=this._updateTimeScale(t),i=this._updateTime(r),t=this._updateWeight(t),0<t)switch(r=this._interpolants,f=this._propertyBindings,this.blendMode){case 2501:for(var c=0,d=r.length;c!==d;++c)r[c].evaluate(i),f[c].accumulateAdditive(t);break;default:for(c=0,d=r.length;c!==d;++c)r[c].evaluate(i),f[c].accumulate(s,t)}}else this._updateWeight(t)},_updateWeight:function(t){var r=0;if(this.enabled){r=this.weight;var i=this._weightInterpolant;if(i!==null){var s=i.evaluate(t)[0];r*=s,t>i.parameterPositions[1]&&(this.stopFading(),s===0&&(this.enabled=!1))}}return this._effectiveWeight=r},_updateTimeScale:function(t){var r=0;if(!this.paused){r=this.timeScale;var i=this._timeScaleInterpolant;if(i!==null){var s=i.evaluate(t)[0];r*=s,t>i.parameterPositions[1]&&(this.stopWarping(),r===0?this.paused=!0:this.timeScale=r)}}return this._effectiveTimeScale=r},_updateTime:function(t){var r=this.time+t,i=this._clip.duration,s=this.loop,f=this._loopCount,c=s===2202;if(t===0)return f===-1?r:c&&(f&1)===1?i-r:r;if(s===2200)t:{if(f===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1)),r>=i)r=i;else if(0>r)r=0;else{this.time=r;break t}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:0>t?-1:1})}else{if(f===-1&&(0<=t?(f=0,this._setEndings(!0,this.repetitions===0,c)):this._setEndings(this.repetitions===0,!0,c)),r>=i||0>r){s=Math.floor(r/i),r-=i*s,f+=Math.abs(s);var d=this.repetitions-f;0>=d?(this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=r=0<t?i:0,this._mixer.dispatchEvent({type:"finished",action:this,direction:0<t?1:-1})):(d===1?(t=0>t,this._setEndings(t,!t,c)):this._setEndings(!1,!1,c),this._loopCount=f,this.time=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:s}))}else this.time=r;if(c&&(f&1)===1)return i-r}return r},_setEndings:function(t,r,i){var s=this._interpolantSettings;i?(s.endingStart=2401,s.endingEnd=2401):(s.endingStart=t?this.zeroSlopeAtStart?2401:2400:2402,s.endingEnd=r?this.zeroSlopeAtEnd?2401:2400:2402)},_scheduleFading:function(t,r,i){var s=this._mixer,f=s.time,c=this._weightInterpolant;return c===null&&(this._weightInterpolant=c=s._lendControlInterpolant()),s=c.parameterPositions,c=c.sampleValues,s[0]=f,c[0]=r,s[1]=f+t,c[1]=i,this}}),Rg.prototype=pt(ft(se.prototype),{constructor:Rg,_bindAction:function(t,r){var i=t._localRoot||this._root,s=t._clip.tracks,f=s.length,c=t._propertyBindings;t=t._interpolants;var d=i.uuid,p=this._bindingsByRootAndName,A=p[d];for(A===void 0&&(A={},p[d]=A),p=0;p!==f;++p){var S=s[p],z=S.name,w=A[z];if(w===void 0){if(w=c[p],w!==void 0){w._cacheIndex===null&&(++w.referenceCount,this._addInactiveBinding(w,d,z));continue}w=new yd(io.create(i,z,r&&r._propertyBindings[p].binding.parsedPath),S.ValueTypeName,S.getValueSize()),++w.referenceCount,this._addInactiveBinding(w,d,z)}c[p]=w,t[p].resultBuffer=w.buffer}},_activateAction:function(t){if(!this._isActiveAction(t)){if(t._cacheIndex===null){var r=(t._localRoot||this._root).uuid,i=t._clip.uuid,s=this._actionsByClip[i];this._bindAction(t,s&&s.knownActions[0]),this._addInactiveAction(t,i,r)}for(r=t._propertyBindings,i=0,s=r.length;i!==s;++i){var f=r[i];f.useCount++===0&&(this._lendBinding(f),f.saveOriginalState())}this._lendAction(t)}},_deactivateAction:function(t){if(this._isActiveAction(t)){for(var r=t._propertyBindings,i=0,s=r.length;i!==s;++i){var f=r[i];--f.useCount===0&&(f.restoreOriginalState(),this._takeBackBinding(f))}this._takeBackAction(t)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;var t=this;this.stats={actions:{get total(){return t._actions.length},get inUse(){return t._nActiveActions}},bindings:{get total(){return t._bindings.length},get inUse(){return t._nActiveBindings}},controlInterpolants:{get total(){return t._controlInterpolants.length},get inUse(){return t._nActiveControlInterpolants}}}},_isActiveAction:function(t){return t=t._cacheIndex,t!==null&&t<this._nActiveActions},_addInactiveAction:function(t,r,i){var s=this._actions,f=this._actionsByClip,c=f[r];c===void 0?(c={knownActions:[t],actionByRoot:{}},t._byClipCacheIndex=0,f[r]=c):(r=c.knownActions,t._byClipCacheIndex=r.length,r.push(t)),t._cacheIndex=s.length,s.push(t),c.actionByRoot[i]=t},_removeInactiveAction:function(t){var r=this._actions,i=r[r.length-1],s=t._cacheIndex;i._cacheIndex=s,r[s]=i,r.pop(),t._cacheIndex=null,r=t._clip.uuid,i=this._actionsByClip,s=i[r];var f=s.knownActions,c=f[f.length-1],d=t._byClipCacheIndex;c._byClipCacheIndex=d,f[d]=c,f.pop(),t._byClipCacheIndex=null,delete s.actionByRoot[(t._localRoot||this._root).uuid],f.length===0&&delete i[r],this._removeInactiveBindingsForAction(t)},_removeInactiveBindingsForAction:function(t){t=t._propertyBindings;for(var r=0,i=t.length;r!==i;++r){var s=t[r];--s.referenceCount===0&&this._removeInactiveBinding(s)}},_lendAction:function(t){var r=this._actions,i=t._cacheIndex,s=this._nActiveActions++,f=r[s];t._cacheIndex=s,r[s]=t,f._cacheIndex=i,r[i]=f},_takeBackAction:function(t){var r=this._actions,i=t._cacheIndex,s=--this._nActiveActions,f=r[s];t._cacheIndex=s,r[s]=t,f._cacheIndex=i,r[i]=f},_addInactiveBinding:function(t,r,i){var s=this._bindingsByRootAndName,f=s[r],c=this._bindings;f===void 0&&(f={},s[r]=f),f[i]=t,t._cacheIndex=c.length,c.push(t)},_removeInactiveBinding:function(t){var r=this._bindings,i=t.binding,s=i.rootNode.uuid;i=i.path;var f=this._bindingsByRootAndName,c=f[s],d=r[r.length-1];t=t._cacheIndex,d._cacheIndex=t,r[t]=d,r.pop(),delete c[i],Ti(c).length===0&&delete f[s]},_lendBinding:function(t){var r=this._bindings,i=t._cacheIndex,s=this._nActiveBindings++,f=r[s];t._cacheIndex=s,r[s]=t,f._cacheIndex=i,r[i]=f},_takeBackBinding:function(t){var r=this._bindings,i=t._cacheIndex,s=--this._nActiveBindings,f=r[s];t._cacheIndex=s,r[s]=t,f._cacheIndex=i,r[i]=f},_lendControlInterpolant:function(){var t=this._controlInterpolants,r=this._nActiveControlInterpolants++,i=t[r];return i===void 0&&(i=new fd(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer),i.__cacheIndex=r,t[r]=i),i},_takeBackControlInterpolant:function(t){var r=this._controlInterpolants,i=t.__cacheIndex,s=--this._nActiveControlInterpolants,f=r[s];t.__cacheIndex=s,r[s]=t,f.__cacheIndex=i,r[i]=f},_controlInterpolantsResultBuffer:new Float32Array(1),clipAction:function(t,r,i){var s=r||this._root,f=s.uuid;s=typeof t=="string"?Fo.findByName(s,t):t,t=s!==null?s.uuid:t;var c=this._actionsByClip[t],d=null;if(i===void 0&&(i=s!==null?s.blendMode:2500),c!==void 0){if(d=c.actionByRoot[f],d!==void 0&&d.blendMode===i)return d;d=c.knownActions[0],s===null&&(s=d._clip)}return s===null?null:(r=new T1(this,s,r,i),this._bindAction(r,d),this._addInactiveAction(r,t,f),r)},existingAction:function(t,r){var i=r||this._root;return r=i.uuid,i=typeof t=="string"?Fo.findByName(i,t):t,t=this._actionsByClip[i?i.uuid:t],t!==void 0&&t.actionByRoot[r]||null},stopAllAction:function(){for(var t=this._actions,r=this._nActiveActions-1;0<=r;--r)t[r].stop();return this},update:function(t){t*=this.timeScale;for(var r=this._actions,i=this._nActiveActions,s=this.time+=t,f=Qu(t),c=this._accuIndex^=1,d=0;d!==i;++d)r[d]._update(s,t,f,c);for(t=this._bindings,r=this._nActiveBindings,d=0;d!==r;++d)t[d].apply(c);return this},setTime:function(t){for(var r=this.time=0;r<this._actions.length;r++)this._actions[r].time=0;return this.update(t)},getRoot:function(){return this._root},uncacheClip:function(t){var r=this._actions;t=t.uuid;var i=this._actionsByClip,s=i[t];if(s!==void 0){s=s.knownActions;for(var f=0,c=s.length;f!==c;++f){var d=s[f];this._deactivateAction(d);var p=d._cacheIndex,A=r[r.length-1];d._cacheIndex=null,d._byClipCacheIndex=null,A._cacheIndex=p,r[p]=A,r.pop(),this._removeInactiveBindingsForAction(d)}delete i[t]}},uncacheRoot:function(t){t=t.uuid;var r=this._actionsByClip;for(s in r){var i=r[s].actionByRoot[t];i!==void 0&&(this._deactivateAction(i),this._removeInactiveAction(i))}var s=this._bindingsByRootAndName[t];if(s!==void 0)for(var f in s)t=s[f],t.restoreOriginalState(),this._removeInactiveBinding(t)},uncacheAction:function(t,r){t=this.existingAction(t,r),t!==null&&(this._deactivateAction(t),this._removeInactiveAction(t))}}),xd.prototype.clone=function(){return new xd(this.value.clone===void 0?this.value:this.value.clone())},qh.prototype=pt(ft(Ue.prototype),{constructor:qh,isInstancedInterleavedBuffer:!0,copy:function(t){return Ue.prototype.copy.call(this,t),this.meshPerAttribute=t.meshPerAttribute,this}}),pt(S1.prototype,{set:function(t,r){this.ray.set(t,r)},setFromCamera:function(t,r){r&&r.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(r.matrixWorld),this.ray.direction.set(t.x,t.y,.5).unproject(r).sub(this.ray.origin).normalize(),this.camera=r):r&&r.isOrthographicCamera?(this.ray.origin.set(t.x,t.y,(r.near+r.far)/(r.near-r.far)).unproject(r),this.ray.direction.set(0,0,-1).transformDirection(r.matrixWorld),this.camera=r):console.error("THREE.Raycaster: Unsupported camera type.")},intersectObject:function(t,r,i){return i=i||[],Ya(t,this,i,r),i.sort(Hn),i},intersectObjects:function(t,r,i){if(i=i||[],Array.isArray(t)===!1)return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),i;for(var s=0,f=t.length;s<f;s++)Ya(t[s],this,i,r);return i.sort(Hn),i}}),pt(function(t,r,i){return this.radius=t!==void 0?t:1,this.phi=r!==void 0?r:0,this.theta=i!==void 0?i:0,this}.prototype,{set:function(t,r,i){return this.radius=t,this.phi=r,this.theta=i,this},clone:function(){return new this.constructor().copy(this)},copy:function(t){return this.radius=t.radius,this.phi=t.phi,this.theta=t.theta,this},makeSafe:function(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this},setFromVector3:function(t){return this.setFromCartesianCoords(t.x,t.y,t.z)},setFromCartesianCoords:function(t,r,i){return this.radius=Math.sqrt(t*t+r*r+i*i),this.radius===0?this.phi=this.theta=0:(this.theta=Math.atan2(t,i),this.phi=Math.acos(ti.clamp(r/this.radius,-1,1))),this}}),pt(function(t,r,i){return this.radius=t!==void 0?t:1,this.theta=r!==void 0?r:0,this.y=i!==void 0?i:0,this}.prototype,{set:function(t,r,i){return this.radius=t,this.theta=r,this.y=i,this},clone:function(){return new this.constructor().copy(this)},copy:function(t){return this.radius=t.radius,this.theta=t.theta,this.y=t.y,this},setFromVector3:function(t){return this.setFromCartesianCoords(t.x,t.y,t.z)},setFromCartesianCoords:function(t,r,i){return this.radius=Math.sqrt(t*t+i*i),this.theta=Math.atan2(t,i),this.y=r,this}});var o3=new Ot;pt(br.prototype,{set:function(t,r){return this.min.copy(t),this.max.copy(r),this},setFromPoints:function(t){this.makeEmpty();for(var r=0,i=t.length;r<i;r++)this.expandByPoint(t[r]);return this},setFromCenterAndSize:function(t,r){return r=o3.copy(r).multiplyScalar(.5),this.min.copy(t).sub(r),this.max.copy(t).add(r),this},clone:function(){return new this.constructor().copy(this)},copy:function(t){return this.min.copy(t.min),this.max.copy(t.max),this},makeEmpty:function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},getCenter:function(t){return t===void 0&&(console.warn("THREE.Box2: .getCenter() target is now required"),t=new Ot),this.isEmpty()?t.set(0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(t){return t===void 0&&(console.warn("THREE.Box2: .getSize() target is now required"),t=new Ot),this.isEmpty()?t.set(0,0):t.subVectors(this.max,this.min)},expandByPoint:function(t){return this.min.min(t),this.max.max(t),this},expandByVector:function(t){return this.min.sub(t),this.max.add(t),this},expandByScalar:function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},containsPoint:function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y)},containsBox:function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y},getParameter:function(t,r){return r===void 0&&(console.warn("THREE.Box2: .getParameter() target is now required"),r=new Ot),r.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y))},intersectsBox:function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y)},clampPoint:function(t,r){return r===void 0&&(console.warn("THREE.Box2: .clampPoint() target is now required"),r=new Ot),r.copy(t).clamp(this.min,this.max)},distanceToPoint:function(t){return o3.copy(t).clamp(this.min,this.max).sub(t).length()},intersect:function(t){return this.min.max(t.min),this.max.min(t.max),this},union:function(t){return this.min.min(t.min),this.max.max(t.max),this},translate:function(t){return this.min.add(t),this.max.add(t),this},equals:function(t){return t.min.equals(this.min)&&t.max.equals(this.max)}});var s3=new dt,Xy=new dt;pt(Za.prototype,{set:function(t,r){return this.start.copy(t),this.end.copy(r),this},clone:function(){return new this.constructor().copy(this)},copy:function(t){return this.start.copy(t.start),this.end.copy(t.end),this},getCenter:function(t){return t===void 0&&(console.warn("THREE.Line3: .getCenter() target is now required"),t=new dt),t.addVectors(this.start,this.end).multiplyScalar(.5)},delta:function(t){return t===void 0&&(console.warn("THREE.Line3: .delta() target is now required"),t=new dt),t.subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(t,r){return r===void 0&&(console.warn("THREE.Line3: .at() target is now required"),r=new dt),this.delta(r).multiplyScalar(t).add(this.start)},closestPointToPointParameter:function(t,r){return s3.subVectors(t,this.start),Xy.subVectors(this.end,this.start),t=Xy.dot(Xy),t=Xy.dot(s3)/t,r&&(t=ti.clamp(t,0,1)),t},closestPointToPoint:function(t,r,i){return t=this.closestPointToPointParameter(t,r),i===void 0&&(console.warn("THREE.Line3: .closestPointToPoint() target is now required"),i=new dt),this.delta(i).multiplyScalar(t).add(this.start)},applyMatrix4:function(t){return this.start.applyMatrix4(t),this.end.applyMatrix4(t),this},equals:function(t){return t.start.equals(this.start)&&t.end.equals(this.end)}}),aa.prototype=ft(fe.prototype),aa.prototype.constructor=aa,aa.prototype.isImmediateRenderObject=!0;var a3=new dt;Lf.prototype=ft(fe.prototype),Lf.prototype.constructor=Lf,Lf.prototype.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},Lf.prototype.update=function(){this.light.updateMatrixWorld();var t=this.light.distance?this.light.distance:1e3,r=t*Math.tan(this.light.angle);this.cone.scale.set(r,r,t),a3.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(a3),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)};var yc=new dt,Yy=new Me,S_=new Me;qo.prototype=ft(Fi.prototype),qo.prototype.constructor=qo,qo.prototype.isSkeletonHelper=!0,qo.prototype.updateMatrixWorld=function(t){var r=this.bones,i=this.geometry,s=i.getAttribute("position");S_.getInverse(this.root.matrixWorld);for(var f=0,c=0;f<r.length;f++){var d=r[f];d.parent&&d.parent.isBone&&(Yy.multiplyMatrices(S_,d.matrixWorld),yc.setFromMatrixPosition(Yy),s.setXYZ(c,yc.x,yc.y,yc.z),Yy.multiplyMatrices(S_,d.parent.matrixWorld),yc.setFromMatrixPosition(Yy),s.setXYZ(c+1,yc.x,yc.y,yc.z),c+=2)}i.getAttribute("position").needsUpdate=!0,fe.prototype.updateMatrixWorld.call(this,t)},Jh.prototype=ft(Zi.prototype),Jh.prototype.constructor=Jh,Jh.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},Jh.prototype.update=function(){this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)};var mE=new dt,u3=new Oe,l3=new Oe;No.prototype=ft(fe.prototype),No.prototype.constructor=No,No.prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},No.prototype.update=function(){var t=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{var r=t.geometry.getAttribute("color");u3.copy(this.light.color),l3.copy(this.light.groundColor);for(var i=0,s=r.count;i<s;i++){var f=i<s/2?u3:l3;r.setXYZ(i,f.r,f.g,f.b)}r.needsUpdate=!0}t.lookAt(mE.setFromMatrixPosition(this.light.matrixWorld).negate())},Ad.prototype=pt(ft(Fi.prototype),{constructor:Ad,copy:function(t){return Fi.prototype.copy.call(this,t),this.geometry.copy(t.geometry),this.material.copy(t.material),this},clone:function(){return new this.constructor().copy(this)}}),Jo.prototype=ft(Fi.prototype),Jo.prototype.constructor=Jo;var h3=new dt,Zy=new dt,c3=new dt;Rf.prototype=ft(fe.prototype),Rf.prototype.constructor=Rf,Rf.prototype.dispose=function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()},Rf.prototype.update=function(){h3.setFromMatrixPosition(this.light.matrixWorld),Zy.setFromMatrixPosition(this.light.target.matrixWorld),c3.subVectors(Zy,h3),this.lightPlane.lookAt(Zy),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(Zy),this.targetLine.scale.z=c3.length()};var qy=new dt,Fn=new Da;Qh.prototype=ft(Fi.prototype),Qh.prototype.constructor=Qh,Qh.prototype.update=function(){var t=this.geometry,r=this.pointMap;Fn.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),wn("c",r,t,Fn,0,0,-1),wn("t",r,t,Fn,0,0,1),wn("n1",r,t,Fn,-1,-1,-1),wn("n2",r,t,Fn,1,-1,-1),wn("n3",r,t,Fn,-1,1,-1),wn("n4",r,t,Fn,1,1,-1),wn("f1",r,t,Fn,-1,-1,1),wn("f2",r,t,Fn,1,-1,1),wn("f3",r,t,Fn,-1,1,1),wn("f4",r,t,Fn,1,1,1),wn("u1",r,t,Fn,.7,1.1,-1),wn("u2",r,t,Fn,-.7,1.1,-1),wn("u3",r,t,Fn,0,2,-1),wn("cf1",r,t,Fn,-1,0,1),wn("cf2",r,t,Fn,1,0,1),wn("cf3",r,t,Fn,0,-1,1),wn("cf4",r,t,Fn,0,1,1),wn("cn1",r,t,Fn,-1,0,-1),wn("cn2",r,t,Fn,1,0,-1),wn("cn3",r,t,Fn,0,-1,-1),wn("cn4",r,t,Fn,0,1,-1),t.getAttribute("position").needsUpdate=!0};var Jy=new ui;Hl.prototype=ft(Fi.prototype),Hl.prototype.constructor=Hl,Hl.prototype.update=function(t){if(t!==void 0&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),this.object!==void 0&&Jy.setFromObject(this.object),!Jy.isEmpty()){t=Jy.min;var r=Jy.max,i=this.geometry.attributes.position,s=i.array;s[0]=r.x,s[1]=r.y,s[2]=r.z,s[3]=t.x,s[4]=r.y,s[5]=r.z,s[6]=t.x,s[7]=t.y,s[8]=r.z,s[9]=r.x,s[10]=t.y,s[11]=r.z,s[12]=r.x,s[13]=r.y,s[14]=t.z,s[15]=t.x,s[16]=r.y,s[17]=t.z,s[18]=t.x,s[19]=t.y,s[20]=t.z,s[21]=r.x,s[22]=t.y,s[23]=t.z,i.needsUpdate=!0,this.geometry.computeBoundingSphere()}},Hl.prototype.setFromObject=function(t){return this.object=t,this.update(),this},Hl.prototype.copy=function(t){return Fi.prototype.copy.call(this,t),this.object=t.object,this},Hl.prototype.clone=function(){return new this.constructor().copy(this)},Gl.prototype=ft(Fi.prototype),Gl.prototype.constructor=Gl,Gl.prototype.updateMatrixWorld=function(t){var r=this.box;r.isEmpty()||(r.getCenter(this.position),r.getSize(this.scale),this.scale.multiplyScalar(.5),fe.prototype.updateMatrixWorld.call(this,t))},_d.prototype=ft(Po.prototype),_d.prototype.constructor=_d,_d.prototype.updateMatrixWorld=function(t){var r=-this.plane.constant;1e-8>Math.abs(r)&&(r=1e-8),this.scale.set(.5*this.size,.5*this.size,r),this.children[0].material.side=0>r?1:0,this.lookAt(this.plane.normal),fe.prototype.updateMatrixWorld.call(this,t)};var f3=new dt,Qy,I_;bu.prototype=ft(fe.prototype),bu.prototype.constructor=bu,bu.prototype.setDirection=function(t){.99999<t.y?this.quaternion.set(0,0,0,1):-.99999>t.y?this.quaternion.set(1,0,0,0):(f3.set(t.z,0,-t.x).normalize(),this.quaternion.setFromAxisAngle(f3,Math.acos(t.y)))},bu.prototype.setLength=function(t,r,i){r===void 0&&(r=.2*t),i===void 0&&(i=.2*r),this.line.scale.set(1,Math.max(1e-4,t-r),1),this.line.updateMatrix(),this.cone.scale.set(i,r,i),this.cone.position.y=t,this.cone.updateMatrix()},bu.prototype.setColor=function(t){this.line.material.color.set(t),this.cone.material.color.set(t)},bu.prototype.copy=function(t){return fe.prototype.copy.call(this,t,!1),this.line.copy(t.line),this.cone.copy(t.cone),this},bu.prototype.clone=function(){return new this.constructor().copy(this)},Pg.prototype=ft(Fi.prototype),Pg.prototype.constructor=Pg;var p3=[.125,.215,.35,.446,.526,.582],gE=5+p3.length,pp={};Si(pp,3e3,0),Si(pp,3001,1),Si(pp,3002,2),Si(pp,3004,3),Si(pp,3005,4),Si(pp,3006,5),Si(pp,3007,6),new ja,function(){for(var t=[],r=[],i=[],s=8,f=0;f<gE;f++){var c=Math.pow(2,s);r.push(c);var d=1/c;4<f?d=p3[f-8+4-1]:f==0&&(d=0),i.push(d),d=1/(c-1),c=-d/2,d=1+d/2;var p=[c,c,d,c,d,d,c,c,d,d,c,d];c=new Float32Array(108),d=new Float32Array(72);for(var A=new Float32Array(36),S=0;6>S;S++){var z=S%3*2/3-1,w=2<S?0:-1;c.set([z,w,0,z+2/3,w,0,z+2/3,w+1,0,z,w,0,z+2/3,w+1,0,z,w+1,0],18*S),d.set(p,12*S),A.set([S,S,S,S,S,S],6*S)}p=new ke,p.setAttribute("position",new wr(c,3)),p.setAttribute("uv",new wr(d,2)),p.setAttribute("faceIndex",new wr(A,1)),t.push(p),4<s&&s--}return{_lodPlanes:t,_sizeLods:r,_sigmas:i}}(),Ir.create=function(t,r){return t.prototype=ft(Ir.prototype),t.prototype.constructor=t,t.prototype.getPoint=r,t},pt(Rn.prototype,{createPointsGeometry:function(t){return console.warn("THREE.CurvePath: .createPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead."),t=this.getPoints(t),this.createGeometry(t)},createSpacedPointsGeometry:function(t){return console.warn("THREE.CurvePath: .createSpacedPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead."),t=this.getSpacedPoints(t),this.createGeometry(t)},createGeometry:function(t){console.warn("THREE.CurvePath: .createGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");for(var r=new Gr,i=0,s=t.length;i<s;i++){var f=t[i];r.vertices.push(new dt(f.x,f.y,f.z||0))}return r}}),pt(fs.prototype,{fromPoints:function(t){return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(t)}}),ft(ln.prototype),ft(ln.prototype),E1.prototype=ft(ln.prototype),pt(E1.prototype,{initFromArray:function(){console.error("THREE.Spline: .initFromArray() has been removed.")},getControlPointsArray:function(){console.error("THREE.Spline: .getControlPointsArray() has been removed.")},reparametrizeByArcLength:function(){console.error("THREE.Spline: .reparametrizeByArcLength() has been removed.")}}),Ad.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},qo.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},pt(ai.prototype,{extractUrlBase:function(t){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),vc.extractUrlBase(t)}}),ai.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}},pt(md.prototype,{setTexturePath:function(t){return console.warn("THREE.ObjectLoader: .setTexturePath() has been renamed to .setResourcePath()."),this.setResourcePath(t)}}),pt(br.prototype,{center:function(t){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(t)},empty:function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(t){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},size:function(t){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(t)}}),pt(ui.prototype,{center:function(t){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(t)},empty:function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(t){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},isIntersectionSphere:function(t){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(t)},size:function(t){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(t)}}),pt(fn.prototype,{empty:function(){return console.warn("THREE.Sphere: .empty() has been renamed to .isEmpty()."),this.isEmpty()}}),Su.prototype.setFromMatrix=function(t){return console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix()."),this.setFromProjectionMatrix(t)},Za.prototype.center=function(t){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(t)},pt(ti,{random16:function(){return console.warn("THREE.Math: .random16() has been deprecated. Use Math.random() instead."),Math.random()},nearestPowerOfTwo:function(t){return console.warn("THREE.Math: .nearestPowerOfTwo() has been renamed to .floorPowerOfTwo()."),ti.floorPowerOfTwo(t)},nextPowerOfTwo:function(t){return console.warn("THREE.Math: .nextPowerOfTwo() has been renamed to .ceilPowerOfTwo()."),ti.ceilPowerOfTwo(t)}}),pt(Jt.prototype,{flattenToArrayOffset:function(t,r){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(t,r)},multiplyVector3:function(t){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),t.applyMatrix3(this)},multiplyVector3Array:function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},applyToBufferAttribute:function(t){return console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead."),t.applyMatrix3(this)},applyToVector3Array:function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")}}),pt(Me.prototype,{extractPosition:function(t){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(t)},flattenToArrayOffset:function(t,r){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(t,r)},getPosition:function(){return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),new dt().setFromMatrixColumn(this,3)},setRotationFromQuaternion:function(t){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(t)},multiplyToArray:function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},multiplyVector3:function(t){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},multiplyVector4:function(t){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},multiplyVector3Array:function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},rotateAxis:function(t){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),t.transformDirection(this)},crossVector:function(t){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},translate:function(){console.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},applyToBufferAttribute:function(t){return console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},applyToVector3Array:function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},makeFrustum:function(t,r,i,s,f,c){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(t,r,s,i,f,c)}}),Li.prototype.isIntersectionLine=function(t){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(t)},ye.prototype.multiplyVector3=function(t){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),t.applyQuaternion(this)},pt(Ln.prototype,{isIntersectionBox:function(t){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},isIntersectionPlane:function(t){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(t)},isIntersectionSphere:function(t){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(t)}}),pt(li.prototype,{area:function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},barycoordFromPoint:function(t,r){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(t,r)},midpoint:function(t){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(t)},normal:function(t){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(t)},plane:function(t){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(t)}}),pt(li,{barycoordFromPoint:function(t,r,i,s,f){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),li.getBarycoord(t,r,i,s,f)},normal:function(t,r,i,s){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),li.getNormal(t,r,i,s)}}),pt(zu.prototype,{extractAllPoints:function(t){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(t)},extrude:function(t){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new Ou(this,t)},makeGeometry:function(t){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new zh(this,t)}}),pt(Ot.prototype,{fromAttribute:function(t,r,i){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,r,i)},distanceToManhattan:function(t){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(t)},lengthManhattan:function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),pt(dt.prototype,{setEulerFromRotationMatrix:function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(t){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(t)},getScaleFromMatrix:function(t){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(t)},getColumnFromMatrix:function(t,r){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(r,t)},applyProjection:function(t){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(t)},fromAttribute:function(t,r,i){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,r,i)},distanceToManhattan:function(t){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(t)},lengthManhattan:function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),pt(jt.prototype,{fromAttribute:function(t,r,i){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,r,i)},lengthManhattan:function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),pt(Gr.prototype,{computeTangents:function(){console.error("THREE.Geometry: .computeTangents() has been removed.")},computeLineDistances:function(){console.error("THREE.Geometry: .computeLineDistances() has been removed. Use THREE.Line.computeLineDistances() instead.")},applyMatrix:function(t){return console.warn("THREE.Geometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(t)}}),pt(fe.prototype,{getChildByName:function(t){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(t)},renderDepth:function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},translate:function(t,r){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(r,t)},getWorldRotation:function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")},applyMatrix:function(t){return console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(t)}}),Or(fe.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(t){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=t}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),pt(Zi.prototype,{setDrawMode:function(){console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}),Or(Zi.prototype,{drawMode:{get:function(){return console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode."),0},set:function(){console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}}),Or(id.prototype,{objects:{get:function(){return console.warn("THREE.LOD: .objects has been renamed to .levels."),this.levels}}}),Object.defineProperty(Tl.prototype,"useVertexTexture",{get:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")},set:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")}}),Eh.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")},Object.defineProperty(Ir.prototype,"__arcLengthDivisions",{get:function(){return console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions},set:function(t){console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions=t}}),en.prototype.setLens=function(t,r){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),r!==void 0&&(this.filmGauge=r),this.setFocalLength(t)},Or(ji.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(t){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=t}},shadowCameraLeft:{set:function(t){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=t}},shadowCameraRight:{set:function(t){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=t}},shadowCameraTop:{set:function(t){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=t}},shadowCameraBottom:{set:function(t){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=t}},shadowCameraNear:{set:function(t){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=t}},shadowCameraFar:{set:function(t){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=t}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(t){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=t}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(t){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=t}},shadowMapHeight:{set:function(t){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=t}}}),Or(wr.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},dynamic:{get:function(){return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.usage===35048},set:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.setUsage(35048)}}}),pt(wr.prototype,{setDynamic:function(t){return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(t===!0?35048:35044),this},copyIndicesArray:function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},setArray:function(){console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")}}),pt(ke.prototype,{addIndex:function(t){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(t)},addAttribute:function(t,r,i){return console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute()."),r&&r.isBufferAttribute||r&&r.isInterleavedBufferAttribute?t==="index"?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(r),this):this.setAttribute(t,r):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.setAttribute(t,new wr(r,i)))},addDrawCall:function(t,r,i){i!==void 0&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(t,r)},clearDrawCalls:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},computeTangents:function(){console.warn("THREE.BufferGeometry: .computeTangents() has been removed.")},computeOffsets:function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")},removeAttribute:function(t){return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."),this.deleteAttribute(t)},applyMatrix:function(t){return console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(t)}}),Or(ke.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),Or(Uu.prototype,{maxInstancedCount:{get:function(){return console.warn("THREE.InstancedBufferGeometry: .maxInstancedCount has been renamed to .instanceCount."),this.instanceCount},set:function(t){console.warn("THREE.InstancedBufferGeometry: .maxInstancedCount has been renamed to .instanceCount."),this.instanceCount=t}}}),Or(S1.prototype,{linePrecision:{get:function(){return console.warn("THREE.Raycaster: .linePrecision has been deprecated. Use .params.Line.threshold instead."),this.params.Line.threshold},set:function(t){console.warn("THREE.Raycaster: .linePrecision has been deprecated. Use .params.Line.threshold instead."),this.params.Line.threshold=t}}}),Or(Ue.prototype,{dynamic:{get:function(){return console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),this.usage===35048},set:function(t){console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),this.setUsage(t)}}}),pt(Ue.prototype,{setDynamic:function(t){return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(t===!0?35048:35044),this},setArray:function(){console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")}}),pt(hs.prototype,{getArrays:function(){console.error("THREE.ExtrudeBufferGeometry: .getArrays() has been removed.")},addShapeList:function(){console.error("THREE.ExtrudeBufferGeometry: .addShapeList() has been removed.")},addShape:function(){console.error("THREE.ExtrudeBufferGeometry: .addShape() has been removed.")}}),Or(xd.prototype,{dynamic:{set:function(){console.warn("THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.")}},onUpdate:{value:function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this}}}),Or(Rr.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new Oe}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(t){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=t===1}},stencilMask:{get:function(){return console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask},set:function(t){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask=t}}}),Or(Ha.prototype,{metal:{get:function(){return console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead."),!1},set:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}}),Or(Ki.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(t){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=t}}}),pt(ra.prototype,{clearTarget:function(t,r,i,s){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(t),this.clear(r,i,s)},animate:function(t){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(t)},getCurrentRenderTarget:function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},getMaxAnisotropy:function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},getPrecision:function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},resetGLState:function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},supportsFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},supportsHalfFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},supportsStandardDerivatives:function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},supportsCompressedTextureS3TC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},supportsCompressedTexturePVRTC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},supportsBlendMinMax:function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},supportsVertexTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},supportsInstancedArrays:function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},enableScissorTest:function(t){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(t)},initMaterial:function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},addPrePlugin:function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},addPostPlugin:function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},updateShadowMap:function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},setFaceCulling:function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},allocTextureUnit:function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")},setTexture:function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},setTexture2D:function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")},setTextureCube:function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")},getActiveMipMapLevel:function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()}}),Or(ra.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=t}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=t}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}},vr:{get:function(){return console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr"),this.xr}},gammaInput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead."),!1},set:function(){console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.")}},gammaOutput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),!1},set:function(t){console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),this.outputEncoding=t===!0?3001:3e3}}}),Or(Vr.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),Or(pe.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(t){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=t}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(t){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=t}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(t){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=t}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(t){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=t}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(t){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=t}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(t){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=t}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(t){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=t}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(t){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=t}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(t){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=t}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(t){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=t}}}),Or(Zh.prototype,{load:{value:function(t){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");var r=this;return new ps().load(t,function(i){r.setBuffer(i)}),this}},startTime:{set:function(){console.warn("THREE.Audio: .startTime is now .play( delay ).")}}}),Eg.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()},Vi.prototype.updateCubeMap=function(t,r){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(t,r)},h.crossOrigin=void 0,h.loadTexture=function(t,r,i,s){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");var f=new Wh;return f.setCrossOrigin(this.crossOrigin),t=f.load(t,i,void 0,s),r&&(t.mapping=r),t},h.loadTextureCube=function(t,r,i,s){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");var f=new _g;return f.setCrossOrigin(this.crossOrigin),t=f.load(t,i,void 0,s),r&&(t.mapping=r),t},h.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},h.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")},typeof __THREE_DEVTOOLS__!="undefined"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:"117"}}));var dp=function(t){ai.call(this,t)};dp.prototype=pt(ft(ai.prototype),{constructor:dp,load:function(t,r,i,s){var f=this,c=this.path===""?vc.extractUrlBase(t):this.path,d=new eo(this.manager);d.setPath(this.path),d.load(t,function(p){try{r(f.parse(p,c))}catch(A){s?s(A):console.error(A),f.manager.itemError(t)}},i,s)},setMaterialOptions:function(t){return this.materialOptions=t,this},parse:function(t,r){var i=t.split(`
`),s={},f=/\s+/;t={};for(var c=0;c<i.length;c++){var d=i[c];if(d=d.trim(),d.length!==0&&d.charAt(0)!=="#"){var p=d.indexOf(" "),A=0<=p?d.substring(0,p):d;A=A.toLowerCase(),d=0<=p?d.substring(p+1):"",d=d.trim(),A==="newmtl"?(s={name:d},t[d]=s):A==="ka"||A==="kd"||A==="ks"||A==="ke"?(d=d.split(f,3),s[A]=[parseFloat(d[0]),parseFloat(d[1]),parseFloat(d[2])]):s[A]=d}}return r=new dp.MaterialCreator(this.resourcePath||r,this.materialOptions),r.setCrossOrigin(this.crossOrigin),r.setManager(this.manager),r.setMaterials(t),r}}),dp.MaterialCreator=function(t,r){this.baseUrl=t||"",this.options=r,this.materialsInfo={},this.materials={},this.materialsArray=[],this.nameLookup={},this.side=this.options&&this.options.side?this.options.side:0,this.wrap=this.options&&this.options.wrap?this.options.wrap:1e3},dp.MaterialCreator.prototype={constructor:dp.MaterialCreator,crossOrigin:"anonymous",setCrossOrigin:function(t){return this.crossOrigin=t,this},setManager:function(t){this.manager=t},setMaterials:function(t){this.materialsInfo=this.convert(t),this.materials={},this.materialsArray=[],this.nameLookup={}},convert:function(t){if(!this.options)return t;var r={},i;for(i in t){var s=t[i],f={};r[i]=f;for(var c in s){var d=!0,p=s[c],A=c.toLowerCase();switch(A){case"kd":case"ka":case"ks":this.options&&this.options.normalizeRGB&&(p=[p[0]/255,p[1]/255,p[2]/255]),this.options&&this.options.ignoreZeroRGBs&&p[0]===0&&p[1]===0&&p[2]===0&&(d=!1)}d&&(f[A]=p)}}return r},preload:function(){for(var t in this.materialsInfo)this.create(t)},getIndex:function(t){return this.nameLookup[t]},getAsArray:function(){var t=0,r;for(r in this.materialsInfo)this.materialsArray[t]=this.create(r),this.nameLookup[r]=t,t++;return this.materialsArray},create:function(t){return this.materials[t]===void 0&&this.createMaterial_(t),this.materials[t]},createMaterial_:function(t){function r(A,S){return typeof S!="string"||S===""?"":/^https?:\/\//i.test(S)?S:A+S}function i(A,S){if(!c[A]){S=s.getTextureParams(S,c);var z=s.loadTexture(r(s.baseUrl,S.url));z.repeat.copy(S.scale),z.offset.copy(S.offset),z.wrapS=s.wrap,z.wrapT=s.wrap,c[A]=z}}var s=this,f=this.materialsInfo[t],c={name:t,side:this.side},d;for(d in f){var p=f[d];if(p!=="")switch(d.toLowerCase()){case"kd":c.color=new Oe().fromArray(p);break;case"ks":c.specular=new Oe().fromArray(p);break;case"ke":c.emissive=new Oe().fromArray(p);break;case"map_kd":i("map",p);break;case"map_ks":i("specularMap",p);break;case"map_ke":i("emissiveMap",p);break;case"norm":i("normalMap",p);break;case"map_bump":case"bump":i("bumpMap",p);break;case"map_d":i("alphaMap",p),c.transparent=!0;break;case"ns":c.shininess=parseFloat(p);break;case"d":p=parseFloat(p),1>p&&(c.opacity=p,c.transparent=!0);break;case"tr":p=parseFloat(p),this.options&&this.options.invertTrProperty&&(p=1-p),0<p&&(c.opacity=1-p,c.transparent=!0)}}return this.materials[t]=new Ha(c),this.materials[t]},getTextureParams:function(t,r){var i={scale:new Ot(1,1),offset:new Ot(0,0)};t=t.split(/\s+/);var s=t.indexOf("-bm");return 0<=s&&(r.bumpScale=parseFloat(t[s+1]),t.splice(s,2)),s=t.indexOf("-s"),0<=s&&(i.scale.set(parseFloat(t[s+1]),parseFloat(t[s+2])),t.splice(s,4)),s=t.indexOf("-o"),0<=s&&(i.offset.set(parseFloat(t[s+1]),parseFloat(t[s+2])),t.splice(s,4)),i.url=t.join(" ").trim(),i},loadTexture:function(t,r,i,s,f){var c=this.manager!==void 0?this.manager:QC,d=c.getHandler(t);return d===null&&(d=new Wh(c)),d.setCrossOrigin&&d.setCrossOrigin(this.crossOrigin),t=d.load(t,i,s,f),r!==void 0&&(t.mapping=r),t}};var vE=function(){function t(){var w={objects:[],object:{},vertices:[],normals:[],colors:[],uvs:[],materials:{},materialLibraries:[],startObject:function(I,E){if(this.object&&this.object.fromDeclaration===!1)this.object.name=I,this.object.fromDeclaration=E!==!1;else{var P=this.object&&typeof this.object.currentMaterial=="function"?this.object.currentMaterial():void 0;this.object&&typeof this.object._finalize=="function"&&this.object._finalize(!0),this.object={name:I||"",fromDeclaration:E!==!1,geometry:{vertices:[],normals:[],colors:[],uvs:[],hasNormalIndices:!1,hasUVIndices:!1},materials:[],smooth:!0,startMaterial:function(F,X){var q=this._finalize(!1);return q&&(q.inherited||0>=q.groupCount)&&this.materials.splice(q.index,1),F={index:this.materials.length,name:F||"",mtllib:Array.isArray(X)&&0<X.length?X[X.length-1]:"",smooth:q!==void 0?q.smooth:this.smooth,groupStart:q!==void 0?q.groupEnd:0,groupEnd:-1,groupCount:-1,inherited:!1,clone:function(J){return J={index:typeof J=="number"?J:this.index,name:this.name,mtllib:this.mtllib,smooth:this.smooth,groupStart:0,groupEnd:-1,groupCount:-1,inherited:!1},J.clone=this.clone.bind(J),J}},this.materials.push(F),F},currentMaterial:function(){if(0<this.materials.length)return this.materials[this.materials.length-1]},_finalize:function(F){var X=this.currentMaterial();if(X&&X.groupEnd===-1&&(X.groupEnd=this.geometry.vertices.length/3,X.groupCount=X.groupEnd-X.groupStart,X.inherited=!1),F&&1<this.materials.length)for(var q=this.materials.length-1;0<=q;q--)0>=this.materials[q].groupCount&&this.materials.splice(q,1);return F&&this.materials.length===0&&this.materials.push({name:"",smooth:this.smooth}),X}},P&&P.name&&typeof P.clone=="function"&&(I=P.clone(0),I.inherited=!0,this.object.materials.push(I)),this.objects.push(this.object)}},finalize:function(){this.object&&typeof this.object._finalize=="function"&&this.object._finalize(!0)},parseVertexIndex:function(I,E){return I=parseInt(I,10),3*(0<=I?I-1:I+E/3)},parseNormalIndex:function(I,E){return I=parseInt(I,10),3*(0<=I?I-1:I+E/3)},parseUVIndex:function(I,E){return I=parseInt(I,10),2*(0<=I?I-1:I+E/2)},addVertex:function(I,E,P){var F=this.vertices,X=this.object.geometry.vertices;X.push(F[I+0],F[I+1],F[I+2]),X.push(F[E+0],F[E+1],F[E+2]),X.push(F[P+0],F[P+1],F[P+2])},addVertexPoint:function(I){var E=this.vertices;this.object.geometry.vertices.push(E[I+0],E[I+1],E[I+2])},addVertexLine:function(I){var E=this.vertices;this.object.geometry.vertices.push(E[I+0],E[I+1],E[I+2])},addNormal:function(I,E,P){var F=this.normals,X=this.object.geometry.normals;X.push(F[I+0],F[I+1],F[I+2]),X.push(F[E+0],F[E+1],F[E+2]),X.push(F[P+0],F[P+1],F[P+2])},addFaceNormal:function(I,E,P){var F=this.vertices,X=this.object.geometry.normals;d.fromArray(F,I),p.fromArray(F,E),A.fromArray(F,P),z.subVectors(A,p),S.subVectors(d,p),z.cross(S),z.normalize(),X.push(z.x,z.y,z.z),X.push(z.x,z.y,z.z),X.push(z.x,z.y,z.z)},addColor:function(I,E,P){var F=this.colors,X=this.object.geometry.colors;F[I]!==void 0&&X.push(F[I+0],F[I+1],F[I+2]),F[E]!==void 0&&X.push(F[E+0],F[E+1],F[E+2]),F[P]!==void 0&&X.push(F[P+0],F[P+1],F[P+2])},addUV:function(I,E,P){var F=this.uvs,X=this.object.geometry.uvs;X.push(F[I+0],F[I+1]),X.push(F[E+0],F[E+1]),X.push(F[P+0],F[P+1])},addDefaultUV:function(){var I=this.object.geometry.uvs;I.push(0,0),I.push(0,0),I.push(0,0)},addUVLine:function(I){var E=this.uvs;this.object.geometry.uvs.push(E[I+0],E[I+1])},addFace:function(I,E,P,F,X,q,J,it,lt){var Mt=this.vertices.length;I=this.parseVertexIndex(I,Mt),E=this.parseVertexIndex(E,Mt),P=this.parseVertexIndex(P,Mt),this.addVertex(I,E,P),this.addColor(I,E,P),J!==void 0&&J!==""?(P=this.normals.length,I=this.parseNormalIndex(J,P),E=this.parseNormalIndex(it,P),P=this.parseNormalIndex(lt,P),this.addNormal(I,E,P),this.object.geometry.hasNormalIndices=!0):this.addFaceNormal(I,E,P),F!==void 0&&F!==""?(J=this.uvs.length,I=this.parseUVIndex(F,J),E=this.parseUVIndex(X,J),P=this.parseUVIndex(q,J),this.addUV(I,E,P),this.object.geometry.hasUVIndices=!0):this.addDefaultUV()},addPointGeometry:function(I){this.object.geometry.type="Points";for(var E=this.vertices.length,P=0,F=I.length;P<F;P++)this.addVertexPoint(this.parseVertexIndex(I[P],E))},addLineGeometry:function(I,E){this.object.geometry.type="Line";for(var P=this.vertices.length,F=this.uvs.length,X=0,q=I.length;X<q;X++)this.addVertexLine(this.parseVertexIndex(I[X],P));for(I=0,q=E.length;I<q;I++)this.addUVLine(this.parseUVIndex(E[I],F))}};return w.startObject("",!1),w}function r(w){ai.call(this,w),this.materials=null}var i=/^[og]\s*(.+)?/,s=/^mtllib /,f=/^usemtl /,c=/^usemap /,d=new dt,p=new dt,A=new dt,S=new dt,z=new dt;return r.prototype=pt(ft(ai.prototype),{constructor:r,load:function(w,I,E,P){var F=this,X=new eo(F.manager);X.setPath(this.path),X.load(w,function(q){try{I(F.parse(q))}catch(J){P?P(J):console.error(J),F.manager.itemError(w)}},E,P)},setMaterials:function(w){return this.materials=w,this},parse:function(w){var I=new t;w.indexOf(`\r
`)!==-1&&(w=w.replace(/\r\n/g,`
`)),w.indexOf(`\\
`)!==-1&&(w=w.replace(/\\\n/g,""));var E=w.split(`
`),P,F=typeof"".trimLeft=="function";w=0;for(var X=E.length;w<X;w++){var q=E[w];q=F?q.trimLeft():q.trim();var J=q.length;if(J!==0&&(J=q.charAt(0),J!=="#"))if(J==="v")switch(q=q.split(/\s+/),q[0]){case"v":I.vertices.push(parseFloat(q[1]),parseFloat(q[2]),parseFloat(q[3])),7<=q.length?I.colors.push(parseFloat(q[4]),parseFloat(q[5]),parseFloat(q[6])):I.colors.push(void 0,void 0,void 0);break;case"vn":I.normals.push(parseFloat(q[1]),parseFloat(q[2]),parseFloat(q[3]));break;case"vt":I.uvs.push(parseFloat(q[1]),parseFloat(q[2]))}else if(J==="f"){q=q.substr(1).trim();var it=q.split(/\s+/);for(q=[],J=0,P=it.length;J<P;J++){var lt=it[J];0<lt.length&&(lt=lt.split("/"),q.push(lt))}for(it=q[0],J=1,P=q.length-1;J<P;J++){lt=q[J];var Mt=q[J+1];I.addFace(it[0],lt[0],Mt[0],it[1],lt[1],Mt[1],it[2],lt[2],Mt[2])}}else if(J==="l"){if(J=q.substring(1).trim().split(" "),P=[],it=[],q.indexOf("/")===-1)P=J;else for(q=0,lt=J.length;q<lt;q++)Mt=J[q].split("/"),Mt[0]!==""&&P.push(Mt[0]),Mt[1]!==""&&it.push(Mt[1]);I.addLineGeometry(P,it)}else J==="p"?(q=q.substr(1).trim(),q=q.split(" "),I.addPointGeometry(q)):(P=i.exec(q))!==null?(q=(" "+P[0].substr(1).trim()).substr(1),I.startObject(q)):f.test(q)?I.object.startMaterial(q.substring(7).trim(),I.materialLibraries):s.test(q)?I.materialLibraries.push(q.substring(7).trim()):c.test(q)?console.warn('THREE.OBJLoader: Rendering identifier "usemap" not supported. Textures must be defined in MTL files.'):J==="s"?(P=q.split(" "),1<P.length?(q=P[1].trim().toLowerCase(),I.object.smooth=q!=="0"&&q!=="off"):I.object.smooth=!0,(q=I.object.currentMaterial())&&(q.smooth=I.object.smooth)):q!=="\0"&&console.warn('THREE.OBJLoader: Unexpected line: "'+q+'"')}for(I.finalize(),E=new Zo,E.materialLibraries=[].concat(I.materialLibraries),w=0,X=I.objects.length;w<X;w++)if(F=I.objects[w],q=F.geometry,J=F.materials,P=q.type==="Line",it=q.type==="Points",lt=!1,q.vertices.length!==0){Mt=new ke,Mt.setAttribute("position",new Ge(q.vertices,3)),q.hasNormalIndices===!0&&Mt.setAttribute("normal",new Ge(q.normals,3)),0<q.colors.length&&(lt=!0,Mt.setAttribute("color",new Ge(q.colors,3))),q.hasUVIndices===!0&&Mt.setAttribute("uv",new Ge(q.uvs,2));for(var Ct=[],wt=0,zt=J.length;wt<zt;wt++){var Ut=J[wt],Kt=Ut.name+"_"+Ut.smooth+"_"+lt;if(q=I.materials[Kt],this.materials!==null)if(q=this.materials.create(Ut.name),!P||!q||q instanceof $i)!it||!q||q instanceof Ps||(Gt=new Ps({size:10,sizeAttenuation:!1}),Rr.prototype.copy.call(Gt,q),Gt.color.copy(q.color),Gt.map=q.map,q=Gt);else{var Gt=new $i;Rr.prototype.copy.call(Gt,q),Gt.color.copy(q.color),q=Gt}q===void 0&&(q=P?new $i:it?new Ps({size:1,sizeAttenuation:!1}):new Ha,q.name=Ut.name,q.flatShading=!Ut.smooth,q.vertexColors=lt,I.materials[Kt]=q),Ct.push(q)}if(1<Ct.length){for(wt=0,zt=J.length;wt<zt;wt++)Ut=J[wt],Mt.addGroup(Ut.groupStart,Ut.groupCount,wt);q=P?new Fi(Mt,Ct):it?new Ru(Mt,Ct):new Zi(Mt,Ct)}else q=P?new Fi(Mt,Ct[0]):it?new Ru(Mt,Ct[0]):new Zi(Mt,Ct[0]);q.name=F.name,E.add(q)}return E}}),r}(),yE=function(){function t(xt){ai.call(this,xt),this.ddsLoader=this.dracoLoader=null}function r(){var xt={};return{get:function(At){return xt[At]},add:function(At,_t){xt[At]=_t},remove:function(At){delete xt[At]},removeAll:function(){xt={}}}}function i(xt){if(!xt)throw Error("THREE.GLTFLoader: Attempting to load .dds texture without importing DDSLoader");this.name=zt.MSFT_TEXTURE_DDS,this.ddsLoader=xt}function s(xt){this.name=zt.KHR_LIGHTS_PUNCTUAL,this.lightDefs=(xt.extensions&&xt.extensions[zt.KHR_LIGHTS_PUNCTUAL]||{}).lights||[]}function f(){this.name=zt.KHR_MATERIALS_UNLIT}function c(){this.name=zt.KHR_MATERIALS_CLEARCOAT}function d(xt){this.name=zt.KHR_BINARY_GLTF,this.body=this.content=null;var At=new DataView(xt,0,Kt);if(this.header={magic:vc.decodeText(new Uint8Array(xt.slice(0,4))),version:At.getUint32(4,!0),length:At.getUint32(8,!0)},this.header.magic!==Ut)throw Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(2>this.header.version)throw Error("THREE.GLTFLoader: Legacy binary file detected.");At=new DataView(xt,Kt);for(var _t=0;_t<At.byteLength;){var Rt=At.getUint32(_t,!0);_t+=4;var st=At.getUint32(_t,!0);_t+=4,st===Gt.JSON?(st=new Uint8Array(xt,Kt+_t,Rt),this.content=vc.decodeText(st)):st===Gt.BIN&&(st=Kt+_t,this.body=xt.slice(st,st+Rt)),_t+=Rt}if(this.content===null)throw Error("THREE.GLTFLoader: JSON content not found.")}function p(xt,At){if(!At)throw Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=zt.KHR_DRACO_MESH_COMPRESSION,this.json=xt,this.dracoLoader=At,this.dracoLoader.preload()}function A(){this.name=zt.KHR_TEXTURE_TRANSFORM}function S(xt){yo.call(this),this.isGLTFSpecularGlossinessMaterial=!0;var At={specular:{value:new Oe().setHex(16777215)},glossiness:{value:1},specularMap:{value:null},glossinessMap:{value:null}};this._extraUniforms=At,this.onBeforeCompile=function(_t){for(var Rt in At)_t.uniforms[Rt]=At[Rt];_t.fragmentShader=_t.fragmentShader.replace("uniform float roughness;","uniform vec3 specular;"),_t.fragmentShader=_t.fragmentShader.replace("uniform float metalness;","uniform float glossiness;"),_t.fragmentShader=_t.fragmentShader.replace("#include <roughnessmap_pars_fragment>",`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`),_t.fragmentShader=_t.fragmentShader.replace("#include <metalnessmap_pars_fragment>",`#ifdef USE_GLOSSINESSMAP
	uniform sampler2D glossinessMap;
#endif`),_t.fragmentShader=_t.fragmentShader.replace("#include <roughnessmap_fragment>",`vec3 specularFactor = specular;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vUv );
	texelSpecular = sRGBToLinear( texelSpecular );
	// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture
	specularFactor *= texelSpecular.rgb;
#endif`),_t.fragmentShader=_t.fragmentShader.replace("#include <metalnessmap_fragment>",`float glossinessFactor = glossiness;
#ifdef USE_GLOSSINESSMAP
	vec4 texelGlossiness = texture2D( glossinessMap, vUv );
	// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture
	glossinessFactor *= texelGlossiness.a;
#endif`),_t.fragmentShader=_t.fragmentShader.replace("#include <lights_physical_fragment>",`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb;
vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.specularRoughness = max( 1.0 - glossinessFactor, 0.0525 );// 0.0525 corresponds to the base mip of a 256 cubemap.
material.specularRoughness += geometryRoughness;
material.specularRoughness = min( material.specularRoughness, 1.0 );
material.specularColor = specularFactor.rgb;`)},Or(this,{specular:{get:function(){return At.specular.value},set:function(_t){At.specular.value=_t}},specularMap:{get:function(){return At.specularMap.value},set:function(_t){At.specularMap.value=_t}},glossiness:{get:function(){return At.glossiness.value},set:function(_t){At.glossiness.value=_t}},glossinessMap:{get:function(){return At.glossinessMap.value},set:function(_t){(At.glossinessMap.value=_t)?(this.defines.USE_GLOSSINESSMAP="",this.defines.USE_ROUGHNESSMAP=""):(delete this.defines.USE_ROUGHNESSMAP,delete this.defines.USE_GLOSSINESSMAP)}}}),delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this.setValues(xt)}function z(){return{name:zt.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,specularGlossinessParams:"color map lightMap lightMapIntensity aoMap aoMapIntensity emissive emissiveIntensity emissiveMap bumpMap bumpScale normalMap normalMapType displacementMap displacementScale displacementBias specularMap specular glossinessMap glossiness alphaMap envMap envMapIntensity refractionRatio".split(" "),getMaterialType:function(){return S},extendParams:function(xt,At,_t){var Rt=At.extensions[this.name];if(xt.color=new Oe(1,1,1),xt.opacity=1,At=[],Array.isArray(Rt.diffuseFactor)){var st=Rt.diffuseFactor;xt.color.fromArray(st),xt.opacity=st[3]}return Rt.diffuseTexture!==void 0&&At.push(_t.assignTexture(xt,"map",Rt.diffuseTexture)),xt.emissive=new Oe(0,0,0),xt.glossiness=Rt.glossinessFactor!==void 0?Rt.glossinessFactor:1,xt.specular=new Oe(1,1,1),Array.isArray(Rt.specularFactor)&&xt.specular.fromArray(Rt.specularFactor),Rt.specularGlossinessTexture!==void 0&&(Rt=Rt.specularGlossinessTexture,At.push(_t.assignTexture(xt,"glossinessMap",Rt)),At.push(_t.assignTexture(xt,"specularMap",Rt))),di.all(At)},createMaterial:function(xt){var At=new S(xt);return At.fog=!0,At.color=xt.color,At.map=xt.map===void 0?null:xt.map,At.lightMap=null,At.lightMapIntensity=1,At.aoMap=xt.aoMap===void 0?null:xt.aoMap,At.aoMapIntensity=1,At.emissive=xt.emissive,At.emissiveIntensity=1,At.emissiveMap=xt.emissiveMap===void 0?null:xt.emissiveMap,At.bumpMap=xt.bumpMap===void 0?null:xt.bumpMap,At.bumpScale=1,At.normalMap=xt.normalMap===void 0?null:xt.normalMap,At.normalMapType=0,xt.normalScale&&(At.normalScale=xt.normalScale),At.displacementMap=null,At.displacementScale=1,At.displacementBias=0,At.specularMap=xt.specularMap===void 0?null:xt.specularMap,At.specular=xt.specular,At.glossinessMap=xt.glossinessMap===void 0?null:xt.glossinessMap,At.glossiness=xt.glossiness,At.alphaMap=null,At.envMap=xt.envMap===void 0?null:xt.envMap,At.envMapIntensity=1,At.refractionRatio=.98,At}}}function w(){this.name=zt.KHR_MESH_QUANTIZATION}function I(xt,At,_t,Rt){Oo.call(this,xt,At,_t,Rt)}function E(xt,At){return typeof xt!="string"||xt===""?"":(/^https?:\/\//i.test(At)&&/^\//.test(xt)&&(At=At.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(xt)||/^data:.*,.*$/i.test(xt)||/^blob:.*$/i.test(xt)?xt:At+xt)}function P(xt){return xt.DefaultMaterial===void 0&&(xt.DefaultMaterial=new yo({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:0})),xt.DefaultMaterial}function F(xt,At,_t){for(var Rt in _t.extensions)xt[Rt]===void 0&&(At.userData.gltfExtensions=At.userData.gltfExtensions||{},At.userData.gltfExtensions[Rt]=_t.extensions[Rt])}function X(xt,At){At.extras!==void 0&&(ts(At.extras)==="object"?pt(xt.userData,At.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+At.extras))}function q(xt,At,_t){for(var Rt=!1,st=!1,gt=0,vt=At.length;gt<vt;gt++){var Pt=At[gt];if(Pt.POSITION!==void 0&&(Rt=!0),Pt.NORMAL!==void 0&&(st=!0),Rt&&st)break}if(!Rt&&!st)return di.resolve(xt);var kt=[],Zt=[];for(gt=0,vt=At.length;gt<vt;gt++){if(Pt=At[gt],Rt){var yt=Pt.POSITION!==void 0?_t.getDependency("accessor",Pt.POSITION):xt.attributes.position;kt.push(yt)}st&&(yt=Pt.NORMAL!==void 0?_t.getDependency("accessor",Pt.NORMAL):xt.attributes.normal,Zt.push(yt))}return di.all([di.all(kt),di.all(Zt)]).then(function(he){var de=he[0];return he=he[1],Rt&&(xt.morphAttributes.position=de),st&&(xt.morphAttributes.normal=he),xt.morphTargetsRelative=!0,xt})}function J(xt){var At=xt.extensions&&xt.extensions[zt.KHR_DRACO_MESH_COMPRESSION];return At?"draco:"+At.bufferView+":"+At.indices+":"+it(At.attributes):xt.indices+":"+it(xt.attributes)+":"+xt.mode}function it(xt){for(var At="",_t=Ti(xt).sort(),Rt=0,st=_t.length;Rt<st;Rt++)At+=_t[Rt]+":"+xt[_t[Rt]]+";";return At}function lt(xt,At,_t){this.json=xt||{},this.extensions=At||{},this.options=_t||{},this.cache=new r,this.associations=new vv,this.primitiveCache={},this.textureLoader=new Wh(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.fileLoader=new eo(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}function Mt(xt,At,_t){var Rt=At.attributes,st=new ui;if(Rt.POSITION!==void 0){var gt=_t.json.accessors[Rt.POSITION];if(Rt=gt.min,gt=gt.max,Rt!==void 0&&gt!==void 0){if(st.set(new dt(Rt[0],Rt[1],Rt[2]),new dt(gt[0],gt[1],gt[2])),At=At.targets,At!==void 0){for(var vt=new dt,Pt=new dt,kt=0,Zt=At.length;kt<Zt;kt++)Rt=At[kt],Rt.POSITION!==void 0&&(gt=_t.json.accessors[Rt.POSITION],Rt=gt.min,gt=gt.max,Rt!==void 0&&gt!==void 0?(Pt.setX(Math.max(Math.abs(Rt[0]),Math.abs(gt[0]))),Pt.setY(Math.max(Math.abs(Rt[1]),Math.abs(gt[1]))),Pt.setZ(Math.max(Math.abs(Rt[2]),Math.abs(gt[2]))),vt.max(Pt)):console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION."));st.expandByVector(vt)}xt.boundingBox=st,_t=new fn,st.getCenter(_t.center),_t.radius=st.min.distanceTo(st.max)/2,xt.boundingSphere=_t}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}function Ct(xt,At,_t){function Rt(kt,Zt){return _t.getDependency("accessor",kt).then(function(yt){xt.setAttribute(Zt,yt)})}var st=At.attributes,gt=[],vt;for(vt in st){var Pt=hr[vt]||vt.toLowerCase();Pt in xt.attributes||gt.push(Rt(st[vt],Pt))}return At.indices===void 0||xt.index||(st=_t.getDependency("accessor",At.indices).then(function(kt){xt.setIndex(kt)}),gt.push(st)),X(xt,At),Mt(xt,At,_t),di.all(gt).then(function(){return At.targets!==void 0?q(xt,At.targets,_t):xt})}function wt(xt,At){var _t=xt.getIndex();if(_t===null){var Rt=[];if(_t=xt.getAttribute("position"),_t!==void 0){for(var st=0;st<_t.count;st++)Rt.push(st);xt.setIndex(Rt),_t=xt.getIndex()}else return console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),xt}var gt=_t.count-2;if(Rt=[],At===2)for(st=1;st<=gt;st++)Rt.push(_t.getX(0)),Rt.push(_t.getX(st)),Rt.push(_t.getX(st+1));else for(st=0;st<gt;st++)st%2===0?(Rt.push(_t.getX(st)),Rt.push(_t.getX(st+1)),Rt.push(_t.getX(st+2))):(Rt.push(_t.getX(st+2)),Rt.push(_t.getX(st+1)),Rt.push(_t.getX(st)));return Rt.length/3!==gt&&console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Unable to generate correct amount of triangles."),xt=xt.clone(),xt.setIndex(Rt),xt}t.prototype=pt(ft(ai.prototype),{constructor:t,load:function(xt,At,_t,Rt){var st=this,gt=this.resourcePath!==""?this.resourcePath:this.path!==""?this.path:vc.extractUrlBase(xt);st.manager.itemStart(xt);var vt=function(kt){Rt?Rt(kt):console.error(kt),st.manager.itemError(xt),st.manager.itemEnd(xt)},Pt=new eo(st.manager);Pt.setPath(this.path),Pt.setResponseType("arraybuffer"),Pt.setRequestHeader(this.requestHeader),st.crossOrigin==="use-credentials"&&Pt.setWithCredentials(!0),Pt.load(xt,function(kt){try{st.parse(kt,gt,function(Zt){At(Zt),st.manager.itemEnd(xt)},vt)}catch(Zt){vt(Zt)}},_t,vt)},setDRACOLoader:function(xt){return this.dracoLoader=xt,this},setDDSLoader:function(xt){return this.ddsLoader=xt,this},parse:function(xt,At,_t,Rt){var st={};if(typeof xt!="string")if(vc.decodeText(new Uint8Array(xt,0,4))===Ut){try{st[zt.KHR_BINARY_GLTF]=new d(xt)}catch(kt){Rt&&Rt(kt);return}xt=st[zt.KHR_BINARY_GLTF].content}else xt=vc.decodeText(new Uint8Array(xt));if(xt=JSON.parse(xt),xt.asset===void 0||2>xt.asset.version[0])Rt&&Rt(Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));else{if(xt.extensionsUsed)for(var gt=0;gt<xt.extensionsUsed.length;++gt){var vt=xt.extensionsUsed[gt],Pt=xt.extensionsRequired||[];switch(vt){case zt.KHR_LIGHTS_PUNCTUAL:st[vt]=new s(xt);break;case zt.KHR_MATERIALS_CLEARCOAT:st[vt]=new c;break;case zt.KHR_MATERIALS_UNLIT:st[vt]=new f;break;case zt.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:st[vt]=new z;break;case zt.KHR_DRACO_MESH_COMPRESSION:st[vt]=new p(xt,this.dracoLoader);break;case zt.MSFT_TEXTURE_DDS:st[vt]=new i(this.ddsLoader);break;case zt.KHR_TEXTURE_TRANSFORM:st[vt]=new A;break;case zt.KHR_MESH_QUANTIZATION:st[vt]=new w;break;default:0<=Pt.indexOf(vt)&&console.warn('THREE.GLTFLoader: Unknown extension "'+vt+'".')}}At=new lt(xt,st,{path:At||this.resourcePath||"",crossOrigin:this.crossOrigin,manager:this.manager}),At.fileLoader.setRequestHeader(this.requestHeader),At.parse(_t,Rt)}}});var zt={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:"KHR_materials_pbrSpecularGlossiness",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",MSFT_TEXTURE_DDS:"MSFT_texture_dds"};s.prototype.loadLight=function(xt){var At=this.lightDefs[xt],_t=new Oe(16777215);At.color!==void 0&&_t.fromArray(At.color);var Rt=At.range!==void 0?At.range:0;switch(At.type){case"directional":_t=new kl(_t),_t.target.position.set(0,0,-1),_t.add(_t.target);break;case"point":_t=new Nu(_t),_t.distance=Rt;break;case"spot":_t=new sa(_t),_t.distance=Rt,At.spot=At.spot||{},At.spot.innerConeAngle=At.spot.innerConeAngle!==void 0?At.spot.innerConeAngle:0,At.spot.outerConeAngle=At.spot.outerConeAngle!==void 0?At.spot.outerConeAngle:Math.PI/4,_t.angle=At.spot.outerConeAngle,_t.penumbra=1-At.spot.innerConeAngle/At.spot.outerConeAngle,_t.target.position.set(0,0,-1),_t.add(_t.target);break;default:throw Error('THREE.GLTFLoader: Unexpected light type, "'+At.type+'".')}return _t.position.set(0,0,0),_t.decay=2,At.intensity!==void 0&&(_t.intensity=At.intensity),_t.name=At.name||"light_"+xt,di.resolve(_t)},f.prototype.getMaterialType=function(){return Nn},f.prototype.extendParams=function(xt,At,_t){var Rt=[];if(xt.color=new Oe(1,1,1),xt.opacity=1,At=At.pbrMetallicRoughness){if(Array.isArray(At.baseColorFactor)){var st=At.baseColorFactor;xt.color.fromArray(st),xt.opacity=st[3]}At.baseColorTexture!==void 0&&Rt.push(_t.assignTexture(xt,"map",At.baseColorTexture))}return di.all(Rt)},c.prototype.getMaterialType=function(){return Bl},c.prototype.extendParams=function(xt,At,_t){var Rt=[];return At=At.extensions[this.name],At.clearcoatFactor!==void 0&&(xt.clearcoat=At.clearcoatFactor),At.clearcoatTexture!==void 0&&Rt.push(_t.assignTexture(xt,"clearcoatMap",At.clearcoatTexture)),At.clearcoatRoughnessFactor!==void 0&&(xt.clearcoatRoughness=At.clearcoatRoughnessFactor),At.clearcoatRoughnessTexture!==void 0&&Rt.push(_t.assignTexture(xt,"clearcoatRoughnessMap",At.clearcoatRoughnessTexture)),At.clearcoatNormalTexture!==void 0&&(Rt.push(_t.assignTexture(xt,"clearcoatNormalMap",At.clearcoatNormalTexture)),At.clearcoatNormalTexture.scale!==void 0&&(_t=At.clearcoatNormalTexture.scale,xt.clearcoatNormalScale=new Ot(_t,_t))),di.all(Rt)};var Ut="glTF",Kt=12,Gt={JSON:1313821514,BIN:5130562};p.prototype.decodePrimitive=function(xt,At){var _t=this.json,Rt=this.dracoLoader,st=xt.extensions[this.name].bufferView,gt=xt.extensions[this.name].attributes,vt={},Pt={},kt={},Zt;for(Zt in gt){var yt=hr[Zt]||Zt.toLowerCase();vt[yt]=gt[Zt]}for(Zt in xt.attributes)if(yt=hr[Zt]||Zt.toLowerCase(),gt[Zt]!==void 0){var he=_t.accessors[xt.attributes[Zt]];kt[yt]=Qt[he.componentType],Pt[yt]=he.normalized===!0}return At.getDependency("bufferView",st).then(function(de){return new di(function(ue){Rt.decodeDracoFile(de,function(te){for(var Ae in te.attributes){var cr=te.attributes[Ae],Cr=Pt[Ae];Cr!==void 0&&(cr.normalized=Cr)}ue(te)},vt,kt)})})},A.prototype.extendTexture=function(xt,At){return xt=xt.clone(),At.offset!==void 0&&xt.offset.fromArray(At.offset),At.rotation!==void 0&&(xt.rotation=At.rotation),At.scale!==void 0&&xt.repeat.fromArray(At.scale),At.texCoord!==void 0&&console.warn('THREE.GLTFLoader: Custom UV sets in "'+this.name+'" extension not yet supported.'),xt.needsUpdate=!0,xt},S.prototype=ft(yo.prototype),S.prototype.constructor=S,S.prototype.copy=function(xt){return yo.prototype.copy.call(this,xt),this.specularMap=xt.specularMap,this.specular.copy(xt.specular),this.glossinessMap=xt.glossinessMap,this.glossiness=xt.glossiness,delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this},I.prototype=ft(Oo.prototype),I.prototype.constructor=I,I.prototype.copySampleValue_=function(xt){var At=this.resultBuffer,_t=this.sampleValues,Rt=this.valueSize;xt=xt*Rt*3+Rt;for(var st=0;st!==Rt;st++)At[st]=_t[xt+st];return At},I.prototype.beforeStart_=I.prototype.copySampleValue_,I.prototype.afterEnd_=I.prototype.copySampleValue_,I.prototype.interpolate_=function(xt,At,_t,Rt){var st=this.resultBuffer,gt=this.sampleValues,vt=this.valueSize,Pt=2*vt,kt=3*vt;Rt-=At,At=(_t-At)/Rt,_t=At*At;var Zt=_t*At;xt*=kt,kt=xt-kt;var yt=-2*Zt+3*_t;Zt-=_t;var he=1-yt;for(At=Zt-_t+At,_t=0;_t!==vt;_t++)st[_t]=he*gt[kt+_t+vt]+At*gt[kt+_t+Pt]*Rt+yt*gt[xt+_t+vt]+Zt*gt[xt+_t]*Rt;return st};var Qt={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},De={9728:1003,9729:1006,9984:1004,9985:1007,9986:1005,9987:1008},re={33071:1001,33648:1002,10497:1e3},We={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},hr={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},Je={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},qr={CUBICSPLINE:void 0,LINEAR:2301,STEP:2300},nr={"image/png":1023,"image/jpeg":1022};return lt.prototype.parse=function(xt,At){var _t=this,Rt=this.json,st=this.extensions;this.cache.removeAll(),this.markDefs(),di.all([this.getDependencies("scene"),this.getDependencies("animation"),this.getDependencies("camera")]).then(function(gt){gt={scene:gt[0][Rt.scene||0],scenes:gt[0],animations:gt[1],cameras:gt[2],asset:Rt.asset,parser:_t,userData:{}},F(st,gt,Rt),X(gt,Rt),xt(gt)}).catch(At)},lt.prototype.markDefs=function(){for(var xt=this.json.nodes||[],At=this.json.skins||[],_t=this.json.meshes||[],Rt={},st={},gt=0,vt=At.length;gt<vt;gt++)for(var Pt=At[gt].joints,kt=0,Zt=Pt.length;kt<Zt;kt++)xt[Pt[kt]].isBone=!0;for(At=0,gt=xt.length;At<gt;At++)vt=xt[At],vt.mesh!==void 0&&(Rt[vt.mesh]===void 0&&(Rt[vt.mesh]=st[vt.mesh]=0),Rt[vt.mesh]++,vt.skin!==void 0&&(_t[vt.mesh].isSkinnedMesh=!0));this.json.meshReferences=Rt,this.json.meshUses=st},lt.prototype.getDependency=function(xt,At){var _t=xt+":"+At,Rt=this.cache.get(_t);if(!Rt){switch(xt){case"scene":Rt=this.loadScene(At);break;case"node":Rt=this.loadNode(At);break;case"mesh":Rt=this.loadMesh(At);break;case"accessor":Rt=this.loadAccessor(At);break;case"bufferView":Rt=this.loadBufferView(At);break;case"buffer":Rt=this.loadBuffer(At);break;case"material":Rt=this.loadMaterial(At);break;case"texture":Rt=this.loadTexture(At);break;case"skin":Rt=this.loadSkin(At);break;case"animation":Rt=this.loadAnimation(At);break;case"camera":Rt=this.loadCamera(At);break;case"light":Rt=this.extensions[zt.KHR_LIGHTS_PUNCTUAL].loadLight(At);break;default:throw Error("Unknown type: "+xt)}this.cache.add(_t,Rt)}return Rt},lt.prototype.getDependencies=function(xt){var At=this.cache.get(xt);if(!At){var _t=this;At=di.all((this.json[xt+(xt==="mesh"?"es":"s")]||[]).map(function(Rt,st){return _t.getDependency(xt,st)})),this.cache.add(xt,At)}return At},lt.prototype.loadBuffer=function(xt){var At=this.json.buffers[xt],_t=this.fileLoader;if(At.type&&At.type!=="arraybuffer")throw Error("THREE.GLTFLoader: "+At.type+" buffer type is not supported.");if(At.uri===void 0&&xt===0)return di.resolve(this.extensions[zt.KHR_BINARY_GLTF].body);var Rt=this.options;return new di(function(st,gt){_t.load(E(At.uri,Rt.path),st,void 0,function(){gt(Error('THREE.GLTFLoader: Failed to load buffer "'+At.uri+'".'))})})},lt.prototype.loadBufferView=function(xt){var At=this.json.bufferViews[xt];return this.getDependency("buffer",At.buffer).then(function(_t){var Rt=At.byteOffset||0;return _t.slice(Rt,Rt+(At.byteLength||0))})},lt.prototype.loadAccessor=function(xt){var At=this,_t=this.json,Rt=this.json.accessors[xt];return Rt.bufferView===void 0&&Rt.sparse===void 0?di.resolve(null):(xt=[],Rt.bufferView!==void 0?xt.push(this.getDependency("bufferView",Rt.bufferView)):xt.push(null),Rt.sparse!==void 0&&(xt.push(this.getDependency("bufferView",Rt.sparse.indices.bufferView)),xt.push(this.getDependency("bufferView",Rt.sparse.values.bufferView))),di.all(xt).then(function(st){var gt=st[0],vt=We[Rt.type],Pt=Qt[Rt.componentType],kt=Pt.BYTES_PER_ELEMENT,Zt=Rt.byteOffset||0,yt=Rt.bufferView!==void 0?_t.bufferViews[Rt.bufferView].byteStride:void 0,he=Rt.normalized===!0;if(yt&&yt!==kt*vt){var de=Math.floor(Zt/yt),ue="InterleavedBuffer:"+Rt.bufferView+":"+Rt.componentType+":"+de+":"+Rt.count,te=At.cache.get(ue);te||(de=new Pt(gt,de*yt,Rt.count*yt/kt),te=new Ue(de,yt/kt),At.cache.add(ue,te)),kt=new Ro(te,vt,Zt%yt/kt,he)}else de=gt===null?new Pt(Rt.count*vt):new Pt(gt,Zt,Rt.count*vt),kt=new wr(de,vt,he);if(Rt.sparse!==void 0){for(yt=Rt.sparse.values.byteOffset||0,Zt=new Qt[Rt.sparse.indices.componentType](st[1],Rt.sparse.indices.byteOffset||0,Rt.sparse.count*We.SCALAR),st=new Pt(st[2],yt,Rt.sparse.count*vt),gt!==null&&(kt=new wr(kt.array.slice(),kt.itemSize,kt.normalized)),gt=0,Pt=Zt.length;gt<Pt;gt++)if(yt=Zt[gt],kt.setX(yt,st[gt*vt]),2<=vt&&kt.setY(yt,st[gt*vt+1]),3<=vt&&kt.setZ(yt,st[gt*vt+2]),4<=vt&&kt.setW(yt,st[gt*vt+3]),5<=vt)throw Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}return kt}))},lt.prototype.loadTexture=function(xt){var At=this,_t=this.json,Rt=this.options,st=this.textureLoader,gt=self.URL||self.webkitURL,vt=_t.textures[xt],Pt=vt.extensions||{},kt=Pt[zt.MSFT_TEXTURE_DDS]?_t.images[Pt[zt.MSFT_TEXTURE_DDS].source]:_t.images[vt.source],Zt=kt.uri,yt=!1;return kt.bufferView!==void 0&&(Zt=At.getDependency("bufferView",kt.bufferView).then(function(he){return yt=!0,he=new Blob([he],{type:kt.mimeType}),Zt=gt.createObjectURL(he)})),di.resolve(Zt).then(function(he){var de=Rt.manager.getHandler(he);return de||(de=Pt[zt.MSFT_TEXTURE_DDS]?At.extensions[zt.MSFT_TEXTURE_DDS].ddsLoader:st),new di(function(ue,te){de.load(E(he,Rt.path),ue,void 0,te)})}).then(function(he){yt===!0&&gt.revokeObjectURL(Zt),he.flipY=!1,vt.name&&(he.name=vt.name),kt.mimeType in nr&&(he.format=nr[kt.mimeType]);var de=(_t.samplers||{})[vt.sampler]||{};return he.magFilter=De[de.magFilter]||1006,he.minFilter=De[de.minFilter]||1008,he.wrapS=re[de.wrapS]||1e3,he.wrapT=re[de.wrapT]||1e3,At.associations.set(he,{type:"textures",index:xt}),he})},lt.prototype.assignTexture=function(xt,At,_t){var Rt=this;return this.getDependency("texture",_t.index).then(function(st){if(!st.isCompressedTexture)switch(At){case"aoMap":case"emissiveMap":case"metalnessMap":case"normalMap":case"roughnessMap":st.format=1022}if(_t.texCoord===void 0||_t.texCoord==0||At==="aoMap"&&_t.texCoord==1||console.warn("THREE.GLTFLoader: Custom UV set "+_t.texCoord+" for texture "+At+" not yet supported."),Rt.extensions[zt.KHR_TEXTURE_TRANSFORM]){var gt=_t.extensions!==void 0?_t.extensions[zt.KHR_TEXTURE_TRANSFORM]:void 0;if(gt){var vt=Rt.associations.get(st);st=Rt.extensions[zt.KHR_TEXTURE_TRANSFORM].extendTexture(st,gt),Rt.associations.set(st,vt)}}xt[At]=st})},lt.prototype.assignFinalMaterial=function(xt){var At=xt.geometry,_t=xt.material,Rt=At.attributes.tangent!==void 0,st=At.attributes.color!==void 0,gt=At.attributes.normal===void 0,vt=xt.isSkinnedMesh===!0,Pt=0<Ti(At.morphAttributes).length,kt=Pt&&At.morphAttributes.normal!==void 0;if(xt.isPoints){var Zt="PointsMaterial:"+_t.uuid,yt=this.cache.get(Zt);yt||(yt=new Ps,Rr.prototype.copy.call(yt,_t),yt.color.copy(_t.color),yt.map=_t.map,yt.sizeAttenuation=!1,this.cache.add(Zt,yt)),_t=yt}else xt.isLine&&(Zt="LineBasicMaterial:"+_t.uuid,yt=this.cache.get(Zt),yt||(yt=new $i,Rr.prototype.copy.call(yt,_t),yt.color.copy(_t.color),this.cache.add(Zt,yt)),_t=yt);(Rt||st||gt||vt||Pt)&&(Zt="ClonedMaterial:"+_t.uuid+":",_t.isGLTFSpecularGlossinessMaterial&&(Zt+="specular-glossiness:"),vt&&(Zt+="skinning:"),Rt&&(Zt+="vertex-tangents:"),st&&(Zt+="vertex-colors:"),gt&&(Zt+="flat-shading:"),Pt&&(Zt+="morph-targets:"),kt&&(Zt+="morph-normals:"),yt=this.cache.get(Zt),yt||(yt=_t.clone(),vt&&(yt.skinning=!0),Rt&&(yt.vertexTangents=!0),st&&(yt.vertexColors=!0),gt&&(yt.flatShading=!0),Pt&&(yt.morphTargets=!0),kt&&(yt.morphNormals=!0),this.cache.add(Zt,yt),this.associations.set(yt,this.associations.get(_t))),_t=yt),_t.aoMap&&At.attributes.uv2===void 0&&At.attributes.uv!==void 0&&At.setAttribute("uv2",At.attributes.uv),_t.normalScale&&!Rt&&(_t.normalScale.y=-_t.normalScale.y),_t.clearcoatNormalScale&&!Rt&&(_t.clearcoatNormalScale.y=-_t.clearcoatNormalScale.y),xt.material=_t},lt.prototype.loadMaterial=function(xt){var At=this,_t=this.extensions,Rt=this.json.materials[xt],st={},gt=Rt.extensions||{},vt=[];if(gt[zt.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]){var Pt=_t[zt.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS],kt=Pt.getMaterialType();vt.push(Pt.extendParams(st,Rt,At))}else if(gt[zt.KHR_MATERIALS_UNLIT])Pt=_t[zt.KHR_MATERIALS_UNLIT],kt=Pt.getMaterialType(),vt.push(Pt.extendParams(st,Rt,At));else{if(kt=yo,Pt=Rt.pbrMetallicRoughness||{},st.color=new Oe(1,1,1),st.opacity=1,Array.isArray(Pt.baseColorFactor)){var Zt=Pt.baseColorFactor;st.color.fromArray(Zt),st.opacity=Zt[3]}Pt.baseColorTexture!==void 0&&vt.push(At.assignTexture(st,"map",Pt.baseColorTexture)),st.metalness=Pt.metallicFactor!==void 0?Pt.metallicFactor:1,st.roughness=Pt.roughnessFactor!==void 0?Pt.roughnessFactor:1,Pt.metallicRoughnessTexture!==void 0&&(vt.push(At.assignTexture(st,"metalnessMap",Pt.metallicRoughnessTexture)),vt.push(At.assignTexture(st,"roughnessMap",Pt.metallicRoughnessTexture)))}return Rt.doubleSided===!0&&(st.side=2),Pt=Rt.alphaMode||"OPAQUE",Pt==="BLEND"?(st.transparent=!0,st.depthWrite=!1):(st.transparent=!1,Pt==="MASK"&&(st.alphaTest=Rt.alphaCutoff!==void 0?Rt.alphaCutoff:.5)),Rt.normalTexture!==void 0&&kt!==Nn&&(vt.push(At.assignTexture(st,"normalMap",Rt.normalTexture)),st.normalScale=new Ot(1,1),Rt.normalTexture.scale!==void 0&&st.normalScale.set(Rt.normalTexture.scale,Rt.normalTexture.scale)),Rt.occlusionTexture!==void 0&&kt!==Nn&&(vt.push(At.assignTexture(st,"aoMap",Rt.occlusionTexture)),Rt.occlusionTexture.strength!==void 0&&(st.aoMapIntensity=Rt.occlusionTexture.strength)),Rt.emissiveFactor!==void 0&&kt!==Nn&&(st.emissive=new Oe().fromArray(Rt.emissiveFactor)),Rt.emissiveTexture!==void 0&&kt!==Nn&&vt.push(At.assignTexture(st,"emissiveMap",Rt.emissiveTexture)),gt[zt.KHR_MATERIALS_CLEARCOAT]&&(Pt=_t[zt.KHR_MATERIALS_CLEARCOAT],kt=Pt.getMaterialType(),vt.push(Pt.extendParams(st,{extensions:gt},At))),di.all(vt).then(function(){var yt=kt===S?_t[zt.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(st):new kt(st);return Rt.name&&(yt.name=Rt.name),yt.map&&(yt.map.encoding=3001),yt.emissiveMap&&(yt.emissiveMap.encoding=3001),X(yt,Rt),At.associations.set(yt,{type:"materials",index:xt}),Rt.extensions&&F(_t,yt,Rt),yt})},lt.prototype.loadGeometries=function(xt){function At(he){return Rt[zt.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(he,_t).then(function(de){return Ct(de,he,_t)})}for(var _t=this,Rt=this.extensions,st=this.primitiveCache,gt=[],vt=0,Pt=xt.length;vt<Pt;vt++){var kt=xt[vt],Zt=J(kt),yt=st[Zt];yt?gt.push(yt.promise):(yt=kt.extensions&&kt.extensions[zt.KHR_DRACO_MESH_COMPRESSION]?At(kt):Ct(new ke,kt,_t),st[Zt]={primitive:kt,promise:yt},gt.push(yt))}return di.all(gt)},lt.prototype.loadMesh=function(xt){for(var At=this,_t=this.json.meshes[xt],Rt=_t.primitives,st=[],gt=0,vt=Rt.length;gt<vt;gt++){var Pt=Rt[gt].material===void 0?P(this.cache):this.getDependency("material",Rt[gt].material);st.push(Pt)}return st.push(At.loadGeometries(Rt)),di.all(st).then(function(kt){var Zt=kt.slice(0,kt.length-1),yt=kt[kt.length-1];kt=[];for(var he=0,de=yt.length;he<de;he++){var ue=yt[he],te=Rt[he],Ae=Zt[he];if(te.mode===4||te.mode===5||te.mode===6||te.mode===void 0)ue=_t.isSkinnedMesh===!0?new Eh(ue,Ae):new Zi(ue,Ae),ue.isSkinnedMesh!==!0||ue.geometry.attributes.skinWeight.normalized||ue.normalizeSkinWeights(),te.mode===5?ue.geometry=wt(ue.geometry,1):te.mode===6&&(ue.geometry=wt(ue.geometry,2));else if(te.mode===1)ue=new Fi(ue,Ae);else if(te.mode===3)ue=new Po(ue,Ae);else if(te.mode===2)ue=new of(ue,Ae);else if(te.mode===0)ue=new Ru(ue,Ae);else throw Error("THREE.GLTFLoader: Primitive mode unsupported: "+te.mode);if(0<Ti(ue.geometry.morphAttributes).length){te=ue;var cr=_t;if(te.updateMorphTargets(),cr.weights!==void 0){Ae=0;for(var Cr=cr.weights.length;Ae<Cr;Ae++)te.morphTargetInfluences[Ae]=cr.weights[Ae]}if(cr.extras&&Array.isArray(cr.extras.targetNames))if(cr=cr.extras.targetNames,te.morphTargetInfluences.length===cr.length)for(te.morphTargetDictionary={},Ae=0,Cr=cr.length;Ae<Cr;Ae++)te.morphTargetDictionary[cr[Ae]]=Ae;else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}ue.name=_t.name||"mesh_"+xt,1<yt.length&&(ue.name+="_"+he),X(ue,_t),At.assignFinalMaterial(ue),kt.push(ue)}if(kt.length===1)return kt[0];for(Zt=new Zo,he=0,de=kt.length;he<de;he++)Zt.add(kt[he]);return Zt})},lt.prototype.loadCamera=function(xt){var At;xt=this.json.cameras[xt];var _t=xt[xt.type];if(_t)return xt.type==="perspective"?At=new en(ti.radToDeg(_t.yfov),_t.aspectRatio||1,_t.znear||1,_t.zfar||2e6):xt.type==="orthographic"&&(At=new ja(-_t.xmag,_t.xmag,_t.ymag,-_t.ymag,_t.znear,_t.zfar)),xt.name&&(At.name=xt.name),X(At,xt),di.resolve(At);console.warn("THREE.GLTFLoader: Missing camera parameters.")},lt.prototype.loadSkin=function(xt){xt=this.json.skins[xt];var At={joints:xt.joints};return xt.inverseBindMatrices===void 0?di.resolve(At):this.getDependency("accessor",xt.inverseBindMatrices).then(function(_t){return At.inverseBindMatrices=_t,At})},lt.prototype.loadAnimation=function(xt){for(var At=this.json.animations[xt],_t=[],Rt=[],st=[],gt=[],vt=[],Pt=0,kt=At.channels.length;Pt<kt;Pt++){var Zt=At.channels[Pt],yt=At.samplers[Zt.sampler];Zt=Zt.target;var he=At.parameters!==void 0?At.parameters[yt.input]:yt.input,de=At.parameters!==void 0?At.parameters[yt.output]:yt.output;_t.push(this.getDependency("node",Zt.node!==void 0?Zt.node:Zt.id)),Rt.push(this.getDependency("accessor",he)),st.push(this.getDependency("accessor",de)),gt.push(yt),vt.push(Zt)}return di.all([di.all(_t),di.all(Rt),di.all(st),di.all(gt),di.all(vt)]).then(function(ue){var te=ue[0],Ae=ue[1],cr=ue[2],Cr=ue[3];ue=ue[4];for(var me=[],Qe=0,Fr=te.length;Qe<Fr;Qe++){var be=te[Qe],mn=Ae[Qe],hi=cr[Qe],Co=Cr[Qe],_a=ue[Qe];if(be!==void 0){switch(be.updateMatrix(),be.matrixAutoUpdate=!0,Je[_a.path]){case Je.weights:var rh=Gh;break;case Je.rotation:rh=Vh;break;default:rh=Ul}var ws=be.name?be.name:be.uuid,tl=Co.interpolation!==void 0?qr[Co.interpolation]:2301,el=[];if(Je[_a.path]===Je.weights?be.traverse(function(go){go.isMesh===!0&&go.morphTargetInfluences&&el.push(go.name?go.name:go.uuid)}):el.push(ws),be=hi.array,hi.normalized){if(be.constructor===Int8Array)var ns=1/127;else if(be.constructor===Uint8Array)ns=1/255;else if(be.constructor==Int16Array)ns=1/32767;else if(be.constructor===Uint16Array)ns=1/65535;else throw Error("THREE.GLTFLoader: Unsupported output accessor component type.");var au=new Float32Array(be.length);for(hi=0,ws=be.length;hi<ws;hi++)au[hi]=be[hi]*ns;be=au}for(hi=0,ws=el.length;hi<ws;hi++)ns=new rh(el[hi]+"."+Je[_a.path],mn.array,be,tl),Co.interpolation==="CUBICSPLINE"&&(ns.createInterpolant=function(go){return new I(this.times,this.values,this.getValueSize()/3,go)},ns.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),me.push(ns)}}return new Fo(At.name?At.name:"animation_"+xt,void 0,me)})},lt.prototype.loadNode=function(xt){var At=this.json,_t=this.extensions,Rt=this,st=At.meshReferences,gt=At.meshUses,vt=At.nodes[xt];return function(){var Pt=[];return vt.mesh!==void 0&&Pt.push(Rt.getDependency("mesh",vt.mesh).then(function(kt){if(1<st[vt.mesh]){var Zt=gt[vt.mesh]++;kt=kt.clone(),kt.name+="_instance_"+Zt}return vt.weights!==void 0&&kt.traverse(function(yt){if(yt.isMesh)for(var he=0,de=vt.weights.length;he<de;he++)yt.morphTargetInfluences[he]=vt.weights[he]}),kt})),vt.camera!==void 0&&Pt.push(Rt.getDependency("camera",vt.camera)),vt.extensions&&vt.extensions[zt.KHR_LIGHTS_PUNCTUAL]&&vt.extensions[zt.KHR_LIGHTS_PUNCTUAL].light!==void 0&&Pt.push(Rt.getDependency("light",vt.extensions[zt.KHR_LIGHTS_PUNCTUAL].light)),di.all(Pt)}().then(function(Pt){var kt=vt.isBone===!0?new ia:1<Pt.length?new Zo:Pt.length===1?Pt[0]:new fe;if(kt!==Pt[0])for(var Zt=0,yt=Pt.length;Zt<yt;Zt++)kt.add(Pt[Zt]);return vt.name&&(kt.userData.name=vt.name,kt.name=io.sanitizeNodeName(vt.name)),X(kt,vt),vt.extensions&&F(_t,kt,vt),vt.matrix!==void 0?(Pt=new Me,Pt.fromArray(vt.matrix),kt.applyMatrix4(Pt)):(vt.translation!==void 0&&kt.position.fromArray(vt.translation),vt.rotation!==void 0&&kt.quaternion.fromArray(vt.rotation),vt.scale!==void 0&&kt.scale.fromArray(vt.scale)),Rt.associations.set(kt,{type:"nodes",index:xt}),kt})},lt.prototype.loadScene=function(){function xt(At,_t,Rt,st){var gt=Rt.nodes[At];return st.getDependency("node",At).then(function(vt){if(gt.skin===void 0)return vt;var Pt;return st.getDependency("skin",gt.skin).then(function(kt){Pt=kt,kt=[];for(var Zt=0,yt=Pt.joints.length;Zt<yt;Zt++)kt.push(st.getDependency("node",Pt.joints[Zt]));return di.all(kt)}).then(function(kt){return vt.traverse(function(Zt){if(Zt.isMesh){for(var yt=[],he=[],de=0,ue=kt.length;de<ue;de++){var te=kt[de];te?(yt.push(te),te=new Me,Pt.inverseBindMatrices!==void 0&&te.fromArray(Pt.inverseBindMatrices.array,16*de),he.push(te)):console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',Pt.joints[de])}Zt.bind(new Tl(yt,he),Zt.matrixWorld)}}),vt})}).then(function(vt){_t.add(vt);var Pt=[];if(gt.children)for(var kt=gt.children,Zt=0,yt=kt.length;Zt<yt;Zt++)Pt.push(xt(kt[Zt],vt,Rt,st));return di.all(Pt)})}return function(At){var _t=this.json,Rt=this.extensions;At=this.json.scenes[At];var st=new Zo;At.name&&(st.name=At.name),X(st,At),At.extensions&&F(Rt,st,At),Rt=At.nodes||[],At=[];for(var gt=0,vt=Rt.length;gt<vt;gt++)At.push(xt(Rt[gt],st,_t,this));return di.all(At).then(function(){return st})}}(),t}(),xc={};xc.MTLLoader=dp,xc.OBJLoader=vE,xc.GLTFLoader=yE;var xE=ht(function(t,r){r.__esModule=!0;var i=eu&&eu.__esModule?eu:{default:eu};r.default=function(){function s(f,c){for(var d=0;d<c.length;d++){var p=c[d];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),(0,i.default)(f,p.key,p)}}return function(f,c,d){return c&&s(f.prototype,c),d&&s(f,d),f}}()}),Xi=ot(xE);ua(Gn.prototype,{equals:function(t){return this.lat===t.lat&&this.lng===t.lng},clone:function(){return new Gn(this.lat,this.lng)},getLngSpan:function(t){return t=Math.abs(t-this.lng),180<t&&(t=360-t),t},sub:function(t){return new Gn(this.lat-t.lat,this.lng-t.lng)},toString:function(){return"Point"}}),ua(Bs,{EARTHRADIUS:637099681e-2,MCBAND:[1289059486e-2,836237787e-2,5591021,348198983e-2,167804312e-2,0],LLBAND:[75,60,45,30,15,0],MC2LL:[[1410526172116255e-23,898305509648872e-20,-1.9939833816331,200.9824383106796,-187.2403703815547,91.6087516669843,-23.38765649603339,2.57121317296198,-.03801003308653,173379812e-1],[-7435856389565537e-24,8983055097726239e-21,-.78625201886289,96.32687599759846,-1.85204757529826,-59.36935905485877,47.40033549296737,-16.50741931063887,2.28786674699375,1026014486e-2],[-3030883460898826e-23,898305509983578e-20,.30071316287616,59.74293618442277,7.357984074871,-25.38371002664745,13.45380521110908,-3.29883767235584,.32710905363475,685681737e-2],[-1981981304930552e-23,8983055099779535e-21,.03278182852591,40.31678527705744,.65659298677277,-4.44255534477492,.85341911805263,.12923347998204,-.04625736007561,448277706e-2],[309191371068437e-23,8983055096812155e-21,6995724062e-14,23.10934304144901,-.00023663490511,-.6321817810242,-.00663494467273,.03430082397953,-.00466043876332,25551644e-1],[2890871144776878e-24,8983055095805407e-21,-3068298e-14,7.47137025468032,-353937994e-14,-.02145144861037,-1234426596e-14,.00010322952773,-323890364e-14,826088.5]],LL2MC:[[-.0015702102444,111320.7020616939,0x60e374c3105a3,-0x24bb4115e2e164,0x5cc55543bb0ae8,-0x7ce070193f3784,0x5e7ca61ddf8150,-0x261a578d8b24d0,0x665d60f3742ca,82.5],[.0008277824516172526,111320.7020463578,6477955746671607e-7,-4082003173641316e-6,1077490566351142e-5,-1517187553151559e-5,1205306533862167e-5,-5124939663577472e-6,9133119359512032e-7,67.5],[.00337398766765,111320.7020202162,4481351045890365e-9,-2339375119931662e-8,7968221547186455e-8,-1159649932797253e-7,9723671115602145e-8,-4366194633752821e-8,8477230501135234e-9,52.5],[.00220636496208,111320.7020209128,51751.86112841131,3796837749470245e-9,992013.7397791013,-122195221711287e-8,1340652697009075e-9,-620943.6990984312,144416.9293806241,37.5],[-.0003441963504368392,111320.7020576856,278.2353980772752,2485758690035394e-9,6070.750963243378,54821.18345352118,9540.606633304236,-2710.55326746645,1405.483844121726,22.5],[-.0003218135878613132,111320.7020701615,.00369383431289,823725.6402795718,.46104986909093,2351.343141331292,1.58060784298199,8.77738589078284,.37238884252424,7.45]],getDistanceByMC:function(t,r){if(!t||!r||(t=this.convertMC2LL(t),!t))return 0;var i=this.toRadians(t.lng);if(t=this.toRadians(t.lat),r=this.convertMC2LL(r),!r)return 0;var s=this.toRadians(r.lng);return r=this.toRadians(r.lat),this.getDistance(i,s,t,r)},getDistanceByLL:function(t,r){if(!t||!r)return 0;t.lng=this.getLoop(t.lng,-180,180),t.lat=this.getRange(t.lat,-74,74),r.lng=this.getLoop(r.lng,-180,180),r.lat=this.getRange(r.lat,-74,74);var i=this.toRadians(t.lng),s=this.toRadians(t.lat);return t=this.toRadians(r.lng),r=this.toRadians(r.lat),this.getDistance(i,t,s,r)},convertMC2LL:function(t){if(t==null)return new Gn(0,0);if(180>t.lng&&-180<t.lng&&90>t.lat&&-90<t.lat)return t;for(var r=new Gn(Math.abs(t.lng),Math.abs(t.lat)),i=0;i<this.MCBAND.length;i++)if(r.lat>=this.MCBAND[i]){var s=this.MC2LL[i];break}return t=this.convertor(t,s),t=new Gn(t.lng.toFixed(6),t.lat.toFixed(6))},convertLL2MC:function(t){if(t==null)return new Gn(0,0);if(180<t.lng||-180>t.lng||90<t.lat||-90>t.lat)return t;t.lng=this.getLoop(t.lng,-180,180),t.lat=this.getRange(t.lat,-74,74);for(var r=new Gn(t.lng,t.lat),i=0;i<this.LLBAND.length;i++)if(r.lat>=this.LLBAND[i]){var s=this.LL2MC[i];break}if(!s){for(i=0;i<this.LLBAND.length;i++)if(r.lat<=-this.LLBAND[i]){s=this.LL2MC[i];break}}return t=this.convertor(t,s),t=new Gn(Number(t.lng.toFixed(2)),Number(t.lat.toFixed(2)))},convertor:function(t,r){if(t&&r){var i=r[0]+r[1]*Math.abs(t.lng),s=Math.abs(t.lat)/r[9];return r=r[2]+r[3]*s+r[4]*s*s+r[5]*s*s*s+r[6]*s*s*s*s+r[7]*s*s*s*s*s+r[8]*s*s*s*s*s*s,i*=0>t.lng?-1:1,r*=0>t.lat?-1:1,new Gn(i,r)}},getDistance:function(t,r,i,s){return this.EARTHRADIUS*Math.acos(Math.sin(i)*Math.sin(s)+Math.cos(i)*Math.cos(s)*Math.cos(r-t))},toRadians:function(t){return Math.PI*t/180},toDegrees:function(t){return 180*t/Math.PI},getRange:function(t,r,i){return r!=null&&(t=Math.max(t,r)),i!=null&&(t=Math.min(t,i)),t},getLoop:function(t,r,i){for(;t>i;)t-=i-r;for(;t<r;)t+=i-r;return t}}),ua(Bs.prototype,{lngLatToMercator:function(t){return Bs.convertLL2MC(t)},lngLatToPoint:function(t){return t=Bs.convertLL2MC(t),new qa(t.lng,t.lat)},mercatorToLngLat:function(t){return Bs.convertMC2LL(t)},pointToLngLat:function(t){return t=new Gn(t.x,t.y),Bs.convertMC2LL(t)},pointToPixel:function(t,r,i,s,f){if(t)return t=this.lngLatToMercator(t,f),r=this.getZoomUnits(r),new qa(Math.round((t.lng-i.lng)/r+s.width/2),Math.round((i.lat-t.lat)/r+s.height/2))},pixelToPoint:function(t,r,i,s,f){if(t)return r=this.getZoomUnits(r),t=new Gn(i.lng+r*(t.x-s.width/2),i.lat-r*(t.y-s.height/2)),this.mercatorToLngLat(t,f)},getZoomUnits:function(t){return Math.pow(2,18-t)}});var AE=ht(function(t,r){r.__esModule=!0;var i=$h&&$h.__esModule?$h:{default:$h};r.default=function(s){if(Array.isArray(s)){for(var f=0,c=Array(s.length);f<s.length;f++)c[f]=s[f];return c}return(0,i.default)(s)}}),d3=ot(AE);(function(){function t(){var r=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};Ai(this,t),this.options=r,this._initialize()}return Xi(t,[{key:"_initialize",value:function(){this.points=this.options.points}},{key:"_normalizaCoord",value:function(r){return r?(r instanceof Array&&(r={lng:Number(r[0]),lat:Number(r[1])}),Bs.convertLL2MC(r)):null}},{key:"setOptions",value:function(){this.options=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{},this._initialize()}},{key:"getPoints",value:function(r){for(var i=[],s=this.points,f=0;f<s.length-1;f++){var c=this.getCurveByTwoPoints(this._normalizaCoord(s[f]),this._normalizaCoord(s[f+1]),r);c&&0<c.length&&(i=i.concat(c))}return i}},{key:"getCurveByTwoPoints",value:function(r,i){var s=2<arguments.length&&arguments[2]!==void 0?arguments[2]:20;if(!r||!i)return null;var f=[],c=0;if((typeof i=="undefined"?"undefined":ts(i))===void 0)typeof f=="undefined"||ts(f);else{var d=parseFloat(r.lat),p=parseFloat(i.lat),A=parseFloat(r.lng),S=parseFloat(i.lng);S>A&&180<parseFloat(S-A)&&0>A&&(A=parseFloat(360+A),S=parseFloat(360+S));var z=0;if(p===d)var w=0,I=A-S;else S===A?(w=Math.PI/2,I=d-p):(w=Math.atan((p-d)/(S-A)),I=(p-d)/Math.sin(w));for(z===0&&(z=w+Math.PI/5),I/=2,w=I*Math.cos(z)+A,z=I*Math.sin(z)+d,I=0;I<s+1;I++){var E=A*(1-2*c+c*c)+w*(2*c-2*c*c)+S*c*c,P=i.lng;f.push([0>r.lng&&0<P?E-360:E,d*(1-2*c+c*c)+z*(2*c-2*c*c)+p*c*c]),c+=1/s}return f}}}]),t})();var Rv=void 0,_E=function(){if(Rv!==void 0)return Rv;var t=navigator.userAgent,r="Android;iPhone;SymbianOS;Windows Phone;iPad;iPod".split(";");Rv=!1;for(var i=0;i<r.length;i++)if(0<t.indexOf(r[i])){Rv=!0;break}return Rv}();Qo(Array(576)),Qo(Array(60)),Qo(Array(512)),Qo(Array(256)),Qo(Array(29)),Qo(Array(30)),new Uint32Array(function(){for(var t,r=[],i=0;256>i;i++){t=i;for(var s=0;8>s;s++)t=t&1?3988292384^t>>>1:t>>>1;r[i]=t}return r}());try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{}for(var E_=new Uint8Array(256),Ac=0;256>Ac;Ac++)E_[Ac]=252<=Ac?6:248<=Ac?5:240<=Ac?4:224<=Ac?3:192<=Ac?2:1;E_[254]=E_[254]=1;var ou={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},wE=$o.f;rc("getOwnPropertyDescriptor",function(){return function(t,r){return wE(Us(t),r)}});var ME=yi.Object,CE=function(t,r){return ME.getOwnPropertyDescriptor(t,r)},TE=ht(function(t){t.exports={default:CE,__esModule:!0}}),Xn=ot(TE),Pv=ht(function(t){var r=Array.prototype.concat,i=Array.prototype.slice,s=t.exports=function(f){for(var c=[],d=0,p=f.length;d<p;d++){var A=f[d],S=(S=A)&&typeof S!="string"?S instanceof Array||Array.isArray(S)||0<=S.length&&(S.splice instanceof Function||Xn(S,S.length-1)&&S.constructor.name!=="String"):!1;S?c=r.call(c,i.call(A)):c.push(A)}return c};s.wrap=function(f){return function(){return f(s(arguments))}}}),Dv=ht(function(t){function r(d,p,A){return Math.min(Math.max(p,d),A)}function i(d){return d=d.toString(16).toUpperCase(),2>d.length?"0"+d:d}var s={},f;for(f in ou)ou.hasOwnProperty(f)&&(s[ou[f]]=f);var c=t.exports={to:{},get:{}};c.get=function(d){switch(d.substring(0,3).toLowerCase()){case"hsl":d=c.get.hsl(d);var p="hsl";break;case"hwb":d=c.get.hwb(d),p="hwb";break;default:d=c.get.rgb(d),p="rgb"}return d?{model:p,value:d}:null},c.get.rgb=function(d){if(!d)return null;var p=/^#([a-f0-9]{3,4})$/i,A=/^rgba?\(\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/,S=/^rgba?\(\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/,z=/(\D+)/,w=[0,0,0,1],I;if(I=d.match(/^#([a-f0-9]{6})([a-f0-9]{2})?$/i)){for(p=I[2],I=I[1],d=0;3>d;d++)A=2*d,w[d]=parseInt(I.slice(A,A+2),16);p&&(w[3]=Math.round(parseInt(p,16)/255*100)/100)}else if(I=d.match(p)){for(I=I[1],p=I[3],d=0;3>d;d++)w[d]=parseInt(I[d]+I[d],16);p&&(w[3]=Math.round(parseInt(p+p,16)/255*100)/100)}else if(I=d.match(A)){for(d=0;3>d;d++)w[d]=parseInt(I[d+1],0);I[4]&&(w[3]=parseFloat(I[4]))}else if(I=d.match(S)){for(d=0;3>d;d++)w[d]=Math.round(2.55*parseFloat(I[d+1]));I[4]&&(w[3]=parseFloat(I[4]))}else return(I=d.match(z))?I[1]==="transparent"?[0,0,0,0]:(w=ou[I[1]],w?(w[3]=1,w):null):null;for(d=0;3>d;d++)w[d]=r(w[d],0,255);return w[3]=r(w[3],0,1),w},c.get.hsl=function(d){if(!d)return null;var p=d.match(/^hsla?\(\s*([+-]?(?:\d*\.)?\d+)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/);if(p){var A=parseFloat(p[4]);d=(parseFloat(p[1])+360)%360;var S=r(parseFloat(p[2]),0,100);return p=r(parseFloat(p[3]),0,100),A=r(isNaN(A)?1:A,0,1),[d,S,p,A]}return null},c.get.hwb=function(d){if(!d)return null;var p=d.match(/^hwb\(\s*([+-]?\d*[\.]?\d+)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/);if(p){var A=parseFloat(p[4]);d=(parseFloat(p[1])%360+360)%360;var S=r(parseFloat(p[2]),0,100);return p=r(parseFloat(p[3]),0,100),A=r(isNaN(A)?1:A,0,1),[d,S,p,A]}return null},c.to.hex=function(){var d=Pv(arguments);return"#"+i(d[0])+i(d[1])+i(d[2])+(1>d[3]?i(Math.round(255*d[3])):"")},c.to.rgb=function(){var d=Pv(arguments);return 4>d.length||d[3]===1?"rgb("+Math.round(d[0])+", "+Math.round(d[1])+", "+Math.round(d[2])+")":"rgba("+Math.round(d[0])+", "+Math.round(d[1])+", "+Math.round(d[2])+", "+d[3]+")"},c.to.rgb.percent=function(){var d=Pv(arguments),p=Math.round(d[0]/255*100),A=Math.round(d[1]/255*100),S=Math.round(d[2]/255*100);return 4>d.length||d[3]===1?"rgb("+p+"%, "+A+"%, "+S+"%)":"rgba("+p+"%, "+A+"%, "+S+"%, "+d[3]+")"},c.to.hsl=function(){var d=Pv(arguments);return 4>d.length||d[3]===1?"hsl("+d[0]+", "+d[1]+"%, "+d[2]+"%)":"hsla("+d[0]+", "+d[1]+"%, "+d[2]+"%, "+d[3]+")"},c.to.hwb=function(){var d=Pv(arguments),p="";return 4<=d.length&&d[3]!==1&&(p=", "+d[3]),"hwb("+d[0]+", "+d[1]+"%, "+d[2]+"%"+p+")"},c.to.keyword=function(d){return s[d.slice(0,3)]}}),mp=ht(function(t){var r={};for(f in ou)ou.hasOwnProperty(f)&&(r[ou[f]]=f);var i=t.exports={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},lch:{channels:3,labels:"lch"},hex:{channels:1,labels:["hex"]},keyword:{channels:1,labels:["keyword"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}},s;for(s in i)if(i.hasOwnProperty(s)){if(!("channels"in i[s]))throw Error("missing channels property: "+s);if(!("labels"in i[s]))throw Error("missing channel labels property: "+s);if(i[s].labels.length!==i[s].channels)throw Error("channel and label counts mismatch: "+s);t=i[s].channels;var f=i[s].labels;delete i[s].channels,delete i[s].labels,Object.defineProperty(i[s],"channels",{value:t}),Object.defineProperty(i[s],"labels",{value:f})}i.rgb.hsl=function(c){var d=c[0]/255,p=c[1]/255,A=c[2]/255;c=Math.min(d,p,A);var S=Math.max(d,p,A),z=S-c,w;return S===c?w=0:d===S?w=(p-A)/z:p===S?w=2+(A-d)/z:A===S&&(w=4+(d-p)/z),w=Math.min(60*w,360),0>w&&(w+=360),d=(c+S)/2,[w,100*(S===c?0:.5>=d?z/(S+c):z/(2-S-c)),100*d]},i.rgb.hsv=function(c){var d,p=c[0]/255,A=c[1]/255,S=c[2]/255,z=Math.max(p,A,S),w=z-Math.min(p,A,S);if(w===0)var I=d=0;else{d=w/z,c=(z-p)/6/w+.5;var E=(z-A)/6/w+.5;w=(z-S)/6/w+.5,p===z?I=w-E:A===z?I=1/3+c-w:S===z&&(I=2/3+E-c),0>I?I+=1:1<I&&--I}return[360*I,100*d,100*z]},i.rgb.hwb=function(c){var d=c[0],p=c[1],A=c[2];c=i.rgb.hsl(c)[0];var S=1/255*Math.min(d,Math.min(p,A));return A=1-1/255*Math.max(d,Math.max(p,A)),[c,100*S,100*A]},i.rgb.cmyk=function(c){var d=c[0]/255,p=c[1]/255;c=c[2]/255;var A=Math.min(1-d,1-p,1-c);return[100*((1-d-A)/(1-A)||0),100*((1-p-A)/(1-A)||0),100*((1-c-A)/(1-A)||0),100*A]},i.rgb.keyword=function(c){var d=r[c];if(d)return d;d=1/0;var p;for(p in ou)if(ou.hasOwnProperty(p)){var A=ou[p];if(A=Math.pow(c[0]-A[0],2)+Math.pow(c[1]-A[1],2)+Math.pow(c[2]-A[2],2),A<d){d=A;var S=p}}return S},i.keyword.rgb=function(c){return ou[c]},i.rgb.xyz=function(c){var d=c[0]/255,p=c[1]/255;return c=c[2]/255,d=.04045<d?Math.pow((d+.055)/1.055,2.4):d/12.92,p=.04045<p?Math.pow((p+.055)/1.055,2.4):p/12.92,c=.04045<c?Math.pow((c+.055)/1.055,2.4):c/12.92,[100*(.4124*d+.3576*p+.1805*c),100*(.2126*d+.7152*p+.0722*c),100*(.0193*d+.1192*p+.9505*c)]},i.rgb.lab=function(c){var d=i.rgb.xyz(c);c=d[0];var p=d[1];return d=d[2],c/=95.047,p/=100,d/=108.883,c=.008856<c?Math.pow(c,1/3):7.787*c+16/116,p=.008856<p?Math.pow(p,1/3):7.787*p+16/116,d=.008856<d?Math.pow(d,1/3):7.787*d+16/116,[116*p-16,500*(c-p),200*(p-d)]},i.hsl.rgb=function(c){var d=c[0]/360,p=c[1]/100;if(c=c[2]/100,p===0){var A=255*c;return[A,A,A]}p=.5>c?c*(1+p):c+p-c*p,c=2*c-p;for(var S=[0,0,0],z=0;3>z;z++)A=d+1/3*-(z-1),0>A&&A++,1<A&&A--,A=1>6*A?c+6*(p-c)*A:1>2*A?p:2>3*A?c+(p-c)*(2/3-A)*6:c,S[z]=255*A;return S},i.hsl.hsv=function(c){var d=c[0],p=c[1]/100;c=c[2]/100;var A=p,S=Math.max(c,.01);return c*=2,p*=1>=c?c:2-c,A*=1>=S?S:2-S,[d,100*(c===0?2*A/(S+A):2*p/(c+p)),(c+p)/2*100]},i.hsv.rgb=function(c){var d=c[0]/60,p=c[1]/100;c=c[2]/100;var A=Math.floor(d)%6,S=d-Math.floor(d);d=255*c*(1-p);var z=255*c*(1-p*S);switch(p=255*c*(1-p*(1-S)),c*=255,A){case 0:return[c,p,d];case 1:return[z,c,d];case 2:return[d,c,p];case 3:return[d,z,c];case 4:return[p,d,c];case 5:return[c,d,z]}},i.hsv.hsl=function(c){var d=c[0],p=c[1]/100;c=c[2]/100;var A=Math.max(c,.01),S=(2-p)*A;return A=p*A/(1>=S?S:2-S)||0,[d,100*A,(2-p)*c/2*100]},i.hwb.rgb=function(c){var d=c[0]/360,p=c[1]/100;c=c[2]/100;var A=p+c;switch(1<A&&(p/=A,c/=A),A=Math.floor(6*d),c=1-c,d=6*d-A,(A&1)!==0&&(d=1-d),d=p+d*(c-p),A){default:case 6:case 0:A=c;var S=d;break;case 1:A=d,S=c;break;case 2:A=p,S=c,p=d;break;case 3:A=p,S=d,p=c;break;case 4:A=d,S=p,p=c;break;case 5:A=c,S=p,p=d}return[255*A,255*S,255*p]},i.cmyk.rgb=function(c){var d=c[3]/100;return[255*(1-Math.min(1,c[0]/100*(1-d)+d)),255*(1-Math.min(1,c[1]/100*(1-d)+d)),255*(1-Math.min(1,c[2]/100*(1-d)+d))]},i.xyz.rgb=function(c){var d=c[0]/100,p=c[1]/100,A=c[2]/100;c=3.2406*d+-1.5372*p+-.4986*A;var S=-.9689*d+1.8758*p+.0415*A;return d=.0557*d+-.204*p+1.057*A,c=.0031308<c?1.055*Math.pow(c,1/2.4)-.055:12.92*c,S=.0031308<S?1.055*Math.pow(S,1/2.4)-.055:12.92*S,d=.0031308<d?1.055*Math.pow(d,1/2.4)-.055:12.92*d,c=Math.min(Math.max(0,c),1),S=Math.min(Math.max(0,S),1),d=Math.min(Math.max(0,d),1),[255*c,255*S,255*d]},i.xyz.lab=function(c){var d=c[0],p=c[1];return c=c[2],d/=95.047,p/=100,c/=108.883,d=.008856<d?Math.pow(d,1/3):7.787*d+16/116,p=.008856<p?Math.pow(p,1/3):7.787*p+16/116,c=.008856<c?Math.pow(c,1/3):7.787*c+16/116,[116*p-16,500*(d-p),200*(p-c)]},i.lab.xyz=function(c){var d=c[1],p=c[2];c=(c[0]+16)/116,d=d/500+c,p=c-p/200;var A=Math.pow(c,3),S=Math.pow(d,3),z=Math.pow(p,3);return[95.047*(.008856<S?S:(d-16/116)/7.787),100*(.008856<A?A:(c-16/116)/7.787),108.883*(.008856<z?z:(p-16/116)/7.787)]},i.lab.lch=function(c){var d=c[0],p=c[1];c=c[2];var A=360*Math.atan2(c,p)/2/Math.PI;return 0>A&&(A+=360),[d,Math.sqrt(p*p+c*c),A]},i.lch.lab=function(c){var d=c[0],p=c[1];return c=c[2]/360*2*Math.PI,[d,p*Math.cos(c),p*Math.sin(c)]},i.rgb.ansi16=function(c){var d=c[0],p=c[1],A=c[2],S=1 in arguments?arguments[1]:i.rgb.hsv(c)[2];return S=Math.round(S/50),S===0?30:(d=30+(Math.round(A/255)<<2|Math.round(p/255)<<1|Math.round(d/255)),S===2&&(d+=60),d)},i.hsv.ansi16=function(c){return i.rgb.ansi16(i.hsv.rgb(c),c[2])},i.rgb.ansi256=function(c){var d=c[0],p=c[1];return c=c[2],d===p&&p===c?8>d?16:248<d?231:Math.round((d-8)/247*24)+232:16+36*Math.round(d/255*5)+6*Math.round(p/255*5)+Math.round(c/255*5)},i.ansi16.rgb=function(c){var d=c%10;return d===0||d===7?(50<c&&(d+=3.5),d=d/10.5*255,[d,d,d]):(c=.5*(~~(50<c)+1),[(d&1)*c*255,(d>>1&1)*c*255,(d>>2&1)*c*255])},i.ansi256.rgb=function(c){if(232<=c){var d=10*(c-232)+8;return[d,d,d]}c-=16,d=Math.floor(c/36)/5*255;var p=Math.floor((c%=36)/6)/5*255;return[d,p,c%6/5*255]},i.rgb.hex=function(c){return c=(((Math.round(c[0])&255)<<16)+((Math.round(c[1])&255)<<8)+(Math.round(c[2])&255)).toString(16).toUpperCase(),"000000".substring(c.length)+c},i.hex.rgb=function(c){if(c=c.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i),!c)return[0,0,0];var d=c[0];return c[0].length===3&&(d=d.split("").map(function(p){return p+p}).join("")),c=parseInt(d,16),[c>>16&255,c>>8&255,c&255]},i.rgb.hcg=function(c){var d=c[0]/255,p=c[1]/255;c=c[2]/255;var A=Math.max(Math.max(d,p),c),S=Math.min(Math.min(d,p),c),z=A-S;return[(0>=z?0:A===d?(p-c)/z%6:A===p?2+(c-d)/z:(d-p)/z+8)/6%1*360,100*z,100*(1>z?S/(1-z):0)]},i.hsl.hcg=function(c){var d=c[1]/100,p=c[2]/100,A=0;return d=.5>p?2*d*p:2*d*(1-p),1>d&&(A=(p-.5*d)/(1-d)),[c[0],100*d,100*A]},i.hsv.hcg=function(c){var d=c[2]/100,p=c[1]/100*d,A=0;return 1>p&&(A=(d-p)/(1-p)),[c[0],100*p,100*A]},i.hcg.rgb=function(c){var d=c[1]/100,p=c[2]/100;if(d===0)return[255*p,255*p,255*p];var A=[0,0,0];c=c[0]/360%1*6;var S=c%1,z=1-S;switch(Math.floor(c)){case 0:A[0]=1,A[1]=S,A[2]=0;break;case 1:A[0]=z,A[1]=1,A[2]=0;break;case 2:A[0]=0,A[1]=1,A[2]=S;break;case 3:A[0]=0,A[1]=z,A[2]=1;break;case 4:A[0]=S,A[1]=0,A[2]=1;break;default:A[0]=1,A[1]=0,A[2]=z}return p*=1-d,[255*(d*A[0]+p),255*(d*A[1]+p),255*(d*A[2]+p)]},i.hcg.hsv=function(c){var d=c[1]/100,p=d+c[2]/100*(1-d),A=0;return 0<p&&(A=d/p),[c[0],100*A,100*p]},i.hcg.hsl=function(c){var d=c[1]/100,p=c[2]/100*(1-d)+.5*d,A=0;return 0<p&&.5>p?A=d/(2*p):.5<=p&&1>p&&(A=d/(2*(1-p))),[c[0],100*A,100*p]},i.hcg.hwb=function(c){var d=c[1]/100,p=d+c[2]/100*(1-d);return[c[0],100*(p-d),100*(1-p)]},i.hwb.hcg=function(c){var d=1-c[2]/100,p=d-c[1]/100,A=0;return 1>p&&(A=(d-p)/(1-p)),[c[0],100*p,100*A]},i.apple.rgb=function(c){return[c[0]/65535*255,c[1]/65535*255,c[2]/65535*255]},i.rgb.apple=function(c){return[c[0]/255*65535,c[1]/255*65535,c[2]/255*65535]},i.gray.rgb=function(c){return[c[0]/100*255,c[0]/100*255,c[0]/100*255]},i.gray.hsl=i.gray.hsv=function(c){return[0,0,c[0]]},i.gray.hwb=function(c){return[0,100,c[0]]},i.gray.cmyk=function(c){return[0,0,0,c[0]]},i.gray.lab=function(c){return[c[0],0,0]},i.gray.hex=function(c){return c=Math.round(c[0]/100*255)&255,c=((c<<16)+(c<<8)+c).toString(16).toUpperCase(),"000000".substring(c.length)+c},i.rgb.gray=function(c){return[(c[0]+c[1]+c[2])/3/255*100]}}),SE=function(t){for(var r={},i=Ti(mp),s=i.length,f=0;f<s;f++)r[i[f]]={distance:-1,parent:null};for(i=[t],r[t].distance=0;i.length;){t=i.pop(),s=Ti(mp[t]),f=s.length;for(var c=0;c<f;c++){var d=s[c],p=r[d];p.distance===-1&&(p.distance=r[t].distance+1,p.parent=t,i.unshift(d))}}for(i={},t=Ti(r),s=t.length,f=0;f<s;f++){var A=t[f];if(r[A].parent!==null){c=A,d=r,p=[d[A].parent,A];var S=mp[d[A].parent][A];for(A=d[A].parent;d[A].parent;)p.unshift(d[A].parent),S=no(mp[d[A].parent][A],S),A=d[A].parent;S.conversion=p,i[c]=S}}return i},Jd={};Ti(mp).forEach(function(t){Jd[t]={},Object.defineProperty(Jd[t],"channels",{value:mp[t].channels}),Object.defineProperty(Jd[t],"labels",{value:mp[t].labels});var r=SE(t);Ti(r).forEach(function(i){var s=r[i];Jd[t][i]=Pf(s),Jd[t][i].raw=Mi(s)})});var Vs=Jd,L_=[].slice,m3=["keyword","gray","hex"],R_={};Ti(Vs).forEach(function(t){R_[L_.call(Vs[t].labels).sort().join("")]=t});var Ky={};Vn.prototype={toString:function(){return this.string()},toJSON:function(){return this[this.model]()},string:function(t){var r=this.model in Dv.to?this:this.rgb();return r=r.round(typeof t=="number"?t:1),t=r.valpha===1?r.color:r.color.concat(this.valpha),Dv.to[r.model](t)},percentString:function(t){return t=this.rgb().round(typeof t=="number"?t:1),t=t.valpha===1?t.color:t.color.concat(this.valpha),Dv.to.rgb.percent(t)},array:function(){return this.valpha===1?this.color.slice():this.color.concat(this.valpha)},object:function(){for(var t={},r=Vs[this.model].channels,i=Vs[this.model].labels,s=0;s<r;s++)t[i[s]]=this.color[s];return this.valpha!==1&&(t.alpha=this.valpha),t},unitArray:function(){var t=this.rgb().color;return t[0]/=255,t[1]/=255,t[2]/=255,this.valpha!==1&&t.push(this.valpha),t},unitObject:function(){var t=this.rgb().object();return t.r/=255,t.g/=255,t.b/=255,this.valpha!==1&&(t.alpha=this.valpha),t},round:function(t){return t=Math.max(t||0,0),new Vn(this.color.map(Vl(t)).concat(this.valpha),this.model)},alpha:function(t){return arguments.length?new Vn(this.color.concat(Math.max(0,Math.min(1,t))),this.model):this.valpha},red:rn("rgb",0,nn(255)),green:rn("rgb",1,nn(255)),blue:rn("rgb",2,nn(255)),hue:rn(["hsl","hsv","hsl","hwb","hcg"],0,function(t){return(t%360+360)%360}),saturationl:rn("hsl",1,nn(100)),lightness:rn("hsl",2,nn(100)),saturationv:rn("hsv",1,nn(100)),value:rn("hsv",2,nn(100)),chroma:rn("hcg",1,nn(100)),gray:rn("hcg",2,nn(100)),white:rn("hwb",1,nn(100)),wblack:rn("hwb",2,nn(100)),cyan:rn("cmyk",0,nn(100)),magenta:rn("cmyk",1,nn(100)),yellow:rn("cmyk",2,nn(100)),black:rn("cmyk",3,nn(100)),x:rn("xyz",0,nn(100)),y:rn("xyz",1,nn(100)),z:rn("xyz",2,nn(100)),l:rn("lab",0,nn(100)),a:rn("lab",1),b:rn("lab",2),keyword:function(t){return arguments.length?new Vn(t):Vs[this.model].keyword(this.color)},hex:function(t){return arguments.length?new Vn(t):Dv.to.hex(this.rgb().round().color)},rgbNumber:function(){var t=this.rgb().color;return(t[0]&255)<<16|(t[1]&255)<<8|t[2]&255},luminosity:function(){for(var t=this.rgb().color,r=[],i=0;i<t.length;i++){var s=t[i]/255;r[i]=.03928>=s?s/12.92:Math.pow((s+.055)/1.055,2.4)}return .2126*r[0]+.7152*r[1]+.0722*r[2]},contrast:function(t){var r=this.luminosity();return t=t.luminosity(),r>t?(r+.05)/(t+.05):(t+.05)/(r+.05)},level:function(t){return t=this.contrast(t),7.1<=t?"AAA":4.5<=t?"AA":""},isDark:function(){var t=this.rgb().color;return 128>(299*t[0]+587*t[1]+114*t[2])/1e3},isLight:function(){return!this.isDark()},negate:function(){for(var t=this.rgb(),r=0;3>r;r++)t.color[r]=255-t.color[r];return t},lighten:function(t){var r=this.hsl();return r.color[2]+=r.color[2]*t,r},darken:function(t){var r=this.hsl();return r.color[2]-=r.color[2]*t,r},saturate:function(t){var r=this.hsl();return r.color[1]+=r.color[1]*t,r},desaturate:function(t){var r=this.hsl();return r.color[1]-=r.color[1]*t,r},whiten:function(t){var r=this.hwb();return r.color[1]+=r.color[1]*t,r},blacken:function(t){var r=this.hwb();return r.color[2]+=r.color[2]*t,r},grayscale:function(){var t=this.rgb().color;return t=.3*t[0]+.59*t[1]+.11*t[2],Vn.rgb(t,t,t)},fade:function(t){return this.alpha(this.valpha-this.valpha*t)},opaquer:function(t){return this.alpha(this.valpha+this.valpha*t)},rotate:function(t){var r=this.hsl(),i=r.color[0];return i=(i+t)%360,r.color[0]=0>i?360+i:i,r},mix:function(t,r){if(!t||!t.rgb)throw Error('Argument to "mix" was not a Color instance, but rather an instance of '+(typeof t=="undefined"?"undefined":ts(t)));t=t.rgb();var i=this.rgb();r=r===void 0?.5:r;var s=2*r-1,f=t.alpha()-i.alpha();return s=((s*f===-1?s:(s+f)/(1+s*f))+1)/2,f=1-s,Vn.rgb(s*t.red()+f*i.red(),s*t.green()+f*i.green(),s*t.blue()+f*i.blue(),t.alpha()*r+i.alpha()*(1-r))}},Ti(Vs).forEach(function(t){if(m3.indexOf(t)===-1){var r=Vs[t].channels;Vn.prototype[t]=function(){if(this.model===t)return new Vn(this);if(arguments.length)return new Vn(arguments,t);var i=typeof arguments[r]=="number"?r:this.valpha,s=Vs[this.model][t].raw(this.color);return s=Array.isArray(s)?s:[s],new Vn(s.concat(i),t)},Vn[t]=function(i){return typeof i=="number"&&(i=Dg(L_.call(arguments),r)),new Vn(i,t)}}});var su=ht(function(t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.setMatrixArrayType=function(c){r.ARRAY_TYPE=s=c},r.toRadian=function(c){return c*f},r.equals=function(c,d){return Math.abs(c-d)<=i*Math.max(1,Math.abs(c),Math.abs(d))},r.RANDOM=r.ARRAY_TYPE=r.EPSILON=void 0;var i=1e-6;r.EPSILON=i;var s=typeof Float32Array!="undefined"?Float32Array:Array;r.ARRAY_TYPE=s,r.RANDOM=Math.random;var f=Math.PI/180});ot(su);var g3=ht(function(t,r){function i(c,d,p){var A=d[0],S=d[1],z=d[2];d=d[3];var w=p[0],I=p[1],E=p[2];return p=p[3],c[0]=A*w+z*I,c[1]=S*w+d*I,c[2]=A*E+z*p,c[3]=S*E+d*p,c}function s(c,d,p){return c[0]=d[0]-p[0],c[1]=d[1]-p[1],c[2]=d[2]-p[2],c[3]=d[3]-p[3],c}Object.defineProperty(r,"__esModule",{value:!0}),r.create=function(){var c=new f.ARRAY_TYPE(4);return f.ARRAY_TYPE!=Float32Array&&(c[1]=0,c[2]=0),c[0]=1,c[3]=1,c},r.clone=function(c){var d=new f.ARRAY_TYPE(4);return d[0]=c[0],d[1]=c[1],d[2]=c[2],d[3]=c[3],d},r.copy=function(c,d){return c[0]=d[0],c[1]=d[1],c[2]=d[2],c[3]=d[3],c},r.identity=function(c){return c[0]=1,c[1]=0,c[2]=0,c[3]=1,c},r.fromValues=function(c,d,p,A){var S=new f.ARRAY_TYPE(4);return S[0]=c,S[1]=d,S[2]=p,S[3]=A,S},r.set=function(c,d,p,A,S){return c[0]=d,c[1]=p,c[2]=A,c[3]=S,c},r.transpose=function(c,d){if(c===d){var p=d[1];c[1]=d[2],c[2]=p}else c[0]=d[0],c[1]=d[2],c[2]=d[1],c[3]=d[3];return c},r.invert=function(c,d){var p=d[0],A=d[1],S=d[2];d=d[3];var z=p*d-S*A;return z?(z=1/z,c[0]=d*z,c[1]=-A*z,c[2]=-S*z,c[3]=p*z,c):null},r.adjoint=function(c,d){var p=d[0];return c[0]=d[3],c[1]=-d[1],c[2]=-d[2],c[3]=p,c},r.determinant=function(c){return c[0]*c[3]-c[2]*c[1]},r.multiply=i,r.rotate=function(c,d,p){var A=d[0],S=d[1],z=d[2];d=d[3];var w=Math.sin(p);return p=Math.cos(p),c[0]=A*p+z*w,c[1]=S*p+d*w,c[2]=A*-w+z*p,c[3]=S*-w+d*p,c},r.scale=function(c,d,p){var A=d[1],S=d[2],z=d[3],w=p[0];return p=p[1],c[0]=d[0]*w,c[1]=A*w,c[2]=S*p,c[3]=z*p,c},r.fromRotation=function(c,d){var p=Math.sin(d);return d=Math.cos(d),c[0]=d,c[1]=p,c[2]=-p,c[3]=d,c},r.fromScaling=function(c,d){return c[0]=d[0],c[1]=0,c[2]=0,c[3]=d[1],c},r.str=function(c){return"mat2("+c[0]+", "+c[1]+", "+c[2]+", "+c[3]+")"},r.frob=function(c){return Math.sqrt(Math.pow(c[0],2)+Math.pow(c[1],2)+Math.pow(c[2],2)+Math.pow(c[3],2))},r.LDU=function(c,d,p,A){return c[2]=A[2]/A[0],p[0]=A[0],p[1]=A[1],p[3]=A[3]-c[2]*p[1],[c,d,p]},r.add=function(c,d,p){return c[0]=d[0]+p[0],c[1]=d[1]+p[1],c[2]=d[2]+p[2],c[3]=d[3]+p[3],c},r.subtract=s,r.exactEquals=function(c,d){return c[0]===d[0]&&c[1]===d[1]&&c[2]===d[2]&&c[3]===d[3]},r.equals=function(c,d){var p=c[0],A=c[1],S=c[2];c=c[3];var z=d[0],w=d[1],I=d[2];return d=d[3],Math.abs(p-z)<=f.EPSILON*Math.max(1,Math.abs(p),Math.abs(z))&&Math.abs(A-w)<=f.EPSILON*Math.max(1,Math.abs(A),Math.abs(w))&&Math.abs(S-I)<=f.EPSILON*Math.max(1,Math.abs(S),Math.abs(I))&&Math.abs(c-d)<=f.EPSILON*Math.max(1,Math.abs(c),Math.abs(d))},r.multiplyScalar=function(c,d,p){return c[0]=d[0]*p,c[1]=d[1]*p,c[2]=d[2]*p,c[3]=d[3]*p,c},r.multiplyScalarAndAdd=function(c,d,p,A){return c[0]=d[0]+p[0]*A,c[1]=d[1]+p[1]*A,c[2]=d[2]+p[2]*A,c[3]=d[3]+p[3]*A,c},r.sub=r.mul=void 0;var f=function(c){if(c&&c.__esModule)return c;var d={};if(c!=null){for(var p in c)if(Object.prototype.hasOwnProperty.call(c,p)){var A=On&&Xn?Xn(c,p):{};A.get||A.set?On(d,p,A):d[p]=c[p]}}return d.default=c,d}(su);r.mul=i,r.sub=s});ot(g3);var v3=ht(function(t,r){function i(c,d,p){var A=d[0],S=d[1],z=d[2],w=d[3],I=d[4];d=d[5];var E=p[0],P=p[1],F=p[2],X=p[3],q=p[4];return p=p[5],c[0]=A*E+z*P,c[1]=S*E+w*P,c[2]=A*F+z*X,c[3]=S*F+w*X,c[4]=A*q+z*p+I,c[5]=S*q+w*p+d,c}function s(c,d,p){return c[0]=d[0]-p[0],c[1]=d[1]-p[1],c[2]=d[2]-p[2],c[3]=d[3]-p[3],c[4]=d[4]-p[4],c[5]=d[5]-p[5],c}Object.defineProperty(r,"__esModule",{value:!0}),r.create=function(){var c=new f.ARRAY_TYPE(6);return f.ARRAY_TYPE!=Float32Array&&(c[1]=0,c[2]=0,c[4]=0,c[5]=0),c[0]=1,c[3]=1,c},r.clone=function(c){var d=new f.ARRAY_TYPE(6);return d[0]=c[0],d[1]=c[1],d[2]=c[2],d[3]=c[3],d[4]=c[4],d[5]=c[5],d},r.copy=function(c,d){return c[0]=d[0],c[1]=d[1],c[2]=d[2],c[3]=d[3],c[4]=d[4],c[5]=d[5],c},r.identity=function(c){return c[0]=1,c[1]=0,c[2]=0,c[3]=1,c[4]=0,c[5]=0,c},r.fromValues=function(c,d,p,A,S,z){var w=new f.ARRAY_TYPE(6);return w[0]=c,w[1]=d,w[2]=p,w[3]=A,w[4]=S,w[5]=z,w},r.set=function(c,d,p,A,S,z,w){return c[0]=d,c[1]=p,c[2]=A,c[3]=S,c[4]=z,c[5]=w,c},r.invert=function(c,d){var p=d[0],A=d[1],S=d[2],z=d[3],w=d[4];d=d[5];var I=p*z-A*S;return I?(I=1/I,c[0]=z*I,c[1]=-A*I,c[2]=-S*I,c[3]=p*I,c[4]=(S*d-z*w)*I,c[5]=(A*w-p*d)*I,c):null},r.determinant=function(c){return c[0]*c[3]-c[1]*c[2]},r.multiply=i,r.rotate=function(c,d,p){var A=d[0],S=d[1],z=d[2],w=d[3],I=d[4];d=d[5];var E=Math.sin(p);return p=Math.cos(p),c[0]=A*p+z*E,c[1]=S*p+w*E,c[2]=A*-E+z*p,c[3]=S*-E+w*p,c[4]=I,c[5]=d,c},r.scale=function(c,d,p){var A=d[1],S=d[2],z=d[3],w=d[4],I=d[5],E=p[0];return p=p[1],c[0]=d[0]*E,c[1]=A*E,c[2]=S*p,c[3]=z*p,c[4]=w,c[5]=I,c},r.translate=function(c,d,p){var A=d[0],S=d[1],z=d[2],w=d[3],I=d[4];d=d[5];var E=p[0];return p=p[1],c[0]=A,c[1]=S,c[2]=z,c[3]=w,c[4]=A*E+z*p+I,c[5]=S*E+w*p+d,c},r.fromRotation=function(c,d){var p=Math.sin(d);return d=Math.cos(d),c[0]=d,c[1]=p,c[2]=-p,c[3]=d,c[4]=0,c[5]=0,c},r.fromScaling=function(c,d){return c[0]=d[0],c[1]=0,c[2]=0,c[3]=d[1],c[4]=0,c[5]=0,c},r.fromTranslation=function(c,d){return c[0]=1,c[1]=0,c[2]=0,c[3]=1,c[4]=d[0],c[5]=d[1],c},r.str=function(c){return"mat2d("+c[0]+", "+c[1]+", "+c[2]+", "+c[3]+", "+c[4]+", "+c[5]+")"},r.frob=function(c){return Math.sqrt(Math.pow(c[0],2)+Math.pow(c[1],2)+Math.pow(c[2],2)+Math.pow(c[3],2)+Math.pow(c[4],2)+Math.pow(c[5],2)+1)},r.add=function(c,d,p){return c[0]=d[0]+p[0],c[1]=d[1]+p[1],c[2]=d[2]+p[2],c[3]=d[3]+p[3],c[4]=d[4]+p[4],c[5]=d[5]+p[5],c},r.subtract=s,r.multiplyScalar=function(c,d,p){return c[0]=d[0]*p,c[1]=d[1]*p,c[2]=d[2]*p,c[3]=d[3]*p,c[4]=d[4]*p,c[5]=d[5]*p,c},r.multiplyScalarAndAdd=function(c,d,p,A){return c[0]=d[0]+p[0]*A,c[1]=d[1]+p[1]*A,c[2]=d[2]+p[2]*A,c[3]=d[3]+p[3]*A,c[4]=d[4]+p[4]*A,c[5]=d[5]+p[5]*A,c},r.exactEquals=function(c,d){return c[0]===d[0]&&c[1]===d[1]&&c[2]===d[2]&&c[3]===d[3]&&c[4]===d[4]&&c[5]===d[5]},r.equals=function(c,d){var p=c[0],A=c[1],S=c[2],z=c[3],w=c[4];c=c[5];var I=d[0],E=d[1],P=d[2],F=d[3],X=d[4];return d=d[5],Math.abs(p-I)<=f.EPSILON*Math.max(1,Math.abs(p),Math.abs(I))&&Math.abs(A-E)<=f.EPSILON*Math.max(1,Math.abs(A),Math.abs(E))&&Math.abs(S-P)<=f.EPSILON*Math.max(1,Math.abs(S),Math.abs(P))&&Math.abs(z-F)<=f.EPSILON*Math.max(1,Math.abs(z),Math.abs(F))&&Math.abs(w-X)<=f.EPSILON*Math.max(1,Math.abs(w),Math.abs(X))&&Math.abs(c-d)<=f.EPSILON*Math.max(1,Math.abs(c),Math.abs(d))},r.sub=r.mul=void 0;var f=function(c){if(c&&c.__esModule)return c;var d={};if(c!=null){for(var p in c)if(Object.prototype.hasOwnProperty.call(c,p)){var A=On&&Xn?Xn(c,p):{};A.get||A.set?On(d,p,A):d[p]=c[p]}}return d.default=c,d}(su);r.mul=i,r.sub=s});ot(v3);var P_=ht(function(t,r){function i(c,d,p){var A=d[0],S=d[1],z=d[2],w=d[3],I=d[4],E=d[5],P=d[6],F=d[7];d=d[8];var X=p[0],q=p[1],J=p[2],it=p[3],lt=p[4],Mt=p[5],Ct=p[6],wt=p[7];return p=p[8],c[0]=X*A+q*w+J*P,c[1]=X*S+q*I+J*F,c[2]=X*z+q*E+J*d,c[3]=it*A+lt*w+Mt*P,c[4]=it*S+lt*I+Mt*F,c[5]=it*z+lt*E+Mt*d,c[6]=Ct*A+wt*w+p*P,c[7]=Ct*S+wt*I+p*F,c[8]=Ct*z+wt*E+p*d,c}function s(c,d,p){return c[0]=d[0]-p[0],c[1]=d[1]-p[1],c[2]=d[2]-p[2],c[3]=d[3]-p[3],c[4]=d[4]-p[4],c[5]=d[5]-p[5],c[6]=d[6]-p[6],c[7]=d[7]-p[7],c[8]=d[8]-p[8],c}Object.defineProperty(r,"__esModule",{value:!0}),r.create=function(){var c=new f.ARRAY_TYPE(9);return f.ARRAY_TYPE!=Float32Array&&(c[1]=0,c[2]=0,c[3]=0,c[5]=0,c[6]=0,c[7]=0),c[0]=1,c[4]=1,c[8]=1,c},r.fromMat4=function(c,d){return c[0]=d[0],c[1]=d[1],c[2]=d[2],c[3]=d[4],c[4]=d[5],c[5]=d[6],c[6]=d[8],c[7]=d[9],c[8]=d[10],c},r.clone=function(c){var d=new f.ARRAY_TYPE(9);return d[0]=c[0],d[1]=c[1],d[2]=c[2],d[3]=c[3],d[4]=c[4],d[5]=c[5],d[6]=c[6],d[7]=c[7],d[8]=c[8],d},r.copy=function(c,d){return c[0]=d[0],c[1]=d[1],c[2]=d[2],c[3]=d[3],c[4]=d[4],c[5]=d[5],c[6]=d[6],c[7]=d[7],c[8]=d[8],c},r.fromValues=function(c,d,p,A,S,z,w,I,E){var P=new f.ARRAY_TYPE(9);return P[0]=c,P[1]=d,P[2]=p,P[3]=A,P[4]=S,P[5]=z,P[6]=w,P[7]=I,P[8]=E,P},r.set=function(c,d,p,A,S,z,w,I,E,P){return c[0]=d,c[1]=p,c[2]=A,c[3]=S,c[4]=z,c[5]=w,c[6]=I,c[7]=E,c[8]=P,c},r.identity=function(c){return c[0]=1,c[1]=0,c[2]=0,c[3]=0,c[4]=1,c[5]=0,c[6]=0,c[7]=0,c[8]=1,c},r.transpose=function(c,d){if(c===d){var p=d[1],A=d[2],S=d[5];c[1]=d[3],c[2]=d[6],c[3]=p,c[5]=d[7],c[6]=A,c[7]=S}else c[0]=d[0],c[1]=d[3],c[2]=d[6],c[3]=d[1],c[4]=d[4],c[5]=d[7],c[6]=d[2],c[7]=d[5],c[8]=d[8];return c},r.invert=function(c,d){var p=d[0],A=d[1],S=d[2],z=d[3],w=d[4],I=d[5],E=d[6],P=d[7];d=d[8];var F=d*w-I*P,X=-d*z+I*E,q=P*z-w*E,J=p*F+A*X+S*q;return J?(J=1/J,c[0]=F*J,c[1]=(-d*A+S*P)*J,c[2]=(I*A-S*w)*J,c[3]=X*J,c[4]=(d*p-S*E)*J,c[5]=(-I*p+S*z)*J,c[6]=q*J,c[7]=(-P*p+A*E)*J,c[8]=(w*p-A*z)*J,c):null},r.adjoint=function(c,d){var p=d[0],A=d[1],S=d[2],z=d[3],w=d[4],I=d[5],E=d[6],P=d[7];return d=d[8],c[0]=w*d-I*P,c[1]=S*P-A*d,c[2]=A*I-S*w,c[3]=I*E-z*d,c[4]=p*d-S*E,c[5]=S*z-p*I,c[6]=z*P-w*E,c[7]=A*E-p*P,c[8]=p*w-A*z,c},r.determinant=function(c){var d=c[3],p=c[4],A=c[5],S=c[6],z=c[7],w=c[8];return c[0]*(w*p-A*z)+c[1]*(-w*d+A*S)+c[2]*(z*d-p*S)},r.multiply=i,r.translate=function(c,d,p){var A=d[0],S=d[1],z=d[2],w=d[3],I=d[4],E=d[5],P=d[6],F=d[7];d=d[8];var X=p[0];return p=p[1],c[0]=A,c[1]=S,c[2]=z,c[3]=w,c[4]=I,c[5]=E,c[6]=X*A+p*w+P,c[7]=X*S+p*I+F,c[8]=X*z+p*E+d,c},r.rotate=function(c,d,p){var A=d[0],S=d[1],z=d[2],w=d[3],I=d[4],E=d[5],P=d[6],F=d[7];d=d[8];var X=Math.sin(p);return p=Math.cos(p),c[0]=p*A+X*w,c[1]=p*S+X*I,c[2]=p*z+X*E,c[3]=p*w-X*A,c[4]=p*I-X*S,c[5]=p*E-X*z,c[6]=P,c[7]=F,c[8]=d,c},r.scale=function(c,d,p){var A=p[0];return p=p[1],c[0]=A*d[0],c[1]=A*d[1],c[2]=A*d[2],c[3]=p*d[3],c[4]=p*d[4],c[5]=p*d[5],c[6]=d[6],c[7]=d[7],c[8]=d[8],c},r.fromTranslation=function(c,d){return c[0]=1,c[1]=0,c[2]=0,c[3]=0,c[4]=1,c[5]=0,c[6]=d[0],c[7]=d[1],c[8]=1,c},r.fromRotation=function(c,d){var p=Math.sin(d);return d=Math.cos(d),c[0]=d,c[1]=p,c[2]=0,c[3]=-p,c[4]=d,c[5]=0,c[6]=0,c[7]=0,c[8]=1,c},r.fromScaling=function(c,d){return c[0]=d[0],c[1]=0,c[2]=0,c[3]=0,c[4]=d[1],c[5]=0,c[6]=0,c[7]=0,c[8]=1,c},r.fromMat2d=function(c,d){return c[0]=d[0],c[1]=d[1],c[2]=0,c[3]=d[2],c[4]=d[3],c[5]=0,c[6]=d[4],c[7]=d[5],c[8]=1,c},r.fromQuat=function(c,d){var p=d[0],A=d[1],S=d[2];d=d[3];var z=p+p,w=A+A,I=S+S;p*=z;var E=A*z;A*=w;var P=S*z,F=S*w;return S*=I,z*=d,w*=d,d*=I,c[0]=1-A-S,c[3]=E-d,c[6]=P+w,c[1]=E+d,c[4]=1-p-S,c[7]=F-z,c[2]=P-w,c[5]=F+z,c[8]=1-p-A,c},r.normalFromMat4=function(c,d){var p=d[0],A=d[1],S=d[2],z=d[3],w=d[4],I=d[5],E=d[6],P=d[7],F=d[8],X=d[9],q=d[10],J=d[11],it=d[12],lt=d[13],Mt=d[14];d=d[15];var Ct=p*I-A*w,wt=p*E-S*w,zt=p*P-z*w,Ut=A*E-S*I,Kt=A*P-z*I,Gt=S*P-z*E,Qt=F*lt-X*it,De=F*Mt-q*it;F=F*d-J*it;var re=X*Mt-q*lt;return X=X*d-J*lt,q=q*d-J*Mt,J=Ct*q-wt*X+zt*re+Ut*F-Kt*De+Gt*Qt,J?(J=1/J,c[0]=(I*q-E*X+P*re)*J,c[1]=(E*F-w*q-P*De)*J,c[2]=(w*X-I*F+P*Qt)*J,c[3]=(S*X-A*q-z*re)*J,c[4]=(p*q-S*F+z*De)*J,c[5]=(A*F-p*X-z*Qt)*J,c[6]=(lt*Gt-Mt*Kt+d*Ut)*J,c[7]=(Mt*zt-it*Gt-d*wt)*J,c[8]=(it*Kt-lt*zt+d*Ct)*J,c):null},r.projection=function(c,d,p){return c[0]=2/d,c[1]=0,c[2]=0,c[3]=0,c[4]=-2/p,c[5]=0,c[6]=-1,c[7]=1,c[8]=1,c},r.str=function(c){return"mat3("+c[0]+", "+c[1]+", "+c[2]+", "+c[3]+", "+c[4]+", "+c[5]+", "+c[6]+", "+c[7]+", "+c[8]+")"},r.frob=function(c){return Math.sqrt(Math.pow(c[0],2)+Math.pow(c[1],2)+Math.pow(c[2],2)+Math.pow(c[3],2)+Math.pow(c[4],2)+Math.pow(c[5],2)+Math.pow(c[6],2)+Math.pow(c[7],2)+Math.pow(c[8],2))},r.add=function(c,d,p){return c[0]=d[0]+p[0],c[1]=d[1]+p[1],c[2]=d[2]+p[2],c[3]=d[3]+p[3],c[4]=d[4]+p[4],c[5]=d[5]+p[5],c[6]=d[6]+p[6],c[7]=d[7]+p[7],c[8]=d[8]+p[8],c},r.subtract=s,r.multiplyScalar=function(c,d,p){return c[0]=d[0]*p,c[1]=d[1]*p,c[2]=d[2]*p,c[3]=d[3]*p,c[4]=d[4]*p,c[5]=d[5]*p,c[6]=d[6]*p,c[7]=d[7]*p,c[8]=d[8]*p,c},r.multiplyScalarAndAdd=function(c,d,p,A){return c[0]=d[0]+p[0]*A,c[1]=d[1]+p[1]*A,c[2]=d[2]+p[2]*A,c[3]=d[3]+p[3]*A,c[4]=d[4]+p[4]*A,c[5]=d[5]+p[5]*A,c[6]=d[6]+p[6]*A,c[7]=d[7]+p[7]*A,c[8]=d[8]+p[8]*A,c},r.exactEquals=function(c,d){return c[0]===d[0]&&c[1]===d[1]&&c[2]===d[2]&&c[3]===d[3]&&c[4]===d[4]&&c[5]===d[5]&&c[6]===d[6]&&c[7]===d[7]&&c[8]===d[8]},r.equals=function(c,d){var p=c[0],A=c[1],S=c[2],z=c[3],w=c[4],I=c[5],E=c[6],P=c[7];c=c[8];var F=d[0],X=d[1],q=d[2],J=d[3],it=d[4],lt=d[5],Mt=d[6],Ct=d[7];return d=d[8],Math.abs(p-F)<=f.EPSILON*Math.max(1,Math.abs(p),Math.abs(F))&&Math.abs(A-X)<=f.EPSILON*Math.max(1,Math.abs(A),Math.abs(X))&&Math.abs(S-q)<=f.EPSILON*Math.max(1,Math.abs(S),Math.abs(q))&&Math.abs(z-J)<=f.EPSILON*Math.max(1,Math.abs(z),Math.abs(J))&&Math.abs(w-it)<=f.EPSILON*Math.max(1,Math.abs(w),Math.abs(it))&&Math.abs(I-lt)<=f.EPSILON*Math.max(1,Math.abs(I),Math.abs(lt))&&Math.abs(E-Mt)<=f.EPSILON*Math.max(1,Math.abs(E),Math.abs(Mt))&&Math.abs(P-Ct)<=f.EPSILON*Math.max(1,Math.abs(P),Math.abs(Ct))&&Math.abs(c-d)<=f.EPSILON*Math.max(1,Math.abs(c),Math.abs(d))},r.sub=r.mul=void 0;var f=function(c){if(c&&c.__esModule)return c;var d={};if(c!=null){for(var p in c)if(Object.prototype.hasOwnProperty.call(c,p)){var A=On&&Xn?Xn(c,p):{};A.get||A.set?On(d,p,A):d[p]=c[p]}}return d.default=c,d}(su);r.mul=i,r.sub=s});ot(P_);var D_=ht(function(t,r){function i(p){return p[0]=1,p[1]=0,p[2]=0,p[3]=0,p[4]=0,p[5]=1,p[6]=0,p[7]=0,p[8]=0,p[9]=0,p[10]=1,p[11]=0,p[12]=0,p[13]=0,p[14]=0,p[15]=1,p}function s(p,A,S){var z=A[0],w=A[1],I=A[2],E=A[3],P=A[4],F=A[5],X=A[6],q=A[7],J=A[8],it=A[9],lt=A[10],Mt=A[11],Ct=A[12],wt=A[13],zt=A[14];A=A[15];var Ut=S[0],Kt=S[1],Gt=S[2],Qt=S[3];return p[0]=Ut*z+Kt*P+Gt*J+Qt*Ct,p[1]=Ut*w+Kt*F+Gt*it+Qt*wt,p[2]=Ut*I+Kt*X+Gt*lt+Qt*zt,p[3]=Ut*E+Kt*q+Gt*Mt+Qt*A,Ut=S[4],Kt=S[5],Gt=S[6],Qt=S[7],p[4]=Ut*z+Kt*P+Gt*J+Qt*Ct,p[5]=Ut*w+Kt*F+Gt*it+Qt*wt,p[6]=Ut*I+Kt*X+Gt*lt+Qt*zt,p[7]=Ut*E+Kt*q+Gt*Mt+Qt*A,Ut=S[8],Kt=S[9],Gt=S[10],Qt=S[11],p[8]=Ut*z+Kt*P+Gt*J+Qt*Ct,p[9]=Ut*w+Kt*F+Gt*it+Qt*wt,p[10]=Ut*I+Kt*X+Gt*lt+Qt*zt,p[11]=Ut*E+Kt*q+Gt*Mt+Qt*A,Ut=S[12],Kt=S[13],Gt=S[14],Qt=S[15],p[12]=Ut*z+Kt*P+Gt*J+Qt*Ct,p[13]=Ut*w+Kt*F+Gt*it+Qt*wt,p[14]=Ut*I+Kt*X+Gt*lt+Qt*zt,p[15]=Ut*E+Kt*q+Gt*Mt+Qt*A,p}function f(p,A,S){var z=A[0],w=A[1],I=A[2],E=A[3],P=z+z,F=w+w,X=I+I;A=z*P;var q=z*F;z*=X;var J=w*F;return w*=X,I*=X,P*=E,F*=E,E*=X,p[0]=1-(J+I),p[1]=q+E,p[2]=z-F,p[3]=0,p[4]=q-E,p[5]=1-(A+I),p[6]=w+P,p[7]=0,p[8]=z+F,p[9]=w-P,p[10]=1-(A+J),p[11]=0,p[12]=S[0],p[13]=S[1],p[14]=S[2],p[15]=1,p}function c(p,A,S){return p[0]=A[0]-S[0],p[1]=A[1]-S[1],p[2]=A[2]-S[2],p[3]=A[3]-S[3],p[4]=A[4]-S[4],p[5]=A[5]-S[5],p[6]=A[6]-S[6],p[7]=A[7]-S[7],p[8]=A[8]-S[8],p[9]=A[9]-S[9],p[10]=A[10]-S[10],p[11]=A[11]-S[11],p[12]=A[12]-S[12],p[13]=A[13]-S[13],p[14]=A[14]-S[14],p[15]=A[15]-S[15],p}Object.defineProperty(r,"__esModule",{value:!0}),r.create=function(){var p=new d.ARRAY_TYPE(16);return d.ARRAY_TYPE!=Float32Array&&(p[1]=0,p[2]=0,p[3]=0,p[4]=0,p[6]=0,p[7]=0,p[8]=0,p[9]=0,p[11]=0,p[12]=0,p[13]=0,p[14]=0),p[0]=1,p[5]=1,p[10]=1,p[15]=1,p},r.clone=function(p){var A=new d.ARRAY_TYPE(16);return A[0]=p[0],A[1]=p[1],A[2]=p[2],A[3]=p[3],A[4]=p[4],A[5]=p[5],A[6]=p[6],A[7]=p[7],A[8]=p[8],A[9]=p[9],A[10]=p[10],A[11]=p[11],A[12]=p[12],A[13]=p[13],A[14]=p[14],A[15]=p[15],A},r.copy=function(p,A){return p[0]=A[0],p[1]=A[1],p[2]=A[2],p[3]=A[3],p[4]=A[4],p[5]=A[5],p[6]=A[6],p[7]=A[7],p[8]=A[8],p[9]=A[9],p[10]=A[10],p[11]=A[11],p[12]=A[12],p[13]=A[13],p[14]=A[14],p[15]=A[15],p},r.fromValues=function(p,A,S,z,w,I,E,P,F,X,q,J,it,lt,Mt,Ct){var wt=new d.ARRAY_TYPE(16);return wt[0]=p,wt[1]=A,wt[2]=S,wt[3]=z,wt[4]=w,wt[5]=I,wt[6]=E,wt[7]=P,wt[8]=F,wt[9]=X,wt[10]=q,wt[11]=J,wt[12]=it,wt[13]=lt,wt[14]=Mt,wt[15]=Ct,wt},r.set=function(p,A,S,z,w,I,E,P,F,X,q,J,it,lt,Mt,Ct,wt){return p[0]=A,p[1]=S,p[2]=z,p[3]=w,p[4]=I,p[5]=E,p[6]=P,p[7]=F,p[8]=X,p[9]=q,p[10]=J,p[11]=it,p[12]=lt,p[13]=Mt,p[14]=Ct,p[15]=wt,p},r.identity=i,r.transpose=function(p,A){if(p===A){var S=A[1],z=A[2],w=A[3],I=A[6],E=A[7],P=A[11];p[1]=A[4],p[2]=A[8],p[3]=A[12],p[4]=S,p[6]=A[9],p[7]=A[13],p[8]=z,p[9]=I,p[11]=A[14],p[12]=w,p[13]=E,p[14]=P}else p[0]=A[0],p[1]=A[4],p[2]=A[8],p[3]=A[12],p[4]=A[1],p[5]=A[5],p[6]=A[9],p[7]=A[13],p[8]=A[2],p[9]=A[6],p[10]=A[10],p[11]=A[14],p[12]=A[3],p[13]=A[7],p[14]=A[11],p[15]=A[15];return p},r.invert=function(p,A){var S=A[0],z=A[1],w=A[2],I=A[3],E=A[4],P=A[5],F=A[6],X=A[7],q=A[8],J=A[9],it=A[10],lt=A[11],Mt=A[12],Ct=A[13],wt=A[14];A=A[15];var zt=S*P-z*E,Ut=S*F-w*E,Kt=S*X-I*E,Gt=z*F-w*P,Qt=z*X-I*P,De=w*X-I*F,re=q*Ct-J*Mt,We=q*wt-it*Mt,hr=q*A-lt*Mt,Je=J*wt-it*Ct,qr=J*A-lt*Ct,nr=it*A-lt*wt,xt=zt*nr-Ut*qr+Kt*Je+Gt*hr-Qt*We+De*re;return xt?(xt=1/xt,p[0]=(P*nr-F*qr+X*Je)*xt,p[1]=(w*qr-z*nr-I*Je)*xt,p[2]=(Ct*De-wt*Qt+A*Gt)*xt,p[3]=(it*Qt-J*De-lt*Gt)*xt,p[4]=(F*hr-E*nr-X*We)*xt,p[5]=(S*nr-w*hr+I*We)*xt,p[6]=(wt*Kt-Mt*De-A*Ut)*xt,p[7]=(q*De-it*Kt+lt*Ut)*xt,p[8]=(E*qr-P*hr+X*re)*xt,p[9]=(z*hr-S*qr-I*re)*xt,p[10]=(Mt*Qt-Ct*Kt+A*zt)*xt,p[11]=(J*Kt-q*Qt-lt*zt)*xt,p[12]=(P*We-E*Je-F*re)*xt,p[13]=(S*Je-z*We+w*re)*xt,p[14]=(Ct*Ut-Mt*Gt-wt*zt)*xt,p[15]=(q*Gt-J*Ut+it*zt)*xt,p):null},r.adjoint=function(p,A){var S=A[0],z=A[1],w=A[2],I=A[3],E=A[4],P=A[5],F=A[6],X=A[7],q=A[8],J=A[9],it=A[10],lt=A[11],Mt=A[12],Ct=A[13],wt=A[14];return A=A[15],p[0]=P*(it*A-lt*wt)-J*(F*A-X*wt)+Ct*(F*lt-X*it),p[1]=-(z*(it*A-lt*wt)-J*(w*A-I*wt)+Ct*(w*lt-I*it)),p[2]=z*(F*A-X*wt)-P*(w*A-I*wt)+Ct*(w*X-I*F),p[3]=-(z*(F*lt-X*it)-P*(w*lt-I*it)+J*(w*X-I*F)),p[4]=-(E*(it*A-lt*wt)-q*(F*A-X*wt)+Mt*(F*lt-X*it)),p[5]=S*(it*A-lt*wt)-q*(w*A-I*wt)+Mt*(w*lt-I*it),p[6]=-(S*(F*A-X*wt)-E*(w*A-I*wt)+Mt*(w*X-I*F)),p[7]=S*(F*lt-X*it)-E*(w*lt-I*it)+q*(w*X-I*F),p[8]=E*(J*A-lt*Ct)-q*(P*A-X*Ct)+Mt*(P*lt-X*J),p[9]=-(S*(J*A-lt*Ct)-q*(z*A-I*Ct)+Mt*(z*lt-I*J)),p[10]=S*(P*A-X*Ct)-E*(z*A-I*Ct)+Mt*(z*X-I*P),p[11]=-(S*(P*lt-X*J)-E*(z*lt-I*J)+q*(z*X-I*P)),p[12]=-(E*(J*wt-it*Ct)-q*(P*wt-F*Ct)+Mt*(P*it-F*J)),p[13]=S*(J*wt-it*Ct)-q*(z*wt-w*Ct)+Mt*(z*it-w*J),p[14]=-(S*(P*wt-F*Ct)-E*(z*wt-w*Ct)+Mt*(z*F-w*P)),p[15]=S*(P*it-F*J)-E*(z*it-w*J)+q*(z*F-w*P),p},r.determinant=function(p){var A=p[0],S=p[1],z=p[2],w=p[3],I=p[4],E=p[5],P=p[6],F=p[7],X=p[8],q=p[9],J=p[10],it=p[11],lt=p[12],Mt=p[13],Ct=p[14];return p=p[15],(A*E-S*I)*(J*p-it*Ct)-(A*P-z*I)*(q*p-it*Mt)+(A*F-w*I)*(q*Ct-J*Mt)+(S*P-z*E)*(X*p-it*lt)-(S*F-w*E)*(X*Ct-J*lt)+(z*F-w*P)*(X*Mt-q*lt)},r.multiply=s,r.translate=function(p,A,S){var z=S[0],w=S[1];if(S=S[2],A===p)p[12]=A[0]*z+A[4]*w+A[8]*S+A[12],p[13]=A[1]*z+A[5]*w+A[9]*S+A[13],p[14]=A[2]*z+A[6]*w+A[10]*S+A[14],p[15]=A[3]*z+A[7]*w+A[11]*S+A[15];else{var I=A[0],E=A[1],P=A[2],F=A[3],X=A[4],q=A[5],J=A[6],it=A[7],lt=A[8],Mt=A[9],Ct=A[10],wt=A[11];p[0]=I,p[1]=E,p[2]=P,p[3]=F,p[4]=X,p[5]=q,p[6]=J,p[7]=it,p[8]=lt,p[9]=Mt,p[10]=Ct,p[11]=wt,p[12]=I*z+X*w+lt*S+A[12],p[13]=E*z+q*w+Mt*S+A[13],p[14]=P*z+J*w+Ct*S+A[14],p[15]=F*z+it*w+wt*S+A[15]}return p},r.scale=function(p,A,S){var z=S[0],w=S[1];return S=S[2],p[0]=A[0]*z,p[1]=A[1]*z,p[2]=A[2]*z,p[3]=A[3]*z,p[4]=A[4]*w,p[5]=A[5]*w,p[6]=A[6]*w,p[7]=A[7]*w,p[8]=A[8]*S,p[9]=A[9]*S,p[10]=A[10]*S,p[11]=A[11]*S,p[12]=A[12],p[13]=A[13],p[14]=A[14],p[15]=A[15],p},r.rotate=function(p,A,S,z){var w=z[0],I=z[1];z=z[2];var E=Math.sqrt(w*w+I*I+z*z);if(E<d.EPSILON)return null;E=1/E,w*=E,I*=E,z*=E;var P=Math.sin(S),F=Math.cos(S),X=1-F;S=A[0],E=A[1];var q=A[2],J=A[3],it=A[4],lt=A[5],Mt=A[6],Ct=A[7],wt=A[8],zt=A[9],Ut=A[10],Kt=A[11],Gt=w*w*X+F,Qt=I*w*X+z*P,De=z*w*X-I*P,re=w*I*X-z*P,We=I*I*X+F,hr=z*I*X+w*P,Je=w*z*X+I*P;return w=I*z*X-w*P,I=z*z*X+F,p[0]=S*Gt+it*Qt+wt*De,p[1]=E*Gt+lt*Qt+zt*De,p[2]=q*Gt+Mt*Qt+Ut*De,p[3]=J*Gt+Ct*Qt+Kt*De,p[4]=S*re+it*We+wt*hr,p[5]=E*re+lt*We+zt*hr,p[6]=q*re+Mt*We+Ut*hr,p[7]=J*re+Ct*We+Kt*hr,p[8]=S*Je+it*w+wt*I,p[9]=E*Je+lt*w+zt*I,p[10]=q*Je+Mt*w+Ut*I,p[11]=J*Je+Ct*w+Kt*I,A!==p&&(p[12]=A[12],p[13]=A[13],p[14]=A[14],p[15]=A[15]),p},r.rotateX=function(p,A,S){var z=Math.sin(S);S=Math.cos(S);var w=A[4],I=A[5],E=A[6],P=A[7],F=A[8],X=A[9],q=A[10],J=A[11];return A!==p&&(p[0]=A[0],p[1]=A[1],p[2]=A[2],p[3]=A[3],p[12]=A[12],p[13]=A[13],p[14]=A[14],p[15]=A[15]),p[4]=w*S+F*z,p[5]=I*S+X*z,p[6]=E*S+q*z,p[7]=P*S+J*z,p[8]=F*S-w*z,p[9]=X*S-I*z,p[10]=q*S-E*z,p[11]=J*S-P*z,p},r.rotateY=function(p,A,S){var z=Math.sin(S);S=Math.cos(S);var w=A[0],I=A[1],E=A[2],P=A[3],F=A[8],X=A[9],q=A[10],J=A[11];return A!==p&&(p[4]=A[4],p[5]=A[5],p[6]=A[6],p[7]=A[7],p[12]=A[12],p[13]=A[13],p[14]=A[14],p[15]=A[15]),p[0]=w*S-F*z,p[1]=I*S-X*z,p[2]=E*S-q*z,p[3]=P*S-J*z,p[8]=w*z+F*S,p[9]=I*z+X*S,p[10]=E*z+q*S,p[11]=P*z+J*S,p},r.rotateZ=function(p,A,S){var z=Math.sin(S);S=Math.cos(S);var w=A[0],I=A[1],E=A[2],P=A[3],F=A[4],X=A[5],q=A[6],J=A[7];return A!==p&&(p[8]=A[8],p[9]=A[9],p[10]=A[10],p[11]=A[11],p[12]=A[12],p[13]=A[13],p[14]=A[14],p[15]=A[15]),p[0]=w*S+F*z,p[1]=I*S+X*z,p[2]=E*S+q*z,p[3]=P*S+J*z,p[4]=F*S-w*z,p[5]=X*S-I*z,p[6]=q*S-E*z,p[7]=J*S-P*z,p},r.fromTranslation=function(p,A){return p[0]=1,p[1]=0,p[2]=0,p[3]=0,p[4]=0,p[5]=1,p[6]=0,p[7]=0,p[8]=0,p[9]=0,p[10]=1,p[11]=0,p[12]=A[0],p[13]=A[1],p[14]=A[2],p[15]=1,p},r.fromScaling=function(p,A){return p[0]=A[0],p[1]=0,p[2]=0,p[3]=0,p[4]=0,p[5]=A[1],p[6]=0,p[7]=0,p[8]=0,p[9]=0,p[10]=A[2],p[11]=0,p[12]=0,p[13]=0,p[14]=0,p[15]=1,p},r.fromRotation=function(p,A,S){var z=S[0],w=S[1];S=S[2];var I=Math.sqrt(z*z+w*w+S*S);if(I<d.EPSILON)return null;I=1/I,z*=I,w*=I,S*=I,I=Math.sin(A),A=Math.cos(A);var E=1-A;return p[0]=z*z*E+A,p[1]=w*z*E+S*I,p[2]=S*z*E-w*I,p[3]=0,p[4]=z*w*E-S*I,p[5]=w*w*E+A,p[6]=S*w*E+z*I,p[7]=0,p[8]=z*S*E+w*I,p[9]=w*S*E-z*I,p[10]=S*S*E+A,p[11]=0,p[12]=0,p[13]=0,p[14]=0,p[15]=1,p},r.fromXRotation=function(p,A){var S=Math.sin(A);return A=Math.cos(A),p[0]=1,p[1]=0,p[2]=0,p[3]=0,p[4]=0,p[5]=A,p[6]=S,p[7]=0,p[8]=0,p[9]=-S,p[10]=A,p[11]=0,p[12]=0,p[13]=0,p[14]=0,p[15]=1,p},r.fromYRotation=function(p,A){var S=Math.sin(A);return A=Math.cos(A),p[0]=A,p[1]=0,p[2]=-S,p[3]=0,p[4]=0,p[5]=1,p[6]=0,p[7]=0,p[8]=S,p[9]=0,p[10]=A,p[11]=0,p[12]=0,p[13]=0,p[14]=0,p[15]=1,p},r.fromZRotation=function(p,A){var S=Math.sin(A);return A=Math.cos(A),p[0]=A,p[1]=S,p[2]=0,p[3]=0,p[4]=-S,p[5]=A,p[6]=0,p[7]=0,p[8]=0,p[9]=0,p[10]=1,p[11]=0,p[12]=0,p[13]=0,p[14]=0,p[15]=1,p},r.fromRotationTranslation=f,r.fromQuat2=function(p,A){var S=new d.ARRAY_TYPE(3),z=-A[0],w=-A[1],I=-A[2],E=A[3],P=A[4],F=A[5],X=A[6],q=A[7],J=z*z+w*w+I*I+E*E;return 0<J?(S[0]=2*(P*E+q*z+F*I-X*w)/J,S[1]=2*(F*E+q*w+X*z-P*I)/J,S[2]=2*(X*E+q*I+P*w-F*z)/J):(S[0]=2*(P*E+q*z+F*I-X*w),S[1]=2*(F*E+q*w+X*z-P*I),S[2]=2*(X*E+q*I+P*w-F*z)),f(p,A,S),p},r.getTranslation=function(p,A){return p[0]=A[12],p[1]=A[13],p[2]=A[14],p},r.getScaling=function(p,A){var S=A[0],z=A[1],w=A[2],I=A[4],E=A[5],P=A[6],F=A[8],X=A[9];return A=A[10],p[0]=Math.sqrt(S*S+z*z+w*w),p[1]=Math.sqrt(I*I+E*E+P*P),p[2]=Math.sqrt(F*F+X*X+A*A),p},r.getRotation=function(p,A){var S=A[0]+A[5]+A[10];return 0<S?(S=2*Math.sqrt(S+1),p[3]=.25*S,p[0]=(A[6]-A[9])/S,p[1]=(A[8]-A[2])/S,p[2]=(A[1]-A[4])/S):A[0]>A[5]&&A[0]>A[10]?(S=2*Math.sqrt(1+A[0]-A[5]-A[10]),p[3]=(A[6]-A[9])/S,p[0]=.25*S,p[1]=(A[1]+A[4])/S,p[2]=(A[8]+A[2])/S):A[5]>A[10]?(S=2*Math.sqrt(1+A[5]-A[0]-A[10]),p[3]=(A[8]-A[2])/S,p[0]=(A[1]+A[4])/S,p[1]=.25*S,p[2]=(A[6]+A[9])/S):(S=2*Math.sqrt(1+A[10]-A[0]-A[5]),p[3]=(A[1]-A[4])/S,p[0]=(A[8]+A[2])/S,p[1]=(A[6]+A[9])/S,p[2]=.25*S),p},r.fromRotationTranslationScale=function(p,A,S,z){var w=A[0],I=A[1],E=A[2],P=A[3],F=w+w,X=I+I,q=E+E;A=w*F;var J=w*X;w*=q;var it=I*X;I*=q,E*=q,F*=P,X*=P,P*=q,q=z[0];var lt=z[1];return z=z[2],p[0]=(1-(it+E))*q,p[1]=(J+P)*q,p[2]=(w-X)*q,p[3]=0,p[4]=(J-P)*lt,p[5]=(1-(A+E))*lt,p[6]=(I+F)*lt,p[7]=0,p[8]=(w+X)*z,p[9]=(I-F)*z,p[10]=(1-(A+it))*z,p[11]=0,p[12]=S[0],p[13]=S[1],p[14]=S[2],p[15]=1,p},r.fromRotationTranslationScaleOrigin=function(p,A,S,z,w){var I=A[0],E=A[1],P=A[2],F=A[3],X=I+I,q=E+E,J=P+P;A=I*X;var it=I*q,lt=I*J;I=E*q,E*=J;var Mt=P*J;P=F*X,q*=F;var Ct=F*J,wt=z[0],zt=z[1];J=z[2],z=w[0],F=w[1],w=w[2],X=(1-(I+Mt))*wt;var Ut=(it+Ct)*wt;return wt*=lt-q,it=(it-Ct)*zt,Mt=(1-(A+Mt))*zt,zt*=E+P,lt=(lt+q)*J,E=(E-P)*J,A=(1-(A+I))*J,p[0]=X,p[1]=Ut,p[2]=wt,p[3]=0,p[4]=it,p[5]=Mt,p[6]=zt,p[7]=0,p[8]=lt,p[9]=E,p[10]=A,p[11]=0,p[12]=S[0]+z-(X*z+it*F+lt*w),p[13]=S[1]+F-(Ut*z+Mt*F+E*w),p[14]=S[2]+w-(wt*z+zt*F+A*w),p[15]=1,p},r.fromQuat=function(p,A){var S=A[0],z=A[1],w=A[2];A=A[3];var I=S+S,E=z+z,P=w+w;S*=I;var F=z*I;z*=E;var X=w*I,q=w*E;return w*=P,I*=A,E*=A,A*=P,p[0]=1-z-w,p[1]=F+A,p[2]=X-E,p[3]=0,p[4]=F-A,p[5]=1-S-w,p[6]=q+I,p[7]=0,p[8]=X+E,p[9]=q-I,p[10]=1-S-z,p[11]=0,p[12]=0,p[13]=0,p[14]=0,p[15]=1,p},r.frustum=function(p,A,S,z,w,I,E){var P=1/(S-A),F=1/(w-z),X=1/(I-E);return p[0]=2*I*P,p[1]=0,p[2]=0,p[3]=0,p[4]=0,p[5]=2*I*F,p[6]=0,p[7]=0,p[8]=(S+A)*P,p[9]=(w+z)*F,p[10]=(E+I)*X,p[11]=-1,p[12]=0,p[13]=0,p[14]=E*I*2*X,p[15]=0,p},r.perspective=function(p,A,S,z,w){return A=1/Math.tan(A/2),p[0]=A/S,p[1]=0,p[2]=0,p[3]=0,p[4]=0,p[5]=A,p[6]=0,p[7]=0,p[8]=0,p[9]=0,p[11]=-1,p[12]=0,p[13]=0,p[15]=0,w!=null&&w!==1/0?(S=1/(z-w),p[10]=(w+z)*S,p[14]=2*w*z*S):(p[10]=-1,p[14]=-2*z),p},r.perspectiveFromFieldOfView=function(p,A,S,z){var w=Math.tan(A.upDegrees*Math.PI/180),I=Math.tan(A.downDegrees*Math.PI/180),E=Math.tan(A.leftDegrees*Math.PI/180);A=Math.tan(A.rightDegrees*Math.PI/180);var P=2/(E+A),F=2/(w+I);return p[0]=P,p[1]=0,p[2]=0,p[3]=0,p[4]=0,p[5]=F,p[6]=0,p[7]=0,p[8]=-((E-A)*P*.5),p[9]=(w-I)*F*.5,p[10]=z/(S-z),p[11]=-1,p[12]=0,p[13]=0,p[14]=z*S/(S-z),p[15]=0,p},r.ortho=function(p,A,S,z,w,I,E){var P=1/(A-S),F=1/(z-w),X=1/(I-E);return p[0]=-2*P,p[1]=0,p[2]=0,p[3]=0,p[4]=0,p[5]=-2*F,p[6]=0,p[7]=0,p[8]=0,p[9]=0,p[10]=2*X,p[11]=0,p[12]=(A+S)*P,p[13]=(w+z)*F,p[14]=(E+I)*X,p[15]=1,p},r.lookAt=function(p,A,S,z){var w=A[0],I=A[1];A=A[2];var E=z[0],P=z[1],F=z[2],X=S[0];z=S[1];var q=S[2];if(Math.abs(w-X)<d.EPSILON&&Math.abs(I-z)<d.EPSILON&&Math.abs(A-q)<d.EPSILON)return i(p);S=w-X,z=I-z,X=A-q;var J=1/Math.sqrt(S*S+z*z+X*X);S*=J,z*=J,X*=J,q=P*X-F*z,F=F*S-E*X,E=E*z-P*S,(J=Math.sqrt(q*q+F*F+E*E))?(J=1/J,q*=J,F*=J,E*=J):E=F=q=0,P=z*E-X*F;var it=X*q-S*E,lt=S*F-z*q;return(J=Math.sqrt(P*P+it*it+lt*lt))?(J=1/J,P*=J,it*=J,lt*=J):lt=it=P=0,p[0]=q,p[1]=P,p[2]=S,p[3]=0,p[4]=F,p[5]=it,p[6]=z,p[7]=0,p[8]=E,p[9]=lt,p[10]=X,p[11]=0,p[12]=-(q*w+F*I+E*A),p[13]=-(P*w+it*I+lt*A),p[14]=-(S*w+z*I+X*A),p[15]=1,p},r.targetTo=function(p,A,S,z){var w=A[0],I=A[1];A=A[2];var E=z[0],P=z[1],F=z[2];z=w-S[0];var X=I-S[1];S=A-S[2];var q=z*z+X*X+S*S;0<q&&(q=1/Math.sqrt(q),z*=q,X*=q,S*=q);var J=P*S-F*X;return F=F*z-E*S,E=E*X-P*z,q=J*J+F*F+E*E,0<q&&(q=1/Math.sqrt(q),J*=q,F*=q,E*=q),p[0]=J,p[1]=F,p[2]=E,p[3]=0,p[4]=X*E-S*F,p[5]=S*J-z*E,p[6]=z*F-X*J,p[7]=0,p[8]=z,p[9]=X,p[10]=S,p[11]=0,p[12]=w,p[13]=I,p[14]=A,p[15]=1,p},r.str=function(p){return"mat4("+p[0]+", "+p[1]+", "+p[2]+", "+p[3]+", "+p[4]+", "+p[5]+", "+p[6]+", "+p[7]+", "+p[8]+", "+p[9]+", "+p[10]+", "+p[11]+", "+p[12]+", "+p[13]+", "+p[14]+", "+p[15]+")"},r.frob=function(p){return Math.sqrt(Math.pow(p[0],2)+Math.pow(p[1],2)+Math.pow(p[2],2)+Math.pow(p[3],2)+Math.pow(p[4],2)+Math.pow(p[5],2)+Math.pow(p[6],2)+Math.pow(p[7],2)+Math.pow(p[8],2)+Math.pow(p[9],2)+Math.pow(p[10],2)+Math.pow(p[11],2)+Math.pow(p[12],2)+Math.pow(p[13],2)+Math.pow(p[14],2)+Math.pow(p[15],2))},r.add=function(p,A,S){return p[0]=A[0]+S[0],p[1]=A[1]+S[1],p[2]=A[2]+S[2],p[3]=A[3]+S[3],p[4]=A[4]+S[4],p[5]=A[5]+S[5],p[6]=A[6]+S[6],p[7]=A[7]+S[7],p[8]=A[8]+S[8],p[9]=A[9]+S[9],p[10]=A[10]+S[10],p[11]=A[11]+S[11],p[12]=A[12]+S[12],p[13]=A[13]+S[13],p[14]=A[14]+S[14],p[15]=A[15]+S[15],p},r.subtract=c,r.multiplyScalar=function(p,A,S){return p[0]=A[0]*S,p[1]=A[1]*S,p[2]=A[2]*S,p[3]=A[3]*S,p[4]=A[4]*S,p[5]=A[5]*S,p[6]=A[6]*S,p[7]=A[7]*S,p[8]=A[8]*S,p[9]=A[9]*S,p[10]=A[10]*S,p[11]=A[11]*S,p[12]=A[12]*S,p[13]=A[13]*S,p[14]=A[14]*S,p[15]=A[15]*S,p},r.multiplyScalarAndAdd=function(p,A,S,z){return p[0]=A[0]+S[0]*z,p[1]=A[1]+S[1]*z,p[2]=A[2]+S[2]*z,p[3]=A[3]+S[3]*z,p[4]=A[4]+S[4]*z,p[5]=A[5]+S[5]*z,p[6]=A[6]+S[6]*z,p[7]=A[7]+S[7]*z,p[8]=A[8]+S[8]*z,p[9]=A[9]+S[9]*z,p[10]=A[10]+S[10]*z,p[11]=A[11]+S[11]*z,p[12]=A[12]+S[12]*z,p[13]=A[13]+S[13]*z,p[14]=A[14]+S[14]*z,p[15]=A[15]+S[15]*z,p},r.exactEquals=function(p,A){return p[0]===A[0]&&p[1]===A[1]&&p[2]===A[2]&&p[3]===A[3]&&p[4]===A[4]&&p[5]===A[5]&&p[6]===A[6]&&p[7]===A[7]&&p[8]===A[8]&&p[9]===A[9]&&p[10]===A[10]&&p[11]===A[11]&&p[12]===A[12]&&p[13]===A[13]&&p[14]===A[14]&&p[15]===A[15]},r.equals=function(p,A){var S=p[0],z=p[1],w=p[2],I=p[3],E=p[4],P=p[5],F=p[6],X=p[7],q=p[8],J=p[9],it=p[10],lt=p[11],Mt=p[12],Ct=p[13],wt=p[14];p=p[15];var zt=A[0],Ut=A[1],Kt=A[2],Gt=A[3],Qt=A[4],De=A[5],re=A[6],We=A[7],hr=A[8],Je=A[9],qr=A[10],nr=A[11],xt=A[12],At=A[13],_t=A[14];return A=A[15],Math.abs(S-zt)<=d.EPSILON*Math.max(1,Math.abs(S),Math.abs(zt))&&Math.abs(z-Ut)<=d.EPSILON*Math.max(1,Math.abs(z),Math.abs(Ut))&&Math.abs(w-Kt)<=d.EPSILON*Math.max(1,Math.abs(w),Math.abs(Kt))&&Math.abs(I-Gt)<=d.EPSILON*Math.max(1,Math.abs(I),Math.abs(Gt))&&Math.abs(E-Qt)<=d.EPSILON*Math.max(1,Math.abs(E),Math.abs(Qt))&&Math.abs(P-De)<=d.EPSILON*Math.max(1,Math.abs(P),Math.abs(De))&&Math.abs(F-re)<=d.EPSILON*Math.max(1,Math.abs(F),Math.abs(re))&&Math.abs(X-We)<=d.EPSILON*Math.max(1,Math.abs(X),Math.abs(We))&&Math.abs(q-hr)<=d.EPSILON*Math.max(1,Math.abs(q),Math.abs(hr))&&Math.abs(J-Je)<=d.EPSILON*Math.max(1,Math.abs(J),Math.abs(Je))&&Math.abs(it-qr)<=d.EPSILON*Math.max(1,Math.abs(it),Math.abs(qr))&&Math.abs(lt-nr)<=d.EPSILON*Math.max(1,Math.abs(lt),Math.abs(nr))&&Math.abs(Mt-xt)<=d.EPSILON*Math.max(1,Math.abs(Mt),Math.abs(xt))&&Math.abs(Ct-At)<=d.EPSILON*Math.max(1,Math.abs(Ct),Math.abs(At))&&Math.abs(wt-_t)<=d.EPSILON*Math.max(1,Math.abs(wt),Math.abs(_t))&&Math.abs(p-A)<=d.EPSILON*Math.max(1,Math.abs(p),Math.abs(A))},r.sub=r.mul=void 0;var d=function(p){if(p&&p.__esModule)return p;var A={};if(p!=null){for(var S in p)if(Object.prototype.hasOwnProperty.call(p,S)){var z=On&&Xn?Xn(p,S):{};z.get||z.set?On(A,S,z):A[S]=p[S]}}return A.default=p,A}(su);r.mul=s,r.sub=c});ot(D_);var O_=ht(function(t,r){function i(){var P=new E.ARRAY_TYPE(3);return E.ARRAY_TYPE!=Float32Array&&(P[0]=0,P[1]=0,P[2]=0),P}function s(P){var F=P[0],X=P[1];return P=P[2],Math.sqrt(F*F+X*X+P*P)}function f(P,F,X){var q=new E.ARRAY_TYPE(3);return q[0]=P,q[1]=F,q[2]=X,q}function c(P,F,X){return P[0]=F[0]-X[0],P[1]=F[1]-X[1],P[2]=F[2]-X[2],P}function d(P,F,X){return P[0]=F[0]*X[0],P[1]=F[1]*X[1],P[2]=F[2]*X[2],P}function p(P,F,X){return P[0]=F[0]/X[0],P[1]=F[1]/X[1],P[2]=F[2]/X[2],P}function A(P,F){var X=F[0]-P[0],q=F[1]-P[1];return P=F[2]-P[2],Math.sqrt(X*X+q*q+P*P)}function S(P,F){var X=F[0]-P[0],q=F[1]-P[1];return P=F[2]-P[2],X*X+q*q+P*P}function z(P){var F=P[0],X=P[1];return P=P[2],F*F+X*X+P*P}function w(P,F){var X=F[0],q=F[1],J=F[2];return X=X*X+q*q+J*J,0<X&&(X=1/Math.sqrt(X)),P[0]=F[0]*X,P[1]=F[1]*X,P[2]=F[2]*X,P}function I(P,F){return P[0]*F[0]+P[1]*F[1]+P[2]*F[2]}Object.defineProperty(r,"__esModule",{value:!0}),r.create=i,r.clone=function(P){var F=new E.ARRAY_TYPE(3);return F[0]=P[0],F[1]=P[1],F[2]=P[2],F},r.length=s,r.fromValues=f,r.copy=function(P,F){return P[0]=F[0],P[1]=F[1],P[2]=F[2],P},r.set=function(P,F,X,q){return P[0]=F,P[1]=X,P[2]=q,P},r.add=function(P,F,X){return P[0]=F[0]+X[0],P[1]=F[1]+X[1],P[2]=F[2]+X[2],P},r.subtract=c,r.multiply=d,r.divide=p,r.ceil=function(P,F){return P[0]=Math.ceil(F[0]),P[1]=Math.ceil(F[1]),P[2]=Math.ceil(F[2]),P},r.floor=function(P,F){return P[0]=Math.floor(F[0]),P[1]=Math.floor(F[1]),P[2]=Math.floor(F[2]),P},r.min=function(P,F,X){return P[0]=Math.min(F[0],X[0]),P[1]=Math.min(F[1],X[1]),P[2]=Math.min(F[2],X[2]),P},r.max=function(P,F,X){return P[0]=Math.max(F[0],X[0]),P[1]=Math.max(F[1],X[1]),P[2]=Math.max(F[2],X[2]),P},r.round=function(P,F){return P[0]=Math.round(F[0]),P[1]=Math.round(F[1]),P[2]=Math.round(F[2]),P},r.scale=function(P,F,X){return P[0]=F[0]*X,P[1]=F[1]*X,P[2]=F[2]*X,P},r.scaleAndAdd=function(P,F,X,q){return P[0]=F[0]+X[0]*q,P[1]=F[1]+X[1]*q,P[2]=F[2]+X[2]*q,P},r.distance=A,r.squaredDistance=S,r.squaredLength=z,r.negate=function(P,F){return P[0]=-F[0],P[1]=-F[1],P[2]=-F[2],P},r.inverse=function(P,F){return P[0]=1/F[0],P[1]=1/F[1],P[2]=1/F[2],P},r.normalize=w,r.dot=I,r.cross=function(P,F,X){var q=F[0],J=F[1];F=F[2];var it=X[0],lt=X[1];return X=X[2],P[0]=J*X-F*lt,P[1]=F*it-q*X,P[2]=q*lt-J*it,P},r.lerp=function(P,F,X,q){var J=F[0],it=F[1];return F=F[2],P[0]=J+q*(X[0]-J),P[1]=it+q*(X[1]-it),P[2]=F+q*(X[2]-F),P},r.hermite=function(P,F,X,q,J,it){var lt=it*it,Mt=lt*(2*it-3)+1,Ct=lt*(it-2)+it,wt=lt*(it-1);return it=lt*(3-2*it),P[0]=F[0]*Mt+X[0]*Ct+q[0]*wt+J[0]*it,P[1]=F[1]*Mt+X[1]*Ct+q[1]*wt+J[1]*it,P[2]=F[2]*Mt+X[2]*Ct+q[2]*wt+J[2]*it,P},r.bezier=function(P,F,X,q,J,it){var lt=1-it,Mt=lt*lt,Ct=it*it,wt=Mt*lt;return Mt*=3*it,lt*=3*Ct,it*=Ct,P[0]=F[0]*wt+X[0]*Mt+q[0]*lt+J[0]*it,P[1]=F[1]*wt+X[1]*Mt+q[1]*lt+J[1]*it,P[2]=F[2]*wt+X[2]*Mt+q[2]*lt+J[2]*it,P},r.random=function(P,F){F=F||1;var X=2*E.RANDOM()*Math.PI,q=2*E.RANDOM()-1,J=Math.sqrt(1-q*q)*F;return P[0]=Math.cos(X)*J,P[1]=Math.sin(X)*J,P[2]=q*F,P},r.transformMat4=function(P,F,X){var q=F[0],J=F[1];F=F[2];var it=X[3]*q+X[7]*J+X[11]*F+X[15];return it=it||1,P[0]=(X[0]*q+X[4]*J+X[8]*F+X[12])/it,P[1]=(X[1]*q+X[5]*J+X[9]*F+X[13])/it,P[2]=(X[2]*q+X[6]*J+X[10]*F+X[14])/it,P},r.transformMat3=function(P,F,X){var q=F[0],J=F[1];return F=F[2],P[0]=q*X[0]+J*X[3]+F*X[6],P[1]=q*X[1]+J*X[4]+F*X[7],P[2]=q*X[2]+J*X[5]+F*X[8],P},r.transformQuat=function(P,F,X){var q=X[0],J=X[1],it=X[2],lt=F[0],Mt=F[1];F=F[2];var Ct=J*F-it*Mt,wt=it*lt-q*F,zt=q*Mt-J*lt;return X=2*X[3],P[0]=lt+Ct*X+2*(J*zt-it*wt),P[1]=Mt+wt*X+2*(it*Ct-q*zt),P[2]=F+zt*X+2*(q*wt-J*Ct),P},r.rotateX=function(P,F,X,q){var J=[],it=[];return J[0]=F[0]-X[0],J[1]=F[1]-X[1],J[2]=F[2]-X[2],it[0]=J[0],it[1]=J[1]*Math.cos(q)-J[2]*Math.sin(q),it[2]=J[1]*Math.sin(q)+J[2]*Math.cos(q),P[0]=it[0]+X[0],P[1]=it[1]+X[1],P[2]=it[2]+X[2],P},r.rotateY=function(P,F,X,q){var J=[],it=[];return J[0]=F[0]-X[0],J[1]=F[1]-X[1],J[2]=F[2]-X[2],it[0]=J[2]*Math.sin(q)+J[0]*Math.cos(q),it[1]=J[1],it[2]=J[2]*Math.cos(q)-J[0]*Math.sin(q),P[0]=it[0]+X[0],P[1]=it[1]+X[1],P[2]=it[2]+X[2],P},r.rotateZ=function(P,F,X,q){var J=[],it=[];return J[0]=F[0]-X[0],J[1]=F[1]-X[1],J[2]=F[2]-X[2],it[0]=J[0]*Math.cos(q)-J[1]*Math.sin(q),it[1]=J[0]*Math.sin(q)+J[1]*Math.cos(q),it[2]=J[2],P[0]=it[0]+X[0],P[1]=it[1]+X[1],P[2]=it[2]+X[2],P},r.angle=function(P,F){return P=f(P[0],P[1],P[2]),F=f(F[0],F[1],F[2]),w(P,P),w(F,F),F=I(P,F),1<F?0:-1>F?Math.PI:Math.acos(F)},r.zero=function(P){return P[0]=0,P[1]=0,P[2]=0,P},r.str=function(P){return"vec3("+P[0]+", "+P[1]+", "+P[2]+")"},r.exactEquals=function(P,F){return P[0]===F[0]&&P[1]===F[1]&&P[2]===F[2]},r.equals=function(P,F){var X=P[0],q=P[1];P=P[2];var J=F[0],it=F[1];return F=F[2],Math.abs(X-J)<=E.EPSILON*Math.max(1,Math.abs(X),Math.abs(J))&&Math.abs(q-it)<=E.EPSILON*Math.max(1,Math.abs(q),Math.abs(it))&&Math.abs(P-F)<=E.EPSILON*Math.max(1,Math.abs(P),Math.abs(F))},r.forEach=r.sqrLen=r.len=r.sqrDist=r.dist=r.div=r.mul=r.sub=void 0;var E=function(P){if(P&&P.__esModule)return P;var F={};if(P!=null){for(var X in P)if(Object.prototype.hasOwnProperty.call(P,X)){var q=On&&Xn?Xn(P,X):{};q.get||q.set?On(F,X,q):F[X]=P[X]}}return F.default=P,F}(su);r.sub=c,r.mul=d,r.div=p,r.dist=A,r.sqrDist=S,r.len=s,r.sqrLen=z,t=function(){var P=i();return function(F,X,q,J,it,lt){for(X||(X=3),q||(q=0),J=J?Math.min(J*X+q,F.length):F.length;q<J;q+=X)P[0]=F[q],P[1]=F[q+1],P[2]=F[q+2],it(P,P,lt),F[q]=P[0],F[q+1]=P[1],F[q+2]=P[2];return F}}(),r.forEach=t});ot(O_);var F_=ht(function(t,r){function i(){var w=new z.ARRAY_TYPE(4);return z.ARRAY_TYPE!=Float32Array&&(w[0]=0,w[1]=0,w[2]=0,w[3]=0),w}function s(w,I,E){return w[0]=I[0]-E[0],w[1]=I[1]-E[1],w[2]=I[2]-E[2],w[3]=I[3]-E[3],w}function f(w,I,E){return w[0]=I[0]*E[0],w[1]=I[1]*E[1],w[2]=I[2]*E[2],w[3]=I[3]*E[3],w}function c(w,I,E){return w[0]=I[0]/E[0],w[1]=I[1]/E[1],w[2]=I[2]/E[2],w[3]=I[3]/E[3],w}function d(w,I){var E=I[0]-w[0],P=I[1]-w[1],F=I[2]-w[2];return w=I[3]-w[3],Math.sqrt(E*E+P*P+F*F+w*w)}function p(w,I){var E=I[0]-w[0],P=I[1]-w[1],F=I[2]-w[2];return w=I[3]-w[3],E*E+P*P+F*F+w*w}function A(w){var I=w[0],E=w[1],P=w[2];return w=w[3],Math.sqrt(I*I+E*E+P*P+w*w)}function S(w){var I=w[0],E=w[1],P=w[2];return w=w[3],I*I+E*E+P*P+w*w}Object.defineProperty(r,"__esModule",{value:!0}),r.create=i,r.clone=function(w){var I=new z.ARRAY_TYPE(4);return I[0]=w[0],I[1]=w[1],I[2]=w[2],I[3]=w[3],I},r.fromValues=function(w,I,E,P){var F=new z.ARRAY_TYPE(4);return F[0]=w,F[1]=I,F[2]=E,F[3]=P,F},r.copy=function(w,I){return w[0]=I[0],w[1]=I[1],w[2]=I[2],w[3]=I[3],w},r.set=function(w,I,E,P,F){return w[0]=I,w[1]=E,w[2]=P,w[3]=F,w},r.add=function(w,I,E){return w[0]=I[0]+E[0],w[1]=I[1]+E[1],w[2]=I[2]+E[2],w[3]=I[3]+E[3],w},r.subtract=s,r.multiply=f,r.divide=c,r.ceil=function(w,I){return w[0]=Math.ceil(I[0]),w[1]=Math.ceil(I[1]),w[2]=Math.ceil(I[2]),w[3]=Math.ceil(I[3]),w},r.floor=function(w,I){return w[0]=Math.floor(I[0]),w[1]=Math.floor(I[1]),w[2]=Math.floor(I[2]),w[3]=Math.floor(I[3]),w},r.min=function(w,I,E){return w[0]=Math.min(I[0],E[0]),w[1]=Math.min(I[1],E[1]),w[2]=Math.min(I[2],E[2]),w[3]=Math.min(I[3],E[3]),w},r.max=function(w,I,E){return w[0]=Math.max(I[0],E[0]),w[1]=Math.max(I[1],E[1]),w[2]=Math.max(I[2],E[2]),w[3]=Math.max(I[3],E[3]),w},r.round=function(w,I){return w[0]=Math.round(I[0]),w[1]=Math.round(I[1]),w[2]=Math.round(I[2]),w[3]=Math.round(I[3]),w},r.scale=function(w,I,E){return w[0]=I[0]*E,w[1]=I[1]*E,w[2]=I[2]*E,w[3]=I[3]*E,w},r.scaleAndAdd=function(w,I,E,P){return w[0]=I[0]+E[0]*P,w[1]=I[1]+E[1]*P,w[2]=I[2]+E[2]*P,w[3]=I[3]+E[3]*P,w},r.distance=d,r.squaredDistance=p,r.length=A,r.squaredLength=S,r.negate=function(w,I){return w[0]=-I[0],w[1]=-I[1],w[2]=-I[2],w[3]=-I[3],w},r.inverse=function(w,I){return w[0]=1/I[0],w[1]=1/I[1],w[2]=1/I[2],w[3]=1/I[3],w},r.normalize=function(w,I){var E=I[0],P=I[1],F=I[2];I=I[3];var X=E*E+P*P+F*F+I*I;return 0<X&&(X=1/Math.sqrt(X)),w[0]=E*X,w[1]=P*X,w[2]=F*X,w[3]=I*X,w},r.dot=function(w,I){return w[0]*I[0]+w[1]*I[1]+w[2]*I[2]+w[3]*I[3]},r.cross=function(w,I,E,P){var F=E[0]*P[1]-E[1]*P[0],X=E[0]*P[2]-E[2]*P[0],q=E[0]*P[3]-E[3]*P[0],J=E[1]*P[2]-E[2]*P[1],it=E[1]*P[3]-E[3]*P[1];E=E[2]*P[3]-E[3]*P[2],P=I[0];var lt=I[1],Mt=I[2];return I=I[3],w[0]=lt*E-Mt*it+I*J,w[1]=-(P*E)+Mt*q-I*X,w[2]=P*it-lt*q+I*F,w[3]=-(P*J)+lt*X-Mt*F,w},r.lerp=function(w,I,E,P){var F=I[0],X=I[1],q=I[2];return I=I[3],w[0]=F+P*(E[0]-F),w[1]=X+P*(E[1]-X),w[2]=q+P*(E[2]-q),w[3]=I+P*(E[3]-I),w},r.random=function(w,I){I=I||1;do var E=2*z.RANDOM()-1,P=2*z.RANDOM()-1,F=E*E+P*P;while(1<=F);do var X=2*z.RANDOM()-1,q=2*z.RANDOM()-1,J=X*X+q*q;while(1<=J);return F=Math.sqrt((1-F)/J),w[0]=I*E,w[1]=I*P,w[2]=I*X*F,w[3]=I*q*F,w},r.transformMat4=function(w,I,E){var P=I[0],F=I[1],X=I[2];return I=I[3],w[0]=E[0]*P+E[4]*F+E[8]*X+E[12]*I,w[1]=E[1]*P+E[5]*F+E[9]*X+E[13]*I,w[2]=E[2]*P+E[6]*F+E[10]*X+E[14]*I,w[3]=E[3]*P+E[7]*F+E[11]*X+E[15]*I,w},r.transformQuat=function(w,I,E){var P=I[0],F=I[1],X=I[2],q=E[0],J=E[1],it=E[2];E=E[3];var lt=E*P+J*X-it*F,Mt=E*F+it*P-q*X,Ct=E*X+q*F-J*P;return P=-q*P-J*F-it*X,w[0]=lt*E+P*-q+Mt*-it-Ct*-J,w[1]=Mt*E+P*-J+Ct*-q-lt*-it,w[2]=Ct*E+P*-it+lt*-J-Mt*-q,w[3]=I[3],w},r.zero=function(w){return w[0]=0,w[1]=0,w[2]=0,w[3]=0,w},r.str=function(w){return"vec4("+w[0]+", "+w[1]+", "+w[2]+", "+w[3]+")"},r.exactEquals=function(w,I){return w[0]===I[0]&&w[1]===I[1]&&w[2]===I[2]&&w[3]===I[3]},r.equals=function(w,I){var E=w[0],P=w[1],F=w[2];w=w[3];var X=I[0],q=I[1],J=I[2];return I=I[3],Math.abs(E-X)<=z.EPSILON*Math.max(1,Math.abs(E),Math.abs(X))&&Math.abs(P-q)<=z.EPSILON*Math.max(1,Math.abs(P),Math.abs(q))&&Math.abs(F-J)<=z.EPSILON*Math.max(1,Math.abs(F),Math.abs(J))&&Math.abs(w-I)<=z.EPSILON*Math.max(1,Math.abs(w),Math.abs(I))},r.forEach=r.sqrLen=r.len=r.sqrDist=r.dist=r.div=r.mul=r.sub=void 0;var z=function(w){if(w&&w.__esModule)return w;var I={};if(w!=null){for(var E in w)if(Object.prototype.hasOwnProperty.call(w,E)){var P=On&&Xn?Xn(w,E):{};P.get||P.set?On(I,E,P):I[E]=w[E]}}return I.default=w,I}(su);r.sub=s,r.mul=f,r.div=c,r.dist=d,r.sqrDist=p,r.len=A,r.sqrLen=S,t=function(){var w=i();return function(I,E,P,F,X,q){for(E||(E=4),P||(P=0),F=F?Math.min(F*E+P,I.length):I.length;P<F;P+=E)w[0]=I[P],w[1]=I[P+1],w[2]=I[P+2],w[3]=I[P+3],X(w,w,q),I[P]=w[0],I[P+1]=w[1],I[P+2]=w[2],I[P+3]=w[3];return I}}(),r.forEach=t});ot(F_);var B_=ht(function(t,r){function i(E){if(E&&E.__esModule)return E;var P={};if(E!=null){for(var F in E)if(Object.prototype.hasOwnProperty.call(E,F)){var X=On&&Xn?Xn(E,F):{};X.get||X.set?On(P,F,X):P[F]=E[F]}}return P.default=E,P}function s(){var E=new A.ARRAY_TYPE(4);return A.ARRAY_TYPE!=Float32Array&&(E[0]=0,E[1]=0,E[2]=0),E[3]=1,E}function f(E,P,F){F*=.5;var X=Math.sin(F);return E[0]=X*P[0],E[1]=X*P[1],E[2]=X*P[2],E[3]=Math.cos(F),E}function c(E,P,F){var X=P[0],q=P[1],J=P[2];P=P[3];var it=F[0],lt=F[1],Mt=F[2];return F=F[3],E[0]=X*F+P*it+q*Mt-J*lt,E[1]=q*F+P*lt+J*it-X*Mt,E[2]=J*F+P*Mt+X*lt-q*it,E[3]=P*F-X*it-q*lt-J*Mt,E}function d(E,P,F,X){var q=P[0],J=P[1],it=P[2];P=P[3];var lt=F[0],Mt=F[1],Ct=F[2];F=F[3];var wt=q*lt+J*Mt+it*Ct+P*F;if(0>wt&&(wt=-wt,lt=-lt,Mt=-Mt,Ct=-Ct,F=-F),1-wt>A.EPSILON){var zt=Math.acos(wt),Ut=Math.sin(zt);wt=Math.sin((1-X)*zt)/Ut,X=Math.sin(X*zt)/Ut}else wt=1-X;return E[0]=wt*q+X*lt,E[1]=wt*J+X*Mt,E[2]=wt*it+X*Ct,E[3]=wt*P+X*F,E}function p(E,P){var F=P[0]+P[4]+P[8];if(0<F)F=Math.sqrt(F+1),E[3]=.5*F,F=.5/F,E[0]=(P[5]-P[7])*F,E[1]=(P[6]-P[2])*F,E[2]=(P[1]-P[3])*F;else{var X=0;P[4]>P[0]&&(X=1),P[8]>P[3*X+X]&&(X=2);var q=(X+1)%3,J=(X+2)%3;F=Math.sqrt(P[3*X+X]-P[3*q+q]-P[3*J+J]+1),E[X]=.5*F,F=.5/F,E[3]=(P[3*q+J]-P[3*J+q])*F,E[q]=(P[3*q+X]+P[3*X+q])*F,E[J]=(P[3*J+X]+P[3*X+J])*F}return E}Object.defineProperty(r,"__esModule",{value:!0}),r.create=s,r.identity=function(E){return E[0]=0,E[1]=0,E[2]=0,E[3]=1,E},r.setAxisAngle=f,r.getAxisAngle=function(E,P){var F=2*Math.acos(P[3]),X=Math.sin(F/2);return X>A.EPSILON?(E[0]=P[0]/X,E[1]=P[1]/X,E[2]=P[2]/X):(E[0]=1,E[1]=0,E[2]=0),F},r.multiply=c,r.rotateX=function(E,P,F){F*=.5;var X=P[0],q=P[1],J=P[2];P=P[3];var it=Math.sin(F);return F=Math.cos(F),E[0]=X*F+P*it,E[1]=q*F+J*it,E[2]=J*F-q*it,E[3]=P*F-X*it,E},r.rotateY=function(E,P,F){F*=.5;var X=P[0],q=P[1],J=P[2];P=P[3];var it=Math.sin(F);return F=Math.cos(F),E[0]=X*F-J*it,E[1]=q*F+P*it,E[2]=J*F+X*it,E[3]=P*F-q*it,E},r.rotateZ=function(E,P,F){F*=.5;var X=P[0],q=P[1],J=P[2];P=P[3];var it=Math.sin(F);return F=Math.cos(F),E[0]=X*F+q*it,E[1]=q*F-X*it,E[2]=J*F+P*it,E[3]=P*F-J*it,E},r.calculateW=function(E,P){var F=P[0],X=P[1];return P=P[2],E[0]=F,E[1]=X,E[2]=P,E[3]=Math.sqrt(Math.abs(1-F*F-X*X-P*P)),E},r.slerp=d,r.random=function(E){var P=A.RANDOM(),F=A.RANDOM(),X=A.RANDOM(),q=Math.sqrt(1-P);return P=Math.sqrt(P),E[0]=q*Math.sin(2*Math.PI*F),E[1]=q*Math.cos(2*Math.PI*F),E[2]=P*Math.sin(2*Math.PI*X),E[3]=P*Math.cos(2*Math.PI*X),E},r.invert=function(E,P){var F=P[0],X=P[1],q=P[2];P=P[3];var J=F*F+X*X+q*q+P*P;return J=J?1/J:0,E[0]=-F*J,E[1]=-X*J,E[2]=-q*J,E[3]=P*J,E},r.conjugate=function(E,P){return E[0]=-P[0],E[1]=-P[1],E[2]=-P[2],E[3]=P[3],E},r.fromMat3=p,r.fromEuler=function(E,P,F,X){var q=.5*Math.PI/180;P*=q,F*=q,X*=q,q=Math.sin(P),P=Math.cos(P);var J=Math.sin(F);F=Math.cos(F);var it=Math.sin(X);return X=Math.cos(X),E[0]=q*F*X-P*J*it,E[1]=P*J*X+q*F*it,E[2]=P*F*it-q*J*X,E[3]=P*F*X+q*J*it,E},r.str=function(E){return"quat("+E[0]+", "+E[1]+", "+E[2]+", "+E[3]+")"},r.setAxes=r.sqlerp=r.rotationTo=r.equals=r.exactEquals=r.normalize=r.sqrLen=r.squaredLength=r.len=r.length=r.lerp=r.dot=r.scale=r.mul=r.add=r.set=r.copy=r.fromValues=r.clone=void 0;var A=i(su),S=i(P_),z=i(O_);t=i(F_),r.clone=t.clone,r.fromValues=t.fromValues,r.copy=t.copy,r.set=t.set,r.add=t.add,r.mul=c,r.scale=t.scale,r.dot=t.dot,r.lerp=t.lerp;var w=t.length;r.length=w,r.len=w,w=t.squaredLength,r.squaredLength=w,r.sqrLen=w;var I=t.normalize;r.normalize=I,r.exactEquals=t.exactEquals,r.equals=t.equals,t=function(){var E=z.create(),P=z.fromValues(1,0,0),F=z.fromValues(0,1,0);return function(X,q,J){var it=z.dot(q,J);return-.999999>it?(z.cross(E,P,q),1e-6>z.len(E)&&z.cross(E,F,q),z.normalize(E,E),f(X,E,Math.PI),X):.999999<it?(X[0]=0,X[1]=0,X[2]=0,X[3]=1,X):(z.cross(E,q,J),X[0]=E[0],X[1]=E[1],X[2]=E[2],X[3]=1+it,I(X,X))}}(),r.rotationTo=t,t=function(){var E=s(),P=s();return function(F,X,q,J,it,lt){return d(E,X,it,lt),d(P,q,J,lt),d(F,E,P,2*lt*(1-lt)),F}}(),r.sqlerp=t,t=function(){var E=S.create();return function(P,F,X,q){return E[0]=X[0],E[3]=X[1],E[6]=X[2],E[1]=q[0],E[4]=q[1],E[7]=q[2],E[2]=-F[0],E[5]=-F[1],E[8]=-F[2],I(P,p(P,E))}}(),r.setAxes=t});ot(B_);var y3=ht(function(t,r){function i(w){if(w&&w.__esModule)return w;var I={};if(w!=null){for(var E in w)if(Object.prototype.hasOwnProperty.call(w,E)){var P=On&&Xn?Xn(w,E):{};P.get||P.set?On(I,E,P):I[E]=w[E]}}return I.default=w,I}function s(w,I,E){var P=.5*E[0],F=.5*E[1];E=.5*E[2];var X=I[0],q=I[1],J=I[2];return I=I[3],w[0]=X,w[1]=q,w[2]=J,w[3]=I,w[4]=P*I+F*J-E*q,w[5]=F*I+E*X-P*J,w[6]=E*I+P*q-F*X,w[7]=-P*X-F*q-E*J,w}function f(w,I){return w[0]=I[0],w[1]=I[1],w[2]=I[2],w[3]=I[3],w[4]=I[4],w[5]=I[5],w[6]=I[6],w[7]=I[7],w}function c(w,I,E){var P=I[0],F=I[1],X=I[2],q=I[3],J=E[4],it=E[5],lt=E[6],Mt=E[7],Ct=I[4],wt=I[5],zt=I[6];I=I[7];var Ut=E[0],Kt=E[1],Gt=E[2];return E=E[3],w[0]=P*E+q*Ut+F*Gt-X*Kt,w[1]=F*E+q*Kt+X*Ut-P*Gt,w[2]=X*E+q*Gt+P*Kt-F*Ut,w[3]=q*E-P*Ut-F*Kt-X*Gt,w[4]=P*Mt+q*J+F*lt-X*it+Ct*E+I*Ut+wt*Gt-zt*Kt,w[5]=F*Mt+q*it+X*J-P*lt+wt*E+I*Kt+zt*Ut-Ct*Gt,w[6]=X*Mt+q*lt+P*it-F*J+zt*E+I*Gt+Ct*Kt-wt*Ut,w[7]=q*Mt-P*J-F*it-X*lt+I*E-Ct*Ut-wt*Kt-zt*Gt,w}Object.defineProperty(r,"__esModule",{value:!0}),r.create=function(){var w=new d.ARRAY_TYPE(8);return d.ARRAY_TYPE!=Float32Array&&(w[0]=0,w[1]=0,w[2]=0,w[4]=0,w[5]=0,w[6]=0,w[7]=0),w[3]=1,w},r.clone=function(w){var I=new d.ARRAY_TYPE(8);return I[0]=w[0],I[1]=w[1],I[2]=w[2],I[3]=w[3],I[4]=w[4],I[5]=w[5],I[6]=w[6],I[7]=w[7],I},r.fromValues=function(w,I,E,P,F,X,q,J){var it=new d.ARRAY_TYPE(8);return it[0]=w,it[1]=I,it[2]=E,it[3]=P,it[4]=F,it[5]=X,it[6]=q,it[7]=J,it},r.fromRotationTranslationValues=function(w,I,E,P,F,X,q){var J=new d.ARRAY_TYPE(8);return J[0]=w,J[1]=I,J[2]=E,J[3]=P,F*=.5,X*=.5,q*=.5,J[4]=F*P+X*E-q*I,J[5]=X*P+q*w-F*E,J[6]=q*P+F*I-X*w,J[7]=-F*w-X*I-q*E,J},r.fromRotationTranslation=s,r.fromTranslation=function(w,I){return w[0]=0,w[1]=0,w[2]=0,w[3]=1,w[4]=.5*I[0],w[5]=.5*I[1],w[6]=.5*I[2],w[7]=0,w},r.fromRotation=function(w,I){return w[0]=I[0],w[1]=I[1],w[2]=I[2],w[3]=I[3],w[4]=0,w[5]=0,w[6]=0,w[7]=0,w},r.fromMat4=function(w,I){var E=p.create();A.getRotation(E,I);var P=new d.ARRAY_TYPE(3);return A.getTranslation(P,I),s(w,E,P),w},r.copy=f,r.identity=function(w){return w[0]=0,w[1]=0,w[2]=0,w[3]=1,w[4]=0,w[5]=0,w[6]=0,w[7]=0,w},r.set=function(w,I,E,P,F,X,q,J,it){return w[0]=I,w[1]=E,w[2]=P,w[3]=F,w[4]=X,w[5]=q,w[6]=J,w[7]=it,w},r.getDual=function(w,I){return w[0]=I[4],w[1]=I[5],w[2]=I[6],w[3]=I[7],w},r.setDual=function(w,I){return w[4]=I[0],w[5]=I[1],w[6]=I[2],w[7]=I[3],w},r.getTranslation=function(w,I){var E=I[4],P=I[5],F=I[6],X=I[7],q=-I[0],J=-I[1],it=-I[2];return I=I[3],w[0]=2*(E*I+X*q+P*it-F*J),w[1]=2*(P*I+X*J+F*q-E*it),w[2]=2*(F*I+X*it+E*J-P*q),w},r.translate=function(w,I,E){var P=I[0],F=I[1],X=I[2],q=I[3],J=.5*E[0],it=.5*E[1];E=.5*E[2];var lt=I[4],Mt=I[5],Ct=I[6];return I=I[7],w[0]=P,w[1]=F,w[2]=X,w[3]=q,w[4]=q*J+F*E-X*it+lt,w[5]=q*it+X*J-P*E+Mt,w[6]=q*E+P*it-F*J+Ct,w[7]=-P*J-F*it-X*E+I,w},r.rotateX=function(w,I,E){var P=-I[0],F=-I[1],X=-I[2],q=I[3],J=I[4],it=I[5],lt=I[6],Mt=I[7],Ct=J*q+Mt*P+it*X-lt*F,wt=it*q+Mt*F+lt*P-J*X,zt=lt*q+Mt*X+J*F-it*P;return J=Mt*q-J*P-it*F-lt*X,p.rotateX(w,I,E),P=w[0],F=w[1],X=w[2],q=w[3],w[4]=Ct*q+J*P+wt*X-zt*F,w[5]=wt*q+J*F+zt*P-Ct*X,w[6]=zt*q+J*X+Ct*F-wt*P,w[7]=J*q-Ct*P-wt*F-zt*X,w},r.rotateY=function(w,I,E){var P=-I[0],F=-I[1],X=-I[2],q=I[3],J=I[4],it=I[5],lt=I[6],Mt=I[7],Ct=J*q+Mt*P+it*X-lt*F,wt=it*q+Mt*F+lt*P-J*X,zt=lt*q+Mt*X+J*F-it*P;return J=Mt*q-J*P-it*F-lt*X,p.rotateY(w,I,E),P=w[0],F=w[1],X=w[2],q=w[3],w[4]=Ct*q+J*P+wt*X-zt*F,w[5]=wt*q+J*F+zt*P-Ct*X,w[6]=zt*q+J*X+Ct*F-wt*P,w[7]=J*q-Ct*P-wt*F-zt*X,w},r.rotateZ=function(w,I,E){var P=-I[0],F=-I[1],X=-I[2],q=I[3],J=I[4],it=I[5],lt=I[6],Mt=I[7],Ct=J*q+Mt*P+it*X-lt*F,wt=it*q+Mt*F+lt*P-J*X,zt=lt*q+Mt*X+J*F-it*P;return J=Mt*q-J*P-it*F-lt*X,p.rotateZ(w,I,E),P=w[0],F=w[1],X=w[2],q=w[3],w[4]=Ct*q+J*P+wt*X-zt*F,w[5]=wt*q+J*F+zt*P-Ct*X,w[6]=zt*q+J*X+Ct*F-wt*P,w[7]=J*q-Ct*P-wt*F-zt*X,w},r.rotateByQuatAppend=function(w,I,E){var P=E[0],F=E[1],X=E[2];E=E[3];var q=I[0],J=I[1],it=I[2],lt=I[3];return w[0]=q*E+lt*P+J*X-it*F,w[1]=J*E+lt*F+it*P-q*X,w[2]=it*E+lt*X+q*F-J*P,w[3]=lt*E-q*P-J*F-it*X,q=I[4],J=I[5],it=I[6],lt=I[7],w[4]=q*E+lt*P+J*X-it*F,w[5]=J*E+lt*F+it*P-q*X,w[6]=it*E+lt*X+q*F-J*P,w[7]=lt*E-q*P-J*F-it*X,w},r.rotateByQuatPrepend=function(w,I,E){var P=I[0],F=I[1],X=I[2];I=I[3];var q=E[0],J=E[1],it=E[2],lt=E[3];return w[0]=P*lt+I*q+F*it-X*J,w[1]=F*lt+I*J+X*q-P*it,w[2]=X*lt+I*it+P*J-F*q,w[3]=I*lt-P*q-F*J-X*it,q=E[4],J=E[5],it=E[6],lt=E[7],w[4]=P*lt+I*q+F*it-X*J,w[5]=F*lt+I*J+X*q-P*it,w[6]=X*lt+I*it+P*J-F*q,w[7]=I*lt-P*q-F*J-X*it,w},r.rotateAroundAxis=function(w,I,E,P){if(Math.abs(P)<d.EPSILON)return f(w,I);var F=Math.sqrt(E[0]*E[0]+E[1]*E[1]+E[2]*E[2]);P*=.5;var X=Math.sin(P),q=X*E[0]/F,J=X*E[1]/F;E=X*E[2]/F,P=Math.cos(P),F=I[0],X=I[1];var it=I[2],lt=I[3];return w[0]=F*P+lt*q+X*E-it*J,w[1]=X*P+lt*J+it*q-F*E,w[2]=it*P+lt*E+F*J-X*q,w[3]=lt*P-F*q-X*J-it*E,F=I[4],X=I[5],it=I[6],I=I[7],w[4]=F*P+I*q+X*E-it*J,w[5]=X*P+I*J+it*q-F*E,w[6]=it*P+I*E+F*J-X*q,w[7]=I*P-F*q-X*J-it*E,w},r.add=function(w,I,E){return w[0]=I[0]+E[0],w[1]=I[1]+E[1],w[2]=I[2]+E[2],w[3]=I[3]+E[3],w[4]=I[4]+E[4],w[5]=I[5]+E[5],w[6]=I[6]+E[6],w[7]=I[7]+E[7],w},r.multiply=c,r.scale=function(w,I,E){return w[0]=I[0]*E,w[1]=I[1]*E,w[2]=I[2]*E,w[3]=I[3]*E,w[4]=I[4]*E,w[5]=I[5]*E,w[6]=I[6]*E,w[7]=I[7]*E,w},r.lerp=function(w,I,E,P){var F=1-P;return 0>S(I,E)&&(P=-P),w[0]=I[0]*F+E[0]*P,w[1]=I[1]*F+E[1]*P,w[2]=I[2]*F+E[2]*P,w[3]=I[3]*F+E[3]*P,w[4]=I[4]*F+E[4]*P,w[5]=I[5]*F+E[5]*P,w[6]=I[6]*F+E[6]*P,w[7]=I[7]*F+E[7]*P,w},r.invert=function(w,I){var E=z(I);return w[0]=-I[0]/E,w[1]=-I[1]/E,w[2]=-I[2]/E,w[3]=I[3]/E,w[4]=-I[4]/E,w[5]=-I[5]/E,w[6]=-I[6]/E,w[7]=I[7]/E,w},r.conjugate=function(w,I){return w[0]=-I[0],w[1]=-I[1],w[2]=-I[2],w[3]=I[3],w[4]=-I[4],w[5]=-I[5],w[6]=-I[6],w[7]=I[7],w},r.normalize=function(w,I){var E=z(I);if(0<E){E=Math.sqrt(E);var P=I[0]/E,F=I[1]/E,X=I[2]/E,q=I[3]/E,J=I[4],it=I[5],lt=I[6];I=I[7];var Mt=P*J+F*it+X*lt+q*I;w[0]=P,w[1]=F,w[2]=X,w[3]=q,w[4]=(J-P*Mt)/E,w[5]=(it-F*Mt)/E,w[6]=(lt-X*Mt)/E,w[7]=(I-q*Mt)/E}return w},r.str=function(w){return"quat2("+w[0]+", "+w[1]+", "+w[2]+", "+w[3]+", "+w[4]+", "+w[5]+", "+w[6]+", "+w[7]+")"},r.exactEquals=function(w,I){return w[0]===I[0]&&w[1]===I[1]&&w[2]===I[2]&&w[3]===I[3]&&w[4]===I[4]&&w[5]===I[5]&&w[6]===I[6]&&w[7]===I[7]},r.equals=function(w,I){var E=w[0],P=w[1],F=w[2],X=w[3],q=w[4],J=w[5],it=w[6];w=w[7];var lt=I[0],Mt=I[1],Ct=I[2],wt=I[3],zt=I[4],Ut=I[5],Kt=I[6];return I=I[7],Math.abs(E-lt)<=d.EPSILON*Math.max(1,Math.abs(E),Math.abs(lt))&&Math.abs(P-Mt)<=d.EPSILON*Math.max(1,Math.abs(P),Math.abs(Mt))&&Math.abs(F-Ct)<=d.EPSILON*Math.max(1,Math.abs(F),Math.abs(Ct))&&Math.abs(X-wt)<=d.EPSILON*Math.max(1,Math.abs(X),Math.abs(wt))&&Math.abs(q-zt)<=d.EPSILON*Math.max(1,Math.abs(q),Math.abs(zt))&&Math.abs(J-Ut)<=d.EPSILON*Math.max(1,Math.abs(J),Math.abs(Ut))&&Math.abs(it-Kt)<=d.EPSILON*Math.max(1,Math.abs(it),Math.abs(Kt))&&Math.abs(w-I)<=d.EPSILON*Math.max(1,Math.abs(w),Math.abs(I))},r.sqrLen=r.squaredLength=r.len=r.length=r.dot=r.mul=r.setReal=r.getReal=void 0;var d=i(su),p=i(B_),A=i(D_);r.getReal=p.copy,r.setReal=p.copy,r.mul=c;var S=p.dot;r.dot=S,t=p.length,r.length=t,r.len=t;var z=p.squaredLength;r.squaredLength=z,r.sqrLen=z});ot(y3);var x3=ht(function(t,r){function i(){var w=new z.ARRAY_TYPE(2);return z.ARRAY_TYPE!=Float32Array&&(w[0]=0,w[1]=0),w}function s(w,I,E){return w[0]=I[0]-E[0],w[1]=I[1]-E[1],w}function f(w,I,E){return w[0]=I[0]*E[0],w[1]=I[1]*E[1],w}function c(w,I,E){return w[0]=I[0]/E[0],w[1]=I[1]/E[1],w}function d(w,I){var E=I[0]-w[0];return w=I[1]-w[1],Math.sqrt(E*E+w*w)}function p(w,I){var E=I[0]-w[0];return w=I[1]-w[1],E*E+w*w}function A(w){var I=w[0];return w=w[1],Math.sqrt(I*I+w*w)}function S(w){var I=w[0];return w=w[1],I*I+w*w}Object.defineProperty(r,"__esModule",{value:!0}),r.create=i,r.clone=function(w){var I=new z.ARRAY_TYPE(2);return I[0]=w[0],I[1]=w[1],I},r.fromValues=function(w,I){var E=new z.ARRAY_TYPE(2);return E[0]=w,E[1]=I,E},r.copy=function(w,I){return w[0]=I[0],w[1]=I[1],w},r.set=function(w,I,E){return w[0]=I,w[1]=E,w},r.add=function(w,I,E){return w[0]=I[0]+E[0],w[1]=I[1]+E[1],w},r.subtract=s,r.multiply=f,r.divide=c,r.ceil=function(w,I){return w[0]=Math.ceil(I[0]),w[1]=Math.ceil(I[1]),w},r.floor=function(w,I){return w[0]=Math.floor(I[0]),w[1]=Math.floor(I[1]),w},r.min=function(w,I,E){return w[0]=Math.min(I[0],E[0]),w[1]=Math.min(I[1],E[1]),w},r.max=function(w,I,E){return w[0]=Math.max(I[0],E[0]),w[1]=Math.max(I[1],E[1]),w},r.round=function(w,I){return w[0]=Math.round(I[0]),w[1]=Math.round(I[1]),w},r.scale=function(w,I,E){return w[0]=I[0]*E,w[1]=I[1]*E,w},r.scaleAndAdd=function(w,I,E,P){return w[0]=I[0]+E[0]*P,w[1]=I[1]+E[1]*P,w},r.distance=d,r.squaredDistance=p,r.length=A,r.squaredLength=S,r.negate=function(w,I){return w[0]=-I[0],w[1]=-I[1],w},r.inverse=function(w,I){return w[0]=1/I[0],w[1]=1/I[1],w},r.normalize=function(w,I){var E=I[0],P=I[1];return E=E*E+P*P,0<E&&(E=1/Math.sqrt(E)),w[0]=I[0]*E,w[1]=I[1]*E,w},r.dot=function(w,I){return w[0]*I[0]+w[1]*I[1]},r.cross=function(w,I,E){return I=I[0]*E[1]-I[1]*E[0],w[0]=w[1]=0,w[2]=I,w},r.lerp=function(w,I,E,P){var F=I[0];return I=I[1],w[0]=F+P*(E[0]-F),w[1]=I+P*(E[1]-I),w},r.random=function(w,I){I=I||1;var E=2*z.RANDOM()*Math.PI;return w[0]=Math.cos(E)*I,w[1]=Math.sin(E)*I,w},r.transformMat2=function(w,I,E){var P=I[0];return I=I[1],w[0]=E[0]*P+E[2]*I,w[1]=E[1]*P+E[3]*I,w},r.transformMat2d=function(w,I,E){var P=I[0];return I=I[1],w[0]=E[0]*P+E[2]*I+E[4],w[1]=E[1]*P+E[3]*I+E[5],w},r.transformMat3=function(w,I,E){var P=I[0];return I=I[1],w[0]=E[0]*P+E[3]*I+E[6],w[1]=E[1]*P+E[4]*I+E[7],w},r.transformMat4=function(w,I,E){var P=I[0];return I=I[1],w[0]=E[0]*P+E[4]*I+E[12],w[1]=E[1]*P+E[5]*I+E[13],w},r.rotate=function(w,I,E,P){var F=I[0]-E[0];I=I[1]-E[1];var X=Math.sin(P);return P=Math.cos(P),w[0]=F*P-I*X+E[0],w[1]=F*X+I*P+E[1],w},r.angle=function(w,I){var E=w[0];w=w[1];var P=I[0];I=I[1];var F=E*E+w*w;0<F&&(F=1/Math.sqrt(F));var X=P*P+I*I;return 0<X&&(X=1/Math.sqrt(X)),E=(E*P+w*I)*F*X,1<E?0:-1>E?Math.PI:Math.acos(E)},r.zero=function(w){return w[0]=0,w[1]=0,w},r.str=function(w){return"vec2("+w[0]+", "+w[1]+")"},r.exactEquals=function(w,I){return w[0]===I[0]&&w[1]===I[1]},r.equals=function(w,I){var E=w[0];w=w[1];var P=I[0];return I=I[1],Math.abs(E-P)<=z.EPSILON*Math.max(1,Math.abs(E),Math.abs(P))&&Math.abs(w-I)<=z.EPSILON*Math.max(1,Math.abs(w),Math.abs(I))},r.forEach=r.sqrLen=r.sqrDist=r.dist=r.div=r.mul=r.sub=r.len=void 0;var z=function(w){if(w&&w.__esModule)return w;var I={};if(w!=null){for(var E in w)if(Object.prototype.hasOwnProperty.call(w,E)){var P=On&&Xn?Xn(w,E):{};P.get||P.set?On(I,E,P):I[E]=w[E]}}return I.default=w,I}(su);r.len=A,r.sub=s,r.mul=f,r.div=c,r.dist=d,r.sqrDist=p,r.sqrLen=S,t=function(){var w=i();return function(I,E,P,F,X,q){for(E||(E=2),P||(P=0),F=F?Math.min(F*E+P,I.length):I.length;P<F;P+=E)w[0]=I[P],w[1]=I[P+1],X(w,w,q),I[P]=w[0],I[P+1]=w[1];return I}}(),r.forEach=t});ot(x3);var A3=ht(function(t,r){function i(s){if(s&&s.__esModule)return s;var f={};if(s!=null){for(var c in s)if(Object.prototype.hasOwnProperty.call(s,c)){var d=On&&Xn?Xn(s,c):{};d.get||d.set?On(f,c,d):f[c]=s[c]}}return f.default=s,f}Object.defineProperty(r,"__esModule",{value:!0}),r.vec4=r.vec3=r.vec2=r.quat2=r.quat=r.mat4=r.mat3=r.mat2d=r.mat2=r.glMatrix=void 0,t=i(su),r.glMatrix=t,t=i(g3),r.mat2=t,t=i(v3),r.mat2d=t,t=i(P_),r.mat3=t,t=i(D_),r.mat4=t,t=i(B_),r.quat=t,t=i(y3),r.quat2=t,t=i(x3),r.vec2=t,t=i(O_),r.vec3=t,t=i(F_),r.vec4=t});ot(A3);var mo=A3.mat4,Aa=function(){function t(r,i,s){Ai(this,t),this.options=i,this.gl=r,s&&(this.map=s.map),s=this.getVertexShader(i.vertexShader);var f=this.getFragmentShader(i.fragmentShader);i=r.createShader(r.VERTEX_SHADER),r.shaderSource(i,s),r.compileShader(i),r.getShaderParameter(i,r.COMPILE_STATUS)?(s=r.createShader(r.FRAGMENT_SHADER),r.shaderSource(s,f),r.compileShader(s),r.getShaderParameter(s,r.COMPILE_STATUS)?(f=r.createProgram(),r.attachShader(f,i),r.attachShader(f,s),r.deleteShader(i),r.deleteShader(s),r.linkProgram(f),r.getProgramParameter(f,r.LINK_STATUS)?i=f:(i="Shader program failed to link.  The error log is:"+r.getProgramInfoLog(f),console.error(i),i=-1)):(i="Fragment shader failed to compile.  The error log is:"+r.getShaderInfoLog(s),console.error(i),i=-1)):(i="Vertex shader failed to compile.  The error log is:"+r.getShaderInfoLog(i),console.error(i),i=-1),i=this.program=i,s={},f=r.getProgramParameter(i,r.ACTIVE_ATTRIBUTES);for(var c=0;c<f;c++){var d=r.getActiveAttrib(i,c);s[d.name]=r.getAttribLocation(i,d.name)}c={},d={};for(var p=r.getProgramParameter(i,r.ACTIVE_UNIFORMS),A=0;A<p;A++){var S=r.getActiveUniform(i,A);c[S.name]=r.getUniformLocation(i,S.name),d[S.name]=S.type}this.parameter=r={attributes:s,numAttributes:f,uniformsType:d,uniforms:c},this.attributes=r.attributes,this.uniforms=r.uniforms,this.parameter=r}return Xi(t,[{key:"getVertexShader",value:function(r){var i="";return this.map&&this.map.type==="cesium"&&(i=`#define LOG_DEPTH
`),i+=`#ifdef LOG_DEPTH
uniform float currentFrustumX;varying float v_depthFromNearPlusOne;
#endif
uniform vec2 MAPV_resolution;
#if defined(PICK)
uniform bool uIsPickRender;attribute vec3 aPickColor;uniform vec3 uPickedColor;varying vec4 vPickColor;uniform bool uEnablePicked;bool mapvIsPicked(){return uEnablePicked&&aPickColor==uPickedColor;}
#endif
void afterMain(){
#if defined(LOG_DEPTH)
v_depthFromNearPlusOne=(gl_Position.w-currentFrustumX)+1.0;gl_Position.z=clamp(gl_Position.z/gl_Position.w,-1.0,1.0)*gl_Position.w;
#endif
#if defined(PICK)
vPickColor=vec4(aPickColor,0.0);if(mapvIsPicked()){vPickColor.a=1.0;}
#endif
}`,r=this.getDefines()+i+r,r=r.replace("void main","void originMain"),r+"void main() {originMain(); afterMain();}"}},{key:"getFragmentShader",value:function(r){var i="";return this.map&&this.map.type==="cesium"&&(i=`#define LOG_DEPTH
`),i+=`#if defined(LOG_DEPTH)
#extension GL_EXT_frag_depth : enable
#endif
precision highp float;uniform vec2 MAPV_resolution;uniform bool uIsPickRender;
#if defined(PICK)
varying vec4 vPickColor;bool mapvIsPicked(){return vPickColor.a==1.0;}
#endif
#if defined(LOG_DEPTH)
uniform float oneOverLog2FarDepthFromNearPlusOne;uniform float farDepthFromNearPlusOne;varying float v_depthFromNearPlusOne;void writeLogDepth(float depth){if(depth<=0.9999999||depth>farDepthFromNearPlusOne){discard;}gl_FragDepthEXT=log2(depth)*oneOverLog2FarDepthFromNearPlusOne;}
#endif
void afterMain(){
#if defined(PICK)
if(uIsPickRender){gl_FragColor=vec4(vPickColor.rgb,1.0);return;}
#endif
#if defined(LOG_DEPTH)
writeLogDepth(v_depthFromNearPlusOne);
#endif
}`,r=this.getDefines()+i+r,r=r.replace("void main","void originMain"),r+"void main() {originMain(); afterMain();}"}},{key:"getDefines",value:function(){var r="",i=this.options.defines;if(i)for(var s=0;s<i.length;s++)r+="#define "+i[s]+`
`;return r}},{key:"use",value:function(r,i){this.gl=r,r.useProgram(this.program),this.map&&this.map.type==="cesium"&&this.setUniforms({currentFrustumX:this.map.map.scene.camera.frustum.near,oneOverLog2FarDepthFromNearPlusOne:this.map.map.scene.context.uniformState.oneOverLog2FarDepthFromNearPlusOne,farDepthFromNearPlusOne:this.map.map.scene.context.uniformState.farDepthFromNearPlusOne}),this.uniforms.MAPV_resolution&&this.setUniforms({MAPV_resolution:[r.canvas.width,r.canvas.height]})}},{key:"setUniform",value:function(r,i){var s=this.gl,f=this.uniforms[r];if(f)switch(this.parameter.uniformsType[r]){case s.FLOAT:s.uniform1f(f,i);break;case s.FLOAT_VEC2:s.uniform2f(f,i[0],i[1]);break;case s.FLOAT_VEC3:s.uniform3f(f,i[0],i[1],i[2]);break;case s.FLOAT_VEC4:s.uniform4f(f,i[0],i[1],i[2],i[3]);break;case s.SAMPLER_2D:case s.SAMPLER_CUBE:s.activeTexture(s["TEXTURE"+this.textureIndex]),s.uniform1i(f,this.textureIndex),s.bindTexture(s.TEXTURE_2D,i),this.textureIndex++;break;case s.INT:case s.BOOL:s.uniform1i(f,i);break;case s.INT_VEC2:case s.BOOL_VEC2:s.uniform2i(f,i[0],i[1]);break;case s.INT_VEC3:case s.BOOL_VEC3:s.uniform3i(f,i[0],i[1],i[2]);break;case s.INT_VEC4:case s.BOOL_VEC4:s.uniform4i(f,i[0],i[1],i[2],i[3]);break;case s.FLOAT_MAT2:s.uniformMatrix2fv(f,!1,i);break;case s.FLOAT_MAT3:s.uniformMatrix3fv(f,!1,i);break;case s.FLOAT_MAT4:s.uniformMatrix4fv(f,!1,i);break;default:console.error("Unrecognized uniform type: "+r)}else console.warn("Unrecognized uniform type: "+r)}},{key:"setUniforms",value:function(r){this.textureIndex=0;for(var i in r)this.setUniform(i,r[i])}}]),t}(),eh=function(t,r,i,s){var f=i?i.call(s,t,r):void 0;if(f!==void 0)return!!f;if(t===r)return!0;if((typeof t=="undefined"?"undefined":ts(t))!=="object"||!t||(typeof r=="undefined"?"undefined":ts(r))!=="object"||!r)return!1;var c=Ti(t),d=Ti(r);if(c.length!==d.length)return!1;d=Object.prototype.hasOwnProperty.bind(r);for(var p=0;p<c.length;p++){if(f=c[p],!d(f))return!1;var A=t[f],S=r[f];if(f=i?i.call(s,A,S,f):void 0,f===!1||f===void 0&&A!==S)return!1}return!0},IE=function(){function t(r){Ai(this,t),this.options=r,this.gl=r.gl,this.savedState=[],this.currentState=this.getDefaultState()}return Xi(t,[{key:"setDefaultState",value:function(){this.setState()}},{key:"getDefaultState",value:function(){var r=this.gl;return{blend:!1,blendEquation:r.FUNC_ADD,blendFunc:[r.ONE,r.ZERO],depthMask:!0,depthTest:!0,depthFunc:r.LEQUAL,polygonOffset:[0,0],cullFace:!1,stencilTest:!1}}},{key:"getRealState",value:function(){var r=this.gl;return{blend:r.getParameter(r.BLEND),blendEquation:r.getParameter(r.BLEND_EQUATION),depthMask:r.getParameter(r.DEPTH_WRITEMASK),depthTest:r.getParameter(r.DEPTH_TEST),depthFunc:r.getParameter(r.DEPTH_FUNC),polygonOffset:[r.getParameter(r.POLYGON_OFFSET_FACTOR),r.getParameter(r.POLYGON_OFFSET_UNITS)],cullFace:r.getParameter(r.CULL_FACE),stencilTest:r.getParameter(r.STENCIL_TEST)}}},{key:"getCurrentState",value:function(){return this.currentState}},{key:"save",value:function(){this.savedState.push(this.getCurrentState())}},{key:"restore",value:function(){var r=this.savedState.pop();this.setState(r,{force:!0})}},{key:"setState",value:function(r){var i=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{};r=pt(this.getDefaultState(),r),this.setBlend(r,i),this.setDepth(r,i),this.setCullFace(r,i),this.setPolygonOffset(r,i),this.setStencil(r,i),this.currentState=r}},{key:"setBlend",value:function(r,i){var s=this.gl,f=this.getCurrentState();((i=i.force)||!eh(r.blend,f.blend))&&(r.blend?s.enable(s.BLEND):s.disable(s.BLEND)),!i&&eh(r.blendEquation,f.blendEquation)||s.blendEquation(r.blendEquation),!i&&eh(r.blendFunc,f.blendFunc)||s.blendFunc(r.blendFunc[0],r.blendFunc[1])}},{key:"setDepth",value:function(r,i){var s=this.gl,f=this.getCurrentState();((i=i.force)||!eh(r.depthTest,f.depthTest))&&(r.depthTest?s.enable(s.DEPTH_TEST):s.disable(s.DEPTH_TEST)),(i||!eh(r.depthMask,f.depthMask))&&(r.depthMask?s.depthMask(!0):s.depthMask(!1)),!i&&eh(r.depthFunc,f.depthFunc)||s.depthFunc(r.depthFunc)}},{key:"setPolygonOffset",value:function(r,i){var s=this.gl,f=this.getCurrentState();(i.force||!eh(r.polygonOffset,f.polygonOffset))&&(r.polygonOffset[0]!==0&&r.polygonOffset[1]!==0?s.enable(s.POLYGON_OFFSET_FILL):s.disable(s.POLYGON_OFFSET_FILL),s.polygonOffset(r.polygonOffset[0],r.polygonOffset[1]))}},{key:"setCullFace",value:function(r,i){var s=this.gl,f=this.getCurrentState();(i.force||!eh(r.cullFace,f.cullFace))&&(r.cullFace?(s.enable(s.CULL_FACE),s.cullFace(s.BACK)):s.disable(s.CULL_FACE))}},{key:"setStencil",value:function(r,i){var s=this.gl,f=this.getCurrentState();(i.force||!eh(r.stencilTest,f.stencilTest))&&(r.stencilTest?s.enable(s.STENCIL_TEST):s.disable(s.STENCIL_TEST))}}]),t}(),Ov=function(){function t(r){Ai(this,t),this.options=r,this.gl=r.gl,this.buffer=this.gl.createBuffer(),r.data&&this.updateData(r.data)}return Xi(t,[{key:"updateData",value:function(r){var i=this.options,s=this.gl;this.bind(),s.bufferData(s[i.target],r,s[i.usage])}},{key:"bind",value:function(r){r=r||this.gl,r.bindBuffer(r[this.options.target],this.buffer)}},{key:"unBind",value:function(r){r=r||this.gl,r.bindBuffer(r[this.options.target],null)}},{key:"destroy",value:function(){this.buffer=null}}]),t}(),EE={BYTE:1,UNSIGNED_BYTE:1,SHORT:2,UNSIGNED_SHORT:2,FLOAT:4},$y=function(){function t(r){for(Ai(this,t),this.options=r,this.attributes=r.attributes,this.gl=r.gl,this.program=r.program,r=this.stride=0;r<this.attributes.length;r++)this.stride+=EE[this.attributes[r].type]*this.attributes[r].size}return Xi(t,[{key:"setVertexAttribPointers",value:function(){for(var r=this.gl,i=this.program,s=0;s<this.attributes.length;s++){var f=this.attributes[s],c=i.attributes[f.name];c!==void 0&&(f.buffer.bind(r),r.vertexAttribPointer(c,f.size,r[f.type],f.normalize||!1,f.stride!==void 0?f.stride:this.stride,f.offset),r.enableVertexAttribArray(c))}}},{key:"bind",value:function(){this.setVertexAttribPointers()}},{key:"destroy",value:function(){}}]),t}(),is=function t(r,i,s){Ai(this,t),i=i||r.canvas.width,s=s||r.canvas.height;var f=r.createFramebuffer(),c=r.createTexture();r.bindTexture(r.TEXTURE_2D,c),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,i,s,0,r.RGBA,r.UNSIGNED_BYTE,null),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),f.texture=c;var d=r.createRenderbuffer();r.bindRenderbuffer(r.RENDERBUFFER,d),r.renderbufferStorage(r.RENDERBUFFER,r.DEPTH_STENCIL,i,s),f.depthBuffer=d,r.bindFramebuffer(r.FRAMEBUFFER,f),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,c,0),r.framebufferRenderbuffer(r.FRAMEBUFFER,r.DEPTH_STENCIL_ATTACHMENT,r.RENDERBUFFER,d),i=r.checkFramebufferStatus(r.FRAMEBUFFER),r.FRAMEBUFFER_COMPLETE===i&&(r.bindFramebuffer(r.FRAMEBUFFER,null),r.bindTexture(r.TEXTURE_2D,null),r.bindRenderbuffer(r.RENDERBUFFER,null),this.framebuffer=f)},Qd=function(){function t(r){Ai(this,t),this.options={},pt(this.options,r),this.vertex=[-1,1,0,-1,-1,0,1,1,0,1,1,0,-1,-1,0,1,-1,0],this.sampleCoord=[0,1,0,0,1,1,1,1,0,0,1,0]}return Xi(t,[{key:"getOptions",value:function(){return this.options}},{key:"onResize",value:function(r){}},{key:"render",value:function(r){var i=r.gl;r=r.texture;var s=this.programSample;i.useProgram(s.program);var f=i.createBuffer();i.bindBuffer(i.ARRAY_BUFFER,f);var c=[-1,-1,0,-1,1,0,1,1,0,1,1,0,-1,-1,0,1,-1,0];i.bufferData(i.ARRAY_BUFFER,new Float32Array(c),i.STATIC_DRAW),i.enableVertexAttribArray(s.attributes.aPos),i.vertexAttribPointer(s.attributes.aPos,3,i.FLOAT,!1,0,0),f=i.createBuffer(),i.bindBuffer(i.ARRAY_BUFFER,f),i.bufferData(i.ARRAY_BUFFER,new Float32Array([0,0,0,1,1,1,1,1,0,0,1,0]),i.STATIC_DRAW),i.enableVertexAttribArray(s.attributes.aTextureCoord),i.vertexAttribPointer(s.attributes.aTextureCoord,2,i.FLOAT,!1,0,0),i.activeTexture(i.TEXTURE0),i.bindTexture(i.TEXTURE_2D,r),i.uniform1i(s.uniforms.uSampler,0),i.drawArrays(i.TRIANGLES,0,c.length/3)}}]),t}();(function(t){function r(i){return Ai(this,r),Tn(this,(r.__proto__||Wn(r)).call(this,i))}return jn(r,t),Xi(r,[{key:"getProgram",value:function(i){return this.programSample||(this.programSample=new Aa(i,{vertexShader:"attribute vec3 aPos;attribute vec2 aTextureCoord;varying vec2 vTextureCoord;void main(void){vTextureCoord=aTextureCoord;gl_Position=vec4(aPos,1.0);}",fragmentShader:"precision highp float;uniform sampler2D uSampler;uniform vec2 canvasSize;varying vec2 vTextureCoord;vec4 fxaa_2_0(sampler2D tex,vec2 fragCoord,vec2 resolution,vec2 v_rgbNW,vec2 v_rgbNE,vec2 v_rgbSW,vec2 v_rgbSE,vec2 v_rgbM){vec4 color;mediump vec2 inverseVP=vec2(1.0/resolution.x,1.0/resolution.y);vec3 rgbNW=texture2D(tex,v_rgbNW).xyz;vec3 rgbNE=texture2D(tex,v_rgbNE).xyz;vec3 rgbSW=texture2D(tex,v_rgbSW).xyz;vec3 rgbSE=texture2D(tex,v_rgbSE).xyz;vec4 texColor=texture2D(tex,v_rgbM);vec3 rgbM=texColor.xyz;vec3 luma=vec3(0.299,0.587,0.114);float lumaNW=dot(rgbNW,luma);float lumaNE=dot(rgbNE,luma);float lumaSW=dot(rgbSW,luma);float lumaSE=dot(rgbSE,luma);float lumaM=dot(rgbM,luma);float lumaMin=min(lumaM,min(min(lumaNW,lumaNE),min(lumaSW,lumaSE)));float lumaMax=max(lumaM,max(max(lumaNW,lumaNE),max(lumaSW,lumaSE)));mediump vec2 dir;dir.x=-((lumaNW+lumaNE)-(lumaSW+lumaSE));dir.y=((lumaNW+lumaSW)-(lumaNE+lumaSE));float dirReduce=max((lumaNW+lumaNE+lumaSW+lumaSE)*(0.25*1.0/8.0),1.0/128.0);float rcpDirMin=1.0/(min(abs(dir.x),abs(dir.y))+dirReduce);dir=min(vec2(8.0,8.0),max(vec2(-8.0,-8.0),dir*rcpDirMin))*inverseVP;vec3 rgbA=0.5*(texture2D(tex,fragCoord*inverseVP+dir*(1.0/3.0-0.5)).xyz+texture2D(tex,fragCoord*inverseVP+dir*(2.0/3.0-0.5)).xyz);vec3 rgbB=rgbA*0.5+0.25*(texture2D(tex,fragCoord*inverseVP+dir*-0.5).xyz+texture2D(tex,fragCoord*inverseVP+dir*0.5).xyz);float lumaB=dot(rgbB,luma);if((lumaB<lumaMin)||(lumaB>lumaMax)){color=vec4(rgbA,texColor.a);}else{color=vec4(rgbB,texColor.a);}return color;}void texcoords_3_1(vec2 fragCoord,vec2 resolution,out vec2 v_rgbNW,out vec2 v_rgbNE,out vec2 v_rgbSW,out vec2 v_rgbSE,out vec2 v_rgbM){vec2 inverseVP=1.0/resolution.xy;v_rgbNW=(fragCoord+vec2(-1.0,-1.0))*inverseVP;v_rgbNE=(fragCoord+vec2(1.0,-1.0))*inverseVP;v_rgbSW=(fragCoord+vec2(-1.0,1.0))*inverseVP;v_rgbSE=(fragCoord+vec2(1.0,1.0))*inverseVP;v_rgbM=vec2(fragCoord*inverseVP);}vec4 apply_1_2(sampler2D tex,vec2 fragCoord,vec2 resolution){mediump vec2 v_rgbNW;mediump vec2 v_rgbNE;mediump vec2 v_rgbSW;mediump vec2 v_rgbSE;mediump vec2 v_rgbM;texcoords_3_1(fragCoord,resolution,v_rgbNW,v_rgbNE,v_rgbSW,v_rgbSE,v_rgbM);return fxaa_2_0(tex,fragCoord,resolution,v_rgbNW,v_rgbNE,v_rgbSW,v_rgbSE,v_rgbM);}void main(void){vec2 fragCoord=vTextureCoord*canvasSize;gl_FragColor=apply_1_2(uSampler,fragCoord,canvasSize);}"})),this.programSample}},{key:"render",value:function(i){var s=i.gl;i=i.texture,this.getOptions(),s.clearColor(0,0,0,0),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT);var f=this.getProgram(s);s.useProgram(f.program);var c=s.createBuffer();s.bindBuffer(s.ARRAY_BUFFER,c),s.bufferData(s.ARRAY_BUFFER,new Float32Array(this.vertex),s.STATIC_DRAW),s.enableVertexAttribArray(f.attributes.aPos),s.vertexAttribPointer(f.attributes.aPos,3,s.FLOAT,!1,0,0),c=s.createBuffer(),s.bindBuffer(s.ARRAY_BUFFER,c),s.bufferData(s.ARRAY_BUFFER,new Float32Array(this.sampleCoord),s.STATIC_DRAW),s.enableVertexAttribArray(f.attributes.aTextureCoord),s.vertexAttribPointer(f.attributes.aTextureCoord,2,s.FLOAT,!1,0,0),s.activeTexture(s.TEXTURE1),s.bindTexture(s.TEXTURE_2D,i),s.uniform1i(f.uniforms.uSampler,1),s.uniform2fv(f.uniforms.canvasSize,[s.canvas.width,s.canvas.height]),s.drawArrays(s.TRIANGLES,0,this.vertex.length/3),s.bindBuffer(s.ARRAY_BUFFER,null),s.useProgram(null)}}]),r})(Qd),function(t){function r(i){return Ai(this,r),Tn(this,(r.__proto__||Wn(r)).call(this,i))}return jn(r,t),Xi(r,[{key:"getProgram",value:function(i){if(this.program1||(this.program1=new Aa(i,{vertexShader:"attribute vec3 position;attribute vec2 uv;uniform vec2 resolution;varying vec2 vUv;varying vec4 vOffset[3];void SMAAEdgeDetectionVS(vec2 texcoord){vOffset[0]=texcoord.xyxy+resolution.xyxy*vec4(-1.0,0.0,0.0,1.0);vOffset[1]=texcoord.xyxy+resolution.xyxy*vec4(1.0,0.0,0.0,-1.0);vOffset[2]=texcoord.xyxy+resolution.xyxy*vec4(-2.0,0.0,0.0,2.0);}void main(){vUv=uv;SMAAEdgeDetectionVS(vUv);gl_Position=vec4(position,1.0);}",fragmentShader:`precision highp float;
#define SMAA_THRESHOLD 0.1
uniform sampler2D tDiffuse;varying vec2 vUv;varying vec4 vOffset[3];vec4 SMAAColorEdgeDetectionPS(vec2 texcoord,vec4 offset[3],sampler2D colorTex){vec2 threshold=vec2(SMAA_THRESHOLD,SMAA_THRESHOLD);vec4 delta;vec3 C=texture2D(colorTex,texcoord).rgb;vec3 Cleft=texture2D(colorTex,offset[0].xy).rgb;vec3 t=abs(C-Cleft);delta.x=max(max(t.r,t.g),t.b);vec3 Ctop=texture2D(colorTex,offset[0].zw).rgb;t=abs(C-Ctop);delta.y=max(max(t.r,t.g),t.b);vec2 edges=step(threshold,delta.xy);if(dot(edges,vec2(1.0,1.0))==0.0)discard;vec3 Cright=texture2D(colorTex,offset[1].xy).rgb;t=abs(C-Cright);delta.z=max(max(t.r,t.g),t.b);vec3 Cbottom=texture2D(colorTex,offset[1].zw).rgb;t=abs(C-Cbottom);delta.w=max(max(t.r,t.g),t.b);float maxDelta=max(max(max(delta.x,delta.y),delta.z),delta.w);vec3 Cleftleft=texture2D(colorTex,offset[2].xy).rgb;t=abs(C-Cleftleft);delta.z=max(max(t.r,t.g),t.b);vec3 Ctoptop=texture2D(colorTex,offset[2].zw).rgb;t=abs(C-Ctoptop);delta.w=max(max(t.r,t.g),t.b);maxDelta=max(max(maxDelta,delta.z),delta.w);edges.xy*=step(0.5*maxDelta,delta.xy);return vec4(edges,0.0,0.0);}void main(){gl_FragColor=SMAAColorEdgeDetectionPS(vUv,vOffset,tDiffuse);}`})),this.program2||(this.program2=new Aa(i,{vertexShader:`precision highp float;
#define SMAA_MAX_SEARCH_STEPS 8
#define SMAA_AREATEX_MAX_DISTANCE 16
#define SMAA_AREATEX_PIXEL_SIZE ( 1.0 / vec2( 160.0, 560.0 ) )
#define SMAA_AREATEX_SUBTEX_SIZE ( 1.0 / 7.0 )
attribute vec3 position;attribute vec2 uv;uniform vec2 resolution;varying vec2 vUv;varying vec4 vOffset[3];varying vec2 vPixcoord;void SMAABlendingWeightCalculationVS(vec2 texcoord){vPixcoord=texcoord/resolution;vOffset[0]=texcoord.xyxy+resolution.xyxy*vec4(-0.25,0.125,1.25,0.125);vOffset[1]=texcoord.xyxy+resolution.xyxy*vec4(-0.125,0.25,-0.125,-1.25);vOffset[2]=vec4(vOffset[0].xz,vOffset[1].yw)+vec4(-2.0,2.0,-2.0,2.0)*resolution.xxyy*float(SMAA_MAX_SEARCH_STEPS);}void main(){vUv=uv;SMAABlendingWeightCalculationVS(vUv);gl_Position=vec4(position,1.0);}`,fragmentShader:`precision highp float;
#define SMAA_MAX_SEARCH_STEPS 8
#define SMAA_AREATEX_MAX_DISTANCE 16
#define SMAA_AREATEX_PIXEL_SIZE ( 1.0 / vec2( 160.0, 560.0 ) )
#define SMAA_AREATEX_SUBTEX_SIZE ( 1.0 / 7.0 )
#define SMAASampleLevelZeroOffset( tex, coord, offset ) texture2D( tex, coord + float( offset ) * resolution, 0.0 )
uniform sampler2D tDiffuse;uniform sampler2D tArea;uniform sampler2D tSearch;uniform vec2 resolution;varying vec2 vUv;varying vec4 vOffset[3];varying vec2 vPixcoord;vec2 round(vec2 x){return sign(x)*floor(abs(x)+0.5);}float SMAASearchLength(sampler2D searchTex,vec2 e,float bias,float scale){e.r=bias+e.r*scale;return 255.0*texture2D(searchTex,e,0.0).r;}float SMAASearchXLeft(sampler2D edgesTex,sampler2D searchTex,vec2 texcoord,float end){/***@PSEUDO_GATHER4*This texcoord has been offset by(-0.25,-0.125)in the vertex shader to*sample between edge,thus fetching four edges in a row.*Sampling with different offsets in each direction allows to disambiguate*which edges are active from the four fetched ones.*/vec2 e=vec2(0.0,1.0);for(int i=0;i<SMAA_MAX_SEARCH_STEPS;i++){e=texture2D(edgesTex,texcoord,0.0).rg;texcoord-=vec2(2.0,0.0)*resolution;if(!(texcoord.x>end&&e.g>0.8281&&e.r==0.0))break;}texcoord.x+=0.25*resolution.x;texcoord.x+=resolution.x;texcoord.x+=2.0*resolution.x;texcoord.x-=resolution.x*SMAASearchLength(searchTex,e,0.0,0.5);return texcoord.x;}float SMAASearchXRight(sampler2D edgesTex,sampler2D searchTex,vec2 texcoord,float end){vec2 e=vec2(0.0,1.0);for(int i=0;i<SMAA_MAX_SEARCH_STEPS;i++){e=texture2D(edgesTex,texcoord,0.0).rg;texcoord+=vec2(2.0,0.0)*resolution;if(!(texcoord.x<end&&e.g>0.8281&&e.r==0.0))break;}texcoord.x-=0.25*resolution.x;texcoord.x-=resolution.x;texcoord.x-=2.0*resolution.x;texcoord.x+=resolution.x*SMAASearchLength(searchTex,e,0.5,0.5);return texcoord.x;}float SMAASearchYUp(sampler2D edgesTex,sampler2D searchTex,vec2 texcoord,float end){vec2 e=vec2(1.0,0.0);for(int i=0;i<SMAA_MAX_SEARCH_STEPS;i++){e=texture2D(edgesTex,texcoord,0.0).rg;texcoord+=vec2(0.0,2.0)*resolution;if(!(texcoord.y>end&&e.r>0.8281&&e.g==0.0))break;}texcoord.y-=0.25*resolution.y;texcoord.y-=resolution.y;texcoord.y-=2.0*resolution.y;texcoord.y+=resolution.y*SMAASearchLength(searchTex,e.gr,0.0,0.5);return texcoord.y;}float SMAASearchYDown(sampler2D edgesTex,sampler2D searchTex,vec2 texcoord,float end){vec2 e=vec2(1.0,0.0);for(int i=0;i<SMAA_MAX_SEARCH_STEPS;i++){e=texture2D(edgesTex,texcoord,0.0).rg;texcoord-=vec2(0.0,2.0)*resolution;if(!(texcoord.y<end&&e.r>0.8281&&e.g==0.0))break;}texcoord.y+=0.25*resolution.y;texcoord.y+=resolution.y;texcoord.y+=2.0*resolution.y;texcoord.y-=resolution.y*SMAASearchLength(searchTex,e.gr,0.5,0.5);return texcoord.y;}vec2 SMAAArea(sampler2D areaTex,vec2 dist,float e1,float e2,float offset){vec2 texcoord=float(SMAA_AREATEX_MAX_DISTANCE)*round(4.0*vec2(e1,e2))+dist;texcoord=SMAA_AREATEX_PIXEL_SIZE*texcoord+(0.5*SMAA_AREATEX_PIXEL_SIZE);texcoord.y+=SMAA_AREATEX_SUBTEX_SIZE*offset;return texture2D(areaTex,texcoord,0.0).rg;}vec4 SMAABlendingWeightCalculationPS(vec2 texcoord,vec2 pixcoord,vec4 offset[3],sampler2D edgesTex,sampler2D areaTex,sampler2D searchTex,ivec4 subsampleIndices){vec4 weights=vec4(0.0,0.0,0.0,0.0);vec2 e=texture2D(edgesTex,texcoord).rg;if(e.g>0.0){vec2 d;vec2 coords;coords.x=SMAASearchXLeft(edgesTex,searchTex,offset[0].xy,offset[2].x);coords.y=offset[1].y;d.x=coords.x;float e1=texture2D(edgesTex,coords,0.0).r;coords.x=SMAASearchXRight(edgesTex,searchTex,offset[0].zw,offset[2].y);d.y=coords.x;d=d/resolution.x-pixcoord.x;vec2 sqrt_d=sqrt(abs(d));coords.y-=1.0*resolution.y;float e2=SMAASampleLevelZeroOffset(edgesTex,coords,ivec2(1,0)).r;weights.rg=SMAAArea(areaTex,sqrt_d,e1,e2,float(subsampleIndices.y));}if(e.r>0.0){vec2 d;vec2 coords;coords.y=SMAASearchYUp(edgesTex,searchTex,offset[1].xy,offset[2].z);coords.x=offset[0].x;d.x=coords.y;float e1=texture2D(edgesTex,coords,0.0).g;coords.y=SMAASearchYDown(edgesTex,searchTex,offset[1].zw,offset[2].w);d.y=coords.y;d=d/resolution.y-pixcoord.y;vec2 sqrt_d=sqrt(abs(d));coords.y-=1.0*resolution.y;float e2=SMAASampleLevelZeroOffset(edgesTex,coords,ivec2(0,1)).g;weights.ba=SMAAArea(areaTex,sqrt_d,e1,e2,float(subsampleIndices.x));}return weights;}void main(){gl_FragColor=SMAABlendingWeightCalculationPS(vUv,vPixcoord,vOffset,tDiffuse,tArea,tSearch,ivec4(0.0));}`})),this.program3||(this.program3=new Aa(i,{vertexShader:"precision highp float;uniform vec2 resolution;attribute vec3 position;attribute vec2 uv;varying vec2 vUv;varying vec4 vOffset[2];void SMAANeighborhoodBlendingVS(vec2 texcoord){vOffset[0]=texcoord.xyxy+resolution.xyxy*vec4(-1.0,0.0,0.0,1.0);vOffset[1]=texcoord.xyxy+resolution.xyxy*vec4(1.0,0.0,0.0,-1.0);}void main(){vUv=uv;SMAANeighborhoodBlendingVS(vUv);gl_Position=vec4(position,1.0);}",fragmentShader:"precision highp float;uniform sampler2D tDiffuse;uniform sampler2D tColor;uniform vec2 resolution;varying vec2 vUv;varying vec4 vOffset[2];vec4 SMAANeighborhoodBlendingPS(vec2 texcoord,vec4 offset[2],sampler2D colorTex,sampler2D blendTex){vec4 a;a.xz=texture2D(blendTex,texcoord).xz;a.y=texture2D(blendTex,offset[1].zw).g;a.w=texture2D(blendTex,offset[1].xy).a;if(dot(a,vec4(1.0,1.0,1.0,1.0))<1e-5){return texture2D(colorTex,texcoord,0.0);}else{vec2 offset;offset.x=a.a>a.b ? a.a :-a.b;offset.y=a.g>a.r ?-a.g : a.r;if(abs(offset.x)>abs(offset.y)){offset.y=0.0;}else{offset.x=0.0;}vec4 C=texture2D(colorTex,texcoord,0.0);texcoord+=sign(offset)*resolution;vec4 Cop=texture2D(colorTex,texcoord,0.0);float s=abs(offset.x)>abs(offset.y)? abs(offset.x): abs(offset.y);C.xyz=pow(C.xyz,vec3(2.2));Cop.xyz=pow(Cop.xyz,vec3(2.2));vec4 mixed=mix(C,Cop,s);mixed.xyz=pow(mixed.xyz,vec3(1.0/2.2));return mixed;}}void main(){gl_FragColor=SMAANeighborhoodBlendingPS(vUv,vOffset,tColor,tDiffuse);}"})),!this.vertexBuffer||!this.sampleBuffer){this.vertexBuffer=new Ov({gl:i,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.sampleBuffer=new Ov({gl:i,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.vertexBuffer.updateData(new Float32Array(this.vertex)),this.sampleBuffer.updateData(new Float32Array(this.sampleCoord));var s=[{stride:12,name:"position",buffer:this.vertexBuffer,size:3,type:"FLOAT",offset:0},{stride:8,name:"uv",buffer:this.sampleBuffer,size:2,type:"FLOAT",offset:0}];this.vertexArray1=new $y({gl:i,program:this.program1,attributes:s}),this.vertexArray2=new $y({gl:i,program:this.program2,attributes:s}),this.vertexArray3=new $y({gl:i,program:this.program3,attributes:s})}return{program1:this.program1,program2:this.program2,program3:this.program3}}},{key:"onResize",value:function(i){this.collectBrightBuffer=new is(i),this.bloomBuffer=new is(i)}},{key:"getExtraFbo",value:function(i){return this.collectBrightBuffer||(this.collectBrightBuffer=new is(i)),this.bloomBuffer||(this.bloomBuffer=new is(i)),{collectBrightBuffer:this.collectBrightBuffer.framebuffer,bloomBuffer:this.bloomBuffer.framebuffer}}},{key:"render",value:function(i){var s=i.gl,f=i.texture;i=i.fbo,this.getOptions(),s.clearColor(0,0,0,0),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT);var c=this.getProgram(s),d=c.program1,p=c.program2;c=c.program3;var A=this.getExtraFbo(s),S=A.collectBrightBuffer;A=A.bloomBuffer;var z=s.createBuffer();s.bindBuffer(s.ARRAY_BUFFER,z),s.bufferData(s.ARRAY_BUFFER,new Float32Array(this.vertex),s.STATIC_DRAW),s.enableVertexAttribArray(d.attributes.position),s.vertexAttribPointer(d.attributes.position,3,s.FLOAT,!1,0,0),s.enableVertexAttribArray(p.attributes.position),s.vertexAttribPointer(p.attributes.position,3,s.FLOAT,!1,0,0),s.enableVertexAttribArray(c.attributes.position),s.vertexAttribPointer(c.attributes.position,3,s.FLOAT,!1,0,0),z=s.createBuffer(),s.bindBuffer(s.ARRAY_BUFFER,z),s.bufferData(s.ARRAY_BUFFER,new Float32Array(this.sampleCoord),s.STATIC_DRAW),s.enableVertexAttribArray(d.attributes.uv),s.vertexAttribPointer(d.attributes.uv,2,s.FLOAT,!1,0,0),s.enableVertexAttribArray(p.attributes.uv),s.vertexAttribPointer(p.attributes.uv,2,s.FLOAT,!1,0,0),s.enableVertexAttribArray(c.attributes.uv),s.vertexAttribPointer(c.attributes.uv,2,s.FLOAT,!1,0,0),s.useProgram(d.program),s.bindFramebuffer(s.FRAMEBUFFER,S),s.clearColor(0,0,0,0),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT),s.activeTexture(s.TEXTURE2),s.bindTexture(s.TEXTURE_2D,f),s.uniform1i(d.uniforms.tDiffuse,2),s.uniform2fv(d.uniforms.resolution,[s.canvas.width,s.canvas.height]),s.drawArrays(s.TRIANGLES,0,this.vertex.length/3),s.useProgram(p.program),s.bindFramebuffer(s.FRAMEBUFFER,A),s.clearColor(0,0,0,0),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT),s.activeTexture(s.TEXTURE2),s.bindTexture(s.TEXTURE_2D,S.texture),s.uniform1i(p.uniforms.uSampler,2),s.uniform2fv(p.uniforms.resolution,[s.canvas.width,s.canvas.height]),s.drawArrays(s.TRIANGLES,0,this.vertex.length/3),s.useProgram(c.program),s.bindFramebuffer(s.FRAMEBUFFER,i),s.clearColor(0,0,0,0),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT),s.activeTexture(s.TEXTURE2),s.bindTexture(s.TEXTURE_2D,f),s.uniform1i(c.uniforms.tDiffuse,2),s.activeTexture(s.TEXTURE3),s.bindTexture(s.TEXTURE_2D,A.texture),s.uniform1i(c.uniforms.tColor,3),s.uniform2fv(c.uniforms.resolution,[s.canvas.width,s.canvas.height]),s.drawArrays(s.TRIANGLES,0,this.vertex.length/3),s.bindBuffer(s.ARRAY_BUFFER,null),s.useProgram(null)}},{key:"getAreaTexture",value:function(){return"data:image/png;base64,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"}},{key:"getSearchTexture",value:function(){return"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEIAAAAhCAIAAADiVupLAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAFZJREFUeNrs00EKgAAIRNEZ739mTQoiwmhRi4L/FiKiu9ERISkzbXdTVV3H4WhfOG6ehl1rNR7qDSF8hwkVcJXt+3A//I0Nv0GoCBUAAAAAAMA/LAIMAB+Dcg2OE2zsAAAAAElFTkSuQmCC"}}]),r}(Qd),function(t){function r(i){return Ai(this,r),Tn(this,(r.__proto__||Wn(r)).call(this,i))}return jn(r,t),Xi(r,[{key:"getProgram",value:function(i){return this.programSample||(this.programSample=new Aa(i,{vertexShader:"attribute vec3 aPos;attribute vec2 aTextureCoord;varying vec2 vTextureCoord;void main(){vTextureCoord=aTextureCoord;gl_Position=vec4(aPos,1.0);}",fragmentShader:"precision mediump float;uniform sampler2D uSampler;varying vec2 vTextureCoord;void main(){float fStep=1.0/512.0;vec4 sample11=texture2D(uSampler,vec2(vTextureCoord.s-1.0*fStep,vTextureCoord.t+1.0*fStep));vec4 sample12=texture2D(uSampler,vec2(vTextureCoord.s,vTextureCoord.t+1.0*fStep));vec4 sample13=texture2D(uSampler,vec2(vTextureCoord.s+1.0*fStep,vTextureCoord.t+1.0*fStep));vec4 sample21=texture2D(uSampler,vec2(vTextureCoord.s-1.0*fStep,vTextureCoord.t));vec4 sample22=texture2D(uSampler,vec2(vTextureCoord.s,vTextureCoord.t));vec4 sample23=texture2D(uSampler,vec2(vTextureCoord.s+1.0*fStep,vTextureCoord.t));vec4 sample31=texture2D(uSampler,vec2(vTextureCoord.s-1.0*fStep,vTextureCoord.t-1.0*fStep));vec4 sample32=texture2D(uSampler,vec2(vTextureCoord.s,vTextureCoord.t-1.0*fStep));vec4 sample33=texture2D(uSampler,vec2(vTextureCoord.s+1.0*fStep,vTextureCoord.t-1.0*fStep));vec4 blurSample=(sample11+sample12+sample13+sample21+2.0*sample22+sample23+sample31+sample32+sample33)/10.0;gl_FragColor=blurSample;}"}),this.vertexBuffer=new Ov({gl:i,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.sampleBuffer=new Ov({gl:i,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.vertexBuffer.updateData(new Float32Array(this.vertex)),this.sampleBuffer.updateData(new Float32Array(this.sampleCoord)),this.vertexArray=new $y({gl:i,program:this.programSample,attributes:[{stride:12,name:"aPos",buffer:this.vertexBuffer,size:3,type:"FLOAT",offset:0},{stride:8,name:"aTextureCoord",buffer:this.sampleBuffer,size:2,type:"FLOAT",offset:0}]})),this.programSample}},{key:"render",value:function(i){var s=i.gl;i=i.texture,s.clearColor(0,0,0,0),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT);var f=this.getProgram(s);f.use(s),this.vertexArray.bind(),s.activeTexture(s.TEXTURE1),s.bindTexture(s.TEXTURE_2D,i),s.uniform1i(f.uniforms.uSampler,1),s.drawArrays(s.TRIANGLES,0,this.vertex.length/3)}}]),r}(Qd),function(t){function r(i){return Ai(this,r),Tn(this,(r.__proto__||Wn(r)).call(this,i))}return jn(r,t),Xi(r,[{key:"getProgram",value:function(i){return this.programBright||(this.programBright=new Aa(i,{vertexShader:"attribute vec3 aPos;attribute vec2 aTextureCoord;varying vec2 vTextureCoord;void main(){vTextureCoord=aTextureCoord;gl_Position=vec4(aPos,1.0);}",fragmentShader:"precision mediump float;uniform sampler2D uSampler;uniform float threshold;varying vec2 vTextureCoord;void main(){vec4 color=texture2D(uSampler,vTextureCoord);vec4 lightColor=max(vec4(0.0),(color-(1.0-threshold)/5.0));float brightness=dot(color.rgb,vec3(0.2126,0.7152,0.0722));if(brightness>threshold){color=lightColor;}else{color=vec4(0.0);}gl_FragColor=color;}"})),this.programBloom||(this.programBloom=new Aa(i,{vertexShader:"attribute vec3 aPos;attribute vec2 aTextureCoord;varying vec2 vTextureCoord;void main(){vTextureCoord=aTextureCoord;gl_Position=vec4(aPos,1.0);}",fragmentShader:"precision mediump float;uniform sampler2D uSampler;uniform bool isVertical;uniform vec2 canvasSize;uniform float blurSize;uniform float devicePixelRatio;varying vec2 vTextureCoord;void main(){float weight[10];weight[0]=0.2270270270;weight[1]=0.1945945946;weight[2]=0.1216216216;weight[3]=0.1135135135;weight[4]=0.0972972973;weight[5]=0.0608108108;weight[6]=0.0540540541;weight[7]=0.0270270270;weight[8]=0.0162162162;weight[9]=0.0081081081;vec2 offset=vec2(blurSize/canvasSize.x,blurSize/canvasSize.y)*devicePixelRatio;vec4 result=texture2D(uSampler,vTextureCoord)*weight[0];if(isVertical){for(int i=1;i<10;++i){result+=texture2D(uSampler,vTextureCoord+vec2(0.0,offset.y*float(i)))*weight[i];result+=texture2D(uSampler,vTextureCoord-vec2(0.0,offset.y*float(i)))*weight[i];}}else{for(int i=1;i<10;++i){result+=texture2D(uSampler,vTextureCoord+vec2(offset.x*float(i),0.0))*weight[i];result+=texture2D(uSampler,vTextureCoord-vec2(offset.x*float(i),0.0))*weight[i];}}gl_FragColor=result;}"})),this.programResult||(this.programResult=new Aa(i,{vertexShader:"attribute vec3 aPos;attribute vec2 aTextureCoord;varying vec2 vTextureCoord;void main(){vTextureCoord=aTextureCoord;gl_Position=vec4(aPos,1.0);}",fragmentShader:"precision mediump float;uniform sampler2D originalTexture;uniform sampler2D bloomTexture;varying vec2 vTextureCoord;void main(){vec4 color=texture2D(originalTexture,vTextureCoord);vec4 bloomColor=texture2D(bloomTexture,vTextureCoord);color+=bloomColor;gl_FragColor=color;}"})),{programBright:this.programBright,programBloom:this.programBloom,programResult:this.programResult}}},{key:"onResize",value:function(i){this.collectBrightBuffer=new is(i),this.bloomBuffer=new is(i)}},{key:"getExtraFbo",value:function(i){return this.collectBrightBuffer||(this.collectBrightBuffer=new is(i)),this.bloomBuffer||(this.bloomBuffer=new is(i)),{collectBrightBuffer:this.collectBrightBuffer.framebuffer,bloomBuffer:this.bloomBuffer.framebuffer}}},{key:"render",value:function(i){var s=i.gl,f=i.texture;i=i.fbo;var c=this.getOptions();s.clearColor(0,0,0,0),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT);var d=this.getProgram(s),p=d.programBright,A=d.programBloom;d=d.programResult;var S=this.getExtraFbo(s),z=S.collectBrightBuffer;S=S.bloomBuffer;var w=s.createBuffer();s.bindBuffer(s.ARRAY_BUFFER,w),s.bufferData(s.ARRAY_BUFFER,new Float32Array(this.vertex),s.STATIC_DRAW),s.enableVertexAttribArray(p.attributes.aPos),s.vertexAttribPointer(p.attributes.aPos,3,s.FLOAT,!1,0,0),s.enableVertexAttribArray(A.attributes.aPos),s.vertexAttribPointer(A.attributes.aPos,3,s.FLOAT,!1,0,0),s.enableVertexAttribArray(d.attributes.aPos),s.vertexAttribPointer(d.attributes.aPos,3,s.FLOAT,!1,0,0),w=s.createBuffer(),s.bindBuffer(s.ARRAY_BUFFER,w),s.bufferData(s.ARRAY_BUFFER,new Float32Array(this.sampleCoord),s.STATIC_DRAW),s.enableVertexAttribArray(p.attributes.aTextureCoord),s.vertexAttribPointer(p.attributes.aTextureCoord,2,s.FLOAT,!1,0,0),s.enableVertexAttribArray(A.attributes.aTextureCoord),s.vertexAttribPointer(A.attributes.aTextureCoord,2,s.FLOAT,!1,0,0),s.enableVertexAttribArray(d.attributes.aTextureCoord),s.vertexAttribPointer(d.attributes.aTextureCoord,2,s.FLOAT,!1,0,0),s.useProgram(p.program),s.bindFramebuffer(s.FRAMEBUFFER,z),s.clearColor(0,0,0,0),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT),s.activeTexture(s.TEXTURE1),s.bindTexture(s.TEXTURE_2D,f),s.uniform1i(p.uniforms.uSampler,1),s.uniform1f(p.uniforms.threshold,c.threshold||0),s.drawArrays(s.TRIANGLES,0,this.vertex.length/3),s.useProgram(A.program),s.bindFramebuffer(s.FRAMEBUFFER,S),s.clearColor(0,0,0,0),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT),s.activeTexture(s.TEXTURE1),s.bindTexture(s.TEXTURE_2D,z.texture),s.uniform1i(A.uniforms.uSampler,1),s.uniform1i(A.uniforms.isVertical,!0),s.uniform1f(A.uniforms.blurSize,c.blurSize||2),s.uniform1f(A.uniforms.devicePixelRatio,window.devicePixelRatio),s.uniform2fv(A.uniforms.canvasSize,[s.canvas.width,s.canvas.height]),s.drawArrays(s.TRIANGLES,0,this.vertex.length/3),s.useProgram(A.program),s.bindFramebuffer(s.FRAMEBUFFER,z),s.clearColor(0,0,0,0),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT),s.activeTexture(s.TEXTURE1),s.bindTexture(s.TEXTURE_2D,S.texture),s.uniform1i(A.uniforms.uSampler,1),s.uniform1i(A.uniforms.isVertical,!1),s.uniform1f(A.uniforms.blurSize,c.blurSize||2),s.uniform1f(A.uniforms.devicePixelRatio,window.devicePixelRatio),s.uniform2fv(A.uniforms.canvasSize,[s.canvas.width,s.canvas.height]),s.drawArrays(s.TRIANGLES,0,this.vertex.length/3),s.useProgram(d.program),s.bindFramebuffer(s.FRAMEBUFFER,i),s.clearColor(0,0,0,0),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT),s.activeTexture(s.TEXTURE1),s.bindTexture(s.TEXTURE_2D,f),s.uniform1i(d.uniforms.originalTexture,1),s.activeTexture(s.TEXTURE0),s.bindTexture(s.TEXTURE_2D,z.texture),s.uniform1i(d.uniforms.bloomTexture,0),s.drawArrays(s.TRIANGLES,0,this.vertex.length/3),s.bindBuffer(s.ARRAY_BUFFER,null),s.useProgram(null)}}]),r}(Qd),function(t){function r(i){return Ai(this,r),Tn(this,(r.__proto__||Wn(r)).call(this,i))}return jn(r,t),Xi(r,[{key:"getProgram",value:function(i){return this.programBright||(this.programBright=new Aa(i,{vertexShader:"attribute vec3 aPos;attribute vec2 aTextureCoord;varying vec2 vTextureCoord;void main(){vTextureCoord=aTextureCoord;gl_Position=vec4(aPos,1.0);}",fragmentShader:"precision mediump float;uniform sampler2D uSampler;uniform float threshold;varying vec2 vTextureCoord;void main(){vec4 color=texture2D(uSampler,vTextureCoord);vec4 lightColor=max(vec4(0.0),(color-threshold));gl_FragColor=lightColor;}"})),this.programBloom||(this.programBloom=new Aa(i,{vertexShader:"attribute vec3 aPos;attribute vec2 aTextureCoord;varying vec2 vTextureCoord;void main(){vTextureCoord=aTextureCoord;gl_Position=vec4(aPos,1.0);}",fragmentShader:"precision mediump float;uniform sampler2D uSampler;uniform bool isVertical;uniform vec2 canvasSize;uniform float blurSize;uniform float devicePixelRatio;varying vec2 vTextureCoord;void main(){float weight[10];weight[0]=0.2270270270;weight[1]=0.1945945946;weight[2]=0.1216216216;weight[3]=0.1135135135;weight[4]=0.0972972973;weight[5]=0.0608108108;weight[6]=0.0540540541;weight[7]=0.0270270270;weight[8]=0.0162162162;weight[9]=0.0081081081;vec2 offset=vec2(blurSize/canvasSize.x,blurSize/canvasSize.y)*devicePixelRatio;vec4 result=texture2D(uSampler,vTextureCoord)*weight[0];if(isVertical){for(int i=1;i<10;++i){result+=texture2D(uSampler,vTextureCoord+vec2(0.0,offset.y*float(i)))*weight[i];result+=texture2D(uSampler,vTextureCoord-vec2(0.0,offset.y*float(i)))*weight[i];}}else{for(int i=1;i<10;++i){result+=texture2D(uSampler,vTextureCoord+vec2(offset.x*float(i),0.0))*weight[i];result+=texture2D(uSampler,vTextureCoord-vec2(offset.x*float(i),0.0))*weight[i];}}gl_FragColor=result;}"})),this.programResult||(this.programResult=new Aa(i,{vertexShader:"attribute vec3 aPos;attribute vec2 aTextureCoord;varying vec2 vTextureCoord;void main(){vTextureCoord=aTextureCoord;gl_Position=vec4(aPos,1.0);}",fragmentShader:"precision mediump float;uniform sampler2D originalTexture;uniform sampler2D bloomTexture;uniform float toneScale;varying vec2 vTextureCoord;void main(){vec4 color=texture2D(originalTexture,vTextureCoord)*toneScale;vec4 bloomColor=texture2D(bloomTexture,vTextureCoord);color+=bloomColor;gl_FragColor=color;}"})),{programBright:this.programBright,programBloom:this.programBloom,programResult:this.programResult}}},{key:"onResize",value:function(i){this.collectBrightBuffer=new is(i),this.bloomBuffer=new is(i)}},{key:"getExtraFbo",value:function(i){return this.collectBrightBuffer||(this.collectBrightBuffer=new is(i)),this.bloomBuffer||(this.bloomBuffer=new is(i)),{collectBrightBuffer:this.collectBrightBuffer.framebuffer,bloomBuffer:this.bloomBuffer.framebuffer}}},{key:"render",value:function(i){var s=i.gl,f=i.texture;i=i.fbo;var c=this.getOptions(),d="clarity"in c?c.clarity:1;d=Math.max(0,d),d=Math.min(1,d),s.clearColor(0,0,0,0),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT);var p=this.getProgram(s),A=p.programBright,S=p.programBloom;p=p.programResult;var z=this.getExtraFbo(s),w=z.collectBrightBuffer;z=z.bloomBuffer;var I=s.createBuffer();s.bindBuffer(s.ARRAY_BUFFER,I),s.bufferData(s.ARRAY_BUFFER,new Float32Array(this.vertex),s.STATIC_DRAW),s.enableVertexAttribArray(A.attributes.aPos),s.vertexAttribPointer(A.attributes.aPos,3,s.FLOAT,!1,0,0),s.enableVertexAttribArray(S.attributes.aPos),s.vertexAttribPointer(S.attributes.aPos,3,s.FLOAT,!1,0,0),s.enableVertexAttribArray(p.attributes.aPos),s.vertexAttribPointer(p.attributes.aPos,3,s.FLOAT,!1,0,0),I=s.createBuffer(),s.bindBuffer(s.ARRAY_BUFFER,I),s.bufferData(s.ARRAY_BUFFER,new Float32Array(this.sampleCoord),s.STATIC_DRAW),s.enableVertexAttribArray(A.attributes.aTextureCoord),s.vertexAttribPointer(A.attributes.aTextureCoord,2,s.FLOAT,!1,0,0),s.enableVertexAttribArray(S.attributes.aTextureCoord),s.vertexAttribPointer(S.attributes.aTextureCoord,2,s.FLOAT,!1,0,0),s.enableVertexAttribArray(p.attributes.aTextureCoord),s.vertexAttribPointer(p.attributes.aTextureCoord,2,s.FLOAT,!1,0,0),s.useProgram(A.program),s.bindFramebuffer(s.FRAMEBUFFER,w),s.clearColor(0,0,0,0),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT),s.activeTexture(s.TEXTURE1),s.bindTexture(s.TEXTURE_2D,f),s.uniform1i(A.uniforms.uSampler,1),s.uniform1f(A.uniforms.threshold,c.threshold||0),s.drawArrays(s.TRIANGLES,0,this.vertex.length/3),s.useProgram(S.program),s.bindFramebuffer(s.FRAMEBUFFER,z),s.clearColor(0,0,0,0),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT),s.activeTexture(s.TEXTURE1),s.bindTexture(s.TEXTURE_2D,w.texture),s.uniform1i(S.uniforms.uSampler,1),s.uniform1i(S.uniforms.isVertical,!0),s.uniform1f(S.uniforms.blurSize,c.blurSize||2),s.uniform1f(S.uniforms.devicePixelRatio,window.devicePixelRatio),s.uniform2fv(S.uniforms.canvasSize,[s.canvas.width,s.canvas.height]),s.drawArrays(s.TRIANGLES,0,this.vertex.length/3),s.useProgram(S.program),s.bindFramebuffer(s.FRAMEBUFFER,w),s.clearColor(0,0,0,0),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT),s.activeTexture(s.TEXTURE1),s.bindTexture(s.TEXTURE_2D,z.texture),s.uniform1i(S.uniforms.uSampler,1),s.uniform1i(S.uniforms.isVertical,!1),s.uniform1f(S.uniforms.blurSize,c.blurSize||2),s.uniform1f(S.uniforms.devicePixelRatio,window.devicePixelRatio),s.uniform2fv(S.uniforms.canvasSize,[s.canvas.width,s.canvas.height]),s.drawArrays(s.TRIANGLES,0,this.vertex.length/3),s.useProgram(p.program),s.bindFramebuffer(s.FRAMEBUFFER,i),s.clearColor(0,0,0,0),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT),s.activeTexture(s.TEXTURE1),s.bindTexture(s.TEXTURE_2D,f),s.uniform1i(p.uniforms.originalTexture,1),s.uniform1f(p.uniforms.toneScale,d),s.activeTexture(s.TEXTURE0),s.bindTexture(s.TEXTURE_2D,w.texture),s.uniform1i(p.uniforms.bloomTexture,0),s.drawArrays(s.TRIANGLES,0,this.vertex.length/3),s.bindBuffer(s.ARRAY_BUFFER,null),s.useProgram(null)}}]),r}(Qd),function(t){function r(i){return Ai(this,r),Tn(this,(r.__proto__||Wn(r)).call(this,i))}return jn(r,t),Xi(r,[{key:"getProgram",value:function(i){return this.programSample||(this.programSample=new Aa(i,{vertexShader:"attribute vec3 aPos;attribute vec2 aTextureCoord;varying vec2 vTextureCoord;void main(){vTextureCoord=aTextureCoord;gl_Position=vec4(aPos,1.0);}",fragmentShader:"precision mediump float;uniform sampler2D uSampler;uniform vec2 canvasSize;varying vec2 vTextureCoord;void main(){float fStep=1.0/312.0;vec4 sample11=texture2D(uSampler,vec2(vTextureCoord.s-1.0*fStep,vTextureCoord.t+1.0*fStep));vec4 sample12=texture2D(uSampler,vec2(vTextureCoord.s,vTextureCoord.t+1.0*fStep));vec4 sample13=texture2D(uSampler,vec2(vTextureCoord.s+1.0*fStep,vTextureCoord.t+1.0*fStep));vec4 sample21=texture2D(uSampler,vec2(vTextureCoord.s-1.0*fStep,vTextureCoord.t));vec4 sample22=texture2D(uSampler,vec2(vTextureCoord.s,vTextureCoord.t));vec4 sample23=texture2D(uSampler,vec2(vTextureCoord.s+1.0*fStep,vTextureCoord.t));vec4 sample31=texture2D(uSampler,vec2(vTextureCoord.s-1.0*fStep,vTextureCoord.t-1.0*fStep));vec4 sample32=texture2D(uSampler,vec2(vTextureCoord.s,vTextureCoord.t-1.0*fStep));vec4 sample33=texture2D(uSampler,vec2(vTextureCoord.s+1.0*fStep,vTextureCoord.t-1.0*fStep));vec4 blurSample=(sample11+sample12+sample13+sample21+2.0*sample22+sample23+sample31+sample32+sample33)/10.0;float desX=abs((gl_FragCoord.x-canvasSize.x/2.0)/(canvasSize.x/2.0));float desY=abs((gl_FragCoord.y-canvasSize.y/2.0)/(canvasSize.y/2.0));float factor=max(desX,desY);gl_FragColor=(sample22*(1.0-factor)+blurSample*factor);}"})),this.programSample}},{key:"render",value:function(i){var s=i.gl;i=i.texture;var f=this.getProgram(s);s.useProgram(f.program);var c=s.createBuffer();s.bindBuffer(s.ARRAY_BUFFER,c),s.bufferData(s.ARRAY_BUFFER,new Float32Array(this.vertex),s.STATIC_DRAW),s.enableVertexAttribArray(f.attributes.aPos),s.vertexAttribPointer(f.attributes.aPos,3,s.FLOAT,!1,0,0),c=s.createBuffer(),s.bindBuffer(s.ARRAY_BUFFER,c),s.bufferData(s.ARRAY_BUFFER,new Float32Array(this.sampleCoord),s.STATIC_DRAW),s.enableVertexAttribArray(f.attributes.aTextureCoord),s.vertexAttribPointer(f.attributes.aTextureCoord,2,s.FLOAT,!1,0,0),s.activeTexture(s.TEXTURE1),s.bindTexture(s.TEXTURE_2D,i),s.uniform1i(f.uniforms.uSampler,1),s.uniform2fv(f.uniforms.canvasSize,[s.canvas.width,s.canvas.height]),s.drawArrays(s.TRIANGLES,0,this.vertex.length/3)}}]),r}(Qd);var LE=function(){function t(r){Ai(this,t),this.gl=r,this.effects=[],this.initFbo()}return Xi(t,[{key:"addEffect",value:function(r){this.effects.push(r)}},{key:"removeEffect",value:function(r){}},{key:"setEffects",value:function(r){this.effects=r}},{key:"onResize",value:function(){this.initFbo();var r=this.gl,i=this.effects;if(i&&1<i.length)for(var s=1;s<i.length;s++){var f=i[s];f.onResize&&f.onResize(r)}}},{key:"initFbo",value:function(){var r=this.gl;r&&(this.fbo=[new is(r),new is(r)])}},{key:"destroy",value:function(){this.effects=[],this.fbo=[],this.gl=null}},{key:"render",value:function(){var r=this.gl,i=this.effects;if(i&&0<i.length)for(var s={},f=0;f<i.length;f++){var c=this.fbo[f%2].framebuffer;f===i.length-1&&(c=null),r.bindFramebuffer(r.FRAMEBUFFER,c);var d=[0,0,0,0];r.clearColor(d[0],d[1],d[2],d[3]),r.clear(r.COLOR_BUFFER_BIT|r.DEPTH_BUFFER_BIT),i[f].render({isPickRender:!1,gl:r,texture:s.texture,fbo:c}),s=c}}}]),t}(),Fv=function(){function t(r,i){Ai(this,t),this.map=r,this.options=i||{},this.eventMap={}}return Xi(t,[{key:"onResize",value:function(r){}},{key:"onUpdate",value:function(r){throw"\u672A\u5B9E\u73B0onUpdate\u65B9\u6CD5"}},{key:"getContainer",value:function(){throw"\u672A\u5B9E\u73B0getContainer\u65B9\u6CD5"}},{key:"getSize",value:function(){throw"\u672A\u5B9E\u73B0getSize\u65B9\u6CD5"}},{key:"getTilt",value:function(){throw"\u672A\u5B9E\u73B0getTilt\u65B9\u6CD5"}},{key:"getHeading",value:function(){throw"\u672A\u5B9E\u73B0getHeading\u65B9\u6CD5"}},{key:"getZoomUnits",value:function(){throw"\u672A\u5B9E\u73B0getZoomUnits\u65B9\u6CD5"}},{key:"getCenter",value:function(){throw"\u672A\u5B9E\u73B0getCenter\u65B9\u6CD5"}},{key:"getMapType",value:function(){throw"\u672A\u5B9E\u73B0getMapType\u65B9\u6CD5"}},{key:"lnglatToMercator",value:function(r,i){return this.options.coordinateSystem==="gcj02"?(i=i*Math.PI/180,i=31890685e-1*Math.log((1+Math.sin(i))/(1-Math.sin(i))),[parseFloat((r*Math.PI/180*6378137).toFixed(2)),parseFloat(i.toFixed(2))]):(r=Bs.convertLL2MC({lng:r,lat:i}),[r.lng,r.lat])}}]),t}(),RE=function(t){function r(i){return Ai(this,r),i=Tn(this,(r.__proto__||Wn(r)).call(this,i)),i.eventMap={},i}return jn(r,t),Xi(r,[{key:"onResize",value:function(i){this.map.addEventListener("resize",i),this.eventMap.resize=i}},{key:"onMousemove",value:function(i){i=this.extendCallback(i),this.map.addEventListener("mousemove",i),this.eventMap.mousemove=i}},{key:"onClick",value:function(i){i=this.extendCallback(i),this.map.addEventListener("click",i),this.eventMap.click=i}},{key:"onDblClick",value:function(i){i=this.extendCallback(i),this.map.addEventListener("dblclick",i),this.eventMap.dblclick=i}},{key:"onRightClick",value:function(i){i=this.extendCallback(i),this.map.addEventListener("rightclick",i),this.eventMap.rightclick=i}},{key:"onUpdate",value:function(i){this.map.addEventListener("update",i),this.map.addEventListener("onearthstatuschange",i),this.eventMap.update=i,this.eventMap.onearthstatuschange=i}},{key:"extendCallback",value:function(i){return function(s){i(pt(s,{x:s.x,y:s.y}))}}},{key:"unbind",value:function(i){var s=this;this.eventMap[i]?(this.map.removeEventListener(i,this.eventMap[i]),delete this.eventMap[i]):(Ti(this.eventMap).forEach(function(f){s.map.removeEventListener(f,s.eventMap[f])}),this.eventMap={})}},{key:"getContainer",value:function(){return this.map.getContainer()}},{key:"getSize",value:function(){return this.map.getSize()}},{key:"getBounds",value:function(){return this.map.getBounds()}},{key:"getTilt",value:function(){return this.map.getTilt()}},{key:"getHeading",value:function(){return this.map.getHeading()}},{key:"getZoomUnits",value:function(){return this.map.getZoomUnits()}},{key:"getZoom",value:function(){return this.map.getZoom()}},{key:"getCenter",value:function(){var i=this.map.getCenter();return-180<=i.lng&&180>=i.lng&&(i=this.map.lnglatToMercator(i.lng,i.lat),i={lng:i[0],lat:i[1]}),i}},{key:"getMapType",value:function(){return this.map.getMapType()}},{key:"lnglatToMercator",value:function(i,s){return this.map.lnglatToMercator(i,s)}},{key:"mercatorToLnglat",value:function(i,s){return this.map.mercatorToLnglat(i,s)}},{key:"pixelToPointIn",value:function(i){return i=this.map.pixelToPointIn(i),this.mercatorToLnglat(i.lng,i.lat)}}]),r}(Fv),PE=function(t){function r(i){return Ai(this,r),i=Tn(this,(r.__proto__||Wn(r)).call(this,i)),i.div=document.createElement("div"),i.div.style.position="absolute",i.div.style.userSelect="none",i.map.getPanes().mapPane.appendChild(i.div),i.eventMap={},i}return jn(r,t),Xi(r,[{key:"onResize",value:function(i){this.map.addEventListener("resize",i),this.eventMap.resize=i}},{key:"onMousemove",value:function(i){i=this.extendCallback(i),this.map.addEventListener("mousemove",i),this.eventMap.mousemove=i}},{key:"onClick",value:function(i){i=this.extendCallback(i),_E?(this.map.addEventListener("touchend",i),this.eventMap.touchend=i):(this.map.addEventListener("click",i),this.eventMap.click=i)}},{key:"onDblClick",value:function(i){i=this.extendCallback(i),this.map.addEventListener("dblclick",i),this.eventMap.dblclick=i}},{key:"onRightClick",value:function(i){i=this.extendCallback(i),this.map.addEventListener("rightclick",i),this.eventMap.rightclick=i}},{key:"changeCanvas",value:function(){var i=this.map,s=i.getSize(),f=i.getCenter();i=i.pointToOverlayPixel(f),this.div.style.left=i.x-s.width/2+"px",this.div.style.top=i.y-s.height/2+"px"}},{key:"onUpdate",value:function(i){var s=this,f=function(){s.changeCanvas(),i()};this.map.addEventListener("moveend",f),this.map.addEventListener("moving",f),this.map.addEventListener("zoomend",f),this.eventMap.moveend=f,this.eventMap.moving=f,this.eventMap.zoomend=f}},{key:"extendCallback",value:function(i){return function(s){i(pt(s,{x:s.pixel.x,y:s.pixel.y}))}}},{key:"unbind",value:function(){var i=this;Ti(this.eventMap).forEach(function(s){i.map.removeEventListener(s,i.eventMap[s])}),this.eventMap={}}},{key:"getContainer",value:function(){return this.div}},{key:"getSize",value:function(){return this.map.getSize()}},{key:"getBounds",value:function(){return this.map.getBounds()}},{key:"getTilt",value:function(){return 0}},{key:"getHeading",value:function(){return 0}},{key:"getZoom",value:function(){return this.map.getZoom()}},{key:"getZoomUnits",value:function(){var i=this.getZoom();return this.map.getMapType().getZoomUnits?this.map.getMapType().getZoomUnits(i):Math.pow(2,18-i)}},{key:"getCenter",value:function(){var i=this.map.getMapType().getProjection().lngLatToPoint(this.map.getCenter());return{lng:i.x,lat:i.y}}},{key:"lnglatToMercator",value:function(i,s){return i=this.map.getMapType().getProjection().lngLatToPoint({lng:i,lat:s}),[i.x,i.y]}},{key:"mercatorToLnglat",value:function(i,s){return i=this.map.getMapType().getProjection().pointToLngLat({lng:i,lat:s}),[i.lng,i.lat]}}]),r}(Fv),DE=function(t){function r(i){return Ai(this,r),i=Tn(this,(r.__proto__||Wn(r)).call(this,i)),i.eventMap={},i}return jn(r,t),Xi(r,[{key:"onResize",value:function(i){window.addEventListener("resize",i),this.eventMap.resize=i}},{key:"onUpdate",value:function(i){}},{key:"unbind",value:function(){var i=this;Ti(this.eventMap).forEach(function(s){window.removeEventListener(s,i.eventMap[s])}),this.eventMap={}}},{key:"getContainer",value:function(){return this.map.container.getElementsByClassName("cesium-widget")[0]}},{key:"getSize",value:function(){var i=this.map;return{width:i.canvas.clientWidth,height:i.canvas.clientHeight}}},{key:"getTilt",value:function(){return 180*this.map.camera.pitch/Math.PI+90}},{key:"getHeading",value:function(){return 360-180*this.map.camera.heading/Math.PI}},{key:"getZoomUnits",value:function(){var i=this.map;return 6.8*i.scene.globe.ellipsoid.cartesianToCartographic(i.camera.position).height/6500}},{key:"getZoom",value:function(){return 10}},{key:"getCenter",value:function(){var i=this.map;return i=i.camera.pickEllipsoid(new Cesium.Cartesian2(i.canvas.clientWidth/2,i.canvas.clientHeight/2)),i=Cesium.Ellipsoid.WGS84.cartesianToCartographic(i),i=this.getMercator([180*i.longitude/Math.PI,180*i.latitude/Math.PI]),{lng:i[0],lat:i[1]}}},{key:"getMercator",value:function(i){var s=[];return s[0]=i[0]*Math.PI/180*6378137,i=i[1]*Math.PI/180,s[1]=31890685e-1*Math.log((1+Math.sin(i))/(1-Math.sin(i))),s}}]),r}(Fv),OE=function(t){function r(i){return Ai(this,r),i=Tn(this,(r.__proto__||Wn(r)).call(this,i)),i.eventMap={},i}return jn(r,t),Xi(r,[{key:"onResize",value:function(i){window.addEventListener("resize",i),this.eventMap.resize=i}},{key:"onUpdate",value:function(i){}},{key:"unbind",value:function(){var i=this;Ti(this.eventMap).forEach(function(s){window.removeEventListener(s,i.eventMap[s])}),this.eventMap={}}},{key:"getContainer",value:function(){return this.map.container}},{key:"getSize",value:function(){return{width:this.map.container.clientWidth,height:this.map.container.clientHeight}}},{key:"getTilt",value:function(){return this.map.tilt}},{key:"getHeading",value:function(){return this.map.heading}},{key:"getZoomUnits",value:function(){return this.map.zoomUnits}},{key:"getZoom",value:function(){return this.map.zoom}},{key:"getCenter",value:function(){return this.map.center}}]),r}(Fv),FE=function(t){function r(i,s){return Ai(this,r),i=Tn(this,(r.__proto__||Wn(r)).call(this,i,s)),i.eventMap={},i}return jn(r,t),Xi(r,[{key:"onResize",value:function(i){window.addEventListener("resize",i),this.eventMap.resize=i}},{key:"onUpdate",value:function(i){}},{key:"unbind",value:function(){var i=this;Ti(this.eventMap).forEach(function(s){window.removeEventListener(s,i.eventMap[s])}),this.eventMap={}}},{key:"getContainer",value:function(){return this.map.container}},{key:"getSize",value:function(){return{width:this.map.container.clientWidth,height:this.map.container.clientHeight}}},{key:"getTilt",value:function(){return this.map.tilt}},{key:"getHeading",value:function(){return this.map.heading}},{key:"getZoomUnits",value:function(){return this.map.zoomUnits}},{key:"getCenter",value:function(){return this.map.center}}]),r}(Fv),BE=function(){function t(r,i){var s=this;Ai(this,t),i=i||{},i.mapType==="bmap"?this.map=new PE(r,i):i.mapType==="blank"?this.map=new OE(r,i):i.mapType==="cesium"?this.map=new DE(r,i):i.mapType==="three"?this.map=new FE(r,i):(i.mapType="bmapgl",this.map=new RE(r,i)),this.map.type=i.mapType,this._dpr=window.devicePixelRatio,i.mapType==="bmapgl"&&(this._dpr=this.map.map.config.ratio),this.options=i||{},this.renderArr=[],(r=i.canvas)||(r=document.createElement("canvas")),this.canvas=r,this.gl=i.gl?i.gl:MA(r,i),["OES_texture_float","OES_element_index_uint","WEBGL_color_buffer_float","EXT_float_blend"].forEach(function(f){s.gl.getExtension(f)}),this.changeSize(),this.projectionMatrix=mo.create(Float64Array),this.orthoMatrix=mo.create(Float64Array),this.matrix=mo.create(Float64Array),this.viewMatrix=mo.create(Float64Array),this.pointToPixelMatrix=mo.create(Float64Array),this.pixelToViewMatrix=mo.create(Float64Array),this.fovy=35,this.fps=Math.min(i.fps,60)||60,this.renderTime=new Date().valueOf(),this._animation=this.animation.bind(this),this._update=this.update.bind(this),this.onInitialize(this.options.onInitialize),this.options.onRender&&this.renderArr.push(this.options.onRender),this.stateManager=new IE({gl:this.gl}),this.pickFBO=new is(this.gl),this.transferOptions={},this.bind()}return Xi(t,[{key:"bind",value:function(){var r=this,i=this.map;i.onResize(function(){r.changeSize(),r.render()}),i.onUpdate(this._update),i.onClick&&i.onClick(function(s){r.onClick&&r.onClick(s)}),i.onDblClick&&i.onDblClick(function(s){r.onDblClick&&r.onDblClick(s)}),i.onRightClick&&i.onRightClick(function(s){r.onRightClick&&r.onRightClick(s)}),i.onMousemove&&i.onMousemove(function(s){r.onMousemove&&r.onMousemove(s)}),this.options.canvas||i.getContainer().appendChild(this.canvas)}},{key:"unbind",value:function(){var r=this.map;r.unbind&&r.unbind()}},{key:"setOptions",value:function(r){this.options=r}},{key:"onInitialize",value:function(r){r&&(this.transferOptions=r.bind(this)(this.gl)||{})}},{key:"bindFramebuffer",value:function(r){var i=this.gl;r?i.bindFramebuffer(i.FRAMEBUFFER,r.framebuffer):i.bindFramebuffer(i.FRAMEBUFFER,null)}},{key:"saveFramebuffer",value:function(){var r=this.gl;this.preFramebuffer=r.getParameter(r.FRAMEBUFFER_BINDING)}},{key:"restoreFramebuffer",value:function(){var r=this.gl;r.bindFramebuffer(r.FRAMEBUFFER,this.preFramebuffer)}},{key:"onRender",value:function(r){this.renderArr.push(r)}},{key:"changeSize",value:function(){var r=this.canvas,i=this.options;if(r){var s=r.style,f=this.map.getSize(),c=this._dpr;r.width=f.width*c,r.height=f.height*c,s.cssText="position: absolute;left:0;top:0;width:"+f.width+"px;height:"+f.height+"px;z-index:2;",i.mapType!=="cesium"||i.canvas||(s.pointerEvents="none"),this.gl.viewport(0,0,r.width,r.height)}}},{key:"update",value:function(){this.options.autoUpdate===!1||this.isAnimation&&60<=this.fps||this.render()}},{key:"pixelToPointIn",value:function(r){return this.map.pixelToPointIn(r)}},{key:"render",value:function(){if(this.map&&this.gl){var r=this.options,i=this.projectionMatrix,s=this.viewMatrix;if(r.mapType==="three")s=this.map.map.camera,i=s.projectionMatrix.elements,s=s.matrixWorldInverse.elements;else if(r.mapType==="cesium"){s=this.map.map;var f=s.camera.frustum.projectionMatrix;i=new Float32Array([f[0],f[1],f[2],f[3],f[4],f[5],f[6],f[7],f[8],f[9],f[10],f[11],f[12],f[13],f[14],f[15]]),f=s.camera.viewMatrix,s=new Float32Array([f[0],f[1],f[2],f[3],f[4],f[5],f[6],f[7],f[8],f[9],f[10],f[11],f[12],f[13],f[14],f[15]])}else this.map.map.mapType==="B_EARTH_MAP"?(i=this.map.map.getEarth().scene._camera.getProjectionMatrix(),s=this.map.map.getEarth().scene._camera.getModelViewMatrix()):(this.updateProjectionMatrix(),this.updateModelViewMatrix());for(f=mo.multiply(this.matrix,i,s),pt(this.transferOptions,{gl:this.gl,matrix:f,pointToPixelMatrix:this.pointToPixelMatrix,pixelToViewMatrix:this.pixelToViewMatrix,projectionMatrix:i,orthoMatrix:this.orthoMatrix,viewMatrix:s,stateManager:this.stateManager}),r.mapType!=="three"&&r.mapType!=="cesium"&&r.autoUpdate!==!1&&this.clear(),r=0;r<this.renderArr.length;r++)this.renderArr[r]&&this.renderArr[r].bind(this)(this.transferOptions)}}},{key:"clear",value:function(r){var i=this.gl,s=this.options.clearColor||[0,0,0,0];i.clearColor(s[0],s[1],s[2],s[3]),r&&(r instanceof Array||(r=Vn(r).unitArray()),i.clearColor(r[0],r[1],r[2],r[3])),i.clear(i.COLOR_BUFFER_BIT|i.DEPTH_BUFFER_BIT)}},{key:"updateProjectionMatrix",value:function(){var r=this.options.cameraNear||1,i=this.options.cameraFar||4e3;mo.perspective(this.projectionMatrix,this.fovy*Math.PI/180,this.gl.canvas.width/this.gl.canvas.height,r,i);var s=this.map.getSize();mo.ortho(this.orthoMatrix,-s.width/2,s.width/2,-s.height/2,s.height/2,r,i)}},{key:"updateModelViewMatrix",value:function(){var r=this.map,i=this.viewMatrix,s=this.pointToPixelMatrix,f=this.pixelToViewMatrix;mo.identity(i),mo.identity(s),mo.identity(f);var c=r.getSize();mo.translate(f,f,[0,0,Math.round(-c.height/(2*Math.tan(this.fovy*Math.PI/180/2)))]),mo.rotate(f,f,r.getTilt()*Math.PI/180,[-1,0,0]),mo.rotate(f,f,r.getHeading()*Math.PI/180,[0,0,-1]),c=r.getCenter();var d=this.options.pointOffset||[0,0];r=r.getZoomUnits(),mo.translate(s,s,[(d[0]-c.lng)/r,(d[1]-c.lat)/r,0]),r=1/r,mo.scale(s,s,[r,r,r]),mo.multiply(i,f,s)}},{key:"destroy",value:function(){this.stopAnimation(),this.unbind();var r=this.gl.getExtension("WEBGL_lose_context");r&&r.loseContext(),this.map.getContainer().removeChild(this.canvas),this.gl=this.canvas=null}},{key:"animation",value:function(){if(this.isAnimation){if(60<=this.fps)this.render();else{var r=new Date().valueOf(),i=Math.floor(1e3/this.fps),s=r-this.renderTime;s>i&&(this.render(),this.renderTime=r-s%i)}window.requestAnimationFrame(this._animation)}}},{key:"startAnimation",value:function(){this.isAnimation||(this.isAnimation=!0,window.requestAnimationFrame(this._animation))}},{key:"stopAnimation",value:function(){this.isAnimation=!1}}]),t}(),zE=function(){function t(r){Ai(this,t),this.layers=[],this.options=r,this.webglLayer=r.webglLayer}return Xi(t,[{key:"addLayer",value:function(r){for(var i=!1,s=0;s<this.layers.length;s++)if(this.layers[s]===r){i=!0;break}i||(r.map=this.webglLayer.map,r.layerType==="threeLayer"?(r.setWebglLayer(this.webglLayer),i=r.getThreeLayer(),this.addLayer(i),r.initialize&&r.initialize(i)):(r.setWebglLayer(this.webglLayer),r.commonInitialize&&r.commonInitialize(this.webglLayer.gl),r.initialize&&r.initialize(this.webglLayer.gl),r.onOptionsChanged(r.getOptions(),{}),r.onDataChanged(r.getData()),r.onChanged(r.getOptions(),r.getData())),this.putInLayer(r)),this.options.autoUpdate&&(this.isRequestAnimation()?this.webglLayer.startAnimation():this.webglLayer.stopAnimation()),this.webglLayer.render()}},{key:"putInLayer",value:function(r){r.options.renderOrder===void 0&&(r.options.renderOrder=this.layers.length),this.layers.push(r),this.layers=this.layers.sort(function(i,s){return i.options.renderOrder-s.options.renderOrder})}},{key:"removeLayer",value:function(r){for(var i=0;i<this.layers.length;i++)this.layers[i]===r&&this.layers.splice(i,1);this.options.autoUpdate&&(this.isRequestAnimation()?this.webglLayer.startAnimation():this.webglLayer.stopAnimation()),this.webglLayer.render()}},{key:"showLayer",value:function(r){for(var i=0;i<this.layers.length;i++)this.layers[i]===r&&r.show();this.options.autoUpdate&&(this.isRequestAnimation()?this.webglLayer.startAnimation():this.webglLayer.stopAnimation()),this.webglLayer.render()}},{key:"hideLayer",value:function(r){for(var i=0;i<this.layers.length;i++)this.layers[i]===r&&r.hide();this.options.autoUpdate&&(this.isRequestAnimation()?this.webglLayer.startAnimation():this.webglLayer.stopAnimation()),this.webglLayer.render()}},{key:"removeAllLayers",value:function(){this.layers=[],this.webglLayer.stopAnimation(),this.webglLayer.render()}},{key:"destroyAllLayers",value:function(){for(var r=0;r<this.layers.length;r++){var i=this.layers[r];i.destroy&&i.destroy()}}},{key:"getAllLayers",value:function(){return this.layers}},{key:"getAllThreeLayers",value:function(){for(var r=[],i=0;i<this.layers.length;i++){var s=this.layers[i];s.layerType==="ThreeLayer"&&r.push(s)}return r}},{key:"isRequestAnimation",value:function(){for(var r=!1,i=0;i<this.layers.length;i++)if(this.layers[i].isRequestAnimation()){r=!0;break}return r}},{key:"beforeRender",value:function(r){r.gl&&this.webglLayer.stateManager.setDefaultState()}},{key:"afterRender",value:function(r){(r=r.gl)&&(r.bindBuffer(r.ARRAY_BUFFER,null),r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,null),r.useProgram(null))}},{key:"renderGLLayers",value:function(r){this.webglLayer.stateManager.save();for(var i=0;i<this.layers.length;i++){var s=this.layers[i];if(s._visible===!0&&s.layerType!=="threeLayer"&&s.layerType!=="ThreeLayer"){var f=s.map.getZoom(),c=s.getOptions().zoomThreshold;c&&(f<c[0]||f>=c[1])||(this.beforeRender(r),s.render(r),this.afterRender(r))}}this.webglLayer.stateManager.restore()}},{key:"renderThreeLayer",value:function(r){this.webglLayer.stateManager.save(),this.webglLayer.stateManager.setState({blendFunc:[r.gl.SRC_ALPHA,r.gl.ONE],depthMask:!1,depthTest:!0,depthFunc:r.gl.LESS,cullFace:!1});for(var i=0;i<this.layers.length;i++){var s=this.layers[i];if(s._visible===!0&&s.layerType==="ThreeLayer"){var f=s.map.getZoom(),c=s.getOptions().zoomThreshold;c&&(f<c[0]||f>=c[1])||s.render(r)}}this.webglLayer.stateManager.restore()}},{key:"renderThreeLayers",value:function(r){this.webglLayer.stateManager.save(),this.webglLayer.stateManager.setState({blendFunc:[r.gl.SRC_ALPHA,r.gl.ONE],depthMask:!1,depthTest:!0,depthFunc:r.gl.LESS,cullFace:!1});for(var i=0;i<this.layers.length;i++){var s=this.layers[i];if(s._visible===!0&&s.layerType==="threeLayer"){var f=s.map.getZoom(),c=s.getOptions().zoomThreshold;c&&(f<c[0]||f>=c[1])||s.render(r)}}this.webglLayer.stateManager.restore()}},{key:"onClick",value:function(r){for(var i=0;i<this.layers.length;i++){var s=this.layers[i];if(s._visible===!0&&s.layerType!=="threeLayer"&&s.layerType!=="ThreeLayer"){var f=s.map.getZoom(),c=s.getOptions().zoomThreshold;c&&(f<=c[0]||f>=c[1])||!s.options.enablePicked||!s.options.onClick||!s.pick||(f=s.pick(r.x,r.y),s.options.onClick(f,r),s.options.autoSelect&&this.webglLayer.render())}}}},{key:"onDblClick",value:function(r){for(var i=0;i<this.layers.length;i++){var s=this.layers[i];if(s._visible===!0&&s.layerType!=="threeLayer"&&s.layerType!=="ThreeLayer"){var f=s.map.getZoom(),c=s.getOptions().zoomThreshold;c&&(f<=c[0]||f>=c[1])||!s.options.enablePicked||!s.options.onDblClick||!s.pick||(f=s.pick(r.x,r.y),s.options.onDblClick(f,r),s.options.autoSelect&&this.webglLayer.render())}}}},{key:"onRightClick",value:function(r){for(var i=0;i<this.layers.length;i++){var s=this.layers[i];if(s._visible===!0&&s.layerType!=="threeLayer"&&s.layerType!=="ThreeLayer"){var f=s.map.getZoom(),c=s.getOptions().zoomThreshold;c&&(f<=c[0]||f>=c[1])||!s.options.enablePicked||!s.options.onRightClick||!s.pick||(f=s.pick(r.x,r.y),s.options.onRightClick(f,r),s.options.autoSelect&&this.webglLayer.render())}}}},{key:"onMousemove",value:function(r){for(var i=!1,s=0;s<this.layers.length;s++){var f=this.layers[s];if(f._visible===!0&&f.layerType!=="threeLayer"&&f.layerType!=="ThreeLayer"){var c=f.map.getZoom(),d=f.getOptions().zoomThreshold;(!d||!(c<=d[0]||c>=d[1]))&&f.options.enablePicked&&f.pick&&(f.options.onMousemove||f.options.autoSelect)&&(c=f.pick(r.x,r.y),this.webglLayer.map.map.platform.style.cursor=c.dataIndex===-1?"default":"pointer",f.options.onMousemove&&f.options.onMousemove(c,r),f.options.autoSelect&&(i=!0))}}i&&(this.webglLayer.isAnimation||this.webglLayer.render())}},{key:"destroy",value:function(){this.destroyAllLayers(),this.removeAllLayers()}}]),t}();(function(){function t(r){var i=this;Ai(this,t),this.options={autoUpdate:!0},this._visible=!0,pt(this.options,r);var s=r.pointOffset;this.webglLayer=r.webglLayer||new BE(r.map,this.options),this.layerManager=new zE({autoUpdate:this.options.autoUpdate,webglLayer:this.webglLayer}),this.effectManager=new LE(this.webglLayer.gl),this.webglRender={render:function(){}},this.options.effects&&this.effectManager.setEffects([this.webglRender].concat(this.options.effects)),this.webglLayer.onRender(function(f){i._render(f)}),this.webglLayer.onClick=function(f){i._visible&&i.layerManager.onClick(f)},this.webglLayer.onDblClick=function(f){i._visible&&i.layerManager.onDblClick(f)},this.webglLayer.onRightClick=function(f){i._visible&&i.layerManager.onRightClick(f)},this.webglLayer.onMousemove=function(f){i._visible&&i.layerManager.onMousemove(f)},s||this.webglLayer.options.mapType==="cesium"||(s=this.webglLayer.map.getCenter(),this.webglLayer.options.pointOffset=[s.lng,s.lat]),this.webglLayer.map.onResize(function(){i.effectManager.onResize()}),(this.postProcessing=r.postProcessing)&&(this.postProcessing.setWebglLayer(this.webglLayer),r=this.postProcessing.getThreeLayer(),this.addLayer(r),this.postProcessing.initialize(r),r.postProcessing=this.postProcessing)}return Xi(t,[{key:"renderCanvas",value:function(r){var i=this;this.postProcessing?this.postProcessing.addRender(function(){i.layerManager.renderGLLayers(r)}):this.layerManager.renderGLLayers(r),this.layerManager.renderThreeLayers(r),this.layerManager.renderThreeLayer(r)}},{key:"render",value:function(){this.webglLayer&&this.webglLayer.render()}},{key:"_render",value:function(r){var i=this;if(this._visible){var s=this.options.effects;s&&0<s.length?(this.webglRender.render=function(){i.renderCanvas(r)},this.effectManager.render()):(this.webglLayer.saveFramebuffer(),this.renderCanvas(r),this.webglLayer.restoreFramebuffer())}}},{key:"onRender",value:function(r){this.webglLayer.onRender(r)}},{key:"destroy",value:function(){this.stopAnimation(),this.layerManager.destroy(),this.effectManager.destroy(),this.webglLayer.destroy()}},{key:"isRequestAnimation",value:function(){return this.layerManager.isRequestAnimation()}},{key:"startAnimation",value:function(){this.webglLayer.startAnimation()}},{key:"stopAnimation",value:function(){this.webglLayer.stopAnimation()}},{key:"show",value:function(){this._visible!==!0&&(this._visible=!0,this.webglLayer.render(),this.isRequestAnimation()&&this.startAnimation())}},{key:"hide",value:function(){this._visible!==!1&&(this._visible=!1,this.stopAnimation(),this.webglLayer.clear())}},{key:"showLayer",value:function(r){this.layerManager.showLayer(r)}},{key:"hideLayer",value:function(r){this.layerManager.hideLayer(r)}},{key:"add",value:function(r){this.addLayer(r)}},{key:"remove",value:function(r){this.removeLayer(r)}},{key:"addLayer",value:function(r){this.layerManager.addLayer(r)}},{key:"removeLayer",value:function(r){this.layerManager.removeLayer(r)}},{key:"removeAllLayers",value:function(){this.layerManager.removeAllLayers()}},{key:"getAllLayers",value:function(){return this.layerManager.getAllLayers()}},{key:"getAllThreeLayers",value:function(){return this.layerManager.getAllThreeLayers()}}]),t})();var _3=function(){function t(r){Ai(this,t),this._visible=!0,this.options=this.getCommonDefaultOptions(),this.options=pt(this.options,this.getDefaultOptions()),this.autoUpdate=!1,this.options=pt(this.options,r),this.options.data&&(this.data=this.options.data,delete this.options.data)}return Xi(t,[{key:"getCommonDefaultOptions",value:function(){return{}}},{key:"getDefaultOptions",value:function(){return{}}},{key:"initialize",value:function(r){}},{key:"destroy",value:function(){this.onDestroy&&this.onDestroy()}},{key:"show",value:function(){this._visible=!0}},{key:"hide",value:function(){this._visible=!1}},{key:"render",value:function(){}},{key:"clear",value:function(){this.setData([])}},{key:"setData",value:function(r,i){i=i||{},this.data=r,this.onDataChanged&&this.onDataChanged(this.getData()),this.onChanged&&this.onChanged(this.getOptions(),this.getData(),i),i.autoRender!==!1&&this.webglLayer&&this.webglLayer.render()}},{key:"getData",value:function(){return this.data||[]}},{key:"setOptions",value:function(r,i){r=r||{},i=i||{};var s=pt({},this.getOptions());pt(this.options,r),this.onOptionsChanged&&this.onOptionsChanged(this.getOptions(),s),this.onChanged&&this.onChanged(this.getOptions(),this.getData(),i),r.data?(this.setData(r.data,i),delete r.data):i.autoRender!==!1&&this.webglLayer&&this.webglLayer.render()}},{key:"getOptions",value:function(){return this.options||{}}},{key:"onOptionsChanged",value:function(r,i){}},{key:"onDataChanged",value:function(r){}},{key:"onChanged",value:function(r,i){}},{key:"onDestroy",value:function(){}},{key:"lnglatToMercator",value:function(r,i){}},{key:"setWebglLayer",value:function(r){this.webglLayer=r}},{key:"getWebglLayer",value:function(){return this.webglLayer}},{key:"isRequestAnimation",value:function(){return this.autoUpdate}}]),t}(),NE=Dn("iterator"),UE=yi.isIterable=function(t){return t=Object(t),t[NE]!==void 0||"@@iterator"in t||bs.hasOwnProperty(Ka(t))},Bv=ht(function(t){t.exports={default:UE,__esModule:!0}});ot(Bv);var bE=yi.getIterator=function(t){var r=Qg(t);if(typeof r!="function")throw TypeError(t+" is not iterable!");return Pn(r.call(t))},zv=ht(function(t){t.exports={default:bE,__esModule:!0}});ot(zv);var kE=ht(function(t,r){r.__esModule=!0;var i=Bv&&Bv.__esModule?Bv:{default:Bv},s=zv&&zv.__esModule?zv:{default:zv};r.default=function(){return function(f,c){if(Array.isArray(f))return f;if((0,i.default)(Object(f))){var d=[],p=!0,A=!1,S=void 0;try{for(var z=(0,s.default)(f),w;!(p=(w=z.next()).done)&&(d.push(w.value),!c||d.length!==c);p=!0);}catch(I){A=!0,S=I}finally{try{!p&&z.return&&z.return()}finally{if(A)throw S}}return d}throw new TypeError("Invalid attempt to destructure non-iterable instance")}}()}),z_=ot(kE),HE=function(t){function r(i){return Ai(this,r),i=Tn(this,(r.__proto__||Wn(r)).call(this,i)),i.pickedColor=[-1,-1,-1],i}return jn(r,t),Xi(r,[{key:"getCommonDefaultOptions",value:function(){return{blend:"default",zIndex:0,zoomThreshold:[0,30],repeat:!1,enablePicked:!1,autoSelect:!1,selectedIndex:-1,selectedColor:"rgba(20, 20, 200, 1.0)"}}},{key:"commonInitialize",value:function(i){var s=this.getOptions();this.gl=i,s.enablePicked&&(this.pickBuffer=new Ov({gl:i,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}))}},{key:"getCommonAttributes",value:function(){var i=[];return this.getOptions().enablePicked&&i.push({name:"aPickColor",buffer:this.pickBuffer,size:3,type:"FLOAT",stride:12,offset:0}),i}},{key:"getProperty",value:function(i,s,f){return Object.prototype.toString.call(s)==="[object Function]"?s(f):(s=f[i]||s,"properties"in f&&i in f.properties&&(s=f.properties[i]),s)}},{key:"normizedColor",value:function(i){var s=i;return i instanceof Array||(s=Vn(i).unitArray()),s[3]===void 0&&(s[3]=1),s}},{key:"normizedPoint",value:function(i){var s=this.getPointOffset();if(!i||!i[0]||!i[1])return[s[0],s[1],0];var f=Number(i[0]),c=Number(i[1]);-180<=f&&180>=f&&-90<=c&&90>=c&&(c=this.webglLayer.map.lnglatToMercator(f,c),f=c[0],c=c[1]);var d=Number(i[2])||0;return this.webglLayer&&this.webglLayer.options.mapType==="cesium"&&window.Cesium?(f=this.convertLngLat([f,c]),d=window.Cesium.Cartesian3.fromDegrees(f[0],f[1],d),f=d.x,c=d.y,d=d.z):this.webglLayer&&this.webglLayer.options.mapType==="bmapgl"&&this.webglLayer.map.map.mapType==="B_EARTH_MAP"&&(f=this.convertLngLat([f,c]),d=this.webglLayer.map.map.getEarth().scene.fromLatLngToXYZ({lng:f[0],lat:f[1]}),f=d.x,c=d.y,d=d.z),3<i.length?[f-s[0],c-s[1],d].concat(d3(i.slice(3))):[f-s[0],c-s[1],d]}},{key:"convertLngLat",value:function(i){return[i[0]/2003750834e-2*180,180/Math.PI*(2*Math.atan(Math.exp(i[1]/2003750834e-2*180*Math.PI/180))-Math.PI/2)]}},{key:"getPointOffset",value:function(){var i=[0,0],s=this.getOptions();return this.webglLayer&&this.webglLayer.options.pointOffset?i=this.webglLayer.options.pointOffset:s.pointOffset&&(i=s.pointOffset),i}},{key:"indexToRgb",value:function(i){i++;var s=Math.floor(i/65536);i-=65536*s;var f=Math.floor(i/256);return[i-256*f,f,s]}},{key:"rgbToIndex",value:function(i){return i[0]+256*i[1]+65536*i[2]-1}},{key:"getCommonUniforms",value:function(i){i=i.isPickRender;var s=this.getOptions(),f={};if(s.enablePicked){var c=0<=s.selectedIndex?s.selectedIndex:-1;c=s.autoSelect?this.pickedColor:this.indexToRgb(c),f=pt(f,{uSelectedColor:this.normizedColor(s.selectedColor),uEnablePicked:s.enablePicked,uPickedColor:c.map(function(d){return d/255}),uIsPickRender:!!i})}return f}},{key:"pick",value:function(i,s){var f=this.gl,c=this.webglLayer._dpr;this.webglLayer.saveFramebuffer(),this.webglLayer.bindFramebuffer(this.webglLayer.pickFBO),this.webglLayer.clear(),this.render({gl:f,isPickRender:!0,matrix:this.webglLayer.matrix,projectionMatrix:this.webglLayer.projectionMatrix,viewMatrix:this.webglLayer.viewMatrix,orthoMatrix:this.webglLayer.orthoMatrix});var d=new Uint8Array(4);return f.readPixels(i*c,f.canvas.height-s*c,1,1,f.RGBA,f.UNSIGNED_BYTE,d),i=this.rgbToIndex(d),this.pickAfter&&(i=this.pickAfter(d,i+1)),s=this.getData(),this.pickedColor=[d[0],d[1],d[2]],this.webglLayer.restoreFramebuffer(),{dataIndex:i,dataItem:s[i]}}},{key:"setGLState",value:function(i){this.webglLayer.stateManager.setState(i,this.options)}},{key:"addMultipleCoords",value:function(i,s,f){if(!this.options.repeat||!this.webglLayer||this.webglLayer.options.mapType!=="bmapgl"||this.webglLayer.map.map.mapType==="B_EARTH_MAP")return[i];var c=this.webglLayer.map.map;s=s||c.getZoom();var d=f?c.worldSize(s):4007545274461451e-8;if(s=function(E){return[[E[0]-d,E[1],E[2]||0],[E[0]+d,E[1],E[2]||0]]},i instanceof Array&&!(i[0]instanceof Array))return s=s(i),s=z_(s,2),[i,s[0],s[1]];if(i instanceof Array&&i[0]instanceof Array&&!(i[0][0]instanceof Array)){f=[],c=[];for(var p=0;p<i.length;p++){var A=s(i[p]);A=z_(A,2);var S=A[1];f.push(A[0]),c.push(S)}return[i,f,c]}for(f=[],c=[],p=0;p<i.length;p++){A=[],S=[];for(var z=0;z<i[p].length;z++){var w=s(i[p][z]);w=z_(w,2);var I=w[1];A.push(w[0]),S.push(I)}f.push(A),c.push(S)}return[i,f,c]}}]),r}(_3),w3=ht(function(t,r){(function(i,s){s(r)})(Og,function(i){function s(){}function f(e,n){this.x=e||0,this.y=n||0}function c(){this.elements=[1,0,0,0,1,0,0,0,1],0<arguments.length&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}function d(e,n,u,m,_,T,R,N,H,W){Object.defineProperty(this,"id",{value:O5++}),this.uuid=ni.generateUUID(),this.name="",this.image=e!==void 0?e:d.DEFAULT_IMAGE,this.mipmaps=[],this.mapping=n!==void 0?n:d.DEFAULT_MAPPING,this.wrapS=u!==void 0?u:1001,this.wrapT=m!==void 0?m:1001,this.magFilter=_!==void 0?_:1006,this.minFilter=T!==void 0?T:1008,this.anisotropy=H!==void 0?H:1,this.format=R!==void 0?R:1023,this.internalFormat=null,this.type=N!==void 0?N:1009,this.offset=new f(0,0),this.repeat=new f(1,1),this.center=new f(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new c,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=W!==void 0?W:3e3,this.version=0,this.onUpdate=null}function p(e,n,u,m){this.x=e||0,this.y=n||0,this.z=u||0,this.w=m!==void 0?m:1}function A(e,n,u){this.width=e,this.height=n,this.scissor=new p(0,0,e,n),this.scissorTest=!1,this.viewport=new p(0,0,e,n),u=u||{},this.texture=new d(void 0,u.mapping,u.wrapS,u.wrapT,u.magFilter,u.minFilter,u.format,u.type,u.anisotropy,u.encoding),this.texture.image={},this.texture.image.width=e,this.texture.image.height=n,this.texture.generateMipmaps=u.generateMipmaps!==void 0?u.generateMipmaps:!1,this.texture.minFilter=u.minFilter!==void 0?u.minFilter:1006,this.depthBuffer=u.depthBuffer!==void 0?u.depthBuffer:!0,this.stencilBuffer=u.stencilBuffer!==void 0?u.stencilBuffer:!0,this.depthTexture=u.depthTexture!==void 0?u.depthTexture:null}function S(e,n,u){A.call(this,e,n,u),this.samples=4}function z(e,n,u,m){this._x=e||0,this._y=n||0,this._z=u||0,this._w=m!==void 0?m:1}function w(e,n,u){this.x=e||0,this.y=n||0,this.z=u||0}function I(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],0<arguments.length&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}function E(e,n,u,m){this._x=e||0,this._y=n||0,this._z=u||0,this._order=m||E.DefaultOrder}function P(){this.mask=1}function F(){Object.defineProperty(this,"id",{value:z5++}),this.uuid=ni.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=F.DefaultUp.clone();var e=new w,n=new E,u=new z,m=new w(1,1,1);n._onChange(function(){u.setFromEuler(n,!1)}),u._onChange(function(){n.setFromQuaternion(u,void 0,!1)}),Or(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:n},quaternion:{configurable:!0,enumerable:!0,value:u},scale:{configurable:!0,enumerable:!0,value:m},modelViewMatrix:{value:new I},normalMatrix:{value:new c}}),this.matrix=new I,this.matrixWorld=new I,this.matrixAutoUpdate=F.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new P,this.visible=!0,this.receiveShadow=this.castShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}}function X(){F.call(this),this.type="Scene",this.overrideMaterial=this.fog=this.environment=this.background=null,this.autoUpdate=!0,typeof __THREE_DEVTOOLS__!="undefined"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}function q(e,n){this.min=e!==void 0?e:new w(1/0,1/0,1/0),this.max=n!==void 0?n:new w(-1/0,-1/0,-1/0)}function J(e,n,u,m,_){var T,R=0;for(T=e.length-3;R<=T;R+=3){Op.fromArray(e,R);var N=_.x*Math.abs(Op.x)+_.y*Math.abs(Op.y)+_.z*Math.abs(Op.z),H=n.dot(Op),W=u.dot(Op),$=m.dot(Op);if(Math.max(-Math.max(H,W,$),Math.min(H,W,$))>N)return!1}return!0}function it(e,n){this.center=e!==void 0?e:new w,this.radius=n!==void 0?n:-1}function lt(e,n){this.origin=e!==void 0?e:new w,this.direction=n!==void 0?n:new w(0,0,-1)}function Mt(e,n){this.normal=e!==void 0?e:new w(1,0,0),this.constant=n!==void 0?n:0}function Ct(e,n,u){this.a=e!==void 0?e:new w,this.b=n!==void 0?n:new w,this.c=u!==void 0?u:new w}function wt(e,n,u){return n===void 0&&u===void 0?this.set(e):this.setRGB(e,n,u)}function zt(e,n,u){return 0>u&&(u+=1),1<u&&--u,u<1/6?e+6*(n-e)*u:.5>u?n:u<2/3?e+6*(n-e)*(2/3-u):e}function Ut(e){return .04045>e?.0773993808*e:Math.pow(.9478672986*e+.0521327014,2.4)}function Kt(e){return .0031308>e?12.92*e:1.055*Math.pow(e,.41666)-.055}function Gt(e,n,u,m,_,T){this.a=e,this.b=n,this.c=u,this.normal=m&&m.isVector3?m:new w,this.vertexNormals=Array.isArray(m)?m:[],this.color=_&&_.isColor?_:new wt,this.vertexColors=Array.isArray(_)?_:[],this.materialIndex=T!==void 0?T:0}function Qt(){Object.defineProperty(this,"id",{value:W5++}),this.uuid=ni.generateUUID(),this.name="",this.type="Material",this.fog=!0,this.blending=1,this.side=0,this.vertexColors=this.flatShading=!1,this.opacity=1,this.transparent=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=100,this.blendEquationAlpha=this.blendDstAlpha=this.blendSrcAlpha=null,this.depthFunc=3,this.depthWrite=this.depthTest=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilZPass=this.stencilZFail=this.stencilFail=7680,this.stencilWrite=!1,this.clippingPlanes=null,this.clipShadows=this.clipIntersection=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetUnits=this.polygonOffsetFactor=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.toneMapped=this.visible=!0,this.userData={},this.version=0}function De(e){Qt.call(this),this.type="MeshBasicMaterial",this.color=new wt(16777215),this.lightMap=this.map=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.envMap=this.alphaMap=this.specularMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinejoin=this.wireframeLinecap="round",this.morphTargets=this.skinning=!1,this.setValues(e)}function re(e,n,u){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=e,this.itemSize=n,this.count=e!==void 0?e.length/n:0,this.normalized=u===!0,this.usage=35044,this.updateRange={offset:0,count:-1},this.version=0}function We(e,n,u){re.call(this,new Int8Array(e),n,u)}function hr(e,n,u){re.call(this,new Uint8Array(e),n,u)}function Je(e,n,u){re.call(this,new Uint8ClampedArray(e),n,u)}function qr(e,n,u){re.call(this,new Int16Array(e),n,u)}function nr(e,n,u){re.call(this,new Uint16Array(e),n,u)}function xt(e,n,u){re.call(this,new Int32Array(e),n,u)}function At(e,n,u){re.call(this,new Uint32Array(e),n,u)}function _t(e,n,u){re.call(this,new Float32Array(e),n,u)}function Rt(e,n,u){re.call(this,new Float64Array(e),n,u)}function st(){this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingSphere=this.boundingBox=null,this.groupsNeedUpdate=this.uvsNeedUpdate=this.colorsNeedUpdate=this.normalsNeedUpdate=this.verticesNeedUpdate=!1}function gt(e){if(e.length===0)return-1/0;for(var n=e[0],u=1,m=e.length;u<m;++u)e[u]>n&&(n=e[u]);return n}function vt(){Object.defineProperty(this,"id",{value:j5+=2}),this.uuid=ni.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingSphere=this.boundingBox=null,this.drawRange={start:0,count:1/0},this.userData={}}function Pt(e,n){F.call(this),this.type="Mesh",this.geometry=e!==void 0?e:new vt,this.material=n!==void 0?n:new De,this.updateMorphTargets()}function kt(e,n,u,m,_,T,R,N){return(n.side===1?m.intersectTriangle(R,T,_,!0,N):m.intersectTriangle(_,T,R,n.side!==2,N))===null?null:(t2.copy(N),t2.applyMatrix4(e.matrixWorld),n=u.ray.origin.distanceTo(t2),n<u.near||n>u.far?null:{distance:n,point:t2.clone(),object:e})}function Zt(e,n,u,m,_,T,R,N,H,W,$,K){if(Bc.fromBufferAttribute(_,W),zc.fromBufferAttribute(_,$),Nc.fromBufferAttribute(_,K),_=e.morphTargetInfluences,n.morphTargets&&T&&_){Qx.set(0,0,0),Kx.set(0,0,0),$x.set(0,0,0);for(var rt=0,et=T.length;rt<et;rt++){var at=_[rt],mt=T[rt];at!==0&&(Fw.fromBufferAttribute(mt,W),Bw.fromBufferAttribute(mt,$),zw.fromBufferAttribute(mt,K),R?(Qx.addScaledVector(Fw,at),Kx.addScaledVector(Bw,at),$x.addScaledVector(zw,at)):(Qx.addScaledVector(Fw.sub(Bc),at),Kx.addScaledVector(Bw.sub(zc),at),$x.addScaledVector(zw.sub(Nc),at)))}Bc.add(Qx),zc.add(Kx),Nc.add($x)}return e.isSkinnedMesh&&(e.boneTransform(W,Bc),e.boneTransform($,zc),e.boneTransform(K,Nc)),(e=kt(e,n,u,m,Bc,zc,Nc,S0))&&(N&&(Bm.fromBufferAttribute(N,W),zm.fromBufferAttribute(N,$),Nm.fromBufferAttribute(N,K),e.uv=Ct.getUV(S0,Bc,zc,Nc,Bm,zm,Nm,new f)),H&&(Bm.fromBufferAttribute(H,W),zm.fromBufferAttribute(H,$),Nm.fromBufferAttribute(H,K),e.uv2=Ct.getUV(S0,Bc,zc,Nc,Bm,zm,Nm,new f)),N=new Gt(W,$,K),Ct.getNormal(Bc,zc,Nc,N.normal),e.face=N),e}function yt(){Object.defineProperty(this,"id",{value:X5+=2}),this.uuid=ni.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingSphere=this.boundingBox=null,this.groupsNeedUpdate=this.lineDistancesNeedUpdate=this.colorsNeedUpdate=this.normalsNeedUpdate=this.uvsNeedUpdate=this.verticesNeedUpdate=this.elementsNeedUpdate=!1}function he(e){var n={},u;for(u in e){n[u]={};for(var m in e[u]){var _=e[u][m];_&&(_.isColor||_.isMatrix3||_.isMatrix4||_.isVector2||_.isVector3||_.isVector4||_.isTexture)?n[u][m]=_.clone():Array.isArray(_)?n[u][m]=_.slice():n[u][m]=_}}return n}function de(e){for(var n={},u=0;u<e.length;u++){var m=he(e[u]),_;for(_ in m)n[_]=m[_]}return n}function ue(e){Qt.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,this.fragmentShader=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.morphNormals=this.morphTargets=this.skinning=this.clipping=this.lights=this.fog=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,e!==void 0&&(e.attributes!==void 0&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(e))}function te(){F.call(this),this.type="Camera",this.matrixWorldInverse=new I,this.projectionMatrix=new I,this.projectionMatrixInverse=new I}function Ae(e,n,u,m){te.call(this),this.type="PerspectiveCamera",this.fov=e!==void 0?e:50,this.zoom=1,this.near=u!==void 0?u:.1,this.far=m!==void 0?m:2e3,this.focus=10,this.aspect=n!==void 0?n:1,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}function cr(e,n,u){if(F.call(this),this.type="CubeCamera",u.isWebGLCubeRenderTarget!==!0)console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter.");else{this.renderTarget=u;var m=new Ae(90,1,e,n);m.layers=this.layers,m.up.set(0,-1,0),m.lookAt(new w(1,0,0)),this.add(m);var _=new Ae(90,1,e,n);_.layers=this.layers,_.up.set(0,-1,0),_.lookAt(new w(-1,0,0)),this.add(_);var T=new Ae(90,1,e,n);T.layers=this.layers,T.up.set(0,0,1),T.lookAt(new w(0,1,0)),this.add(T);var R=new Ae(90,1,e,n);R.layers=this.layers,R.up.set(0,0,-1),R.lookAt(new w(0,-1,0)),this.add(R);var N=new Ae(90,1,e,n);N.layers=this.layers,N.up.set(0,-1,0),N.lookAt(new w(0,0,1)),this.add(N);var H=new Ae(90,1,e,n);H.layers=this.layers,H.up.set(0,-1,0),H.lookAt(new w(0,0,-1)),this.add(H),this.update=function(W,$){this.parent===null&&this.updateMatrixWorld();var K=W.xr.enabled,rt=W.getRenderTarget();W.xr.enabled=!1;var et=u.texture.generateMipmaps;u.texture.generateMipmaps=!1,W.setRenderTarget(u,0),W.render($,m),W.setRenderTarget(u,1),W.render($,_),W.setRenderTarget(u,2),W.render($,T),W.setRenderTarget(u,3),W.render($,R),W.setRenderTarget(u,4),W.render($,N),u.texture.generateMipmaps=et,W.setRenderTarget(u,5),W.render($,H),W.setRenderTarget(rt),W.xr.enabled=K},this.clear=function(W,$,K,rt){for(var et=W.getRenderTarget(),at=0;6>at;at++)W.setRenderTarget(u,at),W.clear($,K,rt);W.setRenderTarget(et)}}}function Cr(e,n,u){fc(n)&&(console.warn("THREE.WebGLCubeRenderTarget: constructor signature is now WebGLCubeRenderTarget( size, options )"),n=u),A.call(this,e,e,n)}function me(e,n,u,m,_,T,R,N,H,W,$,K){d.call(this,null,T,R,N,H,W,m,_,$,K),this.image={data:e||null,width:n||1,height:u||1},this.magFilter=H!==void 0?H:1003,this.minFilter=W!==void 0?W:1003,this.flipY=this.generateMipmaps=!1,this.unpackAlignment=1,this.needsUpdate=!0}function Qe(e,n,u,m,_,T){this.planes=[e!==void 0?e:new Mt,n!==void 0?n:new Mt,u!==void 0?u:new Mt,m!==void 0?m:new Mt,_!==void 0?_:new Mt,T!==void 0?T:new Mt]}function Fr(){function e(_,T){u!==!1&&(m(_,T),n.requestAnimationFrame(e))}var n=null,u=!1,m=null;return{start:function(){u!==!0&&m!==null&&(n.requestAnimationFrame(e),u=!0)},stop:function(){u=!1},setAnimationLoop:function(_){m=_},setContext:function(_){n=_}}}function be(e,n){function u(T,R){var N=T.array,H=T.usage,W=e.createBuffer();return e.bindBuffer(R,W),e.bufferData(R,N,H),T.onUploadCallback(),R=5126,N instanceof Float32Array?R=5126:N instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):N instanceof Uint16Array?R=5123:N instanceof Int16Array?R=5122:N instanceof Uint32Array?R=5125:N instanceof Int32Array?R=5124:N instanceof Int8Array?R=5120:N instanceof Uint8Array&&(R=5121),{buffer:W,type:R,bytesPerElement:N.BYTES_PER_ELEMENT,version:T.version}}var m=n.isWebGL2,_=new ki;return{get:function(T){return T.isInterleavedBufferAttribute&&(T=T.data),_.get(T)},remove:function(T){T.isInterleavedBufferAttribute&&(T=T.data);var R=_.get(T);R&&(e.deleteBuffer(R.buffer),_.delete(T))},update:function(T,R){T.isInterleavedBufferAttribute&&(T=T.data);var N=_.get(T);if(N===void 0)_.set(T,u(T,R));else if(N.version<T.version){var H=T.array,W=T.updateRange;e.bindBuffer(R,N.buffer),W.count===-1?e.bufferSubData(R,0,H):(m?e.bufferSubData(R,W.offset*H.BYTES_PER_ELEMENT,H,W.offset,W.count):e.bufferSubData(R,W.offset*H.BYTES_PER_ELEMENT,H.subarray(W.offset,W.offset+W.count)),W.count=-1),N.version=T.version}}}}function mn(e,n,u,m){yt.call(this),this.type="PlaneGeometry",this.parameters={width:e,height:n,widthSegments:u,heightSegments:m},this.fromBufferGeometry(new hi(e,n,u,m)),this.mergeVertices()}function hi(e,n,u,m){vt.call(this),this.type="PlaneBufferGeometry",this.parameters={width:e,height:n,widthSegments:u,heightSegments:m},e=e||1,n=n||1;var _=e/2,T=n/2;u=Math.floor(u)||1,m=Math.floor(m)||1;var R=u+1,N=m+1,H=e/u,W=n/m,$=[],K=[],rt=[],et=[];for(e=0;e<N;e++){var at=e*W-T;for(n=0;n<R;n++)K.push(n*H-_,-at,0),rt.push(0,0,1),et.push(n/u),et.push(1-e/m)}for(e=0;e<m;e++)for(n=0;n<u;n++)_=n+R*(e+1),T=n+1+R*(e+1),N=n+1+R*e,$.push(n+R*e,_,N),$.push(_,T,N);this.setIndex($),this.setAttribute("position",new _t(K,3)),this.setAttribute("normal",new _t(rt,3)),this.setAttribute("uv",new _t(et,2))}function Co(e,n,u,m){function _(rt,et){n.buffers.color.setClear(rt.r,rt.g,rt.b,et,m)}var T=new wt(0),R=0,N,H,W=null,$=0,K=null;return{getClearColor:function(){return T},setClearColor:function(rt,et){T.set(rt),R=et!==void 0?et:1,_(T,R)},getClearAlpha:function(){return R},setClearAlpha:function(rt){R=rt,_(T,R)},render:function(rt,et,at,mt){et=et.background,at=e.xr,(at=at.getSession&&at.getSession())&&at.environmentBlendMode==="additive"&&(et=null),et===null?_(T,R):et&&et.isColor&&(_(et,1),mt=!0),(e.autoClear||mt)&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),et&&(et.isCubeTexture||et.isWebGLCubeRenderTarget||et.mapping===306)?(H===void 0&&(H=new Pt(new I0(1,1,1),new ue({type:"BackgroundCubeMaterial",uniforms:he(ll.cube.uniforms),vertexShader:ll.cube.vertexShader,fragmentShader:ll.cube.fragmentShader,side:1,depthTest:!1,depthWrite:!1,fog:!1})),H.geometry.deleteAttribute("normal"),H.geometry.deleteAttribute("uv"),H.onBeforeRender=function(Ft,Wt,Ht){this.matrixWorld.copyPosition(Ht.matrixWorld)},Object.defineProperty(H.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),u.update(H)),mt=et.isWebGLCubeRenderTarget?et.texture:et,H.material.uniforms.envMap.value=mt,H.material.uniforms.flipEnvMap.value=mt.isCubeTexture?-1:1,(W!==et||$!==mt.version||K!==e.toneMapping)&&(H.material.needsUpdate=!0,W=et,$=mt.version,K=e.toneMapping),rt.unshift(H,H.geometry,H.material,0,0,null)):et&&et.isTexture&&(N===void 0&&(N=new Pt(new hi(2,2),new ue({type:"BackgroundMaterial",uniforms:he(ll.background.uniforms),vertexShader:ll.background.vertexShader,fragmentShader:ll.background.fragmentShader,side:0,depthTest:!1,depthWrite:!1,fog:!1})),N.geometry.deleteAttribute("normal"),Object.defineProperty(N.material,"map",{get:function(){return this.uniforms.t2D.value}}),u.update(N)),N.material.uniforms.t2D.value=et,et.matrixAutoUpdate===!0&&et.updateMatrix(),N.material.uniforms.uvTransform.value.copy(et.matrix),(W!==et||$!==et.version||K!==e.toneMapping)&&(N.material.needsUpdate=!0,W=et,$=et.version,K=e.toneMapping),rt.unshift(N,N.geometry,N.material,0,0,null))}}}function _a(e,n,u,m){var _=m.isWebGL2,T;this.setMode=function(R){T=R},this.render=function(R,N){e.drawArrays(T,R,N),u.update(N,T)},this.renderInstances=function(R,N,H,W){if(W!==0){if(_){R=e;var $="drawArraysInstanced"}else if(R=n.get("ANGLE_instanced_arrays"),$="drawArraysInstancedANGLE",R===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}R[$](T,N,H,W),u.update(H,T,W)}}}function rh(e,n,u){function m($t){if($t==="highp"){if(0<e.getShaderPrecisionFormat(35633,36338).precision&&0<e.getShaderPrecisionFormat(35632,36338).precision)return"highp";$t="mediump"}return $t==="mediump"&&0<e.getShaderPrecisionFormat(35633,36337).precision&&0<e.getShaderPrecisionFormat(35632,36337).precision?"mediump":"lowp"}var _,T=typeof WebGL2RenderingContext!="undefined"&&e instanceof WebGL2RenderingContext||typeof WebGL2ComputeRenderingContext!="undefined"&&e instanceof WebGL2ComputeRenderingContext,R=u.precision!==void 0?u.precision:"highp",N=m(R);N!==R&&(console.warn("THREE.WebGLRenderer:",R,"not supported, using",N,"instead."),R=N),u=u.logarithmicDepthBuffer===!0,N=e.getParameter(34930);var H=e.getParameter(35660),W=e.getParameter(3379),$=e.getParameter(34076),K=e.getParameter(34921),rt=e.getParameter(36347),et=e.getParameter(36348),at=e.getParameter(36349),mt=0<H,Ft=T||!!n.get("OES_texture_float"),Wt=mt&&Ft,Ht=T?e.getParameter(36183):0;return{isWebGL2:T,getMaxAnisotropy:function(){if(_!==void 0)return _;var $t=n.get("EXT_texture_filter_anisotropic");return _=$t!==null?e.getParameter($t.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0},getMaxPrecision:m,precision:R,logarithmicDepthBuffer:u,maxTextures:N,maxVertexTextures:H,maxTextureSize:W,maxCubemapSize:$,maxAttributes:K,maxVertexUniforms:rt,maxVaryings:et,maxFragmentUniforms:at,vertexTextures:mt,floatFragmentTextures:Ft,floatVertexTextures:Wt,maxSamples:Ht}}function ws(){function e(){W.value!==m&&(W.value=m,W.needsUpdate=0<_),u.numPlanes=_,u.numIntersection=0}function n($,K,rt,et){var at=$!==null?$.length:0,mt=null;if(at!==0){if(mt=W.value,et!==!0||mt===null)for(et=rt+4*at,K=K.matrixWorldInverse,H.getNormalMatrix(K),(mt===null||mt.length<et)&&(mt=new Float32Array(et)),et=0;et!==at;++et,rt+=4)N.copy($[et]).applyMatrix4(K,H),N.normal.toArray(mt,rt),mt[rt+3]=N.constant;W.value=mt,W.needsUpdate=!0}return u.numPlanes=at,u.numIntersection=0,mt}var u=this,m=null,_=0,T=!1,R=!1,N=new Mt,H=new c,W={value:null,needsUpdate:!1};this.uniform=W,this.numIntersection=this.numPlanes=0,this.init=function($,K,rt){var et=$.length!==0||K||_!==0||T;return T=K,m=n($,rt,0),_=$.length,et},this.beginShadows=function(){R=!0,n(null)},this.endShadows=function(){R=!1,e()},this.setState=function($,K,rt,et,at,mt){if(!T||$===null||$.length===0||R&&!rt)R?n(null):e();else{rt=R?0:_;var Ft=4*rt,Wt=at.clippingState||null;for(W.value=Wt,Wt=n($,et,Ft,mt),$=0;$!==Ft;++$)Wt[$]=m[$];at.clippingState=Wt,this.numIntersection=K?this.numPlanes:0,this.numPlanes+=rt}}}function tl(e){var n={};return{get:function(u){if(n[u]!==void 0)return n[u];switch(u){case"WEBGL_depth_texture":var m=e.getExtension("WEBGL_depth_texture")||e.getExtension("MOZ_WEBGL_depth_texture")||e.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":m=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":m=e.getExtension("WEBGL_compressed_texture_s3tc")||e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":m=e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:m=e.getExtension(u)}return m===null&&console.warn("THREE.WebGLRenderer: "+u+" extension not supported."),n[u]=m}}}function el(e,n,u){function m(N){var H=N.target;N=T.get(H),N.index!==null&&n.remove(N.index);for(var W in N.attributes)n.remove(N.attributes[W]);H.removeEventListener("dispose",m),T.delete(H),(W=R.get(N))&&(n.remove(W),R.delete(N)),u.memory.geometries--}function _(N){var H=[],W=N.index,$=N.attributes.position;if(W!==null){var K=W.array;W=W.version,$=0;for(var rt=K.length;$<rt;$+=3){var et=K[$+0],at=K[$+1],mt=K[$+2];H.push(et,at,at,mt,mt,et)}}else for(K=$.array,W=$.version,$=0,rt=K.length/3-1;$<rt;$+=3)et=$+0,at=$+1,mt=$+2,H.push(et,at,at,mt,mt,et);H=new(65535<gt(H)?At:nr)(H,1),H.version=W,n.update(H,34963),(K=R.get(N))&&n.remove(K),R.set(N,H)}var T=new ki,R=new ki;return{get:function(N,H){var W=T.get(H);return W||(H.addEventListener("dispose",m),H.isBufferGeometry?W=H:H.isGeometry&&(H._bufferGeometry===void 0&&(H._bufferGeometry=new vt().setFromObject(N)),W=H._bufferGeometry),T.set(H,W),u.memory.geometries++,W)},update:function(N){var H=N.index,W=N.attributes;H!==null&&n.update(H,34963);for(var $ in W)n.update(W[$],34962);N=N.morphAttributes;for($ in N){H=N[$],W=0;for(var K=H.length;W<K;W++)n.update(H[W],34962)}},getWireframeAttribute:function(N){var H=R.get(N);if(H){var W=N.index;W!==null&&H.version<W.version&&_(N)}else _(N);return R.get(N)}}}function ns(e,n,u,m){var _=m.isWebGL2,T,R,N;this.setMode=function(H){T=H},this.setIndex=function(H){R=H.type,N=H.bytesPerElement},this.render=function(H,W){e.drawElements(T,W,R,H*N),u.update(W,T)},this.renderInstances=function(H,W,$,K){if(K!==0){if(_){H=e;var rt="drawElementsInstanced"}else if(H=n.get("ANGLE_instanced_arrays"),rt="drawElementsInstancedANGLE",H===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}H[rt](T,$,R,W*N,K),u.update($,T,K)}}}function au(e){var n={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:n,programs:null,autoReset:!0,reset:function(){n.frame++,n.calls=0,n.triangles=0,n.points=0,n.lines=0},update:function(u,m,_){switch(_=_||1,n.calls++,m){case 4:n.triangles+=u/3*_;break;case 1:n.lines+=u/2*_;break;case 3:n.lines+=_*(u-1);break;case 2:n.lines+=_*u;break;case 0:n.points+=_*u;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",m)}}}}function go(e,n){return Math.abs(n[1])-Math.abs(e[1])}function ix(e){var n={},u=new Float32Array(8);return{update:function(m,_,T,R){var N=m.morphTargetInfluences,H=N===void 0?0:N.length;if(m=n[_.id],m===void 0){m=[];for(var W=0;W<H;W++)m[W]=[W,0];n[_.id]=m}var $=T.morphTargets&&_.morphAttributes.position;for(T=T.morphNormals&&_.morphAttributes.normal,W=0;W<H;W++){var K=m[W];K[1]!==0&&($&&_.deleteAttribute("morphTarget"+W),T&&_.deleteAttribute("morphNormal"+W))}for(W=0;W<H;W++)K=m[W],K[0]=W,K[1]=N[W];for(m.sort(go),W=N=0;8>W;W++){if((K=m[W])&&(H=K[0],K=K[1])){$&&_.setAttribute("morphTarget"+W,$[H]),T&&_.setAttribute("morphNormal"+W,T[H]),u[W]=K,N+=K;continue}u[W]=0}_=_.morphTargetsRelative?1:1-N,R.getUniforms().setValue(e,"morphTargetBaseInfluence",_),R.getUniforms().setValue(e,"morphTargetInfluences",u)}}}function nx(e,n,u,m){var _=new ki;return{update:function(T){var R=m.render.frame,N=T.geometry,H=n.get(T,N);return _.get(H)!==R&&(N.isGeometry&&H.updateFromObject(T),n.update(H),_.set(H,R)),T.isInstancedMesh&&u.update(T.instanceMatrix,34962),H},dispose:function(){_=new ki}}}function wa(e,n,u,m,_,T,R,N,H,W){e=e!==void 0?e:[],d.call(this,e,n!==void 0?n:301,u,m,_,T,R!==void 0?R:1022,N,H,W),this.flipY=!1}function ko(e,n,u,m){d.call(this,null),this.image={data:e||null,width:n||1,height:u||1,depth:m||1},this.minFilter=this.magFilter=1003,this.wrapR=1001,this.flipY=this.generateMipmaps=!1,this.needsUpdate=!0}function os(e,n,u,m){d.call(this,null),this.image={data:e||null,width:n||1,height:u||1,depth:m||1},this.minFilter=this.magFilter=1003,this.wrapR=1001,this.flipY=this.generateMipmaps=!1,this.needsUpdate=!0}function ih(e,n,u){var m=e[0];if(0>=m||0<m)return e;var _=n*u,T=wT[_];if(T===void 0&&(T=new Float32Array(_),wT[_]=T),n!==0)for(m.toArray(T,0),m=1,_=0;m!==n;++m)_+=u,e[m].toArray(T,_);return T}function Ms(e,n){if(e.length!==n.length)return!1;for(var u=0,m=e.length;u<m;u++)if(e[u]!==n[u])return!1;return!0}function To(e,n){for(var u=0,m=n.length;u<m;u++)e[u]=n[u]}function gp(e,n){var u=MT[n];u===void 0&&(u=new Int32Array(n),MT[n]=u);for(var m=0;m!==n;++m)u[m]=e.allocateTextureUnit();return u}function It(e,n){var u=this.cache;u[0]!==n&&(e.uniform1f(this.addr,n),u[0]=n)}function ge(e,n){var u=this.cache;n.x!==void 0?(u[0]!==n.x||u[1]!==n.y)&&(e.uniform2f(this.addr,n.x,n.y),u[0]=n.x,u[1]=n.y):Ms(u,n)||(e.uniform2fv(this.addr,n),To(u,n))}function Xt(e,n){var u=this.cache;n.x!==void 0?(u[0]!==n.x||u[1]!==n.y||u[2]!==n.z)&&(e.uniform3f(this.addr,n.x,n.y,n.z),u[0]=n.x,u[1]=n.y,u[2]=n.z):n.r!==void 0?(u[0]!==n.r||u[1]!==n.g||u[2]!==n.b)&&(e.uniform3f(this.addr,n.r,n.g,n.b),u[0]=n.r,u[1]=n.g,u[2]=n.b):Ms(u,n)||(e.uniform3fv(this.addr,n),To(u,n))}function Te(e,n){var u=this.cache;n.x!==void 0?(u[0]!==n.x||u[1]!==n.y||u[2]!==n.z||u[3]!==n.w)&&(e.uniform4f(this.addr,n.x,n.y,n.z,n.w),u[0]=n.x,u[1]=n.y,u[2]=n.z,u[3]=n.w):Ms(u,n)||(e.uniform4fv(this.addr,n),To(u,n))}function Ve(e,n){var u=this.cache,m=n.elements;m===void 0?Ms(u,n)||(e.uniformMatrix2fv(this.addr,!1,n),To(u,n)):Ms(u,m)||(ST.set(m),e.uniformMatrix2fv(this.addr,!1,ST),To(u,m))}function Kr(e,n){var u=this.cache,m=n.elements;m===void 0?Ms(u,n)||(e.uniformMatrix3fv(this.addr,!1,n),To(u,n)):Ms(u,m)||(TT.set(m),e.uniformMatrix3fv(this.addr,!1,TT),To(u,m))}function rr(e,n){var u=this.cache,m=n.elements;m===void 0?Ms(u,n)||(e.uniformMatrix4fv(this.addr,!1,n),To(u,n)):Ms(u,m)||(CT.set(m),e.uniformMatrix4fv(this.addr,!1,CT),To(u,m))}function Er(e,n,u){var m=this.cache,_=u.allocateTextureUnit();m[0]!==_&&(e.uniform1i(this.addr,_),m[0]=_),u.safeSetTexture2D(n||AT,_)}function Jr(e,n,u){var m=this.cache,_=u.allocateTextureUnit();m[0]!==_&&(e.uniform1i(this.addr,_),m[0]=_),u.setTexture2DArray(n||Y5,_)}function _i(e,n,u){var m=this.cache,_=u.allocateTextureUnit();m[0]!==_&&(e.uniform1i(this.addr,_),m[0]=_),u.setTexture3D(n||Z5,_)}function ci(e,n,u){var m=this.cache,_=u.allocateTextureUnit();m[0]!==_&&(e.uniform1i(this.addr,_),m[0]=_),u.safeSetTextureCube(n||_T,_)}function Ma(e,n){var u=this.cache;u[0]!==n&&(e.uniform1i(this.addr,n),u[0]=n)}function tn(e,n){var u=this.cache;Ms(u,n)||(e.uniform2iv(this.addr,n),To(u,n))}function Bn(e,n){var u=this.cache;Ms(u,n)||(e.uniform3iv(this.addr,n),To(u,n))}function uu(e,n){var u=this.cache;Ms(u,n)||(e.uniform4iv(this.addr,n),To(u,n))}function ox(e,n){var u=this.cache;u[0]!==n&&(e.uniform1ui(this.addr,n),u[0]=n)}function Ws(e){switch(e){case 5126:return It;case 35664:return ge;case 35665:return Xt;case 35666:return Te;case 35674:return Ve;case 35675:return Kr;case 35676:return rr;case 5124:case 35670:return Ma;case 35667:case 35671:return tn;case 35668:case 35672:return Bn;case 35669:case 35673:return uu;case 5125:return ox;case 35678:case 36198:case 36298:case 36306:case 35682:return Er;case 35679:case 36299:case 36307:return _i;case 35680:case 36300:case 36308:case 36293:return ci;case 36289:case 36303:case 36311:case 36292:return Jr}}function $d(e,n){e.uniform1fv(this.addr,n)}function nh(e,n){e.uniform1iv(this.addr,n)}function wc(e,n){e.uniform2iv(this.addr,n)}function k_(e,n){e.uniform3iv(this.addr,n)}function oh(e,n){e.uniform4iv(this.addr,n)}function JE(e,n){n=ih(n,this.size,2),e.uniform2fv(this.addr,n)}function QE(e,n){n=ih(n,this.size,3),e.uniform3fv(this.addr,n)}function KE(e,n){n=ih(n,this.size,4),e.uniform4fv(this.addr,n)}function $E(e,n){n=ih(n,this.size,4),e.uniformMatrix2fv(this.addr,!1,n)}function t5(e,n){n=ih(n,this.size,9),e.uniformMatrix3fv(this.addr,!1,n)}function e5(e,n){n=ih(n,this.size,16),e.uniformMatrix4fv(this.addr,!1,n)}function r5(e,n,u){var m=n.length,_=gp(u,m);for(e.uniform1iv(this.addr,_),e=0;e!==m;++e)u.safeSetTexture2D(n[e]||AT,_[e])}function i5(e,n,u){var m=n.length,_=gp(u,m);for(e.uniform1iv(this.addr,_),e=0;e!==m;++e)u.safeSetTextureCube(n[e]||_T,_[e])}function n5(e){switch(e){case 5126:return $d;case 35664:return JE;case 35665:return QE;case 35666:return KE;case 35674:return $E;case 35675:return t5;case 35676:return e5;case 5124:case 35670:return nh;case 35667:case 35671:return wc;case 35668:case 35672:return k_;case 35669:case 35673:return oh;case 35678:case 36198:case 36298:case 36306:case 35682:return r5;case 35680:case 36300:case 36308:case 36293:return i5}}function o5(e,n,u){this.id=e,this.addr=u,this.cache=[],this.setValue=Ws(n.type)}function I3(e,n,u){this.id=e,this.addr=u,this.cache=[],this.size=n.size,this.setValue=n5(n.type)}function E3(e){this.id=e,this.seq=[],this.map={}}function Mc(e,n){this.seq=[],this.map={};for(var u=e.getProgramParameter(n,35718),m=0;m<u;++m){var _=e.getActiveUniform(n,m),T=e.getUniformLocation(n,_.name),R=this,N=_.name,H=N.length;for(bw.lastIndex=0;;){var W=bw.exec(N),$=bw.lastIndex,K=W[1],rt=W[3];if(W[2]==="]"&&(K|=0),rt===void 0||rt==="["&&$+2===H){N=R,_=rt===void 0?new o5(K,_,T):new I3(K,_,T),N.seq.push(_),N.map[_.id]=_;break}else rt=R.map[K],rt===void 0&&(rt=new E3(K),K=R,R=rt,K.seq.push(R),K.map[R.id]=R),R=rt}}}function L3(e,n,u){return n=e.createShader(n),e.shaderSource(n,u),e.compileShader(n),n}function R3(e){switch(e){case 3e3:return["Linear","( value )"];case 3001:return["sRGB","( value )"];case 3002:return["RGBE","( value )"];case 3004:return["RGBM","( value, 7.0 )"];case 3005:return["RGBM","( value, 16.0 )"];case 3006:return["RGBD","( value, 256.0 )"];case 3007:return["Gamma","( value, float( GAMMA_FACTOR ) )"];case 3003:return["LogLuv","( value )"];default:throw Error("unsupported encoding: "+e)}}function P3(e,n,u){var m=e.getShaderParameter(n,35713),_=e.getShaderInfoLog(n).trim();if(m&&_==="")return"";for(e=e.getShaderSource(n).split(`
`),n=0;n<e.length;n++)e[n]=n+1+": "+e[n];return e=e.join(`
`),"THREE.WebGLShader: gl.getShaderInfoLog() "+u+`
`+_+e}function bv(e,n){return n=R3(n),"vec4 "+e+"( vec4 value ) { return "+n[0]+"ToLinear"+n[1]+"; }"}function s5(e,n){return n=R3(n),"vec4 "+e+"( vec4 value ) { return LinearTo"+n[0]+n[1]+"; }"}function a5(e,n){switch(n){case 1:n="Linear";break;case 2:n="Reinhard";break;case 3:n="Uncharted2";break;case 4:n="OptimizedCineon";break;case 5:n="ACESFilmic";break;default:throw Error("unsupported toneMapping: "+n)}return"vec3 "+e+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}function u5(e){var n=[],u;for(u in e){var m=e[u];m!==!1&&n.push("#define "+u+" "+m)}return n.join(`
`)}function kv(e){return e!==""}function D3(e,n){return e.replace(/NUM_DIR_LIGHTS/g,n.numDirLights).replace(/NUM_SPOT_LIGHTS/g,n.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,n.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,n.numPointLights).replace(/NUM_HEMI_LIGHTS/g,n.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,n.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,n.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,n.numPointLightShadows)}function O3(e,n){return e.replace(/NUM_CLIPPING_PLANES/g,n.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,n.numClippingPlanes-n.numClipIntersection)}function H_(e,n){if(e=mi[n],e===void 0)throw Error("Can not resolve #include <"+n+">");return e.replace(kw,H_)}function F3(e,n,u,m){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),G_(e,n,u,m)}function G_(e,n,u,m){for(e="",n=parseInt(n);n<parseInt(u);n++)e+=m.replace(/\[ i \]/g,"[ "+n+" ]").replace(/UNROLLED_LOOP_INDEX/g,n);return e}function B3(e){var n="precision "+e.precision+` float;
precision `+e.precision+" int;";return e.precision==="highp"?n+=`
#define HIGH_PRECISION`:e.precision==="mediump"?n+=`
#define MEDIUM_PRECISION`:e.precision==="lowp"&&(n+=`
#define LOW_PRECISION`),n}function l5(e){var n="SHADOWMAP_TYPE_BASIC";return e.shadowMapType===1?n="SHADOWMAP_TYPE_PCF":e.shadowMapType===2?n="SHADOWMAP_TYPE_PCF_SOFT":e.shadowMapType===3&&(n="SHADOWMAP_TYPE_VSM"),n}function h5(e){var n="ENVMAP_TYPE_CUBE";if(e.envMap)switch(e.envMapMode){case 301:case 302:n="ENVMAP_TYPE_CUBE";break;case 306:case 307:n="ENVMAP_TYPE_CUBE_UV";break;case 303:case 304:n="ENVMAP_TYPE_EQUIREC";break;case 305:n="ENVMAP_TYPE_SPHERE"}return n}function c5(e){var n="ENVMAP_MODE_REFLECTION";if(e.envMap)switch(e.envMapMode){case 302:case 304:n="ENVMAP_MODE_REFRACTION"}return n}function f5(e){var n="ENVMAP_BLENDING_NONE";if(e.envMap)switch(e.combine){case 0:n="ENVMAP_BLENDING_MULTIPLY";break;case 1:n="ENVMAP_BLENDING_MIX";break;case 2:n="ENVMAP_BLENDING_ADD"}return n}function p5(e,n,u){var m=e.getContext(),_=u.defines,T=u.vertexShader,R=u.fragmentShader,N=l5(u),H=h5(u),W=c5(u),$=f5(u),K=0<e.gammaFactor?e.gammaFactor:1,rt=u.isWebGL2?"":[u.extensionDerivatives||u.envMapCubeUV||u.bumpMap||u.tangentSpaceNormalMap||u.clearcoatNormalMap||u.flatShading||u.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(u.extensionFragDepth||u.logarithmicDepthBuffer)&&u.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",u.extensionDrawBuffers&&u.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(u.extensionShaderTextureLOD||u.envMap)&&u.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(kv).join(`
`),et=u5(_),at=m.createProgram();u.isRawShaderMaterial?(_=[et].filter(kv).join(`
`),0<_.length&&(_+=`
`),N=[rt,et].filter(kv).join(`
`),0<N.length&&(N+=`
`)):(_=[B3(u),"#define SHADER_NAME "+u.shaderName,et,u.instancing?"#define USE_INSTANCING":"",u.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+K,"#define MAX_BONES "+u.maxBones,u.useFog&&u.fog?"#define USE_FOG":"",u.useFog&&u.fogExp2?"#define FOG_EXP2":"",u.map?"#define USE_MAP":"",u.envMap?"#define USE_ENVMAP":"",u.envMap?"#define "+W:"",u.lightMap?"#define USE_LIGHTMAP":"",u.aoMap?"#define USE_AOMAP":"",u.emissiveMap?"#define USE_EMISSIVEMAP":"",u.bumpMap?"#define USE_BUMPMAP":"",u.normalMap?"#define USE_NORMALMAP":"",u.normalMap&&u.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",u.normalMap&&u.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",u.clearcoatMap?"#define USE_CLEARCOATMAP":"",u.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",u.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",u.displacementMap&&u.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",u.specularMap?"#define USE_SPECULARMAP":"",u.roughnessMap?"#define USE_ROUGHNESSMAP":"",u.metalnessMap?"#define USE_METALNESSMAP":"",u.alphaMap?"#define USE_ALPHAMAP":"",u.vertexTangents?"#define USE_TANGENT":"",u.vertexColors?"#define USE_COLOR":"",u.vertexUvs?"#define USE_UV":"",u.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",u.flatShading?"#define FLAT_SHADED":"",u.skinning?"#define USE_SKINNING":"",u.useVertexTexture?"#define BONE_TEXTURE":"",u.morphTargets?"#define USE_MORPHTARGETS":"",u.morphNormals&&u.flatShading===!1?"#define USE_MORPHNORMALS":"",u.doubleSided?"#define DOUBLE_SIDED":"",u.flipSided?"#define FLIP_SIDED":"",u.shadowMapEnabled?"#define USE_SHADOWMAP":"",u.shadowMapEnabled?"#define "+N:"",u.sizeAttenuation?"#define USE_SIZEATTENUATION":"",u.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",u.logarithmicDepthBuffer&&u.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING"," attribute mat4 instanceMatrix;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#ifdef USE_COLOR","	attribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(kv).join(`
`),N=[rt,B3(u),"#define SHADER_NAME "+u.shaderName,et,u.alphaTest?"#define ALPHATEST "+u.alphaTest+(u.alphaTest%1?"":".0"):"","#define GAMMA_FACTOR "+K,u.useFog&&u.fog?"#define USE_FOG":"",u.useFog&&u.fogExp2?"#define FOG_EXP2":"",u.map?"#define USE_MAP":"",u.matcap?"#define USE_MATCAP":"",u.envMap?"#define USE_ENVMAP":"",u.envMap?"#define "+H:"",u.envMap?"#define "+W:"",u.envMap?"#define "+$:"",u.lightMap?"#define USE_LIGHTMAP":"",u.aoMap?"#define USE_AOMAP":"",u.emissiveMap?"#define USE_EMISSIVEMAP":"",u.bumpMap?"#define USE_BUMPMAP":"",u.normalMap?"#define USE_NORMALMAP":"",u.normalMap&&u.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",u.normalMap&&u.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",u.clearcoatMap?"#define USE_CLEARCOATMAP":"",u.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",u.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",u.specularMap?"#define USE_SPECULARMAP":"",u.roughnessMap?"#define USE_ROUGHNESSMAP":"",u.metalnessMap?"#define USE_METALNESSMAP":"",u.alphaMap?"#define USE_ALPHAMAP":"",u.sheen?"#define USE_SHEEN":"",u.vertexTangents?"#define USE_TANGENT":"",u.vertexColors?"#define USE_COLOR":"",u.vertexUvs?"#define USE_UV":"",u.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",u.gradientMap?"#define USE_GRADIENTMAP":"",u.flatShading?"#define FLAT_SHADED":"",u.doubleSided?"#define DOUBLE_SIDED":"",u.flipSided?"#define FLIP_SIDED":"",u.shadowMapEnabled?"#define USE_SHADOWMAP":"",u.shadowMapEnabled?"#define "+N:"",u.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",u.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",u.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",u.logarithmicDepthBuffer&&u.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"",(u.extensionShaderTextureLOD||u.envMap)&&u.rendererExtensionShaderTextureLod?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",u.toneMapping!==0?"#define TONE_MAPPING":"",u.toneMapping!==0?mi.tonemapping_pars_fragment:"",u.toneMapping!==0?a5("toneMapping",u.toneMapping):"",u.dithering?"#define DITHERING":"",u.outputEncoding||u.mapEncoding||u.matcapEncoding||u.envMapEncoding||u.emissiveMapEncoding||u.lightMapEncoding?mi.encodings_pars_fragment:"",u.mapEncoding?bv("mapTexelToLinear",u.mapEncoding):"",u.matcapEncoding?bv("matcapTexelToLinear",u.matcapEncoding):"",u.envMapEncoding?bv("envMapTexelToLinear",u.envMapEncoding):"",u.emissiveMapEncoding?bv("emissiveMapTexelToLinear",u.emissiveMapEncoding):"",u.lightMapEncoding?bv("lightMapTexelToLinear",u.lightMapEncoding):"",u.outputEncoding?s5("linearToOutputTexel",u.outputEncoding):"",u.depthPacking?"#define DEPTH_PACKING "+u.depthPacking:"",`
`].filter(kv).join(`
`)),T=T.replace(kw,H_),T=D3(T,u),T=O3(T,u),R=R.replace(kw,H_),R=D3(R,u),R=O3(R,u),T=T.replace(ET,G_).replace(IT,F3),R=R.replace(ET,G_).replace(IT,F3),u.isWebGL2&&!u.isRawShaderMaterial&&(H=!1,W=/^\s*#version\s+300\s+es\s*\n/,u.isShaderMaterial&&T.match(W)!==null&&R.match(W)!==null&&(H=!0,T=T.replace(W,""),R=R.replace(W,"")),_=`#version 300 es

#define attribute in
#define varying out
#define texture2D texture
`+_,N=[`#version 300 es

#define varying in`,H?"":"out highp vec4 pc_fragColor;",H?"":"#define gl_FragColor pc_fragColor",`#define gl_FragDepthEXT gl_FragDepth
#define texture2D texture
#define textureCube texture
#define texture2DProj textureProj
#define texture2DLodEXT textureLod
#define texture2DProjLodEXT textureProjLod
#define textureCubeLodEXT textureLod
#define texture2DGradEXT textureGrad
#define texture2DProjGradEXT textureProjGrad
#define textureCubeGradEXT textureGrad`].join(`
`)+`
`+N),R=N+R,T=L3(m,35633,_+T),R=L3(m,35632,R),m.attachShader(at,T),m.attachShader(at,R),u.index0AttributeName!==void 0?m.bindAttribLocation(at,0,u.index0AttributeName):u.morphTargets===!0&&m.bindAttribLocation(at,0,"position"),m.linkProgram(at),e.debug.checkShaderErrors&&(e=m.getProgramInfoLog(at).trim(),H=m.getShaderInfoLog(T).trim(),W=m.getShaderInfoLog(R).trim(),K=$=!0,m.getProgramParameter(at,35714)===!1?($=!1,rt=P3(m,T,"vertex"),et=P3(m,R,"fragment"),console.error("THREE.WebGLProgram: shader error: ",m.getError(),"35715",m.getProgramParameter(at,35715),"gl.getProgramInfoLog",e,rt,et)):e!==""?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",e):(H===""||W==="")&&(K=!1),K&&(this.diagnostics={runnable:$,programLog:e,vertexShader:{log:H,prefix:_},fragmentShader:{log:W,prefix:N}})),m.deleteShader(T),m.deleteShader(R);var mt;this.getUniforms=function(){return mt===void 0&&(mt=new Mc(m,at)),mt};var Ft;return this.getAttributes=function(){if(Ft===void 0){for(var Wt={},Ht=m.getProgramParameter(at,35721),$t=0;$t<Ht;$t++){var Yt=m.getActiveAttrib(at,$t).name;Wt[Yt]=m.getAttribLocation(at,Yt)}Ft=Wt}return Ft},this.destroy=function(){m.deleteProgram(at),this.program=void 0},this.name=u.shaderName,this.id=q5++,this.cacheKey=n,this.usedTimes=1,this.program=at,this.vertexShader=T,this.fragmentShader=R,this}function d5(e,n,u){function m(et){if(et)et.isTexture?at=et.encoding:et.isWebGLRenderTarget&&(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),at=et.texture.encoding);else var at=3e3;return at}var _=[],T=u.isWebGL2,R=u.logarithmicDepthBuffer,N=u.floatVertexTextures,H=u.precision,W=u.maxVertexUniforms,$=u.vertexTextures,K={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},rt="precision isWebGL2 supportsVertexTextures outputEncoding instancing map mapEncoding matcap matcapEncoding envMap envMapMode envMapEncoding envMapCubeUV lightMap lightMapEncoding aoMap emissiveMap emissiveMapEncoding bumpMap normalMap objectSpaceNormalMap tangentSpaceNormalMap clearcoatMap clearcoatRoughnessMap clearcoatNormalMap displacementMap specularMap roughnessMap metalnessMap gradientMap alphaMap combine vertexColors vertexTangents vertexUvs uvsVertexOnly fog useFog fogExp2 flatShading sizeAttenuation logarithmicDepthBuffer skinning maxBones useVertexTexture morphTargets morphNormals maxMorphTargets maxMorphNormals premultipliedAlpha numDirLights numPointLights numSpotLights numHemiLights numRectAreaLights numDirLightShadows numPointLightShadows numSpotLightShadows shadowMapEnabled shadowMapType toneMapping physicallyCorrectLights alphaTest doubleSided flipSided numClippingPlanes numClipIntersection depthPacking dithering sheen".split(" ");this.getParameters=function(et,at,mt,Ft,Wt,Ht,$t){var Yt=Ft.fog;Ft=et.isMeshStandardMaterial?Ft.environment:null,Ft=et.envMap||Ft;var ie=K[et.type];if($t.isSkinnedMesh){var Vt=$t.skeleton.bones;if(N)Vt=1024;else{var ve=Math.min(Math.floor((W-20)/4),Vt.length);ve<Vt.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+Vt.length+" bones. This GPU supports "+ve+"."),Vt=0):Vt=ve}}else Vt=0;et.precision!==null&&(H=u.getMaxPrecision(et.precision),H!==et.precision&&console.warn("THREE.WebGLProgram.getParameters:",et.precision,"not supported, using",H,"instead.")),ie?(ve=ll[ie],ve={name:et.type,uniforms:xT.clone(ve.uniforms),vertexShader:ve.vertexShader,fragmentShader:ve.fragmentShader}):ve={name:et.type,uniforms:et.uniforms,vertexShader:et.vertexShader,fragmentShader:et.fragmentShader},et.onBeforeCompile(ve,e);var Le=e.getRenderTarget();return{isWebGL2:T,shaderID:ie,shaderName:ve.name,uniforms:ve.uniforms,vertexShader:ve.vertexShader,fragmentShader:ve.fragmentShader,defines:et.defines,isRawShaderMaterial:et.isRawShaderMaterial,isShaderMaterial:et.isShaderMaterial,precision:H,instancing:$t.isInstancedMesh===!0,supportsVertexTextures:$,outputEncoding:Le!==null?m(Le.texture):e.outputEncoding,map:!!et.map,mapEncoding:m(et.map),matcap:!!et.matcap,matcapEncoding:m(et.matcap),envMap:!!Ft,envMapMode:Ft&&Ft.mapping,envMapEncoding:m(Ft),envMapCubeUV:!!Ft&&(Ft.mapping===306||Ft.mapping===307),lightMap:!!et.lightMap,lightMapEncoding:m(et.lightMap),aoMap:!!et.aoMap,emissiveMap:!!et.emissiveMap,emissiveMapEncoding:m(et.emissiveMap),bumpMap:!!et.bumpMap,normalMap:!!et.normalMap,objectSpaceNormalMap:et.normalMapType===1,tangentSpaceNormalMap:et.normalMapType===0,clearcoatMap:!!et.clearcoatMap,clearcoatRoughnessMap:!!et.clearcoatRoughnessMap,clearcoatNormalMap:!!et.clearcoatNormalMap,displacementMap:!!et.displacementMap,roughnessMap:!!et.roughnessMap,metalnessMap:!!et.metalnessMap,specularMap:!!et.specularMap,alphaMap:!!et.alphaMap,gradientMap:!!et.gradientMap,sheen:!!et.sheen,combine:et.combine,vertexTangents:et.normalMap&&et.vertexTangents,vertexColors:et.vertexColors,vertexUvs:!!et.map||!!et.bumpMap||!!et.normalMap||!!et.specularMap||!!et.alphaMap||!!et.emissiveMap||!!et.roughnessMap||!!et.metalnessMap||!!et.clearcoatMap||!!et.clearcoatRoughnessMap||!!et.clearcoatNormalMap||!!et.displacementMap,uvsVertexOnly:!(et.map||et.bumpMap||et.normalMap||et.specularMap||et.alphaMap||et.emissiveMap||et.roughnessMap||et.metalnessMap||et.clearcoatNormalMap)&&!!et.displacementMap,fog:!!Yt,useFog:et.fog,fogExp2:Yt&&Yt.isFogExp2,flatShading:et.flatShading,sizeAttenuation:et.sizeAttenuation,logarithmicDepthBuffer:R,skinning:et.skinning&&0<Vt,maxBones:Vt,useVertexTexture:N,morphTargets:et.morphTargets,morphNormals:et.morphNormals,maxMorphTargets:e.maxMorphTargets,maxMorphNormals:e.maxMorphNormals,numDirLights:at.directional.length,numPointLights:at.point.length,numSpotLights:at.spot.length,numRectAreaLights:at.rectArea.length,numHemiLights:at.hemi.length,numDirLightShadows:at.directionalShadowMap.length,numPointLightShadows:at.pointShadowMap.length,numSpotLightShadows:at.spotShadowMap.length,numClippingPlanes:Wt,numClipIntersection:Ht,dithering:et.dithering,shadowMapEnabled:e.shadowMap.enabled&&0<mt.length,shadowMapType:e.shadowMap.type,toneMapping:et.toneMapped?e.toneMapping:0,physicallyCorrectLights:e.physicallyCorrectLights,premultipliedAlpha:et.premultipliedAlpha,alphaTest:et.alphaTest,doubleSided:et.side===2,flipSided:et.side===1,depthPacking:et.depthPacking!==void 0?et.depthPacking:!1,index0AttributeName:et.index0AttributeName,extensionDerivatives:et.extensions&&et.extensions.derivatives,extensionFragDepth:et.extensions&&et.extensions.fragDepth,extensionDrawBuffers:et.extensions&&et.extensions.drawBuffers,extensionShaderTextureLOD:et.extensions&&et.extensions.shaderTextureLOD,rendererExtensionFragDepth:T||n.get("EXT_frag_depth")!==null,rendererExtensionDrawBuffers:T||n.get("WEBGL_draw_buffers")!==null,rendererExtensionShaderTextureLod:T||n.get("EXT_shader_texture_lod")!==null,onBeforeCompile:et.onBeforeCompile}},this.getProgramCacheKey=function(et){var at=[];if(et.shaderID?at.push(et.shaderID):(at.push(et.fragmentShader),at.push(et.vertexShader)),et.defines!==void 0)for(var mt in et.defines)at.push(mt),at.push(et.defines[mt]);if(et.isRawShaderMaterial===void 0){for(mt=0;mt<rt.length;mt++)at.push(et[rt[mt]]);at.push(e.outputEncoding),at.push(e.gammaFactor)}return at.push(et.onBeforeCompile.toString()),at.join()},this.acquireProgram=function(et,at){for(var mt,Ft=0,Wt=_.length;Ft<Wt;Ft++){var Ht=_[Ft];if(Ht.cacheKey===at){mt=Ht,++mt.usedTimes;break}}return mt===void 0&&(mt=new p5(e,at,et),_.push(mt)),mt},this.releaseProgram=function(et){if(--et.usedTimes===0){var at=_.indexOf(et);_[at]=_[_.length-1],_.pop(),et.destroy()}},this.programs=_}function m5(){var e=new ki;return{get:function(n){var u=e.get(n);return u===void 0&&(u={},e.set(n,u)),u},remove:function(n){e.delete(n)},update:function(n,u,m){e.get(n)[u]=m},dispose:function(){e=new ki}}}function g5(e,n){return e.groupOrder!==n.groupOrder?e.groupOrder-n.groupOrder:e.renderOrder!==n.renderOrder?e.renderOrder-n.renderOrder:e.program!==n.program?e.program.id-n.program.id:e.material.id!==n.material.id?e.material.id-n.material.id:e.z!==n.z?e.z-n.z:e.id-n.id}function v5(e,n){return e.groupOrder!==n.groupOrder?e.groupOrder-n.groupOrder:e.renderOrder!==n.renderOrder?e.renderOrder-n.renderOrder:e.z!==n.z?n.z-e.z:e.id-n.id}function z3(){function e(R,N,H,W,$,K){var rt=n[u];return rt===void 0?(rt={id:R.id,object:R,geometry:N,material:H,program:H.program||T,groupOrder:W,renderOrder:R.renderOrder,z:$,group:K},n[u]=rt):(rt.id=R.id,rt.object=R,rt.geometry=N,rt.material=H,rt.program=H.program||T,rt.groupOrder=W,rt.renderOrder=R.renderOrder,rt.z=$,rt.group=K),u++,rt}var n=[],u=0,m=[],_=[],T={id:-1};return{opaque:m,transparent:_,init:function(){u=0,m.length=0,_.length=0},push:function(R,N,H,W,$,K){R=e(R,N,H,W,$,K),(H.transparent===!0?_:m).push(R)},unshift:function(R,N,H,W,$,K){R=e(R,N,H,W,$,K),(H.transparent===!0?_:m).unshift(R)},finish:function(){for(var R=u,N=n.length;R<N;R++){var H=n[R];if(H.id===null)break;H.id=null,H.object=null,H.geometry=null,H.material=null,H.program=null,H.group=null}},sort:function(R,N){1<m.length&&m.sort(R||g5),1<_.length&&_.sort(N||v5)}}}function y5(){function e(u){u=u.target,u.removeEventListener("dispose",e),n.delete(u)}var n=new ki;return{get:function(u,m){var _=n.get(u);if(_===void 0){var T=new z3;n.set(u,new ki),n.get(u).set(m,T),u.addEventListener("dispose",e)}else T=_.get(m),T===void 0&&(T=new z3,_.set(m,T));return T},dispose:function(){n=new ki}}}function x5(){var e={};return{get:function(n){if(e[n.id]!==void 0)return e[n.id];switch(n.type){case"DirectionalLight":var u={direction:new w,color:new wt};break;case"SpotLight":u={position:new w,direction:new w,color:new wt,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":u={position:new w,color:new wt,distance:0,decay:0};break;case"HemisphereLight":u={direction:new w,skyColor:new wt,groundColor:new wt};break;case"RectAreaLight":u={color:new wt,position:new w,halfWidth:new w,halfHeight:new w}}return e[n.id]=u}}}function A5(){var e={};return{get:function(n){if(e[n.id]!==void 0)return e[n.id];switch(n.type){case"DirectionalLight":var u={shadowBias:0,shadowRadius:1,shadowMapSize:new f};break;case"SpotLight":u={shadowBias:0,shadowRadius:1,shadowMapSize:new f};break;case"PointLight":u={shadowBias:0,shadowRadius:1,shadowMapSize:new f,shadowCameraNear:1,shadowCameraFar:1e3}}return e[n.id]=u}}}function _5(e,n){return(n.castShadow?1:0)-(e.castShadow?1:0)}function w5(){for(var e=new x5,n=A5(),u={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]},m=0;9>m;m++)u.probe.push(new w);var _=new w,T=new I,R=new I;return{setup:function(N,H,W){for(var $=0,K=0,rt=0,et=0;9>et;et++)u.probe[et].set(0,0,0);var at=H=0,mt=0,Ft=0,Wt=0,Ht=0,$t=0,Yt=0;W=W.matrixWorldInverse,N.sort(_5),et=0;for(var ie=N.length;et<ie;et++){var Vt=N[et],ve=Vt.color,Le=Vt.intensity,oe=Vt.distance,Pe=Vt.shadow&&Vt.shadow.map?Vt.shadow.map.texture:null;if(Vt.isAmbientLight)$+=ve.r*Le,K+=ve.g*Le,rt+=ve.b*Le;else if(Vt.isLightProbe)for(Pe=0;9>Pe;Pe++)u.probe[Pe].addScaledVector(Vt.sh.coefficients[Pe],Le);else if(Vt.isDirectionalLight){var Ie=e.get(Vt);Ie.color.copy(Vt.color).multiplyScalar(Vt.intensity),Ie.direction.setFromMatrixPosition(Vt.matrixWorld),_.setFromMatrixPosition(Vt.target.matrixWorld),Ie.direction.sub(_),Ie.direction.transformDirection(W),Vt.castShadow&&(Le=Vt.shadow,ve=n.get(Vt),ve.shadowBias=Le.bias,ve.shadowRadius=Le.radius,ve.shadowMapSize=Le.mapSize,u.directionalShadow[H]=ve,u.directionalShadowMap[H]=Pe,u.directionalShadowMatrix[H]=Vt.shadow.matrix,Ht++),u.directional[H]=Ie,H++}else Vt.isSpotLight?(Ie=e.get(Vt),Ie.position.setFromMatrixPosition(Vt.matrixWorld),Ie.position.applyMatrix4(W),Ie.color.copy(ve).multiplyScalar(Le),Ie.distance=oe,Ie.direction.setFromMatrixPosition(Vt.matrixWorld),_.setFromMatrixPosition(Vt.target.matrixWorld),Ie.direction.sub(_),Ie.direction.transformDirection(W),Ie.coneCos=Math.cos(Vt.angle),Ie.penumbraCos=Math.cos(Vt.angle*(1-Vt.penumbra)),Ie.decay=Vt.decay,Vt.castShadow&&(Le=Vt.shadow,ve=n.get(Vt),ve.shadowBias=Le.bias,ve.shadowRadius=Le.radius,ve.shadowMapSize=Le.mapSize,u.spotShadow[mt]=ve,u.spotShadowMap[mt]=Pe,u.spotShadowMatrix[mt]=Vt.shadow.matrix,Yt++),u.spot[mt]=Ie,mt++):Vt.isRectAreaLight?(Ie=e.get(Vt),Ie.color.copy(ve).multiplyScalar(Le),Ie.position.setFromMatrixPosition(Vt.matrixWorld),Ie.position.applyMatrix4(W),R.identity(),T.copy(Vt.matrixWorld),T.premultiply(W),R.extractRotation(T),Ie.halfWidth.set(.5*Vt.width,0,0),Ie.halfHeight.set(0,.5*Vt.height,0),Ie.halfWidth.applyMatrix4(R),Ie.halfHeight.applyMatrix4(R),u.rectArea[Ft]=Ie,Ft++):Vt.isPointLight?(Ie=e.get(Vt),Ie.position.setFromMatrixPosition(Vt.matrixWorld),Ie.position.applyMatrix4(W),Ie.color.copy(Vt.color).multiplyScalar(Vt.intensity),Ie.distance=Vt.distance,Ie.decay=Vt.decay,Vt.castShadow&&(Le=Vt.shadow,ve=n.get(Vt),ve.shadowBias=Le.bias,ve.shadowRadius=Le.radius,ve.shadowMapSize=Le.mapSize,ve.shadowCameraNear=Le.camera.near,ve.shadowCameraFar=Le.camera.far,u.pointShadow[at]=ve,u.pointShadowMap[at]=Pe,u.pointShadowMatrix[at]=Vt.shadow.matrix,$t++),u.point[at]=Ie,at++):Vt.isHemisphereLight&&(Ie=e.get(Vt),Ie.direction.setFromMatrixPosition(Vt.matrixWorld),Ie.direction.transformDirection(W),Ie.direction.normalize(),Ie.skyColor.copy(Vt.color).multiplyScalar(Le),Ie.groundColor.copy(Vt.groundColor).multiplyScalar(Le),u.hemi[Wt]=Ie,Wt++)}u.ambient[0]=$,u.ambient[1]=K,u.ambient[2]=rt,N=u.hash,(N.directionalLength!==H||N.pointLength!==at||N.spotLength!==mt||N.rectAreaLength!==Ft||N.hemiLength!==Wt||N.numDirectionalShadows!==Ht||N.numPointShadows!==$t||N.numSpotShadows!==Yt)&&(u.directional.length=H,u.spot.length=mt,u.rectArea.length=Ft,u.point.length=at,u.hemi.length=Wt,u.directionalShadow.length=Ht,u.directionalShadowMap.length=Ht,u.pointShadow.length=$t,u.pointShadowMap.length=$t,u.spotShadow.length=Yt,u.spotShadowMap.length=Yt,u.directionalShadowMatrix.length=Ht,u.pointShadowMatrix.length=$t,u.spotShadowMatrix.length=Yt,N.directionalLength=H,N.pointLength=at,N.spotLength=mt,N.rectAreaLength=Ft,N.hemiLength=Wt,N.numDirectionalShadows=Ht,N.numPointShadows=$t,N.numSpotShadows=Yt,u.version=J5++)},state:u}}function N3(){var e=new w5,n=[],u=[];return{init:function(){n.length=0,u.length=0},state:{lightsArray:n,shadowsArray:u,lights:e},setupLights:function(m){e.setup(n,u,m)},pushLight:function(m){n.push(m)},pushShadow:function(m){u.push(m)}}}function M5(){function e(u){u=u.target,u.removeEventListener("dispose",e),n.delete(u)}var n=new ki;return{get:function(u,m){if(n.has(u)===!1){var _=new N3;n.set(u,new ki),n.get(u).set(m,_),u.addEventListener("dispose",e)}else n.get(u).has(m)===!1?(_=new N3,n.get(u).set(m,_)):_=n.get(u).get(m);return _},dispose:function(){n=new ki}}}function Cc(e){Qt.call(this),this.type="MeshDepthMaterial",this.depthPacking=3200,this.morphTargets=this.skinning=!1,this.displacementMap=this.alphaMap=this.map=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.setValues(e)}function Tc(e){Qt.call(this),this.type="MeshDistanceMaterial",this.referencePosition=new w,this.nearDistance=1,this.farDistance=1e3,this.morphTargets=this.skinning=!1,this.displacementMap=this.alphaMap=this.map=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.setValues(e)}function U3(e,n,u){function m(Yt,ie,Vt){Vt=Yt<<0|ie<<1|Vt<<2;var ve=K[Vt];return ve===void 0&&(ve=new Cc({depthPacking:3201,morphTargets:Yt,skinning:ie}),K[Vt]=ve),ve}function _(Yt,ie,Vt){Vt=Yt<<0|ie<<1|Vt<<2;var ve=rt[Vt];return ve===void 0&&(ve=new Tc({morphTargets:Yt,skinning:ie}),rt[Vt]=ve),ve}function T(Yt,ie,Vt,ve,Le,oe,Pe){var Ie=m,fr=Yt.customDepthMaterial;return ve.isPointLight===!0&&(Ie=_,fr=Yt.customDistanceMaterial),fr===void 0?(fr=!1,Vt.morphTargets===!0&&(fr=ie.morphAttributes&&ie.morphAttributes.position&&0<ie.morphAttributes.position.length),ie=!1,Yt.isSkinnedMesh===!0&&(Vt.skinning===!0?ie=!0:console.warn("THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:",Yt)),Yt=Ie(fr,ie,Yt.isInstancedMesh===!0)):Yt=fr,e.localClippingEnabled&&Vt.clipShadows===!0&&Vt.clippingPlanes.length!==0&&(fr=Yt.uuid,Ie=Vt.uuid,ie=et[fr],ie===void 0&&(ie={},et[fr]=ie),fr=ie[Ie],fr===void 0&&(fr=Yt.clone(),ie[Ie]=fr),Yt=fr),Yt.visible=Vt.visible,Yt.wireframe=Vt.wireframe,Yt.side=Pe===3?Vt.shadowSide!==null?Vt.shadowSide:Vt.side:Vt.shadowSide!==null?Vt.shadowSide:at[Vt.side],Yt.clipShadows=Vt.clipShadows,Yt.clippingPlanes=Vt.clippingPlanes,Yt.clipIntersection=Vt.clipIntersection,Yt.wireframeLinewidth=Vt.wireframeLinewidth,Yt.linewidth=Vt.linewidth,ve.isPointLight===!0&&Yt.isMeshDistanceMaterial===!0&&(Yt.referencePosition.setFromMatrixPosition(ve.matrixWorld),Yt.nearDistance=Le,Yt.farDistance=oe),Yt}function R(Yt,ie,Vt,ve,Le){if(Yt.visible!==!1){if(Yt.layers.test(ie.layers)&&(Yt.isMesh||Yt.isLine||Yt.isPoints)&&(Yt.castShadow||Yt.receiveShadow&&Le===3)&&(!Yt.frustumCulled||N.intersectsObject(Yt))){Yt.modelViewMatrix.multiplyMatrices(Vt.matrixWorldInverse,Yt.matrixWorld);var oe=n.update(Yt),Pe=Yt.material;if(Array.isArray(Pe))for(var Ie=oe.groups,fr=0,Lr=Ie.length;fr<Lr;fr++){var Ze=Ie[fr],Sr=Pe[Ze.materialIndex];Sr&&Sr.visible&&(Sr=T(Yt,oe,Sr,ve,Vt.near,Vt.far,Le),e.renderBufferDirect(Vt,null,oe,Sr,Yt,Ze))}else Pe.visible&&(Sr=T(Yt,oe,Pe,ve,Vt.near,Vt.far,Le),e.renderBufferDirect(Vt,null,oe,Sr,Yt,null))}for(Yt=Yt.children,oe=0,Pe=Yt.length;oe<Pe;oe++)R(Yt[oe],ie,Vt,ve,Le)}}var N=new Qe,H=new f,W=new f,$=new p,K=[],rt=[],et={},at={0:1,1:0,2:2},mt=new ue({defines:{SAMPLE_RATE:.25,HALF_SAMPLE_RATE:.125},uniforms:{shadow_pass:{value:null},resolution:{value:new f},radius:{value:4}},vertexShader:`void main() {
	gl_Position = vec4( position, 1.0 );
}`,fragmentShader:`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
  float mean = 0.0;
  float squared_mean = 0.0;
	float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy  ) / resolution ) );
  for ( float i = -1.0; i < 1.0 ; i += SAMPLE_RATE) {
    #ifdef HORIZONAL_PASS
      vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( i, 0.0 ) * radius ) / resolution ) );
      mean += distribution.x;
      squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
    #else
      float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0,  i )  * radius ) / resolution ) );
      mean += depth;
      squared_mean += depth * depth;
    #endif
  }
  mean = mean * HALF_SAMPLE_RATE;
  squared_mean = squared_mean * HALF_SAMPLE_RATE;
  float std_dev = sqrt( squared_mean - mean * mean );
  gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`}),Ft=mt.clone();Ft.defines.HORIZONAL_PASS=1;var Wt=new vt;Wt.setAttribute("position",new re(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));var Ht=new Pt(Wt,mt),$t=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=1,this.render=function(Yt,ie,Vt){if($t.enabled!==!1&&($t.autoUpdate!==!1||$t.needsUpdate!==!1)&&Yt.length!==0){var ve=e.getRenderTarget(),Le=e.getActiveCubeFace(),oe=e.getActiveMipmapLevel(),Pe=e.state;Pe.setBlending(0),Pe.buffers.color.setClear(1,1,1,1),Pe.buffers.depth.setTest(!0),Pe.setScissorTest(!1);for(var Ie=0,fr=Yt.length;Ie<fr;Ie++){var Lr=Yt[Ie],Ze=Lr.shadow;if(Ze===void 0)console.warn("THREE.WebGLShadowMap:",Lr,"has no shadow.");else{H.copy(Ze.mapSize);var Sr=Ze.getFrameExtents();H.multiply(Sr),W.copy(Ze.mapSize),(H.x>u||H.y>u)&&(H.x>u&&(W.x=Math.floor(u/Sr.x),H.x=W.x*Sr.x,Ze.mapSize.x=W.x),H.y>u&&(W.y=Math.floor(u/Sr.y),H.y=W.y*Sr.y,Ze.mapSize.y=W.y)),Ze.map!==null||Ze.isPointLightShadow||this.type!==3||(Sr={minFilter:1006,magFilter:1006,format:1023},Ze.map=new A(H.x,H.y,Sr),Ze.map.texture.name=Lr.name+".shadowMap",Ze.mapPass=new A(H.x,H.y,Sr),Ze.camera.updateProjectionMatrix()),Ze.map===null&&(Sr={minFilter:1003,magFilter:1003,format:1023},Ze.map=new A(H.x,H.y,Sr),Ze.map.texture.name=Lr.name+".shadowMap",Ze.camera.updateProjectionMatrix()),e.setRenderTarget(Ze.map),e.clear(),Sr=Ze.getViewportCount();for(var $r=0;$r<Sr;$r++){var Ur=Ze.getViewport($r);$.set(W.x*Ur.x,W.y*Ur.y,W.x*Ur.z,W.y*Ur.w),Pe.viewport($),Ze.updateMatrices(Lr,$r),N=Ze.getFrustum(),R(ie,Vt,Ze.camera,Lr,this.type)}Ze.isPointLightShadow||this.type!==3||(Lr=Ze,Ze=Vt,Sr=n.update(Ht),mt.uniforms.shadow_pass.value=Lr.map.texture,mt.uniforms.resolution.value=Lr.mapSize,mt.uniforms.radius.value=Lr.radius,e.setRenderTarget(Lr.mapPass),e.clear(),e.renderBufferDirect(Ze,null,Sr,mt,Ht,null),Ft.uniforms.shadow_pass.value=Lr.mapPass.texture,Ft.uniforms.resolution.value=Lr.mapSize,Ft.uniforms.radius.value=Lr.radius,e.setRenderTarget(Lr.map),e.clear(),e.renderBufferDirect(Ze,null,Sr,Ft,Ht,null))}}$t.needsUpdate=!1,e.setRenderTarget(ve,Le,oe)}}}function C5(e,n,u){function m(Nt,ze,lr){var Pr=new Uint8Array(4),pr=e.createTexture();for(e.bindTexture(Nt,pr),e.texParameteri(Nt,10241,9728),e.texParameteri(Nt,10240,9728),Nt=0;Nt<lr;Nt++)e.texImage2D(ze+Nt,0,6408,1,1,0,6408,5121,Pr);return pr}function _(Nt,ze){Ft[Nt]=1,Wt[Nt]===0&&(e.enableVertexAttribArray(Nt),Wt[Nt]=1),Ht[Nt]!==ze&&((rt?e:n.get("ANGLE_instanced_arrays"))[rt?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](Nt,ze),Ht[Nt]=ze)}function T(Nt){$t[Nt]!==!0&&(e.enable(Nt),$t[Nt]=!0)}function R(Nt){$t[Nt]!==!1&&(e.disable(Nt),$t[Nt]=!1)}function N(Nt,ze,lr,Pr,pr,$e,tr,kr){if(Nt===0)ie&&(R(3042),ie=!1);else if(ie||(T(3042),ie=!0),Nt!==5){if(Nt!==Vt||kr!==Lr){if((ve!==100||Pe!==100)&&(e.blendEquation(32774),Pe=ve=100),kr)switch(Nt){case 1:e.blendFuncSeparate(1,771,1,771);break;case 2:e.blendFunc(1,1);break;case 3:e.blendFuncSeparate(0,0,769,771);break;case 4:e.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",Nt)}else switch(Nt){case 1:e.blendFuncSeparate(770,771,1,771);break;case 2:e.blendFunc(770,1);break;case 3:e.blendFunc(0,769);break;case 4:e.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",Nt)}fr=Ie=oe=Le=null,Vt=Nt,Lr=kr}}else pr=pr||ze,$e=$e||lr,tr=tr||Pr,(ze!==ve||pr!==Pe)&&(e.blendEquationSeparate(ir[ze],ir[pr]),ve=ze,Pe=pr),(lr!==Le||Pr!==oe||$e!==Ie||tr!==fr)&&(e.blendFuncSeparate(Ce[lr],Ce[Pr],Ce[$e],Ce[tr]),Le=lr,oe=Pr,Ie=$e,fr=tr),Vt=Nt,Lr=null}function H(Nt){Ze!==Nt&&(Nt?e.frontFace(2304):e.frontFace(2305),Ze=Nt)}function W(Nt){Nt!==0?(T(2884),Nt!==Sr&&(Nt===1?e.cullFace(1029):Nt===2?e.cullFace(1028):e.cullFace(1032))):R(2884),Sr=Nt}function $(Nt,ze,lr){Nt?(T(32823),(Ur!==ze||fi!==lr)&&(e.polygonOffset(ze,lr),Ur=ze,fi=lr)):R(32823)}function K(Nt){Nt===void 0&&(Nt=33984+ei-1),Yi!==Nt&&(e.activeTexture(Nt),Yi=Nt)}var rt=u.isWebGL2,et=new function(){var Nt=!1,ze=new p,lr=null,Pr=new p(0,0,0,0);return{setMask:function(pr){lr===pr||Nt||(e.colorMask(pr,pr,pr,pr),lr=pr)},setLocked:function(pr){Nt=pr},setClear:function(pr,$e,tr,kr,hn){hn===!0&&(pr*=kr,$e*=kr,tr*=kr),ze.set(pr,$e,tr,kr),Pr.equals(ze)===!1&&(e.clearColor(pr,$e,tr,kr),Pr.copy(ze))},reset:function(){Nt=!1,lr=null,Pr.set(-1,0,0,0)}}},at=new function(){var Nt=!1,ze=null,lr=null,Pr=null;return{setTest:function(pr){pr?T(2929):R(2929)},setMask:function(pr){ze===pr||Nt||(e.depthMask(pr),ze=pr)},setFunc:function(pr){if(lr!==pr){if(pr)switch(pr){case 0:e.depthFunc(512);break;case 1:e.depthFunc(519);break;case 2:e.depthFunc(513);break;case 3:e.depthFunc(515);break;case 4:e.depthFunc(514);break;case 5:e.depthFunc(518);break;case 6:e.depthFunc(516);break;case 7:e.depthFunc(517);break;default:e.depthFunc(515)}else e.depthFunc(515);lr=pr}},setLocked:function(pr){Nt=pr},setClear:function(pr){Pr!==pr&&(e.clearDepth(pr),Pr=pr)},reset:function(){Nt=!1,Pr=lr=ze=null}}},mt=new function(){var Nt=!1,ze=null,lr=null,Pr=null,pr=null,$e=null,tr=null,kr=null,hn=null;return{setTest:function(Xr){Nt||(Xr?T(2960):R(2960))},setMask:function(Xr){ze===Xr||Nt||(e.stencilMask(Xr),ze=Xr)},setFunc:function(Xr,Ee,Hr){(lr!==Xr||Pr!==Ee||pr!==Hr)&&(e.stencilFunc(Xr,Ee,Hr),lr=Xr,Pr=Ee,pr=Hr)},setOp:function(Xr,Ee,Hr){($e!==Xr||tr!==Ee||kr!==Hr)&&(e.stencilOp(Xr,Ee,Hr),$e=Xr,tr=Ee,kr=Hr)},setLocked:function(Xr){Nt=Xr},setClear:function(Xr){hn!==Xr&&(e.clearStencil(Xr),hn=Xr)},reset:function(){Nt=!1,hn=kr=tr=$e=pr=Pr=lr=ze=null}}};u=e.getParameter(34921);var Ft=new Uint8Array(u),Wt=new Uint8Array(u),Ht=new Uint8Array(u),$t={},Yt=null,ie=null,Vt=null,ve=null,Le=null,oe=null,Pe=null,Ie=null,fr=null,Lr=!1,Ze=null,Sr=null,$r=null,Ur=null,fi=null,ei=e.getParameter(35661),Di=!1;u=0,u=e.getParameter(7938),u.indexOf("WebGL")!==-1?(u=parseFloat(/^WebGL ([0-9])/.exec(u)[1]),Di=1<=u):u.indexOf("OpenGL ES")!==-1&&(u=parseFloat(/^OpenGL ES ([0-9])/.exec(u)[1]),Di=2<=u);var Yi=null,St={},Bt=new p,ce=new p,Fe={};Fe[3553]=m(3553,3553,1),Fe[34067]=m(34067,34069,6),et.setClear(0,0,0,1),at.setClear(1),mt.setClear(0),T(2929),at.setFunc(3),H(!1),W(1),T(2884),N(0);var ir={100:32774,101:32778,102:32779};rt?(ir[103]=32775,ir[104]=32776):(u=n.get("EXT_blend_minmax"),u!==null&&(ir[103]=u.MIN_EXT,ir[104]=u.MAX_EXT));var Ce={200:0,201:1,202:768,204:770,210:776,208:774,206:772,203:769,205:771,209:775,207:773};return{buffers:{color:et,depth:at,stencil:mt},initAttributes:function(){for(var Nt=0,ze=Ft.length;Nt<ze;Nt++)Ft[Nt]=0},enableAttribute:function(Nt){_(Nt,0)},enableAttributeAndDivisor:_,disableUnusedAttributes:function(){for(var Nt=0,ze=Wt.length;Nt!==ze;++Nt)Wt[Nt]!==Ft[Nt]&&(e.disableVertexAttribArray(Nt),Wt[Nt]=0)},vertexAttribPointer:function(Nt,ze,lr,Pr,pr,$e){rt!==!0||lr!==5124&&lr!==5125?e.vertexAttribPointer(Nt,ze,lr,Pr,pr,$e):e.vertexAttribIPointer(Nt,ze,lr,Pr,pr,$e)},enable:T,disable:R,useProgram:function(Nt){return Yt!==Nt?(e.useProgram(Nt),Yt=Nt,!0):!1},setBlending:N,setMaterial:function(Nt,ze){Nt.side===2?R(2884):T(2884);var lr=Nt.side===1;ze&&(lr=!lr),H(lr),Nt.blending===1&&Nt.transparent===!1?N(0):N(Nt.blending,Nt.blendEquation,Nt.blendSrc,Nt.blendDst,Nt.blendEquationAlpha,Nt.blendSrcAlpha,Nt.blendDstAlpha,Nt.premultipliedAlpha),at.setFunc(Nt.depthFunc),at.setTest(Nt.depthTest),at.setMask(Nt.depthWrite),et.setMask(Nt.colorWrite),ze=Nt.stencilWrite,mt.setTest(ze),ze&&(mt.setMask(Nt.stencilWriteMask),mt.setFunc(Nt.stencilFunc,Nt.stencilRef,Nt.stencilFuncMask),mt.setOp(Nt.stencilFail,Nt.stencilZFail,Nt.stencilZPass)),$(Nt.polygonOffset,Nt.polygonOffsetFactor,Nt.polygonOffsetUnits)},setFlipSided:H,setCullFace:W,setLineWidth:function(Nt){Nt!==$r&&(Di&&e.lineWidth(Nt),$r=Nt)},setPolygonOffset:$,setScissorTest:function(Nt){Nt?T(3089):R(3089)},activeTexture:K,bindTexture:function(Nt,ze){Yi===null&&K();var lr=St[Yi];lr===void 0&&(lr={type:void 0,texture:void 0},St[Yi]=lr),(lr.type!==Nt||lr.texture!==ze)&&(e.bindTexture(Nt,ze||Fe[Nt]),lr.type=Nt,lr.texture=ze)},unbindTexture:function(){var Nt=St[Yi];Nt!==void 0&&Nt.type!==void 0&&(e.bindTexture(Nt.type,null),Nt.type=void 0,Nt.texture=void 0)},compressedTexImage2D:function(){try{e.compressedTexImage2D.apply(e,arguments)}catch(Nt){console.error("THREE.WebGLState:",Nt)}},texImage2D:function(){try{e.texImage2D.apply(e,arguments)}catch(Nt){console.error("THREE.WebGLState:",Nt)}},texImage3D:function(){try{e.texImage3D.apply(e,arguments)}catch(Nt){console.error("THREE.WebGLState:",Nt)}},scissor:function(Nt){Bt.equals(Nt)===!1&&(e.scissor(Nt.x,Nt.y,Nt.z,Nt.w),Bt.copy(Nt))},viewport:function(Nt){ce.equals(Nt)===!1&&(e.viewport(Nt.x,Nt.y,Nt.z,Nt.w),ce.copy(Nt))},reset:function(){for(var Nt=0;Nt<Wt.length;Nt++)Wt[Nt]===1&&(e.disableVertexAttribArray(Nt),Wt[Nt]=0);$t={},Yi=null,St={},Sr=Ze=Vt=Yt=null,et.reset(),at.reset(),mt.reset()}}}function T5(e,n,u,m,_,T,R){function N(St,Bt){return $r?new OffscreenCanvas(St,Bt):document.createElementNS("http://www.w3.org/1999/xhtml","canvas")}function H(St,Bt,ce,Fe){var ir=1;if((St.width>Fe||St.height>Fe)&&(ir=Fe/Math.max(St.width,St.height)),1>ir||Bt===!0){if(typeof HTMLImageElement!="undefined"&&St instanceof HTMLImageElement||typeof HTMLCanvasElement!="undefined"&&St instanceof HTMLCanvasElement||typeof ImageBitmap!="undefined"&&St instanceof ImageBitmap)return Fe=Bt?ni.floorPowerOfTwo:Math.floor,Bt=Fe(ir*St.width),ir=Fe(ir*St.height),Sr===void 0&&(Sr=N(Bt,ir)),ce=ce?N(Bt,ir):Sr,ce.width=Bt,ce.height=ir,ce.getContext("2d").drawImage(St,0,0,Bt,ir),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+St.width+"x"+St.height+") to ("+Bt+"x"+ir+")."),ce;"data"in St&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+St.width+"x"+St.height+").")}return St}function W(St){return ni.isPowerOfTwo(St.width)&&ni.isPowerOfTwo(St.height)}function $(St,Bt){return St.generateMipmaps&&Bt&&St.minFilter!==1003&&St.minFilter!==1006}function K(St,Bt,ce,Fe){e.generateMipmap(St),m.get(Bt).__maxMipLevel=Math.log(Math.max(ce,Fe))*Math.LOG2E}function rt(St,Bt,ce){if(oe===!1)return Bt;if(St!==null){if(e[St]!==void 0)return e[St];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+St+"'")}return St=Bt,Bt===6403&&(ce===5126&&(St=33326),ce===5131&&(St=33325),ce===5121&&(St=33321)),Bt===6407&&(ce===5126&&(St=34837),ce===5131&&(St=34843),ce===5121&&(St=32849)),Bt===6408&&(ce===5126&&(St=34836),ce===5131&&(St=34842),ce===5121&&(St=32856)),St!==33325&&St!==33326&&St!==34842&&St!==34836||n.get("EXT_color_buffer_float"),St}function et(St){return St===1003||St===1004||St===1005?9728:9729}function at(St){St=St.target,St.removeEventListener("dispose",at);var Bt=m.get(St);Bt.__webglInit!==void 0&&(e.deleteTexture(Bt.__webglTexture),m.remove(St)),St.isVideoTexture&&Ze.delete(St),R.memory.textures--}function mt(St){St=St.target,St.removeEventListener("dispose",mt);var Bt=m.get(St),ce=m.get(St.texture);if(St){if(ce.__webglTexture!==void 0&&e.deleteTexture(ce.__webglTexture),St.depthTexture&&St.depthTexture.dispose(),St.isWebGLCubeRenderTarget)for(ce=0;6>ce;ce++)e.deleteFramebuffer(Bt.__webglFramebuffer[ce]),Bt.__webglDepthbuffer&&e.deleteRenderbuffer(Bt.__webglDepthbuffer[ce]);else e.deleteFramebuffer(Bt.__webglFramebuffer),Bt.__webglDepthbuffer&&e.deleteRenderbuffer(Bt.__webglDepthbuffer),Bt.__webglMultisampledFramebuffer&&e.deleteFramebuffer(Bt.__webglMultisampledFramebuffer),Bt.__webglColorRenderbuffer&&e.deleteRenderbuffer(Bt.__webglColorRenderbuffer),Bt.__webglDepthRenderbuffer&&e.deleteRenderbuffer(Bt.__webglDepthRenderbuffer);m.remove(St.texture),m.remove(St)}R.memory.textures--}function Ft(St,Bt){var ce=m.get(St);if(St.isVideoTexture){var Fe=R.render.frame;Ze.get(St)!==Fe&&(Ze.set(St,Fe),St.update())}if(0<St.version&&ce.__version!==St.version)if(Fe=St.image,Fe===void 0)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else if(Fe.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{ie(ce,St,Bt);return}u.activeTexture(33984+Bt),u.bindTexture(3553,ce.__webglTexture)}function Wt(St,Bt){if(St.image.length===6){var ce=m.get(St);if(0<St.version&&ce.__version!==St.version){Yt(ce,St),u.activeTexture(33984+Bt),u.bindTexture(34067,ce.__webglTexture),e.pixelStorei(37440,St.flipY);var Fe=St&&(St.isCompressedTexture||St.image[0].isCompressedTexture);Bt=St.image[0]&&St.image[0].isDataTexture;for(var ir=[],Ce=0;6>Ce;Ce++)ir[Ce]=Fe||Bt?Bt?St.image[Ce].image:St.image[Ce]:H(St.image[Ce],!1,!0,Ie);var Nt=ir[0],ze=W(Nt)||oe,lr=T.convert(St.format),Pr=T.convert(St.type),pr=rt(St.internalFormat,lr,Pr);if($t(34067,St,ze),Fe){for(Ce=0;6>Ce;Ce++){var $e=ir[Ce].mipmaps;for(Fe=0;Fe<$e.length;Fe++){var tr=$e[Fe];St.format!==1023&&St.format!==1022?lr!==null?u.compressedTexImage2D(34069+Ce,Fe,pr,tr.width,tr.height,0,tr.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):u.texImage2D(34069+Ce,Fe,pr,tr.width,tr.height,0,lr,Pr,tr.data)}}ce.__maxMipLevel=$e.length-1}else{for($e=St.mipmaps,Ce=0;6>Ce;Ce++)if(Bt)for(u.texImage2D(34069+Ce,0,pr,ir[Ce].width,ir[Ce].height,0,lr,Pr,ir[Ce].data),Fe=0;Fe<$e.length;Fe++)tr=$e[Fe],tr=tr.image[Ce].image,u.texImage2D(34069+Ce,Fe+1,pr,tr.width,tr.height,0,lr,Pr,tr.data);else for(u.texImage2D(34069+Ce,0,pr,lr,Pr,ir[Ce]),Fe=0;Fe<$e.length;Fe++)tr=$e[Fe],u.texImage2D(34069+Ce,Fe+1,pr,lr,Pr,tr.image[Ce]);ce.__maxMipLevel=$e.length}$(St,ze)&&K(34067,St,Nt.width,Nt.height),ce.__version=St.version,St.onUpdate&&St.onUpdate(St)}else u.activeTexture(33984+Bt),u.bindTexture(34067,ce.__webglTexture)}}function Ht(St,Bt){u.activeTexture(33984+Bt),u.bindTexture(34067,m.get(St).__webglTexture)}function $t(St,Bt,ce){ce?(e.texParameteri(St,10242,fi[Bt.wrapS]),e.texParameteri(St,10243,fi[Bt.wrapT]),St!==32879&&St!==35866||e.texParameteri(St,32882,fi[Bt.wrapR]),e.texParameteri(St,10240,ei[Bt.magFilter]),e.texParameteri(St,10241,ei[Bt.minFilter])):(e.texParameteri(St,10242,33071),e.texParameteri(St,10243,33071),St!==32879&&St!==35866||e.texParameteri(St,32882,33071),Bt.wrapS===1001&&Bt.wrapT===1001||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),e.texParameteri(St,10240,et(Bt.magFilter)),e.texParameteri(St,10241,et(Bt.minFilter)),Bt.minFilter!==1003&&Bt.minFilter!==1006&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),!(ce=n.get("EXT_texture_filter_anisotropic"))||Bt.type===1015&&n.get("OES_texture_float_linear")===null||Bt.type===1016&&(oe||n.get("OES_texture_half_float_linear"))===null||!(1<Bt.anisotropy||m.get(Bt).__currentAnisotropy)||(e.texParameterf(St,ce.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(Bt.anisotropy,_.getMaxAnisotropy())),m.get(Bt).__currentAnisotropy=Bt.anisotropy)}function Yt(St,Bt){St.__webglInit===void 0&&(St.__webglInit=!0,Bt.addEventListener("dispose",at),St.__webglTexture=e.createTexture(),R.memory.textures++)}function ie(St,Bt,ce){var Fe=3553;Bt.isDataTexture2DArray&&(Fe=35866),Bt.isDataTexture3D&&(Fe=32879),Yt(St,Bt),u.activeTexture(33984+ce),u.bindTexture(Fe,St.__webglTexture),e.pixelStorei(37440,Bt.flipY),e.pixelStorei(37441,Bt.premultiplyAlpha),e.pixelStorei(3317,Bt.unpackAlignment),ce=oe?!1:Bt.wrapS!==1001||Bt.wrapT!==1001||Bt.minFilter!==1003&&Bt.minFilter!==1006,ce=ce&&W(Bt.image)===!1,ce=H(Bt.image,ce,!1,fr);var ir=W(ce)||oe,Ce=T.convert(Bt.format),Nt=T.convert(Bt.type),ze=rt(Bt.internalFormat,Ce,Nt);$t(Fe,Bt,ir);var lr=Bt.mipmaps;if(Bt.isDepthTexture)ze=6402,oe?ze=Bt.type===1015?36012:Bt.type===1014?33190:Bt.type===1020?35056:33189:Bt.type===1015&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),Bt.format===1026&&ze===6402&&Bt.type!==1012&&Bt.type!==1014&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),Bt.type=1012,Nt=T.convert(Bt.type)),Bt.format===1027&&ze===6402&&(ze=34041,Bt.type!==1020&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),Bt.type=1020,Nt=T.convert(Bt.type))),u.texImage2D(3553,0,ze,ce.width,ce.height,0,Ce,Nt,null);else if(Bt.isDataTexture)if(0<lr.length&&ir){for(var Pr=0,pr=lr.length;Pr<pr;Pr++){var $e=lr[Pr];u.texImage2D(3553,Pr,ze,$e.width,$e.height,0,Ce,Nt,$e.data)}Bt.generateMipmaps=!1,St.__maxMipLevel=lr.length-1}else u.texImage2D(3553,0,ze,ce.width,ce.height,0,Ce,Nt,ce.data),St.__maxMipLevel=0;else if(Bt.isCompressedTexture){for(Pr=0,pr=lr.length;Pr<pr;Pr++)$e=lr[Pr],Bt.format!==1023&&Bt.format!==1022?Ce!==null?u.compressedTexImage2D(3553,Pr,ze,$e.width,$e.height,0,$e.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):u.texImage2D(3553,Pr,ze,$e.width,$e.height,0,Ce,Nt,$e.data);St.__maxMipLevel=lr.length-1}else if(Bt.isDataTexture2DArray)u.texImage3D(35866,0,ze,ce.width,ce.height,ce.depth,0,Ce,Nt,ce.data),St.__maxMipLevel=0;else if(Bt.isDataTexture3D)u.texImage3D(32879,0,ze,ce.width,ce.height,ce.depth,0,Ce,Nt,ce.data),St.__maxMipLevel=0;else if(0<lr.length&&ir){for(Pr=0,pr=lr.length;Pr<pr;Pr++)$e=lr[Pr],u.texImage2D(3553,Pr,ze,Ce,Nt,$e);Bt.generateMipmaps=!1,St.__maxMipLevel=lr.length-1}else u.texImage2D(3553,0,ze,Ce,Nt,ce),St.__maxMipLevel=0;$(Bt,ir)&&K(Fe,Bt,ce.width,ce.height),St.__version=Bt.version,Bt.onUpdate&&Bt.onUpdate(Bt)}function Vt(St,Bt,ce,Fe){var ir=T.convert(Bt.texture.format),Ce=T.convert(Bt.texture.type),Nt=rt(Bt.texture.internalFormat,ir,Ce);u.texImage2D(Fe,0,Nt,Bt.width,Bt.height,0,ir,Ce,null),e.bindFramebuffer(36160,St),e.framebufferTexture2D(36160,ce,Fe,m.get(Bt.texture).__webglTexture,0),e.bindFramebuffer(36160,null)}function ve(St,Bt,ce){if(e.bindRenderbuffer(36161,St),Bt.depthBuffer&&!Bt.stencilBuffer){var Fe=33189;ce?((ce=Bt.depthTexture)&&ce.isDepthTexture&&(ce.type===1015?Fe=36012:ce.type===1014&&(Fe=33190)),ce=Le(Bt),e.renderbufferStorageMultisample(36161,ce,Fe,Bt.width,Bt.height)):e.renderbufferStorage(36161,Fe,Bt.width,Bt.height),e.framebufferRenderbuffer(36160,36096,36161,St)}else Bt.depthBuffer&&Bt.stencilBuffer?(ce?(ce=Le(Bt),e.renderbufferStorageMultisample(36161,ce,35056,Bt.width,Bt.height)):e.renderbufferStorage(36161,34041,Bt.width,Bt.height),e.framebufferRenderbuffer(36160,33306,36161,St)):(St=T.convert(Bt.texture.format),Fe=T.convert(Bt.texture.type),Fe=rt(Bt.texture.internalFormat,St,Fe),ce?(ce=Le(Bt),e.renderbufferStorageMultisample(36161,ce,Fe,Bt.width,Bt.height)):e.renderbufferStorage(36161,Fe,Bt.width,Bt.height));e.bindRenderbuffer(36161,null)}function Le(St){return oe&&St.isWebGLMultisampleRenderTarget?Math.min(Lr,St.samples):0}var oe=_.isWebGL2,Pe=_.maxTextures,Ie=_.maxCubemapSize,fr=_.maxTextureSize,Lr=_.maxSamples,Ze=new ki,Sr,$r=!1;try{$r=typeof OffscreenCanvas!="undefined"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}var Ur=0,fi={1e3:10497,1001:33071,1002:33648},ei={1003:9728,1004:9984,1005:9986,1006:9729,1007:9985,1008:9987},Di=!1,Yi=!1;this.allocateTextureUnit=function(){var St=Ur;return St>=Pe&&console.warn("THREE.WebGLTextures: Trying to use "+St+" texture units while this GPU supports only "+Pe),Ur+=1,St},this.resetTextureUnits=function(){Ur=0},this.setTexture2D=Ft,this.setTexture2DArray=function(St,Bt){var ce=m.get(St);0<St.version&&ce.__version!==St.version?ie(ce,St,Bt):(u.activeTexture(33984+Bt),u.bindTexture(35866,ce.__webglTexture))},this.setTexture3D=function(St,Bt){var ce=m.get(St);0<St.version&&ce.__version!==St.version?ie(ce,St,Bt):(u.activeTexture(33984+Bt),u.bindTexture(32879,ce.__webglTexture))},this.setTextureCube=Wt,this.setTextureCubeDynamic=Ht,this.setupRenderTarget=function(St){var Bt=m.get(St),ce=m.get(St.texture);St.addEventListener("dispose",mt),ce.__webglTexture=e.createTexture(),R.memory.textures++;var Fe=St.isWebGLCubeRenderTarget===!0,ir=St.isWebGLMultisampleRenderTarget===!0,Ce=W(St)||oe;if(!oe||St.texture.format!==1022||St.texture.type!==1015&&St.texture.type!==1016||(St.texture.format=1023,console.warn("THREE.WebGLRenderer: Rendering to textures with RGB format is not supported. Using RGBA format instead.")),Fe)for(Bt.__webglFramebuffer=[],ir=0;6>ir;ir++)Bt.__webglFramebuffer[ir]=e.createFramebuffer();else if(Bt.__webglFramebuffer=e.createFramebuffer(),ir)if(oe){Bt.__webglMultisampledFramebuffer=e.createFramebuffer(),Bt.__webglColorRenderbuffer=e.createRenderbuffer(),e.bindRenderbuffer(36161,Bt.__webglColorRenderbuffer),ir=T.convert(St.texture.format);var Nt=T.convert(St.texture.type);ir=rt(St.texture.internalFormat,ir,Nt),Nt=Le(St),e.renderbufferStorageMultisample(36161,Nt,ir,St.width,St.height),e.bindFramebuffer(36160,Bt.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(36160,36064,36161,Bt.__webglColorRenderbuffer),e.bindRenderbuffer(36161,null),St.depthBuffer&&(Bt.__webglDepthRenderbuffer=e.createRenderbuffer(),ve(Bt.__webglDepthRenderbuffer,St,!0)),e.bindFramebuffer(36160,null)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.");if(Fe){for(u.bindTexture(34067,ce.__webglTexture),$t(34067,St.texture,Ce),ir=0;6>ir;ir++)Vt(Bt.__webglFramebuffer[ir],St,36064,34069+ir);$(St.texture,Ce)&&K(34067,St.texture,St.width,St.height),u.bindTexture(34067,null)}else u.bindTexture(3553,ce.__webglTexture),$t(3553,St.texture,Ce),Vt(Bt.__webglFramebuffer,St,36064,3553),$(St.texture,Ce)&&K(3553,St.texture,St.width,St.height),u.bindTexture(3553,null);if(St.depthBuffer){if(Bt=m.get(St),ce=St.isWebGLCubeRenderTarget===!0,St.depthTexture){if(ce)throw Error("target.depthTexture not supported in Cube render targets");if(St&&St.isWebGLCubeRenderTarget)throw Error("Depth Texture with cube render targets is not supported");if(e.bindFramebuffer(36160,Bt.__webglFramebuffer),!St.depthTexture||!St.depthTexture.isDepthTexture)throw Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");if(m.get(St.depthTexture).__webglTexture&&St.depthTexture.image.width===St.width&&St.depthTexture.image.height===St.height||(St.depthTexture.image.width=St.width,St.depthTexture.image.height=St.height,St.depthTexture.needsUpdate=!0),Ft(St.depthTexture,0),Bt=m.get(St.depthTexture).__webglTexture,St.depthTexture.format===1026)e.framebufferTexture2D(36160,36096,3553,Bt,0);else if(St.depthTexture.format===1027)e.framebufferTexture2D(36160,33306,3553,Bt,0);else throw Error("Unknown depthTexture format")}else if(ce)for(Bt.__webglDepthbuffer=[],ce=0;6>ce;ce++)e.bindFramebuffer(36160,Bt.__webglFramebuffer[ce]),Bt.__webglDepthbuffer[ce]=e.createRenderbuffer(),ve(Bt.__webglDepthbuffer[ce],St,!1);else e.bindFramebuffer(36160,Bt.__webglFramebuffer),Bt.__webglDepthbuffer=e.createRenderbuffer(),ve(Bt.__webglDepthbuffer,St,!1);e.bindFramebuffer(36160,null)}},this.updateRenderTargetMipmap=function(St){var Bt=St.texture,ce=W(St)||oe;if($(Bt,ce)){ce=St.isWebGLCubeRenderTarget?34067:3553;var Fe=m.get(Bt).__webglTexture;u.bindTexture(ce,Fe),K(ce,Bt,St.width,St.height),u.bindTexture(ce,null)}},this.updateMultisampleRenderTarget=function(St){if(St.isWebGLMultisampleRenderTarget)if(oe){var Bt=m.get(St);e.bindFramebuffer(36008,Bt.__webglMultisampledFramebuffer),e.bindFramebuffer(36009,Bt.__webglFramebuffer);var ce=St.width,Fe=St.height,ir=16384;St.depthBuffer&&(ir|=256),St.stencilBuffer&&(ir|=1024),e.blitFramebuffer(0,0,ce,Fe,0,0,ce,Fe,ir,9728),e.bindFramebuffer(36160,Bt.__webglMultisampledFramebuffer)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")},this.safeSetTexture2D=function(St,Bt){St&&St.isWebGLRenderTarget&&(Di===!1&&(console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),Di=!0),St=St.texture),Ft(St,Bt)},this.safeSetTextureCube=function(St,Bt){St&&St.isWebGLCubeRenderTarget&&(Yi===!1&&(console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),Yi=!0),St=St.texture),St&&St.isCubeTexture||Array.isArray(St.image)&&St.image.length===6?Wt(St,Bt):Ht(St,Bt)}}function b3(e,n,u){var m=u.isWebGL2;return{convert:function(_){if(_===1009)return 5121;if(_===1017)return 32819;if(_===1018)return 32820;if(_===1019)return 33635;if(_===1010)return 5120;if(_===1011)return 5122;if(_===1012)return 5123;if(_===1013)return 5124;if(_===1014)return 5125;if(_===1015)return 5126;if(_===1016){if(m)return 5131;var T=n.get("OES_texture_half_float");return T!==null?T.HALF_FLOAT_OES:null}if(_===1021)return 6406;if(_===1022)return 6407;if(_===1023)return 6408;if(_===1024)return 6409;if(_===1025)return 6410;if(_===1026)return 6402;if(_===1027)return 34041;if(_===1028)return 6403;if(_===1029)return 36244;if(_===1030)return 33319;if(_===1031)return 33320;if(_===1032)return 36248;if(_===1033)return 36249;if(_===33776||_===33777||_===33778||_===33779)if(T=n.get("WEBGL_compressed_texture_s3tc"),T!==null){if(_===33776)return T.COMPRESSED_RGB_S3TC_DXT1_EXT;if(_===33777)return T.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(_===33778)return T.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(_===33779)return T.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(_===35840||_===35841||_===35842||_===35843)if(T=n.get("WEBGL_compressed_texture_pvrtc"),T!==null){if(_===35840)return T.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(_===35841)return T.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(_===35842)return T.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(_===35843)return T.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(_===36196)return T=n.get("WEBGL_compressed_texture_etc1"),T!==null?T.COMPRESSED_RGB_ETC1_WEBGL:null;if((_===37492||_===37496)&&(T=n.get("WEBGL_compressed_texture_etc"),T!==null)){if(_===37492)return T.COMPRESSED_RGB8_ETC2;if(_===37496)return T.COMPRESSED_RGBA8_ETC2_EAC}if(_===37808||_===37809||_===37810||_===37811||_===37812||_===37813||_===37814||_===37815||_===37816||_===37817||_===37818||_===37819||_===37820||_===37821||_===37840||_===37841||_===37842||_===37843||_===37844||_===37845||_===37846||_===37847||_===37848||_===37849||_===37850||_===37851||_===37852||_===37853)return T=n.get("WEBGL_compressed_texture_astc"),T!==null?_:null;if(_===36492)return T=n.get("EXT_texture_compression_bptc"),T!==null?_:null;if(_===1020)return m?34042:(T=n.get("WEBGL_depth_texture"),T!==null?T.UNSIGNED_INT_24_8_WEBGL:null)}}}function sx(e){Ae.call(this),this.cameras=e||[]}function tm(){F.call(this),this.type="Group"}function ax(){this._grip=this._targetRay=null}function k3(e,n){function u(oe){var Pe=at.get(oe.inputSource);Pe&&Pe.dispatchEvent({type:oe.type})}function m(){at.forEach(function(oe,Pe){oe.disconnect(Pe)}),at.clear(),e.setFramebuffer(null),e.setRenderTarget(e.getRenderTarget()),Le.stop(),N.isPresenting=!1,N.dispatchEvent({type:"sessionend"})}function _(oe){$=oe,Le.setContext(H),Le.start(),N.isPresenting=!0,N.dispatchEvent({type:"sessionstart"})}function T(oe){for(var Pe=H.inputSources,Ie=0;Ie<et.length;Ie++)at.set(Pe[Ie],et[Ie]);for(Ie=0;Ie<oe.removed.length;Ie++){Pe=oe.removed[Ie];var fr=at.get(Pe);fr&&(fr.dispatchEvent({type:"disconnected",data:Pe}),at.delete(Pe))}for(Ie=0;Ie<oe.added.length;Ie++)Pe=oe.added[Ie],(fr=at.get(Pe))&&fr.dispatchEvent({type:"connected",data:Pe})}function R(oe,Pe){Pe===null?oe.matrixWorld.copy(oe.matrix):oe.matrixWorld.multiplyMatrices(Pe.matrixWorld,oe.matrix),oe.matrixWorldInverse.getInverse(oe.matrixWorld)}var N=this,H=null,W=1,$=null,K="local-floor",rt=null,et=[],at=new vv,mt=new Ae;mt.layers.enable(1),mt.viewport=new p;var Ft=new Ae;Ft.layers.enable(2),Ft.viewport=new p;var Wt=[mt,Ft],Ht=new sx;Ht.layers.enable(1),Ht.layers.enable(2);var $t=null,Yt=null;this.isPresenting=this.enabled=!1,this.getController=function(oe){var Pe=et[oe];return Pe===void 0&&(Pe=new ax,et[oe]=Pe),Pe.getTargetRaySpace()},this.getControllerGrip=function(oe){var Pe=et[oe];return Pe===void 0&&(Pe=new ax,et[oe]=Pe),Pe.getGripSpace()},this.setFramebufferScaleFactor=function(oe){W=oe,N.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(oe){K=oe,N.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return $},this.getSession=function(){return H},this.setSession=function(oe){H=oe,H!==null&&(H.addEventListener("select",u),H.addEventListener("selectstart",u),H.addEventListener("selectend",u),H.addEventListener("squeeze",u),H.addEventListener("squeezestart",u),H.addEventListener("squeezeend",u),H.addEventListener("end",m),oe=n.getContextAttributes(),oe.xrCompatible!==!0&&n.makeXRCompatible(),oe=new XRWebGLLayer(H,n,{antialias:oe.antialias,alpha:oe.alpha,depth:oe.depth,stencil:oe.stencil,framebufferScaleFactor:W}),H.updateRenderState({baseLayer:oe}),H.requestReferenceSpace(K).then(_),H.addEventListener("inputsourceschange",T))};var ie=new w,Vt=new w;this.getCamera=function(oe){Ht.near=Ft.near=mt.near=oe.near,Ht.far=Ft.far=mt.far=oe.far,($t!==Ht.near||Yt!==Ht.far)&&(H.updateRenderState({depthNear:Ht.near,depthFar:Ht.far}),$t=Ht.near,Yt=Ht.far);var Pe=oe.parent,Ie=Ht.cameras;R(Ht,Pe);for(var fr=0;fr<Ie.length;fr++)R(Ie[fr],Pe);for(oe.matrixWorld.copy(Ht.matrixWorld),oe=oe.children,fr=0,Pe=oe.length;fr<Pe;fr++)oe[fr].updateMatrixWorld(!0);if(Ie.length===2){ie.setFromMatrixPosition(mt.matrixWorld),Vt.setFromMatrixPosition(Ft.matrixWorld),Ie=ie.distanceTo(Vt);var Lr=mt.projectionMatrix.elements,Ze=Ft.projectionMatrix.elements,Sr=Lr[14]/(Lr[10]-1);fr=Lr[14]/(Lr[10]+1),oe=(Lr[9]+1)/Lr[5],Pe=(Lr[9]-1)/Lr[5];var $r=(Lr[8]-1)/Lr[0],Ur=(Ze[8]+1)/Ze[0];Ze=Sr*$r,Lr=Sr*Ur,Ur=Ie/(-$r+Ur),$r=Ur*-$r,mt.matrixWorld.decompose(Ht.position,Ht.quaternion,Ht.scale),Ht.translateX($r),Ht.translateZ(Ur),Ht.matrixWorld.compose(Ht.position,Ht.quaternion,Ht.scale),Ht.matrixWorldInverse.getInverse(Ht.matrixWorld),Sr+=Ur,Ur=fr+Ur,Ht.projectionMatrix.makePerspective(Ze-$r,Lr+(Ie-$r),oe*fr/Ur*Sr,Pe*fr/Ur*Sr,Sr,Ur)}else Ht.projectionMatrix.copy(mt.projectionMatrix);return Ht};var ve=null,Le=new Fr;Le.setAnimationLoop(function(oe,Pe){if(rt=Pe.getViewerPose($),rt!==null){var Ie=rt.views,fr=H.renderState.baseLayer;e.setFramebuffer(fr.framebuffer);var Lr=!1;Ie.length!==Ht.cameras.length&&(Ht.cameras.length=0,Lr=!0);for(var Ze=0;Ze<Ie.length;Ze++){var Sr=Ie[Ze],$r=fr.getViewport(Sr),Ur=Wt[Ze];Ur.matrix.fromArray(Sr.transform.matrix),Ur.projectionMatrix.fromArray(Sr.projectionMatrix),Ur.viewport.set($r.x,$r.y,$r.width,$r.height),Ze===0&&Ht.matrix.copy(Ur.matrix),Lr===!0&&Ht.cameras.push(Ur)}}for(Ie=H.inputSources,Ze=0;Ze<et.length;Ze++)et[Ze].update(Ie[Ze],Pe,$);ve&&ve(oe,Pe)}),this.setAnimationLoop=function(oe){ve=oe},this.dispose=function(){}}function S5(e){function n(m,_,T){if(m.opacity.value=_.opacity,_.color&&m.diffuse.value.copy(_.color),_.emissive&&m.emissive.value.copy(_.emissive).multiplyScalar(_.emissiveIntensity),_.map&&(m.map.value=_.map),_.alphaMap&&(m.alphaMap.value=_.alphaMap),_.specularMap&&(m.specularMap.value=_.specularMap),(T=_.envMap||T)&&(m.envMap.value=T,m.flipEnvMap.value=T.isCubeTexture?-1:1,m.reflectivity.value=_.reflectivity,m.refractionRatio.value=_.refractionRatio,m.maxMipLevel.value=e.get(T).__maxMipLevel),_.lightMap&&(m.lightMap.value=_.lightMap,m.lightMapIntensity.value=_.lightMapIntensity),_.aoMap&&(m.aoMap.value=_.aoMap,m.aoMapIntensity.value=_.aoMapIntensity),_.map)var R=_.map;else _.specularMap?R=_.specularMap:_.displacementMap?R=_.displacementMap:_.normalMap?R=_.normalMap:_.bumpMap?R=_.bumpMap:_.roughnessMap?R=_.roughnessMap:_.metalnessMap?R=_.metalnessMap:_.alphaMap?R=_.alphaMap:_.emissiveMap&&(R=_.emissiveMap);if(R!==void 0&&(R.isWebGLRenderTarget&&(R=R.texture),R.matrixAutoUpdate===!0&&R.updateMatrix(),m.uvTransform.value.copy(R.matrix)),_.aoMap)var N=_.aoMap;else _.lightMap&&(N=_.lightMap);N!==void 0&&(N.isWebGLRenderTarget&&(N=N.texture),N.matrixAutoUpdate===!0&&N.updateMatrix(),m.uv2Transform.value.copy(N.matrix))}function u(m,_,T){m.roughness.value=_.roughness,m.metalness.value=_.metalness,_.roughnessMap&&(m.roughnessMap.value=_.roughnessMap),_.metalnessMap&&(m.metalnessMap.value=_.metalnessMap),_.emissiveMap&&(m.emissiveMap.value=_.emissiveMap),_.bumpMap&&(m.bumpMap.value=_.bumpMap,m.bumpScale.value=_.bumpScale,_.side===1&&(m.bumpScale.value*=-1)),_.normalMap&&(m.normalMap.value=_.normalMap,m.normalScale.value.copy(_.normalScale),_.side===1&&m.normalScale.value.negate()),_.displacementMap&&(m.displacementMap.value=_.displacementMap,m.displacementScale.value=_.displacementScale,m.displacementBias.value=_.displacementBias),(_.envMap||T)&&(m.envMapIntensity.value=_.envMapIntensity)}return{refreshFogUniforms:function(m,_){m.fogColor.value.copy(_.color),_.isFog?(m.fogNear.value=_.near,m.fogFar.value=_.far):_.isFogExp2&&(m.fogDensity.value=_.density)},refreshMaterialUniforms:function(m,_,T,R,N){if(_.isMeshBasicMaterial)n(m,_);else if(_.isMeshLambertMaterial)n(m,_),_.emissiveMap&&(m.emissiveMap.value=_.emissiveMap);else if(_.isMeshToonMaterial)n(m,_),m.specular.value.copy(_.specular),m.shininess.value=Math.max(_.shininess,1e-4),_.gradientMap&&(m.gradientMap.value=_.gradientMap),_.emissiveMap&&(m.emissiveMap.value=_.emissiveMap),_.bumpMap&&(m.bumpMap.value=_.bumpMap,m.bumpScale.value=_.bumpScale,_.side===1&&(m.bumpScale.value*=-1)),_.normalMap&&(m.normalMap.value=_.normalMap,m.normalScale.value.copy(_.normalScale),_.side===1&&m.normalScale.value.negate()),_.displacementMap&&(m.displacementMap.value=_.displacementMap,m.displacementScale.value=_.displacementScale,m.displacementBias.value=_.displacementBias);else if(_.isMeshPhongMaterial)n(m,_),m.specular.value.copy(_.specular),m.shininess.value=Math.max(_.shininess,1e-4),_.emissiveMap&&(m.emissiveMap.value=_.emissiveMap),_.bumpMap&&(m.bumpMap.value=_.bumpMap,m.bumpScale.value=_.bumpScale,_.side===1&&(m.bumpScale.value*=-1)),_.normalMap&&(m.normalMap.value=_.normalMap,m.normalScale.value.copy(_.normalScale),_.side===1&&m.normalScale.value.negate()),_.displacementMap&&(m.displacementMap.value=_.displacementMap,m.displacementScale.value=_.displacementScale,m.displacementBias.value=_.displacementBias);else if(_.isMeshStandardMaterial)n(m,_,T),_.isMeshPhysicalMaterial?(u(m,_,T),m.reflectivity.value=_.reflectivity,m.clearcoat.value=_.clearcoat,m.clearcoatRoughness.value=_.clearcoatRoughness,_.sheen&&m.sheen.value.copy(_.sheen),_.clearcoatMap&&(m.clearcoatMap.value=_.clearcoatMap),_.clearcoatRoughnessMap&&(m.clearcoatRoughnessMap.value=_.clearcoatRoughnessMap),_.clearcoatNormalMap&&(m.clearcoatNormalScale.value.copy(_.clearcoatNormalScale),m.clearcoatNormalMap.value=_.clearcoatNormalMap,_.side===1&&m.clearcoatNormalScale.value.negate()),m.transparency.value=_.transparency):u(m,_,T);else if(_.isMeshMatcapMaterial)n(m,_),_.matcap&&(m.matcap.value=_.matcap),_.bumpMap&&(m.bumpMap.value=_.bumpMap,m.bumpScale.value=_.bumpScale,_.side===1&&(m.bumpScale.value*=-1)),_.normalMap&&(m.normalMap.value=_.normalMap,m.normalScale.value.copy(_.normalScale),_.side===1&&m.normalScale.value.negate()),_.displacementMap&&(m.displacementMap.value=_.displacementMap,m.displacementScale.value=_.displacementScale,m.displacementBias.value=_.displacementBias);else if(_.isMeshDepthMaterial)n(m,_),_.displacementMap&&(m.displacementMap.value=_.displacementMap,m.displacementScale.value=_.displacementScale,m.displacementBias.value=_.displacementBias);else if(_.isMeshDistanceMaterial)n(m,_),_.displacementMap&&(m.displacementMap.value=_.displacementMap,m.displacementScale.value=_.displacementScale,m.displacementBias.value=_.displacementBias),m.referencePosition.value.copy(_.referencePosition),m.nearDistance.value=_.nearDistance,m.farDistance.value=_.farDistance;else if(_.isMeshNormalMaterial)n(m,_),_.bumpMap&&(m.bumpMap.value=_.bumpMap,m.bumpScale.value=_.bumpScale,_.side===1&&(m.bumpScale.value*=-1)),_.normalMap&&(m.normalMap.value=_.normalMap,m.normalScale.value.copy(_.normalScale),_.side===1&&m.normalScale.value.negate()),_.displacementMap&&(m.displacementMap.value=_.displacementMap,m.displacementScale.value=_.displacementScale,m.displacementBias.value=_.displacementBias);else if(_.isLineBasicMaterial)m.diffuse.value.copy(_.color),m.opacity.value=_.opacity,_.isLineDashedMaterial&&(m.dashSize.value=_.dashSize,m.totalSize.value=_.dashSize+_.gapSize,m.scale.value=_.scale);else if(_.isPointsMaterial){if(m.diffuse.value.copy(_.color),m.opacity.value=_.opacity,m.size.value=_.size*R,m.scale.value=.5*N,_.map&&(m.map.value=_.map),_.alphaMap&&(m.alphaMap.value=_.alphaMap),_.map)var H=_.map;else _.alphaMap&&(H=_.alphaMap);H!==void 0&&(H.matrixAutoUpdate===!0&&H.updateMatrix(),m.uvTransform.value.copy(H.matrix))}else if(_.isSpriteMaterial){if(m.diffuse.value.copy(_.color),m.opacity.value=_.opacity,m.rotation.value=_.rotation,_.map&&(m.map.value=_.map),_.alphaMap&&(m.alphaMap.value=_.alphaMap),_.map)var W=_.map;else _.alphaMap&&(W=_.alphaMap);W!==void 0&&(W.matrixAutoUpdate===!0&&W.updateMatrix(),m.uvTransform.value.copy(W.matrix))}else _.isShadowMaterial?(m.color.value.copy(_.color),m.opacity.value=_.opacity):_.isShaderMaterial&&(_.uniformsNeedUpdate=!1)}}}function V_(e){var n;function u(){Hr=new tl(Ee),oi=new rh(Ee,Hr,e),oi.isWebGL2===!1&&(Hr.get("WEBGL_depth_texture"),Hr.get("OES_texture_float"),Hr.get("OES_texture_half_float"),Hr.get("OES_texture_half_float_linear"),Hr.get("OES_standard_derivatives"),Hr.get("OES_element_index_uint"),Hr.get("ANGLE_instanced_arrays")),Hr.get("OES_texture_float_linear"),yh=new b3(Ee,Hr,oi),Dr=new C5(Ee,Hr,oi),Dr.scissor(St.copy(lr).multiplyScalar(ir).floor()),Dr.viewport(Yi.copy(ze).multiplyScalar(ir).floor()),Vo=new au,Qn=new m5,xu=new T5(Ee,Hr,Dr,Qn,oi,yh,Vo),Wm=new be(Ee,oi),eM=new el(Ee,Wm,Vo),jm=new nx(Ee,eM,Wm,Vo),oS=new ix(Ee),Xm=new d5(oe,Hr,oi),rM=new S5(Qn),w2=new y5,Ym=new M5,bc=new Co(oe,Dr,jm,$t),sS=new _a(Ee,Hr,Vo,oi),aS=new ns(Ee,Hr,Vo,oi),Vo.programs=Xm.programs,oe.capabilities=oi,oe.extensions=Hr,oe.properties=Qn,oe.renderLists=w2,oe.state=Dr,oe.info=Vo}function m(Et){Et.preventDefault(),Pe=!0}function _(){Pe=!1,u()}function T(Et){Et=Et.target,Et.removeEventListener("dispose",T),R(Et),Qn.remove(Et)}function R(Et){var _e=Qn.get(Et).program;Et.program=void 0,_e!==void 0&&Xm.releaseProgram(_e)}function N(Et,_e){Et.render(function(qt){oe.renderBufferImmediate(qt,_e)})}function H(Et,_e,qt,Se){if(Et.visible!==!1){if(Et.layers.test(_e.layers)){if(Et.isGroup)qt=Et.renderOrder;else if(Et.isLOD)Et.autoUpdate===!0&&Et.update(_e);else if(Et.isLight)Le.pushLight(Et),Et.castShadow&&Le.pushShadow(Et);else if(Et.isSprite){if(!Et.frustumCulled||pr.intersectsSprite(Et)){Se&&Xr.setFromMatrixPosition(Et.matrixWorld).applyMatrix4(hn);var je=jm.update(Et),si=Et.material;si.visible&&ve.push(Et,je,si,qt,Xr.z,null)}}else if(Et.isImmediateRenderObject)Se&&Xr.setFromMatrixPosition(Et.matrixWorld).applyMatrix4(hn),ve.push(Et,null,Et.material,qt,Xr.z,null);else if((Et.isMesh||Et.isLine||Et.isPoints)&&(Et.isSkinnedMesh&&Et.skeleton.frame!==Vo.render.frame&&(Et.skeleton.update(),Et.skeleton.frame=Vo.render.frame),!Et.frustumCulled||pr.intersectsObject(Et)))if(Se&&Xr.setFromMatrixPosition(Et.matrixWorld).applyMatrix4(hn),je=jm.update(Et),si=Et.material,Array.isArray(si))for(var ar=je.groups,zr=0,ri=ar.length;zr<ri;zr++){var Ei=ar[zr],vi=si[Ei.materialIndex];vi&&vi.visible&&ve.push(Et,je,vi,qt,Xr.z,Ei)}else si.visible&&ve.push(Et,je,si,qt,Xr.z,null)}for(Et=Et.children,zr=0,ri=Et.length;zr<ri;zr++)H(Et[zr],_e,qt,Se)}}function W(Et,_e,qt,Se){for(var je=0,si=Et.length;je<si;je++){var ar=Et[je],zr=ar.object,ri=ar.geometry,Ei=Se===void 0?ar.material:Se;if(ar=ar.group,qt.isArrayCamera){Di=qt;for(var vi=qt.cameras,fl=0,cn=vi.length;fl<cn;fl++){var Kn=vi[fl];zr.layers.test(Kn.layers)&&(Dr.viewport(Yi.copy(Kn.viewport)),Le.setupLights(Kn),$(zr,_e,Kn,ri,Ei,ar))}}else Di=null,$(zr,_e,qt,ri,Ei,ar)}}function $(Et,_e,qt,Se,je,si){if(Et.onBeforeRender(oe,_e,qt,Se,je,si),Le=Ym.get(_e,Di||qt),Et.modelViewMatrix.multiplyMatrices(qt.matrixWorldInverse,Et.matrixWorld),Et.normalMatrix.getNormalMatrix(Et.modelViewMatrix),Et.isImmediateRenderObject){var ar=rt(qt,_e,je,Et);Dr.setMaterial(je),Ur=n=null,fi=!1,N(Et,ar)}else oe.renderBufferDirect(qt,_e,Se,je,Et,si);Et.onAfterRender(oe,_e,qt,Se,je,si),Le=Ym.get(_e,Di||qt)}function K(Et,_e,qt){var Se=Qn.get(Et),je=Le.state.lights,si=je.state.version;qt=Xm.getParameters(Et,je.state,Le.state.shadowsArray,_e,$e.numPlanes,$e.numIntersection,qt);var ar=Xm.getProgramCacheKey(qt),zr=Se.program,ri=!0;if(zr===void 0)Et.addEventListener("dispose",T);else if(zr.cacheKey!==ar)R(Et);else{if(Se.lightsStateVersion!==si)Se.lightsStateVersion=si;else if(qt.shaderID!==void 0)return;ri=!1}if(ri&&(zr=Xm.acquireProgram(qt,ar),Se.program=zr,Se.uniforms=qt.uniforms,Se.outputEncoding=qt.outputEncoding,Et.program=zr),qt=zr.getAttributes(),Et.morphTargets)for(ar=Et.numSupportedMorphTargets=0;ar<oe.maxMorphTargets;ar++)0<=qt["morphTarget"+ar]&&Et.numSupportedMorphTargets++;if(Et.morphNormals)for(ar=Et.numSupportedMorphNormals=0;ar<oe.maxMorphNormals;ar++)0<=qt["morphNormal"+ar]&&Et.numSupportedMorphNormals++;qt=Se.uniforms,(!Et.isShaderMaterial&&!Et.isRawShaderMaterial||Et.clipping===!0)&&(Se.numClippingPlanes=$e.numPlanes,Se.numIntersection=$e.numIntersection,qt.clippingPlanes=$e.uniform),Se.environment=Et.isMeshStandardMaterial?_e.environment:null,Se.fog=_e.fog,Se.needsLights=Et.isMeshLambertMaterial||Et.isMeshToonMaterial||Et.isMeshPhongMaterial||Et.isMeshStandardMaterial||Et.isShadowMaterial||Et.isShaderMaterial&&Et.lights===!0,Se.lightsStateVersion=si,Se.needsLights&&(qt.ambientLightColor.value=je.state.ambient,qt.lightProbe.value=je.state.probe,qt.directionalLights.value=je.state.directional,qt.directionalLightShadows.value=je.state.directionalShadow,qt.spotLights.value=je.state.spot,qt.spotLightShadows.value=je.state.spotShadow,qt.rectAreaLights.value=je.state.rectArea,qt.pointLights.value=je.state.point,qt.pointLightShadows.value=je.state.pointShadow,qt.hemisphereLights.value=je.state.hemi,qt.directionalShadowMap.value=je.state.directionalShadowMap,qt.directionalShadowMatrix.value=je.state.directionalShadowMatrix,qt.spotShadowMap.value=je.state.spotShadowMap,qt.spotShadowMatrix.value=je.state.spotShadowMatrix,qt.pointShadowMap.value=je.state.pointShadowMap,qt.pointShadowMatrix.value=je.state.pointShadowMatrix),Et=Se.program.getUniforms(),Et=Mc.seqWithValue(Et.seq,qt),Se.uniformsList=Et}function rt(Et,_e,qt,Se){xu.resetTextureUnits();var je=_e.fog,si=qt.isMeshStandardMaterial?_e.environment:null,ar=Ze===null?oe.outputEncoding:Ze.texture.encoding,zr=Qn.get(qt),ri=Le.state.lights;tr&&(kr||Et!==ei)&&$e.setState(qt.clippingPlanes,qt.clipIntersection,qt.clipShadows,Et,zr,Et===ei&&qt.id===$r),qt.version===zr.__version?zr.program===void 0||qt.fog&&zr.fog!==je||zr.environment!==si||zr.needsLights&&zr.lightsStateVersion!==ri.state.version?K(qt,_e,Se):zr.numClippingPlanes===void 0||zr.numClippingPlanes===$e.numPlanes&&zr.numIntersection===$e.numIntersection?zr.outputEncoding!==ar&&K(qt,_e,Se):K(qt,_e,Se):(K(qt,_e,Se),zr.__version=qt.version);var Ei=!1,vi=!1,fl=!1;if(_e=zr.program,ar=_e.getUniforms(),ri=zr.uniforms,Dr.useProgram(_e.program)&&(fl=vi=Ei=!0),qt.id!==$r&&($r=qt.id,vi=!0),(Ei||ei!==Et)&&(ar.setValue(Ee,"projectionMatrix",Et.projectionMatrix),oi.logarithmicDepthBuffer&&ar.setValue(Ee,"logDepthBufFC",2/(Math.log(Et.far+1)/Math.LN2)),ei!==Et&&(ei=Et,fl=vi=!0),(qt.isShaderMaterial||qt.isMeshPhongMaterial||qt.isMeshToonMaterial||qt.isMeshStandardMaterial||qt.envMap)&&(Ei=ar.map.cameraPosition,Ei!==void 0&&Ei.setValue(Ee,Xr.setFromMatrixPosition(Et.matrixWorld))),(qt.isMeshPhongMaterial||qt.isMeshToonMaterial||qt.isMeshLambertMaterial||qt.isMeshBasicMaterial||qt.isMeshStandardMaterial||qt.isShaderMaterial)&&ar.setValue(Ee,"isOrthographic",Et.isOrthographicCamera===!0),(qt.isMeshPhongMaterial||qt.isMeshToonMaterial||qt.isMeshLambertMaterial||qt.isMeshBasicMaterial||qt.isMeshStandardMaterial||qt.isShaderMaterial||qt.skinning)&&ar.setValue(Ee,"viewMatrix",Et.matrixWorldInverse)),qt.skinning&&(ar.setOptional(Ee,Se,"bindMatrix"),ar.setOptional(Ee,Se,"bindMatrixInverse"),Et=Se.skeleton))if(Ei=Et.bones,oi.floatVertexTextures){if(Et.boneTexture===void 0){Ei=Math.sqrt(4*Ei.length),Ei=ni.ceilPowerOfTwo(Ei),Ei=Math.max(Ei,4);var cn=new Float32Array(Ei*Ei*4);cn.set(Et.boneMatrices);var Kn=new me(cn,Ei,Ei,1023,1015);Et.boneMatrices=cn,Et.boneTexture=Kn,Et.boneTextureSize=Ei}ar.setValue(Ee,"boneTexture",Et.boneTexture,xu),ar.setValue(Ee,"boneTextureSize",Et.boneTextureSize)}else ar.setOptional(Ee,Et,"boneMatrices");return(vi||zr.receiveShadow!==Se.receiveShadow)&&(zr.receiveShadow=Se.receiveShadow,ar.setValue(Ee,"receiveShadow",Se.receiveShadow)),vi&&(ar.setValue(Ee,"toneMappingExposure",oe.toneMappingExposure),ar.setValue(Ee,"toneMappingWhitePoint",oe.toneMappingWhitePoint),zr.needsLights&&(vi=fl,ri.ambientLightColor.needsUpdate=vi,ri.lightProbe.needsUpdate=vi,ri.directionalLights.needsUpdate=vi,ri.directionalLightShadows.needsUpdate=vi,ri.pointLights.needsUpdate=vi,ri.pointLightShadows.needsUpdate=vi,ri.spotLights.needsUpdate=vi,ri.spotLightShadows.needsUpdate=vi,ri.rectAreaLights.needsUpdate=vi,ri.hemisphereLights.needsUpdate=vi),je&&qt.fog&&rM.refreshFogUniforms(ri,je),rM.refreshMaterialUniforms(ri,qt,si,ir,Fe),ri.ltc_1!==void 0&&(ri.ltc_1.value=or.LTC_1),ri.ltc_2!==void 0&&(ri.ltc_2.value=or.LTC_2),Mc.upload(Ee,zr.uniformsList,ri,xu)),qt.isShaderMaterial&&qt.uniformsNeedUpdate===!0&&(Mc.upload(Ee,zr.uniformsList,ri,xu),qt.uniformsNeedUpdate=!1),qt.isSpriteMaterial&&ar.setValue(Ee,"center",Se.center),ar.setValue(Ee,"modelViewMatrix",Se.modelViewMatrix),ar.setValue(Ee,"normalMatrix",Se.normalMatrix),ar.setValue(Ee,"modelMatrix",Se.matrixWorld),_e}e=e||{};var et=e.canvas!==void 0?e.canvas:document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),at=e.context!==void 0?e.context:null,mt=e.alpha!==void 0?e.alpha:!1,Ft=e.depth!==void 0?e.depth:!0,Wt=e.stencil!==void 0?e.stencil:!0,Ht=e.antialias!==void 0?e.antialias:!1,$t=e.premultipliedAlpha!==void 0?e.premultipliedAlpha:!0,Yt=e.preserveDrawingBuffer!==void 0?e.preserveDrawingBuffer:!1,ie=e.powerPreference!==void 0?e.powerPreference:"default",Vt=e.failIfMajorPerformanceCaveat!==void 0?e.failIfMajorPerformanceCaveat:!1,ve=null,Le=null;this.domElement=et,this.debug={checkShaderErrors:!0},this.sortObjects=this.autoClearStencil=this.autoClearDepth=this.autoClearColor=this.autoClear=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.outputEncoding=3e3,this.physicallyCorrectLights=!1,this.toneMapping=0,this.toneMappingWhitePoint=this.toneMappingExposure=1,this.maxMorphTargets=8,this.maxMorphNormals=4;var oe=this,Pe=!1,Ie=null,fr=0,Lr=0,Ze=null,Sr=null,$r=-1,Ur=n=null,fi=!1,ei=null,Di=null,Yi=new p,St=new p,Bt=null,ce=et.width,Fe=et.height,ir=1,Ce=null,Nt=null,ze=new p(0,0,ce,Fe),lr=new p(0,0,ce,Fe),Pr=!1,pr=new Qe,$e=new ws,tr=!1,kr=!1,hn=new I,Xr=new w;try{mt={alpha:mt,depth:Ft,stencil:Wt,antialias:Ht,premultipliedAlpha:$t,preserveDrawingBuffer:Yt,powerPreference:ie,failIfMajorPerformanceCaveat:Vt},et.addEventListener("webglcontextlost",m,!1),et.addEventListener("webglcontextrestored",_,!1);var Ee=at||et.getContext("webgl",mt)||et.getContext("experimental-webgl",mt);if(Ee===null)throw et.getContext("webgl")!==null?Error("Error creating WebGL context with your selected attributes."):Error("Error creating WebGL context.");Ee.getShaderPrecisionFormat===void 0&&(Ee.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(Et){throw console.error("THREE.WebGLRenderer: "+Et.message),Et}var Hr,oi,Dr,Vo,Qn,xu,Wm,eM,jm,Xm,rM,w2,Ym,bc,oS,sS,aS,yh;u();var kc=new k3(oe,Ee);this.xr=kc;var uS=new U3(oe,jm,oi.maxTextureSize);this.shadowMap=uS,this.getContext=function(){return Ee},this.getContextAttributes=function(){return Ee.getContextAttributes()},this.forceContextLoss=function(){var Et=Hr.get("WEBGL_lose_context");Et&&Et.loseContext()},this.forceContextRestore=function(){var Et=Hr.get("WEBGL_lose_context");Et&&Et.restoreContext()},this.getPixelRatio=function(){return ir},this.setPixelRatio=function(Et){Et!==void 0&&(ir=Et,this.setSize(ce,Fe,!1))},this.getSize=function(Et){return Et===void 0&&(console.warn("WebGLRenderer: .getsize() now requires a Vector2 as an argument"),Et=new f),Et.set(ce,Fe)},this.setSize=function(Et,_e,qt){kc.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(ce=Et,Fe=_e,et.width=Math.floor(Et*ir),et.height=Math.floor(_e*ir),qt!==!1&&(et.style.width=Et+"px",et.style.height=_e+"px"),this.setViewport(0,0,Et,_e))},this.getDrawingBufferSize=function(Et){return Et===void 0&&(console.warn("WebGLRenderer: .getdrawingBufferSize() now requires a Vector2 as an argument"),Et=new f),Et.set(ce*ir,Fe*ir).floor()},this.setDrawingBufferSize=function(Et,_e,qt){ce=Et,Fe=_e,ir=qt,et.width=Math.floor(Et*qt),et.height=Math.floor(_e*qt),this.setViewport(0,0,Et,_e)},this.getCurrentViewport=function(Et){return Et===void 0&&(console.warn("WebGLRenderer: .getCurrentViewport() now requires a Vector4 as an argument"),Et=new p),Et.copy(Yi)},this.getViewport=function(Et){return Et.copy(ze)},this.setViewport=function(Et,_e,qt,Se){Et.isVector4?ze.set(Et.x,Et.y,Et.z,Et.w):ze.set(Et,_e,qt,Se),Dr.viewport(Yi.copy(ze).multiplyScalar(ir).floor())},this.getScissor=function(Et){return Et.copy(lr)},this.setScissor=function(Et,_e,qt,Se){Et.isVector4?lr.set(Et.x,Et.y,Et.z,Et.w):lr.set(Et,_e,qt,Se),Dr.scissor(St.copy(lr).multiplyScalar(ir).floor())},this.getScissorTest=function(){return Pr},this.setScissorTest=function(Et){Dr.setScissorTest(Pr=Et)},this.setOpaqueSort=function(Et){Ce=Et},this.setTransparentSort=function(Et){Nt=Et},this.getClearColor=function(){return bc.getClearColor()},this.setClearColor=function(){bc.setClearColor.apply(bc,arguments)},this.getClearAlpha=function(){return bc.getClearAlpha()},this.setClearAlpha=function(){bc.setClearAlpha.apply(bc,arguments)},this.clear=function(Et,_e,qt){var Se=0;(Et===void 0||Et)&&(Se|=16384),(_e===void 0||_e)&&(Se|=256),(qt===void 0||qt)&&(Se|=1024),Ee.clear(Se)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){et.removeEventListener("webglcontextlost",m,!1),et.removeEventListener("webglcontextrestored",_,!1),w2.dispose(),Ym.dispose(),Qn.dispose(),jm.dispose(),kc.dispose(),M2.stop()},this.renderBufferImmediate=function(Et,_e){Dr.initAttributes();var qt=Qn.get(Et);Et.hasPositions&&!qt.position&&(qt.position=Ee.createBuffer()),Et.hasNormals&&!qt.normal&&(qt.normal=Ee.createBuffer()),Et.hasUvs&&!qt.uv&&(qt.uv=Ee.createBuffer()),Et.hasColors&&!qt.color&&(qt.color=Ee.createBuffer()),_e=_e.getAttributes(),Et.hasPositions&&(Ee.bindBuffer(34962,qt.position),Ee.bufferData(34962,Et.positionArray,35048),Dr.enableAttribute(_e.position),Ee.vertexAttribPointer(_e.position,3,5126,!1,0,0)),Et.hasNormals&&(Ee.bindBuffer(34962,qt.normal),Ee.bufferData(34962,Et.normalArray,35048),Dr.enableAttribute(_e.normal),Ee.vertexAttribPointer(_e.normal,3,5126,!1,0,0)),Et.hasUvs&&(Ee.bindBuffer(34962,qt.uv),Ee.bufferData(34962,Et.uvArray,35048),Dr.enableAttribute(_e.uv),Ee.vertexAttribPointer(_e.uv,2,5126,!1,0,0)),Et.hasColors&&(Ee.bindBuffer(34962,qt.color),Ee.bufferData(34962,Et.colorArray,35048),Dr.enableAttribute(_e.color),Ee.vertexAttribPointer(_e.color,3,5126,!1,0,0)),Dr.disableUnusedAttributes(),Ee.drawArrays(4,0,Et.count),Et.count=0};var pL=new X;this.renderBufferDirect=function(Et,_e,qt,Se,je,si){_e===null&&(_e=pL);var ar=je.isMesh&&0>je.matrixWorld.determinant(),zr=rt(Et,_e,Se,je);Dr.setMaterial(Se,ar);var ri=!1;if((n!==qt.id||Ur!==zr.id||fi!==(Se.wireframe===!0))&&(n=qt.id,Ur=zr.id,fi=Se.wireframe===!0,ri=!0),(Se.morphTargets||Se.morphNormals)&&(oS.update(je,qt,Se,zr),ri=!0),je.isInstancedMesh===!0&&(ri=!0),Et=qt.index,_e=qt.attributes.position,Et===null){if(_e===void 0||_e.count===0)return}else if(Et.count===0)return;var Ei=1;if(Se.wireframe===!0&&(Et=eM.getWireframeAttribute(qt),Ei=2),ar=sS,Et!==null){var vi=Wm.get(Et);ar=aS,ar.setIndex(vi)}if(ri){if(oi.isWebGL2!==!1||!je.isInstancedMesh&&!qt.isInstancedBufferGeometry||Hr.get("ANGLE_instanced_arrays")!==null){Dr.initAttributes(),ri=qt.attributes,zr=zr.getAttributes();var fl=Se.defaultAttributeValues;for(Vp in zr){var cn=zr[Vp];if(0<=cn){var Kn=ri[Vp];if(Kn!==void 0){var xh=Kn.normalized,lS=Kn.itemSize,Au=Wm.get(Kn);if(Au!==void 0){var C2=Au.buffer,Gp=Au.type;if(Au=Au.bytesPerElement,Kn.isInterleavedBufferAttribute){var Zm=Kn.data,dL=Zm.stride;Kn=Kn.offset,Zm&&Zm.isInstancedInterleavedBuffer?(Dr.enableAttributeAndDivisor(cn,Zm.meshPerAttribute),qt._maxInstanceCount===void 0&&(qt._maxInstanceCount=Zm.meshPerAttribute*Zm.count)):Dr.enableAttribute(cn),Ee.bindBuffer(34962,C2),Dr.vertexAttribPointer(cn,lS,Gp,xh,dL*Au,Kn*Au)}else Kn.isInstancedBufferAttribute?(Dr.enableAttributeAndDivisor(cn,Kn.meshPerAttribute),qt._maxInstanceCount===void 0&&(qt._maxInstanceCount=Kn.meshPerAttribute*Kn.count)):Dr.enableAttribute(cn),Ee.bindBuffer(34962,C2),Dr.vertexAttribPointer(cn,lS,Gp,xh,0,0)}}else if(Vp==="instanceMatrix")Au=Wm.get(je.instanceMatrix),Au!==void 0&&(C2=Au.buffer,Gp=Au.type,Dr.enableAttributeAndDivisor(cn+0,1),Dr.enableAttributeAndDivisor(cn+1,1),Dr.enableAttributeAndDivisor(cn+2,1),Dr.enableAttributeAndDivisor(cn+3,1),Ee.bindBuffer(34962,C2),Ee.vertexAttribPointer(cn+0,4,Gp,!1,64,0),Ee.vertexAttribPointer(cn+1,4,Gp,!1,64,16),Ee.vertexAttribPointer(cn+2,4,Gp,!1,64,32),Ee.vertexAttribPointer(cn+3,4,Gp,!1,64,48));else if(fl!==void 0&&(xh=fl[Vp],xh!==void 0))switch(xh.length){case 2:Ee.vertexAttrib2fv(cn,xh);break;case 3:Ee.vertexAttrib3fv(cn,xh);break;case 4:Ee.vertexAttrib4fv(cn,xh);break;default:Ee.vertexAttrib1fv(cn,xh)}}}Dr.disableUnusedAttributes()}Et!==null&&Ee.bindBuffer(34963,vi.buffer)}var Vp=qt.drawRange.start*Ei;ri=si!==null?si.start*Ei:0,vi=Math.max(Vp,ri),si=Math.max(0,Math.min(Et!==null?Et.count:_e.count,Vp+qt.drawRange.count*Ei,ri+(si!==null?si.count*Ei:1/0))-1-vi+1),si!==0&&(je.isMesh?Se.wireframe===!0?(Dr.setLineWidth(Se.wireframeLinewidth*(Ze===null?ir:1)),ar.setMode(1)):ar.setMode(4):je.isLine?(Se=Se.linewidth,Se===void 0&&(Se=1),Dr.setLineWidth(Se*(Ze===null?ir:1)),je.isLineSegments?ar.setMode(1):je.isLineLoop?ar.setMode(2):ar.setMode(3)):je.isPoints?ar.setMode(0):je.isSprite&&ar.setMode(4),je.isInstancedMesh?ar.renderInstances(qt,vi,si,je.count):qt.isInstancedBufferGeometry?ar.renderInstances(qt,vi,si,Math.min(qt.instanceCount,qt._maxInstanceCount)):ar.render(vi,si))},this.compile=function(Et,_e){Le=Ym.get(Et,_e),Le.init(),Et.traverse(function(Se){Se.isLight&&(Le.pushLight(Se),Se.castShadow&&Le.pushShadow(Se))}),Le.setupLights(_e);var qt={};Et.traverse(function(Se){var je=Se.material;if(je)if(Array.isArray(je))for(var si=0;si<je.length;si++){var ar=je[si];!(ar.uuid in qt)&&(K(ar,Et,Se),qt[ar.uuid]=!0)}else!(je.uuid in qt)&&(K(je,Et,Se),qt[je.uuid]=!0)})};var iM=null,M2=new Fr;M2.setAnimationLoop(function(Et){kc.isPresenting||iM&&iM(Et)}),typeof window!="undefined"&&M2.setContext(window),this.setAnimationLoop=function(Et){iM=Et,kc.setAnimationLoop(Et),M2.start()},this.render=function(Et,_e,qt,Se){if(qt!==void 0){console.warn("THREE.WebGLRenderer.render(): the renderTarget argument has been removed. Use .setRenderTarget() instead.");var je=qt}if(Se!==void 0){console.warn("THREE.WebGLRenderer.render(): the forceClear argument has been removed. Use .clear() instead.");var si=Se}_e&&_e.isCamera?Pe||(Ur=n=null,fi=!1,$r=-1,ei=null,Et.autoUpdate===!0&&Et.updateMatrixWorld(),_e.parent===null&&_e.updateMatrixWorld(),kc.enabled&&kc.isPresenting&&(_e=kc.getCamera(_e)),Et.onBeforeRender(oe,Et,_e,je||Ze),Le=Ym.get(Et,_e),Le.init(),hn.multiplyMatrices(_e.projectionMatrix,_e.matrixWorldInverse),pr.setFromProjectionMatrix(hn),kr=this.localClippingEnabled,tr=$e.init(this.clippingPlanes,kr,_e),ve=w2.get(Et,_e),ve.init(),H(Et,_e,0,oe.sortObjects),ve.finish(),oe.sortObjects===!0&&ve.sort(Ce,Nt),tr&&$e.beginShadows(),uS.render(Le.state.shadowsArray,Et,_e),Le.setupLights(_e),tr&&$e.endShadows(),this.info.autoReset&&this.info.reset(),je!==void 0&&this.setRenderTarget(je),bc.render(ve,Et,_e,si),qt=ve.opaque,Se=ve.transparent,Et.overrideMaterial?(je=Et.overrideMaterial,qt.length&&W(qt,Et,_e,je),Se.length&&W(Se,Et,_e,je)):(qt.length&&W(qt,Et,_e),Se.length&&W(Se,Et,_e)),Et.onAfterRender(oe,Et,_e),Ze!==null&&(xu.updateRenderTargetMipmap(Ze),xu.updateMultisampleRenderTarget(Ze)),Dr.buffers.depth.setTest(!0),Dr.buffers.depth.setMask(!0),Dr.buffers.color.setMask(!0),Dr.setPolygonOffset(!1),Le=ve=null):console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.setFramebuffer=function(Et){Ie!==Et&&Ze===null&&Ee.bindFramebuffer(36160,Et),Ie=Et},this.getActiveCubeFace=function(){return fr},this.getActiveMipmapLevel=function(){return Lr},this.getRenderTarget=function(){return Ze},this.setRenderTarget=function(Et,_e,qt){Ze=Et,fr=_e,Lr=qt,Et&&Qn.get(Et).__webglFramebuffer===void 0&&xu.setupRenderTarget(Et);var Se=Ie,je=!1;Et?(Se=Qn.get(Et).__webglFramebuffer,Et.isWebGLCubeRenderTarget?(Se=Se[_e||0],je=!0):Se=Et.isWebGLMultisampleRenderTarget?Qn.get(Et).__webglMultisampledFramebuffer:Se,Yi.copy(Et.viewport),St.copy(Et.scissor),Bt=Et.scissorTest):(Yi.copy(ze).multiplyScalar(ir).floor(),St.copy(lr).multiplyScalar(ir).floor(),Bt=Pr),Sr!==Se&&(Ee.bindFramebuffer(36160,Se),Sr=Se),Dr.viewport(Yi),Dr.scissor(St),Dr.setScissorTest(Bt),je&&(Et=Qn.get(Et.texture),Ee.framebufferTexture2D(36160,36064,34069+(_e||0),Et.__webglTexture,qt||0))},this.readRenderTargetPixels=function(Et,_e,qt,Se,je,si,ar){if(Et&&Et.isWebGLRenderTarget){var zr=Qn.get(Et).__webglFramebuffer;if(Et.isWebGLCubeRenderTarget&&ar!==void 0&&(zr=zr[ar]),zr){ar=!1,zr!==Sr&&(Ee.bindFramebuffer(36160,zr),ar=!0);try{var ri=Et.texture,Ei=ri.format,vi=ri.type;Ei!==1023&&yh.convert(Ei)!==Ee.getParameter(35739)?console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format."):vi===1009||yh.convert(vi)===Ee.getParameter(35738)||vi===1015&&(oi.isWebGL2||Hr.get("OES_texture_float")||Hr.get("WEBGL_color_buffer_float"))||vi===1016&&(oi.isWebGL2?Hr.get("EXT_color_buffer_float"):Hr.get("EXT_color_buffer_half_float"))?Ee.checkFramebufferStatus(36160)===36053?0<=_e&&_e<=Et.width-Se&&0<=qt&&qt<=Et.height-je&&Ee.readPixels(_e,qt,Se,je,yh.convert(Ei),yh.convert(vi),si):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete."):console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.")}finally{ar&&Ee.bindFramebuffer(36160,Sr)}}}else console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.")},this.copyFramebufferToTexture=function(Et,_e,qt){qt===void 0&&(qt=0);var Se=Math.pow(2,-qt),je=Math.floor(_e.image.width*Se);Se=Math.floor(_e.image.height*Se);var si=yh.convert(_e.format);xu.setTexture2D(_e,0),Ee.copyTexImage2D(3553,qt,si,Et.x,Et.y,je,Se,0),Dr.unbindTexture()},this.copyTextureToTexture=function(Et,_e,qt,Se){Se===void 0&&(Se=0);var je=_e.image.width,si=_e.image.height,ar=yh.convert(qt.format),zr=yh.convert(qt.type);xu.setTexture2D(qt,0),_e.isDataTexture?Ee.texSubImage2D(3553,Se,Et.x,Et.y,je,si,ar,zr,_e.image.data):_e.isCompressedTexture?Ee.compressedTexSubImage2D(3553,Se,Et.x,Et.y,_e.mipmaps[0].width,_e.mipmaps[0].height,ar,_e.mipmaps[0].data):Ee.texSubImage2D(3553,Se,Et.x,Et.y,ar,zr,_e.image),Se===0&&qt.generateMipmaps&&Ee.generateMipmap(3553),Dr.unbindTexture()},this.initTexture=function(Et){xu.setTexture2D(Et,0),Dr.unbindTexture()},typeof __THREE_DEVTOOLS__!="undefined"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}function ux(e,n){this.name="",this.color=new wt(e),this.density=n!==void 0?n:25e-5}function lx(e,n,u){this.name="",this.color=new wt(e),this.near=n!==void 0?n:1,this.far=u!==void 0?u:1e3}function sh(e,n){this.array=e,this.stride=n,this.count=e!==void 0?e.length/n:0,this.usage=35044,this.updateRange={offset:0,count:-1},this.version=0}function Hv(e,n,u,m){this.name="",this.data=e,this.itemSize=n,this.offset=u,this.normalized=m===!0}function Sc(e){Qt.call(this),this.type="SpriteMaterial",this.color=new wt(16777215),this.alphaMap=this.map=null,this.rotation=0,this.transparent=this.sizeAttenuation=!0,this.setValues(e)}function Gv(e){if(F.call(this),this.type="Sprite",bm===void 0){bm=new vt;var n=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]);n=new sh(n,5),bm.setIndex([0,1,2,0,2,3]),bm.setAttribute("position",new Hv(n,3,0,!1)),bm.setAttribute("uv",new Hv(n,2,3,!1))}this.geometry=bm,this.material=e!==void 0?e:new Sc,this.center=new f(.5,.5)}function hx(e,n,u,m,_,T){Gm.subVectors(e,u).addScalar(.5).multiply(m),_!==void 0?(L0.x=T*Gm.x-_*Gm.y,L0.y=_*Gm.x+T*Gm.y):L0.copy(Gm),e.copy(n),e.x+=L0.x,e.y+=L0.y,e.applyMatrix4(LT)}function Vv(){F.call(this),this._currentLevel=0,this.type="LOD",Or(this,{levels:{enumerable:!0,value:[]}}),this.autoUpdate=!0}function cx(e,n){e&&e.isGeometry&&console.error("THREE.SkinnedMesh no longer supports THREE.Geometry. Use THREE.BufferGeometry instead."),Pt.call(this,e,n),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new I,this.bindMatrixInverse=new I}function fx(e,n){if(e=e||[],this.bones=e.slice(0),this.boneMatrices=new Float32Array(16*this.bones.length),this.frame=-1,n===void 0)this.calculateInverses();else if(this.bones.length===n.length)this.boneInverses=n.slice(0);else for(console.warn("THREE.Skeleton boneInverses is the wrong length."),this.boneInverses=[],e=0,n=this.bones.length;e<n;e++)this.boneInverses.push(new I)}function W_(){F.call(this),this.type="Bone"}function px(e,n,u){Pt.call(this,e,n),this.instanceMatrix=new re(new Float32Array(16*u),16),this.count=u,this.frustumCulled=!1}function gn(e){Qt.call(this),this.type="LineBasicMaterial",this.color=new wt(16777215),this.linewidth=1,this.linejoin=this.linecap="round",this.morphTargets=!1,this.setValues(e)}function js(e,n,u){u===1&&console.error("THREE.Line: parameter THREE.LinePieces no longer supported. Use THREE.LineSegments instead."),F.call(this),this.type="Line",this.geometry=e!==void 0?e:new vt,this.material=n!==void 0?n:new gn,this.updateMorphTargets()}function In(e,n){js.call(this,e,n),this.type="LineSegments"}function dx(e,n){js.call(this,e,n),this.type="LineLoop"}function lu(e){Qt.call(this),this.type="PointsMaterial",this.color=new wt(16777215),this.alphaMap=this.map=null,this.size=1,this.sizeAttenuation=!0,this.morphTargets=!1,this.setValues(e)}function em(e,n){F.call(this),this.type="Points",this.geometry=e!==void 0?e:new vt,this.material=n!==void 0?n:new lu,this.updateMorphTargets()}function j_(e,n,u,m,_,T,R){var N=Gw.distanceSqToPoint(e);N<u&&(u=new w,Gw.closestPointToPoint(e,u),u.applyMatrix4(m),e=_.ray.origin.distanceTo(u),e<_.near||e>_.far||T.push({distance:e,distanceToRay:Math.sqrt(N),point:u,index:n,face:null,object:R}))}function X_(e,n,u,m,_,T,R,N,H){d.call(this,e,n,u,m,_,T,R,N,H),this.format=R!==void 0?R:1022,this.minFilter=T!==void 0?T:1006,this.magFilter=_!==void 0?_:1006,this.generateMipmaps=!1}function rm(e,n,u,m,_,T,R,N,H,W,$,K){d.call(this,null,T,R,N,H,W,m,_,$,K),this.image={width:n,height:u},this.mipmaps=e,this.generateMipmaps=this.flipY=!1}function Wv(e,n,u,m,_,T,R,N,H){d.call(this,e,n,u,m,_,T,R,N,H),this.needsUpdate=!0}function jv(e,n,u,m,_,T,R,N,H,W){if(W=W!==void 0?W:1026,W!==1026&&W!==1027)throw Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");u===void 0&&W===1026&&(u=1012),u===void 0&&W===1027&&(u=1020),d.call(this,null,m,_,T,R,N,W,u,H),this.image={width:e,height:n},this.magFilter=R!==void 0?R:1003,this.minFilter=N!==void 0?N:1003,this.generateMipmaps=this.flipY=!1}function im(e){vt.call(this),this.type="WireframeGeometry";var n=[],u,m,_,T=[0,0],R={},N=["a","b","c"];if(e&&e.isGeometry){var H=e.faces,W=0;for(m=H.length;W<m;W++){var $=H[W];for(u=0;3>u;u++){var K=$[N[u]],rt=$[N[(u+1)%3]];T[0]=Math.min(K,rt),T[1]=Math.max(K,rt),K=T[0]+","+T[1],R[K]===void 0&&(R[K]={index1:T[0],index2:T[1]})}}for(K in R)W=R[K],N=e.vertices[W.index1],n.push(N.x,N.y,N.z),N=e.vertices[W.index2],n.push(N.x,N.y,N.z)}else if(e&&e.isBufferGeometry)if(N=new w,e.index!==null){H=e.attributes.position,$=e.index;var et=e.groups;for(et.length===0&&(et=[{start:0,count:$.count,materialIndex:0}]),e=0,_=et.length;e<_;++e)for(W=et[e],u=W.start,m=W.count,W=u,m=u+m;W<m;W+=3)for(u=0;3>u;u++)K=$.getX(W+u),rt=$.getX(W+(u+1)%3),T[0]=Math.min(K,rt),T[1]=Math.max(K,rt),K=T[0]+","+T[1],R[K]===void 0&&(R[K]={index1:T[0],index2:T[1]});for(K in R)W=R[K],N.fromBufferAttribute(H,W.index1),n.push(N.x,N.y,N.z),N.fromBufferAttribute(H,W.index2),n.push(N.x,N.y,N.z)}else for(H=e.attributes.position,W=0,m=H.count/3;W<m;W++)for(u=0;3>u;u++)R=3*W+u,N.fromBufferAttribute(H,R),n.push(N.x,N.y,N.z),R=3*W+(u+1)%3,N.fromBufferAttribute(H,R),n.push(N.x,N.y,N.z);this.setAttribute("position",new _t(n,3))}function Xv(e,n,u){yt.call(this),this.type="ParametricGeometry",this.parameters={func:e,slices:n,stacks:u},this.fromBufferGeometry(new nm(e,n,u)),this.mergeVertices()}function nm(e,n,u){vt.call(this),this.type="ParametricBufferGeometry",this.parameters={func:e,slices:n,stacks:u};var m=[],_=[],T=[],R=[],N=new w,H=new w,W=new w,$=new w,K=new w,rt,et;3>e.length&&console.error("THREE.ParametricGeometry: Function must now modify a Vector3 as third parameter.");var at=n+1;for(rt=0;rt<=u;rt++){var mt=rt/u;for(et=0;et<=n;et++){var Ft=et/n;e(Ft,mt,H),_.push(H.x,H.y,H.z),0<=Ft-1e-5?(e(Ft-1e-5,mt,W),$.subVectors(H,W)):(e(Ft+1e-5,mt,W),$.subVectors(W,H)),0<=mt-1e-5?(e(Ft,mt-1e-5,W),K.subVectors(H,W)):(e(Ft,mt+1e-5,W),K.subVectors(W,H)),N.crossVectors($,K).normalize(),T.push(N.x,N.y,N.z),R.push(Ft,mt)}}for(rt=0;rt<u;rt++)for(et=0;et<n;et++)e=rt*at+et+1,N=(rt+1)*at+et+1,H=(rt+1)*at+et,m.push(rt*at+et,e,H),m.push(e,N,H);this.setIndex(m),this.setAttribute("position",new _t(_,3)),this.setAttribute("normal",new _t(T,3)),this.setAttribute("uv",new _t(R,2))}function Yv(e,n,u,m){yt.call(this),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:n,radius:u,detail:m},this.fromBufferGeometry(new Cs(e,n,u,m)),this.mergeVertices()}function Cs(e,n,u,m){function _(W){N.push(W.x,W.y,W.z)}function T(W,$){W*=3,$.x=e[W+0],$.y=e[W+1],$.z=e[W+2]}function R(W,$,K,rt){0>rt&&W.x===1&&(H[$]=W.x-1),K.x===0&&K.z===0&&(H[$]=rt/2/Math.PI+.5)}vt.call(this),this.type="PolyhedronBufferGeometry",this.parameters={vertices:e,indices:n,radius:u,detail:m},u=u||1,m=m||0;var N=[],H=[];(function(W){for(var $=new w,K=new w,rt=new w,et=0;et<n.length;et+=3){T(n[et+0],$),T(n[et+1],K),T(n[et+2],rt);var at,mt,Ft=$,Wt=K,Ht=rt,$t=Math.pow(2,W),Yt=[];for(mt=0;mt<=$t;mt++){Yt[mt]=[];var ie=Ft.clone().lerp(Ht,mt/$t),Vt=Wt.clone().lerp(Ht,mt/$t),ve=$t-mt;for(at=0;at<=ve;at++)Yt[mt][at]=at===0&&mt===$t?ie:ie.clone().lerp(Vt,at/ve)}for(mt=0;mt<$t;mt++)for(at=0;at<2*($t-mt)-1;at++)Ft=Math.floor(at/2),at%2===0?(_(Yt[mt][Ft+1]),_(Yt[mt+1][Ft]),_(Yt[mt][Ft])):(_(Yt[mt][Ft+1]),_(Yt[mt+1][Ft+1]),_(Yt[mt+1][Ft]))}})(m),function(W){for(var $=new w,K=0;K<N.length;K+=3)$.x=N[K+0],$.y=N[K+1],$.z=N[K+2],$.normalize().multiplyScalar(W),N[K+0]=$.x,N[K+1]=$.y,N[K+2]=$.z}(u),function(){for(var W=new w,$=0;$<N.length;$+=3)W.x=N[$+0],W.y=N[$+1],W.z=N[$+2],H.push(Math.atan2(W.z,-W.x)/2/Math.PI+.5,1-(Math.atan2(-W.y,Math.sqrt(W.x*W.x+W.z*W.z))/Math.PI+.5));W=new w,$=new w;for(var K=new w,rt=new w,et=new f,at=new f,mt=new f,Ft=0,Wt=0;Ft<N.length;Ft+=9,Wt+=6){W.set(N[Ft+0],N[Ft+1],N[Ft+2]),$.set(N[Ft+3],N[Ft+4],N[Ft+5]),K.set(N[Ft+6],N[Ft+7],N[Ft+8]),et.set(H[Wt+0],H[Wt+1]),at.set(H[Wt+2],H[Wt+3]),mt.set(H[Wt+4],H[Wt+5]),rt.copy(W).add($).add(K).divideScalar(3);var Ht=Math.atan2(rt.z,-rt.x);R(et,Wt+0,W,Ht),R(at,Wt+2,$,Ht),R(mt,Wt+4,K,Ht)}for(W=0;W<H.length;W+=6)$=H[W+0],K=H[W+2],rt=H[W+4],et=Math.min($,K,rt),.9<Math.max($,K,rt)&&.1>et&&(.2>$&&(H[W+0]+=1),.2>K&&(H[W+2]+=1),.2>rt&&(H[W+4]+=1))}(),this.setAttribute("position",new _t(N,3)),this.setAttribute("normal",new _t(N.slice(),3)),this.setAttribute("uv",new _t(H,2)),m===0?this.computeVertexNormals():this.normalizeNormals()}function Zv(e,n){yt.call(this),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:n},this.fromBufferGeometry(new om(e,n)),this.mergeVertices()}function om(e,n){Cs.call(this,[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],e,n),this.type="TetrahedronBufferGeometry",this.parameters={radius:e,detail:n}}function qv(e,n){yt.call(this),this.type="OctahedronGeometry",this.parameters={radius:e,detail:n},this.fromBufferGeometry(new vp(e,n)),this.mergeVertices()}function vp(e,n){Cs.call(this,[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],e,n),this.type="OctahedronBufferGeometry",this.parameters={radius:e,detail:n}}function Jv(e,n){yt.call(this),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:n},this.fromBufferGeometry(new sm(e,n)),this.mergeVertices()}function sm(e,n){var u=(1+Math.sqrt(5))/2;Cs.call(this,[-1,u,0,1,u,0,-1,-u,0,1,-u,0,0,-1,u,0,1,u,0,-1,-u,0,1,-u,u,0,-1,u,0,1,-u,0,-1,-u,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],e,n),this.type="IcosahedronBufferGeometry",this.parameters={radius:e,detail:n}}function Qv(e,n){yt.call(this),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:n},this.fromBufferGeometry(new am(e,n)),this.mergeVertices()}function am(e,n){var u=(1+Math.sqrt(5))/2,m=1/u;Cs.call(this,[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-m,-u,0,-m,u,0,m,-u,0,m,u,-m,-u,0,-m,u,0,m,-u,0,m,u,0,-u,0,-m,u,0,-m,-u,0,m,u,0,m],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],e,n),this.type="DodecahedronBufferGeometry",this.parameters={radius:e,detail:n}}function Kv(e,n,u,m,_,T){yt.call(this),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:n,radius:u,radialSegments:m,closed:_},T!==void 0&&console.warn("THREE.TubeGeometry: taper has been removed."),e=new yp(e,n,u,m,_),this.tangents=e.tangents,this.normals=e.normals,this.binormals=e.binormals,this.fromBufferGeometry(e),this.mergeVertices()}function yp(e,n,u,m,_){function T(Wt){$=e.getPointAt(Wt/n,$);var Ht=R.normals[Wt];for(Wt=R.binormals[Wt],rt=0;rt<=m;rt++){var $t=rt/m*Math.PI*2,Yt=Math.sin($t);$t=-Math.cos($t),H.x=$t*Ht.x+Yt*Wt.x,H.y=$t*Ht.y+Yt*Wt.y,H.z=$t*Ht.z+Yt*Wt.z,H.normalize(),at.push(H.x,H.y,H.z),N.x=$.x+u*H.x,N.y=$.y+u*H.y,N.z=$.z+u*H.z,et.push(N.x,N.y,N.z)}}vt.call(this),this.type="TubeBufferGeometry",this.parameters={path:e,tubularSegments:n,radius:u,radialSegments:m,closed:_},n=n||64,u=u||1,m=m||8,_=_||!1;var R=e.computeFrenetFrames(n,_);this.tangents=R.tangents,this.normals=R.normals,this.binormals=R.binormals;var N=new w,H=new w,W=new f,$=new w,K,rt,et=[],at=[],mt=[],Ft=[];for(K=0;K<n;K++)T(K);for(T(_===!1?n:0),K=0;K<=n;K++)for(rt=0;rt<=m;rt++)W.x=K/n,W.y=rt/m,mt.push(W.x,W.y);(function(){for(rt=1;rt<=n;rt++)for(K=1;K<=m;K++){var Wt=(m+1)*rt+(K-1),Ht=(m+1)*rt+K,$t=(m+1)*(rt-1)+K;Ft.push((m+1)*(rt-1)+(K-1),Wt,$t),Ft.push(Wt,Ht,$t)}})(),this.setIndex(Ft),this.setAttribute("position",new _t(et,3)),this.setAttribute("normal",new _t(at,3)),this.setAttribute("uv",new _t(mt,2))}function $v(e,n,u,m,_,T,R){yt.call(this),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:n,tubularSegments:u,radialSegments:m,p:_,q:T},R!==void 0&&console.warn("THREE.TorusKnotGeometry: heightScale has been deprecated. Use .scale( x, y, z ) instead."),this.fromBufferGeometry(new um(e,n,u,m,_,T)),this.mergeVertices()}function um(e,n,u,m,_,T){function R(Vt,ve,Le,oe,Pe){var Ie=Math.sin(Vt);ve=Le/ve*Vt,Le=Math.cos(ve),Pe.x=oe*(2+Le)*.5*Math.cos(Vt),Pe.y=oe*(2+Le)*Ie*.5,Pe.z=oe*Math.sin(ve)*.5}vt.call(this),this.type="TorusKnotBufferGeometry",this.parameters={radius:e,tube:n,tubularSegments:u,radialSegments:m,p:_,q:T},e=e||1,n=n||.4,u=Math.floor(u)||64,m=Math.floor(m)||8,_=_||2,T=T||3;var N=[],H=[],W=[],$=[],K,rt=new w,et=new w,at=new w,mt=new w,Ft=new w,Wt=new w,Ht=new w;for(K=0;K<=u;++K){var $t=K/u*_*Math.PI*2;for(R($t,_,T,e,at),R($t+.01,_,T,e,mt),Wt.subVectors(mt,at),Ht.addVectors(mt,at),Ft.crossVectors(Wt,Ht),Ht.crossVectors(Ft,Wt),Ft.normalize(),Ht.normalize(),$t=0;$t<=m;++$t){var Yt=$t/m*Math.PI*2,ie=-n*Math.cos(Yt);Yt=n*Math.sin(Yt),rt.x=at.x+(ie*Ht.x+Yt*Ft.x),rt.y=at.y+(ie*Ht.y+Yt*Ft.y),rt.z=at.z+(ie*Ht.z+Yt*Ft.z),H.push(rt.x,rt.y,rt.z),et.subVectors(rt,at).normalize(),W.push(et.x,et.y,et.z),$.push(K/u),$.push($t/m)}}for($t=1;$t<=u;$t++)for(K=1;K<=m;K++)e=(m+1)*$t+(K-1),n=(m+1)*$t+K,_=(m+1)*($t-1)+K,N.push((m+1)*($t-1)+(K-1),e,_),N.push(e,n,_);this.setIndex(N),this.setAttribute("position",new _t(H,3)),this.setAttribute("normal",new _t(W,3)),this.setAttribute("uv",new _t($,2))}function t0(e,n,u,m,_){yt.call(this),this.type="TorusGeometry",this.parameters={radius:e,tube:n,radialSegments:u,tubularSegments:m,arc:_},this.fromBufferGeometry(new lm(e,n,u,m,_)),this.mergeVertices()}function lm(e,n,u,m,_){vt.call(this),this.type="TorusBufferGeometry",this.parameters={radius:e,tube:n,radialSegments:u,tubularSegments:m,arc:_},e=e||1,n=n||.4,u=Math.floor(u)||8,m=Math.floor(m)||6,_=_||2*Math.PI;var T=[],R=[],N=[],H=[],W=new w,$=new w,K=new w,rt,et;for(rt=0;rt<=u;rt++)for(et=0;et<=m;et++){var at=et/m*_,mt=rt/u*Math.PI*2;$.x=(e+n*Math.cos(mt))*Math.cos(at),$.y=(e+n*Math.cos(mt))*Math.sin(at),$.z=n*Math.sin(mt),R.push($.x,$.y,$.z),W.x=e*Math.cos(at),W.y=e*Math.sin(at),K.subVectors($,W).normalize(),N.push(K.x,K.y,K.z),H.push(et/m),H.push(rt/u)}for(rt=1;rt<=u;rt++)for(et=1;et<=m;et++)e=(m+1)*(rt-1)+et-1,n=(m+1)*(rt-1)+et,_=(m+1)*rt+et,T.push((m+1)*rt+et-1,e,_),T.push(e,n,_);this.setIndex(T),this.setAttribute("position",new _t(R,3)),this.setAttribute("normal",new _t(N,3)),this.setAttribute("uv",new _t(H,2))}function H3(e,n,u,m,_){for(var T,R=0,N=n,H=u-m;N<u;N+=m)R+=(e[H]-e[N])*(e[N+1]+e[H+1]),H=N;if(_===0<R)for(_=n;_<u;_+=m)T=W3(_,e[_],e[_+1],T);else for(_=u-m;_>=n;_-=m)T=W3(_,e[_],e[_+1],T);return T&&mx(T,T.next)&&(i0(T),T=T.next),T}function Ic(e,n){if(!e)return e;n||(n=e);do{var u=!1;if(e.steiner||!mx(e,e.next)&&En(e.prev,e,e.next)!==0)e=e.next;else{if(i0(e),e=n=e.prev,e===e.next)break;u=!0}}while(u||e!==n);return n}function e0(e,n,u,m,_,T,R){if(e){if(!R&&T){var N=e,H=N;do H.z===null&&(H.z=Y_(H.x,H.y,m,_,T)),H.prevZ=H.prev,H=H.nextZ=H.next;while(H!==N);H.prevZ.nextZ=null,H.prevZ=null,N=H;var W,$,K,rt,et=1;do{H=N;var at=N=null;for($=0;H;){$++;var mt=H;for(W=K=0;W<et&&(K++,mt=mt.nextZ,mt);W++);for(rt=et;0<K||0<rt&&mt;)K!==0&&(rt===0||!mt||H.z<=mt.z)?(W=H,H=H.nextZ,K--):(W=mt,mt=mt.nextZ,rt--),at?at.nextZ=W:N=W,W.prevZ=at,at=W;H=mt}at.nextZ=null,et*=2}while(1<$)}for(N=e;e.prev!==e.next;){if(H=e.prev,mt=e.next,T)at=I5(e,m,_,T);else t:if(at=e,$=at.prev,K=at,et=at.next,0<=En($,K,et))at=!1;else{for(W=at.next.next;W!==at.prev;){if(hm($.x,$.y,K.x,K.y,et.x,et.y,W.x,W.y)&&0<=En(W.prev,W,W.next)){at=!1;break t}W=W.next}at=!0}if(at)n.push(H.i/u),n.push(e.i/u),n.push(mt.i/u),i0(e),N=e=mt.next;else if(e=mt,e===N){if(!R)e0(Ic(e),n,u,m,_,T,1);else if(R===1){e=Ic(e),R=n,N=u,H=e;do mt=H.prev,at=H.next.next,!mx(mt,at)&&G3(mt,H,H.next,at)&&r0(mt,at)&&r0(at,mt)&&(R.push(mt.i/N),R.push(H.i/N),R.push(at.i/N),i0(H),i0(H.next),H=e=at),H=H.next;while(H!==e);e=Ic(H),e0(e,n,u,m,_,T,2)}else if(R===2)t:{R=e;do{for(N=R.next.next;N!==R.prev;){if(H=R.i!==N.i){if(H=R,mt=N,at=H.next.i!==mt.i&&H.prev.i!==mt.i){e:{at=H;do{if(at.i!==H.i&&at.next.i!==H.i&&at.i!==mt.i&&at.next.i!==mt.i&&G3(at,at.next,H,mt)){at=!0;break e}at=at.next}while(at!==H);at=!1}at=!at}if(at){if(at=r0(H,mt)&&r0(mt,H)){at=H,$=!1,K=(H.x+mt.x)/2,et=(H.y+mt.y)/2;do at.y>et!=at.next.y>et&&at.next.y!==at.y&&K<(at.next.x-at.x)*(et-at.y)/(at.next.y-at.y)+at.x&&($=!$),at=at.next;while(at!==H);at=$}at=at&&(En(H.prev,H,mt.prev)||En(H,mt.prev,mt))||mx(H,mt)&&0<En(H.prev,H,H.next)&&0<En(mt.prev,mt,mt.next)}H=at}if(H){e=V3(R,N),R=Ic(R,R.next),e=Ic(e,e.next),e0(R,n,u,m,_,T),e0(e,n,u,m,_,T);break t}N=N.next}R=R.next}while(R!==e)}break}}}}function I5(e,n,u,m){var _=e.prev,T=e.next;if(0<=En(_,e,T))return!1;var R=_.x>e.x?_.x>T.x?_.x:T.x:e.x>T.x?e.x:T.x,N=_.y>e.y?_.y>T.y?_.y:T.y:e.y>T.y?e.y:T.y,H=Y_(_.x<e.x?_.x<T.x?_.x:T.x:e.x<T.x?e.x:T.x,_.y<e.y?_.y<T.y?_.y:T.y:e.y<T.y?e.y:T.y,n,u,m);for(n=Y_(R,N,n,u,m),u=e.prevZ,m=e.nextZ;u&&u.z>=H&&m&&m.z<=n;){if(u!==e.prev&&u!==e.next&&hm(_.x,_.y,e.x,e.y,T.x,T.y,u.x,u.y)&&0<=En(u.prev,u,u.next)||(u=u.prevZ,m!==e.prev&&m!==e.next&&hm(_.x,_.y,e.x,e.y,T.x,T.y,m.x,m.y)&&0<=En(m.prev,m,m.next)))return!1;m=m.nextZ}for(;u&&u.z>=H;){if(u!==e.prev&&u!==e.next&&hm(_.x,_.y,e.x,e.y,T.x,T.y,u.x,u.y)&&0<=En(u.prev,u,u.next))return!1;u=u.prevZ}for(;m&&m.z<=n;){if(m!==e.prev&&m!==e.next&&hm(_.x,_.y,e.x,e.y,T.x,T.y,m.x,m.y)&&0<=En(m.prev,m,m.next))return!1;m=m.nextZ}return!0}function E5(e,n){return e.x-n.x}function L5(e,n){var u=n,m=e.x,_=e.y,T=-1/0;do{if(_<=u.y&&_>=u.next.y&&u.next.y!==u.y){var R=u.x+(_-u.y)*(u.next.x-u.x)/(u.next.y-u.y);if(R<=m&&R>T){if(T=R,R===m){if(_===u.y)return u;if(_===u.next.y)return u.next}var N=u.x<u.next.x?u:u.next}}u=u.next}while(u!==n);if(!N)return null;if(m===T)return N;n=N,R=N.x;var H=N.y,W=1/0;u=N;do{if(m>=u.x&&u.x>=R&&m!==u.x&&hm(_<H?m:T,_,R,H,_<H?T:m,_,u.x,u.y)){var $=Math.abs(_-u.y)/(m-u.x),K;if((K=r0(u,e))&&!(K=$<W)&&(K=$===W)&&!(K=u.x>N.x)&&(K=u.x===N.x)){K=N;var rt=u;K=0>En(K.prev,K,rt.prev)&&0>En(rt.next,K,K.next)}K&&(N=u,W=$)}u=u.next}while(u!==n);return N}function Y_(e,n,u,m,_){return e=32767*(e-u)*_,n=32767*(n-m)*_,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,n=(n|n<<8)&16711935,n=(n|n<<4)&252645135,n=(n|n<<2)&858993459,(e|e<<1)&1431655765|((n|n<<1)&1431655765)<<1}function R5(e){var n=e,u=e;do(n.x<u.x||n.x===u.x&&n.y<u.y)&&(u=n),n=n.next;while(n!==e);return u}function hm(e,n,u,m,_,T,R,N){return 0<=(_-R)*(n-N)-(e-R)*(T-N)&&0<=(e-R)*(m-N)-(u-R)*(n-N)&&0<=(u-R)*(T-N)-(_-R)*(m-N)}function En(e,n,u){return(n.y-e.y)*(u.x-n.x)-(n.x-e.x)*(u.y-n.y)}function mx(e,n){return e.x===n.x&&e.y===n.y}function G3(e,n,u,m){var _=vx(En(e,n,u)),T=vx(En(e,n,m)),R=vx(En(u,m,e)),N=vx(En(u,m,n));return!!(_!==T&&R!==N||_===0&&gx(e,u,n)||T===0&&gx(e,m,n)||R===0&&gx(u,e,m)||N===0&&gx(u,n,m))}function gx(e,n,u){return n.x<=Math.max(e.x,u.x)&&n.x>=Math.min(e.x,u.x)&&n.y<=Math.max(e.y,u.y)&&n.y>=Math.min(e.y,u.y)}function vx(e){return 0<e?1:0>e?-1:0}function r0(e,n){return 0>En(e.prev,e,e.next)?0<=En(e,n,e.next)&&0<=En(e,e.prev,n):0>En(e,n,e.prev)||0>En(e,e.next,n)}function V3(e,n){var u=new Z_(e.i,e.x,e.y),m=new Z_(n.i,n.x,n.y),_=e.next,T=n.prev;return e.next=n,n.prev=e,u.next=_,_.prev=u,m.next=u,u.prev=m,T.next=m,m.prev=T,m}function W3(e,n,u,m){return e=new Z_(e,n,u),m?(e.next=m.next,e.prev=m,m.next.prev=e,m.next=e):(e.prev=e,e.next=e),e}function i0(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function Z_(e,n,u){this.i=e,this.x=n,this.y=u,this.nextZ=this.prevZ=this.z=this.next=this.prev=null,this.steiner=!1}function j3(e){var n=e.length;2<n&&e[n-1].equals(e[0])&&e.pop()}function X3(e,n){for(var u=0;u<n.length;u++)e.push(n[u].x),e.push(n[u].y)}function xp(e,n){yt.call(this),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:n},this.fromBufferGeometry(new rl(e,n)),this.mergeVertices()}function rl(e,n){function u(H){function W(tr,kr,hn){return kr||console.error("THREE.ExtrudeGeometry: vec does not exist"),kr.clone().multiplyScalar(hn).add(tr)}function $(tr,kr,hn){var Xr=tr.x-kr.x,Ee=tr.y-kr.y,Hr=hn.x-tr.x,oi=hn.y-tr.y,Dr=Xr*Xr+Ee*Ee;if(Math.abs(Xr*oi-Ee*Hr)>an){var Vo=Math.sqrt(Dr),Qn=Math.sqrt(Hr*Hr+oi*oi);if(Dr=kr.x-Ee/Vo,kr=kr.y+Xr/Vo,oi=((hn.x-oi/Qn-Dr)*oi-(hn.y+Hr/Qn-kr)*Hr)/(Xr*oi-Ee*Hr),Hr=Dr+Xr*oi-tr.x,Xr=kr+Ee*oi-tr.y,Ee=Hr*Hr+Xr*Xr,2>=Ee)return new f(Hr,Xr);Ee=Math.sqrt(Ee/2)}else tr=!1,Xr>an?Hr>an&&(tr=!0):Xr<-an?Hr<-an&&(tr=!0):Qu(Ee)===Qu(oi)&&(tr=!0),tr?(Hr=-Ee,Ee=Math.sqrt(Dr)):(Hr=Xr,Xr=Ee,Ee=Math.sqrt(Dr/2));return new f(Hr/Ee,Xr/Ee)}function K(tr,kr){for(Ce=tr.length;0<=--Ce;){var hn=Ce,Xr=Ce-1;0>Xr&&(Xr=tr.length-1);var Ee,Hr=Ht+2*Le;for(Ee=0;Ee<Hr;Ee++){var oi=ce*Ee,Dr=ce*(Ee+1),Vo=kr+Xr+oi,Qn=kr+Xr+Dr;Dr=kr+hn+Dr,at(kr+hn+oi),at(Vo),at(Dr),at(Vo),at(Qn),at(Dr),oi=_.length/3,oi=Pe.generateSideWallUV(m,_,oi-6,oi-3,oi-2,oi-1),mt(oi[0]),mt(oi[1]),mt(oi[3]),mt(oi[1]),mt(oi[2]),mt(oi[3])}}}function rt(tr,kr,hn){Ft.push(tr),Ft.push(kr),Ft.push(hn)}function et(tr,kr,hn){at(tr),at(kr),at(hn),tr=_.length/3,tr=Pe.generateTopUV(m,_,tr-3,tr-2,tr-1),mt(tr[0]),mt(tr[1]),mt(tr[2])}function at(tr){_.push(Ft[3*tr]),_.push(Ft[3*tr+1]),_.push(Ft[3*tr+2])}function mt(tr){T.push(tr.x),T.push(tr.y)}var Ft=[],Wt=n.curveSegments!==void 0?n.curveSegments:12,Ht=n.steps!==void 0?n.steps:1,$t=n.depth!==void 0?n.depth:100,Yt=n.bevelEnabled!==void 0?n.bevelEnabled:!0,ie=n.bevelThickness!==void 0?n.bevelThickness:6,Vt=n.bevelSize!==void 0?n.bevelSize:ie-2,ve=n.bevelOffset!==void 0?n.bevelOffset:0,Le=n.bevelSegments!==void 0?n.bevelSegments:3,oe=n.extrudePath,Pe=n.UVGenerator!==void 0?n.UVGenerator:$5;n.amount!==void 0&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),$t=n.amount);var Ie=!1;if(oe){var fr=oe.getSpacedPoints(Ht);Ie=!0,Yt=!1;var Lr=oe.computeFrenetFrames(Ht,!1),Ze=new w,Sr=new w,$r=new w}Yt||(ve=Vt=ie=Le=0);var Ur;Wt=H.extractPoints(Wt),H=Wt.shape;var fi=Wt.holes;if(!vh.isClockWise(H)){H=H.reverse();var ei=0;for(Ur=fi.length;ei<Ur;ei++){var Di=fi[ei];vh.isClockWise(Di)&&(fi[ei]=Di.reverse())}}var Yi=vh.triangulateShape(H,fi),St=H;for(ei=0,Ur=fi.length;ei<Ur;ei++)Di=fi[ei],H=H.concat(Di);var Bt,ce=H.length,Fe,ir=Yi.length;Wt=[];var Ce=0,Nt=St.length,ze=Nt-1;for(Bt=Ce+1;Ce<Nt;Ce++,ze++,Bt++)ze===Nt&&(ze=0),Bt===Nt&&(Bt=0),Wt[Ce]=$(St[Ce],St[ze],St[Bt]);oe=[];var lr=Wt.concat();for(ei=0,Ur=fi.length;ei<Ur;ei++){Di=fi[ei];var Pr=[];for(Ce=0,Nt=Di.length,ze=Nt-1,Bt=Ce+1;Ce<Nt;Ce++,ze++,Bt++)ze===Nt&&(ze=0),Bt===Nt&&(Bt=0),Pr[Ce]=$(Di[Ce],Di[ze],Di[Bt]);oe.push(Pr),lr=lr.concat(Pr)}for(ze=0;ze<Le;ze++){Nt=ze/Le;var pr=ie*Math.cos(Nt*Math.PI/2);for(Bt=Vt*Math.sin(Nt*Math.PI/2)+ve,Ce=0,Nt=St.length;Ce<Nt;Ce++){var $e=W(St[Ce],Wt[Ce],Bt);rt($e.x,$e.y,-pr)}for(ei=0,Ur=fi.length;ei<Ur;ei++)for(Di=fi[ei],Pr=oe[ei],Ce=0,Nt=Di.length;Ce<Nt;Ce++)$e=W(Di[Ce],Pr[Ce],Bt),rt($e.x,$e.y,-pr)}for(Bt=Vt+ve,Ce=0;Ce<ce;Ce++)$e=Yt?W(H[Ce],lr[Ce],Bt):H[Ce],Ie?(Sr.copy(Lr.normals[0]).multiplyScalar($e.x),Ze.copy(Lr.binormals[0]).multiplyScalar($e.y),$r.copy(fr[0]).add(Sr).add(Ze),rt($r.x,$r.y,$r.z)):rt($e.x,$e.y,0);for(Nt=1;Nt<=Ht;Nt++)for(Ce=0;Ce<ce;Ce++)$e=Yt?W(H[Ce],lr[Ce],Bt):H[Ce],Ie?(Sr.copy(Lr.normals[Nt]).multiplyScalar($e.x),Ze.copy(Lr.binormals[Nt]).multiplyScalar($e.y),$r.copy(fr[Nt]).add(Sr).add(Ze),rt($r.x,$r.y,$r.z)):rt($e.x,$e.y,$t/Ht*Nt);for(ze=Le-1;0<=ze;ze--){for(Nt=ze/Le,pr=ie*Math.cos(Nt*Math.PI/2),Bt=Vt*Math.sin(Nt*Math.PI/2)+ve,Ce=0,Nt=St.length;Ce<Nt;Ce++)$e=W(St[Ce],Wt[Ce],Bt),rt($e.x,$e.y,$t+pr);for(ei=0,Ur=fi.length;ei<Ur;ei++)for(Di=fi[ei],Pr=oe[ei],Ce=0,Nt=Di.length;Ce<Nt;Ce++)$e=W(Di[Ce],Pr[Ce],Bt),Ie?rt($e.x,$e.y+fr[Ht-1].y,fr[Ht-1].x+pr):rt($e.x,$e.y,$t+pr)}(function(){var tr=_.length/3;if(Yt){var kr=0*ce;for(Ce=0;Ce<ir;Ce++)Fe=Yi[Ce],et(Fe[2]+kr,Fe[1]+kr,Fe[0]+kr);for(kr=ce*(Ht+2*Le),Ce=0;Ce<ir;Ce++)Fe=Yi[Ce],et(Fe[0]+kr,Fe[1]+kr,Fe[2]+kr)}else{for(Ce=0;Ce<ir;Ce++)Fe=Yi[Ce],et(Fe[2],Fe[1],Fe[0]);for(Ce=0;Ce<ir;Ce++)Fe=Yi[Ce],et(Fe[0]+ce*Ht,Fe[1]+ce*Ht,Fe[2]+ce*Ht)}m.addGroup(tr,_.length/3-tr,0)})(),function(){var tr=_.length/3,kr=0;for(K(St,kr),kr+=St.length,ei=0,Ur=fi.length;ei<Ur;ei++)Di=fi[ei],K(Di,kr),kr+=Di.length;m.addGroup(tr,_.length/3-tr,1)}()}vt.call(this),this.type="ExtrudeBufferGeometry",this.parameters={shapes:e,options:n},e=Array.isArray(e)?e:[e];for(var m=this,_=[],T=[],R=0,N=e.length;R<N;R++)u(e[R]);this.setAttribute("position",new _t(_,3)),this.setAttribute("uv",new _t(T,2)),this.computeVertexNormals()}function Y3(e,n,u){if(u.shapes=[],Array.isArray(e))for(var m=0,_=e.length;m<_;m++)u.shapes.push(e[m].uuid);else u.shapes.push(e.uuid);return n.extrudePath!==void 0&&(u.options.extrudePath=n.extrudePath.toJSON()),u}function n0(e,n){yt.call(this),this.type="TextGeometry",this.parameters={text:e,parameters:n},this.fromBufferGeometry(new cm(e,n)),this.mergeVertices()}function cm(e,n){n=n||{};var u=n.font;if(!u||!u.isFont)return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),new yt;e=u.generateShapes(e,n.size),n.depth=n.height!==void 0?n.height:50,n.bevelThickness===void 0&&(n.bevelThickness=10),n.bevelSize===void 0&&(n.bevelSize=8),n.bevelEnabled===void 0&&(n.bevelEnabled=!1),rl.call(this,e,n),this.type="TextBufferGeometry"}function o0(e,n,u,m,_,T,R){yt.call(this),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:n,heightSegments:u,phiStart:m,phiLength:_,thetaStart:T,thetaLength:R},this.fromBufferGeometry(new Ap(e,n,u,m,_,T,R)),this.mergeVertices()}function Ap(e,n,u,m,_,T,R){vt.call(this),this.type="SphereBufferGeometry",this.parameters={radius:e,widthSegments:n,heightSegments:u,phiStart:m,phiLength:_,thetaStart:T,thetaLength:R},e=e||1,n=Math.max(3,Math.floor(n)||8),u=Math.max(2,Math.floor(u)||6),m=m!==void 0?m:0,_=_!==void 0?_:2*Math.PI,T=T!==void 0?T:0,R=R!==void 0?R:Math.PI;var N=Math.min(T+R,Math.PI),H,W,$=0,K=[],rt=new w,et=new w,at=[],mt=[],Ft=[],Wt=[];for(W=0;W<=u;W++){var Ht=[],$t=W/u,Yt=0;for(W==0&&T==0?Yt=.5/n:W==u&&N==Math.PI&&(Yt=-.5/n),H=0;H<=n;H++){var ie=H/n;rt.x=-e*Math.cos(m+ie*_)*Math.sin(T+$t*R),rt.y=e*Math.cos(T+$t*R),rt.z=e*Math.sin(m+ie*_)*Math.sin(T+$t*R),mt.push(rt.x,rt.y,rt.z),et.copy(rt).normalize(),Ft.push(et.x,et.y,et.z),Wt.push(ie+Yt,1-$t),Ht.push($++)}K.push(Ht)}for(W=0;W<u;W++)for(H=0;H<n;H++)e=K[W][H+1],m=K[W][H],_=K[W+1][H],R=K[W+1][H+1],(W!==0||0<T)&&at.push(e,m,R),(W!==u-1||N<Math.PI)&&at.push(m,_,R);this.setIndex(at),this.setAttribute("position",new _t(mt,3)),this.setAttribute("normal",new _t(Ft,3)),this.setAttribute("uv",new _t(Wt,2))}function s0(e,n,u,m,_,T){yt.call(this),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:n,thetaSegments:u,phiSegments:m,thetaStart:_,thetaLength:T},this.fromBufferGeometry(new fm(e,n,u,m,_,T)),this.mergeVertices()}function fm(e,n,u,m,_,T){vt.call(this),this.type="RingBufferGeometry",this.parameters={innerRadius:e,outerRadius:n,thetaSegments:u,phiSegments:m,thetaStart:_,thetaLength:T},e=e||.5,n=n||1,_=_!==void 0?_:0,T=T!==void 0?T:2*Math.PI,u=u!==void 0?Math.max(3,u):8,m=m!==void 0?Math.max(1,m):1;var R=[],N=[],H=[],W=[],$=e,K=(n-e)/m,rt=new w,et=new f,at,mt;for(at=0;at<=m;at++){for(mt=0;mt<=u;mt++)e=_+mt/u*T,rt.x=$*Math.cos(e),rt.y=$*Math.sin(e),N.push(rt.x,rt.y,rt.z),H.push(0,0,1),et.x=(rt.x/n+1)/2,et.y=(rt.y/n+1)/2,W.push(et.x,et.y);$+=K}for(at=0;at<m;at++)for(n=at*(u+1),mt=0;mt<u;mt++)e=mt+n,_=e+u+1,T=e+u+2,$=e+1,R.push(e,_,$),R.push(_,T,$);this.setIndex(R),this.setAttribute("position",new _t(N,3)),this.setAttribute("normal",new _t(H,3)),this.setAttribute("uv",new _t(W,2))}function a0(e,n,u,m){yt.call(this),this.type="LatheGeometry",this.parameters={points:e,segments:n,phiStart:u,phiLength:m},this.fromBufferGeometry(new pm(e,n,u,m)),this.mergeVertices()}function pm(e,n,u,m){vt.call(this),this.type="LatheBufferGeometry",this.parameters={points:e,segments:n,phiStart:u,phiLength:m},n=Math.floor(n)||12,u=u||0,m=m||2*Math.PI,m=ni.clamp(m,0,2*Math.PI);var _=[],T=[],R=[],N=1/n,H=new w,W=new f,$;for($=0;$<=n;$++){var K=u+$*N*m,rt=Math.sin(K),et=Math.cos(K);for(K=0;K<=e.length-1;K++)H.x=e[K].x*rt,H.y=e[K].y,H.z=e[K].x*et,T.push(H.x,H.y,H.z),W.x=$/n,W.y=K/(e.length-1),R.push(W.x,W.y)}for($=0;$<n;$++)for(K=0;K<e.length-1;K++)u=K+$*e.length,N=u+e.length,H=u+e.length+1,W=u+1,_.push(u,N,W),_.push(N,H,W);if(this.setIndex(_),this.setAttribute("position",new _t(T,3)),this.setAttribute("uv",new _t(R,2)),this.computeVertexNormals(),m===2*Math.PI)for(m=this.attributes.normal.array,_=new w,T=new w,R=new w,u=n*e.length*3,K=$=0;$<e.length;$++,K+=3)_.x=m[K+0],_.y=m[K+1],_.z=m[K+2],T.x=m[u+K+0],T.y=m[u+K+1],T.z=m[u+K+2],R.addVectors(_,T).normalize(),m[K+0]=m[u+K+0]=R.x,m[K+1]=m[u+K+1]=R.y,m[K+2]=m[u+K+2]=R.z}function _p(e,n){yt.call(this),this.type="ShapeGeometry",(typeof n=="undefined"?"undefined":ts(n))==="object"&&(console.warn("THREE.ShapeGeometry: Options parameter has been removed."),n=n.curveSegments),this.parameters={shapes:e,curveSegments:n},this.fromBufferGeometry(new wp(e,n)),this.mergeVertices()}function wp(e,n){function u($){var K,rt=_.length/3;$=$.extractPoints(n);var et=$.shape,at=$.holes;for(vh.isClockWise(et)===!1&&(et=et.reverse()),$=0,K=at.length;$<K;$++){var mt=at[$];vh.isClockWise(mt)===!0&&(at[$]=mt.reverse())}var Ft=vh.triangulateShape(et,at);for($=0,K=at.length;$<K;$++)mt=at[$],et=et.concat(mt);for($=0,K=et.length;$<K;$++)mt=et[$],_.push(mt.x,mt.y,0),T.push(0,0,1),R.push(mt.x,mt.y);for($=0,K=Ft.length;$<K;$++)et=Ft[$],m.push(et[0]+rt,et[1]+rt,et[2]+rt),H+=3}vt.call(this),this.type="ShapeBufferGeometry",this.parameters={shapes:e,curveSegments:n},n=n||12;var m=[],_=[],T=[],R=[],N=0,H=0;if(Array.isArray(e)===!1)u(e);else for(var W=0;W<e.length;W++)u(e[W]),this.addGroup(N,H,W),N+=H,H=0;this.setIndex(m),this.setAttribute("position",new _t(_,3)),this.setAttribute("normal",new _t(T,3)),this.setAttribute("uv",new _t(R,2))}function Z3(e,n){if(n.shapes=[],Array.isArray(e))for(var u=0,m=e.length;u<m;u++)n.shapes.push(e[u].uuid);else n.shapes.push(e.uuid);return n}function dm(e,n){vt.call(this),this.type="EdgesGeometry",this.parameters={thresholdAngle:n};var u=[];n=Math.cos(ni.DEG2RAD*(n!==void 0?n:1));var m=[0,0],_={},T=["a","b","c"];if(e.isBufferGeometry){var R=new yt;R.fromBufferGeometry(e)}else R=e.clone();R.mergeVertices(),R.computeFaceNormals(),e=R.vertices,R=R.faces;for(var N=0,H=R.length;N<H;N++)for(var W=R[N],$=0;3>$;$++){var K=W[T[$]],rt=W[T[($+1)%3]];m[0]=Math.min(K,rt),m[1]=Math.max(K,rt),K=m[0]+","+m[1],_[K]===void 0?_[K]={index1:m[0],index2:m[1],face1:N,face2:void 0}:_[K].face2=N}for(K in _)m=_[K],(m.face2===void 0||R[m.face1].normal.dot(R[m.face2].normal)<=n)&&(T=e[m.index1],u.push(T.x,T.y,T.z),T=e[m.index2],u.push(T.x,T.y,T.z));this.setAttribute("position",new _t(u,3))}function Mp(e,n,u,m,_,T,R,N){yt.call(this),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:n,height:u,radialSegments:m,heightSegments:_,openEnded:T,thetaStart:R,thetaLength:N},this.fromBufferGeometry(new ah(e,n,u,m,_,T,R,N)),this.mergeVertices()}function ah(e,n,u,m,_,T,R,N){function H(Ht){var $t,Yt=new f,ie=new w,Vt=0,ve=Ht===!0?e:n,Le=Ht===!0?1:-1,oe=at;for($t=1;$t<=m;$t++)K.push(0,Ft*Le,0),rt.push(0,Le,0),et.push(.5,.5),at++;var Pe=at;for($t=0;$t<=m;$t++){var Ie=$t/m*N+R,fr=Math.cos(Ie);Ie=Math.sin(Ie),ie.x=ve*Ie,ie.y=Ft*Le,ie.z=ve*fr,K.push(ie.x,ie.y,ie.z),rt.push(0,Le,0),Yt.x=.5*fr+.5,Yt.y=.5*Ie*Le+.5,et.push(Yt.x,Yt.y),at++}for($t=0;$t<m;$t++)Yt=oe+$t,ie=Pe+$t,Ht===!0?$.push(ie,ie+1,Yt):$.push(ie+1,ie,Yt),Vt+=3;W.addGroup(Wt,Vt,Ht===!0?1:2),Wt+=Vt}vt.call(this),this.type="CylinderBufferGeometry",this.parameters={radiusTop:e,radiusBottom:n,height:u,radialSegments:m,heightSegments:_,openEnded:T,thetaStart:R,thetaLength:N};var W=this;e=e!==void 0?e:1,n=n!==void 0?n:1,u=u||1,m=Math.floor(m)||8,_=Math.floor(_)||1,T=T!==void 0?T:!1,R=R!==void 0?R:0,N=N!==void 0?N:2*Math.PI;var $=[],K=[],rt=[],et=[],at=0,mt=[],Ft=u/2,Wt=0;(function(){var Ht,$t,Yt=new w,ie=new w,Vt=0,ve=(n-e)/u;for($t=0;$t<=_;$t++){var Le=[],oe=$t/_,Pe=oe*(n-e)+e;for(Ht=0;Ht<=m;Ht++){var Ie=Ht/m,fr=Ie*N+R,Lr=Math.sin(fr);fr=Math.cos(fr),ie.x=Pe*Lr,ie.y=-oe*u+Ft,ie.z=Pe*fr,K.push(ie.x,ie.y,ie.z),Yt.set(Lr,ve,fr).normalize(),rt.push(Yt.x,Yt.y,Yt.z),et.push(Ie,1-oe),Le.push(at++)}mt.push(Le)}for(Ht=0;Ht<m;Ht++)for($t=0;$t<_;$t++)Yt=mt[$t+1][Ht],ie=mt[$t+1][Ht+1],ve=mt[$t][Ht+1],$.push(mt[$t][Ht],Yt,ve),$.push(Yt,ie,ve),Vt+=6;W.addGroup(Wt,Vt,0),Wt+=Vt})(),T===!1&&(0<e&&H(!0),0<n&&H(!1)),this.setIndex($),this.setAttribute("position",new _t(K,3)),this.setAttribute("normal",new _t(rt,3)),this.setAttribute("uv",new _t(et,2))}function u0(e,n,u,m,_,T,R){Mp.call(this,0,e,n,u,m,_,T,R),this.type="ConeGeometry",this.parameters={radius:e,height:n,radialSegments:u,heightSegments:m,openEnded:_,thetaStart:T,thetaLength:R}}function l0(e,n,u,m,_,T,R){ah.call(this,0,e,n,u,m,_,T,R),this.type="ConeBufferGeometry",this.parameters={radius:e,height:n,radialSegments:u,heightSegments:m,openEnded:_,thetaStart:T,thetaLength:R}}function h0(e,n,u,m){yt.call(this),this.type="CircleGeometry",this.parameters={radius:e,segments:n,thetaStart:u,thetaLength:m},this.fromBufferGeometry(new mm(e,n,u,m)),this.mergeVertices()}function mm(e,n,u,m){vt.call(this),this.type="CircleBufferGeometry",this.parameters={radius:e,segments:n,thetaStart:u,thetaLength:m},e=e||1,n=n!==void 0?Math.max(3,n):8,u=u!==void 0?u:0,m=m!==void 0?m:2*Math.PI;var _=[],T=[],R=[],N=[],H,W=new w,$=new f;T.push(0,0,0),R.push(0,0,1),N.push(.5,.5);var K=0;for(H=3;K<=n;K++,H+=3){var rt=u+K/n*m;W.x=e*Math.cos(rt),W.y=e*Math.sin(rt),T.push(W.x,W.y,W.z),R.push(0,0,1),$.x=(T[H]/e+1)/2,$.y=(T[H+1]/e+1)/2,N.push($.x,$.y)}for(H=1;H<=n;H++)_.push(H,H+1,0);this.setIndex(_),this.setAttribute("position",new _t(T,3)),this.setAttribute("normal",new _t(R,3)),this.setAttribute("uv",new _t(N,2))}function Cp(e){Qt.call(this),this.type="ShadowMaterial",this.color=new wt(0),this.transparent=!0,this.setValues(e)}function uh(e){ue.call(this,e),this.type="RawShaderMaterial"}function il(e){Qt.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new wt(16777215),this.roughness=1,this.metalness=0,this.lightMap=this.map=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new wt(0),this.emissiveIntensity=1,this.bumpMap=this.emissiveMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new f(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.envMap=this.alphaMap=this.metalnessMap=this.roughnessMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinejoin=this.wireframeLinecap="round",this.vertexTangents=this.morphNormals=this.morphTargets=this.skinning=!1,this.setValues(e)}function Tp(e){il.call(this),this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoat=0,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new f(1,1),this.clearcoatNormalMap=null,this.reflectivity=.5,this.sheen=null,this.transparency=0,this.setValues(e)}function Ec(e){Qt.call(this),this.type="MeshPhongMaterial",this.color=new wt(16777215),this.specular=new wt(1118481),this.shininess=30,this.lightMap=this.map=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new wt(0),this.emissiveIntensity=1,this.bumpMap=this.emissiveMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new f(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.envMap=this.alphaMap=this.specularMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinejoin=this.wireframeLinecap="round",this.morphNormals=this.morphTargets=this.skinning=!1,this.setValues(e)}function Sp(e){Qt.call(this),this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new wt(16777215),this.specular=new wt(1118481),this.shininess=30,this.lightMap=this.gradientMap=this.map=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new wt(0),this.emissiveIntensity=1,this.bumpMap=this.emissiveMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new f(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=this.specularMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinejoin=this.wireframeLinecap="round",this.morphNormals=this.morphTargets=this.skinning=!1,this.setValues(e)}function Ip(e){Qt.call(this),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new f(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.morphNormals=this.morphTargets=this.skinning=this.fog=!1,this.setValues(e)}function Ep(e){Qt.call(this),this.type="MeshLambertMaterial",this.color=new wt(16777215),this.lightMap=this.map=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new wt(0),this.emissiveIntensity=1,this.envMap=this.alphaMap=this.specularMap=this.emissiveMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinejoin=this.wireframeLinecap="round",this.morphNormals=this.morphTargets=this.skinning=!1,this.setValues(e)}function Lp(e){Qt.call(this),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new wt(16777215),this.bumpMap=this.map=this.matcap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new f(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.morphNormals=this.morphTargets=this.skinning=!1,this.setValues(e)}function Rp(e){gn.call(this),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}function Xs(e,n,u,m){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=m!==void 0?m:new n.constructor(u),this.sampleValues=n,this.valueSize=u}function yx(e,n,u,m){Xs.call(this,e,n,u,m),this._offsetNext=this._weightNext=this._offsetPrev=this._weightPrev=-0}function c0(e,n,u,m){Xs.call(this,e,n,u,m)}function xx(e,n,u,m){Xs.call(this,e,n,u,m)}function So(e,n,u,m){if(e===void 0)throw Error("THREE.KeyframeTrack: track name is undefined");if(n===void 0||n.length===0)throw Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=vn.convertArray(n,this.TimeBufferType),this.values=vn.convertArray(u,this.ValueBufferType),this.setInterpolation(m||this.DefaultInterpolation)}function Ax(e,n,u){So.call(this,e,n,u)}function _x(e,n,u,m){So.call(this,e,n,u,m)}function gm(e,n,u,m){So.call(this,e,n,u,m)}function wx(e,n,u,m){Xs.call(this,e,n,u,m)}function f0(e,n,u,m){So.call(this,e,n,u,m)}function Mx(e,n,u,m){So.call(this,e,n,u,m)}function vm(e,n,u,m){So.call(this,e,n,u,m)}function Ca(e,n,u,m){this.name=e,this.tracks=u,this.duration=n!==void 0?n:-1,this.blendMode=m!==void 0?m:2500,this.uuid=ni.generateUUID(),0>this.duration&&this.resetDuration()}function P5(e){switch(e.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return gm;case"vector":case"vector2":case"vector3":case"vector4":return vm;case"color":return _x;case"quaternion":return f0;case"bool":case"boolean":return Ax;case"string":return Mx}throw Error("THREE.KeyframeTrack: Unsupported typeName: "+e)}function D5(e){if(e.type===void 0)throw Error("THREE.KeyframeTrack: track type undefined, can not parse");var n=P5(e.type);if(e.times===void 0){var u=[],m=[];vn.flattenJSON(e.keys,u,m,"value"),e.times=u,e.values=m}return n.parse!==void 0?n.parse(e):new n(e.name,e.times,e.values,e.interpolation)}function q_(e,n,u){var m=this,_=!1,T=0,R=0,N=void 0,H=[];this.onStart=void 0,this.onLoad=e,this.onProgress=n,this.onError=u,this.itemStart=function(W){R++,_===!1&&m.onStart!==void 0&&m.onStart(W,T,R),_=!0},this.itemEnd=function(W){T++,m.onProgress!==void 0&&m.onProgress(W,T,R),T===R&&(_=!1,m.onLoad!==void 0)&&m.onLoad()},this.itemError=function(W){m.onError!==void 0&&m.onError(W)},this.resolveURL=function(W){return N?N(W):W},this.setURLModifier=function(W){return N=W,this},this.addHandler=function(W,$){return H.push(W,$),this},this.removeHandler=function(W){return W=H.indexOf(W),W!==-1&&H.splice(W,2),this},this.getHandler=function(W){for(var $=0,K=H.length;$<K;$+=2){var rt=H[$],et=H[$+1];if(rt.global&&(rt.lastIndex=0),rt.test(W))return et}return null}}function Gi(e){this.manager=e!==void 0?e:kT,this.crossOrigin="anonymous",this.resourcePath=this.path="",this.requestHeader={}}function Ta(e){Gi.call(this,e)}function J_(e){Gi.call(this,e)}function Q_(e){Gi.call(this,e)}function Cx(e){Gi.call(this,e)}function ym(e){Gi.call(this,e)}function Tx(e){Gi.call(this,e)}function Sx(e){Gi.call(this,e)}function Br(){this.type="Curve",this.arcLengthDivisions=200}function Ys(e,n,u,m,_,T,R,N){Br.call(this),this.type="EllipseCurve",this.aX=e||0,this.aY=n||0,this.xRadius=u||1,this.yRadius=m||1,this.aStartAngle=_||0,this.aEndAngle=T||2*Math.PI,this.aClockwise=R||!1,this.aRotation=N||0}function xm(e,n,u,m,_,T){Ys.call(this,e,n,u,u,m,_,T),this.type="ArcCurve"}function K_(){var e=0,n=0,u=0,m=0;return{initCatmullRom:function(_,T,R,N,H){_=H*(R-_),N=H*(N-T),e=T,n=_,u=-3*T+3*R-2*_-N,m=2*T-2*R+_+N},initNonuniformCatmullRom:function(_,T,R,N,H,W,$){_=((T-_)/H-(R-_)/(H+W)+(R-T)/W)*W,N=((R-T)/W-(N-T)/(W+$)+(N-R)/$)*W,e=T,n=_,u=-3*T+3*R-2*_-N,m=2*T-2*R+_+N},calc:function(_){var T=_*_;return e+n*_+u*T+m*T*_}}}function Ho(e,n,u,m){Br.call(this),this.type="CatmullRomCurve3",this.points=e||[],this.closed=n||!1,this.curveType=u||"centripetal",this.tension=m||.5}function q3(e,n,u,m,_){n=.5*(m-n),_=.5*(_-u);var T=e*e;return(2*u-2*m+n+_)*e*T+(-3*u+3*m-2*n-_)*T+n*e+u}function p0(e,n,u,m){var _=1-e;return _*_*n+2*(1-e)*e*u+e*e*m}function d0(e,n,u,m,_){var T=1-e,R=1-e;return T*T*T*n+3*R*R*e*u+3*(1-e)*e*e*m+e*e*e*_}function hu(e,n,u,m){Br.call(this),this.type="CubicBezierCurve",this.v0=e||new f,this.v1=n||new f,this.v2=u||new f,this.v3=m||new f}function nl(e,n,u,m){Br.call(this),this.type="CubicBezierCurve3",this.v0=e||new w,this.v1=n||new w,this.v2=u||new w,this.v3=m||new w}function Ts(e,n){Br.call(this),this.type="LineCurve",this.v1=e||new f,this.v2=n||new f}function cu(e,n){Br.call(this),this.type="LineCurve3",this.v1=e||new w,this.v2=n||new w}function fu(e,n,u){Br.call(this),this.type="QuadraticBezierCurve",this.v0=e||new f,this.v1=n||new f,this.v2=u||new f}function ol(e,n,u){Br.call(this),this.type="QuadraticBezierCurve3",this.v0=e||new w,this.v1=n||new w,this.v2=u||new w}function pu(e){Br.call(this),this.type="SplineCurve",this.points=e||[]}function lh(){Br.call(this),this.type="CurvePath",this.curves=[],this.autoClose=!1}function du(e){lh.call(this),this.type="Path",this.currentPoint=new f,e&&this.setFromPoints(e)}function Lc(e){du.call(this,e),this.uuid=ni.generateUUID(),this.type="Shape",this.holes=[]}function un(e,n){F.call(this),this.type="Light",this.color=new wt(e),this.intensity=n!==void 0?n:1,this.receiveShadow=void 0}function Ix(e,n,u){un.call(this,e,u),this.type="HemisphereLight",this.castShadow=void 0,this.position.copy(F.DefaultUp),this.updateMatrix(),this.groundColor=new wt(n)}function sl(e){this.camera=e,this.bias=0,this.radius=1,this.mapSize=new f(512,512),this.mapPass=this.map=null,this.matrix=new I,this._frustum=new Qe,this._frameExtents=new f(1,1),this._viewportCount=1,this._viewports=[new p(0,0,1,1)]}function Ex(){sl.call(this,new Ae(50,1,.5,500))}function Lx(e,n,u,m,_,T){un.call(this,e,n),this.type="SpotLight",this.position.copy(F.DefaultUp),this.updateMatrix(),this.target=new F,Object.defineProperty(this,"power",{get:function(){return this.intensity*Math.PI},set:function(R){this.intensity=R/Math.PI}}),this.distance=u!==void 0?u:0,this.angle=m!==void 0?m:Math.PI/3,this.penumbra=_!==void 0?_:0,this.decay=T!==void 0?T:1,this.shadow=new Ex}function $_(){sl.call(this,new Ae(90,1,.5,500)),this._frameExtents=new f(4,2),this._viewportCount=6,this._viewports=[new p(2,1,1,1),new p(0,1,1,1),new p(3,1,1,1),new p(1,1,1,1),new p(3,0,1,1),new p(1,0,1,1)],this._cubeDirections=[new w(1,0,0),new w(-1,0,0),new w(0,0,1),new w(0,0,-1),new w(0,1,0),new w(0,-1,0)],this._cubeUps=[new w(0,1,0),new w(0,1,0),new w(0,1,0),new w(0,1,0),new w(0,0,1),new w(0,0,-1)]}function Rx(e,n,u,m){un.call(this,e,n),this.type="PointLight",Object.defineProperty(this,"power",{get:function(){return 4*this.intensity*Math.PI},set:function(_){this.intensity=_/(4*Math.PI)}}),this.distance=u!==void 0?u:0,this.decay=m!==void 0?m:1,this.shadow=new $_}function Am(e,n,u,m,_,T){te.call(this),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e!==void 0?e:-1,this.right=n!==void 0?n:1,this.top=u!==void 0?u:1,this.bottom=m!==void 0?m:-1,this.near=_!==void 0?_:.1,this.far=T!==void 0?T:2e3,this.updateProjectionMatrix()}function Px(){sl.call(this,new Am(-5,5,5,-5,.5,500))}function Dx(e,n){un.call(this,e,n),this.type="DirectionalLight",this.position.copy(F.DefaultUp),this.updateMatrix(),this.target=new F,this.shadow=new Px}function Ox(e,n){un.call(this,e,n),this.type="AmbientLight",this.castShadow=void 0}function Fx(e,n,u,m){un.call(this,e,n),this.type="RectAreaLight",this.width=u!==void 0?u:10,this.height=m!==void 0?m:10}function Bx(){this.coefficients=[];for(var e=0;9>e;e++)this.coefficients.push(new w)}function Sa(e,n){un.call(this,void 0,n),this.type="LightProbe",this.sh=e!==void 0?e:new Bx}function zx(e){Gi.call(this,e),this.textures={}}function m0(){vt.call(this),this.type="InstancedBufferGeometry",this.instanceCount=1/0}function Nx(e,n,u,m){typeof u=="number"&&(m=u,u=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),re.call(this,e,n,u),this.meshPerAttribute=m||1}function Ux(e){Gi.call(this,e)}function bx(e){Gi.call(this,e)}function tw(e){typeof createImageBitmap=="undefined"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch=="undefined"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),Gi.call(this,e),this.options=void 0}function ew(){this.type="ShapePath",this.color=new wt,this.subPaths=[],this.currentPath=null}function rw(e){this.type="Font",this.data=e}function iw(e){Gi.call(this,e)}function kx(e){Gi.call(this,e)}function nw(e,n,u){Sa.call(this,void 0,u),e=new wt().set(e),u=new wt().set(n),n=new w(e.r,e.g,e.b),e=new w(u.r,u.g,u.b),u=Math.sqrt(Math.PI);var m=u*Math.sqrt(.75);this.sh.coefficients[0].copy(n).add(e).multiplyScalar(u),this.sh.coefficients[1].copy(n).sub(e).multiplyScalar(m)}function ow(e,n){Sa.call(this,void 0,n),e=new wt().set(e),this.sh.coefficients[0].set(e.r,e.g,e.b).multiplyScalar(2*Math.sqrt(Math.PI))}function J3(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new Ae,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new Ae,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}function sw(e){this.autoStart=e!==void 0?e:!0,this.elapsedTime=this.oldTime=this.startTime=0,this.running=!1}function aw(){F.call(this),this.type="AudioListener",this.context=qw.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new sw}function _m(e){F.call(this),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.offset=this.loopEnd=this.loopStart=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.sourceType="empty",this._progress=this._startedAt=0,this.filters=[]}function uw(e){_m.call(this,e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}function lw(e,n){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=n!==void 0?n:2048,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}function hw(e,n,u){switch(this.binding=e,this.valueSize=u,n){case"quaternion":e=this._slerp,n=this._slerpAdditive;var m=this._setAdditiveIdentityQuaternion;this.buffer=new Float64Array(6*u),this._workIndex=5;break;case"string":case"bool":n=e=this._select,m=this._setAdditiveIdentityOther,this.buffer=Array(5*u);break;default:e=this._lerp,n=this._lerpAdditive,m=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*u)}this._mixBufferRegion=e,this._mixBufferRegionAdditive=n,this._setIdentity=m,this._origIndex=3,this._addIndex=4,this.referenceCount=this.useCount=this.cumulativeWeightAdditive=this.cumulativeWeight=0}function Q3(e,n,u){u=u||Go.parseTrackName(n),this._targetGroup=e,this._bindings=e.subscribe_(n,u)}function Go(e,n,u){this.path=n,this.parsedPath=u||Go.parseTrackName(n),this.node=Go.findNode(e,this.parsedPath.nodeName)||e,this.rootNode=e}function K3(){this.uuid=ni.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;var e={};this._indicesByUUID=e;for(var n=0,u=arguments.length;n!==u;++n)e[arguments[n].uuid]=n;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};var m=this;this.stats={objects:{get total(){return m._objects.length},get inUse(){return this.total-m.nCachedObjects_}},get bindingsPerObject(){return m._bindings.length}}}function $3(e,n,u,m){this._mixer=e,this._clip=n,this._localRoot=u||null,this.blendMode=m||n.blendMode,e=n.tracks,n=e.length,u=Array(n),m={endingStart:2400,endingEnd:2400};for(var _=0;_!==n;++_){var T=e[_].createInterpolant(null);u[_]=T,T.settings=m}this._interpolantSettings=m,this._interpolants=u,this._propertyBindings=Array(n),this._weightInterpolant=this._timeScaleInterpolant=this._byClipCacheIndex=this._cacheIndex=null,this.loop=2201,this._loopCount=-1,this._startTime=null,this.time=0,this._effectiveWeight=this.weight=this._effectiveTimeScale=this.timeScale=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtEnd=this.zeroSlopeAtStart=!0}function cw(e){this._root=e,this._initMemoryManager(),this.time=this._accuIndex=0,this.timeScale=1}function Hx(e,n){typeof e=="string"&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),e=n),this.value=e}function fw(e,n,u){sh.call(this,e,n),this.meshPerAttribute=u||1}function pw(e,n,u,m){this.ray=new lt(e,n),this.near=u||0,this.far=m||1/0,this.camera=null,this.layers=new P,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}},Or(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})}function tT(e,n){return e.distance-n.distance}function dw(e,n,u,m){if(e.layers.test(n.layers)&&e.raycast(n,u),m===!0){e=e.children,m=0;for(var _=e.length;m<_;m++)dw(e[m],n,u,!0)}}function eT(e,n,u){return this.radius=e!==void 0?e:1,this.phi=n!==void 0?n:0,this.theta=u!==void 0?u:0,this}function rT(e,n,u){return this.radius=e!==void 0?e:1,this.theta=n!==void 0?n:0,this.y=u!==void 0?u:0,this}function mw(e,n){this.min=e!==void 0?e:new f(1/0,1/0),this.max=n!==void 0?n:new f(-1/0,-1/0)}function gw(e,n){this.start=e!==void 0?e:new w,this.end=n!==void 0?n:new w}function g0(e){F.call(this),this.material=e,this.render=function(){},this.hasUvs=this.hasColors=this.hasNormals=this.hasPositions=!1,this.uvArray=this.colorArray=this.normalArray=this.positionArray=null,this.count=0}function wm(e,n){F.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,e=new vt,n=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(var u=0,m=1;32>u;u++,m++){var _=u/32*Math.PI*2,T=m/32*Math.PI*2;n.push(Math.cos(_),Math.sin(_),1,Math.cos(T),Math.sin(T),1)}e.setAttribute("position",new _t(n,3)),n=new gn({fog:!1,toneMapped:!1}),this.cone=new In(e,n),this.add(this.cone),this.update()}function iT(e){var n=[];e&&e.isBone&&n.push(e);for(var u=0;u<e.children.length;u++)n.push.apply(n,iT(e.children[u]));return n}function Pp(e){for(var n=iT(e),u=new vt,m=[],_=[],T=new wt(0,0,1),R=new wt(0,1,0),N=0;N<n.length;N++){var H=n[N];H.parent&&H.parent.isBone&&(m.push(0,0,0),m.push(0,0,0),_.push(T.r,T.g,T.b),_.push(R.r,R.g,R.b))}u.setAttribute("position",new _t(m,3)),u.setAttribute("color",new _t(_,3)),m=new gn({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0}),In.call(this,u,m),this.type="SkeletonHelper",this.root=e,this.bones=n,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}function Mm(e,n,u){this.light=e,this.light.updateMatrixWorld(),this.color=u,e=new Ap(n,4,2),n=new De({wireframe:!0,fog:!1,toneMapped:!1}),Pt.call(this,e,n),this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}function Cm(e,n,u){F.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=u,e=new vp(n),e.rotateY(.5*Math.PI),this.material=new De({wireframe:!0,fog:!1,toneMapped:!1}),this.color===void 0&&(this.material.vertexColors=!0),n=e.getAttribute("position"),n=new Float32Array(3*n.count),e.setAttribute("color",new re(n,3)),this.add(new Pt(e,this.material)),this.update()}function Gx(e,n,u,m){e=e||10,n=n||10,u=new wt(u!==void 0?u:4473924),m=new wt(m!==void 0?m:8947848);var _=n/2,T=e/n,R=e/2;e=[];for(var N=[],H=0,W=0,$=-R;H<=n;H++,$+=T){e.push(-R,0,$,R,0,$),e.push($,0,-R,$,0,R);var K=H===_?u:m;K.toArray(N,W),W+=3,K.toArray(N,W),W+=3,K.toArray(N,W),W+=3,K.toArray(N,W),W+=3}n=new vt,n.setAttribute("position",new _t(e,3)),n.setAttribute("color",new _t(N,3)),u=new gn({vertexColors:!0,toneMapped:!1}),In.call(this,n,u),this.type="GridHelper"}function Vx(e,n,u,m,_,T){e=e||10,n=n||16,u=u||8,m=m||64,_=new wt(_!==void 0?_:4473924),T=new wt(T!==void 0?T:8947848);var R=[],N=[],H;for(H=0;H<=n;H++){var W=H/n*2*Math.PI,$=Math.sin(W)*e;W=Math.cos(W)*e,R.push(0,0,0),R.push($,0,W);var K=H&1?_:T;N.push(K.r,K.g,K.b),N.push(K.r,K.g,K.b)}for(H=0;H<=u;H++){K=H&1?_:T;var rt=e-e/u*H;for(n=0;n<m;n++)W=n/m*2*Math.PI,$=Math.sin(W)*rt,W=Math.cos(W)*rt,R.push($,0,W),N.push(K.r,K.g,K.b),W=(n+1)/m*2*Math.PI,$=Math.sin(W)*rt,W=Math.cos(W)*rt,R.push($,0,W),N.push(K.r,K.g,K.b)}e=new vt,e.setAttribute("position",new _t(R,3)),e.setAttribute("color",new _t(N,3)),R=new gn({vertexColors:!0,toneMapped:!1}),In.call(this,e,R),this.type="PolarGridHelper"}function Tm(e,n,u){F.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=u,n===void 0&&(n=1),e=new vt,e.setAttribute("position",new _t([-n,n,0,n,n,0,n,-n,0,-n,-n,0,-n,n,0],3)),n=new gn({fog:!1,toneMapped:!1}),this.lightPlane=new js(e,n),this.add(this.lightPlane),e=new vt,e.setAttribute("position",new _t([0,0,0,0,0,1],3)),this.targetLine=new js(e,n),this.add(this.targetLine),this.update()}function v0(e){function n(et,at,mt){u(et,mt),u(at,mt)}function u(et,at){T.push(0,0,0),R.push(at.r,at.g,at.b),N[et]===void 0&&(N[et]=[]),N[et].push(T.length/3-1)}var m=new vt,_=new gn({color:16777215,vertexColors:!0,toneMapped:!1}),T=[],R=[],N={},H=new wt(16755200),W=new wt(16711680),$=new wt(43775),K=new wt(16777215),rt=new wt(3355443);n("n1","n2",H),n("n2","n4",H),n("n4","n3",H),n("n3","n1",H),n("f1","f2",H),n("f2","f4",H),n("f4","f3",H),n("f3","f1",H),n("n1","f1",H),n("n2","f2",H),n("n3","f3",H),n("n4","f4",H),n("p","n1",W),n("p","n2",W),n("p","n3",W),n("p","n4",W),n("u1","u2",$),n("u2","u3",$),n("u3","u1",$),n("c","t",K),n("p","c",rt),n("cn1","cn2",rt),n("cn3","cn4",rt),n("cf1","cf2",rt),n("cf3","cf4",rt),m.setAttribute("position",new _t(T,3)),m.setAttribute("color",new _t(R,3)),In.call(this,m,_),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=N,this.update()}function Yn(e,n,u,m,_,T,R){if(y2.set(_,T,R).unproject(m),e=n[e],e!==void 0)for(u=u.getAttribute("position"),n=0,m=e.length;n<m;n++)u.setXYZ(e[n],y2.x,y2.y,y2.z)}function hh(e,n){this.object=e,n===void 0&&(n=16776960),e=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]);var u=new Float32Array(24),m=new vt;m.setIndex(new re(e,1)),m.setAttribute("position",new re(u,3)),In.call(this,m,new gn({color:n,toneMapped:!1})),this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}function y0(e,n){this.type="Box3Helper",this.box=e,n=n||16776960,e=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]);var u=new vt;u.setIndex(new re(e,1)),u.setAttribute("position",new _t([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),In.call(this,u,new gn({color:n,toneMapped:!1})),this.type="Box3Helper",this.geometry.computeBoundingSphere()}function x0(e,n,u){this.plane=e,this.size=n===void 0?1:n,e=u!==void 0?u:16776960,n=new vt,n.setAttribute("position",new _t([1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],3)),n.computeBoundingSphere(),js.call(this,n,new gn({color:e,toneMapped:!1})),this.type="PlaneHelper",n=new vt,n.setAttribute("position",new _t([1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],3)),n.computeBoundingSphere(),this.add(new Pt(n,new De({color:e,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}function ch(e,n,u,m,_,T){F.call(this),this.type="ArrowHelper",e===void 0&&(e=new w(0,0,1)),n===void 0&&(n=new w(0,0,0)),u===void 0&&(u=1),m===void 0&&(m=16776960),_===void 0&&(_=.2*u),T===void 0&&(T=.2*_),A2===void 0&&(A2=new vt,A2.setAttribute("position",new _t([0,0,0,0,1,0],3)),Qw=new ah(0,.5,1,5,1),Qw.translate(0,-.5,0)),this.position.copy(n),this.line=new js(A2,new gn({color:m,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new Pt(Qw,new De({color:m,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(u,_,T)}function A0(e){e=e||1;var n=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e];e=new vt,e.setAttribute("position",new _t(n,3)),e.setAttribute("color",new _t([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3)),n=new gn({vertexColors:!0,toneMapped:!1}),In.call(this,e,n),this.type="AxesHelper"}function vw(e){this._renderer=e,this._pingPongRenderTarget=null,e=new Float32Array(20);var n=new w(0,1,0);e=new uh({defines:{n:20},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:e},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:n},inputEncoding:{value:cl[3e3]},outputEncoding:{value:cl[3e3]}},vertexShader:xw(),fragmentShader:`
precision mediump float;
precision mediump int;
varying vec3 vOutputDirection;
uniform sampler2D envMap;
uniform int samples;
uniform float weights[n];
uniform bool latitudinal;
uniform float dTheta;
uniform float mipInt;
uniform vec3 poleAxis;

`+Aw()+`

#define ENVMAP_TYPE_CUBE_UV
#include <cube_uv_reflection_fragment>

vec3 getSample(float theta, vec3 axis) {
	float cosTheta = cos(theta);
	// Rodrigues' axis-angle rotation
	vec3 sampleDirection = vOutputDirection * cosTheta
		+ cross(axis, vOutputDirection) * sin(theta)
		+ axis * dot(axis, vOutputDirection) * (1.0 - cosTheta);
	return bilinearCubeUV(envMap, sampleDirection, mipInt);
}

void main() {
	vec3 axis = latitudinal ? poleAxis : cross(poleAxis, vOutputDirection);
	if (all(equal(axis, vec3(0.0))))
		axis = vec3(vOutputDirection.z, 0.0, - vOutputDirection.x);
	axis = normalize(axis);
	gl_FragColor = vec4(0.0);
	gl_FragColor.rgb += weights[0] * getSample(0.0, axis);
	for (int i = 1; i < n; i++) {
		if (i >= samples)
			break;
		float theta = dTheta * float(i);
		gl_FragColor.rgb += weights[i] * getSample(-1.0 * theta, axis);
		gl_FragColor.rgb += weights[i] * getSample(theta, axis);
	}
	gl_FragColor = linearToOutputTexel(gl_FragColor);
}
		`,blending:0,depthTest:!1,depthWrite:!1}),e.type="SphericalGaussianBlur",this._blurMaterial=e,this._cubemapShader=this._equirectShader=null,this._compileMaterial(this._blurMaterial)}function nT(e){return e=new A(3*hl,3*hl,e),e.texture.mapping=306,e.texture.name="PMREM.cubeUv",e.scissorTest=!0,e}function yw(e,n,u,m,_){e.viewport.set(n,u,m,_),e.scissor.set(n,u,m,_)}function oT(){var e=new f(1,1);return e=new uh({uniforms:{envMap:{value:null},texelSize:{value:e},inputEncoding:{value:cl[3e3]},outputEncoding:{value:cl[3e3]}},vertexShader:xw(),fragmentShader:`
precision mediump float;
precision mediump int;
varying vec3 vOutputDirection;
uniform sampler2D envMap;
uniform vec2 texelSize;

`+Aw()+`

#include <common>

void main() {
	gl_FragColor = vec4(0.0);
	vec3 outputDirection = normalize(vOutputDirection);
	vec2 uv = equirectUv( outputDirection );
	vec2 f = fract(uv / texelSize - 0.5);
	uv -= f * texelSize;
	vec3 tl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;
	uv.x += texelSize.x;
	vec3 tr = envMapTexelToLinear(texture2D(envMap, uv)).rgb;
	uv.y += texelSize.y;
	vec3 br = envMapTexelToLinear(texture2D(envMap, uv)).rgb;
	uv.x -= texelSize.x;
	vec3 bl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;
	vec3 tm = mix(tl, tr, f.x);
	vec3 bm = mix(bl, br, f.x);
	gl_FragColor.rgb = mix(tm, bm, f.y);
	gl_FragColor = linearToOutputTexel(gl_FragColor);
}
		`,blending:0,depthTest:!1,depthWrite:!1}),e.type="EquirectangularToCubeUV",e}function sT(){var e=new uh({uniforms:{envMap:{value:null},inputEncoding:{value:cl[3e3]},outputEncoding:{value:cl[3e3]}},vertexShader:xw(),fragmentShader:`
precision mediump float;
precision mediump int;
varying vec3 vOutputDirection;
uniform samplerCube envMap;

`+Aw()+`

void main() {
	gl_FragColor = vec4(0.0);
	gl_FragColor.rgb = envMapTexelToLinear(textureCube(envMap, vec3( - vOutputDirection.x, vOutputDirection.yz ))).rgb;
	gl_FragColor = linearToOutputTexel(gl_FragColor);
}
		`,blending:0,depthTest:!1,depthWrite:!1});return e.type="CubemapToCubeUV",e}function xw(){return`
precision mediump float;
precision mediump int;
attribute vec3 position;
attribute vec2 uv;
attribute float faceIndex;
varying vec3 vOutputDirection;

// RH coordinate system; PMREM face-indexing convention
vec3 getDirection(vec2 uv, float face) {
	uv = 2.0 * uv - 1.0;
	vec3 direction = vec3(uv, 1.0);
	if (face == 0.0) {
		direction = direction.zyx; // ( 1, v, u ) pos x
	} else if (face == 1.0) {
		direction = direction.xzy;
		direction.xz *= -1.0; // ( -u, 1, -v ) pos y
	} else if (face == 2.0) {
		direction.x *= -1.0; // ( -u, v, 1 ) pos z
	} else if (face == 3.0) {
		direction = direction.zyx;
		direction.xz *= -1.0; // ( -1, v, -u ) neg x
	} else if (face == 4.0) {
		direction = direction.xzy;
		direction.xy *= -1.0; // ( -u, -1, v ) neg y
	} else if (face == 5.0) {
		direction.z *= -1.0; // ( u, v, -1 ) neg z
	}
	return direction;
}

void main() {
	vOutputDirection = getDirection(uv, faceIndex);
	gl_Position = vec4( position, 1.0 );
}
	`}function Aw(){return`
uniform int inputEncoding;
uniform int outputEncoding;

#include <encodings_pars_fragment>

vec4 inputTexelToLinear(vec4 value){
	if(inputEncoding == 0){
		return value;
	}else if(inputEncoding == 1){
		return sRGBToLinear(value);
	}else if(inputEncoding == 2){
		return RGBEToLinear(value);
	}else if(inputEncoding == 3){
		return RGBMToLinear(value, 7.0);
	}else if(inputEncoding == 4){
		return RGBMToLinear(value, 16.0);
	}else if(inputEncoding == 5){
		return RGBDToLinear(value, 256.0);
	}else{
		return GammaToLinear(value, 2.2);
	}
}

vec4 linearToOutputTexel(vec4 value){
	if(outputEncoding == 0){
		return value;
	}else if(outputEncoding == 1){
		return LinearTosRGB(value);
	}else if(outputEncoding == 2){
		return LinearToRGBE(value);
	}else if(outputEncoding == 3){
		return LinearToRGBM(value, 7.0);
	}else if(outputEncoding == 4){
		return LinearToRGBM(value, 16.0);
	}else if(outputEncoding == 5){
		return LinearToRGBD(value, 256.0);
	}else{
		return LinearToGamma(value, 2.2);
	}
}

vec4 envMapTexelToLinear(vec4 color) {
	return inputTexelToLinear(color);
}
	`}function aT(e){console.warn("THREE.ClosedSplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),Ho.call(this,e),this.type="catmullrom",this.closed=!0}function uT(e){console.warn("THREE.SplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),Ho.call(this,e),this.type="catmullrom"}function _w(e){console.warn("THREE.Spline has been removed. Use THREE.CatmullRomCurve3 instead."),Ho.call(this,e),this.type="catmullrom"}an===void 0&&(Number.EPSILON=Math.pow(2,-52)),fc===void 0&&(Number.isInteger=function(e){return typeof e=="number"&&isFinite(e)&&Math.floor(e)===e}),Qu===void 0&&(Math.sign=function(e){return 0>e?-1:0<e?1:+e}),!("name"in Function.prototype)&&Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*([^\(\s]*)/)[1]}}),pt===void 0&&(Object.assign=function(e){if(e==null)throw new TypeError("Cannot convert undefined or null to object");for(var n=Object(e),u=1;u<arguments.length;u++){var m=arguments[u];if(m!=null)for(var _ in m)Object.prototype.hasOwnProperty.call(m,_)&&(n[_]=m[_])}return n}),pt(s.prototype,{addEventListener:function(e,n){this._listeners===void 0&&(this._listeners={});var u=this._listeners;u[e]===void 0&&(u[e]=[]),u[e].indexOf(n)===-1&&u[e].push(n)},hasEventListener:function(e,n){if(this._listeners===void 0)return!1;var u=this._listeners;return u[e]!==void 0&&u[e].indexOf(n)!==-1},removeEventListener:function(e,n){this._listeners!==void 0&&(e=this._listeners[e],e!==void 0&&(n=e.indexOf(n),n!==-1&&e.splice(n,1)))},dispatchEvent:function(e){if(this._listeners!==void 0){var n=this._listeners[e.type];if(n!==void 0){e.target=this,n=n.slice(0);for(var u=0,m=n.length;u<m;u++)n[u].call(this,e)}}}});for(var Io=[],_0=0;256>_0;_0++)Io[_0]=(16>_0?"0":"")+_0.toString(16);var ni={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){var e=4294967295*Math.random()|0,n=4294967295*Math.random()|0,u=4294967295*Math.random()|0,m=4294967295*Math.random()|0;return(Io[e&255]+Io[e>>8&255]+Io[e>>16&255]+Io[e>>24&255]+"-"+Io[n&255]+Io[n>>8&255]+"-"+Io[n>>16&15|64]+Io[n>>24&255]+"-"+Io[u&63|128]+Io[u>>8&255]+"-"+Io[u>>16&255]+Io[u>>24&255]+Io[m&255]+Io[m>>8&255]+Io[m>>16&255]+Io[m>>24&255]).toUpperCase()},clamp:function(e,n,u){return Math.max(n,Math.min(u,e))},euclideanModulo:function(e,n){return(e%n+n)%n},mapLinear:function(e,n,u,m,_){return m+(e-n)*(_-m)/(u-n)},lerp:function(e,n,u){return(1-u)*e+u*n},smoothstep:function(e,n,u){return e<=n?0:e>=u?1:(e=(e-n)/(u-n),e*e*(3-2*e))},smootherstep:function(e,n,u){return e<=n?0:e>=u?1:(e=(e-n)/(u-n),e*e*e*(e*(6*e-15)+10))},randInt:function(e,n){return e+Math.floor(Math.random()*(n-e+1))},randFloat:function(e,n){return e+Math.random()*(n-e)},randFloatSpread:function(e){return e*(.5-Math.random())},degToRad:function(e){return e*ni.DEG2RAD},radToDeg:function(e){return e*ni.RAD2DEG},isPowerOfTwo:function(e){return(e&e-1)===0&&e!==0},ceilPowerOfTwo:function(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},floorPowerOfTwo:function(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))},setQuaternionFromProperEuler:function(e,n,u,m,_){var T=Math.cos,R=Math.sin,N=T(u/2);u=R(u/2);var H=T((n+m)/2),W=R((n+m)/2),$=T((n-m)/2),K=R((n-m)/2);switch(T=T((m-n)/2),n=R((m-n)/2),_){case"XYX":e.set(N*W,u*$,u*K,N*H);break;case"YZY":e.set(u*K,N*W,u*$,N*H);break;case"ZXZ":e.set(u*$,u*K,N*W,N*H);break;case"XZX":e.set(N*W,u*n,u*T,N*H);break;case"YXY":e.set(u*T,N*W,u*n,N*H);break;case"ZYZ":e.set(u*n,u*T,N*W,N*H);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+_)}}};Or(f.prototype,{width:{get:function(){return this.x},set:function(e){this.x=e}},height:{get:function(){return this.y},set:function(e){this.y=e}}}),pt(f.prototype,{isVector2:!0,set:function(e,n){return this.x=e,this.y=n,this},setScalar:function(e){return this.y=this.x=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setComponent:function(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;default:throw Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(e){return this.x=e.x,this.y=e.y,this},add:function(e,n){return n!==void 0?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,n)):(this.x+=e.x,this.y+=e.y,this)},addScalar:function(e){return this.x+=e,this.y+=e,this},addVectors:function(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this},addScaledVector:function(e,n){return this.x+=e.x*n,this.y+=e.y*n,this},sub:function(e,n){return n!==void 0?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,n)):(this.x-=e.x,this.y-=e.y,this)},subScalar:function(e){return this.x-=e,this.y-=e,this},subVectors:function(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this},multiply:function(e){return this.x*=e.x,this.y*=e.y,this},multiplyScalar:function(e){return this.x*=e,this.y*=e,this},divide:function(e){return this.x/=e.x,this.y/=e.y,this},divideScalar:function(e){return this.multiplyScalar(1/e)},applyMatrix3:function(e){var n=this.x,u=this.y;return e=e.elements,this.x=e[0]*n+e[3]*u+e[6],this.y=e[1]*n+e[4]*u+e[7],this},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this},clamp:function(e,n){return this.x=Math.max(e.x,Math.min(n.x,this.x)),this.y=Math.max(e.y,Math.min(n.y,this.y)),this},clampScalar:function(e,n){return this.x=Math.max(e,Math.min(n,this.x)),this.y=Math.max(e,Math.min(n,this.y)),this},clampLength:function(e,n){var u=this.length();return this.divideScalar(u||1).multiplyScalar(Math.max(e,Math.min(n,u)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x),this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(e){return this.x*e.x+this.y*e.y},cross:function(e){return this.x*e.y-this.y*e.x},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length()||1)},angle:function(){return Math.atan2(-this.y,-this.x)+Math.PI},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var n=this.x-e.x;return e=this.y-e.y,n*n+e*e},manhattanDistanceTo:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this},lerpVectors:function(e,n,u){return this.x=e.x+(n.x-e.x)*u,this.y=e.y+(n.y-e.y)*u,this},equals:function(e){return e.x===this.x&&e.y===this.y},fromArray:function(e,n){return n===void 0&&(n=0),this.x=e[n],this.y=e[n+1],this},toArray:function(e,n){return e===void 0&&(e=[]),n===void 0&&(n=0),e[n]=this.x,e[n+1]=this.y,e},fromBufferAttribute:function(e,n,u){return u!==void 0&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(n),this.y=e.getY(n),this},rotateAround:function(e,n){var u=Math.cos(n);n=Math.sin(n);var m=this.x-e.x,_=this.y-e.y;return this.x=m*u-_*n+e.x,this.y=m*n+_*u+e.y,this},random:function(){return this.x=Math.random(),this.y=Math.random(),this}}),pt(c.prototype,{isMatrix3:!0,set:function(e,n,u,m,_,T,R,N,H){var W=this.elements;return W[0]=e,W[1]=m,W[2]=R,W[3]=n,W[4]=_,W[5]=N,W[6]=u,W[7]=T,W[8]=H,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return new this.constructor().fromArray(this.elements)},copy:function(e){var n=this.elements;return e=e.elements,n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[4]=e[4],n[5]=e[5],n[6]=e[6],n[7]=e[7],n[8]=e[8],this},extractBasis:function(e,n,u){return e.setFromMatrix3Column(this,0),n.setFromMatrix3Column(this,1),u.setFromMatrix3Column(this,2),this},setFromMatrix4:function(e){return e=e.elements,this.set(e[0],e[4],e[8],e[1],e[5],e[9],e[2],e[6],e[10]),this},multiply:function(e){return this.multiplyMatrices(this,e)},premultiply:function(e){return this.multiplyMatrices(e,this)},multiplyMatrices:function(e,n){var u=e.elements,m=n.elements;n=this.elements,e=u[0];var _=u[3],T=u[6],R=u[1],N=u[4],H=u[7],W=u[2],$=u[5];u=u[8];var K=m[0],rt=m[3],et=m[6],at=m[1],mt=m[4],Ft=m[7],Wt=m[2],Ht=m[5];return m=m[8],n[0]=e*K+_*at+T*Wt,n[3]=e*rt+_*mt+T*Ht,n[6]=e*et+_*Ft+T*m,n[1]=R*K+N*at+H*Wt,n[4]=R*rt+N*mt+H*Ht,n[7]=R*et+N*Ft+H*m,n[2]=W*K+$*at+u*Wt,n[5]=W*rt+$*mt+u*Ht,n[8]=W*et+$*Ft+u*m,this},multiplyScalar:function(e){var n=this.elements;return n[0]*=e,n[3]*=e,n[6]*=e,n[1]*=e,n[4]*=e,n[7]*=e,n[2]*=e,n[5]*=e,n[8]*=e,this},determinant:function(){var e=this.elements,n=e[0],u=e[1],m=e[2],_=e[3],T=e[4],R=e[5],N=e[6],H=e[7];return e=e[8],n*T*e-n*R*H-u*_*e+u*R*N+m*_*H-m*T*N},getInverse:function(e,n){n!==void 0&&console.warn("THREE.Matrix3: .getInverse() can no longer be configured to throw on degenerate.");var u=e.elements;e=this.elements,n=u[0];var m=u[1],_=u[2],T=u[3],R=u[4],N=u[5],H=u[6],W=u[7];u=u[8];var $=u*R-N*W,K=N*H-u*T,rt=W*T-R*H,et=n*$+m*K+_*rt;return et===0?this.set(0,0,0,0,0,0,0,0,0):(et=1/et,e[0]=$*et,e[1]=(_*W-u*m)*et,e[2]=(N*m-_*R)*et,e[3]=K*et,e[4]=(u*n-_*H)*et,e[5]=(_*T-N*n)*et,e[6]=rt*et,e[7]=(m*H-W*n)*et,e[8]=(R*n-m*T)*et,this)},transpose:function(){var e=this.elements,n=e[1];return e[1]=e[3],e[3]=n,n=e[2],e[2]=e[6],e[6]=n,n=e[5],e[5]=e[7],e[7]=n,this},getNormalMatrix:function(e){return this.setFromMatrix4(e).getInverse(this).transpose()},transposeIntoArray:function(e){var n=this.elements;return e[0]=n[0],e[1]=n[3],e[2]=n[6],e[3]=n[1],e[4]=n[4],e[5]=n[7],e[6]=n[2],e[7]=n[5],e[8]=n[8],this},setUvTransform:function(e,n,u,m,_,T,R){var N=Math.cos(_);_=Math.sin(_),this.set(u*N,u*_,-u*(N*T+_*R)+T+e,-m*_,m*N,-m*(-_*T+N*R)+R+n,0,0,1)},scale:function(e,n){var u=this.elements;return u[0]*=e,u[3]*=e,u[6]*=e,u[1]*=n,u[4]*=n,u[7]*=n,this},rotate:function(e){var n=Math.cos(e);e=Math.sin(e);var u=this.elements,m=u[0],_=u[3],T=u[6],R=u[1],N=u[4],H=u[7];return u[0]=n*m+e*R,u[3]=n*_+e*N,u[6]=n*T+e*H,u[1]=-e*m+n*R,u[4]=-e*_+n*N,u[7]=-e*T+n*H,this},translate:function(e,n){var u=this.elements;return u[0]+=e*u[2],u[3]+=e*u[5],u[6]+=e*u[8],u[1]+=n*u[2],u[4]+=n*u[5],u[7]+=n*u[8],this},equals:function(e){var n=this.elements;e=e.elements;for(var u=0;9>u;u++)if(n[u]!==e[u])return!1;return!0},fromArray:function(e,n){n===void 0&&(n=0);for(var u=0;9>u;u++)this.elements[u]=e[u+n];return this},toArray:function(e,n){e===void 0&&(e=[]),n===void 0&&(n=0);var u=this.elements;return e[n]=u[0],e[n+1]=u[1],e[n+2]=u[2],e[n+3]=u[3],e[n+4]=u[4],e[n+5]=u[5],e[n+6]=u[6],e[n+7]=u[7],e[n+8]=u[8],e}});var Sm,Rc={getDataURL:function(e){if(typeof HTMLCanvasElement=="undefined")return e.src;if(!(e instanceof HTMLCanvasElement)){Sm===void 0&&(Sm=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")),Sm.width=e.width,Sm.height=e.height;var n=Sm.getContext("2d");e instanceof ImageData?n.putImageData(e,0,0):n.drawImage(e,0,0,e.width,e.height),e=Sm}return 2048<e.width||2048<e.height?e.toDataURL("image/jpeg",.6):e.toDataURL("image/png")}},O5=0;d.DEFAULT_IMAGE=void 0,d.DEFAULT_MAPPING=300,d.prototype=pt(ft(s.prototype),{constructor:d,isTexture:!0,updateMatrix:function(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.name=e.name,this.image=e.image,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this},toJSON:function(e){var n=e===void 0||typeof e=="string";if(!n&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];var u={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(this.image!==void 0){var m=this.image;if(m.uuid===void 0&&(m.uuid=ni.generateUUID()),!n&&e.images[m.uuid]===void 0){if(Array.isArray(m))for(var _=[],T=0,R=m.length;T<R;T++)_.push(Rc.getDataURL(m[T]));else _=Rc.getDataURL(m);e.images[m.uuid]={uuid:m.uuid,url:_}}u.image=m.uuid}return n||(e.textures[this.uuid]=u),u},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(e){if(this.mapping!==300)return e;if(e.applyMatrix3(this.matrix),0>e.x||1<e.x)switch(this.wrapS){case 1e3:e.x-=Math.floor(e.x);break;case 1001:e.x=0>e.x?0:1;break;case 1002:e.x=Math.abs(Math.floor(e.x)%2)===1?Math.ceil(e.x)-e.x:e.x-Math.floor(e.x)}if(0>e.y||1<e.y)switch(this.wrapT){case 1e3:e.y-=Math.floor(e.y);break;case 1001:e.y=0>e.y?0:1;break;case 1002:e.y=Math.abs(Math.floor(e.y)%2)===1?Math.ceil(e.y)-e.y:e.y-Math.floor(e.y)}return this.flipY&&(e.y=1-e.y),e}}),Object.defineProperty(d.prototype,"needsUpdate",{set:function(e){e===!0&&this.version++}}),Or(p.prototype,{width:{get:function(){return this.z},set:function(e){this.z=e}},height:{get:function(){return this.w},set:function(e){this.w=e}}}),pt(p.prototype,{isVector4:!0,set:function(e,n,u,m){return this.x=e,this.y=n,this.z=u,this.w=m,this},setScalar:function(e){return this.w=this.z=this.y=this.x=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setZ:function(e){return this.z=e,this},setW:function(e){return this.w=e,this},setComponent:function(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;case 2:this.z=n;break;case 3:this.w=n;break;default:throw Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this},add:function(e,n){return n!==void 0?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,n)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this)},addScalar:function(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this},addVectors:function(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this.z=e.z+n.z,this.w=e.w+n.w,this},addScaledVector:function(e,n){return this.x+=e.x*n,this.y+=e.y*n,this.z+=e.z*n,this.w+=e.w*n,this},sub:function(e,n){return n!==void 0?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,n)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this)},subScalar:function(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this},subVectors:function(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this.z=e.z-n.z,this.w=e.w-n.w,this},multiplyScalar:function(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this},applyMatrix4:function(e){var n=this.x,u=this.y,m=this.z,_=this.w;return e=e.elements,this.x=e[0]*n+e[4]*u+e[8]*m+e[12]*_,this.y=e[1]*n+e[5]*u+e[9]*m+e[13]*_,this.z=e[2]*n+e[6]*u+e[10]*m+e[14]*_,this.w=e[3]*n+e[7]*u+e[11]*m+e[15]*_,this},divideScalar:function(e){return this.multiplyScalar(1/e)},setAxisAngleFromQuaternion:function(e){this.w=2*Math.acos(e.w);var n=Math.sqrt(1-e.w*e.w);return 1e-4>n?(this.x=1,this.z=this.y=0):(this.x=e.x/n,this.y=e.y/n,this.z=e.z/n),this},setAxisAngleFromRotationMatrix:function(e){e=e.elements;var n=e[0],u=e[4],m=e[8],_=e[1],T=e[5],R=e[9],N=e[2],H=e[6],W=e[10];return .01>Math.abs(u-_)&&.01>Math.abs(m-N)&&.01>Math.abs(R-H)?.1>Math.abs(u+_)&&.1>Math.abs(m+N)&&.1>Math.abs(R+H)&&.1>Math.abs(n+T+W-3)?(this.set(1,0,0,0),this):(e=Math.PI,n=(n+1)/2,T=(T+1)/2,W=(W+1)/2,u=(u+_)/4,m=(m+N)/4,R=(R+H)/4,n>T&&n>W?.01>n?(H=0,u=N=.707106781):(H=Math.sqrt(n),N=u/H,u=m/H):T>W?.01>T?(H=.707106781,N=0,u=.707106781):(N=Math.sqrt(T),H=u/N,u=R/N):.01>W?(N=H=.707106781,u=0):(u=Math.sqrt(W),H=m/u,N=R/u),this.set(H,N,u,e),this):(e=Math.sqrt((H-R)*(H-R)+(m-N)*(m-N)+(_-u)*(_-u)),.001>Math.abs(e)&&(e=1),this.x=(H-R)/e,this.y=(m-N)/e,this.z=(_-u)/e,this.w=Math.acos((n+T+W-1)/2),this)},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this},clamp:function(e,n){return this.x=Math.max(e.x,Math.min(n.x,this.x)),this.y=Math.max(e.y,Math.min(n.y,this.y)),this.z=Math.max(e.z,Math.min(n.z,this.z)),this.w=Math.max(e.w,Math.min(n.w,this.w)),this},clampScalar:function(e,n){return this.x=Math.max(e,Math.min(n,this.x)),this.y=Math.max(e,Math.min(n,this.y)),this.z=Math.max(e,Math.min(n,this.z)),this.w=Math.max(e,Math.min(n,this.w)),this},clampLength:function(e,n){var u=this.length();return this.divideScalar(u||1).multiplyScalar(Math.max(e,Math.min(n,u)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x),this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y),this.z=0>this.z?Math.ceil(this.z):Math.floor(this.z),this.w=0>this.w?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this.z+=(e.z-this.z)*n,this.w+=(e.w-this.w)*n,this},lerpVectors:function(e,n,u){return this.x=e.x+(n.x-e.x)*u,this.y=e.y+(n.y-e.y)*u,this.z=e.z+(n.z-e.z)*u,this.w=e.w+(n.w-e.w)*u,this},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w},fromArray:function(e,n){return n===void 0&&(n=0),this.x=e[n],this.y=e[n+1],this.z=e[n+2],this.w=e[n+3],this},toArray:function(e,n){return e===void 0&&(e=[]),n===void 0&&(n=0),e[n]=this.x,e[n+1]=this.y,e[n+2]=this.z,e[n+3]=this.w,e},fromBufferAttribute:function(e,n,u){return u!==void 0&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(n),this.y=e.getY(n),this.z=e.getZ(n),this.w=e.getW(n),this},random:function(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}}),A.prototype=pt(ft(s.prototype),{constructor:A,isWebGLRenderTarget:!0,setSize:function(e,n){(this.width!==e||this.height!==n)&&(this.width=e,this.height=n,this.texture.image.width=e,this.texture.image.height=n,this.dispose()),this.viewport.set(0,0,e,n),this.scissor.set(0,0,e,n)},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.width=e.width,this.height=e.height,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.depthTexture=e.depthTexture,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),S.prototype=pt(ft(A.prototype),{constructor:S,isWebGLMultisampleRenderTarget:!0,copy:function(e){return A.prototype.copy.call(this,e),this.samples=e.samples,this}}),pt(z,{slerp:function(e,n,u,m){return u.copy(e).slerp(n,m)},slerpFlat:function(e,n,u,m,_,T,R){var N=u[m+0],H=u[m+1],W=u[m+2];u=u[m+3],m=_[T+0];var $=_[T+1],K=_[T+2];if(_=_[T+3],u!==_||N!==m||H!==$||W!==K){T=1-R;var rt=N*m+H*$+W*K+u*_,et=0<=rt?1:-1,at=1-rt*rt;at>an&&(at=Math.sqrt(at),rt=Math.atan2(at,rt*et),T=Math.sin(T*rt)/at,R=Math.sin(R*rt)/at),et*=R,N=N*T+m*et,H=H*T+$*et,W=W*T+K*et,u=u*T+_*et,T===1-R&&(R=1/Math.sqrt(N*N+H*H+W*W+u*u),N*=R,H*=R,W*=R,u*=R)}e[n]=N,e[n+1]=H,e[n+2]=W,e[n+3]=u},multiplyQuaternionsFlat:function(e,n,u,m,_,T){var R=u[m],N=u[m+1],H=u[m+2];u=u[m+3],m=_[T];var W=_[T+1],$=_[T+2];return _=_[T+3],e[n]=R*_+u*m+N*$-H*W,e[n+1]=N*_+u*W+H*m-R*$,e[n+2]=H*_+u*$+R*W-N*m,e[n+3]=u*_-R*m-N*W-H*$,e}}),Or(z.prototype,{x:{get:function(){return this._x},set:function(e){this._x=e,this._onChangeCallback()}},y:{get:function(){return this._y},set:function(e){this._y=e,this._onChangeCallback()}},z:{get:function(){return this._z},set:function(e){this._z=e,this._onChangeCallback()}},w:{get:function(){return this._w},set:function(e){this._w=e,this._onChangeCallback()}}}),pt(z.prototype,{isQuaternion:!0,set:function(e,n,u,m){return this._x=e,this._y=n,this._z=u,this._w=m,this._onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this},setFromEuler:function(e,n){if(!e||!e.isEuler)throw Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var u=e._x,m=e._y,_=e._z;e=e.order;var T=Math.cos,R=Math.sin,N=T(u/2),H=T(m/2);switch(T=T(_/2),u=R(u/2),m=R(m/2),_=R(_/2),e){case"XYZ":this._x=u*H*T+N*m*_,this._y=N*m*T-u*H*_,this._z=N*H*_+u*m*T,this._w=N*H*T-u*m*_;break;case"YXZ":this._x=u*H*T+N*m*_,this._y=N*m*T-u*H*_,this._z=N*H*_-u*m*T,this._w=N*H*T+u*m*_;break;case"ZXY":this._x=u*H*T-N*m*_,this._y=N*m*T+u*H*_,this._z=N*H*_+u*m*T,this._w=N*H*T-u*m*_;break;case"ZYX":this._x=u*H*T-N*m*_,this._y=N*m*T+u*H*_,this._z=N*H*_-u*m*T,this._w=N*H*T+u*m*_;break;case"YZX":this._x=u*H*T+N*m*_,this._y=N*m*T+u*H*_,this._z=N*H*_-u*m*T,this._w=N*H*T-u*m*_;break;case"XZY":this._x=u*H*T-N*m*_,this._y=N*m*T-u*H*_,this._z=N*H*_+u*m*T,this._w=N*H*T+u*m*_;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+e)}return n!==!1&&this._onChangeCallback(),this},setFromAxisAngle:function(e,n){n/=2;var u=Math.sin(n);return this._x=e.x*u,this._y=e.y*u,this._z=e.z*u,this._w=Math.cos(n),this._onChangeCallback(),this},setFromRotationMatrix:function(e){var n=e.elements,u=n[0];e=n[4];var m=n[8],_=n[1],T=n[5],R=n[9],N=n[2],H=n[6];n=n[10];var W=u+T+n;return 0<W?(u=.5/Math.sqrt(W+1),this._w=.25/u,this._x=(H-R)*u,this._y=(m-N)*u,this._z=(_-e)*u):u>T&&u>n?(u=2*Math.sqrt(1+u-T-n),this._w=(H-R)/u,this._x=.25*u,this._y=(e+_)/u,this._z=(m+N)/u):T>n?(u=2*Math.sqrt(1+T-u-n),this._w=(m-N)/u,this._x=(e+_)/u,this._y=.25*u,this._z=(R+H)/u):(u=2*Math.sqrt(1+n-u-T),this._w=(_-e)/u,this._x=(m+N)/u,this._y=(R+H)/u,this._z=.25*u),this._onChangeCallback(),this},setFromUnitVectors:function(e,n){var u=e.dot(n)+1;return 1e-6>u?(u=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0):(this._x=0,this._y=-e.z,this._z=e.y)):(this._x=e.y*n.z-e.z*n.y,this._y=e.z*n.x-e.x*n.z,this._z=e.x*n.y-e.y*n.x),this._w=u,this.normalize()},angleTo:function(e){return 2*Math.acos(Math.abs(ni.clamp(this.dot(e),-1,1)))},rotateTowards:function(e,n){var u=this.angleTo(e);return u===0?this:(this.slerp(e,Math.min(1,n/u)),this)},inverse:function(){return this.conjugate()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this},dot:function(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var e=this.length();return e===0?(this._z=this._y=this._x=0,this._w=1):(e=1/e,this._x*=e,this._y*=e,this._z*=e,this._w*=e),this._onChangeCallback(),this},multiply:function(e,n){return n!==void 0?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(e,n)):this.multiplyQuaternions(this,e)},premultiply:function(e){return this.multiplyQuaternions(e,this)},multiplyQuaternions:function(e,n){var u=e._x,m=e._y,_=e._z;e=e._w;var T=n._x,R=n._y,N=n._z;return n=n._w,this._x=u*n+e*T+m*N-_*R,this._y=m*n+e*R+_*T-u*N,this._z=_*n+e*N+u*R-m*T,this._w=e*n-u*T-m*R-_*N,this._onChangeCallback(),this},slerp:function(e,n){if(n===0)return this;if(n===1)return this.copy(e);var u=this._x,m=this._y,_=this._z,T=this._w,R=T*e._w+u*e._x+m*e._y+_*e._z;if(0>R?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,R=-R):this.copy(e),1<=R)return this._w=T,this._x=u,this._y=m,this._z=_,this;if(e=1-R*R,e<=an)return R=1-n,this._w=R*T+n*this._w,this._x=R*u+n*this._x,this._y=R*m+n*this._y,this._z=R*_+n*this._z,this.normalize(),this._onChangeCallback(),this;e=Math.sqrt(e);var N=Math.atan2(e,R);return R=Math.sin((1-n)*N)/e,n=Math.sin(n*N)/e,this._w=T*R+this._w*n,this._x=u*R+this._x*n,this._y=m*R+this._y*n,this._z=_*R+this._z*n,this._onChangeCallback(),this},equals:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w},fromArray:function(e,n){return n===void 0&&(n=0),this._x=e[n],this._y=e[n+1],this._z=e[n+2],this._w=e[n+3],this._onChangeCallback(),this},toArray:function(e,n){return e===void 0&&(e=[]),n===void 0&&(n=0),e[n]=this._x,e[n+1]=this._y,e[n+2]=this._z,e[n+3]=this._w,e},fromBufferAttribute:function(e,n){return this._x=e.getX(n),this._y=e.getY(n),this._z=e.getZ(n),this._w=e.getW(n),this},_onChange:function(e){return this._onChangeCallback=e,this},_onChangeCallback:function(){}});var ww=new w,lT=new z;pt(w.prototype,{isVector3:!0,set:function(e,n,u){return this.x=e,this.y=n,this.z=u,this},setScalar:function(e){return this.z=this.y=this.x=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setZ:function(e){return this.z=e,this},setComponent:function(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;case 2:this.z=n;break;default:throw Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this},add:function(e,n){return n!==void 0?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,n)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this)},addScalar:function(e){return this.x+=e,this.y+=e,this.z+=e,this},addVectors:function(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this.z=e.z+n.z,this},addScaledVector:function(e,n){return this.x+=e.x*n,this.y+=e.y*n,this.z+=e.z*n,this},sub:function(e,n){return n!==void 0?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,n)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this)},subScalar:function(e){return this.x-=e,this.y-=e,this.z-=e,this},subVectors:function(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this.z=e.z-n.z,this},multiply:function(e,n){return n!==void 0?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,n)):(this.x*=e.x,this.y*=e.y,this.z*=e.z,this)},multiplyScalar:function(e){return this.x*=e,this.y*=e,this.z*=e,this},multiplyVectors:function(e,n){return this.x=e.x*n.x,this.y=e.y*n.y,this.z=e.z*n.z,this},applyEuler:function(e){return e&&e.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(lT.setFromEuler(e))},applyAxisAngle:function(e,n){return this.applyQuaternion(lT.setFromAxisAngle(e,n))},applyMatrix3:function(e){var n=this.x,u=this.y,m=this.z;return e=e.elements,this.x=e[0]*n+e[3]*u+e[6]*m,this.y=e[1]*n+e[4]*u+e[7]*m,this.z=e[2]*n+e[5]*u+e[8]*m,this},applyNormalMatrix:function(e){return this.applyMatrix3(e).normalize()},applyMatrix4:function(e){var n=this.x,u=this.y,m=this.z;e=e.elements;var _=1/(e[3]*n+e[7]*u+e[11]*m+e[15]);return this.x=(e[0]*n+e[4]*u+e[8]*m+e[12])*_,this.y=(e[1]*n+e[5]*u+e[9]*m+e[13])*_,this.z=(e[2]*n+e[6]*u+e[10]*m+e[14])*_,this},applyQuaternion:function(e){var n=this.x,u=this.y,m=this.z,_=e.x,T=e.y,R=e.z;e=e.w;var N=e*n+T*m-R*u,H=e*u+R*n-_*m,W=e*m+_*u-T*n;return n=-_*n-T*u-R*m,this.x=N*e+n*-_+H*-R-W*-T,this.y=H*e+n*-T+W*-_-N*-R,this.z=W*e+n*-R+N*-T-H*-_,this},project:function(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)},unproject:function(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)},transformDirection:function(e){var n=this.x,u=this.y,m=this.z;return e=e.elements,this.x=e[0]*n+e[4]*u+e[8]*m,this.y=e[1]*n+e[5]*u+e[9]*m,this.z=e[2]*n+e[6]*u+e[10]*m,this.normalize()},divide:function(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this},divideScalar:function(e){return this.multiplyScalar(1/e)},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this},clamp:function(e,n){return this.x=Math.max(e.x,Math.min(n.x,this.x)),this.y=Math.max(e.y,Math.min(n.y,this.y)),this.z=Math.max(e.z,Math.min(n.z,this.z)),this},clampScalar:function(e,n){return this.x=Math.max(e,Math.min(n,this.x)),this.y=Math.max(e,Math.min(n,this.y)),this.z=Math.max(e,Math.min(n,this.z)),this},clampLength:function(e,n){var u=this.length();return this.divideScalar(u||1).multiplyScalar(Math.max(e,Math.min(n,u)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x),this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y),this.z=0>this.z?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this.z+=(e.z-this.z)*n,this},lerpVectors:function(e,n,u){return this.x=e.x+(n.x-e.x)*u,this.y=e.y+(n.y-e.y)*u,this.z=e.z+(n.z-e.z)*u,this},cross:function(e,n){return n!==void 0?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(e,n)):this.crossVectors(this,e)},crossVectors:function(e,n){var u=e.x,m=e.y;e=e.z;var _=n.x,T=n.y;return n=n.z,this.x=m*n-e*T,this.y=e*_-u*n,this.z=u*T-m*_,this},projectOnVector:function(e){var n=e.lengthSq();return n===0?this.set(0,0,0):(n=e.dot(this)/n,this.copy(e).multiplyScalar(n))},projectOnPlane:function(e){return ww.copy(this).projectOnVector(e),this.sub(ww)},reflect:function(e){return this.sub(ww.copy(e).multiplyScalar(2*this.dot(e)))},angleTo:function(e){var n=Math.sqrt(this.lengthSq()*e.lengthSq());return n===0?Math.PI/2:(e=this.dot(e)/n,Math.acos(ni.clamp(e,-1,1)))},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var n=this.x-e.x,u=this.y-e.y;return e=this.z-e.z,n*n+u*u+e*e},manhattanDistanceTo:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)},setFromSpherical:function(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)},setFromSphericalCoords:function(e,n,u){var m=Math.sin(n)*e;return this.x=m*Math.sin(u),this.y=Math.cos(n)*e,this.z=m*Math.cos(u),this},setFromCylindrical:function(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)},setFromCylindricalCoords:function(e,n,u){return this.x=e*Math.sin(n),this.y=u,this.z=e*Math.cos(n),this},setFromMatrixPosition:function(e){return e=e.elements,this.x=e[12],this.y=e[13],this.z=e[14],this},setFromMatrixScale:function(e){var n=this.setFromMatrixColumn(e,0).length(),u=this.setFromMatrixColumn(e,1).length();return e=this.setFromMatrixColumn(e,2).length(),this.x=n,this.y=u,this.z=e,this},setFromMatrixColumn:function(e,n){return this.fromArray(e.elements,4*n)},setFromMatrix3Column:function(e,n){return this.fromArray(e.elements,3*n)},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z},fromArray:function(e,n){return n===void 0&&(n=0),this.x=e[n],this.y=e[n+1],this.z=e[n+2],this},toArray:function(e,n){return e===void 0&&(e=[]),n===void 0&&(n=0),e[n]=this.x,e[n+1]=this.y,e[n+2]=this.z,e},fromBufferAttribute:function(e,n,u){return u!==void 0&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(n),this.y=e.getY(n),this.z=e.getZ(n),this},random:function(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}});var Im=new w,mu=new I,F5=new w(0,0,0),B5=new w(1,1,1),Pc=new w,Wx=new w,Zs=new w;pt(I.prototype,{isMatrix4:!0,set:function(e,n,u,m,_,T,R,N,H,W,$,K,rt,et,at,mt){var Ft=this.elements;return Ft[0]=e,Ft[4]=n,Ft[8]=u,Ft[12]=m,Ft[1]=_,Ft[5]=T,Ft[9]=R,Ft[13]=N,Ft[2]=H,Ft[6]=W,Ft[10]=$,Ft[14]=K,Ft[3]=rt,Ft[7]=et,Ft[11]=at,Ft[15]=mt,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return new I().fromArray(this.elements)},copy:function(e){var n=this.elements;return e=e.elements,n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[4]=e[4],n[5]=e[5],n[6]=e[6],n[7]=e[7],n[8]=e[8],n[9]=e[9],n[10]=e[10],n[11]=e[11],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],this},copyPosition:function(e){var n=this.elements;return e=e.elements,n[12]=e[12],n[13]=e[13],n[14]=e[14],this},extractBasis:function(e,n,u){return e.setFromMatrixColumn(this,0),n.setFromMatrixColumn(this,1),u.setFromMatrixColumn(this,2),this},makeBasis:function(e,n,u){return this.set(e.x,n.x,u.x,0,e.y,n.y,u.y,0,e.z,n.z,u.z,0,0,0,0,1),this},extractRotation:function(e){var n=this.elements,u=e.elements,m=1/Im.setFromMatrixColumn(e,0).length(),_=1/Im.setFromMatrixColumn(e,1).length();return e=1/Im.setFromMatrixColumn(e,2).length(),n[0]=u[0]*m,n[1]=u[1]*m,n[2]=u[2]*m,n[3]=0,n[4]=u[4]*_,n[5]=u[5]*_,n[6]=u[6]*_,n[7]=0,n[8]=u[8]*e,n[9]=u[9]*e,n[10]=u[10]*e,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this},makeRotationFromEuler:function(e){e&&e.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var n=this.elements,u=e.x,m=e.y,_=e.z,T=Math.cos(u);u=Math.sin(u);var R=Math.cos(m);m=Math.sin(m);var N=Math.cos(_);if(_=Math.sin(_),e.order==="XYZ"){e=T*N;var H=T*_,W=u*N,$=u*_;n[0]=R*N,n[4]=-R*_,n[8]=m,n[1]=H+W*m,n[5]=e-$*m,n[9]=-u*R,n[2]=$-e*m,n[6]=W+H*m,n[10]=T*R}else e.order==="YXZ"?(e=R*N,H=R*_,W=m*N,$=m*_,n[0]=e+$*u,n[4]=W*u-H,n[8]=T*m,n[1]=T*_,n[5]=T*N,n[9]=-u,n[2]=H*u-W,n[6]=$+e*u,n[10]=T*R):e.order==="ZXY"?(e=R*N,H=R*_,W=m*N,$=m*_,n[0]=e-$*u,n[4]=-T*_,n[8]=W+H*u,n[1]=H+W*u,n[5]=T*N,n[9]=$-e*u,n[2]=-T*m,n[6]=u,n[10]=T*R):e.order==="ZYX"?(e=T*N,H=T*_,W=u*N,$=u*_,n[0]=R*N,n[4]=W*m-H,n[8]=e*m+$,n[1]=R*_,n[5]=$*m+e,n[9]=H*m-W,n[2]=-m,n[6]=u*R,n[10]=T*R):e.order==="YZX"?(e=T*R,H=T*m,W=u*R,$=u*m,n[0]=R*N,n[4]=$-e*_,n[8]=W*_+H,n[1]=_,n[5]=T*N,n[9]=-u*N,n[2]=-m*N,n[6]=H*_+W,n[10]=e-$*_):e.order==="XZY"&&(e=T*R,H=T*m,W=u*R,$=u*m,n[0]=R*N,n[4]=-_,n[8]=m*N,n[1]=e*_+$,n[5]=T*N,n[9]=H*_-W,n[2]=W*_-H,n[6]=u*N,n[10]=$*_+e);return n[3]=0,n[7]=0,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this},makeRotationFromQuaternion:function(e){return this.compose(F5,e,B5)},lookAt:function(e,n,u){var m=this.elements;return Zs.subVectors(e,n),Zs.lengthSq()===0&&(Zs.z=1),Zs.normalize(),Pc.crossVectors(u,Zs),Pc.lengthSq()===0&&(Math.abs(u.z)===1?Zs.x+=1e-4:Zs.z+=1e-4,Zs.normalize(),Pc.crossVectors(u,Zs)),Pc.normalize(),Wx.crossVectors(Zs,Pc),m[0]=Pc.x,m[4]=Wx.x,m[8]=Zs.x,m[1]=Pc.y,m[5]=Wx.y,m[9]=Zs.y,m[2]=Pc.z,m[6]=Wx.z,m[10]=Zs.z,this},multiply:function(e,n){return n!==void 0?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(e,n)):this.multiplyMatrices(this,e)},premultiply:function(e){return this.multiplyMatrices(e,this)},multiplyMatrices:function(e,n){var u=e.elements,m=n.elements;n=this.elements,e=u[0];var _=u[4],T=u[8],R=u[12],N=u[1],H=u[5],W=u[9],$=u[13],K=u[2],rt=u[6],et=u[10],at=u[14],mt=u[3],Ft=u[7],Wt=u[11];u=u[15];var Ht=m[0],$t=m[4],Yt=m[8],ie=m[12],Vt=m[1],ve=m[5],Le=m[9],oe=m[13],Pe=m[2],Ie=m[6],fr=m[10],Lr=m[14],Ze=m[3],Sr=m[7],$r=m[11];return m=m[15],n[0]=e*Ht+_*Vt+T*Pe+R*Ze,n[4]=e*$t+_*ve+T*Ie+R*Sr,n[8]=e*Yt+_*Le+T*fr+R*$r,n[12]=e*ie+_*oe+T*Lr+R*m,n[1]=N*Ht+H*Vt+W*Pe+$*Ze,n[5]=N*$t+H*ve+W*Ie+$*Sr,n[9]=N*Yt+H*Le+W*fr+$*$r,n[13]=N*ie+H*oe+W*Lr+$*m,n[2]=K*Ht+rt*Vt+et*Pe+at*Ze,n[6]=K*$t+rt*ve+et*Ie+at*Sr,n[10]=K*Yt+rt*Le+et*fr+at*$r,n[14]=K*ie+rt*oe+et*Lr+at*m,n[3]=mt*Ht+Ft*Vt+Wt*Pe+u*Ze,n[7]=mt*$t+Ft*ve+Wt*Ie+u*Sr,n[11]=mt*Yt+Ft*Le+Wt*fr+u*$r,n[15]=mt*ie+Ft*oe+Wt*Lr+u*m,this},multiplyScalar:function(e){var n=this.elements;return n[0]*=e,n[4]*=e,n[8]*=e,n[12]*=e,n[1]*=e,n[5]*=e,n[9]*=e,n[13]*=e,n[2]*=e,n[6]*=e,n[10]*=e,n[14]*=e,n[3]*=e,n[7]*=e,n[11]*=e,n[15]*=e,this},determinant:function(){var e=this.elements,n=e[0],u=e[4],m=e[8],_=e[12],T=e[1],R=e[5],N=e[9],H=e[13],W=e[2],$=e[6],K=e[10],rt=e[14];return e[3]*(+_*N*$-m*H*$-_*R*K+u*H*K+m*R*rt-u*N*rt)+e[7]*(+n*N*rt-n*H*K+_*T*K-m*T*rt+m*H*W-_*N*W)+e[11]*(+n*H*$-n*R*rt-_*T*$+u*T*rt+_*R*W-u*H*W)+e[15]*(-m*R*W-n*N*$+n*R*K+m*T*$-u*T*K+u*N*W)},transpose:function(){var e=this.elements,n=e[1];return e[1]=e[4],e[4]=n,n=e[2],e[2]=e[8],e[8]=n,n=e[6],e[6]=e[9],e[9]=n,n=e[3],e[3]=e[12],e[12]=n,n=e[7],e[7]=e[13],e[13]=n,n=e[11],e[11]=e[14],e[14]=n,this},setPosition:function(e,n,u){var m=this.elements;return e.isVector3?(m[12]=e.x,m[13]=e.y,m[14]=e.z):(m[12]=e,m[13]=n,m[14]=u),this},getInverse:function(e,n){n!==void 0&&console.warn("THREE.Matrix4: .getInverse() can no longer be configured to throw on degenerate."),n=this.elements;var u=e.elements;e=u[0];var m=u[1],_=u[2],T=u[3],R=u[4],N=u[5],H=u[6],W=u[7],$=u[8],K=u[9],rt=u[10],et=u[11],at=u[12],mt=u[13],Ft=u[14];u=u[15];var Wt=K*Ft*W-mt*rt*W+mt*H*et-N*Ft*et-K*H*u+N*rt*u,Ht=at*rt*W-$*Ft*W-at*H*et+R*Ft*et+$*H*u-R*rt*u,$t=$*mt*W-at*K*W+at*N*et-R*mt*et-$*N*u+R*K*u,Yt=at*K*H-$*mt*H-at*N*rt+R*mt*rt+$*N*Ft-R*K*Ft,ie=e*Wt+m*Ht+_*$t+T*Yt;return ie===0?this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0):(ie=1/ie,n[0]=Wt*ie,n[1]=(mt*rt*T-K*Ft*T-mt*_*et+m*Ft*et+K*_*u-m*rt*u)*ie,n[2]=(N*Ft*T-mt*H*T+mt*_*W-m*Ft*W-N*_*u+m*H*u)*ie,n[3]=(K*H*T-N*rt*T-K*_*W+m*rt*W+N*_*et-m*H*et)*ie,n[4]=Ht*ie,n[5]=($*Ft*T-at*rt*T+at*_*et-e*Ft*et-$*_*u+e*rt*u)*ie,n[6]=(at*H*T-R*Ft*T-at*_*W+e*Ft*W+R*_*u-e*H*u)*ie,n[7]=(R*rt*T-$*H*T+$*_*W-e*rt*W-R*_*et+e*H*et)*ie,n[8]=$t*ie,n[9]=(at*K*T-$*mt*T-at*m*et+e*mt*et+$*m*u-e*K*u)*ie,n[10]=(R*mt*T-at*N*T+at*m*W-e*mt*W-R*m*u+e*N*u)*ie,n[11]=($*N*T-R*K*T-$*m*W+e*K*W+R*m*et-e*N*et)*ie,n[12]=Yt*ie,n[13]=($*mt*_-at*K*_+at*m*rt-e*mt*rt-$*m*Ft+e*K*Ft)*ie,n[14]=(at*N*_-R*mt*_-at*m*H+e*mt*H+R*m*Ft-e*N*Ft)*ie,n[15]=(R*K*_-$*N*_+$*m*H-e*K*H-R*m*rt+e*N*rt)*ie,this)},scale:function(e){var n=this.elements,u=e.x,m=e.y;return e=e.z,n[0]*=u,n[4]*=m,n[8]*=e,n[1]*=u,n[5]*=m,n[9]*=e,n[2]*=u,n[6]*=m,n[10]*=e,n[3]*=u,n[7]*=m,n[11]*=e,this},getMaxScaleOnAxis:function(){var e=this.elements;return Math.sqrt(Math.max(e[0]*e[0]+e[1]*e[1]+e[2]*e[2],e[4]*e[4]+e[5]*e[5]+e[6]*e[6],e[8]*e[8]+e[9]*e[9]+e[10]*e[10]))},makeTranslation:function(e,n,u){return this.set(1,0,0,e,0,1,0,n,0,0,1,u,0,0,0,1),this},makeRotationX:function(e){var n=Math.cos(e);return e=Math.sin(e),this.set(1,0,0,0,0,n,-e,0,0,e,n,0,0,0,0,1),this},makeRotationY:function(e){var n=Math.cos(e);return e=Math.sin(e),this.set(n,0,e,0,0,1,0,0,-e,0,n,0,0,0,0,1),this},makeRotationZ:function(e){var n=Math.cos(e);return e=Math.sin(e),this.set(n,-e,0,0,e,n,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(e,n){var u=Math.cos(n);n=Math.sin(n);var m=1-u,_=e.x,T=e.y;e=e.z;var R=m*_,N=m*T;return this.set(R*_+u,R*T-n*e,R*e+n*T,0,R*T+n*e,N*T+u,N*e-n*_,0,R*e-n*T,N*e+n*_,m*e*e+u,0,0,0,0,1),this},makeScale:function(e,n,u){return this.set(e,0,0,0,0,n,0,0,0,0,u,0,0,0,0,1),this},makeShear:function(e,n,u){return this.set(1,n,u,0,e,1,u,0,e,n,1,0,0,0,0,1),this},compose:function(e,n,u){var m=this.elements,_=n._x,T=n._y,R=n._z,N=n._w,H=_+_,W=T+T,$=R+R;n=_*H;var K=_*W;_*=$;var rt=T*W;T*=$,R*=$,H*=N,W*=N,N*=$,$=u.x;var et=u.y;return u=u.z,m[0]=(1-(rt+R))*$,m[1]=(K+N)*$,m[2]=(_-W)*$,m[3]=0,m[4]=(K-N)*et,m[5]=(1-(n+R))*et,m[6]=(T+H)*et,m[7]=0,m[8]=(_+W)*u,m[9]=(T-H)*u,m[10]=(1-(n+rt))*u,m[11]=0,m[12]=e.x,m[13]=e.y,m[14]=e.z,m[15]=1,this},decompose:function(e,n,u){var m=this.elements,_=Im.set(m[0],m[1],m[2]).length(),T=Im.set(m[4],m[5],m[6]).length(),R=Im.set(m[8],m[9],m[10]).length();0>this.determinant()&&(_=-_),e.x=m[12],e.y=m[13],e.z=m[14],mu.copy(this),e=1/_,m=1/T;var N=1/R;return mu.elements[0]*=e,mu.elements[1]*=e,mu.elements[2]*=e,mu.elements[4]*=m,mu.elements[5]*=m,mu.elements[6]*=m,mu.elements[8]*=N,mu.elements[9]*=N,mu.elements[10]*=N,n.setFromRotationMatrix(mu),u.x=_,u.y=T,u.z=R,this},makePerspective:function(e,n,u,m,_,T){T===void 0&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");var R=this.elements;return R[0]=2*_/(n-e),R[4]=0,R[8]=(n+e)/(n-e),R[12]=0,R[1]=0,R[5]=2*_/(u-m),R[9]=(u+m)/(u-m),R[13]=0,R[2]=0,R[6]=0,R[10]=-(T+_)/(T-_),R[14]=-2*T*_/(T-_),R[3]=0,R[7]=0,R[11]=-1,R[15]=0,this},makeOrthographic:function(e,n,u,m,_,T){var R=this.elements,N=1/(n-e),H=1/(u-m),W=1/(T-_);return R[0]=2*N,R[4]=0,R[8]=0,R[12]=-((n+e)*N),R[1]=0,R[5]=2*H,R[9]=0,R[13]=-((u+m)*H),R[2]=0,R[6]=0,R[10]=-2*W,R[14]=-((T+_)*W),R[3]=0,R[7]=0,R[11]=0,R[15]=1,this},equals:function(e){var n=this.elements;e=e.elements;for(var u=0;16>u;u++)if(n[u]!==e[u])return!1;return!0},fromArray:function(e,n){n===void 0&&(n=0);for(var u=0;16>u;u++)this.elements[u]=e[u+n];return this},toArray:function(e,n){e===void 0&&(e=[]),n===void 0&&(n=0);var u=this.elements;return e[n]=u[0],e[n+1]=u[1],e[n+2]=u[2],e[n+3]=u[3],e[n+4]=u[4],e[n+5]=u[5],e[n+6]=u[6],e[n+7]=u[7],e[n+8]=u[8],e[n+9]=u[9],e[n+10]=u[10],e[n+11]=u[11],e[n+12]=u[12],e[n+13]=u[13],e[n+14]=u[14],e[n+15]=u[15],e}});var hT=new I,cT=new z;E.RotationOrders="XYZ YZX ZXY XZY YXZ ZYX".split(" "),E.DefaultOrder="XYZ",Or(E.prototype,{x:{get:function(){return this._x},set:function(e){this._x=e,this._onChangeCallback()}},y:{get:function(){return this._y},set:function(e){this._y=e,this._onChangeCallback()}},z:{get:function(){return this._z},set:function(e){this._z=e,this._onChangeCallback()}},order:{get:function(){return this._order},set:function(e){this._order=e,this._onChangeCallback()}}}),pt(E.prototype,{isEuler:!0,set:function(e,n,u,m){return this._x=e,this._y=n,this._z=u,this._order=m||this._order,this._onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this},setFromRotationMatrix:function(e,n,u){var m=ni.clamp,_=e.elements;e=_[0];var T=_[4],R=_[8],N=_[1],H=_[5],W=_[9],$=_[2],K=_[6];switch(_=_[10],n=n||this._order,n){case"XYZ":this._y=Math.asin(m(R,-1,1)),.9999999>Math.abs(R)?(this._x=Math.atan2(-W,_),this._z=Math.atan2(-T,e)):(this._x=Math.atan2(K,H),this._z=0);break;case"YXZ":this._x=Math.asin(-m(W,-1,1)),.9999999>Math.abs(W)?(this._y=Math.atan2(R,_),this._z=Math.atan2(N,H)):(this._y=Math.atan2(-$,e),this._z=0);break;case"ZXY":this._x=Math.asin(m(K,-1,1)),.9999999>Math.abs(K)?(this._y=Math.atan2(-$,_),this._z=Math.atan2(-T,H)):(this._y=0,this._z=Math.atan2(N,e));break;case"ZYX":this._y=Math.asin(-m($,-1,1)),.9999999>Math.abs($)?(this._x=Math.atan2(K,_),this._z=Math.atan2(N,e)):(this._x=0,this._z=Math.atan2(-T,H));break;case"YZX":this._z=Math.asin(m(N,-1,1)),.9999999>Math.abs(N)?(this._x=Math.atan2(-W,H),this._y=Math.atan2(-$,e)):(this._x=0,this._y=Math.atan2(R,_));break;case"XZY":this._z=Math.asin(-m(T,-1,1)),.9999999>Math.abs(T)?(this._x=Math.atan2(K,H),this._y=Math.atan2(R,e)):(this._x=Math.atan2(-W,_),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+n)}return this._order=n,u!==!1&&this._onChangeCallback(),this},setFromQuaternion:function(e,n,u){return hT.makeRotationFromQuaternion(e),this.setFromRotationMatrix(hT,n,u)},setFromVector3:function(e,n){return this.set(e.x,e.y,e.z,n||this._order)},reorder:function(e){return cT.setFromEuler(this),this.setFromQuaternion(cT,e)},equals:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order},fromArray:function(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this},toArray:function(e,n){return e===void 0&&(e=[]),n===void 0&&(n=0),e[n]=this._x,e[n+1]=this._y,e[n+2]=this._z,e[n+3]=this._order,e},toVector3:function(e){return e?e.set(this._x,this._y,this._z):new w(this._x,this._y,this._z)},_onChange:function(e){return this._onChangeCallback=e,this},_onChangeCallback:function(){}}),pt(P.prototype,{set:function(e){this.mask=1<<e|0},enable:function(e){this.mask=this.mask|1<<e|0},enableAll:function(){this.mask=-1},toggle:function(e){this.mask^=1<<e|0},disable:function(e){this.mask&=~(1<<e|0)},disableAll:function(){this.mask=0},test:function(e){return(this.mask&e.mask)!==0}});var z5=0,fT=new w,Em=new z,fh=new I,jx=new w,w0=new w,N5=new w,U5=new z,pT=new w(1,0,0),dT=new w(0,1,0),mT=new w(0,0,1),b5={type:"added"},k5={type:"removed"};F.DefaultUp=new w(0,1,0),F.DefaultMatrixAutoUpdate=!0,F.prototype=pt(ft(s.prototype),{constructor:F,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix4:function(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(e){return this.quaternion.premultiply(e),this},setRotationFromAxisAngle:function(e,n){this.quaternion.setFromAxisAngle(e,n)},setRotationFromEuler:function(e){this.quaternion.setFromEuler(e,!0)},setRotationFromMatrix:function(e){this.quaternion.setFromRotationMatrix(e)},setRotationFromQuaternion:function(e){this.quaternion.copy(e)},rotateOnAxis:function(e,n){return Em.setFromAxisAngle(e,n),this.quaternion.multiply(Em),this},rotateOnWorldAxis:function(e,n){return Em.setFromAxisAngle(e,n),this.quaternion.premultiply(Em),this},rotateX:function(e){return this.rotateOnAxis(pT,e)},rotateY:function(e){return this.rotateOnAxis(dT,e)},rotateZ:function(e){return this.rotateOnAxis(mT,e)},translateOnAxis:function(e,n){return fT.copy(e).applyQuaternion(this.quaternion),this.position.add(fT.multiplyScalar(n)),this},translateX:function(e){return this.translateOnAxis(pT,e)},translateY:function(e){return this.translateOnAxis(dT,e)},translateZ:function(e){return this.translateOnAxis(mT,e)},localToWorld:function(e){return e.applyMatrix4(this.matrixWorld)},worldToLocal:function(e){return e.applyMatrix4(fh.getInverse(this.matrixWorld))},lookAt:function(e,n,u){e.isVector3?jx.copy(e):jx.set(e,n,u),e=this.parent,this.updateWorldMatrix(!0,!1),w0.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?fh.lookAt(w0,jx,this.up):fh.lookAt(jx,w0,this.up),this.quaternion.setFromRotationMatrix(fh),e&&(fh.extractRotation(e.matrixWorld),Em.setFromRotationMatrix(fh),this.quaternion.premultiply(Em.inverse()))},add:function(e){if(1<arguments.length){for(var n=0;n<arguments.length;n++)this.add(arguments[n]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.parent!==null&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(b5)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)},remove:function(e){if(1<arguments.length){for(var n=0;n<arguments.length;n++)this.remove(arguments[n]);return this}return n=this.children.indexOf(e),n!==-1&&(e.parent=null,this.children.splice(n,1),e.dispatchEvent(k5)),this},attach:function(e){return this.updateWorldMatrix(!0,!1),fh.getInverse(this.matrixWorld),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),fh.multiply(e.parent.matrixWorld)),e.applyMatrix4(fh),e.updateWorldMatrix(!1,!1),this.add(e),this},getObjectById:function(e){return this.getObjectByProperty("id",e)},getObjectByName:function(e){return this.getObjectByProperty("name",e)},getObjectByProperty:function(e,n){if(this[e]===n)return this;for(var u=0,m=this.children.length;u<m;u++){var _=this.children[u].getObjectByProperty(e,n);if(_!==void 0)return _}},getWorldPosition:function(e){return e===void 0&&(console.warn("THREE.Object3D: .getWorldPosition() target is now required"),e=new w),this.updateMatrixWorld(!0),e.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(e){return e===void 0&&(console.warn("THREE.Object3D: .getWorldQuaternion() target is now required"),e=new z),this.updateMatrixWorld(!0),this.matrixWorld.decompose(w0,e,N5),e},getWorldScale:function(e){return e===void 0&&(console.warn("THREE.Object3D: .getWorldScale() target is now required"),e=new w),this.updateMatrixWorld(!0),this.matrixWorld.decompose(w0,U5,e),e},getWorldDirection:function(e){e===void 0&&(console.warn("THREE.Object3D: .getWorldDirection() target is now required"),e=new w),this.updateMatrixWorld(!0);var n=this.matrixWorld.elements;return e.set(n[8],n[9],n[10]).normalize()},raycast:function(){},traverse:function(e){e(this);for(var n=this.children,u=0,m=n.length;u<m;u++)n[u].traverse(e)},traverseVisible:function(e){if(this.visible!==!1){e(this);for(var n=this.children,u=0,m=n.length;u<m;u++)n[u].traverseVisible(e)}},traverseAncestors:function(e){var n=this.parent;n!==null&&(e(n),n.traverseAncestors(e))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);for(var n=this.children,u=0,m=n.length;u<m;u++)n[u].updateMatrixWorld(e)},updateWorldMatrix:function(e,n){var u=this.parent;if(e===!0&&u!==null&&u.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),n===!0)for(e=this.children,n=0,u=e.length;n<u;n++)e[n].updateWorldMatrix(!1,!0)},toJSON:function(e){function n($,K){return $[K.uuid]===void 0&&($[K.uuid]=K.toJSON(e)),K.uuid}function u($){var K=[],rt;for(rt in $){var et=$[rt];delete et.metadata,K.push(et)}return K}var m=e===void 0||typeof e=="string",_={};m&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{}},_.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});var T={};if(T.uuid=this.uuid,T.type=this.type,this.name!==""&&(T.name=this.name),this.castShadow===!0&&(T.castShadow=!0),this.receiveShadow===!0&&(T.receiveShadow=!0),this.visible===!1&&(T.visible=!1),this.frustumCulled===!1&&(T.frustumCulled=!1),this.renderOrder!==0&&(T.renderOrder=this.renderOrder),Hs(this.userData)!=="{}"&&(T.userData=this.userData),T.layers=this.layers.mask,T.matrix=this.matrix.toArray(),this.matrixAutoUpdate===!1&&(T.matrixAutoUpdate=!1),this.isInstancedMesh&&(T.type="InstancedMesh",T.count=this.count,T.instanceMatrix=this.instanceMatrix.toJSON()),this.isMesh||this.isLine||this.isPoints){T.geometry=n(e.geometries,this.geometry);var R=this.geometry.parameters;if(R!==void 0&&R.shapes!==void 0)if(R=R.shapes,Array.isArray(R))for(var N=0,H=R.length;N<H;N++)n(e.shapes,R[N]);else n(e.shapes,R)}if(this.material!==void 0)if(Array.isArray(this.material)){for(R=[],N=0,H=this.material.length;N<H;N++)R.push(n(e.materials,this.material[N]));T.material=R}else T.material=n(e.materials,this.material);if(0<this.children.length)for(T.children=[],N=0;N<this.children.length;N++)T.children.push(this.children[N].toJSON(e).object);if(m){m=u(e.geometries),N=u(e.materials),H=u(e.textures);var W=u(e.images);R=u(e.shapes),0<m.length&&(_.geometries=m),0<N.length&&(_.materials=N),0<H.length&&(_.textures=H),0<W.length&&(_.images=W),0<R.length&&(_.shapes=R)}return _.object=T,_},clone:function(e){return new this.constructor().copy(this,e)},copy:function(e,n){if(n===void 0&&(n=!0),this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(Hs(e.userData)),n===!0)for(n=0;n<e.children.length;n++)this.add(e.children[n].clone());return this}}),X.prototype=pt(ft(F.prototype),{constructor:X,isScene:!0,copy:function(e,n){return F.prototype.copy.call(this,e,n),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.autoUpdate=e.autoUpdate,this.matrixAutoUpdate=e.matrixAutoUpdate,this},toJSON:function(e){var n=F.prototype.toJSON.call(this,e);return this.background!==null&&(n.object.background=this.background.toJSON(e)),this.environment!==null&&(n.object.environment=this.environment.toJSON(e)),this.fog!==null&&(n.object.fog=this.fog.toJSON()),n},dispose:function(){this.dispatchEvent({type:"dispose"})}});var ph=[new w,new w,new w,new w,new w,new w,new w,new w],M0=new w,Mw=new q,Lm=new w,Rm=new w,Pm=new w,Dc=new w,Oc=new w,Dp=new w,C0=new w,Xx=new w,Yx=new w,Op=new w;pt(q.prototype,{isBox3:!0,set:function(e,n){return this.min.copy(e),this.max.copy(n),this},setFromArray:function(e){for(var n=1/0,u=1/0,m=1/0,_=-1/0,T=-1/0,R=-1/0,N=0,H=e.length;N<H;N+=3){var W=e[N],$=e[N+1],K=e[N+2];W<n&&(n=W),$<u&&(u=$),K<m&&(m=K),W>_&&(_=W),$>T&&(T=$),K>R&&(R=K)}return this.min.set(n,u,m),this.max.set(_,T,R),this},setFromBufferAttribute:function(e){for(var n=1/0,u=1/0,m=1/0,_=-1/0,T=-1/0,R=-1/0,N=0,H=e.count;N<H;N++){var W=e.getX(N),$=e.getY(N),K=e.getZ(N);W<n&&(n=W),$<u&&(u=$),K<m&&(m=K),W>_&&(_=W),$>T&&(T=$),K>R&&(R=K)}return this.min.set(n,u,m),this.max.set(_,T,R),this},setFromPoints:function(e){this.makeEmpty();for(var n=0,u=e.length;n<u;n++)this.expandByPoint(e[n]);return this},setFromCenterAndSize:function(e,n){return n=M0.copy(n).multiplyScalar(.5),this.min.copy(e).sub(n),this.max.copy(e).add(n),this},setFromObject:function(e){return this.makeEmpty(),this.expandByObject(e)},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.min.copy(e.min),this.max.copy(e.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},getCenter:function(e){return e===void 0&&(console.warn("THREE.Box3: .getCenter() target is now required"),e=new w),this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(e){return e===void 0&&(console.warn("THREE.Box3: .getSize() target is now required"),e=new w),this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)},expandByPoint:function(e){return this.min.min(e),this.max.max(e),this},expandByVector:function(e){return this.min.sub(e),this.max.add(e),this},expandByScalar:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this},expandByObject:function(e){e.updateWorldMatrix(!1,!1);var n=e.geometry;n!==void 0&&(n.boundingBox===null&&n.computeBoundingBox(),Mw.copy(n.boundingBox),Mw.applyMatrix4(e.matrixWorld),this.union(Mw)),e=e.children,n=0;for(var u=e.length;n<u;n++)this.expandByObject(e[n]);return this},containsPoint:function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)},containsBox:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z},getParameter:function(e,n){return n===void 0&&(console.warn("THREE.Box3: .getParameter() target is now required"),n=new w),n.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))},intersectsBox:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)},intersectsSphere:function(e){return this.clampPoint(e.center,M0),M0.distanceToSquared(e.center)<=e.radius*e.radius},intersectsPlane:function(e){if(0<e.normal.x)var n=e.normal.x*this.min.x,u=e.normal.x*this.max.x;else n=e.normal.x*this.max.x,u=e.normal.x*this.min.x;return 0<e.normal.y?(n+=e.normal.y*this.min.y,u+=e.normal.y*this.max.y):(n+=e.normal.y*this.max.y,u+=e.normal.y*this.min.y),0<e.normal.z?(n+=e.normal.z*this.min.z,u+=e.normal.z*this.max.z):(n+=e.normal.z*this.max.z,u+=e.normal.z*this.min.z),n<=-e.constant&&u>=-e.constant},intersectsTriangle:function(e){return this.isEmpty()||(this.getCenter(C0),Xx.subVectors(this.max,C0),Lm.subVectors(e.a,C0),Rm.subVectors(e.b,C0),Pm.subVectors(e.c,C0),Dc.subVectors(Rm,Lm),Oc.subVectors(Pm,Rm),Dp.subVectors(Lm,Pm),e=[0,-Dc.z,Dc.y,0,-Oc.z,Oc.y,0,-Dp.z,Dp.y,Dc.z,0,-Dc.x,Oc.z,0,-Oc.x,Dp.z,0,-Dp.x,-Dc.y,Dc.x,0,-Oc.y,Oc.x,0,-Dp.y,Dp.x,0],!J(e,Lm,Rm,Pm,Xx))||(e=[1,0,0,0,1,0,0,0,1],!J(e,Lm,Rm,Pm,Xx))?!1:(Yx.crossVectors(Dc,Oc),e=[Yx.x,Yx.y,Yx.z],J(e,Lm,Rm,Pm,Xx))},clampPoint:function(e,n){return n===void 0&&(console.warn("THREE.Box3: .clampPoint() target is now required"),n=new w),n.copy(e).clamp(this.min,this.max)},distanceToPoint:function(e){return M0.copy(e).clamp(this.min,this.max).sub(e).length()},getBoundingSphere:function(e){return e===void 0&&console.error("THREE.Box3: .getBoundingSphere() target is now required"),this.getCenter(e.center),e.radius=.5*this.getSize(M0).length(),e},intersect:function(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this},union:function(e){return this.min.min(e.min),this.max.max(e.max),this},applyMatrix4:function(e){return this.isEmpty()?this:(ph[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),ph[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),ph[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),ph[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),ph[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),ph[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),ph[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),ph[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(ph),this)},translate:function(e){return this.min.add(e),this.max.add(e),this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)}});var H5=new q;pt(it.prototype,{set:function(e,n){return this.center.copy(e),this.radius=n,this},setFromPoints:function(e,n){var u=this.center;n!==void 0?u.copy(n):H5.setFromPoints(e).getCenter(u);for(var m=n=0,_=e.length;m<_;m++)n=Math.max(n,u.distanceToSquared(e[m]));return this.radius=Math.sqrt(n),this},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.center.copy(e.center),this.radius=e.radius,this},isEmpty:function(){return 0>this.radius},makeEmpty:function(){return this.center.set(0,0,0),this.radius=-1,this},containsPoint:function(e){return e.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(e){return e.distanceTo(this.center)-this.radius},intersectsSphere:function(e){var n=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=n*n},intersectsBox:function(e){return e.intersectsSphere(this)},intersectsPlane:function(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius},clampPoint:function(e,n){var u=this.center.distanceToSquared(e);return n===void 0&&(console.warn("THREE.Sphere: .clampPoint() target is now required"),n=new w),n.copy(e),u>this.radius*this.radius&&(n.sub(this.center).normalize(),n.multiplyScalar(this.radius).add(this.center)),n},getBoundingBox:function(e){return e===void 0&&(console.warn("THREE.Sphere: .getBoundingBox() target is now required"),e=new q),this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)},applyMatrix4:function(e){return this.center.applyMatrix4(e),this.radius*=e.getMaxScaleOnAxis(),this},translate:function(e){return this.center.add(e),this},equals:function(e){return e.center.equals(this.center)&&e.radius===this.radius}});var dh=new w,Cw=new w,Zx=new w,Fc=new w,Tw=new w,qx=new w,Sw=new w;pt(lt.prototype,{set:function(e,n){return this.origin.copy(e),this.direction.copy(n),this},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this},at:function(e,n){return n===void 0&&(console.warn("THREE.Ray: .at() target is now required"),n=new w),n.copy(this.direction).multiplyScalar(e).add(this.origin)},lookAt:function(e){return this.direction.copy(e).sub(this.origin).normalize(),this},recast:function(e){return this.origin.copy(this.at(e,dh)),this},closestPointToPoint:function(e,n){return n===void 0&&(console.warn("THREE.Ray: .closestPointToPoint() target is now required"),n=new w),n.subVectors(e,this.origin),e=n.dot(this.direction),0>e?n.copy(this.origin):n.copy(this.direction).multiplyScalar(e).add(this.origin)},distanceToPoint:function(e){return Math.sqrt(this.distanceSqToPoint(e))},distanceSqToPoint:function(e){var n=dh.subVectors(e,this.origin).dot(this.direction);return 0>n?this.origin.distanceToSquared(e):(dh.copy(this.direction).multiplyScalar(n).add(this.origin),dh.distanceToSquared(e))},distanceSqToSegment:function(e,n,u,m){Cw.copy(e).add(n).multiplyScalar(.5),Zx.copy(n).sub(e).normalize(),Fc.copy(this.origin).sub(Cw);var _=.5*e.distanceTo(n),T=-this.direction.dot(Zx),R=Fc.dot(this.direction),N=-Fc.dot(Zx),H=Fc.lengthSq(),W=Math.abs(1-T*T);if(0<W){e=T*N-R,n=T*R-N;var $=_*W;0<=e?n>=-$?n<=$?(_=1/W,e*=_,n*=_,T=e*(e+T*n+2*R)+n*(T*e+n+2*N)+H):(n=_,e=Math.max(0,-(T*n+R)),T=-e*e+n*(n+2*N)+H):(n=-_,e=Math.max(0,-(T*n+R)),T=-e*e+n*(n+2*N)+H):n<=-$?(e=Math.max(0,-(-T*_+R)),n=0<e?-_:Math.min(Math.max(-_,-N),_),T=-e*e+n*(n+2*N)+H):n<=$?(e=0,n=Math.min(Math.max(-_,-N),_),T=n*(n+2*N)+H):(e=Math.max(0,-(T*_+R)),n=0<e?_:Math.min(Math.max(-_,-N),_),T=-e*e+n*(n+2*N)+H)}else n=0<T?-_:_,e=Math.max(0,-(T*n+R)),T=-e*e+n*(n+2*N)+H;return u&&u.copy(this.direction).multiplyScalar(e).add(this.origin),m&&m.copy(Zx).multiplyScalar(n).add(Cw),T},intersectSphere:function(e,n){dh.subVectors(e.center,this.origin);var u=dh.dot(this.direction),m=dh.dot(dh)-u*u;return e=e.radius*e.radius,m>e?null:(e=Math.sqrt(e-m),m=u-e,u+=e,0>m&&0>u?null:0>m?this.at(u,n):this.at(m,n))},intersectsSphere:function(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius},distanceToPlane:function(e){var n=e.normal.dot(this.direction);return n===0?e.distanceToPoint(this.origin)===0?0:null:(e=-(this.origin.dot(e.normal)+e.constant)/n,0<=e?e:null)},intersectPlane:function(e,n){return e=this.distanceToPlane(e),e===null?null:this.at(e,n)},intersectsPlane:function(e){var n=e.distanceToPoint(this.origin);return n===0||0>e.normal.dot(this.direction)*n},intersectBox:function(e,n){var u=1/this.direction.x,m=1/this.direction.y,_=1/this.direction.z,T=this.origin;if(0<=u){var R=(e.min.x-T.x)*u;u*=e.max.x-T.x}else R=(e.max.x-T.x)*u,u*=e.min.x-T.x;if(0<=m){var N=(e.min.y-T.y)*m;m*=e.max.y-T.y}else N=(e.max.y-T.y)*m,m*=e.min.y-T.y;return R>m||N>u||((N>R||R!==R)&&(R=N),(m<u||u!==u)&&(u=m),0<=_?(N=(e.min.z-T.z)*_,e=(e.max.z-T.z)*_):(N=(e.max.z-T.z)*_,e=(e.min.z-T.z)*_),R>e||N>u)?null:((N>R||R!==R)&&(R=N),(e<u||u!==u)&&(u=e),0>u?null:this.at(0<=R?R:u,n))},intersectsBox:function(e){return this.intersectBox(e,dh)!==null},intersectTriangle:function(e,n,u,m,_){if(Tw.subVectors(n,e),qx.subVectors(u,e),Sw.crossVectors(Tw,qx),n=this.direction.dot(Sw),0<n){if(m)return null;m=1}else if(0>n)m=-1,n=-n;else return null;return Fc.subVectors(this.origin,e),e=m*this.direction.dot(qx.crossVectors(Fc,qx)),0>e||(u=m*this.direction.dot(Tw.cross(Fc)),0>u||e+u>n)?null:(e=-m*Fc.dot(Sw),0>e?null:this.at(e/n,_))},applyMatrix4:function(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this},equals:function(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}});var Iw=new w,G5=new w,V5=new c;pt(Mt.prototype,{isPlane:!0,set:function(e,n){return this.normal.copy(e),this.constant=n,this},setComponents:function(e,n,u,m){return this.normal.set(e,n,u),this.constant=m,this},setFromNormalAndCoplanarPoint:function(e,n){return this.normal.copy(e),this.constant=-n.dot(this.normal),this},setFromCoplanarPoints:function(e,n,u){return n=Iw.subVectors(u,n).cross(G5.subVectors(e,n)).normalize(),this.setFromNormalAndCoplanarPoint(n,e),this},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.normal.copy(e.normal),this.constant=e.constant,this},normalize:function(){var e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(e){return this.normal.dot(e)+this.constant},distanceToSphere:function(e){return this.distanceToPoint(e.center)-e.radius},projectPoint:function(e,n){return n===void 0&&(console.warn("THREE.Plane: .projectPoint() target is now required"),n=new w),n.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)},intersectLine:function(e,n){n===void 0&&(console.warn("THREE.Plane: .intersectLine() target is now required"),n=new w);var u=e.delta(Iw),m=this.normal.dot(u);if(m===0){if(this.distanceToPoint(e.start)===0)return n.copy(e.start)}else if(m=-(e.start.dot(this.normal)+this.constant)/m,!(0>m||1<m))return n.copy(u).multiplyScalar(m).add(e.start)},intersectsLine:function(e){var n=this.distanceToPoint(e.start);return e=this.distanceToPoint(e.end),0>n&&0<e||0>e&&0<n},intersectsBox:function(e){return e.intersectsPlane(this)},intersectsSphere:function(e){return e.intersectsPlane(this)},coplanarPoint:function(e){return e===void 0&&(console.warn("THREE.Plane: .coplanarPoint() target is now required"),e=new w),e.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(e,n){return n=n||V5.getNormalMatrix(e),e=this.coplanarPoint(Iw).applyMatrix4(e),n=this.normal.applyMatrix3(n).normalize(),this.constant=-e.dot(n),this},translate:function(e){return this.constant-=e.dot(this.normal),this},equals:function(e){return e.normal.equals(this.normal)&&e.constant===this.constant}});var gu=new w,mh=new w,Ew=new w,gh=new w,Dm=new w,Om=new w,gT=new w,Lw=new w,Rw=new w,Pw=new w;pt(Ct,{getNormal:function(e,n,u,m){return m===void 0&&(console.warn("THREE.Triangle: .getNormal() target is now required"),m=new w),m.subVectors(u,n),gu.subVectors(e,n),m.cross(gu),e=m.lengthSq(),0<e?m.multiplyScalar(1/Math.sqrt(e)):m.set(0,0,0)},getBarycoord:function(e,n,u,m,_){gu.subVectors(m,n),mh.subVectors(u,n),Ew.subVectors(e,n),e=gu.dot(gu),n=gu.dot(mh),u=gu.dot(Ew);var T=mh.dot(mh);m=mh.dot(Ew);var R=e*T-n*n;return _===void 0&&(console.warn("THREE.Triangle: .getBarycoord() target is now required"),_=new w),R===0?_.set(-2,-1,-1):(R=1/R,T=(T*u-n*m)*R,e=(e*m-n*u)*R,_.set(1-T-e,e,T))},containsPoint:function(e,n,u,m){return Ct.getBarycoord(e,n,u,m,gh),0<=gh.x&&0<=gh.y&&1>=gh.x+gh.y},getUV:function(e,n,u,m,_,T,R,N){return this.getBarycoord(e,n,u,m,gh),N.set(0,0),N.addScaledVector(_,gh.x),N.addScaledVector(T,gh.y),N.addScaledVector(R,gh.z),N},isFrontFacing:function(e,n,u,m){return gu.subVectors(u,n),mh.subVectors(e,n),0>gu.cross(mh).dot(m)}}),pt(Ct.prototype,{set:function(e,n,u){return this.a.copy(e),this.b.copy(n),this.c.copy(u),this},setFromPointsAndIndices:function(e,n,u,m){return this.a.copy(e[n]),this.b.copy(e[u]),this.c.copy(e[m]),this},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this},getArea:function(){return gu.subVectors(this.c,this.b),mh.subVectors(this.a,this.b),.5*gu.cross(mh).length()},getMidpoint:function(e){return e===void 0&&(console.warn("THREE.Triangle: .getMidpoint() target is now required"),e=new w),e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},getNormal:function(e){return Ct.getNormal(this.a,this.b,this.c,e)},getPlane:function(e){return e===void 0&&(console.warn("THREE.Triangle: .getPlane() target is now required"),e=new Mt),e.setFromCoplanarPoints(this.a,this.b,this.c)},getBarycoord:function(e,n){return Ct.getBarycoord(e,this.a,this.b,this.c,n)},getUV:function(e,n,u,m,_){return Ct.getUV(e,this.a,this.b,this.c,n,u,m,_)},containsPoint:function(e){return Ct.containsPoint(e,this.a,this.b,this.c)},isFrontFacing:function(e){return Ct.isFrontFacing(this.a,this.b,this.c,e)},intersectsBox:function(e){return e.intersectsTriangle(this)},closestPointToPoint:function(e,n){n===void 0&&(console.warn("THREE.Triangle: .closestPointToPoint() target is now required"),n=new w);var u=this.a,m=this.b,_=this.c;Dm.subVectors(m,u),Om.subVectors(_,u),Lw.subVectors(e,u);var T=Dm.dot(Lw),R=Om.dot(Lw);if(0>=T&&0>=R)return n.copy(u);Rw.subVectors(e,m);var N=Dm.dot(Rw),H=Om.dot(Rw);if(0<=N&&H<=N)return n.copy(m);var W=T*H-N*R;if(0>=W&&0<=T&&0>=N)return m=T/(T-N),n.copy(u).addScaledVector(Dm,m);Pw.subVectors(e,_),e=Dm.dot(Pw);var $=Om.dot(Pw);return 0<=$&&e<=$?n.copy(_):(T=e*R-T*$,0>=T&&0<=R&&0>=$?(W=R/(R-$),n.copy(u).addScaledVector(Om,W)):(R=N*$-e*H,0>=R&&0<=H-N&&0<=e-$?(gT.subVectors(_,m),W=(H-N)/(H-N+(e-$)),n.copy(m).addScaledVector(gT,W)):(_=1/(R+T+W),m=T*_,W*=_,n.copy(u).addScaledVector(Dm,m).addScaledVector(Om,W))))},equals:function(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}});var vT={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},vu={h:0,s:0,l:0},Jx={h:0,s:0,l:0};pt(wt.prototype,{isColor:!0,r:1,g:1,b:1,set:function(e){return e&&e.isColor?this.copy(e):typeof e=="number"?this.setHex(e):typeof e=="string"&&this.setStyle(e),this},setScalar:function(e){return this.b=this.g=this.r=e,this},setHex:function(e){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,this},setRGB:function(e,n,u){return this.r=e,this.g=n,this.b=u,this},setHSL:function(e,n,u){return e=ni.euclideanModulo(e,1),n=ni.clamp(n,0,1),u=ni.clamp(u,0,1),n===0?this.r=this.g=this.b=u:(n=.5>=u?u*(1+n):u+n-u*n,u=2*u-n,this.r=zt(u,n,e+1/3),this.g=zt(u,n,e),this.b=zt(u,n,e-1/3)),this},setStyle:function(e){function n(R){R!==void 0&&1>parseFloat(R)&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}var u;if(u=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(e)){var m=u[2];switch(u[1]){case"rgb":case"rgba":if(u=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(m))return this.r=Math.min(255,parseInt(u[1],10))/255,this.g=Math.min(255,parseInt(u[2],10))/255,this.b=Math.min(255,parseInt(u[3],10))/255,n(u[5]),this;if(u=/^(\d+)%\s*,\s*(\d+)%\s*,\s*(\d+)%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(m))return this.r=Math.min(100,parseInt(u[1],10))/100,this.g=Math.min(100,parseInt(u[2],10))/100,this.b=Math.min(100,parseInt(u[3],10))/100,n(u[5]),this;break;case"hsl":case"hsla":if(u=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)%\s*,\s*(\d+)%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(m)){m=parseFloat(u[1])/360;var _=parseInt(u[2],10)/100,T=parseInt(u[3],10)/100;return n(u[5]),this.setHSL(m,_,T)}}}else if(u=/^#([A-Fa-f0-9]+)$/.exec(e)){if(u=u[1],m=u.length,m===3)return this.r=parseInt(u.charAt(0)+u.charAt(0),16)/255,this.g=parseInt(u.charAt(1)+u.charAt(1),16)/255,this.b=parseInt(u.charAt(2)+u.charAt(2),16)/255,this;if(m===6)return this.r=parseInt(u.charAt(0)+u.charAt(1),16)/255,this.g=parseInt(u.charAt(2)+u.charAt(3),16)/255,this.b=parseInt(u.charAt(4)+u.charAt(5),16)/255,this}return e&&0<e.length?this.setColorName(e):this},setColorName:function(e){var n=vT[e];return n!==void 0?this.setHex(n):console.warn("THREE.Color: Unknown color "+e),this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(e){return this.r=e.r,this.g=e.g,this.b=e.b,this},copyGammaToLinear:function(e,n){return n===void 0&&(n=2),this.r=Math.pow(e.r,n),this.g=Math.pow(e.g,n),this.b=Math.pow(e.b,n),this},copyLinearToGamma:function(e,n){return n===void 0&&(n=2),n=0<n?1/n:1,this.r=Math.pow(e.r,n),this.g=Math.pow(e.g,n),this.b=Math.pow(e.b,n),this},convertGammaToLinear:function(e){return this.copyGammaToLinear(this,e),this},convertLinearToGamma:function(e){return this.copyLinearToGamma(this,e),this},copySRGBToLinear:function(e){return this.r=Ut(e.r),this.g=Ut(e.g),this.b=Ut(e.b),this},copyLinearToSRGB:function(e){return this.r=Kt(e.r),this.g=Kt(e.g),this.b=Kt(e.b),this},convertSRGBToLinear:function(){return this.copySRGBToLinear(this),this},convertLinearToSRGB:function(){return this.copyLinearToSRGB(this),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(e){e===void 0&&(console.warn("THREE.Color: .getHSL() target is now required"),e={h:0,s:0,l:0});var n=this.r,u=this.g,m=this.b,_=Math.max(n,u,m),T=Math.min(n,u,m),R,N=(T+_)/2;if(T===_)T=R=0;else{var H=_-T;switch(T=.5>=N?H/(_+T):H/(2-_-T),_){case n:R=(u-m)/H+(u<m?6:0);break;case u:R=(m-n)/H+2;break;case m:R=(n-u)/H+4}R/=6}return e.h=R,e.s=T,e.l=N,e},getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function(e,n,u){return this.getHSL(vu),vu.h+=e,vu.s+=n,vu.l+=u,this.setHSL(vu.h,vu.s,vu.l),this},add:function(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this},addColors:function(e,n){return this.r=e.r+n.r,this.g=e.g+n.g,this.b=e.b+n.b,this},addScalar:function(e){return this.r+=e,this.g+=e,this.b+=e,this},sub:function(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this},multiply:function(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this},multiplyScalar:function(e){return this.r*=e,this.g*=e,this.b*=e,this},lerp:function(e,n){return this.r+=(e.r-this.r)*n,this.g+=(e.g-this.g)*n,this.b+=(e.b-this.b)*n,this},lerpHSL:function(e,n){this.getHSL(vu),e.getHSL(Jx),e=ni.lerp(vu.h,Jx.h,n);var u=ni.lerp(vu.s,Jx.s,n);return n=ni.lerp(vu.l,Jx.l,n),this.setHSL(e,u,n),this},equals:function(e){return e.r===this.r&&e.g===this.g&&e.b===this.b},fromArray:function(e,n){return n===void 0&&(n=0),this.r=e[n],this.g=e[n+1],this.b=e[n+2],this},toArray:function(e,n){return e===void 0&&(e=[]),n===void 0&&(n=0),e[n]=this.r,e[n+1]=this.g,e[n+2]=this.b,e},toJSON:function(){return this.getHex()}}),wt.NAMES=vT,pt(Gt.prototype,{clone:function(){return new this.constructor().copy(this)},copy:function(e){this.a=e.a,this.b=e.b,this.c=e.c,this.normal.copy(e.normal),this.color.copy(e.color),this.materialIndex=e.materialIndex;for(var n=0,u=e.vertexNormals.length;n<u;n++)this.vertexNormals[n]=e.vertexNormals[n].clone();for(n=0,u=e.vertexColors.length;n<u;n++)this.vertexColors[n]=e.vertexColors[n].clone();return this}});var W5=0;Qt.prototype=pt(ft(s.prototype),{constructor:Qt,isMaterial:!0,onBeforeCompile:function(){},setValues:function(e){if(e!==void 0)for(var n in e){var u=e[n];if(u===void 0)console.warn("THREE.Material: '"+n+"' parameter is undefined.");else if(n==="shading")console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=u===1;else{var m=this[n];m===void 0?console.warn("THREE."+this.type+": '"+n+"' is not a property of this material."):m&&m.isColor?m.set(u):m&&m.isVector3&&u&&u.isVector3?m.copy(u):this[n]=u}}},toJSON:function(e){function n(_){var T=[],R;for(R in _){var N=_[R];delete N.metadata,T.push(N)}return T}var u=e===void 0||typeof e=="string";u&&(e={textures:{},images:{}});var m={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};return m.uuid=this.uuid,m.type=this.type,this.name!==""&&(m.name=this.name),this.color&&this.color.isColor&&(m.color=this.color.getHex()),this.roughness!==void 0&&(m.roughness=this.roughness),this.metalness!==void 0&&(m.metalness=this.metalness),this.sheen&&this.sheen.isColor&&(m.sheen=this.sheen.getHex()),this.emissive&&this.emissive.isColor&&(m.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(m.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(m.specular=this.specular.getHex()),this.shininess!==void 0&&(m.shininess=this.shininess),this.clearcoat!==void 0&&(m.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(m.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(m.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(m.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(m.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,m.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(m.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(m.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(m.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(m.lightMap=this.lightMap.toJSON(e).uuid),this.aoMap&&this.aoMap.isTexture&&(m.aoMap=this.aoMap.toJSON(e).uuid,m.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(m.bumpMap=this.bumpMap.toJSON(e).uuid,m.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(m.normalMap=this.normalMap.toJSON(e).uuid,m.normalMapType=this.normalMapType,m.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(m.displacementMap=this.displacementMap.toJSON(e).uuid,m.displacementScale=this.displacementScale,m.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(m.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(m.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(m.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(m.specularMap=this.specularMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(m.envMap=this.envMap.toJSON(e).uuid,m.reflectivity=this.reflectivity,m.refractionRatio=this.refractionRatio,this.combine!==void 0&&(m.combine=this.combine),this.envMapIntensity!==void 0&&(m.envMapIntensity=this.envMapIntensity)),this.gradientMap&&this.gradientMap.isTexture&&(m.gradientMap=this.gradientMap.toJSON(e).uuid),this.size!==void 0&&(m.size=this.size),this.sizeAttenuation!==void 0&&(m.sizeAttenuation=this.sizeAttenuation),this.blending!==1&&(m.blending=this.blending),this.flatShading===!0&&(m.flatShading=this.flatShading),this.side!==0&&(m.side=this.side),this.vertexColors&&(m.vertexColors=!0),1>this.opacity&&(m.opacity=this.opacity),this.transparent===!0&&(m.transparent=this.transparent),m.depthFunc=this.depthFunc,m.depthTest=this.depthTest,m.depthWrite=this.depthWrite,m.stencilWrite=this.stencilWrite,m.stencilWriteMask=this.stencilWriteMask,m.stencilFunc=this.stencilFunc,m.stencilRef=this.stencilRef,m.stencilFuncMask=this.stencilFuncMask,m.stencilFail=this.stencilFail,m.stencilZFail=this.stencilZFail,m.stencilZPass=this.stencilZPass,this.rotation&&this.rotation!==0&&(m.rotation=this.rotation),this.polygonOffset===!0&&(m.polygonOffset=!0),this.polygonOffsetFactor!==0&&(m.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(m.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth&&this.linewidth!==1&&(m.linewidth=this.linewidth),this.dashSize!==void 0&&(m.dashSize=this.dashSize),this.gapSize!==void 0&&(m.gapSize=this.gapSize),this.scale!==void 0&&(m.scale=this.scale),this.dithering===!0&&(m.dithering=!0),0<this.alphaTest&&(m.alphaTest=this.alphaTest),this.premultipliedAlpha===!0&&(m.premultipliedAlpha=this.premultipliedAlpha),this.wireframe===!0&&(m.wireframe=this.wireframe),1<this.wireframeLinewidth&&(m.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(m.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(m.wireframeLinejoin=this.wireframeLinejoin),this.morphTargets===!0&&(m.morphTargets=!0),this.morphNormals===!0&&(m.morphNormals=!0),this.skinning===!0&&(m.skinning=!0),this.visible===!1&&(m.visible=!1),this.toneMapped===!1&&(m.toneMapped=!1),Hs(this.userData)!=="{}"&&(m.userData=this.userData),u&&(u=n(e.textures),e=n(e.images),0<u.length&&(m.textures=u),0<e.length&&(m.images=e)),m},clone:function(){return new this.constructor().copy(this)},copy:function(e){this.name=e.name,this.fog=e.fog,this.blending=e.blending,this.side=e.side,this.flatShading=e.flatShading,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;var n=e.clippingPlanes,u=null;if(n!==null){var m=n.length;u=Array(m);for(var _=0;_!==m;++_)u[_]=n[_].clone()}return this.clippingPlanes=u,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.premultipliedAlpha=e.premultipliedAlpha,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(Hs(e.userData)),this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Object.defineProperty(Qt.prototype,"needsUpdate",{set:function(e){e===!0&&this.version++}}),De.prototype=ft(Qt.prototype),De.prototype.constructor=De,De.prototype.isMeshBasicMaterial=!0,De.prototype.copy=function(e){return Qt.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this};var Ji=new w;Object.defineProperty(re.prototype,"needsUpdate",{set:function(e){e===!0&&this.version++}}),pt(re.prototype,{isBufferAttribute:!0,onUploadCallback:function(){},setUsage:function(e){return this.usage=e,this},copy:function(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this},copyAt:function(e,n,u){e*=this.itemSize,u*=n.itemSize;for(var m=0,_=this.itemSize;m<_;m++)this.array[e+m]=n.array[u+m];return this},copyArray:function(e){return this.array.set(e),this},copyColorsArray:function(e){for(var n=this.array,u=0,m=0,_=e.length;m<_;m++){var T=e[m];T===void 0&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",m),T=new wt),n[u++]=T.r,n[u++]=T.g,n[u++]=T.b}return this},copyVector2sArray:function(e){for(var n=this.array,u=0,m=0,_=e.length;m<_;m++){var T=e[m];T===void 0&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",m),T=new f),n[u++]=T.x,n[u++]=T.y}return this},copyVector3sArray:function(e){for(var n=this.array,u=0,m=0,_=e.length;m<_;m++){var T=e[m];T===void 0&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",m),T=new w),n[u++]=T.x,n[u++]=T.y,n[u++]=T.z}return this},copyVector4sArray:function(e){for(var n=this.array,u=0,m=0,_=e.length;m<_;m++){var T=e[m];T===void 0&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",m),T=new p),n[u++]=T.x,n[u++]=T.y,n[u++]=T.z,n[u++]=T.w}return this},applyMatrix3:function(e){for(var n=0,u=this.count;n<u;n++)Ji.x=this.getX(n),Ji.y=this.getY(n),Ji.z=this.getZ(n),Ji.applyMatrix3(e),this.setXYZ(n,Ji.x,Ji.y,Ji.z);return this},applyMatrix4:function(e){for(var n=0,u=this.count;n<u;n++)Ji.x=this.getX(n),Ji.y=this.getY(n),Ji.z=this.getZ(n),Ji.applyMatrix4(e),this.setXYZ(n,Ji.x,Ji.y,Ji.z);return this},applyNormalMatrix:function(e){for(var n=0,u=this.count;n<u;n++)Ji.x=this.getX(n),Ji.y=this.getY(n),Ji.z=this.getZ(n),Ji.applyNormalMatrix(e),this.setXYZ(n,Ji.x,Ji.y,Ji.z);return this},transformDirection:function(e){for(var n=0,u=this.count;n<u;n++)Ji.x=this.getX(n),Ji.y=this.getY(n),Ji.z=this.getZ(n),Ji.transformDirection(e),this.setXYZ(n,Ji.x,Ji.y,Ji.z);return this},set:function(e,n){return n===void 0&&(n=0),this.array.set(e,n),this},getX:function(e){return this.array[e*this.itemSize]},setX:function(e,n){return this.array[e*this.itemSize]=n,this},getY:function(e){return this.array[e*this.itemSize+1]},setY:function(e,n){return this.array[e*this.itemSize+1]=n,this},getZ:function(e){return this.array[e*this.itemSize+2]},setZ:function(e,n){return this.array[e*this.itemSize+2]=n,this},getW:function(e){return this.array[e*this.itemSize+3]},setW:function(e,n){return this.array[e*this.itemSize+3]=n,this},setXY:function(e,n,u){return e*=this.itemSize,this.array[e+0]=n,this.array[e+1]=u,this},setXYZ:function(e,n,u,m){return e*=this.itemSize,this.array[e+0]=n,this.array[e+1]=u,this.array[e+2]=m,this},setXYZW:function(e,n,u,m,_){return e*=this.itemSize,this.array[e+0]=n,this.array[e+1]=u,this.array[e+2]=m,this.array[e+3]=_,this},onUpload:function(e){return this.onUploadCallback=e,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)},toJSON:function(){return{itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized}}}),We.prototype=ft(re.prototype),We.prototype.constructor=We,hr.prototype=ft(re.prototype),hr.prototype.constructor=hr,Je.prototype=ft(re.prototype),Je.prototype.constructor=Je,qr.prototype=ft(re.prototype),qr.prototype.constructor=qr,nr.prototype=ft(re.prototype),nr.prototype.constructor=nr,xt.prototype=ft(re.prototype),xt.prototype.constructor=xt,At.prototype=ft(re.prototype),At.prototype.constructor=At,_t.prototype=ft(re.prototype),_t.prototype.constructor=_t,Rt.prototype=ft(re.prototype),Rt.prototype.constructor=Rt,pt(st.prototype,{computeGroups:function(e){var n=[],u=void 0;e=e.faces;for(var m=0;m<e.length;m++){var _=e[m];if(_.materialIndex!==u){u=_.materialIndex,T!==void 0&&(T.count=3*m-T.start,n.push(T));var T={start:3*m,materialIndex:u}}}T!==void 0&&(T.count=3*m-T.start,n.push(T)),this.groups=n},fromGeometry:function(e){var n=e.faces,u=e.vertices,m=e.faceVertexUvs,_=m[0]&&0<m[0].length,T=m[1]&&0<m[1].length,R=e.morphTargets,N=R.length;if(0<N){for(var H=[],W=0;W<N;W++)H[W]={name:R[W].name,data:[]};this.morphTargets.position=H}var $=e.morphNormals,K=$.length;if(0<K){var rt=[];for(W=0;W<K;W++)rt[W]={name:$[W].name,data:[]};this.morphTargets.normal=rt}var et=e.skinIndices,at=e.skinWeights,mt=et.length===u.length,Ft=at.length===u.length;for(0<u.length&&n.length===0&&console.error("THREE.DirectGeometry: Faceless geometries are not supported."),W=0;W<n.length;W++){var Wt=n[W];this.vertices.push(u[Wt.a],u[Wt.b],u[Wt.c]);var Ht=Wt.vertexNormals;for(Ht.length===3?this.normals.push(Ht[0],Ht[1],Ht[2]):(Ht=Wt.normal,this.normals.push(Ht,Ht,Ht)),Ht=Wt.vertexColors,Ht.length===3?this.colors.push(Ht[0],Ht[1],Ht[2]):(Ht=Wt.color,this.colors.push(Ht,Ht,Ht)),_===!0&&(Ht=m[0][W],Ht!==void 0?this.uvs.push(Ht[0],Ht[1],Ht[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",W),this.uvs.push(new f,new f,new f))),T===!0&&(Ht=m[1][W],Ht!==void 0?this.uvs2.push(Ht[0],Ht[1],Ht[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",W),this.uvs2.push(new f,new f,new f))),Ht=0;Ht<N;Ht++){var $t=R[Ht].vertices;H[Ht].data.push($t[Wt.a],$t[Wt.b],$t[Wt.c])}for(Ht=0;Ht<K;Ht++)$t=$[Ht].vertexNormals[W],rt[Ht].data.push($t.a,$t.b,$t.c);mt&&this.skinIndices.push(et[Wt.a],et[Wt.b],et[Wt.c]),Ft&&this.skinWeights.push(at[Wt.a],at[Wt.b],at[Wt.c])}return this.computeGroups(e),this.verticesNeedUpdate=e.verticesNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),this}});var j5=1,al=new I,Dw=new F,Fm=new w,qs=new q,T0=new q,Jn=new w;vt.prototype=pt(ft(s.prototype),{constructor:vt,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(e){Array.isArray(e)?this.index=new(65535<gt(e)?At:nr)(e,1):this.index=e},getAttribute:function(e){return this.attributes[e]},setAttribute:function(e,n){return this.attributes[e]=n,this},deleteAttribute:function(e){return delete this.attributes[e],this},addGroup:function(e,n,u){this.groups.push({start:e,count:n,materialIndex:u!==void 0?u:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(e,n){this.drawRange.start=e,this.drawRange.count=n},applyMatrix4:function(e){var n=this.attributes.position;if(n!==void 0&&(n.applyMatrix4(e),n.needsUpdate=!0),n=this.attributes.normal,n!==void 0){var u=new c().getNormalMatrix(e);n.applyNormalMatrix(u),n.needsUpdate=!0}return n=this.attributes.tangent,n!==void 0&&(n.transformDirection(e),n.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this},rotateX:function(e){return al.makeRotationX(e),this.applyMatrix4(al),this},rotateY:function(e){return al.makeRotationY(e),this.applyMatrix4(al),this},rotateZ:function(e){return al.makeRotationZ(e),this.applyMatrix4(al),this},translate:function(e,n,u){return al.makeTranslation(e,n,u),this.applyMatrix4(al),this},scale:function(e,n,u){return al.makeScale(e,n,u),this.applyMatrix4(al),this},lookAt:function(e){return Dw.lookAt(e),Dw.updateMatrix(),this.applyMatrix4(Dw.matrix),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(Fm).negate(),this.translate(Fm.x,Fm.y,Fm.z),this},setFromObject:function(e){var n=e.geometry;if(e.isPoints||e.isLine){e=new _t(3*n.vertices.length,3);var u=new _t(3*n.colors.length,3);this.setAttribute("position",e.copyVector3sArray(n.vertices)),this.setAttribute("color",u.copyColorsArray(n.colors)),n.lineDistances&&n.lineDistances.length===n.vertices.length&&(e=new _t(n.lineDistances.length,1),this.setAttribute("lineDistance",e.copyArray(n.lineDistances))),n.boundingSphere!==null&&(this.boundingSphere=n.boundingSphere.clone()),n.boundingBox!==null&&(this.boundingBox=n.boundingBox.clone())}else e.isMesh&&n&&n.isGeometry&&this.fromGeometry(n);return this},setFromPoints:function(e){for(var n=[],u=0,m=e.length;u<m;u++){var _=e[u];n.push(_.x,_.y,_.z||0)}return this.setAttribute("position",new _t(n,3)),this},updateFromObject:function(e){var n=e.geometry;if(e.isMesh){var u=n.__directGeometry;if(n.elementsNeedUpdate===!0&&(u=void 0,n.elementsNeedUpdate=!1),u===void 0)return this.fromGeometry(n);u.verticesNeedUpdate=n.verticesNeedUpdate,u.normalsNeedUpdate=n.normalsNeedUpdate,u.colorsNeedUpdate=n.colorsNeedUpdate,u.uvsNeedUpdate=n.uvsNeedUpdate,u.groupsNeedUpdate=n.groupsNeedUpdate,n.verticesNeedUpdate=!1,n.normalsNeedUpdate=!1,n.colorsNeedUpdate=!1,n.uvsNeedUpdate=!1,n.groupsNeedUpdate=!1,n=u}return n.verticesNeedUpdate===!0&&(u=this.attributes.position,u!==void 0&&(u.copyVector3sArray(n.vertices),u.needsUpdate=!0),n.verticesNeedUpdate=!1),n.normalsNeedUpdate===!0&&(u=this.attributes.normal,u!==void 0&&(u.copyVector3sArray(n.normals),u.needsUpdate=!0),n.normalsNeedUpdate=!1),n.colorsNeedUpdate===!0&&(u=this.attributes.color,u!==void 0&&(u.copyColorsArray(n.colors),u.needsUpdate=!0),n.colorsNeedUpdate=!1),n.uvsNeedUpdate&&(u=this.attributes.uv,u!==void 0&&(u.copyVector2sArray(n.uvs),u.needsUpdate=!0),n.uvsNeedUpdate=!1),n.lineDistancesNeedUpdate&&(u=this.attributes.lineDistance,u!==void 0&&(u.copyArray(n.lineDistances),u.needsUpdate=!0),n.lineDistancesNeedUpdate=!1),n.groupsNeedUpdate&&(n.computeGroups(e.geometry),this.groups=n.groups,n.groupsNeedUpdate=!1),this},fromGeometry:function(e){return e.__directGeometry=new st().fromGeometry(e),this.fromDirectGeometry(e.__directGeometry)},fromDirectGeometry:function(e){var n=new Float32Array(3*e.vertices.length);this.setAttribute("position",new re(n,3).copyVector3sArray(e.vertices)),0<e.normals.length&&(n=new Float32Array(3*e.normals.length),this.setAttribute("normal",new re(n,3).copyVector3sArray(e.normals))),0<e.colors.length&&(n=new Float32Array(3*e.colors.length),this.setAttribute("color",new re(n,3).copyColorsArray(e.colors))),0<e.uvs.length&&(n=new Float32Array(2*e.uvs.length),this.setAttribute("uv",new re(n,2).copyVector2sArray(e.uvs))),0<e.uvs2.length&&(n=new Float32Array(2*e.uvs2.length),this.setAttribute("uv2",new re(n,2).copyVector2sArray(e.uvs2))),this.groups=e.groups;for(var u in e.morphTargets){n=[];for(var m=e.morphTargets[u],_=0,T=m.length;_<T;_++){var R=m[_],N=new _t(3*R.data.length,3);N.name=R.name,n.push(N.copyVector3sArray(R.data))}this.morphAttributes[u]=n}return 0<e.skinIndices.length&&(u=new _t(4*e.skinIndices.length,4),this.setAttribute("skinIndex",u.copyVector4sArray(e.skinIndices))),0<e.skinWeights.length&&(u=new _t(4*e.skinWeights.length,4),this.setAttribute("skinWeight",u.copyVector4sArray(e.skinWeights))),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),this},computeBoundingBox:function(){this.boundingBox===null&&(this.boundingBox=new q);var e=this.attributes.position,n=this.morphAttributes.position;if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),n){e=0;for(var u=n.length;e<u;e++)qs.setFromBufferAttribute(n[e]),this.morphTargetsRelative?(Jn.addVectors(this.boundingBox.min,qs.min),this.boundingBox.expandByPoint(Jn),Jn.addVectors(this.boundingBox.max,qs.max),this.boundingBox.expandByPoint(Jn)):(this.boundingBox.expandByPoint(qs.min),this.boundingBox.expandByPoint(qs.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:function(){this.boundingSphere===null&&(this.boundingSphere=new it);var e=this.attributes.position,n=this.morphAttributes.position;if(e){var u=this.boundingSphere.center;if(qs.setFromBufferAttribute(e),n)for(var m=0,_=n.length;m<_;m++){var T=n[m];T0.setFromBufferAttribute(T),this.morphTargetsRelative?(Jn.addVectors(qs.min,T0.min),qs.expandByPoint(Jn),Jn.addVectors(qs.max,T0.max),qs.expandByPoint(Jn)):(qs.expandByPoint(T0.min),qs.expandByPoint(T0.max))}qs.getCenter(u);var R=0;for(m=0,_=e.count;m<_;m++)Jn.fromBufferAttribute(e,m),R=Math.max(R,u.distanceToSquared(Jn));if(n)for(m=0,_=n.length;m<_;m++){T=n[m];for(var N=this.morphTargetsRelative,H=0,W=T.count;H<W;H++)Jn.fromBufferAttribute(T,H),N&&(Fm.fromBufferAttribute(e,H),Jn.add(Fm)),R=Math.max(R,u.distanceToSquared(Jn))}this.boundingSphere.radius=Math.sqrt(R),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}},computeFaceNormals:function(){},computeVertexNormals:function(){var e=this.index,n=this.attributes;if(n.position){var u=n.position.array;if(n.normal===void 0)this.setAttribute("normal",new re(new Float32Array(u.length),3));else for(var m=n.normal.array,_=0,T=m.length;_<T;_++)m[_]=0;m=n.normal.array;var R=new w,N=new w,H=new w,W=new w,$=new w;if(e){var K=e.array;for(_=0,T=e.count;_<T;_+=3){e=3*K[_+0];var rt=3*K[_+1],et=3*K[_+2];R.fromArray(u,e),N.fromArray(u,rt),H.fromArray(u,et),W.subVectors(H,N),$.subVectors(R,N),W.cross($),m[e]+=W.x,m[e+1]+=W.y,m[e+2]+=W.z,m[rt]+=W.x,m[rt+1]+=W.y,m[rt+2]+=W.z,m[et]+=W.x,m[et+1]+=W.y,m[et+2]+=W.z}}else for(_=0,T=u.length;_<T;_+=9)R.fromArray(u,_),N.fromArray(u,_+3),H.fromArray(u,_+6),W.subVectors(H,N),$.subVectors(R,N),W.cross($),m[_]=W.x,m[_+1]=W.y,m[_+2]=W.z,m[_+3]=W.x,m[_+4]=W.y,m[_+5]=W.z,m[_+6]=W.x,m[_+7]=W.y,m[_+8]=W.z;this.normalizeNormals(),n.normal.needsUpdate=!0}},merge:function(e,n){if(e&&e.isBufferGeometry){n===void 0&&(n=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));var u=this.attributes,m;for(m in u)if(e.attributes[m]!==void 0){var _=u[m].array,T=e.attributes[m],R=T.array,N=T.itemSize*n;T=Math.min(R.length,_.length-N);for(var H=0;H<T;H++,N++)_[N]=R[H]}return this}console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",e)},normalizeNormals:function(){for(var e=this.attributes.normal,n=0,u=e.count;n<u;n++)Jn.x=e.getX(n),Jn.y=e.getY(n),Jn.z=e.getZ(n),Jn.normalize(),e.setXYZ(n,Jn.x,Jn.y,Jn.z)},toNonIndexed:function(){function e($,K){var rt=$.array,et=$.itemSize;$=$.normalized;for(var at=new rt.constructor(K.length*et),mt,Ft=0,Wt=0,Ht=K.length;Wt<Ht;Wt++){mt=K[Wt]*et;for(var $t=0;$t<et;$t++)at[Ft++]=rt[mt++]}return new re(at,et,$)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed."),this;var n=new vt,u=this.index.array,m=this.attributes,_;for(_ in m){var T=m[_];T=e(T,u),n.setAttribute(_,T)}var R=this.morphAttributes;for(_ in R){var N=[],H=R[_];m=0;for(var W=H.length;m<W;m++)T=H[m],T=e(T,u),N.push(T);n.morphAttributes[_]=N}for(n.morphTargetsRelative=this.morphTargetsRelative,u=this.groups,m=0,_=u.length;m<_;m++)T=u[m],n.addGroup(T.start,T.count,T.materialIndex);return n},toJSON:function(){var e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),0<Ti(this.userData).length&&(e.userData=this.userData),this.parameters!==void 0){var n=this.parameters;for(W in n)n[W]!==void 0&&(e[W]=n[W]);return e}e.data={attributes:{}},n=this.index,n!==null&&(e.data.index={type:n.array.constructor.name,array:Array.prototype.slice.call(n.array)});var u=this.attributes;for(W in u){n=u[W];var m=n.toJSON();n.name!==""&&(m.name=n.name),e.data.attributes[W]=m}u={};var _=!1;for(W in this.morphAttributes){for(var T=this.morphAttributes[W],R=[],N=0,H=T.length;N<H;N++)n=T[N],m=n.toJSON(),n.name!==""&&(m.name=n.name),R.push(m);0<R.length&&(u[W]=R,_=!0)}_&&(e.data.morphAttributes=u,e.data.morphTargetsRelative=this.morphTargetsRelative);var W=this.groups;return 0<W.length&&(e.data.groups=JSON.parse(Hs(W))),W=this.boundingSphere,W!==null&&(e.data.boundingSphere={center:W.center.toArray(),radius:W.radius}),e},clone:function(){return new vt().copy(this)},copy:function(e){var n;this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingSphere=this.boundingBox=null,this.name=e.name;var u=e.index;u!==null&&this.setIndex(u.clone()),u=e.attributes;for(R in u)this.setAttribute(R,u[R].clone());var m=e.morphAttributes;for(R in m){var _=[],T=m[R];for(u=0,n=T.length;u<n;u++)_.push(T[u].clone());this.morphAttributes[R]=_}this.morphTargetsRelative=e.morphTargetsRelative;var R=e.groups;for(u=0,n=R.length;u<n;u++)m=R[u],this.addGroup(m.start,m.count,m.materialIndex);return R=e.boundingBox,R!==null&&(this.boundingBox=R.clone()),R=e.boundingSphere,R!==null&&(this.boundingSphere=R.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});var yT=new I,Fp=new lt,Ow=new it,Bc=new w,zc=new w,Nc=new w,Fw=new w,Bw=new w,zw=new w,Qx=new w,Kx=new w,$x=new w,Bm=new f,zm=new f,Nm=new f,S0=new w,t2=new w;Pt.prototype=pt(ft(F.prototype),{constructor:Pt,isMesh:!0,copy:function(e){return F.prototype.copy.call(this,e),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=pt({},e.morphTargetDictionary)),this},updateMorphTargets:function(){var e=this.geometry;if(e.isBufferGeometry){e=e.morphAttributes;var n=Ti(e);if(0<n.length){var u=e[n[0]];if(u!==void 0)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},e=0,n=u.length;e<n;e++){var m=u[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[m]=e}}}else e=e.morphTargets,e!==void 0&&0<e.length&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")},raycast:function(e,n){var u=this.geometry,m=this.material,_=this.matrixWorld;if(m!==void 0&&(u.boundingSphere===null&&u.computeBoundingSphere(),Ow.copy(u.boundingSphere),Ow.applyMatrix4(_),e.ray.intersectsSphere(Ow)!==!1&&(yT.getInverse(_),Fp.copy(e.ray).applyMatrix4(yT),u.boundingBox===null||Fp.intersectsBox(u.boundingBox)!==!1))){if(u.isBufferGeometry){var T=u.index;_=u.attributes.position;var R=u.morphAttributes.position,N=u.morphTargetsRelative,H=u.attributes.uv,W=u.attributes.uv2,$=u.groups,K=u.drawRange,rt,et;if(T!==null)if(Array.isArray(m)){var at=0;for(rt=$.length;at<rt;at++){var mt=$[at],Ft=m[mt.materialIndex],Wt=Math.max(mt.start,K.start);for(et=u=Math.min(mt.start+mt.count,K.start+K.count);Wt<et;Wt+=3){u=T.getX(Wt);var Ht=T.getX(Wt+1),$t=T.getX(Wt+2);(u=Zt(this,Ft,e,Fp,_,R,N,H,W,u,Ht,$t))&&(u.faceIndex=Math.floor(Wt/3),u.face.materialIndex=mt.materialIndex,n.push(u))}}}else for(Wt=Math.max(0,K.start),u=Math.min(T.count,K.start+K.count),at=Wt,rt=u;at<rt;at+=3)u=T.getX(at),Ht=T.getX(at+1),$t=T.getX(at+2),(u=Zt(this,m,e,Fp,_,R,N,H,W,u,Ht,$t))&&(u.faceIndex=Math.floor(at/3),n.push(u));else if(_!==void 0)if(Array.isArray(m))for(at=0,rt=$.length;at<rt;at++)for(mt=$[at],Ft=m[mt.materialIndex],Wt=Math.max(mt.start,K.start),et=u=Math.min(mt.start+mt.count,K.start+K.count);Wt<et;Wt+=3)u=Wt,Ht=Wt+1,$t=Wt+2,(u=Zt(this,Ft,e,Fp,_,R,N,H,W,u,Ht,$t))&&(u.faceIndex=Math.floor(Wt/3),u.face.materialIndex=mt.materialIndex,n.push(u));else for(Wt=Math.max(0,K.start),u=Math.min(_.count,K.start+K.count),at=Wt,rt=u;at<rt;at+=3)u=at,Ht=at+1,$t=at+2,(u=Zt(this,m,e,Fp,_,R,N,H,W,u,Ht,$t))&&(u.faceIndex=Math.floor(at/3),n.push(u))}else if(u.isGeometry)for(_=Array.isArray(m),R=u.vertices,N=u.faces,u=u.faceVertexUvs[0],0<u.length&&(T=u),K=0,at=N.length;K<at;K++)rt=N[K],u=_?m[rt.materialIndex]:m,u!==void 0&&(H=R[rt.a],W=R[rt.b],$=R[rt.c],u=kt(this,u,e,Fp,H,W,$,S0))&&(T&&T[K]&&(mt=T[K],Bm.copy(mt[0]),zm.copy(mt[1]),Nm.copy(mt[2]),u.uv=Ct.getUV(S0,H,W,$,Bm,zm,Nm,new f)),u.face=rt,u.faceIndex=K,n.push(u))}},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});var X5=0,ul=new I,Nw=new F,e2=new w;yt.prototype=pt(ft(s.prototype),{constructor:yt,isGeometry:!0,applyMatrix4:function(e){for(var n=new c().getNormalMatrix(e),u=0,m=this.vertices.length;u<m;u++)this.vertices[u].applyMatrix4(e);for(u=0,m=this.faces.length;u<m;u++){e=this.faces[u],e.normal.applyMatrix3(n).normalize();for(var _=0,T=e.vertexNormals.length;_<T;_++)e.vertexNormals[_].applyMatrix3(n).normalize()}return this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this.normalsNeedUpdate=this.verticesNeedUpdate=!0,this},rotateX:function(e){return ul.makeRotationX(e),this.applyMatrix4(ul),this},rotateY:function(e){return ul.makeRotationY(e),this.applyMatrix4(ul),this},rotateZ:function(e){return ul.makeRotationZ(e),this.applyMatrix4(ul),this},translate:function(e,n,u){return ul.makeTranslation(e,n,u),this.applyMatrix4(ul),this},scale:function(e,n,u){return ul.makeScale(e,n,u),this.applyMatrix4(ul),this},lookAt:function(e){return Nw.lookAt(e),Nw.updateMatrix(),this.applyMatrix4(Nw.matrix),this},fromBufferGeometry:function(e){function n(et,at,mt,Ft){var Wt=N===void 0?[]:[u.colors[et].clone(),u.colors[at].clone(),u.colors[mt].clone()],Ht=R===void 0?[]:[new w().fromArray(R,3*et),new w().fromArray(R,3*at),new w().fromArray(R,3*mt)];Ft=new Gt(et,at,mt,Ht,Wt,Ft),u.faces.push(Ft),H!==void 0&&u.faceVertexUvs[0].push([new f().fromArray(H,2*et),new f().fromArray(H,2*at),new f().fromArray(H,2*mt)]),W!==void 0&&u.faceVertexUvs[1].push([new f().fromArray(W,2*et),new f().fromArray(W,2*at),new f().fromArray(W,2*mt)])}var u=this,m=e.index!==null?e.index.array:void 0,_=e.attributes;if(_.position===void 0)return console.error("THREE.Geometry.fromBufferGeometry(): Position attribute required for conversion."),this;var T=_.position.array,R=_.normal!==void 0?_.normal.array:void 0,N=_.color!==void 0?_.color.array:void 0,H=_.uv!==void 0?_.uv.array:void 0,W=_.uv2!==void 0?_.uv2.array:void 0;for(W!==void 0&&(this.faceVertexUvs[1]=[]),_=0;_<T.length;_+=3)u.vertices.push(new w().fromArray(T,_)),N!==void 0&&u.colors.push(new wt().fromArray(N,_));var $=e.groups;if(0<$.length)for(_=0;_<$.length;_++){T=$[_];var K=T.start,rt=K;for(K+=T.count;rt<K;rt+=3)m!==void 0?n(m[rt],m[rt+1],m[rt+2],T.materialIndex):n(rt,rt+1,rt+2,T.materialIndex)}else if(m!==void 0)for(_=0;_<m.length;_+=3)n(m[_],m[_+1],m[_+2]);else for(_=0;_<T.length/3;_+=3)n(_,_+1,_+2);return this.computeFaceNormals(),e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(e2).negate(),this.translate(e2.x,e2.y,e2.z),this},normalize:function(){this.computeBoundingSphere();var e=this.boundingSphere.center,n=this.boundingSphere.radius;n=n===0?1:1/n;var u=new I;return u.set(n,0,0,-n*e.x,0,n,0,-n*e.y,0,0,n,-n*e.z,0,0,0,1),this.applyMatrix4(u),this},computeFaceNormals:function(){for(var e=new w,n=new w,u=0,m=this.faces.length;u<m;u++){var _=this.faces[u],T=this.vertices[_.a],R=this.vertices[_.b];e.subVectors(this.vertices[_.c],R),n.subVectors(T,R),e.cross(n),e.normalize(),_.normal.copy(e)}},computeVertexNormals:function(e){e===void 0&&(e=!0);var n,u=Array(this.vertices.length),m=0;for(n=this.vertices.length;m<n;m++)u[m]=new w;if(e){var _=new w,T=new w;for(e=0,m=this.faces.length;e<m;e++){n=this.faces[e];var R=this.vertices[n.a],N=this.vertices[n.b],H=this.vertices[n.c];_.subVectors(H,N),T.subVectors(R,N),_.cross(T),u[n.a].add(_),u[n.b].add(_),u[n.c].add(_)}}else for(this.computeFaceNormals(),e=0,m=this.faces.length;e<m;e++)n=this.faces[e],u[n.a].add(n.normal),u[n.b].add(n.normal),u[n.c].add(n.normal);for(m=0,n=this.vertices.length;m<n;m++)u[m].normalize();for(e=0,m=this.faces.length;e<m;e++)n=this.faces[e],R=n.vertexNormals,R.length===3?(R[0].copy(u[n.a]),R[1].copy(u[n.b]),R[2].copy(u[n.c])):(R[0]=u[n.a].clone(),R[1]=u[n.b].clone(),R[2]=u[n.c].clone());0<this.faces.length&&(this.normalsNeedUpdate=!0)},computeFlatVertexNormals:function(){var e;this.computeFaceNormals();var n=0;for(e=this.faces.length;n<e;n++){var u=this.faces[n],m=u.vertexNormals;m.length===3?(m[0].copy(u.normal),m[1].copy(u.normal),m[2].copy(u.normal)):(m[0]=u.normal.clone(),m[1]=u.normal.clone(),m[2]=u.normal.clone())}0<this.faces.length&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function(){var e,n,u=0;for(n=this.faces.length;u<n;u++){var m=this.faces[u];m.__originalFaceNormal?m.__originalFaceNormal.copy(m.normal):m.__originalFaceNormal=m.normal.clone(),m.__originalVertexNormals||(m.__originalVertexNormals=[]);var _=0;for(e=m.vertexNormals.length;_<e;_++)m.__originalVertexNormals[_]?m.__originalVertexNormals[_].copy(m.vertexNormals[_]):m.__originalVertexNormals[_]=m.vertexNormals[_].clone()}var T=new yt;for(T.faces=this.faces,_=0,e=this.morphTargets.length;_<e;_++){if(!this.morphNormals[_]){this.morphNormals[_]={},this.morphNormals[_].faceNormals=[],this.morphNormals[_].vertexNormals=[],m=this.morphNormals[_].faceNormals;var R=this.morphNormals[_].vertexNormals;for(u=0,n=this.faces.length;u<n;u++){var N=new w,H={a:new w,b:new w,c:new w};m.push(N),R.push(H)}}for(R=this.morphNormals[_],T.vertices=this.morphTargets[_].vertices,T.computeFaceNormals(),T.computeVertexNormals(),u=0,n=this.faces.length;u<n;u++)m=this.faces[u],N=R.faceNormals[u],H=R.vertexNormals[u],N.copy(m.normal),H.a.copy(m.vertexNormals[0]),H.b.copy(m.vertexNormals[1]),H.c.copy(m.vertexNormals[2])}for(u=0,n=this.faces.length;u<n;u++)m=this.faces[u],m.normal=m.__originalFaceNormal,m.vertexNormals=m.__originalVertexNormals},computeBoundingBox:function(){this.boundingBox===null&&(this.boundingBox=new q),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){this.boundingSphere===null&&(this.boundingSphere=new it),this.boundingSphere.setFromPoints(this.vertices)},merge:function(e,n,u){if(e&&e.isGeometry){var m,_=this.vertices.length,T=this.vertices,R=e.vertices,N=this.faces,H=e.faces,W=this.colors,$=e.colors;u===void 0&&(u=0),n!==void 0&&(m=new c().getNormalMatrix(n));for(var K=0,rt=R.length;K<rt;K++){var et=R[K].clone();n!==void 0&&et.applyMatrix4(n),T.push(et)}for(K=0,rt=$.length;K<rt;K++)W.push($[K].clone());for(K=0,rt=H.length;K<rt;K++){R=H[K];var at=R.vertexNormals;for($=R.vertexColors,W=new Gt(R.a+_,R.b+_,R.c+_),W.normal.copy(R.normal),m!==void 0&&W.normal.applyMatrix3(m).normalize(),n=0,T=at.length;n<T;n++)et=at[n].clone(),m!==void 0&&et.applyMatrix3(m).normalize(),W.vertexNormals.push(et);for(W.color.copy(R.color),n=0,T=$.length;n<T;n++)et=$[n],W.vertexColors.push(et.clone());W.materialIndex=R.materialIndex+u,N.push(W)}for(K=0,rt=e.faceVertexUvs.length;K<rt;K++)for(u=e.faceVertexUvs[K],this.faceVertexUvs[K]===void 0&&(this.faceVertexUvs[K]=[]),n=0,T=u.length;n<T;n++){for(m=u[n],_=[],N=0,H=m.length;N<H;N++)_.push(m[N].clone());this.faceVertexUvs[K].push(_)}}else console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",e)},mergeMesh:function(e){e&&e.isMesh?(e.matrixAutoUpdate&&e.updateMatrix(),this.merge(e.geometry,e.matrix)):console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",e)},mergeVertices:function(){var e={},n=[],u=[],m=Math.pow(10,4),_,T=0;for(_=this.vertices.length;T<_;T++){var R=this.vertices[T];R=Math.round(R.x*m)+"_"+Math.round(R.y*m)+"_"+Math.round(R.z*m),e[R]===void 0?(e[R]=T,n.push(this.vertices[T]),u[T]=n.length-1):u[T]=u[e[R]]}for(e=[],T=0,_=this.faces.length;T<_;T++)for(m=this.faces[T],m.a=u[m.a],m.b=u[m.b],m.c=u[m.c],m=[m.a,m.b,m.c],R=0;3>R;R++)if(m[R]===m[(R+1)%3]){e.push(T);break}for(T=e.length-1;0<=T;T--)for(m=e[T],this.faces.splice(m,1),u=0,_=this.faceVertexUvs.length;u<_;u++)this.faceVertexUvs[u].splice(m,1);return T=this.vertices.length-n.length,this.vertices=n,T},setFromPoints:function(e){this.vertices=[];for(var n=0,u=e.length;n<u;n++){var m=e[n];this.vertices.push(new w(m.x,m.y,m.z||0))}return this},sortFacesByMaterialIndex:function(){for(var e=this.faces,n=e.length,u=0;u<n;u++)e[u]._id=u;e.sort(function(H,W){return H.materialIndex-W.materialIndex});var m=this.faceVertexUvs[0],_=this.faceVertexUvs[1],T,R;for(m&&m.length===n&&(T=[]),_&&_.length===n&&(R=[]),u=0;u<n;u++){var N=e[u]._id;T&&T.push(m[N]),R&&R.push(_[N])}T&&(this.faceVertexUvs[0]=T),R&&(this.faceVertexUvs[1]=R)},toJSON:function(){function e(ie,Vt,ve){return ve?ie|1<<Vt:ie&~(1<<Vt)}function n(ie){var Vt=ie.x.toString()+ie.y.toString()+ie.z.toString();return W[Vt]!==void 0||(W[Vt]=H.length/3,H.push(ie.x,ie.y,ie.z)),W[Vt]}function u(ie){var Vt=ie.r.toString()+ie.g.toString()+ie.b.toString();return K[Vt]!==void 0||(K[Vt]=$.length,$.push(ie.getHex())),K[Vt]}function m(ie){var Vt=ie.x.toString()+ie.y.toString();return et[Vt]!==void 0||(et[Vt]=rt.length/2,rt.push(ie.x,ie.y)),et[Vt]}var _={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(_.uuid=this.uuid,_.type=this.type,this.name!==""&&(_.name=this.name),this.parameters!==void 0){var T=this.parameters,R;for(R in T)T[R]!==void 0&&(_[R]=T[R]);return _}for(T=[],R=0;R<this.vertices.length;R++){var N=this.vertices[R];T.push(N.x,N.y,N.z)}N=[];var H=[],W={},$=[],K={},rt=[],et={};for(R=0;R<this.faces.length;R++){var at=this.faces[R],mt=this.faceVertexUvs[0][R]!==void 0,Ft=0<at.normal.length(),Wt=0<at.vertexNormals.length,Ht=at.color.r!==1||at.color.g!==1||at.color.b!==1,$t=0<at.vertexColors.length,Yt=0;Yt=e(Yt,0,0),Yt=e(Yt,1,!0),Yt=e(Yt,2,!1),Yt=e(Yt,3,mt),Yt=e(Yt,4,Ft),Yt=e(Yt,5,Wt),Yt=e(Yt,6,Ht),Yt=e(Yt,7,$t),N.push(Yt),N.push(at.a,at.b,at.c),N.push(at.materialIndex),mt&&(mt=this.faceVertexUvs[0][R],N.push(m(mt[0]),m(mt[1]),m(mt[2]))),Ft&&N.push(n(at.normal)),Wt&&(Ft=at.vertexNormals,N.push(n(Ft[0]),n(Ft[1]),n(Ft[2]))),Ht&&N.push(u(at.color)),$t&&(at=at.vertexColors,N.push(u(at[0]),u(at[1]),u(at[2])))}return _.data={},_.data.vertices=T,_.data.normals=H,0<$.length&&(_.data.colors=$),0<rt.length&&(_.data.uvs=[rt]),_.data.faces=N,_},clone:function(){return new yt().copy(this)},copy:function(e){var n,u,m;this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingSphere=this.boundingBox=null,this.name=e.name;var _=e.vertices,T=0;for(n=_.length;T<n;T++)this.vertices.push(_[T].clone());for(_=e.colors,T=0,n=_.length;T<n;T++)this.colors.push(_[T].clone());for(_=e.faces,T=0,n=_.length;T<n;T++)this.faces.push(_[T].clone());for(T=0,n=e.faceVertexUvs.length;T<n;T++){var R=e.faceVertexUvs[T];for(this.faceVertexUvs[T]===void 0&&(this.faceVertexUvs[T]=[]),_=0,u=R.length;_<u;_++){var N=R[_],H=[],W=0;for(m=N.length;W<m;W++)H.push(N[W].clone());this.faceVertexUvs[T].push(H)}}for(W=e.morphTargets,T=0,n=W.length;T<n;T++){if(m={},m.name=W[T].name,W[T].vertices!==void 0)for(m.vertices=[],_=0,u=W[T].vertices.length;_<u;_++)m.vertices.push(W[T].vertices[_].clone());if(W[T].normals!==void 0)for(m.normals=[],_=0,u=W[T].normals.length;_<u;_++)m.normals.push(W[T].normals[_].clone());this.morphTargets.push(m)}for(W=e.morphNormals,T=0,n=W.length;T<n;T++){if(m={},W[T].vertexNormals!==void 0)for(m.vertexNormals=[],_=0,u=W[T].vertexNormals.length;_<u;_++)R=W[T].vertexNormals[_],N={},N.a=R.a.clone(),N.b=R.b.clone(),N.c=R.c.clone(),m.vertexNormals.push(N);if(W[T].faceNormals!==void 0)for(m.faceNormals=[],_=0,u=W[T].faceNormals.length;_<u;_++)m.faceNormals.push(W[T].faceNormals[_].clone());this.morphNormals.push(m)}for(_=e.skinWeights,T=0,n=_.length;T<n;T++)this.skinWeights.push(_[T].clone());for(_=e.skinIndices,T=0,n=_.length;T<n;T++)this.skinIndices.push(_[T].clone());for(_=e.lineDistances,T=0,n=_.length;T<n;T++)this.lineDistances.push(_[T]);return T=e.boundingBox,T!==null&&(this.boundingBox=T.clone()),T=e.boundingSphere,T!==null&&(this.boundingSphere=T.clone()),this.elementsNeedUpdate=e.elementsNeedUpdate,this.verticesNeedUpdate=e.verticesNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.lineDistancesNeedUpdate=e.lineDistancesNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});var Uw=function(e){function n(u,m,_,T,R,N){e.call(this),this.type="BoxGeometry",this.parameters={width:u,height:m,depth:_,widthSegments:T,heightSegments:R,depthSegments:N},this.fromBufferGeometry(new I0(u,m,_,T,R,N)),this.mergeVertices()}return e&&(n.__proto__=e),n.prototype=ft(e&&e.prototype),n.prototype.constructor=n}(yt),I0=function(e){function n(u,m,_,T,R,N){function H(Ft,Wt,Ht,$t,Yt,ie,Vt,ve,Le,oe,Pe){var Ie=ie/Le,fr=Vt/oe,Lr=ie/2,Ze=Vt/2,Sr=ve/2;Vt=Le+1;for(var $r=oe+1,Ur=ie=0,fi=new w,ei=0;ei<$r;ei++)for(var Di=ei*fr-Ze,Yi=0;Yi<Vt;Yi++)fi[Ft]=(Yi*Ie-Lr)*$t,fi[Wt]=Di*Yt,fi[Ht]=Sr,K.push(fi.x,fi.y,fi.z),fi[Ft]=0,fi[Wt]=0,fi[Ht]=0<ve?1:-1,rt.push(fi.x,fi.y,fi.z),et.push(Yi/Le),et.push(1-ei/oe),ie+=1;for(Ft=0;Ft<oe;Ft++)for(Wt=0;Wt<Le;Wt++)Ht=at+Wt+Vt*(Ft+1),$t=at+(Wt+1)+Vt*(Ft+1),Yt=at+(Wt+1)+Vt*Ft,$.push(at+Wt+Vt*Ft,Ht,Yt),$.push(Ht,$t,Yt),Ur+=6;W.addGroup(mt,Ur,Pe),mt+=Ur,at+=ie}e.call(this),this.type="BoxBufferGeometry",this.parameters={width:u,height:m,depth:_,widthSegments:T,heightSegments:R,depthSegments:N};var W=this;u=u||1,m=m||1,_=_||1,T=Math.floor(T)||1,R=Math.floor(R)||1,N=Math.floor(N)||1;var $=[],K=[],rt=[],et=[],at=0,mt=0;H("z","y","x",-1,-1,_,m,u,N,R,0),H("z","y","x",1,-1,_,m,-u,N,R,1),H("x","z","y",1,1,u,_,m,T,N,2),H("x","z","y",1,-1,u,_,-m,T,N,3),H("x","y","z",1,-1,u,m,_,T,R,4),H("x","y","z",-1,-1,u,m,-_,T,R,5),this.setIndex($),this.setAttribute("position",new _t(K,3)),this.setAttribute("normal",new _t(rt,3)),this.setAttribute("uv",new _t(et,2))}return e&&(n.__proto__=e),n.prototype=ft(e&&e.prototype),n.prototype.constructor=n}(vt),xT={clone:he,merge:de};ue.prototype=ft(Qt.prototype),ue.prototype.constructor=ue,ue.prototype.isShaderMaterial=!0,ue.prototype.copy=function(e){return Qt.prototype.copy.call(this,e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=he(e.uniforms),this.defines=pt({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.lights=e.lights,this.clipping=e.clipping,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this.extensions=pt({},e.extensions),this},ue.prototype.toJSON=function(e){var n=Qt.prototype.toJSON.call(this,e);n.uniforms={};for(var u in this.uniforms){var m=this.uniforms[u].value;n.uniforms[u]=m&&m.isTexture?{type:"t",value:m.toJSON(e).uuid}:m&&m.isColor?{type:"c",value:m.getHex()}:m&&m.isVector2?{type:"v2",value:m.toArray()}:m&&m.isVector3?{type:"v3",value:m.toArray()}:m&&m.isVector4?{type:"v4",value:m.toArray()}:m&&m.isMatrix3?{type:"m3",value:m.toArray()}:m&&m.isMatrix4?{type:"m4",value:m.toArray()}:{value:m}}0<Ti(this.defines).length&&(n.defines=this.defines),n.vertexShader=this.vertexShader,n.fragmentShader=this.fragmentShader,e={};for(var _ in this.extensions)this.extensions[_]===!0&&(e[_]=!0);return 0<Ti(e).length&&(n.extensions=e),n},te.prototype=pt(ft(F.prototype),{constructor:te,isCamera:!0,copy:function(e,n){return F.prototype.copy.call(this,e,n),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this},getWorldDirection:function(e){e===void 0&&(console.warn("THREE.Camera: .getWorldDirection() target is now required"),e=new w),this.updateMatrixWorld(!0);var n=this.matrixWorld.elements;return e.set(-n[8],-n[9],-n[10]).normalize()},updateMatrixWorld:function(e){F.prototype.updateMatrixWorld.call(this,e),this.matrixWorldInverse.getInverse(this.matrixWorld)},updateWorldMatrix:function(e,n){F.prototype.updateWorldMatrix.call(this,e,n),this.matrixWorldInverse.getInverse(this.matrixWorld)},clone:function(){return new this.constructor().copy(this)}}),Ae.prototype=pt(ft(te.prototype),{constructor:Ae,isPerspectiveCamera:!0,copy:function(e,n){return te.prototype.copy.call(this,e,n),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:pt({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this},setFocalLength:function(e){e=.5*this.getFilmHeight()/e,this.fov=2*ni.RAD2DEG*Math.atan(e),this.updateProjectionMatrix()},getFocalLength:function(){var e=Math.tan(.5*ni.DEG2RAD*this.fov);return .5*this.getFilmHeight()/e},getEffectiveFOV:function(){return 2*ni.RAD2DEG*Math.atan(Math.tan(.5*ni.DEG2RAD*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(e,n,u,m,_,T){this.aspect=e/n,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=n,this.view.offsetX=u,this.view.offsetY=m,this.view.width=_,this.view.height=T,this.updateProjectionMatrix()},clearViewOffset:function(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var e=this.near,n=e*Math.tan(.5*ni.DEG2RAD*this.fov)/this.zoom,u=2*n,m=this.aspect*u,_=-.5*m,T=this.view;if(this.view!==null&&this.view.enabled){var R=T.fullWidth,N=T.fullHeight;_+=T.offsetX*m/R,n-=T.offsetY*u/N,m*=T.width/R,u*=T.height/N}T=this.filmOffset,T!==0&&(_+=e*T/this.getFilmWidth()),this.projectionMatrix.makePerspective(_,_+m,n,n-u,e,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(e){return e=F.prototype.toJSON.call(this,e),e.object.fov=this.fov,e.object.zoom=this.zoom,e.object.near=this.near,e.object.far=this.far,e.object.focus=this.focus,e.object.aspect=this.aspect,this.view!==null&&(e.object.view=pt({},this.view)),e.object.filmGauge=this.filmGauge,e.object.filmOffset=this.filmOffset,e}}),cr.prototype=ft(F.prototype),cr.prototype.constructor=cr,Cr.prototype=ft(A.prototype),Cr.prototype.constructor=Cr,Cr.prototype.isWebGLCubeRenderTarget=!0,Cr.prototype.fromEquirectangularTexture=function(e,n){this.texture.type=n.type,this.texture.format=n.format,this.texture.encoding=n.encoding;var u=new X,m=new ue({type:"CubemapFromEquirect",uniforms:he({tEquirect:{value:null}}),vertexShader:`varying vec3 vWorldDirection;
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,fragmentShader:`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
}`,side:1,blending:0});return m.uniforms.tEquirect.value=n,n=new Pt(new I0(5,5,5),m),u.add(n),new cr(1,10,this).update(e,u),n.geometry.dispose(),n.material.dispose(),this},me.prototype=ft(d.prototype),me.prototype.constructor=me,me.prototype.isDataTexture=!0;var Um=new it,r2=new w;pt(Qe.prototype,{set:function(e,n,u,m,_,T){var R=this.planes;return R[0].copy(e),R[1].copy(n),R[2].copy(u),R[3].copy(m),R[4].copy(_),R[5].copy(T),this},clone:function(){return new this.constructor().copy(this)},copy:function(e){for(var n=this.planes,u=0;6>u;u++)n[u].copy(e.planes[u]);return this},setFromProjectionMatrix:function(e){var n=this.planes,u=e.elements;e=u[0];var m=u[1],_=u[2],T=u[3],R=u[4],N=u[5],H=u[6],W=u[7],$=u[8],K=u[9],rt=u[10],et=u[11],at=u[12],mt=u[13],Ft=u[14];return u=u[15],n[0].setComponents(T-e,W-R,et-$,u-at).normalize(),n[1].setComponents(T+e,W+R,et+$,u+at).normalize(),n[2].setComponents(T+m,W+N,et+K,u+mt).normalize(),n[3].setComponents(T-m,W-N,et-K,u-mt).normalize(),n[4].setComponents(T-_,W-H,et-rt,u-Ft).normalize(),n[5].setComponents(T+_,W+H,et+rt,u+Ft).normalize(),this},intersectsObject:function(e){var n=e.geometry;return n.boundingSphere===null&&n.computeBoundingSphere(),Um.copy(n.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(Um)},intersectsSprite:function(e){return Um.center.set(0,0,0),Um.radius=.7071067811865476,Um.applyMatrix4(e.matrixWorld),this.intersectsSphere(Um)},intersectsSphere:function(e){var n=this.planes,u=e.center;e=-e.radius;for(var m=0;6>m;m++)if(n[m].distanceToPoint(u)<e)return!1;return!0},intersectsBox:function(e){for(var n=this.planes,u=0;6>u;u++){var m=n[u];if(r2.x=0<m.normal.x?e.max.x:e.min.x,r2.y=0<m.normal.y?e.max.y:e.min.y,r2.z=0<m.normal.z?e.max.z:e.min.z,0>m.distanceToPoint(r2))return!1}return!0},containsPoint:function(e){for(var n=this.planes,u=0;6>u;u++)if(0>n[u].distanceToPoint(e))return!1;return!0}});var or={common:{diffuse:{value:new wt(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new c},uv2Transform:{value:new c},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new f(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new wt(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}}},points:{diffuse:{value:new wt(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},uvTransform:{value:new c}},sprite:{diffuse:{value:new wt(15658734)},opacity:{value:1},center:{value:new f(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},uvTransform:{value:new c}}};mn.prototype=ft(yt.prototype),mn.prototype.constructor=mn,hi.prototype=ft(vt.prototype),hi.prototype.constructor=hi;var mi={alphamap_fragment:`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vUv ).g;
#endif`,alphamap_pars_fragment:`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,alphatest_fragment:`#ifdef ALPHATEST
	if ( diffuseColor.a < ALPHATEST ) discard;
#endif`,aomap_fragment:`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );
	#endif
#endif`,aomap_pars_fragment:`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,bsdfs:`vec2 integrateSpecularBRDF( const in float dotNV, const in float roughness ) {
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	return vec2( -1.04, 1.04 ) * a004 + r.zw;
}
float punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
#if defined ( PHYSICALLY_CORRECT_LIGHTS )
	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
	if( cutoffDistance > 0.0 ) {
		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
	}
	return distanceFalloff;
#else
	if( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
		return pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );
	}
	return 1.0;
#endif
}
vec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {
	float fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );
	return ( 1.0 - specularColor ) * fresnel + specularColor;
}
vec3 F_Schlick_RoughnessDependent( const in vec3 F0, const in float dotNV, const in float roughness ) {
	float fresnel = exp2( ( -5.55473 * dotNV - 6.98316 ) * dotNV );
	vec3 Fr = max( vec3( 1.0 - roughness ), F0 ) - F0;
	return Fr * fresnel + F0;
}
float G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	float gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	return 1.0 / ( gl * gv );
}
float G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
vec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( incidentLight.direction + viewDir );
	float dotNL = saturate( dot( normal, incidentLight.direction ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotLH = saturate( dot( incidentLight.direction, halfDir ) );
	vec3 F = F_Schlick( specularColor, dotLH );
	float G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );
	float D = D_GGX( alpha, dotNH );
	return F * ( G * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE  = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS  = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
vec3 BRDF_Specular_GGX_Environment( const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	vec2 brdf = integrateSpecularBRDF( dotNV, roughness );
	return specularColor * brdf.x + brdf.y;
}
void BRDF_Specular_Multiscattering_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
	float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
	vec3 F = F_Schlick_RoughnessDependent( specularColor, dotNV, roughness );
	vec2 brdf = integrateSpecularBRDF( dotNV, roughness );
	vec3 FssEss = F * brdf.x + brdf.y;
	float Ess = brdf.x + brdf.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );
	float dotNH = saturate( dot( geometry.normal, halfDir ) );
	float dotLH = saturate( dot( incidentLight.direction, halfDir ) );
	vec3 F = F_Schlick( specularColor, dotLH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
}
float GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {
	return ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );
}
float BlinnExponentToGGXRoughness( const in float blinnExponent ) {
	return sqrt( 2.0 / ( blinnExponent + 2.0 ) );
}
#if defined( USE_SHEEN )
float D_Charlie(float roughness, float NoH) {
	float invAlpha  = 1.0 / roughness;
	float cos2h = NoH * NoH;
	float sin2h = max(1.0 - cos2h, 0.0078125);	return (2.0 + invAlpha) * pow(sin2h, invAlpha * 0.5) / (2.0 * PI);
}
float V_Neubelt(float NoV, float NoL) {
	return saturate(1.0 / (4.0 * (NoL + NoV - NoL * NoV)));
}
vec3 BRDF_Specular_Sheen( const in float roughness, const in vec3 L, const in GeometricContext geometry, vec3 specularColor ) {
	vec3 N = geometry.normal;
	vec3 V = geometry.viewDir;
	vec3 H = normalize( V + L );
	float dotNH = saturate( dot( N, H ) );
	return specularColor * D_Charlie( roughness, dotNH ) * V_Neubelt( dot(N, V), dot(N, L) );
}
#endif`,bumpmap_pars_fragment:`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vUv );
		vec2 dSTdy = dFdy( vUv );
		float Hll = bumpScale * texture2D( bumpMap, vUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {
		vec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );
		vec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 );
		fDet *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,clipping_planes_fragment:`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
	}
	#pragma unroll_loop_end
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
		}
		#pragma unroll_loop_end
		if ( clipped ) discard;
	#endif
#endif`,clipping_planes_pars_fragment:`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,clipping_planes_pars_vertex:`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,clipping_planes_vertex:`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,color_fragment:`#ifdef USE_COLOR
	diffuseColor.rgb *= vColor;
#endif`,color_pars_fragment:`#ifdef USE_COLOR
	varying vec3 vColor;
#endif`,color_pars_vertex:`#ifdef USE_COLOR
	varying vec3 vColor;
#endif`,color_vertex:`#ifdef USE_COLOR
	vColor.xyz = color.xyz;
#endif`,common:`#define PI 3.14159265359
#define PI2 6.28318530718
#define PI_HALF 1.5707963267949
#define RECIPROCAL_PI 0.31830988618
#define RECIPROCAL_PI2 0.15915494
#define LOG2 1.442695
#define EPSILON 1e-6
#ifndef saturate
#define saturate(a) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement(a) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract(sin(sn) * c);
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float max3( vec3 v ) { return max( max( v.x, v.y ), v.z ); }
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
struct GeometricContext {
	vec3 position;
	vec3 normal;
	vec3 viewDir;
#ifdef CLEARCOAT
	vec3 clearcoatNormal;
#endif
};
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
vec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {
	float distance = dot( planeNormal, point - pointOnPlane );
	return - distance * planeNormal + point;
}
float sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {
	return sign( dot( point - pointOnPlane, planeNormal ) );
}
vec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {
	return lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float linearToRelativeLuminance( const in vec3 color ) {
	vec3 weights = vec3( 0.2126, 0.7152, 0.0722 );
	return dot( weights, color.rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
  return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}`,cube_uv_reflection_fragment:`#ifdef ENVMAP_TYPE_CUBE_UV
#define cubeUV_maxMipLevel 8.0
#define cubeUV_minMipLevel 4.0
#define cubeUV_maxTileSize 256.0
#define cubeUV_minTileSize 16.0
float getFace(vec3 direction) {
    vec3 absDirection = abs(direction);
    float face = -1.0;
    if (absDirection.x > absDirection.z) {
      if (absDirection.x > absDirection.y)
        face = direction.x > 0.0 ? 0.0 : 3.0;
      else
        face = direction.y > 0.0 ? 1.0 : 4.0;
    } else {
      if (absDirection.z > absDirection.y)
        face = direction.z > 0.0 ? 2.0 : 5.0;
      else
        face = direction.y > 0.0 ? 1.0 : 4.0;
    }
    return face;
}
vec2 getUV(vec3 direction, float face) {
    vec2 uv;
    if (face == 0.0) {
      uv = vec2(direction.z, direction.y) / abs(direction.x);    } else if (face == 1.0) {
      uv = vec2(-direction.x, -direction.z) / abs(direction.y);    } else if (face == 2.0) {
      uv = vec2(-direction.x, direction.y) / abs(direction.z);    } else if (face == 3.0) {
      uv = vec2(-direction.z, direction.y) / abs(direction.x);    } else if (face == 4.0) {
      uv = vec2(-direction.x, direction.z) / abs(direction.y);    } else {
      uv = vec2(direction.x, direction.y) / abs(direction.z);    }
    return 0.5 * (uv + 1.0);
}
vec3 bilinearCubeUV(sampler2D envMap, vec3 direction, float mipInt) {
  float face = getFace(direction);
  float filterInt = max(cubeUV_minMipLevel - mipInt, 0.0);
  mipInt = max(mipInt, cubeUV_minMipLevel);
  float faceSize = exp2(mipInt);
  float texelSize = 1.0 / (3.0 * cubeUV_maxTileSize);
  vec2 uv = getUV(direction, face) * (faceSize - 1.0);
  vec2 f = fract(uv);
  uv += 0.5 - f;
  if (face > 2.0) {
    uv.y += faceSize;
    face -= 3.0;
  }
  uv.x += face * faceSize;
  if(mipInt < cubeUV_maxMipLevel){
    uv.y += 2.0 * cubeUV_maxTileSize;
  }
  uv.y += filterInt * 2.0 * cubeUV_minTileSize;
  uv.x += 3.0 * max(0.0, cubeUV_maxTileSize - 2.0 * faceSize);
  uv *= texelSize;
  vec3 tl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;
  uv.x += texelSize;
  vec3 tr = envMapTexelToLinear(texture2D(envMap, uv)).rgb;
  uv.y += texelSize;
  vec3 br = envMapTexelToLinear(texture2D(envMap, uv)).rgb;
  uv.x -= texelSize;
  vec3 bl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;
  vec3 tm = mix(tl, tr, f.x);
  vec3 bm = mix(bl, br, f.x);
  return mix(tm, bm, f.y);
}
#define r0 1.0
#define v0 0.339
#define m0 -2.0
#define r1 0.8
#define v1 0.276
#define m1 -1.0
#define r4 0.4
#define v4 0.046
#define m4 2.0
#define r5 0.305
#define v5 0.016
#define m5 3.0
#define r6 0.21
#define v6 0.0038
#define m6 4.0
float roughnessToMip(float roughness) {
  float mip = 0.0;
  if (roughness >= r1) {
    mip = (r0 - roughness) * (m1 - m0) / (r0 - r1) + m0;
  } else if (roughness >= r4) {
    mip = (r1 - roughness) * (m4 - m1) / (r1 - r4) + m1;
  } else if (roughness >= r5) {
    mip = (r4 - roughness) * (m5 - m4) / (r4 - r5) + m4;
  } else if (roughness >= r6) {
    mip = (r5 - roughness) * (m6 - m5) / (r5 - r6) + m5;
  } else {
    mip = -2.0 * log2(1.16 * roughness);  }
  return mip;
}
vec4 textureCubeUV(sampler2D envMap, vec3 sampleDir, float roughness) {
  float mip = clamp(roughnessToMip(roughness), m0, cubeUV_maxMipLevel);
  float mipF = fract(mip);
  float mipInt = floor(mip);
  vec3 color0 = bilinearCubeUV(envMap, sampleDir, mipInt);
  if (mipF == 0.0) {
    return vec4(color0, 1.0);
  } else {
    vec3 color1 = bilinearCubeUV(envMap, sampleDir, mipInt + 1.0);
    return vec4(mix(color0, color1, mipF), 1.0);
  }
}
#endif`,defaultnormal_vertex:`vec3 transformedNormal = objectNormal;
#ifdef USE_INSTANCING
	mat3 m = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );
	transformedNormal = m * transformedNormal;
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	vec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,displacementmap_pars_vertex:`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,displacementmap_vertex:`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );
#endif`,emissivemap_fragment:`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vUv );
	emissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,emissivemap_pars_fragment:`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:`
vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 GammaToLinear( in vec4 value, in float gammaFactor ) {
	return vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );
}
vec4 LinearToGamma( in vec4 value, in float gammaFactor ) {
	return vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );
}
vec4 sRGBToLinear( in vec4 value ) {
	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );
}
vec4 LinearTosRGB( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}
vec4 RGBEToLinear( in vec4 value ) {
	return vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );
}
vec4 LinearToRGBE( in vec4 value ) {
	float maxComponent = max( max( value.r, value.g ), value.b );
	float fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );
	return vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );
}
vec4 RGBMToLinear( in vec4 value, in float maxRange ) {
	return vec4( value.rgb * value.a * maxRange, 1.0 );
}
vec4 LinearToRGBM( in vec4 value, in float maxRange ) {
	float maxRGB = max( value.r, max( value.g, value.b ) );
	float M = clamp( maxRGB / maxRange, 0.0, 1.0 );
	M = ceil( M * 255.0 ) / 255.0;
	return vec4( value.rgb / ( M * maxRange ), M );
}
vec4 RGBDToLinear( in vec4 value, in float maxRange ) {
	return vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );
}
vec4 LinearToRGBD( in vec4 value, in float maxRange ) {
	float maxRGB = max( value.r, max( value.g, value.b ) );
	float D = max( maxRange / maxRGB, 1.0 );
	D = clamp( floor( D ) / 255.0, 0.0, 1.0 );
	return vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );
}
const mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );
vec4 LinearToLogLuv( in vec4 value )  {
	vec3 Xp_Y_XYZp = cLogLuvM * value.rgb;
	Xp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );
	vec4 vResult;
	vResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;
	float Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;
	vResult.w = fract( Le );
	vResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;
	return vResult;
}
const mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );
vec4 LogLuvToLinear( in vec4 value ) {
	float Le = value.z * 255.0 + value.w;
	vec3 Xp_Y_XYZp;
	Xp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );
	Xp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;
	Xp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;
	vec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;
	return vec4( max( vRGB, 0.0 ), 1.0 );
}`,envmap_fragment:`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		}  else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );
	#elif defined( ENVMAP_TYPE_EQUIREC )
		reflectVec = normalize( reflectVec );
		vec2 sampleUV = equirectUv( reflectVec );
		vec4 envColor = texture2D( envMap, sampleUV );
	#elif defined( ENVMAP_TYPE_SPHERE )
		reflectVec = normalize( reflectVec );
		vec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) );
		vec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifndef ENVMAP_TYPE_CUBE_UV
		envColor = envMapTexelToLinear( envColor );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,envmap_common_pars_fragment:`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform int maxMipLevel;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,envmap_pars_fragment:`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,envmap_pars_vertex:`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,envmap_physical_pars_fragment:`#if defined( USE_ENVMAP )
	#ifdef ENVMAP_MODE_REFRACTION
		uniform float refractionRatio;
	#endif
	vec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {
		vec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );
		#ifdef ENVMAP_TYPE_CUBE
			vec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );
			#ifdef TEXTURE_LOD_EXT
				vec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );
			#else
				vec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );
			#endif
			envMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;
		#elif defined( ENVMAP_TYPE_CUBE_UV )
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
		#else
			vec4 envMapColor = vec4( 0.0 );
		#endif
		return PI * envMapColor.rgb * envMapIntensity;
	}
	float getSpecularMIPLevel( const in float roughness, const in int maxMIPLevel ) {
		float maxMIPLevelScalar = float( maxMIPLevel );
		float sigma = PI * roughness * roughness / ( 1.0 + roughness );
		float desiredMIPLevel = maxMIPLevelScalar + log2( sigma );
		return clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );
	}
	vec3 getLightProbeIndirectRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in int maxMIPLevel ) {
		#ifdef ENVMAP_MODE_REFLECTION
		  vec3 reflectVec = reflect( -viewDir, normal );
		  reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
		#else
		  vec3 reflectVec = refract( -viewDir, normal, refractionRatio );
		#endif
		reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
		float specularMIPLevel = getSpecularMIPLevel( roughness, maxMIPLevel );
		#ifdef ENVMAP_TYPE_CUBE
			vec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );
			#ifdef TEXTURE_LOD_EXT
				vec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );
			#else
				vec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );
			#endif
			envMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;
		#elif defined( ENVMAP_TYPE_CUBE_UV )
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
		#elif defined( ENVMAP_TYPE_EQUIREC )
			vec2 sampleUV = equirectUv( reflectVec );
			#ifdef TEXTURE_LOD_EXT
				vec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );
			#else
				vec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );
			#endif
			envMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;
		#elif defined( ENVMAP_TYPE_SPHERE )
			vec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0,0.0,1.0 ) );
			#ifdef TEXTURE_LOD_EXT
				vec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );
			#else
				vec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );
			#endif
			envMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;
		#endif
		return envMapColor.rgb * envMapIntensity;
	}
#endif`,envmap_vertex:`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) { 
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,fog_vertex:`#ifdef USE_FOG
	fogDepth = -mvPosition.z;
#endif`,fog_pars_vertex:`#ifdef USE_FOG
	varying float fogDepth;
#endif`,fog_fragment:`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * fogDepth * fogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, fogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,fog_pars_fragment:`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float fogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,gradientmap_pars_fragment:`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return texture2D( gradientMap, coord ).rgb;
	#else
		return ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );
	#endif
}`,lightmap_fragment:`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel= texture2D( lightMap, vUv2 );
	reflectedLight.indirectDiffuse += PI * lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;
#endif`,lightmap_pars_fragment:`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,lights_lambert_vertex:`vec3 diffuse = vec3( 1.0 );
GeometricContext geometry;
geometry.position = mvPosition.xyz;
geometry.normal = normalize( transformedNormal );
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );
GeometricContext backGeometry;
backGeometry.position = geometry.position;
backGeometry.normal = -geometry.normal;
backGeometry.viewDir = geometry.viewDir;
vLightFront = vec3( 0.0 );
vIndirectFront = vec3( 0.0 );
#ifdef DOUBLE_SIDED
	vLightBack = vec3( 0.0 );
	vIndirectBack = vec3( 0.0 );
#endif
IncidentLight directLight;
float dotNL;
vec3 directLightColor_Diffuse;
vIndirectFront += getAmbientLightIrradiance( ambientLightColor );
vIndirectFront += getLightProbeIrradiance( lightProbe, geometry );
#ifdef DOUBLE_SIDED
	vIndirectBack += getAmbientLightIrradiance( ambientLightColor );
	vIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry );
#endif
#if NUM_POINT_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		getPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = PI * directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_SPOT_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		getSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = PI * directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_DIR_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		getDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = PI * directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_HEMI_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
		vIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );
		#ifdef DOUBLE_SIDED
			vIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );
		#endif
	}
	#pragma unroll_loop_end
#endif`,lights_pars_begin:`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
uniform vec3 lightProbe[ 9 ];
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in GeometricContext geometry ) {
	vec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	return irradiance;
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	void getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {
		directLight.color = directionalLight.color;
		directLight.direction = directionalLight.direction;
		directLight.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
		struct PointLightShadow {
			float shadowBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	void getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {
		vec3 lVector = pointLight.position - geometry.position;
		directLight.direction = normalize( lVector );
		float lightDistance = length( lVector );
		directLight.color = pointLight.color;
		directLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );
		directLight.visible = ( directLight.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	void getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight  ) {
		vec3 lVector = spotLight.position - geometry.position;
		directLight.direction = normalize( lVector );
		float lightDistance = length( lVector );
		float angleCos = dot( directLight.direction, spotLight.direction );
		if ( angleCos > spotLight.coneCos ) {
			float spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );
			directLight.color = spotLight.color;
			directLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );
			directLight.visible = true;
		} else {
			directLight.color = vec3( 0.0 );
			directLight.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {
		float dotNL = dot( geometry.normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		#ifndef PHYSICALLY_CORRECT_LIGHTS
			irradiance *= PI;
		#endif
		return irradiance;
	}
#endif`,lights_toon_fragment:`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,lights_toon_pars_fragment:`varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
struct ToonMaterial {
	vec3	diffuseColor;
	vec3	specularColor;
	float	specularShininess;
	float	specularStrength;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	reflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon
#define Material_LightProbeLOD( material )	(0)`,lights_phong_fragment:`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,lights_phong_pars_fragment:`varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
struct BlinnPhongMaterial {
	vec3	diffuseColor;
	vec3	specularColor;
	float	specularShininess;
	float	specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	reflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong
#define Material_LightProbeLOD( material )	(0)`,lights_physical_fragment:`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.specularRoughness = max( roughnessFactor, 0.0525 );material.specularRoughness += geometryRoughness;
material.specularRoughness = min( material.specularRoughness, 1.0 );
#ifdef REFLECTIVITY
	material.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );
#endif
#ifdef CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheen;
#endif`,lights_physical_pars_fragment:`struct PhysicalMaterial {
	vec3	diffuseColor;
	float	specularRoughness;
	vec3	specularColor;
#ifdef CLEARCOAT
	float clearcoat;
	float clearcoatRoughness;
#endif
#ifdef USE_SHEEN
	vec3 sheenColor;
#endif
};
#define MAXIMUM_SPECULAR_COEFFICIENT 0.16
#define DEFAULT_SPECULAR_COEFFICIENT 0.04
float clearcoatDHRApprox( const in float roughness, const in float dotNL ) {
	return DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometry.normal;
		vec3 viewDir = geometry.viewDir;
		vec3 position = geometry.position;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.specularRoughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	#ifdef CLEARCOAT
		float ccDotNL = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = ccDotNL * directLight.color;
		#ifndef PHYSICALLY_CORRECT_LIGHTS
			ccIrradiance *= PI;
		#endif
		float clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );
		reflectedLight.directSpecular += ccIrradiance * material.clearcoat * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );
	#else
		float clearcoatDHR = 0.0;
	#endif
	#ifdef USE_SHEEN
		reflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_Sheen(
			material.specularRoughness,
			directLight.direction,
			geometry,
			material.sheenColor
		);
	#else
		reflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.normal, material.specularColor, material.specularRoughness);
	#endif
	reflectedLight.directDiffuse += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef CLEARCOAT
		float ccDotNV = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );
		reflectedLight.indirectSpecular += clearcoatRadiance * material.clearcoat * BRDF_Specular_GGX_Environment( geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );
		float ccDotNL = ccDotNV;
		float clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );
	#else
		float clearcoatDHR = 0.0;
	#endif
	float clearcoatInv = 1.0 - clearcoatDHR;
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	BRDF_Specular_Multiscattering_Environment( geometry, material.specularColor, material.specularRoughness, singleScattering, multiScattering );
	vec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );
	reflectedLight.indirectSpecular += clearcoatInv * radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,lights_fragment_begin:`
GeometricContext geometry;
geometry.position = - vViewPosition;
geometry.normal = normal;
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
#ifdef CLEARCOAT
	geometry.clearcoatNormal = clearcoatNormal;
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointDirectLightIrradiance( pointLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotDirectLightIrradiance( spotLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	irradiance += getLightProbeIrradiance( lightProbe, geometry );
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,lights_fragment_maps:`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel= texture2D( lightMap, vUv2 );
		vec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;
		#ifndef PHYSICALLY_CORRECT_LIGHTS
			lightMapIrradiance *= PI;
		#endif
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getLightProbeIndirectIrradiance( geometry, maxMipLevel );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	radiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.normal, material.specularRoughness, maxMipLevel );
	#ifdef CLEARCOAT
		clearcoatRadiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness, maxMipLevel );
	#endif
#endif`,lights_fragment_end:`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );
#endif`,logdepthbuf_fragment:`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,logdepthbuf_pars_fragment:`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,logdepthbuf_pars_vertex:`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,logdepthbuf_vertex:`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,map_fragment:`#ifdef USE_MAP
	vec4 texelColor = texture2D( map, vUv );
	texelColor = mapTexelToLinear( texelColor );
	diffuseColor *= texelColor;
#endif`,map_pars_fragment:`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,map_particle_fragment:`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
#endif
#ifdef USE_MAP
	vec4 mapTexel = texture2D( map, uv );
	diffuseColor *= mapTexelToLinear( mapTexel );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,map_particle_pars_fragment:`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	uniform mat3 uvTransform;
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,metalnessmap_fragment:`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vUv );
	metalnessFactor *= texelMetalness.b;
#endif`,metalnessmap_pars_fragment:`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,morphnormal_vertex:`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
	objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
	objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
	objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
#endif`,morphtarget_pars_vertex:`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifndef USE_MORPHNORMALS
	uniform float morphTargetInfluences[ 8 ];
	#else
	uniform float morphTargetInfluences[ 4 ];
	#endif
#endif`,morphtarget_vertex:`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	transformed += morphTarget0 * morphTargetInfluences[ 0 ];
	transformed += morphTarget1 * morphTargetInfluences[ 1 ];
	transformed += morphTarget2 * morphTargetInfluences[ 2 ];
	transformed += morphTarget3 * morphTargetInfluences[ 3 ];
	#ifndef USE_MORPHNORMALS
	transformed += morphTarget4 * morphTargetInfluences[ 4 ];
	transformed += morphTarget5 * morphTargetInfluences[ 5 ];
	transformed += morphTarget6 * morphTargetInfluences[ 6 ];
	transformed += morphTarget7 * morphTargetInfluences[ 7 ];
	#endif
#endif`,normal_fragment_begin:`#ifdef FLAT_SHADED
	vec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );
	vec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );
	#endif
	#ifdef USE_TANGENT
		vec3 tangent = normalize( vTangent );
		vec3 bitangent = normalize( vBitangent );
		#ifdef DOUBLE_SIDED
			tangent = tangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );
			bitangent = bitangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );
		#endif
		#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )
			mat3 vTBN = mat3( tangent, bitangent, normal );
		#endif
	#endif
#endif
vec3 geometryNormal = normal;`,normal_fragment_maps:`#ifdef OBJECTSPACE_NORMALMAP
	normal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( TANGENTSPACE_NORMALMAP )
	vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	#ifdef USE_TANGENT
		normal = normalize( vTBN * mapN );
	#else
		normal = perturbNormal2Arb( -vViewPosition, normal, mapN );
	#endif
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );
#endif`,normalmap_pars_fragment:`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef OBJECTSPACE_NORMALMAP
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )
	vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN ) {
		vec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );
		vec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );
		vec2 st0 = dFdx( vUv.st );
		vec2 st1 = dFdy( vUv.st );
		float scale = sign( st1.t * st0.s - st0.t * st1.s );
		vec3 S = normalize( ( q0 * st1.t - q1 * st0.t ) * scale );
		vec3 T = normalize( ( - q0 * st1.s + q1 * st0.s ) * scale );
		vec3 N = normalize( surf_norm );
		mat3 tsn = mat3( S, T, N );
		mapN.xy *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );
		return normalize( tsn * mapN );
	}
#endif`,clearcoat_normal_fragment_begin:`#ifdef CLEARCOAT
	vec3 clearcoatNormal = geometryNormal;
#endif`,clearcoat_normal_fragment_maps:`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	#ifdef USE_TANGENT
		clearcoatNormal = normalize( vTBN * clearcoatMapN );
	#else
		clearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN );
	#endif
#endif`,clearcoat_pars_fragment:`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif`,packing:`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ));
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w);
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {
	return linearClipZ * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return (( near + viewZ ) * far ) / (( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * invClipZ - far );
}`,premultiplied_alpha_fragment:`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,project_vertex:`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,dithering_fragment:`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,dithering_pars_fragment:`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,roughnessmap_fragment:`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vUv );
	roughnessFactor *= texelRoughness.g;
#endif`,roughnessmap_pars_fragment:`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,shadowmap_pars_fragment:`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );
		bool inFrustum = all( inFrustumVec );
		bvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );
		bool frustumTest = all( frustumTestVec );
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), 
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), 
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,shadowmap_pars_vertex:`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];
		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,shadowmap_vertex:`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * worldPosition;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		vSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * worldPosition;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * worldPosition;
	}
	#pragma unroll_loop_end
	#endif
#endif`,shadowmask_pars_fragment:`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,skinbase_vertex:`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,skinning_pars_vertex:`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	#ifdef BONE_TEXTURE
		uniform highp sampler2D boneTexture;
		uniform int boneTextureSize;
		mat4 getBoneMatrix( const in float i ) {
			float j = i * 4.0;
			float x = mod( j, float( boneTextureSize ) );
			float y = floor( j / float( boneTextureSize ) );
			float dx = 1.0 / float( boneTextureSize );
			float dy = 1.0 / float( boneTextureSize );
			y = dy * ( y + 0.5 );
			vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );
			vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );
			vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );
			vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );
			mat4 bone = mat4( v1, v2, v3, v4 );
			return bone;
		}
	#else
		uniform mat4 boneMatrices[ MAX_BONES ];
		mat4 getBoneMatrix( const in float i ) {
			mat4 bone = boneMatrices[ int(i) ];
			return bone;
		}
	#endif
#endif`,skinning_vertex:`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,skinnormal_vertex:`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,specularmap_fragment:`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,specularmap_pars_fragment:`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,tonemapping_fragment:`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,tonemapping_pars_fragment:`#ifndef saturate
#define saturate(a) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
uniform float toneMappingWhitePoint;
vec3 LinearToneMapping( vec3 color ) {
	return toneMappingExposure * color;
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
#define Uncharted2Helper( x ) max( ( ( x * ( 0.15 * x + 0.10 * 0.50 ) + 0.20 * 0.02 ) / ( x * ( 0.15 * x + 0.50 ) + 0.20 * 0.30 ) ) - 0.02 / 0.30, vec3( 0.0 ) )
vec3 Uncharted2ToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( Uncharted2Helper( color ) / Uncharted2Helper( vec3( toneMappingWhitePoint ) ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( ( color * ( 2.51 * color + 0.03 ) ) / ( color * ( 2.43 * color + 0.59 ) + 0.14 ) );
}`,uv_pars_fragment:`#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )
	varying vec2 vUv;
#endif`,uv_pars_vertex:`#ifdef USE_UV
	#ifdef UVS_VERTEX_ONLY
		vec2 vUv;
	#else
		varying vec2 vUv;
	#endif
	uniform mat3 uvTransform;
#endif`,uv_vertex:`#ifdef USE_UV
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
#endif`,uv2_pars_fragment:`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	varying vec2 vUv2;
#endif`,uv2_pars_vertex:`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	attribute vec2 uv2;
	varying vec2 vUv2;
	uniform mat3 uv2Transform;
#endif`,uv2_vertex:`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	vUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;
#endif`,worldpos_vertex:`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`,background_frag:`uniform sampler2D t2D;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	gl_FragColor = mapTexelToLinear( texColor );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,background_vert:`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,cube_frag:`#include <envmap_common_pars_fragment>
uniform float opacity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	vec3 vReflect = vWorldDirection;
	#include <envmap_fragment>
	gl_FragColor = envColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,cube_vert:`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,depth_frag:`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,depth_vert:`#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,distanceRGBA_frag:`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,distanceRGBA_vert:`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,equirect_frag:`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	vec4 texColor = texture2D( tEquirect, sampleUV );
	gl_FragColor = mapTexelToLinear( texColor );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,equirect_vert:`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,linedashed_frag:`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,linedashed_vert:`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <color_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,meshbasic_frag:`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
	
		vec4 lightMapTexel= texture2D( lightMap, vUv2 );
		reflectedLight.indirectDiffuse += lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshbasic_vert:`#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <skinbase_vertex>
	#ifdef USE_ENVMAP
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,meshlambert_frag:`uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
varying vec3 vLightFront;
varying vec3 vIndirectFront;
#ifdef DOUBLE_SIDED
	varying vec3 vLightBack;
	varying vec3 vIndirectBack;
#endif
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <fog_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <emissivemap_fragment>
	#ifdef DOUBLE_SIDED
		reflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;
	#else
		reflectedLight.indirectDiffuse += vIndirectFront;
	#endif
	#include <lightmap_fragment>
	reflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );
	#ifdef DOUBLE_SIDED
		reflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;
	#else
		reflectedLight.directDiffuse = vLightFront;
	#endif
	reflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshlambert_vert:`#define LAMBERT
varying vec3 vLightFront;
varying vec3 vIndirectFront;
#ifdef DOUBLE_SIDED
	varying vec3 vLightBack;
	varying vec3 vIndirectBack;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <bsdfs>
#include <lights_pars_begin>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <lights_lambert_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,meshmatcap_frag:`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <fog_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
		matcapColor = matcapTexelToLinear( matcapColor );
	#else
		vec4 matcapColor = vec4( 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshmatcap_vert:`#define MATCAP
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#ifndef FLAT_SHADED
		vNormal = normalize( transformedNormal );
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,meshtoon_frag:`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshtoon_vert:`#define TOON
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,meshphong_frag:`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshphong_vert:`#define PHONG
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,meshphysical_frag:`#define STANDARD
#ifdef PHYSICAL
	#define REFLECTIVITY
	#define CLEARCOAT
	#define TRANSPARENCY
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef TRANSPARENCY
	uniform float transparency;
#endif
#ifdef REFLECTIVITY
	uniform float reflectivity;
#endif
#ifdef CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheen;
#endif
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <bsdfs>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <lights_physical_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#ifdef TRANSPARENCY
		diffuseColor.a *= saturate( 1. - transparency + linearToRelativeLuminance( reflectedLight.directSpecular + reflectedLight.indirectSpecular ) );
	#endif
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshphysical_vert:`#define STANDARD
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,normal_frag:`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <packing>
#include <uv_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
}`,normal_vert:`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	vViewPosition = - mvPosition.xyz;
#endif
}`,points_frag:`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,points_vert:`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <color_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,shadow_frag:`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,shadow_vert:`#include <fog_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <begin_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,sprite_frag:`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,sprite_vert:`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`},ll={basic:{uniforms:de([or.common,or.specularmap,or.envmap,or.aomap,or.lightmap,or.fog]),vertexShader:mi.meshbasic_vert,fragmentShader:mi.meshbasic_frag},lambert:{uniforms:de([or.common,or.specularmap,or.envmap,or.aomap,or.lightmap,or.emissivemap,or.fog,or.lights,{emissive:{value:new wt(0)}}]),vertexShader:mi.meshlambert_vert,fragmentShader:mi.meshlambert_frag},phong:{uniforms:de([or.common,or.specularmap,or.envmap,or.aomap,or.lightmap,or.emissivemap,or.bumpmap,or.normalmap,or.displacementmap,or.fog,or.lights,{emissive:{value:new wt(0)},specular:{value:new wt(1118481)},shininess:{value:30}}]),vertexShader:mi.meshphong_vert,fragmentShader:mi.meshphong_frag},standard:{uniforms:de([or.common,or.envmap,or.aomap,or.lightmap,or.emissivemap,or.bumpmap,or.normalmap,or.displacementmap,or.roughnessmap,or.metalnessmap,or.fog,or.lights,{emissive:{value:new wt(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:mi.meshphysical_vert,fragmentShader:mi.meshphysical_frag},toon:{uniforms:de([or.common,or.specularmap,or.aomap,or.lightmap,or.emissivemap,or.bumpmap,or.normalmap,or.displacementmap,or.gradientmap,or.fog,or.lights,{emissive:{value:new wt(0)},specular:{value:new wt(1118481)},shininess:{value:30}}]),vertexShader:mi.meshtoon_vert,fragmentShader:mi.meshtoon_frag},matcap:{uniforms:de([or.common,or.bumpmap,or.normalmap,or.displacementmap,or.fog,{matcap:{value:null}}]),vertexShader:mi.meshmatcap_vert,fragmentShader:mi.meshmatcap_frag},points:{uniforms:de([or.points,or.fog]),vertexShader:mi.points_vert,fragmentShader:mi.points_frag},dashed:{uniforms:de([or.common,or.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:mi.linedashed_vert,fragmentShader:mi.linedashed_frag},depth:{uniforms:de([or.common,or.displacementmap]),vertexShader:mi.depth_vert,fragmentShader:mi.depth_frag},normal:{uniforms:de([or.common,or.bumpmap,or.normalmap,or.displacementmap,{opacity:{value:1}}]),vertexShader:mi.normal_vert,fragmentShader:mi.normal_frag},sprite:{uniforms:de([or.sprite,or.fog]),vertexShader:mi.sprite_vert,fragmentShader:mi.sprite_frag},background:{uniforms:{uvTransform:{value:new c},t2D:{value:null}},vertexShader:mi.background_vert,fragmentShader:mi.background_frag},cube:{uniforms:de([or.envmap,{opacity:{value:1}}]),vertexShader:mi.cube_vert,fragmentShader:mi.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:mi.equirect_vert,fragmentShader:mi.equirect_frag},distanceRGBA:{uniforms:de([or.common,or.displacementmap,{referencePosition:{value:new w},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:mi.distanceRGBA_vert,fragmentShader:mi.distanceRGBA_frag},shadow:{uniforms:de([or.lights,or.fog,{color:{value:new wt(0)},opacity:{value:1}}]),vertexShader:mi.shadow_vert,fragmentShader:mi.shadow_frag}};ll.physical={uniforms:de([ll.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new f(1,1)},clearcoatNormalMap:{value:null},sheen:{value:new wt(0)},transparency:{value:0}}]),vertexShader:mi.meshphysical_vert,fragmentShader:mi.meshphysical_frag},wa.prototype=ft(d.prototype),wa.prototype.constructor=wa,wa.prototype.isCubeTexture=!0,Object.defineProperty(wa.prototype,"images",{get:function(){return this.image},set:function(e){this.image=e}}),ko.prototype=ft(d.prototype),ko.prototype.constructor=ko,ko.prototype.isDataTexture2DArray=!0,os.prototype=ft(d.prototype),os.prototype.constructor=os,os.prototype.isDataTexture3D=!0;var AT=new d,Y5=new ko,Z5=new os,_T=new wa,wT=[],MT=[],CT=new Float32Array(16),TT=new Float32Array(9),ST=new Float32Array(4);I3.prototype.updateCache=function(e){var n=this.cache;e instanceof Float32Array&&n.length!==e.length&&(this.cache=new Float32Array(e.length)),To(n,e)},E3.prototype.setValue=function(e,n,u){for(var m=this.seq,_=0,T=m.length;_!==T;++_){var R=m[_];R.setValue(e,n[R.id],u)}};var bw=/([\w\d_]+)(\])?(\[|\.)?/g;Mc.prototype.setValue=function(e,n,u,m){n=this.map[n],n!==void 0&&n.setValue(e,u,m)},Mc.prototype.setOptional=function(e,n,u){n=n[u],n!==void 0&&this.setValue(e,u,n)},Mc.upload=function(e,n,u,m){for(var _=0,T=n.length;_!==T;++_){var R=n[_],N=u[R.id];N.needsUpdate!==!1&&R.setValue(e,N.value,m)}},Mc.seqWithValue=function(e,n){for(var u=[],m=0,_=e.length;m!==_;++m){var T=e[m];T.id in n&&u.push(T)}return u};var q5=0,kw=/^[ \t]*#include +<([\w\d./]+)>/gm,IT=/#pragma unroll_loop[\s]+?for \( int i = (\d+); i < (\d+); i \+\+ \) \{([\s\S]+?)(?=\})\}/g,ET=/#pragma unroll_loop_start[\s]+?for \( int i = (\d+); i < (\d+); i \+\+ \) \{([\s\S]+?)(?=\})\}[\s]+?#pragma unroll_loop_end/g,J5=0;Cc.prototype=ft(Qt.prototype),Cc.prototype.constructor=Cc,Cc.prototype.isMeshDepthMaterial=!0,Cc.prototype.copy=function(e){return Qt.prototype.copy.call(this,e),this.depthPacking=e.depthPacking,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this},Tc.prototype=ft(Qt.prototype),Tc.prototype.constructor=Tc,Tc.prototype.isMeshDistanceMaterial=!0,Tc.prototype.copy=function(e){return Qt.prototype.copy.call(this,e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this},sx.prototype=pt(ft(Ae.prototype),{constructor:sx,isArrayCamera:!0}),tm.prototype=pt(ft(F.prototype),{constructor:tm,isGroup:!0}),pt(ax.prototype,{constructor:ax,getTargetRaySpace:function(){return this._targetRay===null&&(this._targetRay=new tm,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1),this._targetRay},getGripSpace:function(){return this._grip===null&&(this._grip=new tm,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1),this._grip},dispatchEvent:function(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this},disconnect:function(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this},update:function(e,n,u){var m=null,_=null,T=this._targetRay,R=this._grip;return e&&(T!==null&&(m=n.getPose(e.targetRaySpace,u),m!==null&&(T.matrix.fromArray(m.transform.matrix),T.matrix.decompose(T.position,T.rotation,T.scale))),R!==null&&e.gripSpace&&(_=n.getPose(e.gripSpace,u),_!==null&&(R.matrix.fromArray(_.transform.matrix),R.matrix.decompose(R.position,R.rotation,R.scale)))),T!==null&&(T.visible=m!==null),R!==null&&(R.visible=_!==null),this}}),pt(k3.prototype,s.prototype),pt(ux.prototype,{isFogExp2:!0,clone:function(){return new ux(this.color,this.density)},toJSON:function(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}),pt(lx.prototype,{isFog:!0,clone:function(){return new lx(this.color,this.near,this.far)},toJSON:function(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}),Object.defineProperty(sh.prototype,"needsUpdate",{set:function(e){e===!0&&this.version++}}),pt(sh.prototype,{isInterleavedBuffer:!0,onUploadCallback:function(){},setUsage:function(e){return this.usage=e,this},copy:function(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this},copyAt:function(e,n,u){e*=this.stride,u*=n.stride;for(var m=0,_=this.stride;m<_;m++)this.array[e+m]=n.array[u+m];return this},set:function(e,n){return n===void 0&&(n=0),this.array.set(e,n),this},clone:function(){return new this.constructor().copy(this)},onUpload:function(e){return this.onUploadCallback=e,this}});var Bp=new w;Or(Hv.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}}}),pt(Hv.prototype,{isInterleavedBufferAttribute:!0,applyMatrix4:function(e){for(var n=0,u=this.data.count;n<u;n++)Bp.x=this.getX(n),Bp.y=this.getY(n),Bp.z=this.getZ(n),Bp.applyMatrix4(e),this.setXYZ(n,Bp.x,Bp.y,Bp.z);return this},setX:function(e,n){return this.data.array[e*this.data.stride+this.offset]=n,this},setY:function(e,n){return this.data.array[e*this.data.stride+this.offset+1]=n,this},setZ:function(e,n){return this.data.array[e*this.data.stride+this.offset+2]=n,this},setW:function(e,n){return this.data.array[e*this.data.stride+this.offset+3]=n,this},getX:function(e){return this.data.array[e*this.data.stride+this.offset]},getY:function(e){return this.data.array[e*this.data.stride+this.offset+1]},getZ:function(e){return this.data.array[e*this.data.stride+this.offset+2]},getW:function(e){return this.data.array[e*this.data.stride+this.offset+3]},setXY:function(e,n,u){return e=e*this.data.stride+this.offset,this.data.array[e+0]=n,this.data.array[e+1]=u,this},setXYZ:function(e,n,u,m){return e=e*this.data.stride+this.offset,this.data.array[e+0]=n,this.data.array[e+1]=u,this.data.array[e+2]=m,this},setXYZW:function(e,n,u,m,_){return e=e*this.data.stride+this.offset,this.data.array[e+0]=n,this.data.array[e+1]=u,this.data.array[e+2]=m,this.data.array[e+3]=_,this},clone:function(){for(var e=[],n=0;n<this.count;n++)for(var u=n*this.data.stride+this.offset,m=0;m<this.itemSize;m++)e.push(this.data.array[u+m]);return new re(new this.array.constructor(e),this.itemSize,this.normalized)},toJSON:function(){for(var e=[],n=0;n<this.count;n++)for(var u=n*this.data.stride+this.offset,m=0;m<this.itemSize;m++)e.push(this.data.array[u+m]);return{itemSize:this.itemSize,type:this.array.constructor.name,array:e,normalized:this.normalized}}}),Sc.prototype=ft(Qt.prototype),Sc.prototype.constructor=Sc,Sc.prototype.isSpriteMaterial=!0,Sc.prototype.copy=function(e){return Qt.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this};var bm,E0=new w,km=new w,Hm=new w,Gm=new f,L0=new f,LT=new I,i2=new w,R0=new w,n2=new w,RT=new f,Hw=new f,PT=new f;Gv.prototype=pt(ft(F.prototype),{constructor:Gv,isSprite:!0,raycast:function(e,n){e.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),km.setFromMatrixScale(this.matrixWorld),LT.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),Hm.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&km.multiplyScalar(-Hm.z);var u=this.material.rotation;if(u!==0)var m=Math.cos(u),_=Math.sin(u);u=this.center,hx(i2.set(-.5,-.5,0),Hm,u,km,_,m),hx(R0.set(.5,-.5,0),Hm,u,km,_,m),hx(n2.set(.5,.5,0),Hm,u,km,_,m),RT.set(0,0),Hw.set(1,0),PT.set(1,1);var T=e.ray.intersectTriangle(i2,R0,n2,!1,E0);T===null&&(hx(R0.set(-.5,.5,0),Hm,u,km,_,m),Hw.set(0,1),T=e.ray.intersectTriangle(i2,n2,R0,!1,E0),T===null)||(_=e.ray.origin.distanceTo(E0),_<e.near||_>e.far||n.push({distance:_,point:E0.clone(),uv:Ct.getUV(E0,i2,R0,n2,RT,Hw,PT,new f),face:null,object:this}))},clone:function(){return new this.constructor(this.material).copy(this)},copy:function(e){return F.prototype.copy.call(this,e),e.center!==void 0&&this.center.copy(e.center),this}});var o2=new w,DT=new w;Vv.prototype=pt(ft(F.prototype),{constructor:Vv,isLOD:!0,copy:function(e){F.prototype.copy.call(this,e,!1);for(var n=e.levels,u=0,m=n.length;u<m;u++){var _=n[u];this.addLevel(_.object.clone(),_.distance)}return this.autoUpdate=e.autoUpdate,this},addLevel:function(e,n){n===void 0&&(n=0),n=Math.abs(n);for(var u=this.levels,m=0;m<u.length&&!(n<u[m].distance);m++);return u.splice(m,0,{distance:n,object:e}),this.add(e),this},getCurrentLevel:function(){return this._currentLevel},getObjectForDistance:function(e){var n=this.levels;if(0<n.length){for(var u=1,m=n.length;u<m&&!(e<n[u].distance);u++);return n[u-1].object}return null},raycast:function(e,n){if(0<this.levels.length){o2.setFromMatrixPosition(this.matrixWorld);var u=e.ray.origin.distanceTo(o2);this.getObjectForDistance(u).raycast(e,n)}},update:function(e){var n=this.levels;if(1<n.length){o2.setFromMatrixPosition(e.matrixWorld),DT.setFromMatrixPosition(this.matrixWorld),e=o2.distanceTo(DT)/e.zoom,n[0].object.visible=!0;for(var u=1,m=n.length;u<m&&e>=n[u].distance;u++)n[u-1].object.visible=!1,n[u].object.visible=!0;for(this._currentLevel=u-1;u<m;u++)n[u].object.visible=!1}},toJSON:function(e){e=F.prototype.toJSON.call(this,e),this.autoUpdate===!1&&(e.object.autoUpdate=!1),e.object.levels=[];for(var n=this.levels,u=0,m=n.length;u<m;u++){var _=n[u];e.object.levels.push({object:_.object.uuid,distance:_.distance})}return e}}),cx.prototype=pt(ft(Pt.prototype),{constructor:cx,isSkinnedMesh:!0,bind:function(e,n){this.skeleton=e,n===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),n=this.matrixWorld),this.bindMatrix.copy(n),this.bindMatrixInverse.getInverse(n)},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){for(var e=new p,n=this.geometry.attributes.skinWeight,u=0,m=n.count;u<m;u++){e.x=n.getX(u),e.y=n.getY(u),e.z=n.getZ(u),e.w=n.getW(u);var _=1/e.manhattanLength();_!==1/0?e.multiplyScalar(_):e.set(1,0,0,0),n.setXYZW(u,e.x,e.y,e.z,e.w)}},updateMatrixWorld:function(e){Pt.prototype.updateMatrixWorld.call(this,e),this.bindMode==="attached"?this.bindMatrixInverse.getInverse(this.matrixWorld):this.bindMode==="detached"?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)},boneTransform:function(){var e=new w,n=new p,u=new p,m=new w,_=new I;return function(T,R){var N=this.skeleton,H=this.geometry;for(n.fromBufferAttribute(H.attributes.skinIndex,T),u.fromBufferAttribute(H.attributes.skinWeight,T),e.fromBufferAttribute(H.attributes.position,T).applyMatrix4(this.bindMatrix),R.set(0,0,0),T=0;4>T;T++)if(H=u.getComponent(T),H!==0){var W=n.getComponent(T);_.multiplyMatrices(N.bones[W].matrixWorld,N.boneInverses[W]),R.addScaledVector(m.copy(e).applyMatrix4(_),H)}return R.applyMatrix4(this.bindMatrixInverse)}}()});var OT=new I,Q5=new I;pt(fx.prototype,{calculateInverses:function(){this.boneInverses=[];for(var e=0,n=this.bones.length;e<n;e++){var u=new I;this.bones[e]&&u.getInverse(this.bones[e].matrixWorld),this.boneInverses.push(u)}},pose:function(){var e,n,u=0;for(n=this.bones.length;u<n;u++)(e=this.bones[u])&&e.matrixWorld.getInverse(this.boneInverses[u]);for(u=0,n=this.bones.length;u<n;u++)(e=this.bones[u])&&(e.parent&&e.parent.isBone?(e.matrix.getInverse(e.parent.matrixWorld),e.matrix.multiply(e.matrixWorld)):e.matrix.copy(e.matrixWorld),e.matrix.decompose(e.position,e.quaternion,e.scale))},update:function(){for(var e=this.bones,n=this.boneInverses,u=this.boneMatrices,m=this.boneTexture,_=0,T=e.length;_<T;_++)OT.multiplyMatrices(e[_]?e[_].matrixWorld:Q5,n[_]),OT.toArray(u,16*_);m!==void 0&&(m.needsUpdate=!0)},clone:function(){return new fx(this.bones,this.boneInverses)},getBoneByName:function(e){for(var n=0,u=this.bones.length;n<u;n++){var m=this.bones[n];if(m.name===e)return m}},dispose:function(){this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=void 0)}}),W_.prototype=pt(ft(F.prototype),{constructor:W_,isBone:!0});var FT=new I,BT=new I,s2=[],P0=new Pt;px.prototype=pt(ft(Pt.prototype),{constructor:px,isInstancedMesh:!0,getMatrixAt:function(e,n){n.fromArray(this.instanceMatrix.array,16*e)},raycast:function(e,n){var u=this.matrixWorld,m=this.count;if(P0.geometry=this.geometry,P0.material=this.material,P0.material!==void 0)for(var _=0;_<m;_++){this.getMatrixAt(_,FT),BT.multiplyMatrices(u,FT),P0.matrixWorld=BT,P0.raycast(e,s2);for(var T=0,R=s2.length;T<R;T++){var N=s2[T];N.instanceId=_,N.object=this,n.push(N)}s2.length=0}},setMatrixAt:function(e,n){n.toArray(this.instanceMatrix.array,16*e)},updateMorphTargets:function(){}}),gn.prototype=ft(Qt.prototype),gn.prototype.constructor=gn,gn.prototype.isLineBasicMaterial=!0,gn.prototype.copy=function(e){return Qt.prototype.copy.call(this,e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.morphTargets=e.morphTargets,this};var zT=new w,NT=new w,UT=new I,a2=new lt,u2=new it;js.prototype=pt(ft(F.prototype),{constructor:js,isLine:!0,computeLineDistances:function(){var e=this.geometry;if(e.isBufferGeometry)if(e.index===null){for(var n=e.attributes.position,u=[0],m=1,_=n.count;m<_;m++)zT.fromBufferAttribute(n,m-1),NT.fromBufferAttribute(n,m),u[m]=u[m-1],u[m]+=zT.distanceTo(NT);e.setAttribute("lineDistance",new _t(u,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(e.isGeometry)for(n=e.vertices,u=e.lineDistances,u[0]=0,m=1,_=n.length;m<_;m++)u[m]=u[m-1],u[m]+=n[m-1].distanceTo(n[m]);return this},raycast:function(e,n){var u=this.geometry,m=this.matrixWorld,_=e.params.Line.threshold;if(u.boundingSphere===null&&u.computeBoundingSphere(),u2.copy(u.boundingSphere),u2.applyMatrix4(m),u2.radius+=_,e.ray.intersectsSphere(u2)!==!1){UT.getInverse(m),a2.copy(e.ray).applyMatrix4(UT),m=_/((this.scale.x+this.scale.y+this.scale.z)/3),m*=m;var T=new w,R=new w;_=new w;var N=new w,H=this&&this.isLineSegments?2:1;if(u.isBufferGeometry){var W=u.index,$=u.attributes.position.array;if(W!==null){W=W.array,u=0;for(var K=W.length-1;u<K;u+=H){var rt=W[u+1];T.fromArray($,3*W[u]),R.fromArray($,3*rt),rt=a2.distanceSqToSegment(T,R,N,_),rt>m||(N.applyMatrix4(this.matrixWorld),rt=e.ray.origin.distanceTo(N),rt<e.near||rt>e.far||n.push({distance:rt,point:_.clone().applyMatrix4(this.matrixWorld),index:u,face:null,faceIndex:null,object:this}))}}else for(u=0,K=$.length/3-1;u<K;u+=H)T.fromArray($,3*u),R.fromArray($,3*u+3),rt=a2.distanceSqToSegment(T,R,N,_),rt>m||(N.applyMatrix4(this.matrixWorld),rt=e.ray.origin.distanceTo(N),rt<e.near||rt>e.far||n.push({distance:rt,point:_.clone().applyMatrix4(this.matrixWorld),index:u,face:null,faceIndex:null,object:this}))}else if(u.isGeometry)for(T=u.vertices,R=T.length,u=0;u<R-1;u+=H)rt=a2.distanceSqToSegment(T[u],T[u+1],N,_),rt>m||(N.applyMatrix4(this.matrixWorld),rt=e.ray.origin.distanceTo(N),rt<e.near||rt>e.far||n.push({distance:rt,point:_.clone().applyMatrix4(this.matrixWorld),index:u,face:null,faceIndex:null,object:this}))}},updateMorphTargets:function(){var e=this.geometry;if(e.isBufferGeometry){e=e.morphAttributes;var n=Ti(e);if(0<n.length){var u=e[n[0]];if(u!==void 0)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},e=0,n=u.length;e<n;e++){var m=u[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[m]=e}}}else e=e.morphTargets,e!==void 0&&0<e.length&&console.error("THREE.Line.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});var l2=new w,h2=new w;In.prototype=pt(ft(js.prototype),{constructor:In,isLineSegments:!0,computeLineDistances:function(){var e=this.geometry;if(e.isBufferGeometry)if(e.index===null){for(var n=e.attributes.position,u=[],m=0,_=n.count;m<_;m+=2)l2.fromBufferAttribute(n,m),h2.fromBufferAttribute(n,m+1),u[m]=m===0?0:u[m-1],u[m+1]=u[m]+l2.distanceTo(h2);e.setAttribute("lineDistance",new _t(u,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(e.isGeometry)for(n=e.vertices,u=e.lineDistances,m=0,_=n.length;m<_;m+=2)l2.copy(n[m]),h2.copy(n[m+1]),u[m]=m===0?0:u[m-1],u[m+1]=u[m]+l2.distanceTo(h2);return this}}),dx.prototype=pt(ft(js.prototype),{constructor:dx,isLineLoop:!0}),lu.prototype=ft(Qt.prototype),lu.prototype.constructor=lu,lu.prototype.isPointsMaterial=!0,lu.prototype.copy=function(e){return Qt.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.morphTargets=e.morphTargets,this};var bT=new I,Gw=new lt,c2=new it,f2=new w;em.prototype=pt(ft(F.prototype),{constructor:em,isPoints:!0,raycast:function(e,n){var u=this.geometry,m=this.matrixWorld,_=e.params.Points.threshold;if(u.boundingSphere===null&&u.computeBoundingSphere(),c2.copy(u.boundingSphere),c2.applyMatrix4(m),c2.radius+=_,e.ray.intersectsSphere(c2)!==!1)if(bT.getInverse(m),Gw.copy(e.ray).applyMatrix4(bT),_/=(this.scale.x+this.scale.y+this.scale.z)/3,_*=_,u.isBufferGeometry){var T=u.index;if(u=u.attributes.position.array,T!==null){var R=T.array;T=0;for(var N=R.length;T<N;T++){var H=R[T];f2.fromArray(u,3*H),j_(f2,H,_,m,e,n,this)}}else for(T=0,R=u.length/3;T<R;T++)f2.fromArray(u,3*T),j_(f2,T,_,m,e,n,this)}else for(u=u.vertices,T=0,R=u.length;T<R;T++)j_(u[T],T,_,m,e,n,this)},updateMorphTargets:function(){var e=this.geometry;if(e.isBufferGeometry){e=e.morphAttributes;var n=Ti(e);if(0<n.length){var u=e[n[0]];if(u!==void 0)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},e=0,n=u.length;e<n;e++){var m=u[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[m]=e}}}else e=e.morphTargets,e!==void 0&&0<e.length&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),X_.prototype=pt(ft(d.prototype),{constructor:X_,isVideoTexture:!0,update:function(){var e=this.image;e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}),rm.prototype=ft(d.prototype),rm.prototype.constructor=rm,rm.prototype.isCompressedTexture=!0,Wv.prototype=ft(d.prototype),Wv.prototype.constructor=Wv,Wv.prototype.isCanvasTexture=!0,jv.prototype=ft(d.prototype),jv.prototype.constructor=jv,jv.prototype.isDepthTexture=!0,im.prototype=ft(vt.prototype),im.prototype.constructor=im,Xv.prototype=ft(yt.prototype),Xv.prototype.constructor=Xv,nm.prototype=ft(vt.prototype),nm.prototype.constructor=nm,Yv.prototype=ft(yt.prototype),Yv.prototype.constructor=Yv,Cs.prototype=ft(vt.prototype),Cs.prototype.constructor=Cs,Zv.prototype=ft(yt.prototype),Zv.prototype.constructor=Zv,om.prototype=ft(Cs.prototype),om.prototype.constructor=om,qv.prototype=ft(yt.prototype),qv.prototype.constructor=qv,vp.prototype=ft(Cs.prototype),vp.prototype.constructor=vp,Jv.prototype=ft(yt.prototype),Jv.prototype.constructor=Jv,sm.prototype=ft(Cs.prototype),sm.prototype.constructor=sm,Qv.prototype=ft(yt.prototype),Qv.prototype.constructor=Qv,am.prototype=ft(Cs.prototype),am.prototype.constructor=am,Kv.prototype=ft(yt.prototype),Kv.prototype.constructor=Kv,yp.prototype=ft(vt.prototype),yp.prototype.constructor=yp,yp.prototype.toJSON=function(){var e=vt.prototype.toJSON.call(this);return e.path=this.parameters.path.toJSON(),e},$v.prototype=ft(yt.prototype),$v.prototype.constructor=$v,um.prototype=ft(vt.prototype),um.prototype.constructor=um,t0.prototype=ft(yt.prototype),t0.prototype.constructor=t0,lm.prototype=ft(vt.prototype),lm.prototype.constructor=lm;var K5={triangulate:function(e,n,u){u=u||2;var m=n&&n.length,_=m?n[0]*u:e.length,T=H3(e,0,_,u,!0),R=[];if(!T||T.next===T.prev)return R;var N;if(m){var H=u;m=[];var W,$=0;for(W=n.length;$<W;$++){var K=n[$]*H,rt=$<W-1?n[$+1]*H:e.length;K=H3(e,K,rt,H,!1),K===K.next&&(K.steiner=!0),m.push(R5(K))}for(m.sort(E5),$=0;$<m.length;$++)H=m[$],n=T,(n=L5(H,n))&&(H=V3(n,H),Ic(n,n.next),Ic(H,H.next)),T=Ic(T,T.next)}if(e.length>80*u){var et=N=e[0],at=m=e[1];for(H=u;H<_;H+=u)$=e[H],n=e[H+1],$<et&&(et=$),n<at&&(at=n),$>N&&(N=$),n>m&&(m=n);N=Math.max(N-et,m-at),N=N!==0?1/N:0}return e0(T,R,u,et,at,N),R}},vh={area:function(e){for(var n=e.length,u=0,m=n-1,_=0;_<n;m=_++)u+=e[m].x*e[_].y-e[_].x*e[m].y;return .5*u},isClockWise:function(e){return 0>vh.area(e)},triangulateShape:function(e,n){var u=[],m=[],_=[];j3(e),X3(u,e);var T=e.length;for(n.forEach(j3),e=0;e<n.length;e++)m.push(T),T+=n[e].length,X3(u,n[e]);for(n=K5.triangulate(u,m),e=0;e<n.length;e+=3)_.push(n.slice(e,e+3));return _}};xp.prototype=ft(yt.prototype),xp.prototype.constructor=xp,xp.prototype.toJSON=function(){var e=yt.prototype.toJSON.call(this);return Y3(this.parameters.shapes,this.parameters.options,e)},rl.prototype=ft(vt.prototype),rl.prototype.constructor=rl,rl.prototype.toJSON=function(){var e=vt.prototype.toJSON.call(this);return Y3(this.parameters.shapes,this.parameters.options,e)};var $5={generateTopUV:function(e,n,u,m,_){e=n[3*m],m=n[3*m+1];var T=n[3*_];return _=n[3*_+1],[new f(n[3*u],n[3*u+1]),new f(e,m),new f(T,_)]},generateSideWallUV:function(e,n,u,m,_,T){e=n[3*u];var R=n[3*u+1];u=n[3*u+2];var N=n[3*m],H=n[3*m+1];m=n[3*m+2];var W=n[3*_],$=n[3*_+1];_=n[3*_+2];var K=n[3*T],rt=n[3*T+1];return n=n[3*T+2],.01>Math.abs(R-H)?[new f(e,1-u),new f(N,1-m),new f(W,1-_),new f(K,1-n)]:[new f(R,1-u),new f(H,1-m),new f($,1-_),new f(rt,1-n)]}};n0.prototype=ft(yt.prototype),n0.prototype.constructor=n0,cm.prototype=ft(rl.prototype),cm.prototype.constructor=cm,o0.prototype=ft(yt.prototype),o0.prototype.constructor=o0,Ap.prototype=ft(vt.prototype),Ap.prototype.constructor=Ap,s0.prototype=ft(yt.prototype),s0.prototype.constructor=s0,fm.prototype=ft(vt.prototype),fm.prototype.constructor=fm,a0.prototype=ft(yt.prototype),a0.prototype.constructor=a0,pm.prototype=ft(vt.prototype),pm.prototype.constructor=pm,_p.prototype=ft(yt.prototype),_p.prototype.constructor=_p,_p.prototype.toJSON=function(){var e=yt.prototype.toJSON.call(this);return Z3(this.parameters.shapes,e)},wp.prototype=ft(vt.prototype),wp.prototype.constructor=wp,wp.prototype.toJSON=function(){var e=vt.prototype.toJSON.call(this);return Z3(this.parameters.shapes,e)},dm.prototype=ft(vt.prototype),dm.prototype.constructor=dm,Mp.prototype=ft(yt.prototype),Mp.prototype.constructor=Mp,ah.prototype=ft(vt.prototype),ah.prototype.constructor=ah,u0.prototype=ft(Mp.prototype),u0.prototype.constructor=u0,l0.prototype=ft(ah.prototype),l0.prototype.constructor=l0,h0.prototype=ft(yt.prototype),h0.prototype.constructor=h0,mm.prototype=ft(vt.prototype),mm.prototype.constructor=mm;var ss=$a({__proto__:null,WireframeGeometry:im,ParametricGeometry:Xv,ParametricBufferGeometry:nm,TetrahedronGeometry:Zv,TetrahedronBufferGeometry:om,OctahedronGeometry:qv,OctahedronBufferGeometry:vp,IcosahedronGeometry:Jv,IcosahedronBufferGeometry:sm,DodecahedronGeometry:Qv,DodecahedronBufferGeometry:am,PolyhedronGeometry:Yv,PolyhedronBufferGeometry:Cs,TubeGeometry:Kv,TubeBufferGeometry:yp,TorusKnotGeometry:$v,TorusKnotBufferGeometry:um,TorusGeometry:t0,TorusBufferGeometry:lm,TextGeometry:n0,TextBufferGeometry:cm,SphereGeometry:o0,SphereBufferGeometry:Ap,RingGeometry:s0,RingBufferGeometry:fm,PlaneGeometry:mn,PlaneBufferGeometry:hi,LatheGeometry:a0,LatheBufferGeometry:pm,ShapeGeometry:_p,ShapeBufferGeometry:wp,ExtrudeGeometry:xp,ExtrudeBufferGeometry:rl,EdgesGeometry:dm,ConeGeometry:u0,ConeBufferGeometry:l0,CylinderGeometry:Mp,CylinderBufferGeometry:ah,CircleGeometry:h0,CircleBufferGeometry:mm,BoxGeometry:Uw,BoxBufferGeometry:I0});Cp.prototype=ft(Qt.prototype),Cp.prototype.constructor=Cp,Cp.prototype.isShadowMaterial=!0,Cp.prototype.copy=function(e){return Qt.prototype.copy.call(this,e),this.color.copy(e.color),this},uh.prototype=ft(ue.prototype),uh.prototype.constructor=uh,uh.prototype.isRawShaderMaterial=!0,il.prototype=ft(Qt.prototype),il.prototype.constructor=il,il.prototype.isMeshStandardMaterial=!0,il.prototype.copy=function(e){return Qt.prototype.copy.call(this,e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this.vertexTangents=e.vertexTangents,this},Tp.prototype=ft(il.prototype),Tp.prototype.constructor=Tp,Tp.prototype.isMeshPhysicalMaterial=!0,Tp.prototype.copy=function(e){return il.prototype.copy.call(this,e),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.reflectivity=e.reflectivity,this.sheen=e.sheen?(this.sheen||new wt).copy(e.sheen):null,this.transparency=e.transparency,this},Ec.prototype=ft(Qt.prototype),Ec.prototype.constructor=Ec,Ec.prototype.isMeshPhongMaterial=!0,Ec.prototype.copy=function(e){return Qt.prototype.copy.call(this,e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},Sp.prototype=ft(Qt.prototype),Sp.prototype.constructor=Sp,Sp.prototype.isMeshToonMaterial=!0,Sp.prototype.copy=function(e){return Qt.prototype.copy.call(this,e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},Ip.prototype=ft(Qt.prototype),Ip.prototype.constructor=Ip,Ip.prototype.isMeshNormalMaterial=!0,Ip.prototype.copy=function(e){return Qt.prototype.copy.call(this,e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},Ep.prototype=ft(Qt.prototype),Ep.prototype.constructor=Ep,Ep.prototype.isMeshLambertMaterial=!0,Ep.prototype.copy=function(e){return Qt.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},Lp.prototype=ft(Qt.prototype),Lp.prototype.constructor=Lp,Lp.prototype.isMeshMatcapMaterial=!0,Lp.prototype.copy=function(e){return Qt.prototype.copy.call(this,e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},Rp.prototype=ft(gn.prototype),Rp.prototype.constructor=Rp,Rp.prototype.isLineDashedMaterial=!0,Rp.prototype.copy=function(e){return gn.prototype.copy.call(this,e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this};var tL=$a({__proto__:null,ShadowMaterial:Cp,SpriteMaterial:Sc,RawShaderMaterial:uh,ShaderMaterial:ue,PointsMaterial:lu,MeshPhysicalMaterial:Tp,MeshStandardMaterial:il,MeshPhongMaterial:Ec,MeshToonMaterial:Sp,MeshNormalMaterial:Ip,MeshLambertMaterial:Ep,MeshDepthMaterial:Cc,MeshDistanceMaterial:Tc,MeshBasicMaterial:De,MeshMatcapMaterial:Lp,LineDashedMaterial:Rp,LineBasicMaterial:gn,Material:Qt}),vn={arraySlice:function(e,n,u){return vn.isTypedArray(e)?new e.constructor(e.subarray(n,u!==void 0?u:e.length)):e.slice(n,u)},convertArray:function(e,n,u){return!e||!u&&e.constructor===n?e:typeof n.BYTES_PER_ELEMENT=="number"?new n(e):Array.prototype.slice.call(e)},isTypedArray:function(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)},getKeyframeOrder:function(e){for(var n=e.length,u=Array(n),m=0;m!==n;++m)u[m]=m;return u.sort(function(_,T){return e[_]-e[T]}),u},sortedArray:function(e,n,u){for(var m=e.length,_=new e.constructor(m),T=0,R=0;R!==m;++T)for(var N=u[T]*n,H=0;H!==n;++H)_[R++]=e[N+H];return _},flattenJSON:function(e,n,u,m){for(var _=1,T=e[0];T!==void 0&&T[m]===void 0;)T=e[_++];if(T!==void 0){var R=T[m];if(R!==void 0)if(Array.isArray(R))do R=T[m],R!==void 0&&(n.push(T.time),u.push.apply(u,R)),T=e[_++];while(T!==void 0);else if(R.toArray!==void 0)do R=T[m],R!==void 0&&(n.push(T.time),R.toArray(u,u.length)),T=e[_++];while(T!==void 0);else do R=T[m],R!==void 0&&(n.push(T.time),u.push(R)),T=e[_++];while(T!==void 0)}},subclip:function(e,n,u,m,_){_=_||30,e=e.clone(),e.name=n;var T=[];for(n=0;n<e.tracks.length;++n){for(var R=e.tracks[n],N=R.getValueSize(),H=[],W=[],$=0;$<R.times.length;++$){var K=R.times[$]*_;if(!(K<u||K>=m))for(H.push(R.times[$]),K=0;K<N;++K)W.push(R.values[$*N+K])}H.length!==0&&(R.times=vn.convertArray(H,R.times.constructor),R.values=vn.convertArray(W,R.values.constructor),T.push(R))}for(e.tracks=T,u=1/0,n=0;n<e.tracks.length;++n)u>e.tracks[n].times[0]&&(u=e.tracks[n].times[0]);for(n=0;n<e.tracks.length;++n)e.tracks[n].shift(-1*u);return e.resetDuration(),e},makeClipAdditive:function(e,n,u,m){n===void 0&&(n=0),u===void 0&&(u=e),(m===void 0||0>=m)&&(m=30);var _=e.tracks.length;for(n/=m,m=0;m<_;++m){var T=u.tracks[m],R=T.ValueTypeName;if(R!=="bool"&&R!=="string"){var N=e.tracks.find(function(at){return at.name===T.name&&at.ValueTypeName===R});if(N!==void 0){var H=T.getValueSize(),W=T.times.length-1;n<=T.times[0]?W=vn.arraySlice(T.values,0,T.valueSize):n>=T.times[W]?W=vn.arraySlice(T.values,W*H):(W=T.createInterpolant(),W.evaluate(n),W=W.resultBuffer),R==="quaternion"&&new z(W[0],W[1],W[2],W[3]).normalize().conjugate().toArray(W);for(var $=N.times.length,K=0;K<$;++K){var rt=K*H;if(R==="quaternion")z.multiplyQuaternionsFlat(N.values,rt,W,0,N.values,rt);else for(var et=0;et<H;++et)N.values[rt+et]-=W[et]}}}}return e.blendMode=2501,e}};pt(Xs.prototype,{evaluate:function(e){var n=this.parameterPositions,u=this._cachedIndex,m=n[u],_=n[u-1];t:{e:{r:{i:if(!(e<m)){for(var T=u+2;;){if(m===void 0){if(e<_)break i;return this._cachedIndex=u=n.length,this.afterEnd_(u-1,e,_)}if(u===T)break;if(_=m,m=n[++u],e<m)break e}m=n.length;break r}if(e>=_)break t;for(T=n[1],e<T&&(u=2,_=T),T=u-2;;){if(_===void 0)return this._cachedIndex=0,this.beforeStart_(0,e,m);if(u===T)break;if(m=_,_=n[--u-1],e>=_)break e}m=u,u=0}for(;u<m;)_=u+m>>>1,e<n[_]?m=_:u=_+1;if(m=n[u],_=n[u-1],_===void 0)return this._cachedIndex=0,this.beforeStart_(0,e,m);if(m===void 0)return this._cachedIndex=u=n.length,this.afterEnd_(u-1,_,e)}this._cachedIndex=u,this.intervalChanged_(u,_,m)}return this.interpolate_(u,_,e,m)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(e){var n=this.resultBuffer,u=this.sampleValues,m=this.valueSize;e*=m;for(var _=0;_!==m;++_)n[_]=u[e+_];return n},interpolate_:function(){throw Error("call to abstract method")},intervalChanged_:function(){}}),pt(Xs.prototype,{beforeStart_:Xs.prototype.copySampleValue_,afterEnd_:Xs.prototype.copySampleValue_}),yx.prototype=pt(ft(Xs.prototype),{constructor:yx,DefaultSettings_:{endingStart:2400,endingEnd:2400},intervalChanged_:function(e,n,u){var m=this.parameterPositions,_=e-2,T=e+1,R=m[_],N=m[T];if(R===void 0)switch(this.getSettings_().endingStart){case 2401:_=e,R=2*n-u;break;case 2402:_=m.length-2,R=n+m[_]-m[_+1];break;default:_=e,R=u}if(N===void 0)switch(this.getSettings_().endingEnd){case 2401:T=e,N=2*u-n;break;case 2402:T=1,N=u+m[1]-m[0];break;default:T=e-1,N=n}e=.5*(u-n),m=this.valueSize,this._weightPrev=e/(n-R),this._weightNext=e/(N-u),this._offsetPrev=_*m,this._offsetNext=T*m},interpolate_:function(e,n,u,m){var _=this.resultBuffer,T=this.sampleValues,R=this.valueSize;e*=R;var N=e-R,H=this._offsetPrev,W=this._offsetNext,$=this._weightPrev,K=this._weightNext,rt=(u-n)/(m-n);for(u=rt*rt,m=u*rt,n=-$*m+2*$*u-$*rt,$=(1+$)*m+(-1.5-2*$)*u+(-.5+$)*rt+1,rt=(-1-K)*m+(1.5+K)*u+.5*rt,K=K*m-K*u,u=0;u!==R;++u)_[u]=n*T[H+u]+$*T[N+u]+rt*T[e+u]+K*T[W+u];return _}}),c0.prototype=pt(ft(Xs.prototype),{constructor:c0,interpolate_:function(e,n,u,m){var _=this.resultBuffer,T=this.sampleValues,R=this.valueSize;e*=R;var N=e-R;for(n=(u-n)/(m-n),u=1-n,m=0;m!==R;++m)_[m]=T[N+m]*u+T[e+m]*n;return _}}),xx.prototype=pt(ft(Xs.prototype),{constructor:xx,interpolate_:function(e){return this.copySampleValue_(e-1)}}),pt(So,{toJSON:function(e){var n=e.constructor;if(n.toJSON!==void 0)n=n.toJSON(e);else{n={name:e.name,times:vn.convertArray(e.times,Array),values:vn.convertArray(e.values,Array)};var u=e.getInterpolation();u!==e.DefaultInterpolation&&(n.interpolation=u)}return n.type=e.ValueTypeName,n}}),pt(So.prototype,{constructor:So,TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:2301,InterpolantFactoryMethodDiscrete:function(e){return new xx(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodLinear:function(e){return new c0(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodSmooth:function(e){return new yx(this.times,this.values,this.getValueSize(),e)},setInterpolation:function(e){switch(e){case 2300:var n=this.InterpolantFactoryMethodDiscrete;break;case 2301:n=this.InterpolantFactoryMethodLinear;break;case 2302:n=this.InterpolantFactoryMethodSmooth}if(n===void 0){if(n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name,this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw Error(n);return console.warn("THREE.KeyframeTrack:",n),this}return this.createInterpolant=n,this},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return 2300;case this.InterpolantFactoryMethodLinear:return 2301;case this.InterpolantFactoryMethodSmooth:return 2302}},getValueSize:function(){return this.values.length/this.times.length},shift:function(e){if(e!==0)for(var n=this.times,u=0,m=n.length;u!==m;++u)n[u]+=e;return this},scale:function(e){if(e!==1)for(var n=this.times,u=0,m=n.length;u!==m;++u)n[u]*=e;return this},trim:function(e,n){for(var u=this.times,m=u.length,_=0,T=m-1;_!==m&&u[_]<e;)++_;for(;T!==-1&&u[T]>n;)--T;return++T,(_!==0||T!==m)&&(_>=T&&(T=Math.max(T,1),_=T-1),e=this.getValueSize(),this.times=vn.arraySlice(u,_,T),this.values=vn.arraySlice(this.values,_*e,T*e)),this},validate:function(){var e=!0,n=this.getValueSize();n-Math.floor(n)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);var u=this.times;n=this.values;var m=u.length;m===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);for(var _=null,T=0;T!==m;T++){var R=u[T];if(typeof R=="number"&&isNaN(R)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,T,R),e=!1;break}if(_!==null&&_>R){console.error("THREE.KeyframeTrack: Out of order keys.",this,T,R,_),e=!1;break}_=R}if(n!==void 0&&vn.isTypedArray(n)){for(T=0,u=n.length;T!==u;++T)if(m=n[T],isNaN(m)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,T,m),e=!1;break}}return e},optimize:function(){for(var e=vn.arraySlice(this.times),n=vn.arraySlice(this.values),u=this.getValueSize(),m=this.getInterpolation()===2302,_=1,T=e.length-1,R=1;R<T;++R){var N=!1,H=e[R];if(H!==e[R+1]&&(R!==1||H!==H[0]))if(m)N=!0;else{var W=R*u,$=W-u,K=W+u;for(H=0;H!==u;++H){var rt=n[W+H];if(rt!==n[$+H]||rt!==n[K+H]){N=!0;break}}}if(N){if(R!==_)for(e[_]=e[R],N=R*u,W=_*u,H=0;H!==u;++H)n[W+H]=n[N+H];++_}}if(0<T){for(e[_]=e[T],N=T*u,W=_*u,H=0;H!==u;++H)n[W+H]=n[N+H];++_}return _!==e.length?(this.times=vn.arraySlice(e,0,_),this.values=vn.arraySlice(n,0,_*u)):(this.times=e,this.values=n),this},clone:function(){var e=vn.arraySlice(this.times,0),n=vn.arraySlice(this.values,0);return e=new this.constructor(this.name,e,n),e.createInterpolant=this.createInterpolant,e}}),Ax.prototype=pt(ft(So.prototype),{constructor:Ax,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:2300,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),_x.prototype=pt(ft(So.prototype),{constructor:_x,ValueTypeName:"color"}),gm.prototype=pt(ft(So.prototype),{constructor:gm,ValueTypeName:"number"}),wx.prototype=pt(ft(Xs.prototype),{constructor:wx,interpolate_:function(e,n,u,m){var _=this.resultBuffer,T=this.sampleValues,R=this.valueSize;for(e*=R,n=(u-n)/(m-n),u=e+R;e!==u;e+=4)z.slerpFlat(_,0,T,e-R,T,e,n);return _}}),f0.prototype=pt(ft(So.prototype),{constructor:f0,ValueTypeName:"quaternion",DefaultInterpolation:2301,InterpolantFactoryMethodLinear:function(e){return new wx(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodSmooth:void 0}),Mx.prototype=pt(ft(So.prototype),{constructor:Mx,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:2300,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),vm.prototype=pt(ft(So.prototype),{constructor:vm,ValueTypeName:"vector"}),pt(Ca,{parse:function(e){for(var n=[],u=e.tracks,m=1/(e.fps||1),_=0,T=u.length;_!==T;++_)n.push(D5(u[_]).scale(m));return new Ca(e.name,e.duration,n,e.blendMode)},toJSON:function(e){var n=[],u=e.tracks;e={name:e.name,duration:e.duration,tracks:n,uuid:e.uuid,blendMode:e.blendMode};for(var m=0,_=u.length;m!==_;++m)n.push(So.toJSON(u[m]));return e},CreateFromMorphTargetSequence:function(e,n,u,m){for(var _=n.length,T=[],R=0;R<_;R++){var N=[],H=[];N.push((R+_-1)%_,R,(R+1)%_),H.push(0,1,0);var W=vn.getKeyframeOrder(N);N=vn.sortedArray(N,1,W),H=vn.sortedArray(H,1,W),m||N[0]!==0||(N.push(_),H.push(H[0])),T.push(new gm(".morphTargetInfluences["+n[R].name+"]",N,H).scale(1/u))}return new Ca(e,-1,T)},findByName:function(e,n){var u=e;for(Array.isArray(e)||(u=e.geometry&&e.geometry.animations||e.animations),e=0;e<u.length;e++)if(u[e].name===n)return u[e];return null},CreateClipsFromMorphTargetSequences:function(e,n,u){for(var m={},_=/^([\w-]*?)([\d]+)$/,T=0,R=e.length;T<R;T++){var N=e[T],H=N.name.match(_);if(H&&1<H.length){var W=H[1];(H=m[W])||(m[W]=H=[]),H.push(N)}}e=[];for(W in m)e.push(Ca.CreateFromMorphTargetSequence(W,m[W],n,u));return e},parseAnimation:function(e,n){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;var u=function(Ft,Wt,Ht,$t,Yt){if(Ht.length!==0){var ie=[],Vt=[];vn.flattenJSON(Ht,ie,Vt,$t),ie.length!==0&&Yt.push(new Ft(Wt,ie,Vt))}},m=[],_=e.name||"default",T=e.length||-1,R=e.fps||30,N=e.blendMode;e=e.hierarchy||[];for(var H=0;H<e.length;H++){var W=e[H].keys;if(W&&W.length!==0)if(W[0].morphTargets){T={};for(var $=0;$<W.length;$++)if(W[$].morphTargets)for(var K=0;K<W[$].morphTargets.length;K++)T[W[$].morphTargets[K]]=-1;for(var rt in T){var et=[],at=[];for(K=0;K!==W[$].morphTargets.length;++K){var mt=W[$];et.push(mt.time),at.push(mt.morphTarget===rt?1:0)}m.push(new gm(".morphTargetInfluence["+rt+"]",et,at))}T=T.length*(R||1)}else $=".bones["+n[H].name+"]",u(vm,$+".position",W,"pos",m),u(f0,$+".quaternion",W,"rot",m),u(vm,$+".scale",W,"scl",m)}return m.length===0?null:new Ca(_,T,m,N)}}),pt(Ca.prototype,{resetDuration:function(){for(var e=0,n=0,u=this.tracks.length;n!==u;++n){var m=this.tracks[n];e=Math.max(e,m.times[m.times.length-1])}return this.duration=e,this},trim:function(){for(var e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this},validate:function(){for(var e=!0,n=0;n<this.tracks.length;n++)e=e&&this.tracks[n].validate();return e},optimize:function(){for(var e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this},clone:function(){for(var e=[],n=0;n<this.tracks.length;n++)e.push(this.tracks[n].clone());return new Ca(this.name,this.duration,e,this.blendMode)}});var zp={enabled:!1,files:{},add:function(e,n){this.enabled!==!1&&(this.files[e]=n)},get:function(e){if(this.enabled!==!1)return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}},kT=new q_;pt(Gi.prototype,{load:function(){},loadAsync:function(e,n){var u=this;return new di(function(m,_){u.load(e,m,n,_)})},parse:function(){},setCrossOrigin:function(e){return this.crossOrigin=e,this},setPath:function(e){return this.path=e,this},setResourcePath:function(e){return this.resourcePath=e,this},setRequestHeader:function(e){return this.requestHeader=e,this}});var yu={};Ta.prototype=pt(ft(Gi.prototype),{constructor:Ta,load:function(e,n,u,m){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);var _=this,T=zp.get(e);if(T!==void 0)return _.manager.itemStart(e),setTimeout(function(){n&&n(T),_.manager.itemEnd(e)},0),T;if(yu[e]!==void 0)yu[e].push({onLoad:n,onProgress:u,onError:m});else{var R=e.match(/^data:(.*?)(;base64)?,(.*)$/);if(R){u=R[1];var N=!!R[2];R=R[3],R=decodeURIComponent(R),N&&(R=atob(R));try{var H=(this.responseType||"").toLowerCase();switch(H){case"arraybuffer":case"blob":var W=new Uint8Array(R.length);for(N=0;N<R.length;N++)W[N]=R.charCodeAt(N);var $=H==="blob"?new Blob([W.buffer],{type:u}):W.buffer;break;case"document":$=new DOMParser().parseFromString(R,u);break;case"json":$=JSON.parse(R);break;default:$=R}setTimeout(function(){n&&n($),_.manager.itemEnd(e)},0)}catch(rt){setTimeout(function(){m&&m(rt),_.manager.itemError(e),_.manager.itemEnd(e)},0)}}else{yu[e]=[],yu[e].push({onLoad:n,onProgress:u,onError:m});var K=new XMLHttpRequest;K.open("GET",e,!0),K.addEventListener("load",function(rt){var et=this.response,at=yu[e];if(delete yu[e],this.status===200||this.status===0){this.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),zp.add(e,et);for(var mt=0,Ft=at.length;mt<Ft;mt++){var Wt=at[mt];Wt.onLoad&&Wt.onLoad(et)}}else{for(mt=0,Ft=at.length;mt<Ft;mt++)Wt=at[mt],Wt.onError&&Wt.onError(rt);_.manager.itemError(e)}_.manager.itemEnd(e)},!1),K.addEventListener("progress",function(rt){for(var et=yu[e],at=0,mt=et.length;at<mt;at++){var Ft=et[at];Ft.onProgress&&Ft.onProgress(rt)}},!1),K.addEventListener("error",function(rt){var et=yu[e];delete yu[e];for(var at=0,mt=et.length;at<mt;at++){var Ft=et[at];Ft.onError&&Ft.onError(rt)}_.manager.itemError(e),_.manager.itemEnd(e)},!1),K.addEventListener("abort",function(rt){var et=yu[e];delete yu[e];for(var at=0,mt=et.length;at<mt;at++){var Ft=et[at];Ft.onError&&Ft.onError(rt)}_.manager.itemError(e),_.manager.itemEnd(e)},!1),this.responseType!==void 0&&(K.responseType=this.responseType),this.withCredentials!==void 0&&(K.withCredentials=this.withCredentials),K.overrideMimeType&&K.overrideMimeType(this.mimeType!==void 0?this.mimeType:"text/plain");for(N in this.requestHeader)K.setRequestHeader(N,this.requestHeader[N]);K.send(null)}return _.manager.itemStart(e),K}},setResponseType:function(e){return this.responseType=e,this},setWithCredentials:function(e){return this.withCredentials=e,this},setMimeType:function(e){return this.mimeType=e,this}}),J_.prototype=pt(ft(Gi.prototype),{constructor:J_,load:function(e,n,u,m){var _=this,T=new Ta(_.manager);T.setPath(_.path),T.load(e,function(R){try{n(_.parse(JSON.parse(R)))}catch(N){m?m(N):console.error(N),_.manager.itemError(e)}},u,m)},parse:function(e){for(var n=[],u=0;u<e.length;u++){var m=Ca.parse(e[u]);n.push(m)}return n}}),Q_.prototype=pt(ft(Gi.prototype),{constructor:Q_,load:function(e,n,u,m){function _(rt){H.load(e[rt],function(et){et=T.parse(et,!0),R[rt]={width:et.width,height:et.height,format:et.format,mipmaps:et.mipmaps},W+=1,W===6&&(et.mipmapCount===1&&(N.minFilter=1006),N.format=et.format,N.needsUpdate=!0,n&&n(N))},u,m)}var T=this,R=[],N=new rm;N.image=R;var H=new Ta(this.manager);if(H.setPath(this.path),H.setResponseType("arraybuffer"),Array.isArray(e))for(var W=0,$=0,K=e.length;$<K;++$)_($);else H.load(e,function(rt){if(rt=T.parse(rt,!0),rt.isCubemap)for(var et=rt.mipmaps.length/rt.mipmapCount,at=0;at<et;at++){R[at]={mipmaps:[]};for(var mt=0;mt<rt.mipmapCount;mt++)R[at].mipmaps.push(rt.mipmaps[at*rt.mipmapCount+mt]),R[at].format=rt.format,R[at].width=rt.width,R[at].height=rt.height}else N.image.width=rt.width,N.image.height=rt.height,N.mipmaps=rt.mipmaps;rt.mipmapCount===1&&(N.minFilter=1006),N.format=rt.format,N.needsUpdate=!0,n&&n(N)},u,m);return N}}),Cx.prototype=pt(ft(Gi.prototype),{constructor:Cx,load:function(e,n,u,m){var _=this,T=new me,R=new Ta(this.manager);return R.setResponseType("arraybuffer"),R.setPath(this.path),R.load(e,function(N){(N=_.parse(N))&&(N.image!==void 0?T.image=N.image:N.data!==void 0&&(T.image.width=N.width,T.image.height=N.height,T.image.data=N.data),T.wrapS=N.wrapS!==void 0?N.wrapS:1001,T.wrapT=N.wrapT!==void 0?N.wrapT:1001,T.magFilter=N.magFilter!==void 0?N.magFilter:1006,T.minFilter=N.minFilter!==void 0?N.minFilter:1006,T.anisotropy=N.anisotropy!==void 0?N.anisotropy:1,N.format!==void 0&&(T.format=N.format),N.type!==void 0&&(T.type=N.type),N.mipmaps!==void 0&&(T.mipmaps=N.mipmaps,T.minFilter=1008),N.mipmapCount===1&&(T.minFilter=1006),T.needsUpdate=!0,n&&n(T,N))},u,m),T}}),ym.prototype=pt(ft(Gi.prototype),{constructor:ym,load:function(e,n,u,m){function _(){H.removeEventListener("load",_,!1),H.removeEventListener("error",T,!1),zp.add(e,this),n&&n(this),R.manager.itemEnd(e)}function T(W){H.removeEventListener("load",_,!1),H.removeEventListener("error",T,!1),m&&m(W),R.manager.itemError(e),R.manager.itemEnd(e)}this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);var R=this,N=zp.get(e);if(N!==void 0)return R.manager.itemStart(e),setTimeout(function(){n&&n(N),R.manager.itemEnd(e)},0),N;var H=document.createElementNS("http://www.w3.org/1999/xhtml","img");return H.addEventListener("load",_,!1),H.addEventListener("error",T,!1),e.substr(0,5)!=="data:"&&this.crossOrigin!==void 0&&(H.crossOrigin=this.crossOrigin),R.manager.itemStart(e),H.src=e,H}}),Tx.prototype=pt(ft(Gi.prototype),{constructor:Tx,load:function(e,n,u,m){function _(H){R.load(e[H],function(W){T.images[H]=W,N++,N===6&&(T.needsUpdate=!0,n&&n(T))},void 0,m)}var T=new wa,R=new ym(this.manager);R.setCrossOrigin(this.crossOrigin),R.setPath(this.path);var N=0;for(u=0;u<e.length;++u)_(u);return T}}),Sx.prototype=pt(ft(Gi.prototype),{constructor:Sx,load:function(e,n,u,m){var _=new d,T=new ym(this.manager);return T.setCrossOrigin(this.crossOrigin),T.setPath(this.path),T.load(e,function(R){_.image=R,R=0<e.search(/\.jpe?g($|\?)/i)||e.search(/^data:image\/jpeg/)===0,_.format=R?1022:1023,_.needsUpdate=!0,n!==void 0&&n(_)},u,m),_}}),pt(Br.prototype,{getPoint:function(){return console.warn("THREE.Curve: .getPoint() not implemented."),null},getPointAt:function(e,n){return e=this.getUtoTmapping(e),this.getPoint(e,n)},getPoints:function(e){e===void 0&&(e=5);for(var n=[],u=0;u<=e;u++)n.push(this.getPoint(u/e));return n},getSpacedPoints:function(e){e===void 0&&(e=5);for(var n=[],u=0;u<=e;u++)n.push(this.getPointAt(u/e));return n},getLength:function(){var e=this.getLengths();return e[e.length-1]},getLengths:function(e){if(e===void 0&&(e=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var n=[],u=this.getPoint(0),m,_=0;for(n.push(0),m=1;m<=e;m++){var T=this.getPoint(m/e);_+=T.distanceTo(u),n.push(_),u=T}return this.cacheArcLengths=n},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(e,n){var u=this.getLengths(),m=u.length;n=n||e*u[m-1];for(var _=0,T=m-1,R;_<=T;)if(e=Math.floor(_+(T-_)/2),R=u[e]-n,0>R)_=e+1;else if(0<R)T=e-1;else{T=e;break}return e=T,u[e]===n?e/(m-1):(_=u[e],(e+(n-_)/(u[e+1]-_))/(m-1))},getTangent:function(e,n){var u=e-1e-4;return e+=1e-4,0>u&&(u=0),1<e&&(e=1),u=this.getPoint(u),e=this.getPoint(e),n=n||(u.isVector2?new f:new w),n.copy(e).sub(u).normalize(),n},getTangentAt:function(e,n){return e=this.getUtoTmapping(e),this.getTangent(e,n)},computeFrenetFrames:function(e,n){var u=new w,m=[],_=[],T=[],R=new w,N=new I,H;for(H=0;H<=e;H++){var W=H/e;m[H]=this.getTangentAt(W,new w),m[H].normalize()}_[0]=new w,T[0]=new w,H=Number.MAX_VALUE,W=Math.abs(m[0].x);var $=Math.abs(m[0].y),K=Math.abs(m[0].z);for(W<=H&&(H=W,u.set(1,0,0)),$<=H&&(H=$,u.set(0,1,0)),K<=H&&u.set(0,0,1),R.crossVectors(m[0],u).normalize(),_[0].crossVectors(m[0],R),T[0].crossVectors(m[0],_[0]),H=1;H<=e;H++)_[H]=_[H-1].clone(),T[H]=T[H-1].clone(),R.crossVectors(m[H-1],m[H]),R.length()>an&&(R.normalize(),u=Math.acos(ni.clamp(m[H-1].dot(m[H]),-1,1)),_[H].applyMatrix4(N.makeRotationAxis(R,u))),T[H].crossVectors(m[H],_[H]);if(n===!0)for(u=Math.acos(ni.clamp(_[0].dot(_[e]),-1,1)),u/=e,0<m[0].dot(R.crossVectors(_[0],_[e]))&&(u=-u),H=1;H<=e;H++)_[H].applyMatrix4(N.makeRotationAxis(m[H],u*H)),T[H].crossVectors(m[H],_[H]);return{tangents:m,normals:_,binormals:T}},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.arcLengthDivisions=e.arcLengthDivisions,this},toJSON:function(){var e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e},fromJSON:function(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}),Ys.prototype=ft(Br.prototype),Ys.prototype.constructor=Ys,Ys.prototype.isEllipseCurve=!0,Ys.prototype.getPoint=function(e,n){n=n||new f;for(var u=2*Math.PI,m=this.aEndAngle-this.aStartAngle,_=Math.abs(m)<an;0>m;)m+=u;for(;m>u;)m-=u;m<an&&(m=_?0:u),this.aClockwise!==!0||_||(m=m===u?-u:m-u),u=this.aStartAngle+e*m,e=this.aX+this.xRadius*Math.cos(u);var T=this.aY+this.yRadius*Math.sin(u);return this.aRotation!==0&&(u=Math.cos(this.aRotation),m=Math.sin(this.aRotation),_=e-this.aX,T-=this.aY,e=_*u-T*m+this.aX,T=_*m+T*u+this.aY),n.set(e,T)},Ys.prototype.copy=function(e){return Br.prototype.copy.call(this,e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this},Ys.prototype.toJSON=function(){var e=Br.prototype.toJSON.call(this);return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e},Ys.prototype.fromJSON=function(e){return Br.prototype.fromJSON.call(this,e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this},xm.prototype=ft(Ys.prototype),xm.prototype.constructor=xm,xm.prototype.isArcCurve=!0;var p2=new w,Vw=new K_,Ww=new K_,jw=new K_;Ho.prototype=ft(Br.prototype),Ho.prototype.constructor=Ho,Ho.prototype.isCatmullRomCurve3=!0,Ho.prototype.getPoint=function(e,n){n=n||new w;var u=this.points,m=u.length;e*=m-(this.closed?0:1);var _=Math.floor(e);if(e-=_,this.closed?_+=0<_?0:(Math.floor(Math.abs(_)/m)+1)*m:e===0&&_===m-1&&(_=m-2,e=1),this.closed||0<_)var T=u[(_-1)%m];else p2.subVectors(u[0],u[1]).add(u[0]),T=p2;var R=u[_%m],N=u[(_+1)%m];if(this.closed||_+2<m?u=u[(_+2)%m]:(p2.subVectors(u[m-1],u[m-2]).add(u[m-1]),u=p2),this.curveType==="centripetal"||this.curveType==="chordal"){var H=this.curveType==="chordal"?.5:.25;m=Math.pow(T.distanceToSquared(R),H),_=Math.pow(R.distanceToSquared(N),H),H=Math.pow(N.distanceToSquared(u),H),1e-4>_&&(_=1),1e-4>m&&(m=_),1e-4>H&&(H=_),Vw.initNonuniformCatmullRom(T.x,R.x,N.x,u.x,m,_,H),Ww.initNonuniformCatmullRom(T.y,R.y,N.y,u.y,m,_,H),jw.initNonuniformCatmullRom(T.z,R.z,N.z,u.z,m,_,H)}else this.curveType==="catmullrom"&&(Vw.initCatmullRom(T.x,R.x,N.x,u.x,this.tension),Ww.initCatmullRom(T.y,R.y,N.y,u.y,this.tension),jw.initCatmullRom(T.z,R.z,N.z,u.z,this.tension));return n.set(Vw.calc(e),Ww.calc(e),jw.calc(e)),n},Ho.prototype.copy=function(e){Br.prototype.copy.call(this,e),this.points=[];for(var n=0,u=e.points.length;n<u;n++)this.points.push(e.points[n].clone());return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this},Ho.prototype.toJSON=function(){var e=Br.prototype.toJSON.call(this);e.points=[];for(var n=0,u=this.points.length;n<u;n++)e.points.push(this.points[n].toArray());return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e},Ho.prototype.fromJSON=function(e){Br.prototype.fromJSON.call(this,e),this.points=[];for(var n=0,u=e.points.length;n<u;n++){var m=e.points[n];this.points.push(new w().fromArray(m))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this},hu.prototype=ft(Br.prototype),hu.prototype.constructor=hu,hu.prototype.isCubicBezierCurve=!0,hu.prototype.getPoint=function(e,n){n=n||new f;var u=this.v0,m=this.v1,_=this.v2,T=this.v3;return n.set(d0(e,u.x,m.x,_.x,T.x),d0(e,u.y,m.y,_.y,T.y)),n},hu.prototype.copy=function(e){return Br.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this},hu.prototype.toJSON=function(){var e=Br.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e},hu.prototype.fromJSON=function(e){return Br.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this},nl.prototype=ft(Br.prototype),nl.prototype.constructor=nl,nl.prototype.isCubicBezierCurve3=!0,nl.prototype.getPoint=function(e,n){n=n||new w;var u=this.v0,m=this.v1,_=this.v2,T=this.v3;return n.set(d0(e,u.x,m.x,_.x,T.x),d0(e,u.y,m.y,_.y,T.y),d0(e,u.z,m.z,_.z,T.z)),n},nl.prototype.copy=function(e){return Br.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this},nl.prototype.toJSON=function(){var e=Br.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e},nl.prototype.fromJSON=function(e){return Br.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this},Ts.prototype=ft(Br.prototype),Ts.prototype.constructor=Ts,Ts.prototype.isLineCurve=!0,Ts.prototype.getPoint=function(e,n){return n=n||new f,e===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n},Ts.prototype.getPointAt=function(e,n){return this.getPoint(e,n)},Ts.prototype.getTangent=function(e,n){return e=n||new f,e=e.copy(this.v2).sub(this.v1).normalize()},Ts.prototype.copy=function(e){return Br.prototype.copy.call(this,e),this.v1.copy(e.v1),this.v2.copy(e.v2),this},Ts.prototype.toJSON=function(){var e=Br.prototype.toJSON.call(this);return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},Ts.prototype.fromJSON=function(e){return Br.prototype.fromJSON.call(this,e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},cu.prototype=ft(Br.prototype),cu.prototype.constructor=cu,cu.prototype.isLineCurve3=!0,cu.prototype.getPoint=function(e,n){return n=n||new w,e===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n},cu.prototype.getPointAt=function(e,n){return this.getPoint(e,n)},cu.prototype.copy=function(e){return Br.prototype.copy.call(this,e),this.v1.copy(e.v1),this.v2.copy(e.v2),this},cu.prototype.toJSON=function(){var e=Br.prototype.toJSON.call(this);return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},cu.prototype.fromJSON=function(e){return Br.prototype.fromJSON.call(this,e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},fu.prototype=ft(Br.prototype),fu.prototype.constructor=fu,fu.prototype.isQuadraticBezierCurve=!0,fu.prototype.getPoint=function(e,n){n=n||new f;var u=this.v0,m=this.v1,_=this.v2;return n.set(p0(e,u.x,m.x,_.x),p0(e,u.y,m.y,_.y)),n},fu.prototype.copy=function(e){return Br.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this},fu.prototype.toJSON=function(){var e=Br.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},fu.prototype.fromJSON=function(e){return Br.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},ol.prototype=ft(Br.prototype),ol.prototype.constructor=ol,ol.prototype.isQuadraticBezierCurve3=!0,ol.prototype.getPoint=function(e,n){n=n||new w;var u=this.v0,m=this.v1,_=this.v2;return n.set(p0(e,u.x,m.x,_.x),p0(e,u.y,m.y,_.y),p0(e,u.z,m.z,_.z)),n},ol.prototype.copy=function(e){return Br.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this},ol.prototype.toJSON=function(){var e=Br.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},ol.prototype.fromJSON=function(e){return Br.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},pu.prototype=ft(Br.prototype),pu.prototype.constructor=pu,pu.prototype.isSplineCurve=!0,pu.prototype.getPoint=function(e,n){n=n||new f;var u=this.points,m=(u.length-1)*e;e=Math.floor(m),m-=e;var _=u[e===0?e:e-1],T=u[e],R=u[e>u.length-2?u.length-1:e+1];return u=u[e>u.length-3?u.length-1:e+2],n.set(q3(m,_.x,T.x,R.x,u.x),q3(m,_.y,T.y,R.y,u.y)),n},pu.prototype.copy=function(e){Br.prototype.copy.call(this,e),this.points=[];for(var n=0,u=e.points.length;n<u;n++)this.points.push(e.points[n].clone());return this},pu.prototype.toJSON=function(){var e=Br.prototype.toJSON.call(this);e.points=[];for(var n=0,u=this.points.length;n<u;n++)e.points.push(this.points[n].toArray());return e},pu.prototype.fromJSON=function(e){Br.prototype.fromJSON.call(this,e),this.points=[];for(var n=0,u=e.points.length;n<u;n++){var m=e.points[n];this.points.push(new f().fromArray(m))}return this};var Xw=$a({__proto__:null,ArcCurve:xm,CatmullRomCurve3:Ho,CubicBezierCurve:hu,CubicBezierCurve3:nl,EllipseCurve:Ys,LineCurve:Ts,LineCurve3:cu,QuadraticBezierCurve:fu,QuadraticBezierCurve3:ol,SplineCurve:pu});lh.prototype=pt(ft(Br.prototype),{constructor:lh,add:function(e){this.curves.push(e)},closePath:function(){var e=this.curves[0].getPoint(0),n=this.curves[this.curves.length-1].getPoint(1);e.equals(n)||this.curves.push(new Ts(n,e))},getPoint:function(e){var n=e*this.getLength(),u=this.getCurveLengths();for(e=0;e<u.length;){if(u[e]>=n)return n=u[e]-n,e=this.curves[e],u=e.getLength(),e.getPointAt(u===0?0:1-n/u);e++}return null},getLength:function(){var e=this.getCurveLengths();return e[e.length-1]},updateArcLengths:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var e=[],n=0,u=0,m=this.curves.length;u<m;u++)n+=this.curves[u].getLength(),e.push(n);return this.cacheLengths=e},getSpacedPoints:function(e){e===void 0&&(e=40);for(var n=[],u=0;u<=e;u++)n.push(this.getPoint(u/e));return this.autoClose&&n.push(n[0]),n},getPoints:function(e){e=e||12;for(var n=[],u,m=0,_=this.curves;m<_.length;m++){var T=_[m];T=T.getPoints(T&&T.isEllipseCurve?2*e:T&&(T.isLineCurve||T.isLineCurve3)?1:T&&T.isSplineCurve?e*T.points.length:e);for(var R=0;R<T.length;R++){var N=T[R];u&&u.equals(N)||(n.push(N),u=N)}}return this.autoClose&&1<n.length&&!n[n.length-1].equals(n[0])&&n.push(n[0]),n},copy:function(e){Br.prototype.copy.call(this,e),this.curves=[];for(var n=0,u=e.curves.length;n<u;n++)this.curves.push(e.curves[n].clone());return this.autoClose=e.autoClose,this},toJSON:function(){var e=Br.prototype.toJSON.call(this);e.autoClose=this.autoClose,e.curves=[];for(var n=0,u=this.curves.length;n<u;n++)e.curves.push(this.curves[n].toJSON());return e},fromJSON:function(e){Br.prototype.fromJSON.call(this,e),this.autoClose=e.autoClose,this.curves=[];for(var n=0,u=e.curves.length;n<u;n++){var m=e.curves[n];this.curves.push(new Xw[m.type]().fromJSON(m))}return this}}),du.prototype=pt(ft(lh.prototype),{constructor:du,setFromPoints:function(e){this.moveTo(e[0].x,e[0].y);for(var n=1,u=e.length;n<u;n++)this.lineTo(e[n].x,e[n].y);return this},moveTo:function(e,n){return this.currentPoint.set(e,n),this},lineTo:function(e,n){var u=new Ts(this.currentPoint.clone(),new f(e,n));return this.curves.push(u),this.currentPoint.set(e,n),this},quadraticCurveTo:function(e,n,u,m){return e=new fu(this.currentPoint.clone(),new f(e,n),new f(u,m)),this.curves.push(e),this.currentPoint.set(u,m),this},bezierCurveTo:function(e,n,u,m,_,T){return e=new hu(this.currentPoint.clone(),new f(e,n),new f(u,m),new f(_,T)),this.curves.push(e),this.currentPoint.set(_,T),this},splineThru:function(e){var n=[this.currentPoint.clone()].concat(e);return n=new pu(n),this.curves.push(n),this.currentPoint.copy(e[e.length-1]),this},arc:function(e,n,u,m,_,T){return this.absarc(e+this.currentPoint.x,n+this.currentPoint.y,u,m,_,T),this},absarc:function(e,n,u,m,_,T){return this.absellipse(e,n,u,u,m,_,T),this},ellipse:function(e,n,u,m,_,T,R,N){return this.absellipse(e+this.currentPoint.x,n+this.currentPoint.y,u,m,_,T,R,N),this},absellipse:function(e,n,u,m,_,T,R,N){return e=new Ys(e,n,u,m,_,T,R,N),0<this.curves.length&&(n=e.getPoint(0),n.equals(this.currentPoint)||this.lineTo(n.x,n.y)),this.curves.push(e),e=e.getPoint(1),this.currentPoint.copy(e),this},copy:function(e){return lh.prototype.copy.call(this,e),this.currentPoint.copy(e.currentPoint),this},toJSON:function(){var e=lh.prototype.toJSON.call(this);return e.currentPoint=this.currentPoint.toArray(),e},fromJSON:function(e){return lh.prototype.fromJSON.call(this,e),this.currentPoint.fromArray(e.currentPoint),this}}),Lc.prototype=pt(ft(du.prototype),{constructor:Lc,getPointsHoles:function(e){for(var n=[],u=0,m=this.holes.length;u<m;u++)n[u]=this.holes[u].getPoints(e);return n},extractPoints:function(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}},copy:function(e){du.prototype.copy.call(this,e),this.holes=[];for(var n=0,u=e.holes.length;n<u;n++)this.holes.push(e.holes[n].clone());return this},toJSON:function(){var e=du.prototype.toJSON.call(this);e.uuid=this.uuid,e.holes=[];for(var n=0,u=this.holes.length;n<u;n++)e.holes.push(this.holes[n].toJSON());return e},fromJSON:function(e){du.prototype.fromJSON.call(this,e),this.uuid=e.uuid,this.holes=[];for(var n=0,u=e.holes.length;n<u;n++){var m=e.holes[n];this.holes.push(new du().fromJSON(m))}return this}}),un.prototype=pt(ft(F.prototype),{constructor:un,isLight:!0,copy:function(e){return F.prototype.copy.call(this,e),this.color.copy(e.color),this.intensity=e.intensity,this},toJSON:function(e){return e=F.prototype.toJSON.call(this,e),e.object.color=this.color.getHex(),e.object.intensity=this.intensity,this.groundColor!==void 0&&(e.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(e.object.distance=this.distance),this.angle!==void 0&&(e.object.angle=this.angle),this.decay!==void 0&&(e.object.decay=this.decay),this.penumbra!==void 0&&(e.object.penumbra=this.penumbra),this.shadow!==void 0&&(e.object.shadow=this.shadow.toJSON()),e}}),Ix.prototype=pt(ft(un.prototype),{constructor:Ix,isHemisphereLight:!0,copy:function(e){return un.prototype.copy.call(this,e),this.groundColor.copy(e.groundColor),this}}),pt(sl.prototype,{_projScreenMatrix:new I,_lightPositionWorld:new w,_lookTarget:new w,getViewportCount:function(){return this._viewportCount},getFrustum:function(){return this._frustum},updateMatrices:function(e){var n=this.camera,u=this.matrix,m=this._projScreenMatrix,_=this._lookTarget,T=this._lightPositionWorld;T.setFromMatrixPosition(e.matrixWorld),n.position.copy(T),_.setFromMatrixPosition(e.target.matrixWorld),n.lookAt(_),n.updateMatrixWorld(),m.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(m),u.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),u.multiply(n.projectionMatrix),u.multiply(n.matrixWorldInverse)},getViewport:function(e){return this._viewports[e]},getFrameExtents:function(){return this._frameExtents},copy:function(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this},clone:function(){return new this.constructor().copy(this)},toJSON:function(){var e={};return this.bias!==0&&(e.bias=this.bias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}),Ex.prototype=pt(ft(sl.prototype),{constructor:Ex,isSpotLightShadow:!0,updateMatrices:function(e){var n=this.camera,u=2*ni.RAD2DEG*e.angle,m=this.mapSize.width/this.mapSize.height,_=e.distance||n.far;(u!==n.fov||m!==n.aspect||_!==n.far)&&(n.fov=u,n.aspect=m,n.far=_,n.updateProjectionMatrix()),sl.prototype.updateMatrices.call(this,e)}}),Lx.prototype=pt(ft(un.prototype),{constructor:Lx,isSpotLight:!0,copy:function(e){return un.prototype.copy.call(this,e),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}),$_.prototype=pt(ft(sl.prototype),{constructor:$_,isPointLightShadow:!0,updateMatrices:function(e,n){n===void 0&&(n=0);var u=this.camera,m=this.matrix,_=this._lightPositionWorld,T=this._lookTarget,R=this._projScreenMatrix;_.setFromMatrixPosition(e.matrixWorld),u.position.copy(_),T.copy(u.position),T.add(this._cubeDirections[n]),u.up.copy(this._cubeUps[n]),u.lookAt(T),u.updateMatrixWorld(),m.makeTranslation(-_.x,-_.y,-_.z),R.multiplyMatrices(u.projectionMatrix,u.matrixWorldInverse),this._frustum.setFromProjectionMatrix(R)}}),Rx.prototype=pt(ft(un.prototype),{constructor:Rx,isPointLight:!0,copy:function(e){return un.prototype.copy.call(this,e),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}),Am.prototype=pt(ft(te.prototype),{constructor:Am,isOrthographicCamera:!0,copy:function(e,n){return te.prototype.copy.call(this,e,n),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:pt({},e.view),this},setViewOffset:function(e,n,u,m,_,T){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=n,this.view.offsetX=u,this.view.offsetY=m,this.view.width=_,this.view.height=T,this.updateProjectionMatrix()},clearViewOffset:function(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var e=(this.right-this.left)/(2*this.zoom),n=(this.top-this.bottom)/(2*this.zoom),u=(this.right+this.left)/2,m=(this.top+this.bottom)/2,_=u-e;u+=e,e=m+n,n=m-n,this.view!==null&&this.view.enabled&&(m=(this.right-this.left)/this.view.fullWidth/this.zoom,n=(this.top-this.bottom)/this.view.fullHeight/this.zoom,_+=m*this.view.offsetX,u=_+m*this.view.width,e-=n*this.view.offsetY,n=e-n*this.view.height),this.projectionMatrix.makeOrthographic(_,u,e,n,this.near,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(e){return e=F.prototype.toJSON.call(this,e),e.object.zoom=this.zoom,e.object.left=this.left,e.object.right=this.right,e.object.top=this.top,e.object.bottom=this.bottom,e.object.near=this.near,e.object.far=this.far,this.view!==null&&(e.object.view=pt({},this.view)),e}}),Px.prototype=pt(ft(sl.prototype),{constructor:Px,isDirectionalLightShadow:!0,updateMatrices:function(e){sl.prototype.updateMatrices.call(this,e)}}),Dx.prototype=pt(ft(un.prototype),{constructor:Dx,isDirectionalLight:!0,copy:function(e){return un.prototype.copy.call(this,e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}),Ox.prototype=pt(ft(un.prototype),{constructor:Ox,isAmbientLight:!0}),Fx.prototype=pt(ft(un.prototype),{constructor:Fx,isRectAreaLight:!0,copy:function(e){return un.prototype.copy.call(this,e),this.width=e.width,this.height=e.height,this},toJSON:function(e){return e=un.prototype.toJSON.call(this,e),e.object.width=this.width,e.object.height=this.height,e}}),pt(Bx.prototype,{isSphericalHarmonics3:!0,set:function(e){for(var n=0;9>n;n++)this.coefficients[n].copy(e[n]);return this},zero:function(){for(var e=0;9>e;e++)this.coefficients[e].set(0,0,0);return this},getAt:function(e,n){var u=e.x,m=e.y;e=e.z;var _=this.coefficients;return n.copy(_[0]).multiplyScalar(.282095),n.addScaledVector(_[1],.488603*m),n.addScaledVector(_[2],.488603*e),n.addScaledVector(_[3],.488603*u),n.addScaledVector(_[4],1.092548*u*m),n.addScaledVector(_[5],1.092548*m*e),n.addScaledVector(_[6],.315392*(3*e*e-1)),n.addScaledVector(_[7],1.092548*u*e),n.addScaledVector(_[8],.546274*(u*u-m*m)),n},getIrradianceAt:function(e,n){var u=e.x,m=e.y;e=e.z;var _=this.coefficients;return n.copy(_[0]).multiplyScalar(.886227),n.addScaledVector(_[1],1.023328*m),n.addScaledVector(_[2],1.023328*e),n.addScaledVector(_[3],1.023328*u),n.addScaledVector(_[4],.858086*u*m),n.addScaledVector(_[5],.858086*m*e),n.addScaledVector(_[6],.743125*e*e-.247708),n.addScaledVector(_[7],.858086*u*e),n.addScaledVector(_[8],.429043*(u*u-m*m)),n},add:function(e){for(var n=0;9>n;n++)this.coefficients[n].add(e.coefficients[n]);return this},addScaledSH:function(e,n){for(var u=0;9>u;u++)this.coefficients[u].addScaledVector(e.coefficients[u],n);return this},scale:function(e){for(var n=0;9>n;n++)this.coefficients[n].multiplyScalar(e);return this},lerp:function(e,n){for(var u=0;9>u;u++)this.coefficients[u].lerp(e.coefficients[u],n);return this},equals:function(e){for(var n=0;9>n;n++)if(!this.coefficients[n].equals(e.coefficients[n]))return!1;return!0},copy:function(e){return this.set(e.coefficients)},clone:function(){return new this.constructor().copy(this)},fromArray:function(e,n){n===void 0&&(n=0);for(var u=this.coefficients,m=0;9>m;m++)u[m].fromArray(e,n+3*m);return this},toArray:function(e,n){e===void 0&&(e=[]),n===void 0&&(n=0);for(var u=this.coefficients,m=0;9>m;m++)u[m].toArray(e,n+3*m);return e}}),pt(Bx,{getBasisAt:function(e,n){var u=e.x,m=e.y;e=e.z,n[0]=.282095,n[1]=.488603*m,n[2]=.488603*e,n[3]=.488603*u,n[4]=1.092548*u*m,n[5]=1.092548*m*e,n[6]=.315392*(3*e*e-1),n[7]=1.092548*u*e,n[8]=.546274*(u*u-m*m)}}),Sa.prototype=pt(ft(un.prototype),{constructor:Sa,isLightProbe:!0,copy:function(e){return un.prototype.copy.call(this,e),this.sh.copy(e.sh),this},fromJSON:function(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this},toJSON:function(e){return e=un.prototype.toJSON.call(this,e),e.object.sh=this.sh.toArray(),e}}),zx.prototype=pt(ft(Gi.prototype),{constructor:zx,load:function(e,n,u,m){var _=this,T=new Ta(_.manager);T.setPath(_.path),T.load(e,function(R){try{n(_.parse(JSON.parse(R)))}catch(N){m?m(N):console.error(N),_.manager.itemError(e)}},u,m)},parse:function(e){function n(N){return u[N]===void 0&&console.warn("THREE.MaterialLoader: Undefined texture",N),u[N]}var u=this.textures,m=new tL[e.type];if(e.uuid!==void 0&&(m.uuid=e.uuid),e.name!==void 0&&(m.name=e.name),e.color!==void 0&&m.color.setHex(e.color),e.roughness!==void 0&&(m.roughness=e.roughness),e.metalness!==void 0&&(m.metalness=e.metalness),e.sheen!==void 0&&(m.sheen=new wt().setHex(e.sheen)),e.emissive!==void 0&&m.emissive.setHex(e.emissive),e.specular!==void 0&&m.specular.setHex(e.specular),e.shininess!==void 0&&(m.shininess=e.shininess),e.clearcoat!==void 0&&(m.clearcoat=e.clearcoat),e.clearcoatRoughness!==void 0&&(m.clearcoatRoughness=e.clearcoatRoughness),e.fog!==void 0&&(m.fog=e.fog),e.flatShading!==void 0&&(m.flatShading=e.flatShading),e.blending!==void 0&&(m.blending=e.blending),e.combine!==void 0&&(m.combine=e.combine),e.side!==void 0&&(m.side=e.side),e.opacity!==void 0&&(m.opacity=e.opacity),e.transparent!==void 0&&(m.transparent=e.transparent),e.alphaTest!==void 0&&(m.alphaTest=e.alphaTest),e.depthTest!==void 0&&(m.depthTest=e.depthTest),e.depthWrite!==void 0&&(m.depthWrite=e.depthWrite),e.colorWrite!==void 0&&(m.colorWrite=e.colorWrite),e.stencilWrite!==void 0&&(m.stencilWrite=e.stencilWrite),e.stencilWriteMask!==void 0&&(m.stencilWriteMask=e.stencilWriteMask),e.stencilFunc!==void 0&&(m.stencilFunc=e.stencilFunc),e.stencilRef!==void 0&&(m.stencilRef=e.stencilRef),e.stencilFuncMask!==void 0&&(m.stencilFuncMask=e.stencilFuncMask),e.stencilFail!==void 0&&(m.stencilFail=e.stencilFail),e.stencilZFail!==void 0&&(m.stencilZFail=e.stencilZFail),e.stencilZPass!==void 0&&(m.stencilZPass=e.stencilZPass),e.wireframe!==void 0&&(m.wireframe=e.wireframe),e.wireframeLinewidth!==void 0&&(m.wireframeLinewidth=e.wireframeLinewidth),e.wireframeLinecap!==void 0&&(m.wireframeLinecap=e.wireframeLinecap),e.wireframeLinejoin!==void 0&&(m.wireframeLinejoin=e.wireframeLinejoin),e.rotation!==void 0&&(m.rotation=e.rotation),e.linewidth!==1&&(m.linewidth=e.linewidth),e.dashSize!==void 0&&(m.dashSize=e.dashSize),e.gapSize!==void 0&&(m.gapSize=e.gapSize),e.scale!==void 0&&(m.scale=e.scale),e.polygonOffset!==void 0&&(m.polygonOffset=e.polygonOffset),e.polygonOffsetFactor!==void 0&&(m.polygonOffsetFactor=e.polygonOffsetFactor),e.polygonOffsetUnits!==void 0&&(m.polygonOffsetUnits=e.polygonOffsetUnits),e.skinning!==void 0&&(m.skinning=e.skinning),e.morphTargets!==void 0&&(m.morphTargets=e.morphTargets),e.morphNormals!==void 0&&(m.morphNormals=e.morphNormals),e.dithering!==void 0&&(m.dithering=e.dithering),e.vertexTangents!==void 0&&(m.vertexTangents=e.vertexTangents),e.visible!==void 0&&(m.visible=e.visible),e.toneMapped!==void 0&&(m.toneMapped=e.toneMapped),e.userData!==void 0&&(m.userData=e.userData),e.vertexColors!==void 0&&(m.vertexColors=typeof e.vertexColors=="number"?0<e.vertexColors:e.vertexColors),e.uniforms!==void 0)for(var _ in e.uniforms){var T=e.uniforms[_];switch(m.uniforms[_]={},T.type){case"t":m.uniforms[_].value=n(T.value);break;case"c":m.uniforms[_].value=new wt().setHex(T.value);break;case"v2":m.uniforms[_].value=new f().fromArray(T.value);break;case"v3":m.uniforms[_].value=new w().fromArray(T.value);break;case"v4":m.uniforms[_].value=new p().fromArray(T.value);break;case"m3":m.uniforms[_].value=new c().fromArray(T.value);case"m4":m.uniforms[_].value=new I().fromArray(T.value);break;default:m.uniforms[_].value=T.value}}if(e.defines!==void 0&&(m.defines=e.defines),e.vertexShader!==void 0&&(m.vertexShader=e.vertexShader),e.fragmentShader!==void 0&&(m.fragmentShader=e.fragmentShader),e.extensions!==void 0)for(var R in e.extensions)m.extensions[R]=e.extensions[R];return e.shading!==void 0&&(m.flatShading=e.shading===1),e.size!==void 0&&(m.size=e.size),e.sizeAttenuation!==void 0&&(m.sizeAttenuation=e.sizeAttenuation),e.map!==void 0&&(m.map=n(e.map)),e.matcap!==void 0&&(m.matcap=n(e.matcap)),e.alphaMap!==void 0&&(m.alphaMap=n(e.alphaMap)),e.bumpMap!==void 0&&(m.bumpMap=n(e.bumpMap)),e.bumpScale!==void 0&&(m.bumpScale=e.bumpScale),e.normalMap!==void 0&&(m.normalMap=n(e.normalMap)),e.normalMapType!==void 0&&(m.normalMapType=e.normalMapType),e.normalScale!==void 0&&(_=e.normalScale,Array.isArray(_)===!1&&(_=[_,_]),m.normalScale=new f().fromArray(_)),e.displacementMap!==void 0&&(m.displacementMap=n(e.displacementMap)),e.displacementScale!==void 0&&(m.displacementScale=e.displacementScale),e.displacementBias!==void 0&&(m.displacementBias=e.displacementBias),e.roughnessMap!==void 0&&(m.roughnessMap=n(e.roughnessMap)),e.metalnessMap!==void 0&&(m.metalnessMap=n(e.metalnessMap)),e.emissiveMap!==void 0&&(m.emissiveMap=n(e.emissiveMap)),e.emissiveIntensity!==void 0&&(m.emissiveIntensity=e.emissiveIntensity),e.specularMap!==void 0&&(m.specularMap=n(e.specularMap)),e.envMap!==void 0&&(m.envMap=n(e.envMap)),e.envMapIntensity!==void 0&&(m.envMapIntensity=e.envMapIntensity),e.reflectivity!==void 0&&(m.reflectivity=e.reflectivity),e.refractionRatio!==void 0&&(m.refractionRatio=e.refractionRatio),e.lightMap!==void 0&&(m.lightMap=n(e.lightMap)),e.lightMapIntensity!==void 0&&(m.lightMapIntensity=e.lightMapIntensity),e.aoMap!==void 0&&(m.aoMap=n(e.aoMap)),e.aoMapIntensity!==void 0&&(m.aoMapIntensity=e.aoMapIntensity),e.gradientMap!==void 0&&(m.gradientMap=n(e.gradientMap)),e.clearcoatMap!==void 0&&(m.clearcoatMap=n(e.clearcoatMap)),e.clearcoatRoughnessMap!==void 0&&(m.clearcoatRoughnessMap=n(e.clearcoatRoughnessMap)),e.clearcoatNormalMap!==void 0&&(m.clearcoatNormalMap=n(e.clearcoatNormalMap)),e.clearcoatNormalScale!==void 0&&(m.clearcoatNormalScale=new f().fromArray(e.clearcoatNormalScale)),m},setTextures:function(e){return this.textures=e,this}});var Yw={decodeText:function(e){if(typeof TextDecoder!="undefined")return new TextDecoder().decode(e);for(var n="",u=0,m=e.length;u<m;u++)n+=String.fromCharCode(e[u]);try{return decodeURIComponent(escape(n))}catch{return n}},extractUrlBase:function(e){var n=e.lastIndexOf("/");return n===-1?"./":e.substr(0,n+1)}};m0.prototype=pt(ft(vt.prototype),{constructor:m0,isInstancedBufferGeometry:!0,copy:function(e){return vt.prototype.copy.call(this,e),this.instanceCount=e.instanceCount,this},clone:function(){return new this.constructor().copy(this)},toJSON:function(){var e=vt.prototype.toJSON.call(this);return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}),Nx.prototype=pt(ft(re.prototype),{constructor:Nx,isInstancedBufferAttribute:!0,copy:function(e){return re.prototype.copy.call(this,e),this.meshPerAttribute=e.meshPerAttribute,this},toJSON:function(){var e=re.prototype.toJSON.call(this);return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}),Ux.prototype=pt(ft(Gi.prototype),{constructor:Ux,load:function(e,n,u,m){var _=this,T=new Ta(_.manager);T.setPath(_.path),T.load(e,function(R){try{n(_.parse(JSON.parse(R)))}catch(N){m?m(N):console.error(N),_.manager.itemError(e)}},u,m)},parse:function(e){var n=e.isInstancedBufferGeometry?new m0:new vt,u=e.data.index;if(u!==void 0){var m=new Zw[u.type](u.array);n.setIndex(new re(m,1))}u=e.data.attributes;for(var _ in u){var T=u[_];m=new Zw[T.type](T.array),m=new(T.isInstancedBufferAttribute?Nx:re)(m,T.itemSize,T.normalized),T.name!==void 0&&(m.name=T.name),n.setAttribute(_,m)}var R=e.data.morphAttributes;if(R)for(_ in R){var N=R[_],H=[];u=0;for(var W=N.length;u<W;u++)T=N[u],m=new Zw[T.type](T.array),m=new re(m,T.itemSize,T.normalized),T.name!==void 0&&(m.name=T.name),H.push(m);n.morphAttributes[_]=H}if(e.data.morphTargetsRelative&&(n.morphTargetsRelative=!0),_=e.data.groups||e.data.drawcalls||e.data.offsets,_!==void 0)for(u=0,T=_.length;u!==T;++u)m=_[u],n.addGroup(m.start,m.count,m.materialIndex);return u=e.data.boundingSphere,u!==void 0&&(_=new w,u.center!==void 0&&_.fromArray(u.center),n.boundingSphere=new it(_,u.radius)),e.name&&(n.name=e.name),e.userData&&(n.userData=e.userData),n}});var Zw={Int8Array,Uint8Array,Uint8ClampedArray:typeof Uint8ClampedArray!="undefined"?Uint8ClampedArray:Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};bx.prototype=pt(ft(Gi.prototype),{constructor:bx,load:function(e,n,u,m){var _=this,T=this.path===""?Yw.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||T,T=new Ta(_.manager),T.setPath(this.path),T.load(e,function(R){var N=null;try{N=JSON.parse(R)}catch(H){m!==void 0&&m(H),console.error("THREE:ObjectLoader: Can't parse "+e+".",H.message);return}R=N.metadata,R===void 0||R.type===void 0||R.type.toLowerCase()==="geometry"?console.error("THREE.ObjectLoader: Can't load "+e):_.parse(N,n)},u,m)},parse:function(e,n){var u=this.parseShape(e.shapes);u=this.parseGeometries(e.geometries,u);var m=this.parseImages(e.images,function(){n!==void 0&&n(_)});m=this.parseTextures(e.textures,m),m=this.parseMaterials(e.materials,m);var _=this.parseObject(e.object,u,m);return e.animations&&(_.animations=this.parseAnimations(e.animations)),e.images!==void 0&&e.images.length!==0||n===void 0||n(_),_},parseShape:function(e){var n={};if(e!==void 0)for(var u=0,m=e.length;u<m;u++){var _=new Lc().fromJSON(e[u]);n[_.uuid]=_}return n},parseGeometries:function(e,n){var u={};if(e!==void 0)for(var m=new Ux,_=0,T=e.length;_<T;_++){var R=e[_];switch(R.type){case"PlaneGeometry":case"PlaneBufferGeometry":var N=new ss[R.type](R.width,R.height,R.widthSegments,R.heightSegments);break;case"BoxGeometry":case"BoxBufferGeometry":case"CubeGeometry":N=new ss[R.type](R.width,R.height,R.depth,R.widthSegments,R.heightSegments,R.depthSegments);break;case"CircleGeometry":case"CircleBufferGeometry":N=new ss[R.type](R.radius,R.segments,R.thetaStart,R.thetaLength);break;case"CylinderGeometry":case"CylinderBufferGeometry":N=new ss[R.type](R.radiusTop,R.radiusBottom,R.height,R.radialSegments,R.heightSegments,R.openEnded,R.thetaStart,R.thetaLength);break;case"ConeGeometry":case"ConeBufferGeometry":N=new ss[R.type](R.radius,R.height,R.radialSegments,R.heightSegments,R.openEnded,R.thetaStart,R.thetaLength);break;case"SphereGeometry":case"SphereBufferGeometry":N=new ss[R.type](R.radius,R.widthSegments,R.heightSegments,R.phiStart,R.phiLength,R.thetaStart,R.thetaLength);break;case"DodecahedronGeometry":case"DodecahedronBufferGeometry":case"IcosahedronGeometry":case"IcosahedronBufferGeometry":case"OctahedronGeometry":case"OctahedronBufferGeometry":case"TetrahedronGeometry":case"TetrahedronBufferGeometry":N=new ss[R.type](R.radius,R.detail);break;case"RingGeometry":case"RingBufferGeometry":N=new ss[R.type](R.innerRadius,R.outerRadius,R.thetaSegments,R.phiSegments,R.thetaStart,R.thetaLength);break;case"TorusGeometry":case"TorusBufferGeometry":N=new ss[R.type](R.radius,R.tube,R.radialSegments,R.tubularSegments,R.arc);break;case"TorusKnotGeometry":case"TorusKnotBufferGeometry":N=new ss[R.type](R.radius,R.tube,R.tubularSegments,R.radialSegments,R.p,R.q);break;case"TubeGeometry":case"TubeBufferGeometry":N=new ss[R.type](new Xw[R.path.type]().fromJSON(R.path),R.tubularSegments,R.radius,R.radialSegments,R.closed);break;case"LatheGeometry":case"LatheBufferGeometry":N=new ss[R.type](R.points,R.segments,R.phiStart,R.phiLength);break;case"PolyhedronGeometry":case"PolyhedronBufferGeometry":N=new ss[R.type](R.vertices,R.indices,R.radius,R.details);break;case"ShapeGeometry":case"ShapeBufferGeometry":N=[];for(var H=0,W=R.shapes.length;H<W;H++){var $=n[R.shapes[H]];N.push($)}N=new ss[R.type](N,R.curveSegments);break;case"ExtrudeGeometry":case"ExtrudeBufferGeometry":for(N=[],H=0,W=R.shapes.length;H<W;H++)$=n[R.shapes[H]],N.push($);H=R.options.extrudePath,H!==void 0&&(R.options.extrudePath=new Xw[H.type]().fromJSON(H)),N=new ss[R.type](N,R.options);break;case"BufferGeometry":case"InstancedBufferGeometry":N=m.parse(R);break;case"Geometry":console.error('THREE.ObjectLoader: Loading "Geometry" is not supported anymore.');break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+R.type+'"');continue}N.uuid=R.uuid,R.name!==void 0&&(N.name=R.name),N.isBufferGeometry===!0&&R.userData!==void 0&&(N.userData=R.userData),u[R.uuid]=N}return u},parseMaterials:function(e,n){var u={},m={};if(e!==void 0){var _=new zx;_.setTextures(n),n=0;for(var T=e.length;n<T;n++){var R=e[n];if(R.type==="MultiMaterial"){for(var N=[],H=0;H<R.materials.length;H++){var W=R.materials[H];u[W.uuid]===void 0&&(u[W.uuid]=_.parse(W)),N.push(u[W.uuid])}m[R.uuid]=N}else u[R.uuid]===void 0&&(u[R.uuid]=_.parse(R)),m[R.uuid]=u[R.uuid]}}return m},parseAnimations:function(e){for(var n=[],u=0;u<e.length;u++){var m=e[u],_=Ca.parse(m);m.uuid!==void 0&&(_.uuid=m.uuid),n.push(_)}return n},parseImages:function(e,n){function u(rt){return m.manager.itemStart(rt),T.load(rt,function(){m.manager.itemEnd(rt)},void 0,function(){m.manager.itemError(rt),m.manager.itemEnd(rt)})}var m=this,_={};if(e!==void 0&&0<e.length){n=new q_(n);var T=new ym(n);T.setCrossOrigin(this.crossOrigin),n=0;for(var R=e.length;n<R;n++){var N=e[n],H=N.url;if(Array.isArray(H)){_[N.uuid]=[];for(var W=0,$=H.length;W<$;W++){var K=H[W];K=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(K)?K:m.resourcePath+K,_[N.uuid].push(u(K))}}else K=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(N.url)?N.url:m.resourcePath+N.url,_[N.uuid]=u(K)}}return _},parseTextures:function(e,n){function u(H,W){return typeof H=="number"?H:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",H),W[H])}var m={};if(e!==void 0)for(var _=0,T=e.length;_<T;_++){var R=e[_];R.image===void 0&&console.warn('THREE.ObjectLoader: No "image" specified for',R.uuid),n[R.image]===void 0&&console.warn("THREE.ObjectLoader: Undefined image",R.image);var N=Array.isArray(n[R.image])?new wa(n[R.image]):new d(n[R.image]);N.needsUpdate=!0,N.uuid=R.uuid,R.name!==void 0&&(N.name=R.name),R.mapping!==void 0&&(N.mapping=u(R.mapping,eL)),R.offset!==void 0&&N.offset.fromArray(R.offset),R.repeat!==void 0&&N.repeat.fromArray(R.repeat),R.center!==void 0&&N.center.fromArray(R.center),R.rotation!==void 0&&(N.rotation=R.rotation),R.wrap!==void 0&&(N.wrapS=u(R.wrap[0],HT),N.wrapT=u(R.wrap[1],HT)),R.format!==void 0&&(N.format=R.format),R.type!==void 0&&(N.type=R.type),R.encoding!==void 0&&(N.encoding=R.encoding),R.minFilter!==void 0&&(N.minFilter=u(R.minFilter,GT)),R.magFilter!==void 0&&(N.magFilter=u(R.magFilter,GT)),R.anisotropy!==void 0&&(N.anisotropy=R.anisotropy),R.flipY!==void 0&&(N.flipY=R.flipY),R.premultiplyAlpha!==void 0&&(N.premultiplyAlpha=R.premultiplyAlpha),R.unpackAlignment!==void 0&&(N.unpackAlignment=R.unpackAlignment),m[R.uuid]=N}return m},parseObject:function(e,n,u){function m(W){return n[W]===void 0&&console.warn("THREE.ObjectLoader: Undefined geometry",W),n[W]}function _(W){if(W!==void 0){if(Array.isArray(W)){for(var $=[],K=0,rt=W.length;K<rt;K++){var et=W[K];u[et]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",et),$.push(u[et])}return $}return u[W]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",W),u[W]}}switch(e.type){case"Scene":var T=new X;e.background!==void 0&&fc(e.background)&&(T.background=new wt(e.background)),e.fog!==void 0&&(e.fog.type==="Fog"?T.fog=new lx(e.fog.color,e.fog.near,e.fog.far):e.fog.type==="FogExp2"&&(T.fog=new ux(e.fog.color,e.fog.density)));break;case"PerspectiveCamera":T=new Ae(e.fov,e.aspect,e.near,e.far),e.focus!==void 0&&(T.focus=e.focus),e.zoom!==void 0&&(T.zoom=e.zoom),e.filmGauge!==void 0&&(T.filmGauge=e.filmGauge),e.filmOffset!==void 0&&(T.filmOffset=e.filmOffset),e.view!==void 0&&(T.view=pt({},e.view));break;case"OrthographicCamera":T=new Am(e.left,e.right,e.top,e.bottom,e.near,e.far),e.zoom!==void 0&&(T.zoom=e.zoom),e.view!==void 0&&(T.view=pt({},e.view));break;case"AmbientLight":T=new Ox(e.color,e.intensity);break;case"DirectionalLight":T=new Dx(e.color,e.intensity);break;case"PointLight":T=new Rx(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":T=new Fx(e.color,e.intensity,e.width,e.height);break;case"SpotLight":T=new Lx(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":T=new Ix(e.color,e.groundColor,e.intensity);break;case"LightProbe":T=new Sa().fromJSON(e);break;case"SkinnedMesh":console.warn("THREE.ObjectLoader.parseObject() does not support SkinnedMesh yet.");case"Mesh":T=m(e.geometry);var R=_(e.material);T=new Pt(T,R);break;case"InstancedMesh":T=m(e.geometry),R=_(e.material);var N=e.instanceMatrix;T=new px(T,R,e.count),T.instanceMatrix=new re(new Float32Array(N.array),16);break;case"LOD":T=new Vv;break;case"Line":T=new js(m(e.geometry),_(e.material),e.mode);break;case"LineLoop":T=new dx(m(e.geometry),_(e.material));break;case"LineSegments":T=new In(m(e.geometry),_(e.material));break;case"PointCloud":case"Points":T=new em(m(e.geometry),_(e.material));break;case"Sprite":T=new Gv(_(e.material));break;case"Group":T=new tm;break;default:T=new F}if(T.uuid=e.uuid,e.name!==void 0&&(T.name=e.name),e.matrix!==void 0?(T.matrix.fromArray(e.matrix),e.matrixAutoUpdate!==void 0&&(T.matrixAutoUpdate=e.matrixAutoUpdate),T.matrixAutoUpdate&&T.matrix.decompose(T.position,T.quaternion,T.scale)):(e.position!==void 0&&T.position.fromArray(e.position),e.rotation!==void 0&&T.rotation.fromArray(e.rotation),e.quaternion!==void 0&&T.quaternion.fromArray(e.quaternion),e.scale!==void 0&&T.scale.fromArray(e.scale)),e.castShadow!==void 0&&(T.castShadow=e.castShadow),e.receiveShadow!==void 0&&(T.receiveShadow=e.receiveShadow),e.shadow&&(e.shadow.bias!==void 0&&(T.shadow.bias=e.shadow.bias),e.shadow.radius!==void 0&&(T.shadow.radius=e.shadow.radius),e.shadow.mapSize!==void 0&&T.shadow.mapSize.fromArray(e.shadow.mapSize),e.shadow.camera!==void 0&&(T.shadow.camera=this.parseObject(e.shadow.camera))),e.visible!==void 0&&(T.visible=e.visible),e.frustumCulled!==void 0&&(T.frustumCulled=e.frustumCulled),e.renderOrder!==void 0&&(T.renderOrder=e.renderOrder),e.userData!==void 0&&(T.userData=e.userData),e.layers!==void 0&&(T.layers.mask=e.layers),e.children!==void 0)for(N=e.children,R=0;R<N.length;R++)T.add(this.parseObject(N[R],n,u));if(e.type==="LOD")for(e.autoUpdate!==void 0&&(T.autoUpdate=e.autoUpdate),e=e.levels,N=0;N<e.length;N++){R=e[N];var H=T.getObjectByProperty("uuid",R.object);H!==void 0&&T.addLevel(H,R.distance)}return T}});var eL={UVMapping:300,CubeReflectionMapping:301,CubeRefractionMapping:302,EquirectangularReflectionMapping:303,EquirectangularRefractionMapping:304,SphericalReflectionMapping:305,CubeUVReflectionMapping:306,CubeUVRefractionMapping:307},HT={RepeatWrapping:1e3,ClampToEdgeWrapping:1001,MirroredRepeatWrapping:1002},GT={NearestFilter:1003,NearestMipmapNearestFilter:1004,NearestMipmapLinearFilter:1005,LinearFilter:1006,LinearMipmapNearestFilter:1007,LinearMipmapLinearFilter:1008};tw.prototype=pt(ft(Gi.prototype),{constructor:tw,setOptions:function(e){return this.options=e,this},load:function(e,n,u,m){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);var _=this,T=zp.get(e);if(T!==void 0)return _.manager.itemStart(e),setTimeout(function(){n&&n(T),_.manager.itemEnd(e)},0),T;fetch(e).then(function(R){return R.blob()}).then(function(R){return _.options===void 0?createImageBitmap(R):createImageBitmap(R,_.options)}).then(function(R){zp.add(e,R),n&&n(R),_.manager.itemEnd(e)}).catch(function(R){m&&m(R),_.manager.itemError(e),_.manager.itemEnd(e)}),_.manager.itemStart(e)}}),pt(ew.prototype,{moveTo:function(e,n){return this.currentPath=new du,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,n),this},lineTo:function(e,n){return this.currentPath.lineTo(e,n),this},quadraticCurveTo:function(e,n,u,m){return this.currentPath.quadraticCurveTo(e,n,u,m),this},bezierCurveTo:function(e,n,u,m,_,T){return this.currentPath.bezierCurveTo(e,n,u,m,_,T),this},splineThru:function(e){return this.currentPath.splineThru(e),this},toShapes:function(e,n){function u(Ft){for(var Wt=[],Ht=0,$t=Ft.length;Ht<$t;Ht++){var Yt=Ft[Ht],ie=new Lc;ie.curves=Yt.curves,Wt.push(ie)}return Wt}function m(Ft,Wt){for(var Ht=Wt.length,$t=!1,Yt=Ht-1,ie=0;ie<Ht;Yt=ie++){var Vt=Wt[Yt],ve=Wt[ie],Le=ve.x-Vt.x,oe=ve.y-Vt.y;if(Math.abs(oe)>an){if(0>oe&&(Vt=Wt[ie],Le=-Le,ve=Wt[Yt],oe=-oe),!(Ft.y<Vt.y||Ft.y>ve.y))if(Ft.y===Vt.y){if(Ft.x===Vt.x)return!0}else{if(Yt=oe*(Ft.x-Vt.x)-Le*(Ft.y-Vt.y),Yt===0)return!0;0>Yt||($t=!$t)}}else if(Ft.y===Vt.y&&(ve.x<=Ft.x&&Ft.x<=Vt.x||Vt.x<=Ft.x&&Ft.x<=ve.x))return!0}return $t}var _=vh.isClockWise,T=this.subPaths;if(T.length===0)return[];if(n===!0)return u(T);if(n=[],T.length===1){var R=T[0],N=new Lc;return N.curves=R.curves,n.push(N),n}var H=!_(T[0].getPoints());H=e?!H:H,N=[];var W=[],$=[],K=0;W[K]=void 0,$[K]=[];for(var rt=0,et=T.length;rt<et;rt++){R=T[rt];var at=R.getPoints(),mt=_(at);(mt=e?!mt:mt)?(!H&&W[K]&&K++,W[K]={s:new Lc,p:at},W[K].s.curves=R.curves,H&&K++,$[K]=[]):$[K].push({h:R,p:at[0]})}if(!W[0])return u(T);if(1<W.length){for(rt=!1,e=[],_=0,T=W.length;_<T;_++)N[_]=[];for(_=0,T=W.length;_<T;_++)for(R=$[_],mt=0;mt<R.length;mt++){for(H=R[mt],K=!0,at=0;at<W.length;at++)m(H.p,W[at].p)&&(_!==at&&e.push({froms:_,tos:at,hole:mt}),K?(K=!1,N[at].push(H)):rt=!0);K&&N[_].push(H)}0<e.length&&(rt||($=N))}for(rt=0,_=W.length;rt<_;rt++)for(N=W[rt].s,n.push(N),e=$[rt],T=0,R=e.length;T<R;T++)N.holes.push(e[T].h);return n}}),pt(rw.prototype,{isFont:!0,generateShapes:function(e,n){n===void 0&&(n=100);var u=[],m=n;n=this.data;var _=Hu?Hu(e):String(e).split("");m/=n.resolution;var T=(n.boundingBox.yMax-n.boundingBox.yMin+n.underlineThickness)*m;e=[];for(var R=0,N=0,H=0;H<_.length;H++){var W=_[H];if(W===`
`)R=0,N-=T;else{var $=W;W=m;var K=R,rt=N,et=n,at=et.glyphs[$]||et.glyphs["?"];if(at){if($=new ew,at.o){et=at._cachedOutline||(at._cachedOutline=at.o.split(" "));for(var mt=0,Ft=et.length;mt<Ft;)switch(et[mt++]){case"m":var Wt=et[mt++]*W+K,Ht=et[mt++]*W+rt;$.moveTo(Wt,Ht);break;case"l":Wt=et[mt++]*W+K,Ht=et[mt++]*W+rt,$.lineTo(Wt,Ht);break;case"q":var $t=et[mt++]*W+K,Yt=et[mt++]*W+rt,ie=et[mt++]*W+K,Vt=et[mt++]*W+rt;$.quadraticCurveTo(ie,Vt,$t,Yt);break;case"b":$t=et[mt++]*W+K,Yt=et[mt++]*W+rt,ie=et[mt++]*W+K,Vt=et[mt++]*W+rt,Wt=et[mt++]*W+K,Ht=et[mt++]*W+rt,$.bezierCurveTo(ie,Vt,Wt,Ht,$t,Yt)}}W={offsetX:at.ha*W,path:$}}else console.error('THREE.Font: character "'+$+'" does not exists in font family '+et.familyName+"."),W=void 0;R+=W.offsetX,e.push(W.path)}}for(n=0,_=e.length;n<_;n++)Array.prototype.push.apply(u,e[n].toShapes());return u}}),iw.prototype=pt(ft(Gi.prototype),{constructor:iw,load:function(e,n,u,m){var _=this,T=new Ta(this.manager);T.setPath(this.path),T.load(e,function(R){try{var N=JSON.parse(R)}catch{console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),N=JSON.parse(R.substring(65,R.length-2))}R=_.parse(N),n&&n(R)},u,m)},parse:function(e){return new rw(e)}});var d2,qw={getContext:function(){return d2===void 0&&(d2=new(window.AudioContext||window.webkitAudioContext)),d2},setContext:function(e){d2=e}};kx.prototype=pt(ft(Gi.prototype),{constructor:kx,load:function(e,n,u,m){var _=this,T=new Ta(_.manager);T.setResponseType("arraybuffer"),T.setPath(_.path),T.load(e,function(R){try{var N=R.slice(0);qw.getContext().decodeAudioData(N,function(H){n(H)})}catch(H){m?m(H):console.error(H),_.manager.itemError(e)}},u,m)}}),nw.prototype=pt(ft(Sa.prototype),{constructor:nw,isHemisphereLightProbe:!0,copy:function(e){return Sa.prototype.copy.call(this,e),this},toJSON:function(e){return Sa.prototype.toJSON.call(this,e)}}),ow.prototype=pt(ft(Sa.prototype),{constructor:ow,isAmbientLightProbe:!0,copy:function(e){return Sa.prototype.copy.call(this,e),this},toJSON:function(e){return Sa.prototype.toJSON.call(this,e)}});var VT=new I,WT=new I;pt(J3.prototype,{update:function(e){var n=this._cache;if(n.focus!==e.focus||n.fov!==e.fov||n.aspect!==e.aspect*this.aspect||n.near!==e.near||n.far!==e.far||n.zoom!==e.zoom||n.eyeSep!==this.eyeSep){n.focus=e.focus,n.fov=e.fov,n.aspect=e.aspect*this.aspect,n.near=e.near,n.far=e.far,n.zoom=e.zoom,n.eyeSep=this.eyeSep;var u=e.projectionMatrix.clone(),m=n.eyeSep/2,_=m*n.near/n.focus,T=n.near*Math.tan(ni.DEG2RAD*n.fov*.5)/n.zoom;WT.elements[12]=-m,VT.elements[12]=m,m=-T*n.aspect+_;var R=T*n.aspect+_;u.elements[0]=2*n.near/(R-m),u.elements[8]=(R+m)/(R-m),this.cameraL.projectionMatrix.copy(u),m=-T*n.aspect-_,R=T*n.aspect-_,u.elements[0]=2*n.near/(R-m),u.elements[8]=(R+m)/(R-m),this.cameraR.projectionMatrix.copy(u)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(WT),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(VT)}}),pt(sw.prototype,{start:function(){this.oldTime=this.startTime=(typeof performance=="undefined"?Date:performance).now(),this.elapsedTime=0,this.running=!0},stop:function(){this.getElapsedTime(),this.autoStart=this.running=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){var e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var n=(typeof performance=="undefined"?Date:performance).now();e=(n-this.oldTime)/1e3,this.oldTime=n,this.elapsedTime+=e}return e}});var Np=new w,jT=new z,rL=new w,Up=new w;aw.prototype=pt(ft(F.prototype),{constructor:aw,getInput:function(){return this.gain},removeFilter:function(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this},getFilter:function(){return this.filter},setFilter:function(e){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this},getMasterVolume:function(){return this.gain.gain.value},setMasterVolume:function(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this},updateMatrixWorld:function(e){F.prototype.updateMatrixWorld.call(this,e),e=this.context.listener;var n=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(Np,jT,rL),Up.set(0,0,-1).applyQuaternion(jT),e.positionX){var u=this.context.currentTime+this.timeDelta;e.positionX.linearRampToValueAtTime(Np.x,u),e.positionY.linearRampToValueAtTime(Np.y,u),e.positionZ.linearRampToValueAtTime(Np.z,u),e.forwardX.linearRampToValueAtTime(Up.x,u),e.forwardY.linearRampToValueAtTime(Up.y,u),e.forwardZ.linearRampToValueAtTime(Up.z,u),e.upX.linearRampToValueAtTime(n.x,u),e.upY.linearRampToValueAtTime(n.y,u),e.upZ.linearRampToValueAtTime(n.z,u)}else e.setPosition(Np.x,Np.y,Np.z),e.setOrientation(Up.x,Up.y,Up.z,n.x,n.y,n.z)}}),_m.prototype=pt(ft(F.prototype),{constructor:_m,getOutput:function(){return this.gain},setNodeSource:function(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this},setMediaElementSource:function(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this},setMediaStreamSource:function(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this},setBuffer:function(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this},play:function(e){if(e===void 0&&(e=0),this.isPlaying===!0)console.warn("THREE.Audio: Audio is already playing.");else if(this.hasPlaybackControl===!1)console.warn("THREE.Audio: this Audio has no playback control.");else return this._startedAt=this.context.currentTime+e,e=this.context.createBufferSource(),e.buffer=this.buffer,e.loop=this.loop,e.loopStart=this.loopStart,e.loopEnd=this.loopEnd,e.onended=this.onEnded.bind(this),e.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=e,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()},pause:function(){if(this.hasPlaybackControl===!1)console.warn("THREE.Audio: this Audio has no playback control.");else return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress%=this.duration||this.buffer.duration),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this},stop:function(){if(this.hasPlaybackControl===!1)console.warn("THREE.Audio: this Audio has no playback control.");else return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this},connect:function(){if(0<this.filters.length){this.source.connect(this.filters[0]);for(var e=1,n=this.filters.length;e<n;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this},disconnect:function(){if(0<this.filters.length){this.source.disconnect(this.filters[0]);for(var e=1,n=this.filters.length;e<n;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this},getFilters:function(){return this.filters},setFilters:function(e){return e||(e=[]),this.isPlaying===!0?(this.disconnect(),this.filters=e,this.connect()):this.filters=e,this},setDetune:function(e){if(this.detune=e,this.source.detune!==void 0)return this.isPlaying===!0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this},getDetune:function(){return this.detune},getFilter:function(){return this.getFilters()[0]},setFilter:function(e){return this.setFilters(e?[e]:[])},setPlaybackRate:function(e){if(this.hasPlaybackControl===!1)console.warn("THREE.Audio: this Audio has no playback control.");else return this.playbackRate=e,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this},getPlaybackRate:function(){return this.playbackRate},onEnded:function(){this.isPlaying=!1},getLoop:function(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop},setLoop:function(e){if(this.hasPlaybackControl===!1)console.warn("THREE.Audio: this Audio has no playback control.");else return this.loop=e,this.isPlaying===!0&&(this.source.loop=this.loop),this},setLoopStart:function(e){return this.loopStart=e,this},setLoopEnd:function(e){return this.loopEnd=e,this},getVolume:function(){return this.gain.gain.value},setVolume:function(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}});var bp=new w,XT=new z,iL=new w,kp=new w;uw.prototype=pt(ft(_m.prototype),{constructor:uw,getOutput:function(){return this.panner},getRefDistance:function(){return this.panner.refDistance},setRefDistance:function(e){return this.panner.refDistance=e,this},getRolloffFactor:function(){return this.panner.rolloffFactor},setRolloffFactor:function(e){return this.panner.rolloffFactor=e,this},getDistanceModel:function(){return this.panner.distanceModel},setDistanceModel:function(e){return this.panner.distanceModel=e,this},getMaxDistance:function(){return this.panner.maxDistance},setMaxDistance:function(e){return this.panner.maxDistance=e,this},setDirectionalCone:function(e,n,u){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=n,this.panner.coneOuterGain=u,this},updateMatrixWorld:function(e){if(F.prototype.updateMatrixWorld.call(this,e),this.hasPlaybackControl!==!0||this.isPlaying!==!1)if(this.matrixWorld.decompose(bp,XT,iL),kp.set(0,0,1).applyQuaternion(XT),e=this.panner,e.positionX){var n=this.context.currentTime+this.listener.timeDelta;e.positionX.linearRampToValueAtTime(bp.x,n),e.positionY.linearRampToValueAtTime(bp.y,n),e.positionZ.linearRampToValueAtTime(bp.z,n),e.orientationX.linearRampToValueAtTime(kp.x,n),e.orientationY.linearRampToValueAtTime(kp.y,n),e.orientationZ.linearRampToValueAtTime(kp.z,n)}else e.setPosition(bp.x,bp.y,bp.z),e.setOrientation(kp.x,kp.y,kp.z)}}),pt(lw.prototype,{getFrequencyData:function(){return this.analyser.getByteFrequencyData(this.data),this.data},getAverageFrequency:function(){for(var e=0,n=this.getFrequencyData(),u=0;u<n.length;u++)e+=n[u];return e/n.length}}),pt(hw.prototype,{accumulate:function(e,n){var u=this.buffer,m=this.valueSize;e=e*m+m;var _=this.cumulativeWeight;if(_===0){for(_=0;_!==m;++_)u[e+_]=u[_];_=n}else _+=n,this._mixBufferRegion(u,e,0,n/_,m);this.cumulativeWeight=_},accumulateAdditive:function(e){var n=this.buffer,u=this.valueSize,m=u*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(n,m,0,e,u),this.cumulativeWeightAdditive+=e},apply:function(e){var n=this.valueSize,u=this.buffer;e=e*n+n;var m=this.cumulativeWeight,_=this.cumulativeWeightAdditive,T=this.binding;for(this.cumulativeWeightAdditive=this.cumulativeWeight=0,1>m&&this._mixBufferRegion(u,e,n*this._origIndex,1-m,n),0<_&&this._mixBufferRegionAdditive(u,e,this._addIndex*n,1,n),m=n,_=n+n;m!==_;++m)if(u[m]!==u[m+n]){T.setValue(u,e);break}},saveOriginalState:function(){var e=this.buffer,n=this.valueSize,u=n*this._origIndex;this.binding.getValue(e,u);for(var m=n;m!==u;++m)e[m]=e[u+m%n];this._setIdentity(),this.cumulativeWeightAdditive=this.cumulativeWeight=0},restoreOriginalState:function(){this.binding.setValue(this.buffer,3*this.valueSize)},_setAdditiveIdentityNumeric:function(){for(var e=this._addIndex*this.valueSize,n=e+this.valueSize;e<n;e++)this.buffer[e]=0},_setAdditiveIdentityQuaternion:function(){this._setAdditiveIdentityNumeric(),this.buffer[4*this._addIndex+3]=1},_setAdditiveIdentityOther:function(){for(var e=this._origIndex*this.valueSize,n=this._addIndex*this.valueSize,u=0;u<this.valueSize;u++)this.buffer[n+u]=this.buffer[e+u]},_select:function(e,n,u,m,_){if(.5<=m)for(m=0;m!==_;++m)e[n+m]=e[u+m]},_slerp:function(e,n,u,m){z.slerpFlat(e,n,e,n,e,u,m)},_slerpAdditive:function(e,n,u,m,_){_*=this._workIndex,z.multiplyQuaternionsFlat(e,_,e,n,e,u),z.slerpFlat(e,n,e,n,e,_,m)},_lerp:function(e,n,u,m,_){for(var T=1-m,R=0;R!==_;++R){var N=n+R;e[N]=e[N]*T+e[u+R]*m}},_lerpAdditive:function(e,n,u,m,_){for(var T=0;T!==_;++T){var R=n+T;e[R]+=e[u+T]*m}}});var nL=/[\[\]\.:\/]/g,oL="[^"+"\\[\\]\\.:\\/".replace("\\.","")+"]",sL=/((?:WC+[\/:])*)/.source.replace("WC","[^\\[\\]\\.:\\/]"),aL=/(WCOD+)?/.source.replace("WCOD",oL),uL=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC","[^\\[\\]\\.:\\/]"),lL=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC","[^\\[\\]\\.:\\/]"),hL=new RegExp("^"+sL+aL+uL+lL+"$"),cL=["material","materials","bones"];pt(Q3.prototype,{getValue:function(e,n){this.bind();var u=this._bindings[this._targetGroup.nCachedObjects_];u!==void 0&&u.getValue(e,n)},setValue:function(e,n){for(var u=this._bindings,m=this._targetGroup.nCachedObjects_,_=u.length;m!==_;++m)u[m].setValue(e,n)},bind:function(){for(var e=this._bindings,n=this._targetGroup.nCachedObjects_,u=e.length;n!==u;++n)e[n].bind()},unbind:function(){for(var e=this._bindings,n=this._targetGroup.nCachedObjects_,u=e.length;n!==u;++n)e[n].unbind()}}),pt(Go,{Composite:Q3,create:function(e,n,u){return e&&e.isAnimationObjectGroup?new Go.Composite(e,n,u):new Go(e,n,u)},sanitizeNodeName:function(e){return e.replace(/\s/g,"_").replace(nL,"")},parseTrackName:function(e){var n=hL.exec(e);if(!n)throw Error("PropertyBinding: Cannot parse trackName: "+e);n={nodeName:n[2],objectName:n[3],objectIndex:n[4],propertyName:n[5],propertyIndex:n[6]};var u=n.nodeName&&n.nodeName.lastIndexOf(".");if(u!==void 0&&u!==-1){var m=n.nodeName.substring(u+1);cL.indexOf(m)!==-1&&(n.nodeName=n.nodeName.substring(0,u),n.objectName=m)}if(n.propertyName===null||n.propertyName.length===0)throw Error("PropertyBinding: can not parse propertyName from trackName: "+e);return n},findNode:function(e,n){if(!n||n===""||n==="."||n===-1||n===e.name||n===e.uuid)return e;if(e.skeleton){var u=e.skeleton.getBoneByName(n);if(u!==void 0)return u}return e.children&&(e=function m(_){for(var T=0;T<_.length;T++){var R=_[T];if(R.name===n||R.uuid===n||(R=m(R.children)))return R}return null}(e.children))?e:null}}),pt(Go.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(e,n){e[n]=this.node[this.propertyName]},function(e,n){for(var u=this.resolvedProperty,m=0,_=u.length;m!==_;++m)e[n++]=u[m]},function(e,n){e[n]=this.resolvedProperty[this.propertyIndex]},function(e,n){this.resolvedProperty.toArray(e,n)}],SetterByBindingTypeAndVersioning:[[function(e,n){this.targetObject[this.propertyName]=e[n]},function(e,n){this.targetObject[this.propertyName]=e[n],this.targetObject.needsUpdate=!0},function(e,n){this.targetObject[this.propertyName]=e[n],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,n){for(var u=this.resolvedProperty,m=0,_=u.length;m!==_;++m)u[m]=e[n++]},function(e,n){for(var u=this.resolvedProperty,m=0,_=u.length;m!==_;++m)u[m]=e[n++];this.targetObject.needsUpdate=!0},function(e,n){for(var u=this.resolvedProperty,m=0,_=u.length;m!==_;++m)u[m]=e[n++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,n){this.resolvedProperty[this.propertyIndex]=e[n]},function(e,n){this.resolvedProperty[this.propertyIndex]=e[n],this.targetObject.needsUpdate=!0},function(e,n){this.resolvedProperty[this.propertyIndex]=e[n],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,n){this.resolvedProperty.fromArray(e,n)},function(e,n){this.resolvedProperty.fromArray(e,n),this.targetObject.needsUpdate=!0},function(e,n){this.resolvedProperty.fromArray(e,n),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(e,n){this.bind(),this.getValue(e,n)},setValue:function(e,n){this.bind(),this.setValue(e,n)},bind:function(){var e=this.node,n=this.parsedPath,u=n.objectName,m=n.propertyName,_=n.propertyIndex;if(e||(this.node=e=Go.findNode(this.rootNode,n.nodeName)||this.rootNode),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,e){if(u){var T=n.objectIndex;switch(u){case"materials":if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}for(e=e.skeleton.bones,u=0;u<e.length;u++)if(e[u].name===T){T=u;break}break;default:if(e[u]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[u]}if(T!==void 0){if(e[T]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[T]}}if(T=e[m],T===void 0)console.error("THREE.PropertyBinding: Trying to update property for track: "+n.nodeName+"."+m+" but it wasn't found.",e);else{if(n=this.Versioning.None,this.targetObject=e,e.needsUpdate!==void 0?n=this.Versioning.NeedsUpdate:e.matrixWorldNeedsUpdate!==void 0&&(n=this.Versioning.MatrixWorldNeedsUpdate),u=this.BindingType.Direct,_!==void 0){if(m==="morphTargetInfluences"){if(!e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(e.geometry.isBufferGeometry){if(!e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[_]!==void 0&&(_=e.morphTargetDictionary[_])}else{console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences on THREE.Geometry. Use THREE.BufferGeometry instead.",this);return}}u=this.BindingType.ArrayElement,this.resolvedProperty=T,this.propertyIndex=_}else T.fromArray!==void 0&&T.toArray!==void 0?(u=this.BindingType.HasFromToArray,this.resolvedProperty=T):Array.isArray(T)?(u=this.BindingType.EntireArray,this.resolvedProperty=T):this.propertyName=m;this.getValue=this.GetterByBindingType[u],this.setValue=this.SetterByBindingTypeAndVersioning[u][n]}}else console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.")},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}),pt(Go.prototype,{_getValue_unbound:Go.prototype.getValue,_setValue_unbound:Go.prototype.setValue}),pt(K3.prototype,{isAnimationObjectGroup:!0,add:function(){for(var e=this._objects,n=e.length,u=this.nCachedObjects_,m=this._indicesByUUID,_=this._paths,T=this._parsedPaths,R=this._bindings,N=R.length,H=void 0,W=0,$=arguments.length;W!==$;++W){var K=arguments[W],rt=K.uuid,et=m[rt];if(et===void 0){et=n++,m[rt]=et,e.push(K),rt=0;for(var at=N;rt!==at;++rt)R[rt].push(new Go(K,_[rt],T[rt]))}else if(et<u){H=e[et];var mt=--u;for(at=e[mt],m[at.uuid]=et,e[et]=at,m[rt]=mt,e[mt]=K,rt=0,at=N;rt!==at;++rt){var Ft=R[rt],Wt=Ft[et];Ft[et]=Ft[mt],Wt===void 0&&(Wt=new Go(K,_[rt],T[rt])),Ft[mt]=Wt}}else e[et]!==H&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=u},remove:function(){for(var e=this._objects,n=this.nCachedObjects_,u=this._indicesByUUID,m=this._bindings,_=m.length,T=0,R=arguments.length;T!==R;++T){var N=arguments[T],H=N.uuid,W=u[H];if(W!==void 0&&W>=n){var $=n++,K=e[$];for(u[K.uuid]=W,e[W]=K,u[H]=$,e[$]=N,N=0,H=_;N!==H;++N){K=m[N];var rt=K[W];K[W]=K[$],K[$]=rt}}}this.nCachedObjects_=n},uncache:function(){for(var e=this._objects,n=e.length,u=this.nCachedObjects_,m=this._indicesByUUID,_=this._bindings,T=_.length,R=0,N=arguments.length;R!==N;++R){var H=arguments[R].uuid,W=m[H];if(W!==void 0)if(delete m[H],W<u){H=--u;var $=e[H],K=--n,rt=e[K];for(m[$.uuid]=W,e[W]=$,m[rt.uuid]=H,e[H]=rt,e.pop(),$=0,rt=T;$!==rt;++$){var et=_[$],at=et[K];et[W]=et[H],et[H]=at,et.pop()}}else for(K=--n,rt=e[K],m[rt.uuid]=W,e[W]=rt,e.pop(),$=0,rt=T;$!==rt;++$)et=_[$],et[W]=et[K],et.pop()}this.nCachedObjects_=u},subscribe_:function(e,n){var u=this._bindingsIndicesByPath,m=u[e],_=this._bindings;if(m!==void 0)return _[m];var T=this._paths,R=this._parsedPaths,N=this._objects,H=this.nCachedObjects_,W=Array(N.length);for(m=_.length,u[e]=m,T.push(e),R.push(n),_.push(W),u=H,m=N.length;u!==m;++u)W[u]=new Go(N[u],e,n);return W},unsubscribe_:function(e){var n=this._bindingsIndicesByPath,u=n[e];if(u!==void 0){var m=this._paths,_=this._parsedPaths,T=this._bindings,R=T.length-1,N=T[R];n[e[R]]=u,T[u]=N,T.pop(),_[u]=_[R],_.pop(),m[u]=m[R],m.pop()}}}),pt($3.prototype,{play:function(){return this._mixer._activateAction(this),this},stop:function(){return this._mixer._deactivateAction(this),this.reset()},reset:function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()},isRunning:function(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)},isScheduled:function(){return this._mixer._isActiveAction(this)},startAt:function(e){return this._startTime=e,this},setLoop:function(e,n){return this.loop=e,this.repetitions=n,this},setEffectiveWeight:function(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()},getEffectiveWeight:function(){return this._effectiveWeight},fadeIn:function(e){return this._scheduleFading(e,0,1)},fadeOut:function(e){return this._scheduleFading(e,1,0)},crossFadeFrom:function(e,n,u){if(e.fadeOut(n),this.fadeIn(n),u){u=this._clip.duration;var m=e._clip.duration,_=u/m;e.warp(1,m/u,n),this.warp(_,1,n)}return this},crossFadeTo:function(e,n,u){return e.crossFadeFrom(this,n,u)},stopFading:function(){var e=this._weightInterpolant;return e!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this},setEffectiveTimeScale:function(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()},getEffectiveTimeScale:function(){return this._effectiveTimeScale},setDuration:function(e){return this.timeScale=this._clip.duration/e,this.stopWarping()},syncWith:function(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()},halt:function(e){return this.warp(this._effectiveTimeScale,0,e)},warp:function(e,n,u){var m=this._mixer,_=m.time,T=this._timeScaleInterpolant,R=this.timeScale;return T===null&&(this._timeScaleInterpolant=T=m._lendControlInterpolant()),m=T.parameterPositions,T=T.sampleValues,m[0]=_,m[1]=_+u,T[0]=e/R,T[1]=n/R,this},stopWarping:function(){var e=this._timeScaleInterpolant;return e!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this},getMixer:function(){return this._mixer},getClip:function(){return this._clip},getRoot:function(){return this._localRoot||this._mixer._root},_update:function(e,n,u,m){if(this.enabled){var _=this._startTime;if(_!==null){if(n=(e-_)*u,0>n||u===0)return;this._startTime=null,n*=u}if(n*=this._updateTimeScale(e),u=this._updateTime(n),e=this._updateWeight(e),0<e)switch(n=this._interpolants,_=this._propertyBindings,this.blendMode){case 2501:for(var T=0,R=n.length;T!==R;++T)n[T].evaluate(u),_[T].accumulateAdditive(e);break;default:for(T=0,R=n.length;T!==R;++T)n[T].evaluate(u),_[T].accumulate(m,e)}}else this._updateWeight(e)},_updateWeight:function(e){var n=0;if(this.enabled){n=this.weight;var u=this._weightInterpolant;if(u!==null){var m=u.evaluate(e)[0];n*=m,e>u.parameterPositions[1]&&(this.stopFading(),m===0&&(this.enabled=!1))}}return this._effectiveWeight=n},_updateTimeScale:function(e){var n=0;if(!this.paused){n=this.timeScale;var u=this._timeScaleInterpolant;if(u!==null){var m=u.evaluate(e)[0];n*=m,e>u.parameterPositions[1]&&(this.stopWarping(),n===0?this.paused=!0:this.timeScale=n)}}return this._effectiveTimeScale=n},_updateTime:function(e){var n=this.time+e,u=this._clip.duration,m=this.loop,_=this._loopCount,T=m===2202;if(e===0)return _===-1?n:T&&(_&1)===1?u-n:n;if(m===2200)t:{if(_===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1)),n>=u)n=u;else if(0>n)n=0;else{this.time=n;break t}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=n,this._mixer.dispatchEvent({type:"finished",action:this,direction:0>e?-1:1})}else{if(_===-1&&(0<=e?(_=0,this._setEndings(!0,this.repetitions===0,T)):this._setEndings(this.repetitions===0,!0,T)),n>=u||0>n){m=Math.floor(n/u),n-=u*m,_+=Math.abs(m);var R=this.repetitions-_;0>=R?(this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=n=0<e?u:0,this._mixer.dispatchEvent({type:"finished",action:this,direction:0<e?1:-1})):(R===1?(e=0>e,this._setEndings(e,!e,T)):this._setEndings(!1,!1,T),this._loopCount=_,this.time=n,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:m}))}else this.time=n;if(T&&(_&1)===1)return u-n}return n},_setEndings:function(e,n,u){var m=this._interpolantSettings;u?(m.endingStart=2401,m.endingEnd=2401):(m.endingStart=e?this.zeroSlopeAtStart?2401:2400:2402,m.endingEnd=n?this.zeroSlopeAtEnd?2401:2400:2402)},_scheduleFading:function(e,n,u){var m=this._mixer,_=m.time,T=this._weightInterpolant;return T===null&&(this._weightInterpolant=T=m._lendControlInterpolant()),m=T.parameterPositions,T=T.sampleValues,m[0]=_,T[0]=n,m[1]=_+e,T[1]=u,this}}),cw.prototype=pt(ft(s.prototype),{constructor:cw,_bindAction:function(e,n){var u=e._localRoot||this._root,m=e._clip.tracks,_=m.length,T=e._propertyBindings;e=e._interpolants;var R=u.uuid,N=this._bindingsByRootAndName,H=N[R];for(H===void 0&&(H={},N[R]=H),N=0;N!==_;++N){var W=m[N],$=W.name,K=H[$];if(K===void 0){if(K=T[N],K!==void 0){K._cacheIndex===null&&(++K.referenceCount,this._addInactiveBinding(K,R,$));continue}K=new hw(Go.create(u,$,n&&n._propertyBindings[N].binding.parsedPath),W.ValueTypeName,W.getValueSize()),++K.referenceCount,this._addInactiveBinding(K,R,$)}T[N]=K,e[N].resultBuffer=K.buffer}},_activateAction:function(e){if(!this._isActiveAction(e)){if(e._cacheIndex===null){var n=(e._localRoot||this._root).uuid,u=e._clip.uuid,m=this._actionsByClip[u];this._bindAction(e,m&&m.knownActions[0]),this._addInactiveAction(e,u,n)}for(n=e._propertyBindings,u=0,m=n.length;u!==m;++u){var _=n[u];_.useCount++===0&&(this._lendBinding(_),_.saveOriginalState())}this._lendAction(e)}},_deactivateAction:function(e){if(this._isActiveAction(e)){for(var n=e._propertyBindings,u=0,m=n.length;u!==m;++u){var _=n[u];--_.useCount===0&&(_.restoreOriginalState(),this._takeBackBinding(_))}this._takeBackAction(e)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;var e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}},_isActiveAction:function(e){return e=e._cacheIndex,e!==null&&e<this._nActiveActions},_addInactiveAction:function(e,n,u){var m=this._actions,_=this._actionsByClip,T=_[n];T===void 0?(T={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,_[n]=T):(n=T.knownActions,e._byClipCacheIndex=n.length,n.push(e)),e._cacheIndex=m.length,m.push(e),T.actionByRoot[u]=e},_removeInactiveAction:function(e){var n=this._actions,u=n[n.length-1],m=e._cacheIndex;u._cacheIndex=m,n[m]=u,n.pop(),e._cacheIndex=null,n=e._clip.uuid,u=this._actionsByClip,m=u[n];var _=m.knownActions,T=_[_.length-1],R=e._byClipCacheIndex;T._byClipCacheIndex=R,_[R]=T,_.pop(),e._byClipCacheIndex=null,delete m.actionByRoot[(e._localRoot||this._root).uuid],_.length===0&&delete u[n],this._removeInactiveBindingsForAction(e)},_removeInactiveBindingsForAction:function(e){e=e._propertyBindings;for(var n=0,u=e.length;n!==u;++n){var m=e[n];--m.referenceCount===0&&this._removeInactiveBinding(m)}},_lendAction:function(e){var n=this._actions,u=e._cacheIndex,m=this._nActiveActions++,_=n[m];e._cacheIndex=m,n[m]=e,_._cacheIndex=u,n[u]=_},_takeBackAction:function(e){var n=this._actions,u=e._cacheIndex,m=--this._nActiveActions,_=n[m];e._cacheIndex=m,n[m]=e,_._cacheIndex=u,n[u]=_},_addInactiveBinding:function(e,n,u){var m=this._bindingsByRootAndName,_=m[n],T=this._bindings;_===void 0&&(_={},m[n]=_),_[u]=e,e._cacheIndex=T.length,T.push(e)},_removeInactiveBinding:function(e){var n=this._bindings,u=e.binding,m=u.rootNode.uuid;u=u.path;var _=this._bindingsByRootAndName,T=_[m],R=n[n.length-1];e=e._cacheIndex,R._cacheIndex=e,n[e]=R,n.pop(),delete T[u],Ti(T).length===0&&delete _[m]},_lendBinding:function(e){var n=this._bindings,u=e._cacheIndex,m=this._nActiveBindings++,_=n[m];e._cacheIndex=m,n[m]=e,_._cacheIndex=u,n[u]=_},_takeBackBinding:function(e){var n=this._bindings,u=e._cacheIndex,m=--this._nActiveBindings,_=n[m];e._cacheIndex=m,n[m]=e,_._cacheIndex=u,n[u]=_},_lendControlInterpolant:function(){var e=this._controlInterpolants,n=this._nActiveControlInterpolants++,u=e[n];return u===void 0&&(u=new c0(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer),u.__cacheIndex=n,e[n]=u),u},_takeBackControlInterpolant:function(e){var n=this._controlInterpolants,u=e.__cacheIndex,m=--this._nActiveControlInterpolants,_=n[m];e.__cacheIndex=m,n[m]=e,_.__cacheIndex=u,n[u]=_},_controlInterpolantsResultBuffer:new Float32Array(1),clipAction:function(e,n,u){var m=n||this._root,_=m.uuid;m=typeof e=="string"?Ca.findByName(m,e):e,e=m!==null?m.uuid:e;var T=this._actionsByClip[e],R=null;if(u===void 0&&(u=m!==null?m.blendMode:2500),T!==void 0){if(R=T.actionByRoot[_],R!==void 0&&R.blendMode===u)return R;R=T.knownActions[0],m===null&&(m=R._clip)}return m===null?null:(n=new $3(this,m,n,u),this._bindAction(n,R),this._addInactiveAction(n,e,_),n)},existingAction:function(e,n){var u=n||this._root;return n=u.uuid,u=typeof e=="string"?Ca.findByName(u,e):e,e=this._actionsByClip[u?u.uuid:e],e!==void 0&&e.actionByRoot[n]||null},stopAllAction:function(){for(var e=this._actions,n=this._nActiveActions-1;0<=n;--n)e[n].stop();return this},update:function(e){e*=this.timeScale;for(var n=this._actions,u=this._nActiveActions,m=this.time+=e,_=Qu(e),T=this._accuIndex^=1,R=0;R!==u;++R)n[R]._update(m,e,_,T);for(e=this._bindings,n=this._nActiveBindings,R=0;R!==n;++R)e[R].apply(T);return this},setTime:function(e){for(var n=this.time=0;n<this._actions.length;n++)this._actions[n].time=0;return this.update(e)},getRoot:function(){return this._root},uncacheClip:function(e){var n=this._actions;e=e.uuid;var u=this._actionsByClip,m=u[e];if(m!==void 0){m=m.knownActions;for(var _=0,T=m.length;_!==T;++_){var R=m[_];this._deactivateAction(R);var N=R._cacheIndex,H=n[n.length-1];R._cacheIndex=null,R._byClipCacheIndex=null,H._cacheIndex=N,n[N]=H,n.pop(),this._removeInactiveBindingsForAction(R)}delete u[e]}},uncacheRoot:function(e){e=e.uuid;var n=this._actionsByClip;for(m in n){var u=n[m].actionByRoot[e];u!==void 0&&(this._deactivateAction(u),this._removeInactiveAction(u))}var m=this._bindingsByRootAndName[e];if(m!==void 0)for(var _ in m)e=m[_],e.restoreOriginalState(),this._removeInactiveBinding(e)},uncacheAction:function(e,n){e=this.existingAction(e,n),e!==null&&(this._deactivateAction(e),this._removeInactiveAction(e))}}),Hx.prototype.clone=function(){return new Hx(this.value.clone===void 0?this.value:this.value.clone())},fw.prototype=pt(ft(sh.prototype),{constructor:fw,isInstancedInterleavedBuffer:!0,copy:function(e){return sh.prototype.copy.call(this,e),this.meshPerAttribute=e.meshPerAttribute,this}}),pt(pw.prototype,{set:function(e,n){this.ray.set(e,n)},setFromCamera:function(e,n){n&&n.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(n.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(n).sub(this.ray.origin).normalize(),this.camera=n):n&&n.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(n.near+n.far)/(n.near-n.far)).unproject(n),this.ray.direction.set(0,0,-1).transformDirection(n.matrixWorld),this.camera=n):console.error("THREE.Raycaster: Unsupported camera type.")},intersectObject:function(e,n,u){return u=u||[],dw(e,this,u,n),u.sort(tT),u},intersectObjects:function(e,n,u){if(u=u||[],Array.isArray(e)===!1)return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),u;for(var m=0,_=e.length;m<_;m++)dw(e[m],this,u,n);return u.sort(tT),u}}),pt(eT.prototype,{set:function(e,n,u){return this.radius=e,this.phi=n,this.theta=u,this},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this},makeSafe:function(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this},setFromVector3:function(e){return this.setFromCartesianCoords(e.x,e.y,e.z)},setFromCartesianCoords:function(e,n,u){return this.radius=Math.sqrt(e*e+n*n+u*u),this.radius===0?this.phi=this.theta=0:(this.theta=Math.atan2(e,u),this.phi=Math.acos(ni.clamp(n/this.radius,-1,1))),this}}),pt(rT.prototype,{set:function(e,n,u){return this.radius=e,this.theta=n,this.y=u,this},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this},setFromVector3:function(e){return this.setFromCartesianCoords(e.x,e.y,e.z)},setFromCartesianCoords:function(e,n,u){return this.radius=Math.sqrt(e*e+u*u),this.theta=Math.atan2(e,u),this.y=n,this}});var YT=new f;pt(mw.prototype,{set:function(e,n){return this.min.copy(e),this.max.copy(n),this},setFromPoints:function(e){this.makeEmpty();for(var n=0,u=e.length;n<u;n++)this.expandByPoint(e[n]);return this},setFromCenterAndSize:function(e,n){return n=YT.copy(n).multiplyScalar(.5),this.min.copy(e).sub(n),this.max.copy(e).add(n),this},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.min.copy(e.min),this.max.copy(e.max),this},makeEmpty:function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},getCenter:function(e){return e===void 0&&(console.warn("THREE.Box2: .getCenter() target is now required"),e=new f),this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(e){return e===void 0&&(console.warn("THREE.Box2: .getSize() target is now required"),e=new f),this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)},expandByPoint:function(e){return this.min.min(e),this.max.max(e),this},expandByVector:function(e){return this.min.sub(e),this.max.add(e),this},expandByScalar:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this},containsPoint:function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)},containsBox:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y},getParameter:function(e,n){return n===void 0&&(console.warn("THREE.Box2: .getParameter() target is now required"),n=new f),n.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))},intersectsBox:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)},clampPoint:function(e,n){return n===void 0&&(console.warn("THREE.Box2: .clampPoint() target is now required"),n=new f),n.copy(e).clamp(this.min,this.max)},distanceToPoint:function(e){return YT.copy(e).clamp(this.min,this.max).sub(e).length()},intersect:function(e){return this.min.max(e.min),this.max.min(e.max),this},union:function(e){return this.min.min(e.min),this.max.max(e.max),this},translate:function(e){return this.min.add(e),this.max.add(e),this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)}});var ZT=new w,m2=new w;pt(gw.prototype,{set:function(e,n){return this.start.copy(e),this.end.copy(n),this},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.start.copy(e.start),this.end.copy(e.end),this},getCenter:function(e){return e===void 0&&(console.warn("THREE.Line3: .getCenter() target is now required"),e=new w),e.addVectors(this.start,this.end).multiplyScalar(.5)},delta:function(e){return e===void 0&&(console.warn("THREE.Line3: .delta() target is now required"),e=new w),e.subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(e,n){return n===void 0&&(console.warn("THREE.Line3: .at() target is now required"),n=new w),this.delta(n).multiplyScalar(e).add(this.start)},closestPointToPointParameter:function(e,n){return ZT.subVectors(e,this.start),m2.subVectors(this.end,this.start),e=m2.dot(m2),e=m2.dot(ZT)/e,n&&(e=ni.clamp(e,0,1)),e},closestPointToPoint:function(e,n,u){return e=this.closestPointToPointParameter(e,n),u===void 0&&(console.warn("THREE.Line3: .closestPointToPoint() target is now required"),u=new w),this.delta(u).multiplyScalar(e).add(this.start)},applyMatrix4:function(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this},equals:function(e){return e.start.equals(this.start)&&e.end.equals(this.end)}}),g0.prototype=ft(F.prototype),g0.prototype.constructor=g0,g0.prototype.isImmediateRenderObject=!0;var qT=new w;wm.prototype=ft(F.prototype),wm.prototype.constructor=wm,wm.prototype.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},wm.prototype.update=function(){this.light.updateMatrixWorld();var e=this.light.distance?this.light.distance:1e3,n=e*Math.tan(this.light.angle);this.cone.scale.set(n,n,e),qT.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(qT),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)};var Uc=new w,g2=new I,Jw=new I;Pp.prototype=ft(In.prototype),Pp.prototype.constructor=Pp,Pp.prototype.isSkeletonHelper=!0,Pp.prototype.updateMatrixWorld=function(e){var n=this.bones,u=this.geometry,m=u.getAttribute("position");Jw.getInverse(this.root.matrixWorld);for(var _=0,T=0;_<n.length;_++){var R=n[_];R.parent&&R.parent.isBone&&(g2.multiplyMatrices(Jw,R.matrixWorld),Uc.setFromMatrixPosition(g2),m.setXYZ(T,Uc.x,Uc.y,Uc.z),g2.multiplyMatrices(Jw,R.parent.matrixWorld),Uc.setFromMatrixPosition(g2),m.setXYZ(T+1,Uc.x,Uc.y,Uc.z),T+=2)}u.getAttribute("position").needsUpdate=!0,F.prototype.updateMatrixWorld.call(this,e)},Mm.prototype=ft(Pt.prototype),Mm.prototype.constructor=Mm,Mm.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},Mm.prototype.update=function(){this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)};var fL=new w,JT=new wt,QT=new wt;Cm.prototype=ft(F.prototype),Cm.prototype.constructor=Cm,Cm.prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},Cm.prototype.update=function(){var e=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{var n=e.geometry.getAttribute("color");JT.copy(this.light.color),QT.copy(this.light.groundColor);for(var u=0,m=n.count;u<m;u++){var _=u<m/2?JT:QT;n.setXYZ(u,_.r,_.g,_.b)}n.needsUpdate=!0}e.lookAt(fL.setFromMatrixPosition(this.light.matrixWorld).negate())},Gx.prototype=pt(ft(In.prototype),{constructor:Gx,copy:function(e){return In.prototype.copy.call(this,e),this.geometry.copy(e.geometry),this.material.copy(e.material),this},clone:function(){return new this.constructor().copy(this)}}),Vx.prototype=ft(In.prototype),Vx.prototype.constructor=Vx;var KT=new w,v2=new w,$T=new w;Tm.prototype=ft(F.prototype),Tm.prototype.constructor=Tm,Tm.prototype.dispose=function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()},Tm.prototype.update=function(){KT.setFromMatrixPosition(this.light.matrixWorld),v2.setFromMatrixPosition(this.light.target.matrixWorld),$T.subVectors(v2,KT),this.lightPlane.lookAt(v2),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(v2),this.targetLine.scale.z=$T.length()};var y2=new w,zn=new te;v0.prototype=ft(In.prototype),v0.prototype.constructor=v0,v0.prototype.update=function(){var e=this.geometry,n=this.pointMap;zn.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),Yn("c",n,e,zn,0,0,-1),Yn("t",n,e,zn,0,0,1),Yn("n1",n,e,zn,-1,-1,-1),Yn("n2",n,e,zn,1,-1,-1),Yn("n3",n,e,zn,-1,1,-1),Yn("n4",n,e,zn,1,1,-1),Yn("f1",n,e,zn,-1,-1,1),Yn("f2",n,e,zn,1,-1,1),Yn("f3",n,e,zn,-1,1,1),Yn("f4",n,e,zn,1,1,1),Yn("u1",n,e,zn,.7,1.1,-1),Yn("u2",n,e,zn,-.7,1.1,-1),Yn("u3",n,e,zn,0,2,-1),Yn("cf1",n,e,zn,-1,0,1),Yn("cf2",n,e,zn,1,0,1),Yn("cf3",n,e,zn,0,-1,1),Yn("cf4",n,e,zn,0,1,1),Yn("cn1",n,e,zn,-1,0,-1),Yn("cn2",n,e,zn,1,0,-1),Yn("cn3",n,e,zn,0,-1,-1),Yn("cn4",n,e,zn,0,1,-1),e.getAttribute("position").needsUpdate=!0};var x2=new q;hh.prototype=ft(In.prototype),hh.prototype.constructor=hh,hh.prototype.update=function(e){if(e!==void 0&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),this.object!==void 0&&x2.setFromObject(this.object),!x2.isEmpty()){e=x2.min;var n=x2.max,u=this.geometry.attributes.position,m=u.array;m[0]=n.x,m[1]=n.y,m[2]=n.z,m[3]=e.x,m[4]=n.y,m[5]=n.z,m[6]=e.x,m[7]=e.y,m[8]=n.z,m[9]=n.x,m[10]=e.y,m[11]=n.z,m[12]=n.x,m[13]=n.y,m[14]=e.z,m[15]=e.x,m[16]=n.y,m[17]=e.z,m[18]=e.x,m[19]=e.y,m[20]=e.z,m[21]=n.x,m[22]=e.y,m[23]=e.z,u.needsUpdate=!0,this.geometry.computeBoundingSphere()}},hh.prototype.setFromObject=function(e){return this.object=e,this.update(),this},hh.prototype.copy=function(e){return In.prototype.copy.call(this,e),this.object=e.object,this},hh.prototype.clone=function(){return new this.constructor().copy(this)},y0.prototype=ft(In.prototype),y0.prototype.constructor=y0,y0.prototype.updateMatrixWorld=function(e){var n=this.box;n.isEmpty()||(n.getCenter(this.position),n.getSize(this.scale),this.scale.multiplyScalar(.5),F.prototype.updateMatrixWorld.call(this,e))},x0.prototype=ft(js.prototype),x0.prototype.constructor=x0,x0.prototype.updateMatrixWorld=function(e){var n=-this.plane.constant;1e-8>Math.abs(n)&&(n=1e-8),this.scale.set(.5*this.size,.5*this.size,n),this.children[0].material.side=0>n?1:0,this.lookAt(this.plane.normal),F.prototype.updateMatrixWorld.call(this,e)};var tS=new w,A2,Qw;ch.prototype=ft(F.prototype),ch.prototype.constructor=ch,ch.prototype.setDirection=function(e){.99999<e.y?this.quaternion.set(0,0,0,1):-.99999>e.y?this.quaternion.set(1,0,0,0):(tS.set(e.z,0,-e.x).normalize(),this.quaternion.setFromAxisAngle(tS,Math.acos(e.y)))},ch.prototype.setLength=function(e,n,u){n===void 0&&(n=.2*e),u===void 0&&(u=.2*n),this.line.scale.set(1,Math.max(1e-4,e-n),1),this.line.updateMatrix(),this.cone.scale.set(u,n,u),this.cone.position.y=e,this.cone.updateMatrix()},ch.prototype.setColor=function(e){this.line.material.color.set(e),this.cone.material.color.set(e)},ch.prototype.copy=function(e){return F.prototype.copy.call(this,e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this},ch.prototype.clone=function(){return new this.constructor().copy(this)},A0.prototype=ft(In.prototype),A0.prototype.constructor=A0;var hl=Math.pow(2,8),eS=[.125,.215,.35,.446,.526,.582],rS=5+eS.length,cl={3e3:0,3001:1,3002:2,3004:3,3005:4,3006:5,3007:6},Kw=new Am,$w=function(){for(var e=[],n=[],u=[],m=8,_=0;_<rS;_++){var T=Math.pow(2,m);n.push(T);var R=1/T;4<_?R=eS[_-8+4-1]:_==0&&(R=0),u.push(R),R=1/(T-1),T=-R/2,R=1+R/2;var N=[T,T,R,T,R,R,T,T,R,R,T,R];T=new Float32Array(108),R=new Float32Array(72);for(var H=new Float32Array(36),W=0;6>W;W++){var $=W%3*2/3-1,K=2<W?0:-1;T.set([$,K,0,$+2/3,K,0,$+2/3,K+1,0,$,K,0,$+2/3,K+1,0,$,K+1,0],18*W),R.set(N,12*W),H.set([W,W,W,W,W,W],6*W)}N=new vt,N.setAttribute("position",new re(T,3)),N.setAttribute("uv",new re(R,2)),N.setAttribute("faceIndex",new re(H,1)),e.push(N),4<m&&m--}return{_lodPlanes:e,_sizeLods:n,_sigmas:u}}(),D0=$w._lodPlanes,iS=$w._sizeLods,_2=$w._sigmas,tM=null,Hp=(1+Math.sqrt(5))/2,Vm=1/Hp,nS=[new w(1,1,1),new w(-1,1,1),new w(1,1,-1),new w(-1,1,-1),new w(0,Hp,Vm),new w(0,Hp,-Vm),new w(Vm,0,Hp),new w(-Vm,0,Hp),new w(Hp,Vm,0),new w(-Hp,Vm,0)];vw.prototype={constructor:vw,fromScene:function(e,n,u,m){n===void 0&&(n=0),u===void 0&&(u=.1),m===void 0&&(m=100),tM=this._renderer.getRenderTarget();var _=this._allocateTargets();return this._sceneToCubeUV(e,u,m,_),0<n&&this._blur(_,0,0,n),this._applyPMREM(_),this._cleanup(_),_},fromEquirectangular:function(e){return e.magFilter=1003,e.minFilter=1003,e.generateMipmaps=!1,this.fromCubemap(e)},fromCubemap:function(e){tM=this._renderer.getRenderTarget();var n=this._allocateTargets(e);return this._textureToCubeUV(e,n),this._applyPMREM(n),this._cleanup(n),n},compileCubemapShader:function(){this._cubemapShader===null&&(this._cubemapShader=sT(),this._compileMaterial(this._cubemapShader))},compileEquirectangularShader:function(){this._equirectShader===null&&(this._equirectShader=oT(),this._compileMaterial(this._equirectShader))},dispose:function(){this._blurMaterial.dispose(),this._cubemapShader!==null&&this._cubemapShader.dispose(),this._equirectShader!==null&&this._equirectShader.dispose();for(var e=0;e<D0.length;e++)D0[e].dispose()},_cleanup:function(e){this._pingPongRenderTarget.dispose(),this._renderer.setRenderTarget(tM),e.scissorTest=!1,e.setSize(e.width,e.height)},_allocateTargets:function(e){var n=e===void 0||e.type!==1009?!1:e.encoding===3e3||e.encoding===3001||e.encoding===3007;n={magFilter:1003,minFilter:1003,generateMipmaps:!1,type:1009,format:1023,encoding:n?e.encoding:3002,depthBuffer:!1,stencilBuffer:!1};var u=nT(n);return u.depthBuffer=!e,this._pingPongRenderTarget=nT(n),u},_compileMaterial:function(e){e=new Pt(D0[0],e),this._renderer.compile(e,Kw)},_sceneToCubeUV:function(e,n,u,m){n=new Ae(90,1,n,u),u=[1,-1,1,1,1,1];var _=[1,1,1,-1,-1,-1],T=this._renderer,R=T.outputEncoding,N=T.toneMapping,H=T.toneMappingExposure,W=T.getClearColor(),$=T.getClearAlpha();T.toneMapping=1,T.toneMappingExposure=1,T.outputEncoding=3e3;var K=e.background;if(K&&K.isColor){K.convertSRGBToLinear();var rt=Math.min(Math.max(Math.ceil(Yg(Math.max(K.r,K.g,K.b))),-128),127);K=K.multiplyScalar(Math.pow(2,-rt)),T.setClearColor(K,(rt+128)/255),e.background=null}for(K=0;6>K;K++)rt=K%3,rt==0?(n.up.set(0,u[K],0),n.lookAt(_[K],0,0)):rt==1?(n.up.set(0,0,u[K]),n.lookAt(0,_[K],0)):(n.up.set(0,u[K],0),n.lookAt(0,0,_[K])),yw(m,rt*hl,2<K?hl:0,hl,hl),T.setRenderTarget(m),T.render(e,n);T.toneMapping=N,T.toneMappingExposure=H,T.outputEncoding=R,T.setClearColor(W,$)},_textureToCubeUV:function(e,n){var u=this._renderer;e.isCubeTexture?this._cubemapShader==null&&(this._cubemapShader=sT()):this._equirectShader==null&&(this._equirectShader=oT());var m=e.isCubeTexture?this._cubemapShader:this._equirectShader,_=new Pt(D0[0],m);m=m.uniforms,m.envMap.value=e,e.isCubeTexture||m.texelSize.value.set(1/e.image.width,1/e.image.height),m.inputEncoding.value=cl[e.encoding],m.outputEncoding.value=cl[n.texture.encoding],yw(n,0,0,3*hl,2*hl),u.setRenderTarget(n),u.render(_,Kw)},_applyPMREM:function(e){var n=this._renderer,u=n.autoClear;n.autoClear=!1;for(var m=1;m<rS;m++)this._blur(e,m-1,m,Math.sqrt(_2[m]*_2[m]-_2[m-1]*_2[m-1]),nS[(m-1)%nS.length]);n.autoClear=u},_blur:function(e,n,u,m,_){var T=this._pingPongRenderTarget;this._halfBlur(e,T,n,u,m,"latitudinal",_),this._halfBlur(T,e,u,u,m,"longitudinal",_)},_halfBlur:function(e,n,u,m,_,T,R){var N=this._renderer,H=this._blurMaterial;T!=="latitudinal"&&T!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");var W=new Pt(D0[m],H);H=H.uniforms;var $=iS[u]-1;$=isFinite(_)?Math.PI/(2*$):2*Math.PI/39;var K=_/$,rt=isFinite(_)?1+Math.floor(3*K):20;20<rt&&console.warn("sigmaRadians, "+_+", is too large and will clip, as it requested "+rt+" samples when the maximum is set to 20"),_=[];for(var et=0,at=0;20>at;++at){var mt=at/K;mt=Math.exp(-mt*mt/2),_.push(mt),at==0?et+=mt:at<rt&&(et+=2*mt)}for(at=0;at<_.length;at++)_[at]/=et;H.envMap.value=e.texture,H.samples.value=rt,H.weights.value=_,H.latitudinal.value=T==="latitudinal",R&&(H.poleAxis.value=R),H.dTheta.value=$,H.mipInt.value=8-u,H.inputEncoding.value=cl[e.texture.encoding],H.outputEncoding.value=cl[e.texture.encoding],e=iS[m],mt=3*Math.max(0,hl-2*e),yw(n,mt,(m===0?0:2*hl)+2*e*(4<m?m-8+4:0),3*e,2*e),N.setRenderTarget(n),N.render(W,Kw)}},Br.create=function(e,n){return e.prototype=ft(Br.prototype),e.prototype.constructor=e,e.prototype.getPoint=n,e},pt(lh.prototype,{createPointsGeometry:function(e){return console.warn("THREE.CurvePath: .createPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead."),e=this.getPoints(e),this.createGeometry(e)},createSpacedPointsGeometry:function(e){return console.warn("THREE.CurvePath: .createSpacedPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead."),e=this.getSpacedPoints(e),this.createGeometry(e)},createGeometry:function(e){console.warn("THREE.CurvePath: .createGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");for(var n=new yt,u=0,m=e.length;u<m;u++){var _=e[u];n.vertices.push(new w(_.x,_.y,_.z||0))}return n}}),pt(du.prototype,{fromPoints:function(e){return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(e)}}),aT.prototype=ft(Ho.prototype),uT.prototype=ft(Ho.prototype),_w.prototype=ft(Ho.prototype),pt(_w.prototype,{initFromArray:function(){console.error("THREE.Spline: .initFromArray() has been removed.")},getControlPointsArray:function(){console.error("THREE.Spline: .getControlPointsArray() has been removed.")},reparametrizeByArcLength:function(){console.error("THREE.Spline: .reparametrizeByArcLength() has been removed.")}}),Gx.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},Pp.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},pt(Gi.prototype,{extractUrlBase:function(e){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),Yw.extractUrlBase(e)}}),Gi.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}},pt(bx.prototype,{setTexturePath:function(e){return console.warn("THREE.ObjectLoader: .setTexturePath() has been renamed to .setResourcePath()."),this.setResourcePath(e)}}),pt(mw.prototype,{center:function(e){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(e)},empty:function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(e){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},size:function(e){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(e)}}),pt(q.prototype,{center:function(e){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(e)},empty:function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(e){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},isIntersectionSphere:function(e){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)},size:function(e){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(e)}}),pt(it.prototype,{empty:function(){return console.warn("THREE.Sphere: .empty() has been renamed to .isEmpty()."),this.isEmpty()}}),Qe.prototype.setFromMatrix=function(e){return console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix()."),this.setFromProjectionMatrix(e)},gw.prototype.center=function(e){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(e)},pt(ni,{random16:function(){return console.warn("THREE.Math: .random16() has been deprecated. Use Math.random() instead."),Math.random()},nearestPowerOfTwo:function(e){return console.warn("THREE.Math: .nearestPowerOfTwo() has been renamed to .floorPowerOfTwo()."),ni.floorPowerOfTwo(e)},nextPowerOfTwo:function(e){return console.warn("THREE.Math: .nextPowerOfTwo() has been renamed to .ceilPowerOfTwo()."),ni.ceilPowerOfTwo(e)}}),pt(c.prototype,{flattenToArrayOffset:function(e,n){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,n)},multiplyVector3:function(e){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),e.applyMatrix3(this)},multiplyVector3Array:function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},applyToBufferAttribute:function(e){return console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead."),e.applyMatrix3(this)},applyToVector3Array:function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")}}),pt(I.prototype,{extractPosition:function(e){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(e)},flattenToArrayOffset:function(e,n){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,n)},getPosition:function(){return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),new w().setFromMatrixColumn(this,3)},setRotationFromQuaternion:function(e){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(e)},multiplyToArray:function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},multiplyVector3:function(e){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},multiplyVector4:function(e){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},multiplyVector3Array:function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},rotateAxis:function(e){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),e.transformDirection(this)},crossVector:function(e){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},translate:function(){console.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},applyToBufferAttribute:function(e){return console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},applyToVector3Array:function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},makeFrustum:function(e,n,u,m,_,T){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(e,n,m,u,_,T)}}),Mt.prototype.isIntersectionLine=function(e){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(e)},z.prototype.multiplyVector3=function(e){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),e.applyQuaternion(this)},pt(lt.prototype,{isIntersectionBox:function(e){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},isIntersectionPlane:function(e){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(e)},isIntersectionSphere:function(e){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)}}),pt(Ct.prototype,{area:function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},barycoordFromPoint:function(e,n){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(e,n)},midpoint:function(e){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(e)},normal:function(e){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(e)},plane:function(e){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(e)}}),pt(Ct,{barycoordFromPoint:function(e,n,u,m,_){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),Ct.getBarycoord(e,n,u,m,_)},normal:function(e,n,u,m){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),Ct.getNormal(e,n,u,m)}}),pt(Lc.prototype,{extractAllPoints:function(e){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(e)},extrude:function(e){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new xp(this,e)},makeGeometry:function(e){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new _p(this,e)}}),pt(f.prototype,{fromAttribute:function(e,n,u){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,n,u)},distanceToManhattan:function(e){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(e)},lengthManhattan:function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),pt(w.prototype,{setEulerFromRotationMatrix:function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(e){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(e)},getScaleFromMatrix:function(e){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(e)},getColumnFromMatrix:function(e,n){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(n,e)},applyProjection:function(e){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(e)},fromAttribute:function(e,n,u){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,n,u)},distanceToManhattan:function(e){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(e)},lengthManhattan:function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),pt(p.prototype,{fromAttribute:function(e,n,u){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,n,u)},lengthManhattan:function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),pt(yt.prototype,{computeTangents:function(){console.error("THREE.Geometry: .computeTangents() has been removed.")},computeLineDistances:function(){console.error("THREE.Geometry: .computeLineDistances() has been removed. Use THREE.Line.computeLineDistances() instead.")},applyMatrix:function(e){return console.warn("THREE.Geometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(e)}}),pt(F.prototype,{getChildByName:function(e){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(e)},renderDepth:function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},translate:function(e,n){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(n,e)},getWorldRotation:function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")},applyMatrix:function(e){return console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(e)}}),Or(F.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(e){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=e}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),pt(Pt.prototype,{setDrawMode:function(){console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}),Or(Pt.prototype,{drawMode:{get:function(){return console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode."),0},set:function(){console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}}),Or(Vv.prototype,{objects:{get:function(){return console.warn("THREE.LOD: .objects has been renamed to .levels."),this.levels}}}),Object.defineProperty(fx.prototype,"useVertexTexture",{get:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")},set:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")}}),cx.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")},Object.defineProperty(Br.prototype,"__arcLengthDivisions",{get:function(){return console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions},set:function(e){console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions=e}}),Ae.prototype.setLens=function(e,n){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),n!==void 0&&(this.filmGauge=n),this.setFocalLength(e)},Or(un.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(e){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=e}},shadowCameraLeft:{set:function(e){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=e}},shadowCameraRight:{set:function(e){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=e}},shadowCameraTop:{set:function(e){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=e}},shadowCameraBottom:{set:function(e){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=e}},shadowCameraNear:{set:function(e){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=e}},shadowCameraFar:{set:function(e){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=e}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(e){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=e}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(e){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=e}},shadowMapHeight:{set:function(e){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=e}}}),Or(re.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},dynamic:{get:function(){return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.usage===35048},set:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.setUsage(35048)}}}),pt(re.prototype,{setDynamic:function(e){return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(e===!0?35048:35044),this},copyIndicesArray:function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},setArray:function(){console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")}}),pt(vt.prototype,{addIndex:function(e){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(e)},addAttribute:function(e,n,u){return console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute()."),n&&n.isBufferAttribute||n&&n.isInterleavedBufferAttribute?e==="index"?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(n),this):this.setAttribute(e,n):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.setAttribute(e,new re(n,u)))},addDrawCall:function(e,n,u){u!==void 0&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(e,n)},clearDrawCalls:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},computeTangents:function(){console.warn("THREE.BufferGeometry: .computeTangents() has been removed.")},computeOffsets:function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")},removeAttribute:function(e){return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."),this.deleteAttribute(e)},applyMatrix:function(e){return console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(e)}}),Or(vt.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),Or(m0.prototype,{maxInstancedCount:{get:function(){return console.warn("THREE.InstancedBufferGeometry: .maxInstancedCount has been renamed to .instanceCount."),this.instanceCount},set:function(e){console.warn("THREE.InstancedBufferGeometry: .maxInstancedCount has been renamed to .instanceCount."),this.instanceCount=e}}}),Or(pw.prototype,{linePrecision:{get:function(){return console.warn("THREE.Raycaster: .linePrecision has been deprecated. Use .params.Line.threshold instead."),this.params.Line.threshold},set:function(e){console.warn("THREE.Raycaster: .linePrecision has been deprecated. Use .params.Line.threshold instead."),this.params.Line.threshold=e}}}),Or(sh.prototype,{dynamic:{get:function(){return console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),this.usage===35048},set:function(e){console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),this.setUsage(e)}}}),pt(sh.prototype,{setDynamic:function(e){return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(e===!0?35048:35044),this},setArray:function(){console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")}}),pt(rl.prototype,{getArrays:function(){console.error("THREE.ExtrudeBufferGeometry: .getArrays() has been removed.")},addShapeList:function(){console.error("THREE.ExtrudeBufferGeometry: .addShapeList() has been removed.")},addShape:function(){console.error("THREE.ExtrudeBufferGeometry: .addShape() has been removed.")}}),Or(Hx.prototype,{dynamic:{set:function(){console.warn("THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.")}},onUpdate:{value:function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this}}}),Or(Qt.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new wt}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(e){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=e===1}},stencilMask:{get:function(){return console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask},set:function(e){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask=e}}}),Or(Ec.prototype,{metal:{get:function(){return console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead."),!1},set:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}}),Or(ue.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(e){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=e}}}),pt(V_.prototype,{clearTarget:function(e,n,u,m){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(e),this.clear(n,u,m)},animate:function(e){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(e)},getCurrentRenderTarget:function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},getMaxAnisotropy:function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},getPrecision:function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},resetGLState:function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},supportsFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},supportsHalfFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},supportsStandardDerivatives:function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},supportsCompressedTextureS3TC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},supportsCompressedTexturePVRTC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},supportsBlendMinMax:function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},supportsVertexTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},supportsInstancedArrays:function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},enableScissorTest:function(e){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(e)},initMaterial:function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},addPrePlugin:function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},addPostPlugin:function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},updateShadowMap:function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},setFaceCulling:function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},allocTextureUnit:function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")},setTexture:function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},setTexture2D:function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")},setTextureCube:function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")},getActiveMipMapLevel:function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()}}),Or(V_.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=e}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=e}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}},vr:{get:function(){return console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr"),this.xr}},gammaInput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead."),!1},set:function(){console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.")}},gammaOutput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),!1},set:function(e){console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),this.outputEncoding=e===!0?3001:3e3}}}),Or(U3.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),Or(A.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=e}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=e}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=e}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=e}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(e){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=e}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(e){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=e}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(e){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=e}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(e){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=e}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(e){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=e}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(e){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=e}}}),Or(_m.prototype,{load:{value:function(e){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");var n=this;return new kx().load(e,function(u){n.setBuffer(u)}),this}},startTime:{set:function(){console.warn("THREE.Audio: .startTime is now .play( delay ).")}}}),lw.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()},cr.prototype.updateCubeMap=function(e,n){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(e,n)},Rc.crossOrigin=void 0,Rc.loadTexture=function(e,n,u,m){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");var _=new Sx;return _.setCrossOrigin(this.crossOrigin),e=_.load(e,u,void 0,m),n&&(e.mapping=n),e},Rc.loadTextureCube=function(e,n,u,m){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");var _=new Tx;return _.setCrossOrigin(this.crossOrigin),e=_.load(e,u,void 0,m),n&&(e.mapping=n),e},Rc.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},Rc.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")},typeof __THREE_DEVTOOLS__!="undefined"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:"117"}})),i.ACESFilmicToneMapping=5,i.AddEquation=100,i.AddOperation=2,i.AdditiveAnimationBlendMode=2501,i.AdditiveBlending=2,i.AlphaFormat=1021,i.AlwaysDepth=1,i.AlwaysStencilFunc=519,i.AmbientLight=Ox,i.AmbientLightProbe=ow,i.AnimationClip=Ca,i.AnimationLoader=J_,i.AnimationMixer=cw,i.AnimationObjectGroup=K3,i.AnimationUtils=vn,i.ArcCurve=xm,i.ArrayCamera=sx,i.ArrowHelper=ch,i.Audio=_m,i.AudioAnalyser=lw,i.AudioContext=qw,i.AudioListener=aw,i.AudioLoader=kx,i.AxesHelper=A0,i.AxisHelper=function(e){return console.warn("THREE.AxisHelper has been renamed to THREE.AxesHelper."),new A0(e)},i.BackSide=1,i.BasicDepthPacking=3200,i.BasicShadowMap=0,i.BinaryTextureLoader=function(e){return console.warn("THREE.BinaryTextureLoader has been renamed to THREE.DataTextureLoader."),new Cx(e)},i.Bone=W_,i.BooleanKeyframeTrack=Ax,i.BoundingBoxHelper=function(e,n){return console.warn("THREE.BoundingBoxHelper has been deprecated. Creating a THREE.BoxHelper instead."),new hh(e,n)},i.Box2=mw,i.Box3=q,i.Box3Helper=y0,i.BoxBufferGeometry=I0,i.BoxGeometry=Uw,i.BoxHelper=hh,i.BufferAttribute=re,i.BufferGeometry=vt,i.BufferGeometryLoader=Ux,i.ByteType=1010,i.Cache=zp,i.Camera=te,i.CameraHelper=v0,i.CanvasRenderer=function(){console.error("THREE.CanvasRenderer has been removed")},i.CanvasTexture=Wv,i.CatmullRomCurve3=Ho,i.CineonToneMapping=4,i.CircleBufferGeometry=mm,i.CircleGeometry=h0,i.ClampToEdgeWrapping=1001,i.Clock=sw,i.ClosedSplineCurve3=aT,i.Color=wt,i.ColorKeyframeTrack=_x,i.CompressedTexture=rm,i.CompressedTextureLoader=Q_,i.ConeBufferGeometry=l0,i.ConeGeometry=u0,i.CubeCamera=cr,i.CubeGeometry=Uw,i.CubeReflectionMapping=301,i.CubeRefractionMapping=302,i.CubeTexture=wa,i.CubeTextureLoader=Tx,i.CubeUVReflectionMapping=306,i.CubeUVRefractionMapping=307,i.CubicBezierCurve=hu,i.CubicBezierCurve3=nl,i.CubicInterpolant=yx,i.CullFaceBack=1,i.CullFaceFront=2,i.CullFaceFrontBack=3,i.CullFaceNone=0,i.Curve=Br,i.CurvePath=lh,i.CustomBlending=5,i.CylinderBufferGeometry=ah,i.CylinderGeometry=Mp,i.Cylindrical=rT,i.DataTexture=me,i.DataTexture2DArray=ko,i.DataTexture3D=os,i.DataTextureLoader=Cx,i.DecrementStencilOp=7683,i.DecrementWrapStencilOp=34056,i.DefaultLoadingManager=kT,i.DepthFormat=1026,i.DepthStencilFormat=1027,i.DepthTexture=jv,i.DirectionalLight=Dx,i.DirectionalLightHelper=Tm,i.DirectionalLightShadow=Px,i.DiscreteInterpolant=xx,i.DodecahedronBufferGeometry=am,i.DodecahedronGeometry=Qv,i.DoubleSide=2,i.DstAlphaFactor=206,i.DstColorFactor=208,i.DynamicBufferAttribute=function(e,n){return console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setUsage( THREE.DynamicDrawUsage ) instead."),new re(e,n).setUsage(35048)},i.DynamicCopyUsage=35050,i.DynamicDrawUsage=35048,i.DynamicReadUsage=35049,i.EdgesGeometry=dm,i.EdgesHelper=function(e,n){return console.warn("THREE.EdgesHelper has been removed. Use THREE.EdgesGeometry instead."),new In(new dm(e.geometry),new gn({color:n!==void 0?n:16777215}))},i.EllipseCurve=Ys,i.EqualDepth=4,i.EqualStencilFunc=514,i.EquirectangularReflectionMapping=303,i.EquirectangularRefractionMapping=304,i.Euler=E,i.EventDispatcher=s,i.ExtrudeBufferGeometry=rl,i.ExtrudeGeometry=xp,i.Face3=Gt,i.Face4=function(e,n,u,m,_,T,R){return console.warn("THREE.Face4 has been removed. A THREE.Face3 will be created instead."),new Gt(e,n,u,_,T,R)},i.FaceColors=1,i.FileLoader=Ta,i.FlatShading=1,i.Float32Attribute=function(e,n){return console.warn("THREE.Float32Attribute has been removed. Use new THREE.Float32BufferAttribute() instead."),new _t(e,n)},i.Float32BufferAttribute=_t,i.Float64Attribute=function(e,n){return console.warn("THREE.Float64Attribute has been removed. Use new THREE.Float64BufferAttribute() instead."),new Rt(e,n)},i.Float64BufferAttribute=Rt,i.FloatType=1015,i.Fog=lx,i.FogExp2=ux,i.Font=rw,i.FontLoader=iw,i.FrontFaceDirectionCCW=1,i.FrontFaceDirectionCW=0,i.FrontSide=0,i.Frustum=Qe,i.GammaEncoding=3007,i.Geometry=yt,i.GeometryUtils={merge:function(e,n,u){if(console.warn("THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead."),n.isMesh){n.matrixAutoUpdate&&n.updateMatrix();var m=n.matrix;n=n.geometry}e.merge(n,m,u)},center:function(e){return console.warn("THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead."),e.center()}},i.GreaterDepth=6,i.GreaterEqualDepth=5,i.GreaterEqualStencilFunc=518,i.GreaterStencilFunc=516,i.GridHelper=Gx,i.Group=tm,i.HalfFloatType=1016,i.HemisphereLight=Ix,i.HemisphereLightHelper=Cm,i.HemisphereLightProbe=nw,i.IcosahedronBufferGeometry=sm,i.IcosahedronGeometry=Jv,i.ImageBitmapLoader=tw,i.ImageLoader=ym,i.ImageUtils=Rc,i.ImmediateRenderObject=g0,i.IncrementStencilOp=7682,i.IncrementWrapStencilOp=34055,i.InstancedBufferAttribute=Nx,i.InstancedBufferGeometry=m0,i.InstancedInterleavedBuffer=fw,i.InstancedMesh=px,i.Int16Attribute=function(e,n){return console.warn("THREE.Int16Attribute has been removed. Use new THREE.Int16BufferAttribute() instead."),new qr(e,n)},i.Int16BufferAttribute=qr,i.Int32Attribute=function(e,n){return console.warn("THREE.Int32Attribute has been removed. Use new THREE.Int32BufferAttribute() instead."),new xt(e,n)},i.Int32BufferAttribute=xt,i.Int8Attribute=function(e,n){return console.warn("THREE.Int8Attribute has been removed. Use new THREE.Int8BufferAttribute() instead."),new We(e,n)},i.Int8BufferAttribute=We,i.IntType=1013,i.InterleavedBuffer=sh,i.InterleavedBufferAttribute=Hv,i.Interpolant=Xs,i.InterpolateDiscrete=2300,i.InterpolateLinear=2301,i.InterpolateSmooth=2302,i.InvertStencilOp=5386,i.JSONLoader=function(){console.error("THREE.JSONLoader has been removed.")},i.KeepStencilOp=7680,i.KeyframeTrack=So,i.LOD=Vv,i.LatheBufferGeometry=pm,i.LatheGeometry=a0,i.Layers=P,i.LensFlare=function(){console.error("THREE.LensFlare has been moved to /examples/jsm/objects/Lensflare.js")},i.LessDepth=2,i.LessEqualDepth=3,i.LessEqualStencilFunc=515,i.LessStencilFunc=513,i.Light=un,i.LightProbe=Sa,i.LightShadow=sl,i.Line=js,i.Line3=gw,i.LineBasicMaterial=gn,i.LineCurve=Ts,i.LineCurve3=cu,i.LineDashedMaterial=Rp,i.LineLoop=dx,i.LinePieces=1,i.LineSegments=In,i.LineStrip=0,i.LinearEncoding=3e3,i.LinearFilter=1006,i.LinearInterpolant=c0,i.LinearMipMapLinearFilter=1008,i.LinearMipMapNearestFilter=1007,i.LinearMipmapLinearFilter=1008,i.LinearMipmapNearestFilter=1007,i.LinearToneMapping=1,i.Loader=Gi,i.LoaderUtils=Yw,i.LoadingManager=q_,i.LogLuvEncoding=3003,i.LoopOnce=2200,i.LoopPingPong=2202,i.LoopRepeat=2201,i.LuminanceAlphaFormat=1025,i.LuminanceFormat=1024,i.MOUSE={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},i.Material=Qt,i.MaterialLoader=zx,i.Math=ni,i.MathUtils=ni,i.Matrix3=c,i.Matrix4=I,i.MaxEquation=104,i.Mesh=Pt,i.MeshBasicMaterial=De,i.MeshDepthMaterial=Cc,i.MeshDistanceMaterial=Tc,i.MeshFaceMaterial=function(e){return console.warn("THREE.MeshFaceMaterial has been removed. Use an Array instead."),e},i.MeshLambertMaterial=Ep,i.MeshMatcapMaterial=Lp,i.MeshNormalMaterial=Ip,i.MeshPhongMaterial=Ec,i.MeshPhysicalMaterial=Tp,i.MeshStandardMaterial=il,i.MeshToonMaterial=Sp,i.MinEquation=103,i.MirroredRepeatWrapping=1002,i.MixOperation=1,i.MultiMaterial=function(e){return e===void 0&&(e=[]),console.warn("THREE.MultiMaterial has been removed. Use an Array instead."),e.isMultiMaterial=!0,e.materials=e,e.clone=function(){return e.slice()},e},i.MultiplyBlending=4,i.MultiplyOperation=0,i.NearestFilter=1003,i.NearestMipMapLinearFilter=1005,i.NearestMipMapNearestFilter=1004,i.NearestMipmapLinearFilter=1005,i.NearestMipmapNearestFilter=1004,i.NeverDepth=0,i.NeverStencilFunc=512,i.NoBlending=0,i.NoColors=0,i.NoToneMapping=0,i.NormalAnimationBlendMode=2500,i.NormalBlending=1,i.NotEqualDepth=7,i.NotEqualStencilFunc=517,i.NumberKeyframeTrack=gm,i.Object3D=F,i.ObjectLoader=bx,i.ObjectSpaceNormalMap=1,i.OctahedronBufferGeometry=vp,i.OctahedronGeometry=qv,i.OneFactor=201,i.OneMinusDstAlphaFactor=207,i.OneMinusDstColorFactor=209,i.OneMinusSrcAlphaFactor=205,i.OneMinusSrcColorFactor=203,i.OrthographicCamera=Am,i.PCFShadowMap=1,i.PCFSoftShadowMap=2,i.PMREMGenerator=vw,i.ParametricBufferGeometry=nm,i.ParametricGeometry=Xv,i.Particle=function(e){return console.warn("THREE.Particle has been renamed to THREE.Sprite."),new Gv(e)},i.ParticleBasicMaterial=function(e){return console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial."),new lu(e)},i.ParticleSystem=function(e,n){return console.warn("THREE.ParticleSystem has been renamed to THREE.Points."),new em(e,n)},i.ParticleSystemMaterial=function(e){return console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial."),new lu(e)},i.Path=du,i.PerspectiveCamera=Ae,i.Plane=Mt,i.PlaneBufferGeometry=hi,i.PlaneGeometry=mn,i.PlaneHelper=x0,i.PointCloud=function(e,n){return console.warn("THREE.PointCloud has been renamed to THREE.Points."),new em(e,n)},i.PointCloudMaterial=function(e){return console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial."),new lu(e)},i.PointLight=Rx,i.PointLightHelper=Mm,i.Points=em,i.PointsMaterial=lu,i.PolarGridHelper=Vx,i.PolyhedronBufferGeometry=Cs,i.PolyhedronGeometry=Yv,i.PositionalAudio=uw,i.PropertyBinding=Go,i.PropertyMixer=hw,i.QuadraticBezierCurve=fu,i.QuadraticBezierCurve3=ol,i.Quaternion=z,i.QuaternionKeyframeTrack=f0,i.QuaternionLinearInterpolant=wx,i.REVISION="117",i.RGBADepthPacking=3201,i.RGBAFormat=1023,i.RGBAIntegerFormat=1033,i.RGBA_ASTC_10x10_Format=37819,i.RGBA_ASTC_10x5_Format=37816,i.RGBA_ASTC_10x6_Format=37817,i.RGBA_ASTC_10x8_Format=37818,i.RGBA_ASTC_12x10_Format=37820,i.RGBA_ASTC_12x12_Format=37821,i.RGBA_ASTC_4x4_Format=37808,i.RGBA_ASTC_5x4_Format=37809,i.RGBA_ASTC_5x5_Format=37810,i.RGBA_ASTC_6x5_Format=37811,i.RGBA_ASTC_6x6_Format=37812,i.RGBA_ASTC_8x5_Format=37813,i.RGBA_ASTC_8x6_Format=37814,i.RGBA_ASTC_8x8_Format=37815,i.RGBA_BPTC_Format=36492,i.RGBA_ETC2_EAC_Format=37496,i.RGBA_PVRTC_2BPPV1_Format=35843,i.RGBA_PVRTC_4BPPV1_Format=35842,i.RGBA_S3TC_DXT1_Format=33777,i.RGBA_S3TC_DXT3_Format=33778,i.RGBA_S3TC_DXT5_Format=33779,i.RGBDEncoding=3006,i.RGBEEncoding=3002,i.RGBEFormat=1023,i.RGBFormat=1022,i.RGBIntegerFormat=1032,i.RGBM16Encoding=3005,i.RGBM7Encoding=3004,i.RGB_ETC1_Format=36196,i.RGB_ETC2_Format=37492,i.RGB_PVRTC_2BPPV1_Format=35841,i.RGB_PVRTC_4BPPV1_Format=35840,i.RGB_S3TC_DXT1_Format=33776,i.RGFormat=1030,i.RGIntegerFormat=1031,i.RawShaderMaterial=uh,i.Ray=lt,i.Raycaster=pw,i.RectAreaLight=Fx,i.RedFormat=1028,i.RedIntegerFormat=1029,i.ReinhardToneMapping=2,i.RepeatWrapping=1e3,i.ReplaceStencilOp=7681,i.ReverseSubtractEquation=102,i.RingBufferGeometry=fm,i.RingGeometry=s0,i.SRGB8_ALPHA8_ASTC_10x10_Format=37851,i.SRGB8_ALPHA8_ASTC_10x5_Format=37848,i.SRGB8_ALPHA8_ASTC_10x6_Format=37849,i.SRGB8_ALPHA8_ASTC_10x8_Format=37850,i.SRGB8_ALPHA8_ASTC_12x10_Format=37852,i.SRGB8_ALPHA8_ASTC_12x12_Format=37853,i.SRGB8_ALPHA8_ASTC_4x4_Format=37840,i.SRGB8_ALPHA8_ASTC_5x4_Format=37841,i.SRGB8_ALPHA8_ASTC_5x5_Format=37842,i.SRGB8_ALPHA8_ASTC_6x5_Format=37843,i.SRGB8_ALPHA8_ASTC_6x6_Format=37844,i.SRGB8_ALPHA8_ASTC_8x5_Format=37845,i.SRGB8_ALPHA8_ASTC_8x6_Format=37846,i.SRGB8_ALPHA8_ASTC_8x8_Format=37847,i.Scene=X,i.SceneUtils={createMultiMaterialObject:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},detach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},attach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")}},i.ShaderChunk=mi,i.ShaderLib=ll,i.ShaderMaterial=ue,i.ShadowMaterial=Cp,i.Shape=Lc,i.ShapeBufferGeometry=wp,i.ShapeGeometry=_p,i.ShapePath=ew,i.ShapeUtils=vh,i.ShortType=1011,i.Skeleton=fx,i.SkeletonHelper=Pp,i.SkinnedMesh=cx,i.SmoothShading=2,i.Sphere=it,i.SphereBufferGeometry=Ap,i.SphereGeometry=o0,i.Spherical=eT,i.SphericalHarmonics3=Bx,i.SphericalReflectionMapping=305,i.Spline=_w,i.SplineCurve=pu,i.SplineCurve3=uT,i.SpotLight=Lx,i.SpotLightHelper=wm,i.SpotLightShadow=Ex,i.Sprite=Gv,i.SpriteMaterial=Sc,i.SrcAlphaFactor=204,i.SrcAlphaSaturateFactor=210,i.SrcColorFactor=202,i.StaticCopyUsage=35046,i.StaticDrawUsage=35044,i.StaticReadUsage=35045,i.StereoCamera=J3,i.StreamCopyUsage=35042,i.StreamDrawUsage=35040,i.StreamReadUsage=35041,i.StringKeyframeTrack=Mx,i.SubtractEquation=101,i.SubtractiveBlending=3,i.TOUCH={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},i.TangentSpaceNormalMap=0,i.TetrahedronBufferGeometry=om,i.TetrahedronGeometry=Zv,i.TextBufferGeometry=cm,i.TextGeometry=n0,i.Texture=d,i.TextureLoader=Sx,i.TorusBufferGeometry=lm,i.TorusGeometry=t0,i.TorusKnotBufferGeometry=um,i.TorusKnotGeometry=$v,i.Triangle=Ct,i.TriangleFanDrawMode=2,i.TriangleStripDrawMode=1,i.TrianglesDrawMode=0,i.TubeBufferGeometry=yp,i.TubeGeometry=Kv,i.UVMapping=300,i.Uint16Attribute=function(e,n){return console.warn("THREE.Uint16Attribute has been removed. Use new THREE.Uint16BufferAttribute() instead."),new nr(e,n)},i.Uint16BufferAttribute=nr,i.Uint32Attribute=function(e,n){return console.warn("THREE.Uint32Attribute has been removed. Use new THREE.Uint32BufferAttribute() instead."),new At(e,n)},i.Uint32BufferAttribute=At,i.Uint8Attribute=function(e,n){return console.warn("THREE.Uint8Attribute has been removed. Use new THREE.Uint8BufferAttribute() instead."),new hr(e,n)},i.Uint8BufferAttribute=hr,i.Uint8ClampedAttribute=function(e,n){return console.warn("THREE.Uint8ClampedAttribute has been removed. Use new THREE.Uint8ClampedBufferAttribute() instead."),new Je(e,n)},i.Uint8ClampedBufferAttribute=Je,i.Uncharted2ToneMapping=3,i.Uniform=Hx,i.UniformsLib=or,i.UniformsUtils=xT,i.UnsignedByteType=1009,i.UnsignedInt248Type=1020,i.UnsignedIntType=1014,i.UnsignedShort4444Type=1017,i.UnsignedShort5551Type=1018,i.UnsignedShort565Type=1019,i.UnsignedShortType=1012,i.VSMShadowMap=3,i.Vector2=f,i.Vector3=w,i.Vector4=p,i.VectorKeyframeTrack=vm,i.Vertex=function(e,n,u){return console.warn("THREE.Vertex has been removed. Use THREE.Vector3 instead."),new w(e,n,u)},i.VertexColors=2,i.VideoTexture=X_,i.WebGLCubeRenderTarget=Cr,i.WebGLMultisampleRenderTarget=S,i.WebGLRenderTarget=A,i.WebGLRenderTargetCube=function(e,n,u){return console.warn("THREE.WebGLRenderTargetCube( width, height, options ) is now WebGLCubeRenderTarget( size, options )."),new Cr(e,u)},i.WebGLRenderer=V_,i.WebGLUtils=b3,i.WireframeGeometry=im,i.WireframeHelper=function(e,n){return console.warn("THREE.WireframeHelper has been removed. Use THREE.WireframeGeometry instead."),new In(new im(e.geometry),new gn({color:n!==void 0?n:16777215}))},i.WrapAroundEnding=2402,i.XHRLoader=function(e){return console.warn("THREE.XHRLoader has been renamed to THREE.FileLoader."),new Ta(e)},i.ZeroCurvatureEnding=2400,i.ZeroFactor=200,i.ZeroSlopeEnding=2401,i.ZeroStencilOp=0,i.sRGBEncoding=3001,Object.defineProperty(i,"__esModule",{value:!0})})}),Pi=ot(w3),M3=function(t){function r(i){return Ai(this,r),i=Tn(this,(r.__proto__||Wn(r)).call(this,i)),i.layerType="ThreeLayer",i}return jn(r,t),Xi(r,[{key:"initialize",value:function(i){this.getOptions();var s=this.webglLayer.map.map;this.webglLayer.map.type==="three"?(this.camera=s.camera,this.scene=s.scene):(this.camera=new Pi.PerspectiveCamera,this.scene=new Pi.Scene),this.world=new Pi.Group,this.scene.add(this.world),this.webglLayer.map.type!=="three"&&(this.camera.matrixAutoUpdate=!1,this.world.matrixAutoUpdate=!1,this.renderer=new Pi.WebGLRenderer({alpha:!0,antialias:!0,canvas:i.canvas,context:i}),this.renderer.autoClear=!1,this.renderer.outputEncoding=Pi.sRGBEncoding)}},{key:"_add",value:function(i,s){var f=[0,0];if(this.getOptions().enabledPointOffset===!0&&(f=this.getPointOffset()),s){var c=new Pi.Group;return c.isGeoGroup=!0,c.object=i,c.point=s,c.add(i),c.position.x=s.lng-f[0],c.position.y=s.lat-f[1],c.position.z=i.position.z,this.world.add(c),c}return this.world.add(i),i}},{key:"add",value:function(i,s){return i=this._add(i,s),this.update(),i}},{key:"update",value:function(){this.webglLayer.render()}},{key:"getCamera",value:function(){return this.camera}},{key:"getScene",value:function(){return this.scene}},{key:"getRenderer",value:function(){return this.renderer}},{key:"getWorld",value:function(){return this.world}},{key:"updatePoint",value:function(i,s){for(var f=this.world.children,c=0;c<f.length;c++)if(f[c].isGeoGroup&&f[c].object===i){var d=f[c];d.position.x=s.lng,d.position.y=s.lat,d.position.z=i.position.z}}},{key:"remove",value:function(i){this.world.remove(i);for(var s=this.world.children,f=0;f<s.length;f++)s[f].children&&0<s[f].children.length&&s[f].children[0]===i&&this.world.remove(s[f]);this.update()}},{key:"updateCamera",value:function(){if(!this.getOptions().notUpdateSize){var i=this.world,s=this.map.getZoomUnits();i=i.children;for(var f=0;f<i.length;f++)i[f].point&&i[f].scale.set(s,s,s)}}},{key:"render",value:function(i){var s=this.getOptions();if(i){if(!this.webglLayer.map.map.camera){this.updateCamera();var f=this.getPointOffset(),c=new Pi.Matrix4().fromArray(i.viewMatrix);this.camera.projectionMatrix=new Pi.Matrix4().fromArray(i.projectionMatrix),this.camera.projectionMatrixInverse.getInverse(this.camera.projectionMatrix),s.enabledPointOffset===!0?this.world.matrix=c:(i=new Pi.Matrix4().makeTranslation(-f[0],-f[1],0),this.world.matrix=c.multiply(i)),this.renderer.state.reset(),this.postProcessing?this.postProcessing.render():this.renderer.render(this.scene,this.camera)}}else this.update()}}]),r}(HE),N_=function(t){function r(i){Ai(this,r);var s=Tn(this,(r.__proto__||Wn(r)).call(this,i));return s.layerType="threeLayer",s.setOptions(i),s}return jn(r,t),Xi(r,[{key:"getCommonDefaultOptions",value:function(){return{zIndex:0,zoomThreshold:[0,30]}}},{key:"setWebglLayer",value:function(i){i.threeLayer||(i.threeLayer=new M3({enabledPointOffset:!0,webglLayer:i})),this.threeLayer=i.threeLayer}},{key:"getPointOffset",value:function(){return this.threeLayer.getPointOffset()}},{key:"getThreeLayer",value:function(){return this.threeLayer}}]),r}(_3),Kd={uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:`varying vec2 vUv;
void main() {
	vUv = uv;
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,fragmentShader:`uniform float opacity;
uniform sampler2D tDiffuse;
varying vec2 vUv;
void main() {
	vec4 texel = texture2D( tDiffuse, vUv );
	gl_FragColor = opacity * texel;
}`};pt(Mn.prototype,{setSize:function(){},render:function(){console.error("THREE.Pass: .render() must be implemented in derived pass.")}}),Mn.FullScreenQuad=function(){var t=new ja(-1,1,1,-1,0,1),r=new Oa(2,2),i=function(s){this._mesh=new Zi(r,s)};return Object.defineProperty(i.prototype,"material",{get:function(){return this._mesh.material},set:function(s){this._mesh.material=s}}),pt(i.prototype,{dispose:function(){this._mesh.geometry.dispose()},render:function(s){s.render(this._mesh,t)}}),i}();var tx=function(t,r){Mn.call(this),this.textureID=r!==void 0?r:"tDiffuse",t instanceof Ki?(this.uniforms=t.uniforms,this.material=t):t&&(this.uniforms=ap.clone(t.uniforms),this.material=new Ki({defines:pt({},t.defines),uniforms:this.uniforms,vertexShader:t.vertexShader,fragmentShader:t.fragmentShader})),this.fsQuad=new Mn.FullScreenQuad(this.material)};tx.prototype=pt(ft(Mn.prototype),{constructor:tx,render:function(t,r,i){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=i.texture),this.fsQuad.material=this.material,this.renderToScreen?t.setRenderTarget(null):(t.setRenderTarget(r),this.clear&&t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil)),this.fsQuad.render(t)}});var ex=function(t,r){Mn.call(this),this.scene=t,this.camera=r,this.clear=!0,this.inverse=this.needsSwap=!1};ex.prototype=pt(ft(Mn.prototype),{constructor:ex,render:function(t,r,i){var s=t.getContext(),f=t.state;if(f.buffers.color.setMask(!1),f.buffers.depth.setMask(!1),f.buffers.color.setLocked(!0),f.buffers.depth.setLocked(!0),this.inverse)var c=0,d=1;else c=1,d=0;f.buffers.stencil.setTest(!0),f.buffers.stencil.setOp(s.REPLACE,s.REPLACE,s.REPLACE),f.buffers.stencil.setFunc(s.ALWAYS,c,4294967295),f.buffers.stencil.setClear(d),f.buffers.stencil.setLocked(!0),t.setRenderTarget(i),this.clear&&t.clear(),t.render(this.scene,this.camera),t.setRenderTarget(r),this.clear&&t.clear(),t.render(this.scene,this.camera),f.buffers.color.setLocked(!1),f.buffers.depth.setLocked(!1),f.buffers.stencil.setLocked(!1),f.buffers.stencil.setFunc(s.EQUAL,1,4294967295),f.buffers.stencil.setOp(s.KEEP,s.KEEP,s.KEEP),f.buffers.stencil.setLocked(!0)}});var U_=function(){Mn.call(this),this.needsSwap=!1};U_.prototype=ft(Mn.prototype),pt(U_.prototype,{render:function(t){t.state.buffers.stencil.setLocked(!1),t.state.buffers.stencil.setTest(!1)}});var C3=function(t,r){this.renderer=t,r===void 0?(r=t.getSize(new Ot),this._pixelRatio=t.getPixelRatio(),this._width=r.width,this._height=r.height,r=new pe(this._width*this._pixelRatio,this._height*this._pixelRatio,{minFilter:1006,magFilter:1006,format:1023,stencilBuffer:!1}),r.texture.name="EffectComposer.rt1"):(this._pixelRatio=1,this._width=r.width,this._height=r.height),this.renderTarget1=r,this.renderTarget2=r.clone(),this.renderTarget2.texture.name="EffectComposer.rt2",this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.renderToScreen=!0,this.passes=[],Kd===void 0&&console.error("THREE.EffectComposer relies on CopyShader"),tx===void 0&&console.error("THREE.EffectComposer relies on ShaderPass"),this.copyPass=new tx(Kd),this.clock=new gd};pt(C3.prototype,{swapBuffers:function(){var t=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=t},addPass:function(t){this.passes.push(t),t.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)},insertPass:function(t,r){this.passes.splice(r,0,t),t.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)},isLastEnabledPass:function(t){for(t+=1;t<this.passes.length;t++)if(this.passes[t].enabled)return!1;return!0},render:function(t){t===void 0&&(t=this.clock.getDelta());var r=this.renderer.getRenderTarget(),i=!1,s,f=this.passes.length;for(s=0;s<f;s++){var c=this.passes[s];if(c.enabled!==!1){if(c.renderToScreen=this.renderToScreen&&this.isLastEnabledPass(s),c.render(this.renderer,this.writeBuffer,this.readBuffer,t,i),c.needsSwap){if(i){var d=this.renderer.getContext(),p=this.renderer.state.buffers.stencil;p.setFunc(d.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,t),p.setFunc(d.EQUAL,1,4294967295)}this.swapBuffers()}ex!==void 0&&(c instanceof ex?i=!0:c instanceof U_&&(i=!1))}}this.renderer.setRenderTarget(r)},reset:function(t){t===void 0&&(t=this.renderer.getSize(new Ot),this._pixelRatio=this.renderer.getPixelRatio(),this._width=t.width,this._height=t.height,t=this.renderTarget1.clone(),t.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)),this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.renderTarget1=t,this.renderTarget2=t.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2},setSize:function(t,r){this._width=t,this._height=r,t=this._width*this._pixelRatio,r=this._height*this._pixelRatio,this.renderTarget1.setSize(t,r),this.renderTarget2.setSize(t,r);for(var i=0;i<this.passes.length;i++)this.passes[i].setSize(t,r)},setPixelRatio:function(t){this._pixelRatio=t,this.setSize(this._width,this._height)}});var T3=function(){this.needsSwap=this.enabled=!0,this.renderToScreen=this.clear=!1};pt(T3.prototype,{setSize:function(){},render:function(){console.error("THREE.Pass: .render() must be implemented in derived pass.")}}),T3.FullScreenQuad=function(){var t=new ja(-1,1,1,-1,0,1),r=new Oa(2,2),i=function(s){this._mesh=new Zi(r,s)};return Object.defineProperty(i.prototype,"material",{get:function(){return this._mesh.material},set:function(s){this._mesh.material=s}}),pt(i.prototype,{dispose:function(){this._mesh.geometry.dispose()},render:function(s){s.render(this._mesh,t)}}),i}();var Nv=function(t,r,i,s,f){Mn.call(this),this.scene=t,this.camera=r,this.overrideMaterial=i,this.clearColor=s,this.clearAlpha=f!==void 0?f:0,this.clear=!0,this.needsSwap=this.clearDepth=!1};Nv.prototype=pt(ft(Mn.prototype),{constructor:Nv,render:function(t,r,i){if(r=t.autoClear,t.autoClear=!1,this.overrideMaterial!==void 0){var s=this.scene.overrideMaterial;this.scene.overrideMaterial=this.overrideMaterial}if(this.clearColor){var f=t.getClearColor().getHex(),c=t.getClearAlpha();t.setClearColor(this.clearColor,this.clearAlpha)}this.clearDepth&&t.clearDepth(),t.setRenderTarget(this.renderToScreen?null:i),this.clear&&t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil),t.render(this.scene,this.camera),this.clearColor&&t.setClearColor(f,c),this.overrideMaterial!==void 0&&(this.scene.overrideMaterial=s),t.autoClear=r}});var Uv={defines:{SMAA_THRESHOLD:"0.1"},uniforms:{tDiffuse:{value:null},resolution:{value:new Ot(1/1024,1/512)}},vertexShader:`uniform vec2 resolution;
varying vec2 vUv;
varying vec4 vOffset[ 3 ];
void SMAAEdgeDetectionVS( vec2 texcoord ) {
	vOffset[ 0 ] = texcoord.xyxy + resolution.xyxy * vec4( -1.0, 0.0, 0.0,  1.0 );
	vOffset[ 1 ] = texcoord.xyxy + resolution.xyxy * vec4(  1.0, 0.0, 0.0, -1.0 );
	vOffset[ 2 ] = texcoord.xyxy + resolution.xyxy * vec4( -2.0, 0.0, 0.0,  2.0 );
}
void main() {
	vUv = uv;
	SMAAEdgeDetectionVS( vUv );
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,fragmentShader:`uniform sampler2D tDiffuse;
varying vec2 vUv;
varying vec4 vOffset[ 3 ];
vec4 SMAAColorEdgeDetectionPS( vec2 texcoord, vec4 offset[3], sampler2D colorTex ) {
	vec2 threshold = vec2( SMAA_THRESHOLD, SMAA_THRESHOLD );
	vec4 delta;
	vec3 C = texture2D( colorTex, texcoord ).rgb;
	vec3 Cleft = texture2D( colorTex, offset[0].xy ).rgb;
	vec3 t = abs( C - Cleft );
	delta.x = max( max( t.r, t.g ), t.b );
	vec3 Ctop = texture2D( colorTex, offset[0].zw ).rgb;
	t = abs( C - Ctop );
	delta.y = max( max( t.r, t.g ), t.b );
	vec2 edges = step( threshold, delta.xy );
	if ( dot( edges, vec2( 1.0, 1.0 ) ) == 0.0 )
		discard;
	vec3 Cright = texture2D( colorTex, offset[1].xy ).rgb;
	t = abs( C - Cright );
	delta.z = max( max( t.r, t.g ), t.b );
	vec3 Cbottom  = texture2D( colorTex, offset[1].zw ).rgb;
	t = abs( C - Cbottom );
	delta.w = max( max( t.r, t.g ), t.b );
	float maxDelta = max( max( max( delta.x, delta.y ), delta.z ), delta.w );
	vec3 Cleftleft  = texture2D( colorTex, offset[2].xy ).rgb;
	t = abs( C - Cleftleft );
	delta.z = max( max( t.r, t.g ), t.b );
	vec3 Ctoptop = texture2D( colorTex, offset[2].zw ).rgb;
	t = abs( C - Ctoptop );
	delta.w = max( max( t.r, t.g ), t.b );
	maxDelta = max( max( maxDelta, delta.z ), delta.w );
	edges.xy *= step( 0.5 * maxDelta, delta.xy );
	return vec4( edges, 0.0, 0.0 );
}
void main() {
	gl_FragColor = SMAAColorEdgeDetectionPS( vUv, vOffset, tDiffuse );
}`},GE={SMAA_MAX_SEARCH_STEPS:"8",SMAA_AREATEX_MAX_DISTANCE:"16",SMAA_AREATEX_PIXEL_SIZE:"( 1.0 / vec2( 160.0, 560.0 ) )",SMAA_AREATEX_SUBTEX_SIZE:"( 1.0 / 7.0 )"},VE={tDiffuse:{value:null},tArea:{value:null},tSearch:{value:null},resolution:{value:new Ot(1/1024,1/512)}},WE={tDiffuse:{value:null},tColor:{value:null},resolution:{value:new Ot(1/1024,1/512)}},b_=function(t,r){Mn.call(this),this.edgesRT=new pe(t,r,{depthBuffer:!1,stencilBuffer:!1,generateMipmaps:!1,minFilter:1006,format:1022}),this.edgesRT.texture.name="SMAAPass.edges",this.weightsRT=new pe(t,r,{depthBuffer:!1,stencilBuffer:!1,generateMipmaps:!1,minFilter:1006,format:1023}),this.weightsRT.texture.name="SMAAPass.weights";var i=this,s=new Image;s.src=this.getAreaTexture(),s.onload=function(){i.areaTexture.needsUpdate=!0},this.areaTexture=new le,this.areaTexture.name="SMAAPass.area",this.areaTexture.image=s,this.areaTexture.format=1022,this.areaTexture.minFilter=1006,this.areaTexture.generateMipmaps=!1,this.areaTexture.flipY=!1,s=new Image,s.src=this.getSearchTexture(),s.onload=function(){i.searchTexture.needsUpdate=!0},this.searchTexture=new le,this.searchTexture.name="SMAAPass.search",this.searchTexture.image=s,this.searchTexture.magFilter=1003,this.searchTexture.minFilter=1003,this.searchTexture.generateMipmaps=!1,this.searchTexture.flipY=!1,Uv===void 0&&console.error("SMAAPass relies on SMAAShader"),this.uniformsEdges=ap.clone(Uv.uniforms),this.uniformsEdges.resolution.value.set(1/t,1/r),this.materialEdges=new Ki({defines:pt({},Uv.defines),uniforms:this.uniformsEdges,vertexShader:Uv.vertexShader,fragmentShader:Uv.fragmentShader}),this.uniformsWeights=ap.clone(VE),this.uniformsWeights.resolution.value.set(1/t,1/r),this.uniformsWeights.tDiffuse.value=this.edgesRT.texture,this.uniformsWeights.tArea.value=this.areaTexture,this.uniformsWeights.tSearch.value=this.searchTexture,this.materialWeights=new Ki({defines:pt({},GE),uniforms:this.uniformsWeights,vertexShader:`uniform vec2 resolution;
varying vec2 vUv;
varying vec4 vOffset[ 3 ];
varying vec2 vPixcoord;
void SMAABlendingWeightCalculationVS( vec2 texcoord ) {
	vPixcoord = texcoord / resolution;
	vOffset[ 0 ] = texcoord.xyxy + resolution.xyxy * vec4( -0.25, 0.125, 1.25, 0.125 );
	vOffset[ 1 ] = texcoord.xyxy + resolution.xyxy * vec4( -0.125, 0.25, -0.125, -1.25 );
	vOffset[ 2 ] = vec4( vOffset[ 0 ].xz, vOffset[ 1 ].yw ) + vec4( -2.0, 2.0, -2.0, 2.0 ) * resolution.xxyy * float( SMAA_MAX_SEARCH_STEPS );
}
void main() {
	vUv = uv;
	SMAABlendingWeightCalculationVS( vUv );
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,fragmentShader:`#define SMAASampleLevelZeroOffset( tex, coord, offset ) texture2D( tex, coord + float( offset ) * resolution, 0.0 )
uniform sampler2D tDiffuse;
uniform sampler2D tArea;
uniform sampler2D tSearch;
uniform vec2 resolution;
varying vec2 vUv;
varying vec4 vOffset[3];
varying vec2 vPixcoord;
#if __VERSION__ == 100
vec2 round( vec2 x ) {
	return sign( x ) * floor( abs( x ) + 0.5 );
}
#endif
float SMAASearchLength( sampler2D searchTex, vec2 e, float bias, float scale ) {
	e.r = bias + e.r * scale;
	return 255.0 * texture2D( searchTex, e, 0.0 ).r;
}
float SMAASearchXLeft( sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end ) {
	vec2 e = vec2( 0.0, 1.0 );
	for ( int i = 0; i < SMAA_MAX_SEARCH_STEPS; i ++ ) {
		e = texture2D( edgesTex, texcoord, 0.0 ).rg;
		texcoord -= vec2( 2.0, 0.0 ) * resolution;
		if ( ! ( texcoord.x > end && e.g > 0.8281 && e.r == 0.0 ) ) break;
	}
	texcoord.x += 0.25 * resolution.x;
	texcoord.x += resolution.x;
	texcoord.x += 2.0 * resolution.x;
	texcoord.x -= resolution.x * SMAASearchLength(searchTex, e, 0.0, 0.5);
	return texcoord.x;
}
float SMAASearchXRight( sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end ) {
	vec2 e = vec2( 0.0, 1.0 );
	for ( int i = 0; i < SMAA_MAX_SEARCH_STEPS; i ++ ) {
		e = texture2D( edgesTex, texcoord, 0.0 ).rg;
		texcoord += vec2( 2.0, 0.0 ) * resolution;
		if ( ! ( texcoord.x < end && e.g > 0.8281 && e.r == 0.0 ) ) break;
	}
	texcoord.x -= 0.25 * resolution.x;
	texcoord.x -= resolution.x;
	texcoord.x -= 2.0 * resolution.x;
	texcoord.x += resolution.x * SMAASearchLength( searchTex, e, 0.5, 0.5 );
	return texcoord.x;
}
float SMAASearchYUp( sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end ) {
	vec2 e = vec2( 1.0, 0.0 );
	for ( int i = 0; i < SMAA_MAX_SEARCH_STEPS; i ++ ) {
		e = texture2D( edgesTex, texcoord, 0.0 ).rg;
		texcoord += vec2( 0.0, 2.0 ) * resolution;
		if ( ! ( texcoord.y > end && e.r > 0.8281 && e.g == 0.0 ) ) break;
	}
	texcoord.y -= 0.25 * resolution.y;
	texcoord.y -= resolution.y;
	texcoord.y -= 2.0 * resolution.y;
	texcoord.y += resolution.y * SMAASearchLength( searchTex, e.gr, 0.0, 0.5 );
	return texcoord.y;
}
float SMAASearchYDown( sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end ) {
	vec2 e = vec2( 1.0, 0.0 );
	for ( int i = 0; i < SMAA_MAX_SEARCH_STEPS; i ++ ) {
		e = texture2D( edgesTex, texcoord, 0.0 ).rg;
		texcoord -= vec2( 0.0, 2.0 ) * resolution;
		if ( ! ( texcoord.y < end && e.r > 0.8281 && e.g == 0.0 ) ) break;
	}
	texcoord.y += 0.25 * resolution.y;
	texcoord.y += resolution.y;
	texcoord.y += 2.0 * resolution.y;
	texcoord.y -= resolution.y * SMAASearchLength( searchTex, e.gr, 0.5, 0.5 );
	return texcoord.y;
}
vec2 SMAAArea( sampler2D areaTex, vec2 dist, float e1, float e2, float offset ) {
	vec2 texcoord = float( SMAA_AREATEX_MAX_DISTANCE ) * round( 4.0 * vec2( e1, e2 ) ) + dist;
	texcoord = SMAA_AREATEX_PIXEL_SIZE * texcoord + ( 0.5 * SMAA_AREATEX_PIXEL_SIZE );
	texcoord.y += SMAA_AREATEX_SUBTEX_SIZE * offset;
	return texture2D( areaTex, texcoord, 0.0 ).rg;
}
vec4 SMAABlendingWeightCalculationPS( vec2 texcoord, vec2 pixcoord, vec4 offset[ 3 ], sampler2D edgesTex, sampler2D areaTex, sampler2D searchTex, ivec4 subsampleIndices ) {
	vec4 weights = vec4( 0.0, 0.0, 0.0, 0.0 );
	vec2 e = texture2D( edgesTex, texcoord ).rg;
	if ( e.g > 0.0 ) {
		vec2 d;
		vec2 coords;
		coords.x = SMAASearchXLeft( edgesTex, searchTex, offset[ 0 ].xy, offset[ 2 ].x );
		coords.y = offset[ 1 ].y;
		d.x = coords.x;
		float e1 = texture2D( edgesTex, coords, 0.0 ).r;
		coords.x = SMAASearchXRight( edgesTex, searchTex, offset[ 0 ].zw, offset[ 2 ].y );
		d.y = coords.x;
		d = d / resolution.x - pixcoord.x;
		vec2 sqrt_d = sqrt( abs( d ) );
		coords.y -= 1.0 * resolution.y;
		float e2 = SMAASampleLevelZeroOffset( edgesTex, coords, ivec2( 1, 0 ) ).r;
		weights.rg = SMAAArea( areaTex, sqrt_d, e1, e2, float( subsampleIndices.y ) );
	}
	if ( e.r > 0.0 ) {
		vec2 d;
		vec2 coords;
		coords.y = SMAASearchYUp( edgesTex, searchTex, offset[ 1 ].xy, offset[ 2 ].z );
		coords.x = offset[ 0 ].x;
		d.x = coords.y;
		float e1 = texture2D( edgesTex, coords, 0.0 ).g;
		coords.y = SMAASearchYDown( edgesTex, searchTex, offset[ 1 ].zw, offset[ 2 ].w );
		d.y = coords.y;
		d = d / resolution.y - pixcoord.y;
		vec2 sqrt_d = sqrt( abs( d ) );
		coords.y -= 1.0 * resolution.y;
		float e2 = SMAASampleLevelZeroOffset( edgesTex, coords, ivec2( 0, 1 ) ).g;
		weights.ba = SMAAArea( areaTex, sqrt_d, e1, e2, float( subsampleIndices.x ) );
	}
	return weights;
}
void main() {
	gl_FragColor = SMAABlendingWeightCalculationPS( vUv, vPixcoord, vOffset, tDiffuse, tArea, tSearch, ivec4( 0.0 ) );
}`}),this.uniformsBlend=ap.clone(WE),this.uniformsBlend.resolution.value.set(1/t,1/r),this.uniformsBlend.tDiffuse.value=this.weightsRT.texture,this.materialBlend=new Ki({uniforms:this.uniformsBlend,vertexShader:`uniform vec2 resolution;
varying vec2 vUv;
varying vec4 vOffset[ 2 ];
void SMAANeighborhoodBlendingVS( vec2 texcoord ) {
	vOffset[ 0 ] = texcoord.xyxy + resolution.xyxy * vec4( -1.0, 0.0, 0.0, 1.0 );
	vOffset[ 1 ] = texcoord.xyxy + resolution.xyxy * vec4( 1.0, 0.0, 0.0, -1.0 );
}
void main() {
	vUv = uv;
	SMAANeighborhoodBlendingVS( vUv );
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,fragmentShader:`uniform sampler2D tDiffuse;
uniform sampler2D tColor;
uniform vec2 resolution;
varying vec2 vUv;
varying vec4 vOffset[ 2 ];
vec4 SMAANeighborhoodBlendingPS( vec2 texcoord, vec4 offset[ 2 ], sampler2D colorTex, sampler2D blendTex ) {
	vec4 a;
	a.xz = texture2D( blendTex, texcoord ).xz;
	a.y = texture2D( blendTex, offset[ 1 ].zw ).g;
	a.w = texture2D( blendTex, offset[ 1 ].xy ).a;
	if ( dot(a, vec4( 1.0, 1.0, 1.0, 1.0 )) < 1e-5 ) {
		return texture2D( colorTex, texcoord, 0.0 );
	} else {
		vec2 offset;
		offset.x = a.a > a.b ? a.a : -a.b;
		offset.y = a.g > a.r ? -a.g : a.r;
		if ( abs( offset.x ) > abs( offset.y )) {
			offset.y = 0.0;
		} else {
			offset.x = 0.0;
		}
		vec4 C = texture2D( colorTex, texcoord, 0.0 );
		texcoord += sign( offset ) * resolution;
		vec4 Cop = texture2D( colorTex, texcoord, 0.0 );
		float s = abs( offset.x ) > abs( offset.y ) ? abs( offset.x ) : abs( offset.y );
		C.xyz = pow(C.xyz, vec3(2.2));
		Cop.xyz = pow(Cop.xyz, vec3(2.2));
		vec4 mixed = mix(C, Cop, s);
		mixed.xyz = pow(mixed.xyz, vec3(1.0 / 2.2));
		return mixed;
	}
}
void main() {
	gl_FragColor = SMAANeighborhoodBlendingPS( vUv, vOffset, tColor, tDiffuse );
}`}),this.needsSwap=!1,this.fsQuad=new Mn.FullScreenQuad(null)};b_.prototype=pt(ft(Mn.prototype),{constructor:b_,render:function(t,r,i){this.uniformsEdges.tDiffuse.value=i.texture,this.fsQuad.material=this.materialEdges,t.setRenderTarget(this.edgesRT),this.clear&&t.clear(),this.fsQuad.render(t),this.fsQuad.material=this.materialWeights,t.setRenderTarget(this.weightsRT),this.clear&&t.clear(),this.fsQuad.render(t),this.uniformsBlend.tColor.value=i.texture,this.fsQuad.material=this.materialBlend,this.renderToScreen?t.setRenderTarget(null):(t.setRenderTarget(r),this.clear&&t.clear()),this.fsQuad.render(t)},setSize:function(t,r){this.edgesRT.setSize(t,r),this.weightsRT.setSize(t,r),this.materialEdges.uniforms.resolution.value.set(1/t,1/r),this.materialWeights.uniforms.resolution.value.set(1/t,1/r),this.materialBlend.uniforms.resolution.value.set(1/t,1/r)},getAreaTexture:function(){return"data:image/png;base64,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"},getSearchTexture:function(){return"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEIAAAAhCAAAAABIXyLAAAAAOElEQVRIx2NgGAWjYBSMglEwEICREYRgFBZBqDCSLA2MGPUIVQETE9iNUAqLR5gIeoQKRgwXjwAAGn4AtaFeYLEAAAAASUVORK5CYII="}});var rx={shaderID:"luminosityHighPass",uniforms:{tDiffuse:{value:null},luminosityThreshold:{value:1},smoothWidth:{value:1},defaultColor:{value:new Oe(0)},defaultOpacity:{value:0}},vertexShader:`varying vec2 vUv;
void main() {
	vUv = uv;
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,fragmentShader:`uniform sampler2D tDiffuse;
uniform vec3 defaultColor;
uniform float defaultOpacity;
uniform float luminosityThreshold;
uniform float smoothWidth;
varying vec2 vUv;
void main() {
	vec4 texel = texture2D( tDiffuse, vUv );
	vec3 luma = vec3( 0.299, 0.587, 0.114 );
	float v = dot( texel.xyz, luma );
	vec4 outputColor = vec4( defaultColor.rgb, defaultOpacity );
	float alpha = smoothstep( luminosityThreshold, luminosityThreshold + smoothWidth, v );
	gl_FragColor = mix( outputColor, texel, alpha );
}`},_c=function(t,r,i,s){Mn.call(this),this.strength=r!==void 0?r:1,this.radius=i,this.threshold=s,this.resolution=t!==void 0?new Ot(t.x,t.y):new Ot(256,256),this.clearColor=new Oe(0,0,0);var f={minFilter:1006,magFilter:1006,format:1023};this.renderTargetsHorizontal=[],this.renderTargetsVertical=[],this.nMips=5,t=Math.round(this.resolution.x/2),i=Math.round(this.resolution.y/2),this.renderTargetBright=new pe(t,i,f),this.renderTargetBright.texture.name="UnrealBloomPass.bright",this.renderTargetBright.texture.generateMipmaps=!1;for(var c=0;c<this.nMips;c++){var d=new pe(t,i,f);d.texture.name="UnrealBloomPass.h"+c,d.texture.generateMipmaps=!1,this.renderTargetsHorizontal.push(d),d=new pe(t,i,f),d.texture.name="UnrealBloomPass.v"+c,d.texture.generateMipmaps=!1,this.renderTargetsVertical.push(d),t=Math.round(t/2),i=Math.round(i/2)}for(rx===void 0&&console.error("UnrealBloomPass relies on LuminosityHighPassShader"),this.highPassUniforms=ap.clone(rx.uniforms),this.highPassUniforms.luminosityThreshold.value=s,this.highPassUniforms.smoothWidth.value=.01,this.materialHighPassFilter=new Ki({uniforms:this.highPassUniforms,vertexShader:rx.vertexShader,fragmentShader:rx.fragmentShader,defines:{}}),this.separableBlurMaterials=[],s=[3,5,7,9,11],t=Math.round(this.resolution.x/2),i=Math.round(this.resolution.y/2),c=0;c<this.nMips;c++)this.separableBlurMaterials.push(this.getSeperableBlurMaterial(s[c])),this.separableBlurMaterials[c].uniforms.texSize.value=new Ot(t,i),t=Math.round(t/2),i=Math.round(i/2);this.compositeMaterial=this.getCompositeMaterial(this.nMips),this.compositeMaterial.uniforms.blurTexture1.value=this.renderTargetsVertical[0].texture,this.compositeMaterial.uniforms.blurTexture2.value=this.renderTargetsVertical[1].texture,this.compositeMaterial.uniforms.blurTexture3.value=this.renderTargetsVertical[2].texture,this.compositeMaterial.uniforms.blurTexture4.value=this.renderTargetsVertical[3].texture,this.compositeMaterial.uniforms.blurTexture5.value=this.renderTargetsVertical[4].texture,this.compositeMaterial.uniforms.bloomStrength.value=r,this.compositeMaterial.uniforms.bloomRadius.value=.1,this.compositeMaterial.needsUpdate=!0,this.compositeMaterial.uniforms.bloomFactors.value=[1,.8,.6,.4,.2],this.bloomTintColors=[new dt(1,1,1),new dt(1,1,1),new dt(1,1,1),new dt(1,1,1),new dt(1,1,1)],this.compositeMaterial.uniforms.bloomTintColors.value=this.bloomTintColors,Kd===void 0&&console.error("UnrealBloomPass relies on CopyShader"),this.copyUniforms=ap.clone(Kd.uniforms),this.copyUniforms.opacity.value=1,this.materialCopy=new Ki({uniforms:this.copyUniforms,vertexShader:Kd.vertexShader,fragmentShader:Kd.fragmentShader,blending:2,depthTest:!1,depthWrite:!1,transparent:!0}),this.enabled=!0,this.needsSwap=!1,this.oldClearColor=new Oe,this.oldClearAlpha=1,this.basic=new Nn,this.fsQuad=new Mn.FullScreenQuad(null)};_c.prototype=pt(ft(Mn.prototype),{constructor:_c,dispose:function(){for(var t=0;t<this.renderTargetsHorizontal.length;t++)this.renderTargetsHorizontal[t].dispose();for(t=0;t<this.renderTargetsVertical.length;t++)this.renderTargetsVertical[t].dispose();this.renderTargetBright.dispose()},setSize:function(t,r){t=Math.round(t/2),r=Math.round(r/2),this.renderTargetBright.setSize(t,r);for(var i=0;i<this.nMips;i++)this.renderTargetsHorizontal[i].setSize(t,r),this.renderTargetsVertical[i].setSize(t,r),this.separableBlurMaterials[i].uniforms.texSize.value=new Ot(t,r),t=Math.round(t/2),r=Math.round(r/2)},render:function(t,r,i,s,f){this.oldClearColor.copy(t.getClearColor()),this.oldClearAlpha=t.getClearAlpha(),r=t.autoClear,t.autoClear=!1,t.setClearColor(this.clearColor,0),f&&t.state.buffers.stencil.setTest(!1),this.renderToScreen&&(this.fsQuad.material=this.basic,this.basic.map=i.texture,t.setRenderTarget(null),t.clear(),this.fsQuad.render(t)),this.highPassUniforms.tDiffuse.value=i.texture,this.highPassUniforms.luminosityThreshold.value=this.threshold,this.fsQuad.material=this.materialHighPassFilter,t.setRenderTarget(this.renderTargetBright),t.clear(),this.fsQuad.render(t),s=this.renderTargetBright;for(var c=0;c<this.nMips;c++)this.fsQuad.material=this.separableBlurMaterials[c],this.separableBlurMaterials[c].uniforms.colorTexture.value=s.texture,this.separableBlurMaterials[c].uniforms.direction.value=_c.BlurDirectionX,t.setRenderTarget(this.renderTargetsHorizontal[c]),t.clear(),this.fsQuad.render(t),this.separableBlurMaterials[c].uniforms.colorTexture.value=this.renderTargetsHorizontal[c].texture,this.separableBlurMaterials[c].uniforms.direction.value=_c.BlurDirectionY,t.setRenderTarget(this.renderTargetsVertical[c]),t.clear(),this.fsQuad.render(t),s=this.renderTargetsVertical[c];this.fsQuad.material=this.compositeMaterial,this.compositeMaterial.uniforms.bloomStrength.value=this.strength,this.compositeMaterial.uniforms.bloomRadius.value=this.radius,this.compositeMaterial.uniforms.bloomTintColors.value=this.bloomTintColors,t.setRenderTarget(this.renderTargetsHorizontal[0]),t.clear(),this.fsQuad.render(t),this.fsQuad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=this.renderTargetsHorizontal[0].texture,f&&t.state.buffers.stencil.setTest(!0),this.renderToScreen?t.setRenderTarget(null):t.setRenderTarget(i),this.fsQuad.render(t),t.setClearColor(this.oldClearColor,this.oldClearAlpha),t.autoClear=r},getSeperableBlurMaterial:function(t){return new Ki({defines:{KERNEL_RADIUS:t,SIGMA:t},uniforms:{colorTexture:{value:null},texSize:{value:new Ot(.5,.5)},direction:{value:new Ot(.5,.5)}},vertexShader:`varying vec2 vUv;
				void main() {
					vUv = uv;
					gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
				}`,fragmentShader:`#include <common>				varying vec2 vUv;
				uniform sampler2D colorTexture;
				uniform vec2 texSize;				uniform vec2 direction;								float gaussianPdf(in float x, in float sigma) {					return 0.39894 * exp( -0.5 * x * x/( sigma * sigma))/sigma;				}				void main() {
					vec2 invSize = 1.0 / texSize;					float fSigma = float(SIGMA);					float weightSum = gaussianPdf(0.0, fSigma);					vec3 diffuseSum = texture2D( colorTexture, vUv).rgb * weightSum;					for( int i = 1; i < KERNEL_RADIUS; i ++ ) {						float x = float(i);						float w = gaussianPdf(x, fSigma);						vec2 uvOffset = direction * invSize * x;						vec3 sample1 = texture2D( colorTexture, vUv + uvOffset).rgb;						vec3 sample2 = texture2D( colorTexture, vUv - uvOffset).rgb;						diffuseSum += (sample1 + sample2) * w;						weightSum += 2.0 * w;					}					gl_FragColor = vec4(diffuseSum/weightSum, 1.0);
				}`})},getCompositeMaterial:function(t){return new Ki({defines:{NUM_MIPS:t},uniforms:{blurTexture1:{value:null},blurTexture2:{value:null},blurTexture3:{value:null},blurTexture4:{value:null},blurTexture5:{value:null},dirtTexture:{value:null},bloomStrength:{value:1},bloomFactors:{value:null},bloomTintColors:{value:null},bloomRadius:{value:0}},vertexShader:`varying vec2 vUv;
				void main() {
					vUv = uv;
					gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
				}`,fragmentShader:"varying vec2 vUv;				uniform sampler2D blurTexture1;				uniform sampler2D blurTexture2;				uniform sampler2D blurTexture3;				uniform sampler2D blurTexture4;				uniform sampler2D blurTexture5;				uniform sampler2D dirtTexture;				uniform float bloomStrength;				uniform float bloomRadius;				uniform float bloomFactors[NUM_MIPS];				uniform vec3 bloomTintColors[NUM_MIPS];								float lerpBloomFactor(const in float factor) { 					float mirrorFactor = 1.2 - factor;					return mix(factor, mirrorFactor, bloomRadius);				}								void main() {					gl_FragColor = bloomStrength * ( lerpBloomFactor(bloomFactors[0]) * vec4(bloomTintColors[0], 1.0) * texture2D(blurTexture1, vUv) + 													 lerpBloomFactor(bloomFactors[1]) * vec4(bloomTintColors[1], 1.0) * texture2D(blurTexture2, vUv) + 													 lerpBloomFactor(bloomFactors[2]) * vec4(bloomTintColors[2], 1.0) * texture2D(blurTexture3, vUv) + 													 lerpBloomFactor(bloomFactors[3]) * vec4(bloomTintColors[3], 1.0) * texture2D(blurTexture4, vUv) + 													 lerpBloomFactor(bloomFactors[4]) * vec4(bloomTintColors[4], 1.0) * texture2D(blurTexture5, vUv) );				}"})}}),_c.BlurDirectionX=new Ot(1,0),_c.BlurDirectionY=new Ot(0,1);var jE=function(t){function r(i){return Ai(this,r),Tn(this,(r.__proto__||Wn(r)).call(this,i))}return jn(r,t),Xi(r,[{key:"initialize",value:function(i){var s=i.camera,f=i.renderer;if(!this._initialize){if(this.scene=i.scene,this.camera=s,this.renderer=f,i=this.options.passes,this._initialize=!0,this.renderScene=new Nv(this.scene,this.camera),s=new C3(this.renderer),s.addPass(this.renderScene),this.passes=[],i)for(var c=0;c<i.length;c++){var d=i[c],p=void 0;switch(d.name){case"unrealBloom":p=d.strength||1;var A=d.radius||0,S=d.threshold||.5;p=new _c(new xc.Vector2(window.innerWidth*f.getPixelRatio(),window.innerHeight*f.getPixelRatio()),p,A,S);break;case"SMAA":p=new b_(window.innerWidth*f.getPixelRatio(),window.innerHeight*f.getPixelRatio())}if(p){for(var z in d)p[z]=d[z];s.addPass(p)}}this.composer=s}}},{key:"addRender",value:function(i){this.renderScene&&this.renderScene.addRender(i)}},{key:"render",value:function(){this.composer.render(this.scene,this.camera)}}]),r}(N_);_c.prototype.getSeperableBlurMaterial=function(t){return new xc.ShaderMaterial({defines:{KERNEL_RADIUS:t,SIGMA:t},uniforms:{colorTexture:{value:null},texSize:{value:new xc.Vector2(.5,.5)},direction:{value:new xc.Vector2(.5,.5)}},vertexShader:`varying vec2 vUv;
            void main() {
                vUv = uv;
                gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
            }`,fragmentShader:`#include <common>            varying vec2 vUv;
            uniform sampler2D colorTexture;
            uniform vec2 texSize;            uniform vec2 direction;                        float gaussianPdf(in float x, in float sigma) {                return 0.39894 * exp( -0.5 * x * x/( sigma * sigma))/sigma;            }            void main() {
                vec2 invSize = 1.0 / texSize;                float fSigma = float(SIGMA);                float weightSum = gaussianPdf(0.0, fSigma);                vec4 diffuseSum = texture2D( colorTexture, vUv).rgba * weightSum;                for( int i = 1; i < KERNEL_RADIUS; i ++ ) {                    float x = float(i);                    float w = gaussianPdf(x, fSigma);                    vec2 uvOffset = direction * invSize * x;                    vec4 sample1 = texture2D( colorTexture, vUv + uvOffset).rgba;                    vec4 sample2 = texture2D( colorTexture, vUv - uvOffset).rgba;                    diffuseSum += (sample1 + sample2) * w;                    weightSum += 2.0 * w;                }                gl_FragColor = vec4(diffuseSum/weightSum);
            }`})},Nv.prototype.addRender=function(t){this.renderCbk=t},Nv.prototype.render=function(t,r,i){if(r=t.autoClear,t.autoClear=!1,this.scene.overrideMaterial=this.overrideMaterial,this.clearColor){var s=t.getClearColor().getHex(),f=t.getClearAlpha();t.setClearColor(this.clearColor,this.clearAlpha)}this.clearDepth&&t.clearDepth(),t.setRenderTarget(this.renderToScreen?null:i),this.clear&&t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil),t.render(this.scene,this.camera),this.renderCbk&&this.renderCbk(),this.clearColor&&t.setClearColor(s,f),this.scene.overrideMaterial=null,t.autoClear=r};var XE=function(t){function r(i){return Ai(this,r),i=Tn(this,(r.__proto__||Wn(r)).call(this,i)),i.time=0,i.autoUpdate=!0,i}return jn(r,t),Xi(r,[{key:"getDefaultOptions",value:function(){return{totalRadian:Math.PI,color:16711680,radius:50,step:.1}}},{key:"initialize",value:function(i){this.threeLayer=i,this.addOverlay()}},{key:"onChanged",value:function(i,s){this.threeLayer&&(this.removeOverlay(),this.addOverlay())}},{key:"onDestroy",value:function(){this.removeOverlay()}},{key:"render",value:function(){this.time+=this.options.step/10,1<this.time&&(this.time=0);for(var i=this.shapeMarker.children,s=0;s<i.length;s++)i[s].material.uniforms.periodRatio.value=this.time}},{key:"removeOverlay",value:function(){this.threeLayer.remove(this.shapeMarker)}},{key:"addOverlay",value:function(){this.shapeMarker=new Pi.Group;for(var i=this.threeLayer,s=this.getData(),f=0;f<s.length;f++){var c=i.normizedPoint(s[f].geometry.coordinates);c=this.create3dCanvasRipple({originalData:s[f],normizedData:c}),this.shapeMarker.add(c)}i.add(this.shapeMarker)}},{key:"create3dCanvasRipple",value:function(i){var s=this.options,f=s.totalRadian,c=s.color;s=s.size;var d=i.originalData;i=i.normizedData,Object.prototype.toString.call(c)==="[object Function]"&&(c=c(d)),s=Object.prototype.toString.call(s)==="[object Function]"?s(d):Number(s),d={totalRadian:{type:"f",value:f},glowColor:{type:"c",value:new Pi.Color(c)},radius:{type:"f",value:s},periodRatio:{type:"f",value:0}},c=new Pi.Geometry;for(var p=f/(s/2),A=p;A<=f;A+=p){var S=s*Math.sin(A),z=s*Math.cos(A);c.vertices.push(new Pi.Vector3(0,0,A/f)),c.vertices.push(new Pi.Vector3(z,S,A/f))}for(f=0,s=c.vertices.length;f<s-2;++f)c.faces.push(new Pi.Face3(f,f+1,f+3));return f=new Pi.ShaderMaterial({uniforms:d,vertexShader:"varying vec4 vFragColor;varying vec4 vPosition;uniform float radius;uniform float totalRadian;uniform float periodRatio;uniform vec3 glowColor;void main(){float radian=radians(360.0*periodRatio);float s=sin(radian);float c=cos(radian);vec2 rotatedPostion=vec2(position.x*s+position.y*c,position.y*s-position.x*c);gl_Position=projectionMatrix*modelViewMatrix*vec4(rotatedPostion,0,1.0);vFragColor=vec4(glowColor,pow(position.z,1.3));}",fragmentShader:"varying vec4 vFragColor;void main(){gl_FragColor=vFragColor;}",blending:Pi.NormalBlending,transparent:!0,depthWrite:!1}),f=new Pi.Mesh(c,f),f.position.set(i[0],i[1],i[2]||0),f}}]),r}(N_),S3=ht(function(t,r){(function(){function i(){this.positions=[],this.previous=[],this.next=[],this.side=[],this.width=[],this.indices_array=[],this.uvs=[],this.counters=[],this.geometry=new c.BufferGeometry,this.widthCallback=null,this.matrixWorld=new c.Matrix4}function s(d,p,A,S,z){if(d=d.subarray||d.slice?d:d.buffer,A=A.subarray||A.slice?A:A.buffer,d=p?d.subarray?d.subarray(p,z&&p+z):d.slice(p,z&&p+z):d,A.set)A.set(d,S);else for(p=0;p<d.length;p++)A[p+S]=d[p];return A}function f(d){c.ShaderMaterial.call(this,{uniforms:pt({},c.UniformsLib.fog,{lineWidth:{value:1},map:{value:null},useMap:{value:0},alphaMap:{value:null},useAlphaMap:{value:0},color:{value:new c.Color(16777215)},opacity:{value:1},resolution:{value:new c.Vector2(1,1)},sizeAttenuation:{value:1},near:{value:1},far:{value:1},dashArray:{value:0},dashOffset:{value:0},dashRatio:{value:.5},useDash:{value:0},visibility:{value:1},alphaTest:{value:0},repeat:{value:new c.Vector2(1,1)}}),vertexShader:c.ShaderChunk.meshline_vert,fragmentShader:c.ShaderChunk.meshline_frag}),this.type="MeshLineMaterial",Or(this,{lineWidth:{enumerable:!0,get:function(){return this.uniforms.lineWidth.value},set:function(p){this.uniforms.lineWidth.value=p}},map:{enumerable:!0,get:function(){return this.uniforms.map.value},set:function(p){this.uniforms.map.value=p}},useMap:{enumerable:!0,get:function(){return this.uniforms.useMap.value},set:function(p){this.uniforms.useMap.value=p}},alphaMap:{enumerable:!0,get:function(){return this.uniforms.alphaMap.value},set:function(p){this.uniforms.alphaMap.value=p}},useAlphaMap:{enumerable:!0,get:function(){return this.uniforms.useAlphaMap.value},set:function(p){this.uniforms.useAlphaMap.value=p}},color:{enumerable:!0,get:function(){return this.uniforms.color.value},set:function(p){this.uniforms.color.value=p}},opacity:{enumerable:!0,get:function(){return this.uniforms.opacity.value},set:function(p){this.uniforms.opacity.value=p}},resolution:{enumerable:!0,get:function(){return this.uniforms.resolution.value},set:function(p){this.uniforms.resolution.value.copy(p)}},sizeAttenuation:{enumerable:!0,get:function(){return this.uniforms.sizeAttenuation.value},set:function(p){this.uniforms.sizeAttenuation.value=p}},near:{enumerable:!0,get:function(){return this.uniforms.near.value},set:function(p){this.uniforms.near.value=p}},far:{enumerable:!0,get:function(){return this.uniforms.far.value},set:function(p){this.uniforms.far.value=p}},dashArray:{enumerable:!0,get:function(){return this.uniforms.dashArray.value},set:function(p){this.uniforms.dashArray.value=p,this.useDash=p!==0?1:0}},dashOffset:{enumerable:!0,get:function(){return this.uniforms.dashOffset.value},set:function(p){this.uniforms.dashOffset.value=p}},dashRatio:{enumerable:!0,get:function(){return this.uniforms.dashRatio.value},set:function(p){this.uniforms.dashRatio.value=p}},useDash:{enumerable:!0,get:function(){return this.uniforms.useDash.value},set:function(p){this.uniforms.useDash.value=p}},visibility:{enumerable:!0,get:function(){return this.uniforms.visibility.value},set:function(p){this.uniforms.visibility.value=p}},alphaTest:{enumerable:!0,get:function(){return this.uniforms.alphaTest.value},set:function(p){this.uniforms.alphaTest.value=p}},repeat:{enumerable:!0,get:function(){return this.uniforms.repeat.value},set:function(p){this.uniforms.repeat.value.copy(p)}}}),this.setValues(d)}var c=typeof tt!="undefined"&&w3||this.THREE;if(!c)throw Error("MeshLine requires three.js");i.prototype.setMatrixWorld=function(d){this.matrixWorld=d},i.prototype.setGeometry=function(d,p){if(this.widthCallback=p,this.positions=[],this.counters=[],d instanceof c.Geometry)for(var A=0;A<d.vertices.length;A++){var S=d.vertices[A];p=A/d.vertices.length,this.positions.push(S.x,S.y,S.z),this.positions.push(S.x,S.y,S.z),this.counters.push(p),this.counters.push(p)}if(d instanceof Float32Array||d instanceof Array)for(A=0;A<d.length;A+=3)p=A/d.length,this.positions.push(d[A],d[A+1],d[A+2]),this.positions.push(d[A],d[A+1],d[A+2]),this.counters.push(p),this.counters.push(p);this.process()},i.prototype.raycast=function(){var d=new c.Matrix4,p=new c.Ray,A=new c.Sphere;return function(S,z){var w=S.linePrecision;w*=w;var I=this.geometry;if(I.boundingSphere===null&&I.computeBoundingSphere(),A.copy(I.boundingSphere),A.applyMatrix4(this.matrixWorld),S.ray.intersectSphere(A)!==!1){d.getInverse(this.matrixWorld),p.copy(S.ray).applyMatrix4(d);var E=new c.Vector3,P=new c.Vector3,F=new c.Vector3,X=new c.Vector3,q=this instanceof c.LineSegments?2:1;if(I instanceof c.BufferGeometry){var J=I.index,it=I.attributes;if(J!==null){I=J.array,it=it.position.array,J=0;for(var lt=I.length-1;J<lt;J+=q){var Mt=I[J+1];E.fromArray(it,3*I[J]),P.fromArray(it,3*Mt),Mt=p.distanceSqToSegment(E,P,X,F),Mt>w||(X.applyMatrix4(this.matrixWorld),Mt=S.ray.origin.distanceTo(X),Mt<S.near||Mt>S.far||z.push({distance:Mt,point:F.clone().applyMatrix4(this.matrixWorld),index:J,face:null,faceIndex:null,object:this}))}}else for(it=it.position.array,J=0,lt=it.length/3-1;J<lt;J+=q)E.fromArray(it,3*J),P.fromArray(it,3*J+3),Mt=p.distanceSqToSegment(E,P,X,F),Mt>w||(X.applyMatrix4(this.matrixWorld),Mt=S.ray.origin.distanceTo(X),Mt<S.near||Mt>S.far||z.push({distance:Mt,point:F.clone().applyMatrix4(this.matrixWorld),index:J,face:null,faceIndex:null,object:this}))}else if(I instanceof c.Geometry)for(E=I.vertices,P=E.length,J=0;J<P-1;J+=q)Mt=p.distanceSqToSegment(E[J],E[J+1],X,F),Mt>w||(X.applyMatrix4(this.matrixWorld),Mt=S.ray.origin.distanceTo(X),Mt<S.near||Mt>S.far||z.push({distance:Mt,point:F.clone().applyMatrix4(this.matrixWorld),index:J,face:null,faceIndex:null,object:this}))}}}(),i.prototype.compareV3=function(d,p){return d*=6,p*=6,this.positions[d]===this.positions[p]&&this.positions[d+1]===this.positions[p+1]&&this.positions[d+2]===this.positions[p+2]},i.prototype.copyV3=function(d){return d*=6,[this.positions[d],this.positions[d+1],this.positions[d+2]]},i.prototype.process=function(){var d=this.positions.length/6;this.previous=[],this.next=[],this.side=[],this.width=[],this.indices_array=[],this.uvs=[];for(var p=0;p<d;p++)this.side.push(1),this.side.push(-1);for(p=0;p<d;p++){var A=this.widthCallback?this.widthCallback(p/(d-1)):1;this.width.push(A),this.width.push(A)}for(p=0;p<d;p++)this.uvs.push(p/(d-1),0),this.uvs.push(p/(d-1),1);for(A=this.compareV3(0,d-1)?this.copyV3(d-2):this.copyV3(0),this.previous.push(A[0],A[1],A[2]),this.previous.push(A[0],A[1],A[2]),p=0;p<d-1;p++)A=this.copyV3(p),this.previous.push(A[0],A[1],A[2]),this.previous.push(A[0],A[1],A[2]);for(p=1;p<d;p++)A=this.copyV3(p),this.next.push(A[0],A[1],A[2]),this.next.push(A[0],A[1],A[2]);for(A=this.compareV3(d-1,0)?this.copyV3(1):this.copyV3(d-1),this.next.push(A[0],A[1],A[2]),this.next.push(A[0],A[1],A[2]),p=0;p<d-1;p++)A=2*p,this.indices_array.push(A,A+1,A+2),this.indices_array.push(A+2,A+1,A+3);this.attributes?(this.attributes.position.copyArray(new Float32Array(this.positions)),this.attributes.position.needsUpdate=!0,this.attributes.previous.copyArray(new Float32Array(this.previous)),this.attributes.previous.needsUpdate=!0,this.attributes.next.copyArray(new Float32Array(this.next)),this.attributes.next.needsUpdate=!0,this.attributes.side.copyArray(new Float32Array(this.side)),this.attributes.side.needsUpdate=!0,this.attributes.width.copyArray(new Float32Array(this.width)),this.attributes.width.needsUpdate=!0,this.attributes.uv.copyArray(new Float32Array(this.uvs)),this.attributes.uv.needsUpdate=!0,this.attributes.index.copyArray(new Uint16Array(this.indices_array)),this.attributes.index.needsUpdate=!0):this.attributes={position:new c.BufferAttribute(new Float32Array(this.positions),3),previous:new c.BufferAttribute(new Float32Array(this.previous),3),next:new c.BufferAttribute(new Float32Array(this.next),3),side:new c.BufferAttribute(new Float32Array(this.side),1),width:new c.BufferAttribute(new Float32Array(this.width),1),uv:new c.BufferAttribute(new Float32Array(this.uvs),2),index:new c.BufferAttribute(new Uint16Array(this.indices_array),1),counters:new c.BufferAttribute(new Float32Array(this.counters),1)},this.geometry.setAttribute("position",this.attributes.position),this.geometry.setAttribute("previous",this.attributes.previous),this.geometry.setAttribute("next",this.attributes.next),this.geometry.setAttribute("side",this.attributes.side),this.geometry.setAttribute("width",this.attributes.width),this.geometry.setAttribute("uv",this.attributes.uv),this.geometry.setAttribute("counters",this.attributes.counters),this.geometry.setIndex(this.attributes.index)},i.prototype.advance=function(d){var p=this.attributes.position.array,A=this.attributes.next.array,S=p.length;s(p,0,this.attributes.previous.array,0,S),s(p,6,p,0,S-6),p[S-6]=d.x,p[S-5]=d.y,p[S-4]=d.z,p[S-3]=d.x,p[S-2]=d.y,p[S-1]=d.z,s(p,6,A,0,S-6),A[S-6]=d.x,A[S-5]=d.y,A[S-4]=d.z,A[S-3]=d.x,A[S-2]=d.y,A[S-1]=d.z,this.attributes.position.needsUpdate=!0,this.attributes.previous.needsUpdate=!0,this.attributes.next.needsUpdate=!0},c.ShaderChunk.meshline_vert=["",c.ShaderChunk.logdepthbuf_pars_vertex,c.ShaderChunk.fog_pars_vertex,`\r
attribute vec3 previous;\r
attribute vec3 next;\r
attribute float side;\r
attribute float width;\r
attribute float counters;\r
\r
uniform vec2 resolution;\r
uniform float lineWidth;\r
uniform vec3 color;\r
uniform float opacity;\r
uniform float near;\r
uniform float far;\r
uniform float sizeAttenuation;\r
\r
varying vec2 vUV;\r
varying vec4 vColor;\r
varying float vCounters;\r
\r
vec2 fix( vec4 i, float aspect ) {\r
\r
    vec2 res = i.xy / i.w;\r
    res.x *= aspect;\r
	 vCounters = counters;\r
    return res;\r
\r
}\r
\r
void main() {\r
\r
    float aspect = resolution.x / resolution.y;\r
    float pixelWidthRatio = 1. / (resolution.x * projectionMatrix[0][0]);\r
\r
    vColor = vec4( color, opacity );\r
    vUV = uv;\r
\r
    mat4 m = projectionMatrix * modelViewMatrix;\r
    vec4 finalPosition = m * vec4( position, 1.0 );\r
    vec4 prevPos = m * vec4( previous, 1.0 );\r
    vec4 nextPos = m * vec4( next, 1.0 );\r
\r
    vec2 currentP = fix( finalPosition, aspect );\r
    vec2 prevP = fix( prevPos, aspect );\r
    vec2 nextP = fix( nextPos, aspect );\r
\r
    float pixelWidth = finalPosition.w * pixelWidthRatio;\r
    float w = 1.8 * pixelWidth * lineWidth * width;\r
\r
    if( sizeAttenuation == 1. ) {\r
        w = 1.8 * lineWidth * width;\r
    }\r
\r
    vec2 dir;\r
    if( nextP == currentP ) dir = normalize( currentP - prevP );\r
    else if( prevP == currentP ) dir = normalize( nextP - currentP );\r
    else {\r
        vec2 dir1 = normalize( currentP - prevP );\r
        vec2 dir2 = normalize( nextP - currentP );\r
        dir = normalize( dir1 + dir2 );\r
\r
        vec2 perp = vec2( -dir1.y, dir1.x );\r
        vec2 miter = vec2( -dir.y, dir.x );\r
        //w = clamp( w / dot( miter, perp ), 0., 4. * lineWidth * width );\r
\r
    }\r
\r
    //vec2 normal = ( cross( vec3( dir, 0. ), vec3( 0., 0., 1. ) ) ).xy;\r
    vec2 normal = vec2( -dir.y, dir.x );\r
    normal.x /= aspect;\r
    normal *= .5 * w;\r
\r
    vec4 offset = vec4( normal * side, 0.0, 1.0 );\r
    finalPosition.xy += offset.xy;\r
\r
    gl_Position = finalPosition;\r
`,c.ShaderChunk.logdepthbuf_vertex,c.ShaderChunk.fog_vertex&&"    vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );",c.ShaderChunk.fog_vertex,"}"].join(`\r
`),c.ShaderChunk.meshline_frag=["",c.ShaderChunk.fog_pars_fragment,c.ShaderChunk.logdepthbuf_pars_fragment,`\r
uniform sampler2D map;\r
uniform sampler2D alphaMap;\r
uniform float useMap;\r
uniform float useAlphaMap;\r
uniform float useDash;\r
uniform float dashArray;\r
uniform float dashOffset;\r
uniform float dashRatio;\r
uniform float visibility;\r
uniform float alphaTest;\r
uniform vec2 repeat;\r
\r
varying vec2 vUV;\r
varying vec4 vColor;\r
varying float vCounters;\r
\r
void main() {\r
`,c.ShaderChunk.logdepthbuf_fragment,`\r
    vec4 c = vColor;\r
    if( useMap == 1. ) c *= texture2D( map, vUV * repeat );\r
    if( useAlphaMap == 1. ) c.a *= texture2D( alphaMap, vUV * repeat ).a;\r
    if( c.a < alphaTest ) discard;\r
    if( useDash == 1. ){\r
        c.a *= ceil(mod(vCounters + dashOffset, dashArray) - (dashArray * dashRatio));\r
    }\r
    gl_FragColor = c;\r
    gl_FragColor.a *= step(vCounters, visibility);\r
`,c.ShaderChunk.fog_fragment,"}"].join(`\r
`),f.prototype=ft(c.ShaderMaterial.prototype),f.prototype.constructor=f,f.prototype.isMeshLineMaterial=!0,f.prototype.copy=function(d){return c.ShaderMaterial.prototype.copy.call(this,d),this.lineWidth=d.lineWidth,this.map=d.map,this.useMap=d.useMap,this.alphaMap=d.alphaMap,this.useAlphaMap=d.useAlphaMap,this.color.copy(d.color),this.opacity=d.opacity,this.resolution.copy(d.resolution),this.sizeAttenuation=d.sizeAttenuation,this.near=d.near,this.far=d.far,this.dashArray.copy(d.dashArray),this.dashOffset.copy(d.dashOffset),this.dashRatio.copy(d.dashRatio),this.useDash=d.useDash,this.visibility=d.visibility,this.alphaTest=d.alphaTest,this.repeat.copy(d.repeat),this},t.exports&&(r=t.exports={MeshLine:i,MeshLineMaterial:f}),r.MeshLine=i,r.MeshLineMaterial=f}).call(Og)}),YE=S3.MeshLine,ZE=S3.MeshLineMaterial,qE=function(t){function r(i){return Ai(this,r),i=Tn(this,(r.__proto__||Wn(r)).call(this,i)),i.staticDashArray=2,i.time=0,i.autoUpdate=!0,i}return jn(r,t),Xi(r,[{key:"getDefaultOptions",value:function(){return{color:16777215,textureColor:16777215,textureWidth:10,textureLength:30,step:.1}}},{key:"initialize",value:function(i){this.threeLayer=i,this.addOverlay()}},{key:"onChanged",value:function(i,s){this.threeLayer&&(this.removeOverlay(),this.addOverlay())}},{key:"onDestroy",value:function(){this.removeOverlay()}},{key:"render",value:function(){var i=this.getOptions(),s=i.textureWidth,f=i.style;i=i.step/10,this.time+=i,2<this.time&&(this.time=0);for(var c=this.flyLine.children,d=0;d<c.length;d++){var p=c[d],A=p.hash;p.children[0].material.uniforms.lineWidth.value=s*(1+.2*Math.sin(5*this.time)),p.children[0].material.uniforms.dashOffset.value=f==="chaos"?p.children[0].material.uniforms.dashOffset.value-i:(this.staticDashArray+A)*(1-this.time/2)}}},{key:"removeOverlay",value:function(){this.threeLayer.remove(this.flyLine)}},{key:"addOverlay",value:function(){var i=this;this.flyLine=new Pi.Group;var s=this.threeLayer,f=new Pi.TextureLoader,c=this.getData();f.load("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFkAAABZCAQAAAD/AkAkAAAACXBIWXMAAAsTAAALEwEAmpwYAAADGWlDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjaY2BgnuDo4uTKJMDAUFBUUuQe5BgZERmlwH6egY2BmYGBgYGBITG5uMAxIMCHgYGBIS8/L5UBA3y7xsDIwMDAcFnX0cXJlYE0wJpcUFTCwMBwgIGBwSgltTiZgYHhCwMDQ3p5SUEJAwNjDAMDg0hSdkEJAwNjAQMDg0h2SJAzAwNjCwMDE09JakUJAwMDg3N+QWVRZnpGiYKhpaWlgmNKflKqQnBlcUlqbrGCZ15yflFBflFiSWoKAwMD1A4GBgYGXpf8EgX3xMw8BUNTVQYqg4jIKAX08EGIIUByaVEZhMXIwMDAIMCgxeDHUMmwiuEBozRjFOM8xqdMhkwNTJeYNZgbme+y2LDMY2VmzWa9yubEtoldhX0mhwBHJycrZzMXM1cbNzf3RB4pnqW8xryH+IL5nvFXCwgJrBZ0E3wk1CisKHxYJF2UV3SrWJw4p/hWiRRJYcmjUhXSutJPZObIhsoJyp2V71HwUeRVvKA0RTlKRUnltepWtUZ1Pw1Zjbea+7QmaqfqWOsK6b7SO6I/36DGMMrI0ljS+LfJPdPDZivM+y0qLBOtfKwtbFRtRexY7L7aP3e47XjB6ZjzXpetruvdVrov9VjkudBrgfdCn8W+y/xW+a8P2Bq4N+hY8PmQW6HPwr5EMEUKRilFG8e4xUbF5cW3JMxO3Jx0Nvl5KlOaXLpNRlRmVdas7D059/KY8tULfAqLi2YXHy55WyZR7lJRWDmv6mz131q9uvj6SQ3HGn83G7Skt85ru94h2Ond1d59uJehz76/bsK+if8nO05pnXpiOu+M4JmzZj2aozW3ZN6+BVwLwxYtXvxxqcOyCcsfrjRe1br65lrddU3rb2402NSx+cFWq21Tt3/Y6btr1R6Oven7jh9QP9h56PURv6Obj4ufqD355LT3mS3nZM+3X/h0Ke7yqasW15bdEL3ZeuvrnfS7N+/7PDjwyPTx6qeKz2a+EHzZ9Zr5Td3bn+9LP3z6VPD53de8b+9+5P/88Lv4z7d/Vf//AwAqvx2K829RWwAAOGtpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+Cjx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTM4IDc5LjE1OTgyNCwgMjAxNi8wOS8xNC0wMTowOTowMSAgICAgICAgIj4KICAgPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICAgICAgPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIKICAgICAgICAgICAgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIgogICAgICAgICAgICB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iCiAgICAgICAgICAgIHhtbG5zOnBob3Rvc2hvcD0iaHR0cDovL25zLmFkb2JlLmNvbS9waG90b3Nob3AvMS4wLyIKICAgICAgICAgICAgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iCiAgICAgICAgICAgIHhtbG5zOnN0RXZ0PSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VFdmVudCMiCiAgICAgICAgICAgIHhtbG5zOnRpZmY9Imh0dHA6Ly9ucy5hZG9iZS5jb20vdGlmZi8xLjAvIgogICAgICAgICAgICB4bWxuczpleGlmPSJodHRwOi8vbnMuYWRvYmUuY29tL2V4aWYvMS4wLyI+CiAgICAgICAgIDx4bXA6Q3JlYXRvclRvb2w+QWRvYmUgUGhvdG9zaG9wIENDIDIwMTcgKE1hY2ludG9zaCk8L3htcDpDcmVhdG9yVG9vbD4KICAgICAgICAgPHhtcDpDcmVhdGVEYXRlPjIwMTktMDYtMjdUMTk6MzE6MTUrMDg6MDA8L3htcDpDcmVhdGVEYXRlPgogICAgICAgICA8eG1wOk1vZGlmeURhdGU+MjAxOS0wOC0xOVQxNjo1Nzo1MCswODowMDwveG1wOk1vZGlmeURhdGU+CiAgICAgICAgIDx4bXA6TWV0YWRhdGFEYXRlPjIwMTktMDgtMTlUMTY6NTc6NTArMDg6MDA8L3htcDpNZXRhZGF0YURhdGU+CiAgICAgICAgIDxkYzpmb3JtYXQ+aW1hZ2UvcG5nPC9kYzpmb3JtYXQ+CiAgICAgICAgIDxwaG90b3Nob3A6Q29sb3JNb2RlPjE8L3Bob3Rvc2hvcDpDb2xvck1vZGU+CiAgICAgICAgIDxwaG90b3Nob3A6SUNDUHJvZmlsZT5Eb3QgR2FpbiAxNSU8L3Bob3Rvc2hvcDpJQ0NQcm9maWxlPgogICAgICAgICA8eG1wTU06SW5zdGFuY2VJRD54bXAuaWlkOjQ5MmI1NTQ1LWIwNmQtNGI0Yi1iMWExLTZiN2NiNzExNzA5MjwveG1wTU06SW5zdGFuY2VJRD4KICAgICAgICAgPHhtcE1NOkRvY3VtZW50SUQ+eG1wLmRpZDo0OTJiNTU0NS1iMDZkLTRiNGItYjFhMS02YjdjYjcxMTcwOTI8L3htcE1NOkRvY3VtZW50SUQ+CiAgICAgICAgIDx4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ+eG1wLmRpZDo0OTJiNTU0NS1iMDZkLTRiNGItYjFhMS02YjdjYjcxMTcwOTI8L3htcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD4KICAgICAgICAgPHhtcE1NOkhpc3Rvcnk+CiAgICAgICAgICAgIDxyZGY6U2VxPgogICAgICAgICAgICAgICA8cmRmOmxpIHJkZjpwYXJzZVR5cGU9IlJlc291cmNlIj4KICAgICAgICAgICAgICAgICAgPHN0RXZ0OmFjdGlvbj5jcmVhdGVkPC9zdEV2dDphY3Rpb24+CiAgICAgICAgICAgICAgICAgIDxzdEV2dDppbnN0YW5jZUlEPnhtcC5paWQ6NDkyYjU1NDUtYjA2ZC00YjRiLWIxYTEtNmI3Y2I3MTE3MDkyPC9zdEV2dDppbnN0YW5jZUlEPgogICAgICAgICAgICAgICAgICA8c3RFdnQ6d2hlbj4yMDE5LTA2LTI3VDE5OjMxOjE1KzA4OjAwPC9zdEV2dDp3aGVuPgogICAgICAgICAgICAgICAgICA8c3RFdnQ6c29mdHdhcmVBZ2VudD5BZG9iZSBQaG90b3Nob3AgQ0MgMjAxNyAoTWFjaW50b3NoKTwvc3RFdnQ6c29mdHdhcmVBZ2VudD4KICAgICAgICAgICAgICAgPC9yZGY6bGk+CiAgICAgICAgICAgIDwvcmRmOlNlcT4KICAgICAgICAgPC94bXBNTTpIaXN0b3J5PgogICAgICAgICA8dGlmZjpPcmllbnRhdGlvbj4xPC90aWZmOk9yaWVudGF0aW9uPgogICAgICAgICA8dGlmZjpYUmVzb2x1dGlvbj43MjAwMDAvMTAwMDA8L3RpZmY6WFJlc29sdXRpb24+CiAgICAgICAgIDx0aWZmOllSZXNvbHV0aW9uPjcyMDAwMC8xMDAwMDwvdGlmZjpZUmVzb2x1dGlvbj4KICAgICAgICAgPHRpZmY6UmVzb2x1dGlvblVuaXQ+MjwvdGlmZjpSZXNvbHV0aW9uVW5pdD4KICAgICAgICAgPGV4aWY6Q29sb3JTcGFjZT42NTUzNTwvZXhpZjpDb2xvclNwYWNlPgogICAgICAgICA8ZXhpZjpQaXhlbFhEaW1lbnNpb24+ODk8L2V4aWY6UGl4ZWxYRGltZW5zaW9uPgogICAgICAgICA8ZXhpZjpQaXhlbFlEaW1lbnNpb24+ODk8L2V4aWY6UGl4ZWxZRGltZW5zaW9uPgogICAgICA8L3JkZjpEZXNjcmlwdGlvbj4KICAgPC9yZGY6UkRGPgo8L3g6eG1wbWV0YT4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAKPD94cGFja2V0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",function(d){for(var p=0;p<c.length;p++){var A=c[p].geometry.coordinates.map(function(S){return new(Function.prototype.bind.apply(Pi.Vector3,[null].concat(d3(s.normizedPoint(S)))))});A=i.createFlyLine({originalData:c[p],curveData:A,texture:d}),i.flyLine.add(A)}s.add(i.flyLine)})}},{key:"createFlyLine",value:function(i){var s=this.options,f=s.color,c=s.textureColor,d=s.textureWidth,p=i.originalData,A=i.curveData;i=i.texture;var S=Math.random();s=Math.min(1,1-s.textureLength/100),s=Math.max(0,s),Object.prototype.toString.call(f)==="[object Function]"&&(f=f(p)),Object.prototype.toString.call(c)==="[object Function]"&&(c=c(p)),p=new Pi.Geometry,p.vertices=A,p.verticesNeedUpdate=!0,f=new Pi.LineBasicMaterial({linewidth:1,color:new Pi.Color(f),blending:Pi.AdditiveBlending,depthTest:!0,depthWrite:!1,transparent:!0,opacity:.3,linecap:"round",linejoin:"round"}),f=new Pi.Line(p,f),f.renderDepth=!1,f.hash=S,p=new YE;for(var z=new Pi.Geometry,w=0;w<A.length;w++){var I=A[w];z.vertices.push(new Pi.Vector3(I.x,I.y,I.z))}return p.setGeometry(z,function(E){return 1-E}),c=new ZE({map:i,useMap:!0,color:new Pi.Color(c),opacity:1,dashArray:this.staticDashArray+S,dashOffset:0,dashRatio:s,sizeAttenuation:!0,lineWidth:d,depthWrite:!1,depthTest:!0,alphaTest:!1,transparent:!0,blending:Pi.AdditiveBlending,side:Pi.DoubleSide}),c=new Pi.Mesh(p.geometry,c),f.add(c),f}}]),r}(N_);Z.THREELoader=xc,Z.PostProcessing=jE,Z.FanLayer=XE,Z.FlyLineLayer=qE,Z.ThreeLayer=M3,Object.defineProperty(Z,"__esModule",{value:!0})})})(RM,RM.exports);Object.defineProperty(yC,"__esModule",{value:!0});var xC=Qi,fM=xC.__importStar(rg.exports),HS=xC.__importStar(RM.exports),C4=Wo,T4=vC,S4=function(b){xC.__extends(G,b);function G(Z){var tt=b.call(this,Z)||this;tt._createLayer=!1;var ot=tt;return tt.props.getMethods&&tt.props.getMethods({setViewport:tt.setViewport.bind(ot)}),tt}return G.prototype.componentDidMount=function(){this.initialize()},G.prototype.componentWillUnmount=function(){this.destroy()},G.prototype.componentDidUpdate=function(Z){var tt=this.props,ot=tt.type,ht=tt.data,bt=tt.options,se=tt.autoViewport,Ot=Z.type,Jt=Z.data,le=Z.options,jt=Z.autoViewport;if(!this.map||!this.layer){this.initialize();return}if(ot!==Ot){this.destroy(),this.initialize();return}JSON.stringify(le)!==JSON.stringify(bt)&&this.layer.setOptions(bt),JSON.stringify(Jt)!==JSON.stringify(ht)&&this.layer.setData(ht),se&&(JSON.stringify(Jt)!==JSON.stringify(ht)||se!==jt)&&this.setViewport()},G.prototype.destroy=function(){this.layer&&this.view&&(this._createLayer=!1,this.view.removeLayer(this.layer),this.layer.destroy(),this.layer=null)},G.prototype.initialize=function(){var Z=this.map=this.getMap(),tt=this.view=this.props.view||this.context.view;!Z||!tt||(this._createLayer||this.createLayers(),this.layer.setData(this.props.data),this.props.autoViewport&&this.setViewport())},G.prototype.setViewport=function(){var Z=this.props.coordType==="bd09mc",tt=function(ht){var bt=new BMapGL.Point(ht[0],ht[1]);return Z?BMapGL.Projection.convertMC2LL(bt):bt},ot=[];this.props.data.forEach(function(ht){ht.geometry.type==="Point"?ot.push(tt(ht.geometry.coordinates)):ht.geometry.type==="LineString"?ht.geometry.coordinates.forEach(function(bt){ot.push(tt(bt))}):ht.geometry.type==="Polygon"?ht.geometry.coordinates[0].forEach(function(bt){ot.push(tt(bt))}):ht.geometry.type==="MultiPolygon"&&ht.geometry.coordinates.forEach(function(bt){bt[0].forEach(function(se){ot.push(tt(se))})})}),ot.length>0&&this.map.setViewport(ot,this.props.viewportOptions||{})},G.prototype.createLayers=function(){if(fM[this.props.type]||HS[this.props.type]){this._createLayer=!0;var Z=fM[this.props.type]?fM:HS;this.layer=new Z[this.props.type](this.props.options),this.view.addLayer(this.layer)}else console.error("mapvgl doesn't have layer "+this.props.type+"!")},G.prototype.render=function(){return null},G.contextType=T4.ViewContext,G}(C4.Component);yC.default=S4;var AC={};Object.defineProperty(AC,"__esModule",{value:!0});var I4=Qi,E4=Qs,L4=Wo,R4=function(b){I4.__extends(G,b);function G(Z){var tt=b.call(this,Z)||this;return tt._showLayer=!1,tt}return G.prototype.componentDidMount=function(){this.initialize()},G.prototype.componentDidUpdate=function(Z){this.initialize()},G.prototype.componentWillUnmount=function(){this._showLayer&&(this.map.setTrafficOff(),this._showLayer=!1)},G.prototype.initialize=function(){var Z=this.map=this.getMap();!Z||this._showLayer||(Z.setTrafficOn(),this._showLayer=!0)},G.prototype.render=function(){return null},G.contextType=E4.MapContext,G}(L4.Component);AC.default=R4;var _C={};Object.defineProperty(_C,"__esModule",{value:!0});var P4=Qi,D4=Qs,O4=Wo,F4=function(b){P4.__extends(G,b);function G(Z){return b.call(this,Z)||this}return G.prototype.componentDidMount=function(){this.initialize()},G.prototype.componentDidUpdate=function(Z){this.initialize()},G.prototype.componentWillUnmount=function(){this.destroy()},G.prototype.destroy=function(){this.tilelayer&&(this.map.removeTileLayer(this.tilelayer),this.tilelayer=void 0)},G.prototype.initialize=function(){var Z=this.map=this.getMap();if(!!Z){this.destroy();var tt="pl",ot="20190102",ht=this.tilelayer=new BMapGL.TileLayer({transparentPng:!0});ht.zIndex=110,ht.getTilesUrl=function(bt,se){if(!bt||se<0)return"";var Ot=bt.x,Jt=bt.y,le="//mapsv0.bdimg.com/tile/?udt="+ot+"&qt=tile&styles="+tt+"&x="+Ot+"&y="+Jt+"&z="+se;return le},Z.addTileLayer(this.tilelayer)}},G.prototype.render=function(){return null},G.contextType=D4.MapContext,G}(O4.Component);_C.default=F4;var wC={},Xc={};Object.defineProperty(Xc,"__esModule",{value:!0});Xc.requireScript=Xc.requireCss=void 0;var H2=document.head||document.getElementsByTagName("head")[0],j0={};function B4(b){return new Promise(function(G,Z){if(b in j0){G();return}var tt=document.createElement("link");tt.type="text/css",tt.rel="stylesheet",tt.href=b,tt.onerror=function(ot){H2.removeChild(tt),Z(new URIError("The css "+b+" is no accessible."))},tt.onload=function(){j0[b]=!0,G()},H2.appendChild(tt)})}Xc.requireCss=B4;function z4(b){return new Promise(function(G,Z){if(b in j0){G();return}var tt=document.createElement("script");tt.type="text/javascript",tt.src=b,tt.onerror=function(ot){H2.removeChild(tt),Z(new URIError("The Script "+b+" is no accessible."))},N4(tt)?tt.onload=function(){j0[b]=!0,G()}:tt.onreadystatechange=function(){(tt.readyState=="loaded"||tt.readyState=="complete")&&(tt.onreadystatechange=null,j0[b]=!0,G())},H2.appendChild(tt)})}Xc.requireScript=z4;function N4(b){return b=b||document.createElement("script"),"onload"in b?!0:(b.setAttribute("onload",""),typeof b.onload=="function")}Object.defineProperty(wC,"__esModule",{value:!0});var MC=Qi,GS=MC.__importDefault(Nr.exports),U4=Wo,VS=Xc,PM=MC.__importStar(Eo),b4=Qs,BI=["overlaycomplete","overlaycancel"],zI={enableCalculate:["enableCalculate","disableCalculate"],enableSorption:["enableSorption","disableSorption"],enableGpc:["enableGpc","disableGpc"]},k4={strokeColor:"#5E87DB",fillColor:"#5E87DB",strokeWeight:2,strokeOpacity:1,fillOpacity:.2},H4={borderRadius:"2px",background:"#FFFBCC",border:"1px solid #E1E1E1",color:"#703A04",fontSize:"12px",letterSpacing:"0",padding:"5px"},NI=function(b){MC.__extends(G,b);function G(Z){var tt=b.call(this,Z)||this;return tt.el=GS.default.createRef(),tt.options=["isOpen","drawingMode","enableDrawingTool","enableCalculate","enableSorption","enableGpc","enableLimit","sorptionDistance","limitOptions","drawingToolOptions","markerOptions","circleOptions","polylineOptions","polygonOptions","rectangleOptions","labelOptions"],tt}return G.prototype.componentDidMount=function(){this.initialize()},G.prototype.componentWillUnmount=function(){this.destroy()},G.prototype.destroy=function(){this.drawingmanager&&(this.drawingmanager.close(),this.instance=this.drawingmanager=void 0)},G.prototype.initialize=function(){var Z=this,tt=this.map=this.getMap();if(!!tt){this.destroy();for(var ot=this.getOptions(),ht=["circleOptions","polylineOptions","polygonOptions","rectangleOptions"],bt=0;bt<ht.length;bt++){var se=ht[bt];ot[se]||(ot[se]=k4)}if(ot.labelOptions||(ot.labelOptions=H4),ot.drawingToolOptions.customContainer=this.el.current,window.BMapGLLib&&BMapGLLib.DrawingManager&&(this.instance=this.drawingmanager=new BMapGLLib.DrawingManager(tt,ot)),!window.BMapGLLib||!BMapGLLib.DrawingManager){var Ot=this.props.cssUrl||"//mapopen.bj.bcebos.com/github/BMapGLLib/DrawingManager/src/DrawingManager.min.css",Jt=this.props.scriptUrl||"//mapopen.bj.bcebos.com/github/BMapGLLib/DrawingManager/src/DrawingManager.min.js";VS.requireCss(Ot).then(function(){}),VS.requireScript(Jt).then(function(){Z.instance=Z.drawingmanager=new BMapGLLib.DrawingManager(tt,ot),PM.registerEvents(Z,Z.getInstance(Z),BI),PM.toggleMethods(Z,Z.getInstance(Z),zI)})}}},G.prototype.render=function(){return GS.default.createElement("div",{className:"react-bmapgl-drawingmanager",ref:this.el,style:this.props.style})},G.contextType=b4.MapContext,G}(U4.Component);NI.defaultProps={isOpen:!1,enableDrawingTool:!0,enableCalculate:!1,enableSorption:!1,enableGpc:!1,enableLimit:!1,sorptionDistance:20,limitOptions:{area:5e7,distance:3e4},drawingToolOptions:{},style:{position:"absolute",left:0,top:0,width:360}};wC.default=PM.default(NI,BI,zI);var CC={};Object.defineProperty(CC,"__esModule",{value:!0});var UI=Qi,G4=Wo,V4=Xc,DM=UI.__importStar(Eo),W4=Qs,bI=["drawend","addpoint","removepolyline"],kI={},HI=function(b){UI.__extends(G,b);function G(Z){var tt=b.call(this,Z)||this;return tt.options=["tips","followText","unit","lineColor","lineStroke","opacity","lineStyle","cursor","secIcon","closeIcon"],tt}return G.prototype.componentDidMount=function(){this.initialize()},G.prototype.componentWillUnmount=function(){this.destroy()},G.prototype.destroy=function(){this.distancetool&&(this.distancetool.close(),this.instance=this.distancetool=void 0)},G.prototype.initialize=function(){var Z=this,tt=this.map=this.getMap();if(!!tt){this.destroy();var ot=this.getOptions();if(window.BMapGLLib&&BMapGLLib.DistanceTool&&(this.instance=this.distancetool=new BMapGLLib.DistanceTool(tt,ot),this.props.defaultOpen&&this.distancetool.open()),!window.BMapGLLib||!BMapGLLib.DistanceTool){var ht=this.props.scriptUrl||"//mapopen.bj.bcebos.com/github/BMapGLLib/DistanceTool/src/DistanceTool.js";V4.requireScript(ht).then(function(){Z.instance=Z.distancetool=new BMapGLLib.DistanceTool(tt,ot),DM.registerEvents(Z,Z.getInstance(Z),bI),DM.toggleMethods(Z,Z.getInstance(Z),kI),Z.props.defaultOpen&&Z.distancetool.open()})}}},G.prototype.render=function(){return null},G.contextType=W4.MapContext,G}(G4.Component);HI.defaultProps={defaultOpen:!0};CC.default=DM.default(HI,bI,kI);var TC={};Object.defineProperty(TC,"__esModule",{value:!0});var SC=Qi,L2=SC.__importStar(Nr.exports),j4=Wo,X4=SC.__importDefault(Eo),Y4=["confirm","highlight"],Z4={},GI=function(b){SC.__extends(G,b);function G(Z){var tt=b.call(this,Z)||this;return tt.el=L2.default.createRef(),tt.options=["location","onSearchComplete","input","types"],tt}return G.prototype.componentDidMount=function(){this.initialize()},G.prototype.componentWillUnmount=function(){this.destroy()},G.prototype.destroy=function(){this.ac&&(this.ac.dispose(),this.instance=this.ac=void 0)},G.prototype.initialize=function(){this.destroy();var Z=this.getOptions();Z.input||(Z.input=this.el.current),this.ac=this.instance=new BMapGL.Autocomplete(Z)},G.prototype.render=function(){return L2.default.createElement(L2.Fragment,null,!this.props.input&&L2.default.createElement("input",{className:"react-bmapgl-autocomplete",ref:this.el,style:this.props.style}))},G}(j4.Component);GI.defaultProps={};TC.default=X4.default(GI,Y4,Z4);var IC={};Object.defineProperty(IC,"__esModule",{value:!0});var D2=Qi,pl=rg.exports,q4=D2.__importDefault(Mu),J4=Wo,pM="rgba(60, 50, 200, 0.9)",Q4=function(b){D2.__extends(G,b);function G(Z){var tt=b.call(this,Z)||this;return tt._createLayer=!1,tt}return G.prototype.componentDidMount=function(){this.initialize()},G.prototype.componentDidUpdate=function(Z){q4.default(this.props,Z)||this.initialize()},G.prototype.componentWillUnmount=function(){this.destroy()},G.prototype.destroy=function(){this._createLayer=!1,this.view.destroy(),this.view=void 0,this.linelayer=void 0,this.arrowlayer=void 0,this.flowlayer=void 0,this.pointlayer=void 0,this.textlayer=void 0,this.colorarrowlayers=[]},G.prototype.initialize=function(){var Z=this,tt=this.map=this.getMap();if(!!tt){this._createLayer||this.createLayers();var ot=[],ht=[],bt=new Map;if(this.colorarrowlayers&&this.colorarrowlayers.length)for(var se=0;se<this.colorarrowlayers.length;se++){var Ot=this.colorarrowlayers[se];this.view.removeLayer(Ot)}if(this.colorarrowlayers=[],this.props.data){var Jt=[],le=new pl.OdCurve;this.props.data.forEach(function(jt){var pe=jt.from.point||pl.utilCity.getCenterByCityName(jt.from.city),He=jt.to.point||pl.utilCity.getCenterByCityName(jt.to.city);pe=new BMapGL.Point(pe.lng,pe.lat),He=new BMapGL.Point(He.lng,He.lat),le.setOptions({points:[pe,He]});var ye=le.getPoints();Z.props.coordType==="bd09mc"?(Jt.push(BMapGL.Projection.convertMC2LL(pe)),Jt.push(BMapGL.Projection.convertMC2LL(He))):(Jt.push(pe),Jt.push(He)),ot.push({geometry:{type:"LineString",coordinates:ye},color:jt.color});var dt=bt.get(jt.color)||[];dt.push({geometry:{type:"LineString",coordinates:ye}}),bt.set(jt.color,dt),Z.props.showEndPoint!==!1&&ht.push({geometry:{type:"Point",coordinates:[He.lng,He.lat]},color:jt.color,properties:{text:jt.to.name||jt.to.city}}),Z.props.showStartPoint!==!1&&ht.push({geometry:{type:"Point",coordinates:[pe.lng,pe.lat]},color:jt.color,properties:{text:jt.from.name||jt.from.city}}),Jt.length>0&&Z.props.autoViewport===!0&&tt.setViewport(Jt,Z.props.viewportOptions||{})})}this.linelayer.setData(ot),this.props.lineOptions&&this.linelayer.setOptions(this.props.lineOptions),this.pointlayer.setData(ht),this.props.pointOptions&&this.pointlayer.setOptions(this.props.pointOptions),this.textlayer.setData(ht),this.props.textOptions&&this.textlayer.setOptions(this.props.textOptions),Array.from(bt.keys()).forEach(function(jt){if(jt===void 0)Z.arrowlayer.setData(bt.get(void 0)),Z.props.arrowOptions&&Z.arrowlayer.setOptions(Z.props.arrowOptions);else{var pe=new pl.LineLayer(D2.__assign(D2.__assign({blend:"lighter",width:10},Z.props.arrowOptions),{style:"arrow",color:"rgba(255, 255, 255, 0)",styleOptions:{color:jt}}));Z.view.addLayer(pe),pe.setData(bt.get(jt)),Z.colorarrowlayers.push(pe)}}),this.props.enableAnimation&&(this.flowlayer.setData(ot),this.props.animationOptions&&this.flowlayer.setOptions(this.props.animationOptions))}},G.prototype.createLayers=function(){this._createLayer=!0;var Z=this.map,tt=this.view=new pl.View({map:Z}),ot=this.linelayer=new pl.LineLayer({blend:"lighter",color:pM,width:4});tt.addLayer(ot);var ht=this.arrowlayer=new pl.LineLayer({blend:"lighter",width:10,style:"arrow",color:"rgba(255, 255, 255, 0)",styleOptions:{color:pM}});tt.addLayer(ht);var bt=this.pointlayer=new pl.PointLayer({blend:"lighter",depthTest:!1,color:pM,size:10});tt.addLayer(bt);var se=this.textlayer=new pl.TextLayer({offset:[0,15],depthTest:!1,color:"#333"});tt.addLayer(se);var Ot=this.flowlayer=new pl.LineLayer({blend:"lighter",color:function(){return"rgb(240, 200, 200)"},width:2,animation:!0,interval:.4,duration:1,trailLength:.8});tt.addLayer(Ot)},G.prototype.render=function(){return null},G.defaultProps={enableAnimation:!0,showStartPoint:!0,showEndPoint:!0},G}(J4.Component);IC.default=Q4;var VI={};(function(b){Object.defineProperty(b,"__esModule",{value:!0});var G=Qi;G.__exportStar(Xc,b);var Z=J2;Object.defineProperty(b,"isString",{enumerable:!0,get:function(){return Z.default}});var tt=K2;Object.defineProperty(b,"getDisplayName",{enumerable:!0,get:function(){return tt.default}})})(VI);(function(b){Object.defineProperty(b,"__esModule",{value:!0});var G=Qi,Z=Qs;Object.defineProperty(b,"Map",{enumerable:!0,get:function(){return Z.default}});var tt=Q2;Object.defineProperty(b,"MapApiLoaderHOC",{enumerable:!0,get:function(){return tt.default}});var ot=QM;Object.defineProperty(b,"MapTypeControl",{enumerable:!0,get:function(){return ot.default}});var ht=KM;Object.defineProperty(b,"ScaleControl",{enumerable:!0,get:function(){return ht.default}});var bt=$M;Object.defineProperty(b,"ZoomControl",{enumerable:!0,get:function(){return bt.default}});var se=tC;Object.defineProperty(b,"NavigationControl",{enumerable:!0,get:function(){return se.default}});var Ot=eC;Object.defineProperty(b,"CityListControl",{enumerable:!0,get:function(){return Ot.default}});var Jt=rC;Object.defineProperty(b,"Marker",{enumerable:!0,get:function(){return Jt.default}});var le=nC;Object.defineProperty(b,"Polyline",{enumerable:!0,get:function(){return le.default}});var jt=aC;Object.defineProperty(b,"Polygon",{enumerable:!0,get:function(){return jt.default}});var pe=lC;Object.defineProperty(b,"Circle",{enumerable:!0,get:function(){return pe.default}});var He=cC;Object.defineProperty(b,"InfoWindow",{enumerable:!0,get:function(){return He.default}});var ye=fC;Object.defineProperty(b,"Label",{enumerable:!0,get:function(){return ye.default}});var dt=dC;Object.defineProperty(b,"CustomOverlay",{enumerable:!0,get:function(){return dt.default}});var Me=vC;Object.defineProperty(b,"MapvglView",{enumerable:!0,get:function(){return Me.default}});var vr=yC;Object.defineProperty(b,"MapvglLayer",{enumerable:!0,get:function(){return vr.default}});var Tr=AC;Object.defineProperty(b,"TrafficLayer",{enumerable:!0,get:function(){return Tr.default}});var fe=_C;Object.defineProperty(b,"PanoramaLayer",{enumerable:!0,get:function(){return fe.default}});var Mr=wC;Object.defineProperty(b,"DrawingManager",{enumerable:!0,get:function(){return Mr.default}});var ui=CC;Object.defineProperty(b,"DistanceTool",{enumerable:!0,get:function(){return ui.default}});var xi=TC;Object.defineProperty(b,"AutoComplete",{enumerable:!0,get:function(){return xi.default}});var fn=IC;Object.defineProperty(b,"Arc",{enumerable:!0,get:function(){return fn.default}}),b.mapvgl=G.__importStar(rg.exports),G.__exportStar(VI,b)})(k0);const K4=b=>{const{mapShow:G,shopList:Z}=b,{getShowListDispatch:tt,getMapShowDispatch:ot}=b,ht=()=>{ot(G)};return Nr.exports.useEffect(()=>{tt()},[]),jp(xP,{children:[Oi("div",{className:"shopList",children:Oi(zS,{defaultActiveKey:["1"],onChange:ht,children:Oi(zS.Panel,{title:G?"\u6536\u8D77\u5730\u56FE":"\u5C55\u5F00\u5730\u56FE",children:jp(k0.Map,{center:{lng:115.832777,lat:28.724024},zoom:"14",style:{height:300},children:[Oi(k0.Marker,{position:{lng:115.832777,lat:28.724024}}),Oi(k0.NavigationControl,{}),Oi(k0.InfoWindow,{position:{lng:115.832777,lat:28.724024},title:"\u6211\u7684\u4F4D\u7F6E",text:"\u4E1C\u534E\u7406\u5DE5\u5927\u5B66"})]})},"1")})}),Oi(_P,{message:Z})]})},$4=b=>({mapShow:b.nearby.mapShow,shopList:b.nearby.shopList}),tD=b=>({getShowListDispatch(){b(yP())},getMapShowDispatch(G){b(gP(G))}});var oD=wL($4,tD)(K4);export{oD as default};
